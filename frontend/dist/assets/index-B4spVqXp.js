var C_=Object.defineProperty;var O0=n=>{throw TypeError(n)};var k_=(n,e,t)=>e in n?C_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Q=(n,e,t)=>k_(n,typeof e!="symbol"?e+"":e,t),wm=(n,e,t)=>e.has(n)||O0("Cannot "+t);var c=(n,e,t)=>(wm(n,e,"read from private field"),t?t.call(n):e.get(n)),A=(n,e,t)=>e.has(n)?O0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),w=(n,e,t,s)=>(wm(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),_=(n,e,t)=>(wm(n,e,"access private method"),t);var Ut=(n,e,t,s)=>({set _(i){w(n,e,i,t)},get _(){return c(n,e,s)}});function N_(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in n)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function P_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Lx={exports:{}},Wp={},jx={exports:{}},de={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bd=Symbol.for("react.element"),T_=Symbol.for("react.portal"),R_=Symbol.for("react.fragment"),M_=Symbol.for("react.strict_mode"),L_=Symbol.for("react.profiler"),j_=Symbol.for("react.provider"),I_=Symbol.for("react.context"),D_=Symbol.for("react.forward_ref"),F_=Symbol.for("react.suspense"),O_=Symbol.for("react.memo"),z_=Symbol.for("react.lazy"),z0=Symbol.iterator;function B_(n){return n===null||typeof n!="object"?null:(n=z0&&n[z0]||n["@@iterator"],typeof n=="function"?n:null)}var Ix={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Dx=Object.assign,Fx={};function Pc(n,e,t){this.props=n,this.context=e,this.refs=Fx,this.updater=t||Ix}Pc.prototype.isReactComponent={};Pc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Pc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Ox(){}Ox.prototype=Pc.prototype;function Sv(n,e,t){this.props=n,this.context=e,this.refs=Fx,this.updater=t||Ix}var Av=Sv.prototype=new Ox;Av.constructor=Sv;Dx(Av,Pc.prototype);Av.isPureReactComponent=!0;var B0=Array.isArray,zx=Object.prototype.hasOwnProperty,_v={current:null},Bx={key:!0,ref:!0,__self:!0,__source:!0};function Ux(n,e,t){var s,i={},r=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)zx.call(e,s)&&!Bx.hasOwnProperty(s)&&(i[s]=e[s]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(n&&n.defaultProps)for(s in o=n.defaultProps,o)i[s]===void 0&&(i[s]=o[s]);return{$$typeof:bd,type:n,key:r,ref:a,props:i,_owner:_v.current}}function U_(n,e){return{$$typeof:bd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Ev(n){return typeof n=="object"&&n!==null&&n.$$typeof===bd}function H_(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var U0=/\/+/g;function xm(n,e){return typeof n=="object"&&n!==null&&n.key!=null?H_(""+n.key):e.toString(36)}function Qd(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case bd:case T_:a=!0}}if(a)return a=n,i=i(a),n=s===""?"."+xm(a,0):s,B0(i)?(t="",n!=null&&(t=n.replace(U0,"$&/")+"/"),Qd(i,e,t,"",function(u){return u})):i!=null&&(Ev(i)&&(i=U_(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(U0,"$&/")+"/")+n)),e.push(i)),1;if(a=0,s=s===""?".":s+":",B0(n))for(var o=0;o<n.length;o++){r=n[o];var l=s+xm(r,o);a+=Qd(r,e,t,l,i)}else if(l=B_(n),typeof l=="function")for(n=l.call(n),o=0;!(r=n.next()).done;)r=r.value,l=s+xm(r,o++),a+=Qd(r,e,t,l,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Pd(n,e,t){if(n==null)return n;var s=[],i=0;return Qd(n,s,"","",function(r){return e.call(t,r,i++)}),s}function $_(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Jt={current:null},Jd={transition:null},W_={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:Jd,ReactCurrentOwner:_v};function Hx(){throw Error("act(...) is not supported in production builds of React.")}de.Children={map:Pd,forEach:function(n,e,t){Pd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Pd(n,function(){e++}),e},toArray:function(n){return Pd(n,function(e){return e})||[]},only:function(n){if(!Ev(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};de.Component=Pc;de.Fragment=R_;de.Profiler=L_;de.PureComponent=Sv;de.StrictMode=M_;de.Suspense=F_;de.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W_;de.act=Hx;de.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=Dx({},n.props),i=n.key,r=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=_v.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)zx.call(e,l)&&!Bx.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:bd,type:n.type,key:i,ref:r,props:s,_owner:a}};de.createContext=function(n){return n={$$typeof:I_,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:j_,_context:n},n.Consumer=n};de.createElement=Ux;de.createFactory=function(n){var e=Ux.bind(null,n);return e.type=n,e};de.createRef=function(){return{current:null}};de.forwardRef=function(n){return{$$typeof:D_,render:n}};de.isValidElement=Ev;de.lazy=function(n){return{$$typeof:z_,_payload:{_status:-1,_result:n},_init:$_}};de.memo=function(n,e){return{$$typeof:O_,type:n,compare:e===void 0?null:e}};de.startTransition=function(n){var e=Jd.transition;Jd.transition={};try{n()}finally{Jd.transition=e}};de.unstable_act=Hx;de.useCallback=function(n,e){return Jt.current.useCallback(n,e)};de.useContext=function(n){return Jt.current.useContext(n)};de.useDebugValue=function(){};de.useDeferredValue=function(n){return Jt.current.useDeferredValue(n)};de.useEffect=function(n,e){return Jt.current.useEffect(n,e)};de.useId=function(){return Jt.current.useId()};de.useImperativeHandle=function(n,e,t){return Jt.current.useImperativeHandle(n,e,t)};de.useInsertionEffect=function(n,e){return Jt.current.useInsertionEffect(n,e)};de.useLayoutEffect=function(n,e){return Jt.current.useLayoutEffect(n,e)};de.useMemo=function(n,e){return Jt.current.useMemo(n,e)};de.useReducer=function(n,e,t){return Jt.current.useReducer(n,e,t)};de.useRef=function(n){return Jt.current.useRef(n)};de.useState=function(n){return Jt.current.useState(n)};de.useSyncExternalStore=function(n,e,t){return Jt.current.useSyncExternalStore(n,e,t)};de.useTransition=function(){return Jt.current.useTransition()};de.version="18.3.1";jx.exports=de;var k=jx.exports;const Ye=P_(k),V_=N_({__proto__:null,default:Ye},[k]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G_=k,X_=Symbol.for("react.element"),q_=Symbol.for("react.fragment"),Y_=Object.prototype.hasOwnProperty,K_=G_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q_={key:!0,ref:!0,__self:!0,__source:!0};function $x(n,e,t){var s,i={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)Y_.call(e,s)&&!Q_.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:X_,type:n,key:r,ref:a,props:i,_owner:K_.current}}Wp.Fragment=q_;Wp.jsx=$x;Wp.jsxs=$x;Lx.exports=Wp;var f=Lx.exports,ig={},Wx={exports:{}},Dn={},Vx={exports:{}},Gx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(M,F){var H=M.length;M.push(F);e:for(;0<H;){var O=H-1>>>1,J=M[O];if(0<i(J,F))M[O]=F,M[H]=J,H=O;else break e}}function t(M){return M.length===0?null:M[0]}function s(M){if(M.length===0)return null;var F=M[0],H=M.pop();if(H!==F){M[0]=H;e:for(var O=0,J=M.length,ge=J>>>1;O<ge;){var De=2*(O+1)-1,ct=M[De],Ee=De+1,se=M[Ee];if(0>i(ct,H))Ee<J&&0>i(se,ct)?(M[O]=se,M[Ee]=H,O=Ee):(M[O]=ct,M[De]=H,O=De);else if(Ee<J&&0>i(se,H))M[O]=se,M[Ee]=H,O=Ee;else break e}}return F}function i(M,F){var H=M.sortIndex-F.sortIndex;return H!==0?H:M.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],h=1,d=null,p=3,m=!1,g=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(M){for(var F=t(u);F!==null;){if(F.callback===null)s(u);else if(F.startTime<=M)s(u),F.sortIndex=F.expirationTime,e(l,F);else break;F=t(u)}}function E(M){if(y=!1,b(M),!g)if(t(l)!==null)g=!0,j(C);else{var F=t(u);F!==null&&z(E,F.startTime-M)}}function C(M,F){g=!1,y&&(y=!1,v(T),T=-1),m=!0;var H=p;try{for(b(F),d=t(l);d!==null&&(!(d.expirationTime>F)||M&&!I());){var O=d.callback;if(typeof O=="function"){d.callback=null,p=d.priorityLevel;var J=O(d.expirationTime<=F);F=n.unstable_now(),typeof J=="function"?d.callback=J:d===t(l)&&s(l),b(F)}else s(l);d=t(l)}if(d!==null)var ge=!0;else{var De=t(u);De!==null&&z(E,De.startTime-F),ge=!1}return ge}finally{d=null,p=H,m=!1}}var P=!1,N=null,T=-1,R=5,L=-1;function I(){return!(n.unstable_now()-L<R)}function ne(){if(N!==null){var M=n.unstable_now();L=M;var F=!0;try{F=N(!0,M)}finally{F?B():(P=!1,N=null)}}else P=!1}var B;if(typeof x=="function")B=function(){x(ne)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,$=Y.port2;Y.port1.onmessage=ne,B=function(){$.postMessage(null)}}else B=function(){S(ne,0)};function j(M){N=M,P||(P=!0,B())}function z(M,F){T=S(function(){M(n.unstable_now())},F)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(M){M.callback=null},n.unstable_continueExecution=function(){g||m||(g=!0,j(C))},n.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<M?Math.floor(1e3/M):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(M){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var H=p;p=F;try{return M()}finally{p=H}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(M,F){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var H=p;p=M;try{return F()}finally{p=H}},n.unstable_scheduleCallback=function(M,F,H){var O=n.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?O+H:O):H=O,M){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=H+J,M={id:h++,callback:F,priorityLevel:M,startTime:H,expirationTime:J,sortIndex:-1},H>O?(M.sortIndex=H,e(u,M),t(l)===null&&M===t(u)&&(y?(v(T),T=-1):y=!0,z(E,H-O))):(M.sortIndex=J,e(l,M),g||m||(g=!0,j(C))),M},n.unstable_shouldYield=I,n.unstable_wrapCallback=function(M){var F=p;return function(){var H=p;p=F;try{return M.apply(this,arguments)}finally{p=H}}}})(Gx);Vx.exports=Gx;var J_=Vx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z_=k,In=J_;function D(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xx=new Set,Cu={};function Lo(n,e){xc(n,e),xc(n+"Capture",e)}function xc(n,e){for(Cu[n]=e,n=0;n<e.length;n++)Xx.add(e[n])}var Ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),rg=Object.prototype.hasOwnProperty,eE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H0={},$0={};function tE(n){return rg.call($0,n)?!0:rg.call(H0,n)?!1:eE.test(n)?$0[n]=!0:(H0[n]=!0,!1)}function nE(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function sE(n,e,t,s){if(e===null||typeof e>"u"||nE(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zt(n,e,t,s,i,r,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var Ct={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ct[n]=new Zt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ct[e]=new Zt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ct[n]=new Zt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ct[n]=new Zt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ct[n]=new Zt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ct[n]=new Zt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ct[n]=new Zt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ct[n]=new Zt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ct[n]=new Zt(n,5,!1,n.toLowerCase(),null,!1,!1)});var Cv=/[\-:]([a-z])/g;function kv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Cv,kv);Ct[e]=new Zt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Cv,kv);Ct[e]=new Zt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Cv,kv);Ct[e]=new Zt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ct[n]=new Zt(n,1,!1,n.toLowerCase(),null,!1,!1)});Ct.xlinkHref=new Zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ct[n]=new Zt(n,1,!1,n.toLowerCase(),null,!0,!0)});function Nv(n,e,t,s){var i=Ct.hasOwnProperty(e)?Ct[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sE(e,t,i,s)&&(t=null),s||i===null?tE(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var Xi=Z_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Td=Symbol.for("react.element"),Go=Symbol.for("react.portal"),Xo=Symbol.for("react.fragment"),Pv=Symbol.for("react.strict_mode"),ag=Symbol.for("react.profiler"),qx=Symbol.for("react.provider"),Yx=Symbol.for("react.context"),Tv=Symbol.for("react.forward_ref"),og=Symbol.for("react.suspense"),lg=Symbol.for("react.suspense_list"),Rv=Symbol.for("react.memo"),Ji=Symbol.for("react.lazy"),Kx=Symbol.for("react.offscreen"),W0=Symbol.iterator;function jc(n){return n===null||typeof n!="object"?null:(n=W0&&n[W0]||n["@@iterator"],typeof n=="function"?n:null)}var $e=Object.assign,bm;function Yc(n){if(bm===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);bm=e&&e[1]||""}return`
`+bm+n}var Sm=!1;function Am(n,e){if(!n||Sm)return"";Sm=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),a=i.length-1,o=r.length-1;1<=a&&0<=o&&i[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==r[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==r[o]){var l=`
`+i[a].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=a&&0<=o);break}}}finally{Sm=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Yc(n):""}function iE(n){switch(n.tag){case 5:return Yc(n.type);case 16:return Yc("Lazy");case 13:return Yc("Suspense");case 19:return Yc("SuspenseList");case 0:case 2:case 15:return n=Am(n.type,!1),n;case 11:return n=Am(n.type.render,!1),n;case 1:return n=Am(n.type,!0),n;default:return""}}function cg(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Xo:return"Fragment";case Go:return"Portal";case ag:return"Profiler";case Pv:return"StrictMode";case og:return"Suspense";case lg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Yx:return(n.displayName||"Context")+".Consumer";case qx:return(n._context.displayName||"Context")+".Provider";case Tv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Rv:return e=n.displayName||null,e!==null?e:cg(n.type)||"Memo";case Ji:e=n._payload,n=n._init;try{return cg(n(e))}catch{}}return null}function rE(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cg(e);case 8:return e===Pv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Gr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Qx(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function aE(n){var e=Qx(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){s=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Rd(n){n._valueTracker||(n._valueTracker=aE(n))}function Jx(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=Qx(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function Hf(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function ug(n,e){var t=e.checked;return $e({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function V0(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Gr(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Zx(n,e){e=e.checked,e!=null&&Nv(n,"checked",e,!1)}function hg(n,e){Zx(n,e);var t=Gr(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?dg(n,e.type,t):e.hasOwnProperty("defaultValue")&&dg(n,e.type,Gr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function G0(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function dg(n,e,t){(e!=="number"||Hf(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Kc=Array.isArray;function ol(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Gr(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function fg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(D(91));return $e({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function X0(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(D(92));if(Kc(t)){if(1<t.length)throw Error(D(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Gr(t)}}function e1(n,e){var t=Gr(e.value),s=Gr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function q0(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function t1(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pg(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?t1(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Md,n1=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Md=Md||document.createElement("div"),Md.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Md.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function ku(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var mu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},oE=["Webkit","ms","Moz","O"];Object.keys(mu).forEach(function(n){oE.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),mu[e]=mu[n]})});function s1(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||mu.hasOwnProperty(n)&&mu[n]?(""+e).trim():e+"px"}function i1(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=s1(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var lE=$e({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mg(n,e){if(e){if(lE[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(D(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(D(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(D(61))}if(e.style!=null&&typeof e.style!="object")throw Error(D(62))}}function gg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yg=null;function Mv(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var vg=null,ll=null,cl=null;function Y0(n){if(n=_d(n)){if(typeof vg!="function")throw Error(D(280));var e=n.stateNode;e&&(e=Yp(e),vg(n.stateNode,n.type,e))}}function r1(n){ll?cl?cl.push(n):cl=[n]:ll=n}function a1(){if(ll){var n=ll,e=cl;if(cl=ll=null,Y0(n),e)for(n=0;n<e.length;n++)Y0(e[n])}}function o1(n,e){return n(e)}function l1(){}var _m=!1;function c1(n,e,t){if(_m)return n(e,t);_m=!0;try{return o1(n,e,t)}finally{_m=!1,(ll!==null||cl!==null)&&(l1(),a1())}}function Nu(n,e){var t=n.stateNode;if(t===null)return null;var s=Yp(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(D(231,e,typeof t));return t}var wg=!1;if(Ui)try{var Ic={};Object.defineProperty(Ic,"passive",{get:function(){wg=!0}}),window.addEventListener("test",Ic,Ic),window.removeEventListener("test",Ic,Ic)}catch{wg=!1}function cE(n,e,t,s,i,r,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var gu=!1,$f=null,Wf=!1,xg=null,uE={onError:function(n){gu=!0,$f=n}};function hE(n,e,t,s,i,r,a,o,l){gu=!1,$f=null,cE.apply(uE,arguments)}function dE(n,e,t,s,i,r,a,o,l){if(hE.apply(this,arguments),gu){if(gu){var u=$f;gu=!1,$f=null}else throw Error(D(198));Wf||(Wf=!0,xg=u)}}function jo(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function u1(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function K0(n){if(jo(n)!==n)throw Error(D(188))}function fE(n){var e=n.alternate;if(!e){if(e=jo(n),e===null)throw Error(D(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return K0(i),n;if(r===s)return K0(i),e;r=r.sibling}throw Error(D(188))}if(t.return!==s.return)t=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,s=r;break}if(o===s){a=!0,s=i,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,s=i;break}if(o===s){a=!0,s=r,t=i;break}o=o.sibling}if(!a)throw Error(D(189))}}if(t.alternate!==s)throw Error(D(190))}if(t.tag!==3)throw Error(D(188));return t.stateNode.current===t?n:e}function h1(n){return n=fE(n),n!==null?d1(n):null}function d1(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=d1(n);if(e!==null)return e;n=n.sibling}return null}var f1=In.unstable_scheduleCallback,Q0=In.unstable_cancelCallback,pE=In.unstable_shouldYield,mE=In.unstable_requestPaint,Ke=In.unstable_now,gE=In.unstable_getCurrentPriorityLevel,Lv=In.unstable_ImmediatePriority,p1=In.unstable_UserBlockingPriority,Vf=In.unstable_NormalPriority,yE=In.unstable_LowPriority,m1=In.unstable_IdlePriority,Vp=null,Zs=null;function vE(n){if(Zs&&typeof Zs.onCommitFiberRoot=="function")try{Zs.onCommitFiberRoot(Vp,n,void 0,(n.current.flags&128)===128)}catch{}}var As=Math.clz32?Math.clz32:bE,wE=Math.log,xE=Math.LN2;function bE(n){return n>>>=0,n===0?32:31-(wE(n)/xE|0)|0}var Ld=64,jd=4194304;function Qc(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Gf(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?s=Qc(o):(r&=a,r!==0&&(s=Qc(r)))}else a=t&~i,a!==0?s=Qc(a):r!==0&&(s=Qc(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-As(e),i=1<<t,s|=n[t],e&=~i;return s}function SE(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AE(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var a=31-As(r),o=1<<a,l=i[a];l===-1?(!(o&t)||o&s)&&(i[a]=SE(o,e)):l<=e&&(n.expiredLanes|=o),r&=~o}}function bg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function g1(){var n=Ld;return Ld<<=1,!(Ld&4194240)&&(Ld=64),n}function Em(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Sd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-As(e),n[e]=t}function _E(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-As(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function jv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-As(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var Se=0;function y1(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var v1,Iv,w1,x1,b1,Sg=!1,Id=[],Dr=null,Fr=null,Or=null,Pu=new Map,Tu=new Map,er=[],EE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function J0(n,e){switch(n){case"focusin":case"focusout":Dr=null;break;case"dragenter":case"dragleave":Fr=null;break;case"mouseover":case"mouseout":Or=null;break;case"pointerover":case"pointerout":Pu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tu.delete(e.pointerId)}}function Dc(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=_d(e),e!==null&&Iv(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function CE(n,e,t,s,i){switch(e){case"focusin":return Dr=Dc(Dr,n,e,t,s,i),!0;case"dragenter":return Fr=Dc(Fr,n,e,t,s,i),!0;case"mouseover":return Or=Dc(Or,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return Pu.set(r,Dc(Pu.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,Tu.set(r,Dc(Tu.get(r)||null,n,e,t,s,i)),!0}return!1}function S1(n){var e=ha(n.target);if(e!==null){var t=jo(e);if(t!==null){if(e=t.tag,e===13){if(e=u1(t),e!==null){n.blockedOn=e,b1(n.priority,function(){w1(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Zd(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Ag(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);yg=s,t.target.dispatchEvent(s),yg=null}else return e=_d(t),e!==null&&Iv(e),n.blockedOn=t,!1;e.shift()}return!0}function Z0(n,e,t){Zd(n)&&t.delete(e)}function kE(){Sg=!1,Dr!==null&&Zd(Dr)&&(Dr=null),Fr!==null&&Zd(Fr)&&(Fr=null),Or!==null&&Zd(Or)&&(Or=null),Pu.forEach(Z0),Tu.forEach(Z0)}function Fc(n,e){n.blockedOn===e&&(n.blockedOn=null,Sg||(Sg=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,kE)))}function Ru(n){function e(i){return Fc(i,n)}if(0<Id.length){Fc(Id[0],n);for(var t=1;t<Id.length;t++){var s=Id[t];s.blockedOn===n&&(s.blockedOn=null)}}for(Dr!==null&&Fc(Dr,n),Fr!==null&&Fc(Fr,n),Or!==null&&Fc(Or,n),Pu.forEach(e),Tu.forEach(e),t=0;t<er.length;t++)s=er[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<er.length&&(t=er[0],t.blockedOn===null);)S1(t),t.blockedOn===null&&er.shift()}var ul=Xi.ReactCurrentBatchConfig,Xf=!0;function NE(n,e,t,s){var i=Se,r=ul.transition;ul.transition=null;try{Se=1,Dv(n,e,t,s)}finally{Se=i,ul.transition=r}}function PE(n,e,t,s){var i=Se,r=ul.transition;ul.transition=null;try{Se=4,Dv(n,e,t,s)}finally{Se=i,ul.transition=r}}function Dv(n,e,t,s){if(Xf){var i=Ag(n,e,t,s);if(i===null)Im(n,e,s,qf,t),J0(n,s);else if(CE(i,n,e,t,s))s.stopPropagation();else if(J0(n,s),e&4&&-1<EE.indexOf(n)){for(;i!==null;){var r=_d(i);if(r!==null&&v1(r),r=Ag(n,e,t,s),r===null&&Im(n,e,s,qf,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else Im(n,e,s,null,t)}}var qf=null;function Ag(n,e,t,s){if(qf=null,n=Mv(s),n=ha(n),n!==null)if(e=jo(n),e===null)n=null;else if(t=e.tag,t===13){if(n=u1(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return qf=n,null}function A1(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gE()){case Lv:return 1;case p1:return 4;case Vf:case yE:return 16;case m1:return 536870912;default:return 16}default:return 16}}var Lr=null,Fv=null,ef=null;function _1(){if(ef)return ef;var n,e=Fv,t=e.length,s,i="value"in Lr?Lr.value:Lr.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===i[r-s];s++);return ef=i.slice(n,1<s?1-s:void 0)}function tf(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Dd(){return!0}function ew(){return!1}function Fn(n){function e(t,s,i,r,a){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Dd:ew,this.isPropagationStopped=ew,this}return $e(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Dd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Dd)},persist:function(){},isPersistent:Dd}),e}var Tc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ov=Fn(Tc),Ad=$e({},Tc,{view:0,detail:0}),TE=Fn(Ad),Cm,km,Oc,Gp=$e({},Ad,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Oc&&(Oc&&n.type==="mousemove"?(Cm=n.screenX-Oc.screenX,km=n.screenY-Oc.screenY):km=Cm=0,Oc=n),Cm)},movementY:function(n){return"movementY"in n?n.movementY:km}}),tw=Fn(Gp),RE=$e({},Gp,{dataTransfer:0}),ME=Fn(RE),LE=$e({},Ad,{relatedTarget:0}),Nm=Fn(LE),jE=$e({},Tc,{animationName:0,elapsedTime:0,pseudoElement:0}),IE=Fn(jE),DE=$e({},Tc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),FE=Fn(DE),OE=$e({},Tc,{data:0}),nw=Fn(OE),zE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},UE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HE(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=UE[n])?!!e[n]:!1}function zv(){return HE}var $E=$e({},Ad,{key:function(n){if(n.key){var e=zE[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=tf(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?BE[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zv,charCode:function(n){return n.type==="keypress"?tf(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?tf(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),WE=Fn($E),VE=$e({},Gp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sw=Fn(VE),GE=$e({},Ad,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zv}),XE=Fn(GE),qE=$e({},Tc,{propertyName:0,elapsedTime:0,pseudoElement:0}),YE=Fn(qE),KE=$e({},Gp,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),QE=Fn(KE),JE=[9,13,27,32],Bv=Ui&&"CompositionEvent"in window,yu=null;Ui&&"documentMode"in document&&(yu=document.documentMode);var ZE=Ui&&"TextEvent"in window&&!yu,E1=Ui&&(!Bv||yu&&8<yu&&11>=yu),iw=" ",rw=!1;function C1(n,e){switch(n){case"keyup":return JE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function k1(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var qo=!1;function eC(n,e){switch(n){case"compositionend":return k1(e);case"keypress":return e.which!==32?null:(rw=!0,iw);case"textInput":return n=e.data,n===iw&&rw?null:n;default:return null}}function tC(n,e){if(qo)return n==="compositionend"||!Bv&&C1(n,e)?(n=_1(),ef=Fv=Lr=null,qo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return E1&&e.locale!=="ko"?null:e.data;default:return null}}var nC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function aw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!nC[n.type]:e==="textarea"}function N1(n,e,t,s){r1(s),e=Yf(e,"onChange"),0<e.length&&(t=new Ov("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var vu=null,Mu=null;function sC(n){z1(n,0)}function Xp(n){var e=Qo(n);if(Jx(e))return n}function iC(n,e){if(n==="change")return e}var P1=!1;if(Ui){var Pm;if(Ui){var Tm="oninput"in document;if(!Tm){var ow=document.createElement("div");ow.setAttribute("oninput","return;"),Tm=typeof ow.oninput=="function"}Pm=Tm}else Pm=!1;P1=Pm&&(!document.documentMode||9<document.documentMode)}function lw(){vu&&(vu.detachEvent("onpropertychange",T1),Mu=vu=null)}function T1(n){if(n.propertyName==="value"&&Xp(Mu)){var e=[];N1(e,Mu,n,Mv(n)),c1(sC,e)}}function rC(n,e,t){n==="focusin"?(lw(),vu=e,Mu=t,vu.attachEvent("onpropertychange",T1)):n==="focusout"&&lw()}function aC(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Xp(Mu)}function oC(n,e){if(n==="click")return Xp(e)}function lC(n,e){if(n==="input"||n==="change")return Xp(e)}function cC(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Es=typeof Object.is=="function"?Object.is:cC;function Lu(n,e){if(Es(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!rg.call(e,i)||!Es(n[i],e[i]))return!1}return!0}function cw(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function uw(n,e){var t=cw(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=cw(t)}}function R1(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?R1(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function M1(){for(var n=window,e=Hf();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Hf(n.document)}return e}function Uv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function uC(n){var e=M1(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&R1(t.ownerDocument.documentElement,t)){if(s!==null&&Uv(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=uw(t,r);var a=uw(t,s);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var hC=Ui&&"documentMode"in document&&11>=document.documentMode,Yo=null,_g=null,wu=null,Eg=!1;function hw(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Eg||Yo==null||Yo!==Hf(s)||(s=Yo,"selectionStart"in s&&Uv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),wu&&Lu(wu,s)||(wu=s,s=Yf(_g,"onSelect"),0<s.length&&(e=new Ov("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Yo)))}function Fd(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Ko={animationend:Fd("Animation","AnimationEnd"),animationiteration:Fd("Animation","AnimationIteration"),animationstart:Fd("Animation","AnimationStart"),transitionend:Fd("Transition","TransitionEnd")},Rm={},L1={};Ui&&(L1=document.createElement("div").style,"AnimationEvent"in window||(delete Ko.animationend.animation,delete Ko.animationiteration.animation,delete Ko.animationstart.animation),"TransitionEvent"in window||delete Ko.transitionend.transition);function qp(n){if(Rm[n])return Rm[n];if(!Ko[n])return n;var e=Ko[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in L1)return Rm[n]=e[t];return n}var j1=qp("animationend"),I1=qp("animationiteration"),D1=qp("animationstart"),F1=qp("transitionend"),O1=new Map,dw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qr(n,e){O1.set(n,e),Lo(e,[n])}for(var Mm=0;Mm<dw.length;Mm++){var Lm=dw[Mm],dC=Lm.toLowerCase(),fC=Lm[0].toUpperCase()+Lm.slice(1);Qr(dC,"on"+fC)}Qr(j1,"onAnimationEnd");Qr(I1,"onAnimationIteration");Qr(D1,"onAnimationStart");Qr("dblclick","onDoubleClick");Qr("focusin","onFocus");Qr("focusout","onBlur");Qr(F1,"onTransitionEnd");xc("onMouseEnter",["mouseout","mouseover"]);xc("onMouseLeave",["mouseout","mouseover"]);xc("onPointerEnter",["pointerout","pointerover"]);xc("onPointerLeave",["pointerout","pointerover"]);Lo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Lo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Lo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Lo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Lo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Lo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pC=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jc));function fw(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,dE(s,e,void 0,n),n.currentTarget=null}function z1(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==r&&i.isPropagationStopped())break e;fw(i,o,u),r=l}else for(a=0;a<s.length;a++){if(o=s[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==r&&i.isPropagationStopped())break e;fw(i,o,u),r=l}}}if(Wf)throw n=xg,Wf=!1,xg=null,n}function Pe(n,e){var t=e[Tg];t===void 0&&(t=e[Tg]=new Set);var s=n+"__bubble";t.has(s)||(B1(e,n,2,!1),t.add(s))}function jm(n,e,t){var s=0;e&&(s|=4),B1(t,n,s,e)}var Od="_reactListening"+Math.random().toString(36).slice(2);function ju(n){if(!n[Od]){n[Od]=!0,Xx.forEach(function(t){t!=="selectionchange"&&(pC.has(t)||jm(t,!1,n),jm(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Od]||(e[Od]=!0,jm("selectionchange",!1,e))}}function B1(n,e,t,s){switch(A1(e)){case 1:var i=NE;break;case 4:i=PE;break;default:i=Dv}t=i.bind(null,e,t,n),i=void 0,!wg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Im(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=s.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=ha(o),a===null)return;if(l=a.tag,l===5||l===6){s=r=a;continue e}o=o.parentNode}}s=s.return}c1(function(){var u=r,h=Mv(t),d=[];e:{var p=O1.get(n);if(p!==void 0){var m=Ov,g=n;switch(n){case"keypress":if(tf(t)===0)break e;case"keydown":case"keyup":m=WE;break;case"focusin":g="focus",m=Nm;break;case"focusout":g="blur",m=Nm;break;case"beforeblur":case"afterblur":m=Nm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=tw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ME;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=XE;break;case j1:case I1:case D1:m=IE;break;case F1:m=YE;break;case"scroll":m=TE;break;case"wheel":m=QE;break;case"copy":case"cut":case"paste":m=FE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=sw}var y=(e&4)!==0,S=!y&&n==="scroll",v=y?p!==null?p+"Capture":null:p;y=[];for(var x=u,b;x!==null;){b=x;var E=b.stateNode;if(b.tag===5&&E!==null&&(b=E,v!==null&&(E=Nu(x,v),E!=null&&y.push(Iu(x,E,b)))),S)break;x=x.return}0<y.length&&(p=new m(p,g,null,t,h),d.push({event:p,listeners:y}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",p&&t!==yg&&(g=t.relatedTarget||t.fromElement)&&(ha(g)||g[Hi]))break e;if((m||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=t.relatedTarget||t.toElement,m=u,g=g?ha(g):null,g!==null&&(S=jo(g),g!==S||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(y=tw,E="onMouseLeave",v="onMouseEnter",x="mouse",(n==="pointerout"||n==="pointerover")&&(y=sw,E="onPointerLeave",v="onPointerEnter",x="pointer"),S=m==null?p:Qo(m),b=g==null?p:Qo(g),p=new y(E,x+"leave",m,t,h),p.target=S,p.relatedTarget=b,E=null,ha(h)===u&&(y=new y(v,x+"enter",g,t,h),y.target=b,y.relatedTarget=S,E=y),S=E,m&&g)t:{for(y=m,v=g,x=0,b=y;b;b=Fo(b))x++;for(b=0,E=v;E;E=Fo(E))b++;for(;0<x-b;)y=Fo(y),x--;for(;0<b-x;)v=Fo(v),b--;for(;x--;){if(y===v||v!==null&&y===v.alternate)break t;y=Fo(y),v=Fo(v)}y=null}else y=null;m!==null&&pw(d,p,m,y,!1),g!==null&&S!==null&&pw(d,S,g,y,!0)}}e:{if(p=u?Qo(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var C=iC;else if(aw(p))if(P1)C=lC;else{C=aC;var P=rC}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=oC);if(C&&(C=C(n,u))){N1(d,C,t,h);break e}P&&P(n,p,u),n==="focusout"&&(P=p._wrapperState)&&P.controlled&&p.type==="number"&&dg(p,"number",p.value)}switch(P=u?Qo(u):window,n){case"focusin":(aw(P)||P.contentEditable==="true")&&(Yo=P,_g=u,wu=null);break;case"focusout":wu=_g=Yo=null;break;case"mousedown":Eg=!0;break;case"contextmenu":case"mouseup":case"dragend":Eg=!1,hw(d,t,h);break;case"selectionchange":if(hC)break;case"keydown":case"keyup":hw(d,t,h)}var N;if(Bv)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else qo?C1(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(E1&&t.locale!=="ko"&&(qo||T!=="onCompositionStart"?T==="onCompositionEnd"&&qo&&(N=_1()):(Lr=h,Fv="value"in Lr?Lr.value:Lr.textContent,qo=!0)),P=Yf(u,T),0<P.length&&(T=new nw(T,n,null,t,h),d.push({event:T,listeners:P}),N?T.data=N:(N=k1(t),N!==null&&(T.data=N)))),(N=ZE?eC(n,t):tC(n,t))&&(u=Yf(u,"onBeforeInput"),0<u.length&&(h=new nw("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=N))}z1(d,e)})}function Iu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Yf(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=Nu(n,t),r!=null&&s.unshift(Iu(n,r,i)),r=Nu(n,e),r!=null&&s.push(Iu(n,r,i))),n=n.return}return s}function Fo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function pw(n,e,t,s,i){for(var r=e._reactName,a=[];t!==null&&t!==s;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===s)break;o.tag===5&&u!==null&&(o=u,i?(l=Nu(t,r),l!=null&&a.unshift(Iu(t,l,o))):i||(l=Nu(t,r),l!=null&&a.push(Iu(t,l,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var mC=/\r\n?/g,gC=/\u0000|\uFFFD/g;function mw(n){return(typeof n=="string"?n:""+n).replace(mC,`
`).replace(gC,"")}function zd(n,e,t){if(e=mw(e),mw(n)!==e&&t)throw Error(D(425))}function Kf(){}var Cg=null,kg=null;function Ng(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Pg=typeof setTimeout=="function"?setTimeout:void 0,yC=typeof clearTimeout=="function"?clearTimeout:void 0,gw=typeof Promise=="function"?Promise:void 0,vC=typeof queueMicrotask=="function"?queueMicrotask:typeof gw<"u"?function(n){return gw.resolve(null).then(n).catch(wC)}:Pg;function wC(n){setTimeout(function(){throw n})}function Dm(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Ru(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Ru(e)}function zr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function yw(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Rc=Math.random().toString(36).slice(2),Qs="__reactFiber$"+Rc,Du="__reactProps$"+Rc,Hi="__reactContainer$"+Rc,Tg="__reactEvents$"+Rc,xC="__reactListeners$"+Rc,bC="__reactHandles$"+Rc;function ha(n){var e=n[Qs];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Hi]||t[Qs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=yw(n);n!==null;){if(t=n[Qs])return t;n=yw(n)}return e}n=t,t=n.parentNode}return null}function _d(n){return n=n[Qs]||n[Hi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Qo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(D(33))}function Yp(n){return n[Du]||null}var Rg=[],Jo=-1;function Jr(n){return{current:n}}function Re(n){0>Jo||(n.current=Rg[Jo],Rg[Jo]=null,Jo--)}function Ne(n,e){Jo++,Rg[Jo]=n.current,n.current=e}var Xr={},zt=Jr(Xr),hn=Jr(!1),bo=Xr;function bc(n,e){var t=n.type.contextTypes;if(!t)return Xr;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function dn(n){return n=n.childContextTypes,n!=null}function Qf(){Re(hn),Re(zt)}function vw(n,e,t){if(zt.current!==Xr)throw Error(D(168));Ne(zt,e),Ne(hn,t)}function U1(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(D(108,rE(n)||"Unknown",i));return $e({},t,s)}function Jf(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Xr,bo=zt.current,Ne(zt,n),Ne(hn,hn.current),!0}function ww(n,e,t){var s=n.stateNode;if(!s)throw Error(D(169));t?(n=U1(n,e,bo),s.__reactInternalMemoizedMergedChildContext=n,Re(hn),Re(zt),Ne(zt,n)):Re(hn),Ne(hn,t)}var ci=null,Kp=!1,Fm=!1;function H1(n){ci===null?ci=[n]:ci.push(n)}function SC(n){Kp=!0,H1(n)}function Zr(){if(!Fm&&ci!==null){Fm=!0;var n=0,e=Se;try{var t=ci;for(Se=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}ci=null,Kp=!1}catch(i){throw ci!==null&&(ci=ci.slice(n+1)),f1(Lv,Zr),i}finally{Se=e,Fm=!1}}return null}var Zo=[],el=0,Zf=null,ep=0,qn=[],Yn=0,So=null,Di=1,Fi="";function sa(n,e){Zo[el++]=ep,Zo[el++]=Zf,Zf=n,ep=e}function $1(n,e,t){qn[Yn++]=Di,qn[Yn++]=Fi,qn[Yn++]=So,So=n;var s=Di;n=Fi;var i=32-As(s)-1;s&=~(1<<i),t+=1;var r=32-As(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Di=1<<32-As(e)+i|t<<i|s,Fi=r+n}else Di=1<<r|t<<i|s,Fi=n}function Hv(n){n.return!==null&&(sa(n,1),$1(n,1,0))}function $v(n){for(;n===Zf;)Zf=Zo[--el],Zo[el]=null,ep=Zo[--el],Zo[el]=null;for(;n===So;)So=qn[--Yn],qn[Yn]=null,Fi=qn[--Yn],qn[Yn]=null,Di=qn[--Yn],qn[Yn]=null}var Ln=null,Mn=null,Ie=!1,bs=null;function W1(n,e){var t=Jn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function xw(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ln=n,Mn=zr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ln=n,Mn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=So!==null?{id:Di,overflow:Fi}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Jn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ln=n,Mn=null,!0):!1;default:return!1}}function Mg(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Lg(n){if(Ie){var e=Mn;if(e){var t=e;if(!xw(n,e)){if(Mg(n))throw Error(D(418));e=zr(t.nextSibling);var s=Ln;e&&xw(n,e)?W1(s,t):(n.flags=n.flags&-4097|2,Ie=!1,Ln=n)}}else{if(Mg(n))throw Error(D(418));n.flags=n.flags&-4097|2,Ie=!1,Ln=n}}}function bw(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ln=n}function Bd(n){if(n!==Ln)return!1;if(!Ie)return bw(n),Ie=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Ng(n.type,n.memoizedProps)),e&&(e=Mn)){if(Mg(n))throw V1(),Error(D(418));for(;e;)W1(n,e),e=zr(e.nextSibling)}if(bw(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(D(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Mn=zr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Mn=null}}else Mn=Ln?zr(n.stateNode.nextSibling):null;return!0}function V1(){for(var n=Mn;n;)n=zr(n.nextSibling)}function Sc(){Mn=Ln=null,Ie=!1}function Wv(n){bs===null?bs=[n]:bs.push(n)}var AC=Xi.ReactCurrentBatchConfig;function zc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(D(309));var s=t.stateNode}if(!s)throw Error(D(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(a){var o=i.refs;a===null?delete o[r]:o[r]=a},e._stringRef=r,e)}if(typeof n!="string")throw Error(D(284));if(!t._owner)throw Error(D(290,n))}return n}function Ud(n,e){throw n=Object.prototype.toString.call(e),Error(D(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Sw(n){var e=n._init;return e(n._payload)}function G1(n){function e(v,x){if(n){var b=v.deletions;b===null?(v.deletions=[x],v.flags|=16):b.push(x)}}function t(v,x){if(!n)return null;for(;x!==null;)e(v,x),x=x.sibling;return null}function s(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=$r(v,x),v.index=0,v.sibling=null,v}function r(v,x,b){return v.index=b,n?(b=v.alternate,b!==null?(b=b.index,b<x?(v.flags|=2,x):b):(v.flags|=2,x)):(v.flags|=1048576,x)}function a(v){return n&&v.alternate===null&&(v.flags|=2),v}function o(v,x,b,E){return x===null||x.tag!==6?(x=Wm(b,v.mode,E),x.return=v,x):(x=i(x,b),x.return=v,x)}function l(v,x,b,E){var C=b.type;return C===Xo?h(v,x,b.props.children,E,b.key):x!==null&&(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ji&&Sw(C)===x.type)?(E=i(x,b.props),E.ref=zc(v,x,b),E.return=v,E):(E=cf(b.type,b.key,b.props,null,v.mode,E),E.ref=zc(v,x,b),E.return=v,E)}function u(v,x,b,E){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=Vm(b,v.mode,E),x.return=v,x):(x=i(x,b.children||[]),x.return=v,x)}function h(v,x,b,E,C){return x===null||x.tag!==7?(x=xo(b,v.mode,E,C),x.return=v,x):(x=i(x,b),x.return=v,x)}function d(v,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Wm(""+x,v.mode,b),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Td:return b=cf(x.type,x.key,x.props,null,v.mode,b),b.ref=zc(v,null,x),b.return=v,b;case Go:return x=Vm(x,v.mode,b),x.return=v,x;case Ji:var E=x._init;return d(v,E(x._payload),b)}if(Kc(x)||jc(x))return x=xo(x,v.mode,b,null),x.return=v,x;Ud(v,x)}return null}function p(v,x,b,E){var C=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return C!==null?null:o(v,x,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Td:return b.key===C?l(v,x,b,E):null;case Go:return b.key===C?u(v,x,b,E):null;case Ji:return C=b._init,p(v,x,C(b._payload),E)}if(Kc(b)||jc(b))return C!==null?null:h(v,x,b,E,null);Ud(v,b)}return null}function m(v,x,b,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(b)||null,o(x,v,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Td:return v=v.get(E.key===null?b:E.key)||null,l(x,v,E,C);case Go:return v=v.get(E.key===null?b:E.key)||null,u(x,v,E,C);case Ji:var P=E._init;return m(v,x,b,P(E._payload),C)}if(Kc(E)||jc(E))return v=v.get(b)||null,h(x,v,E,C,null);Ud(x,E)}return null}function g(v,x,b,E){for(var C=null,P=null,N=x,T=x=0,R=null;N!==null&&T<b.length;T++){N.index>T?(R=N,N=null):R=N.sibling;var L=p(v,N,b[T],E);if(L===null){N===null&&(N=R);break}n&&N&&L.alternate===null&&e(v,N),x=r(L,x,T),P===null?C=L:P.sibling=L,P=L,N=R}if(T===b.length)return t(v,N),Ie&&sa(v,T),C;if(N===null){for(;T<b.length;T++)N=d(v,b[T],E),N!==null&&(x=r(N,x,T),P===null?C=N:P.sibling=N,P=N);return Ie&&sa(v,T),C}for(N=s(v,N);T<b.length;T++)R=m(N,v,T,b[T],E),R!==null&&(n&&R.alternate!==null&&N.delete(R.key===null?T:R.key),x=r(R,x,T),P===null?C=R:P.sibling=R,P=R);return n&&N.forEach(function(I){return e(v,I)}),Ie&&sa(v,T),C}function y(v,x,b,E){var C=jc(b);if(typeof C!="function")throw Error(D(150));if(b=C.call(b),b==null)throw Error(D(151));for(var P=C=null,N=x,T=x=0,R=null,L=b.next();N!==null&&!L.done;T++,L=b.next()){N.index>T?(R=N,N=null):R=N.sibling;var I=p(v,N,L.value,E);if(I===null){N===null&&(N=R);break}n&&N&&I.alternate===null&&e(v,N),x=r(I,x,T),P===null?C=I:P.sibling=I,P=I,N=R}if(L.done)return t(v,N),Ie&&sa(v,T),C;if(N===null){for(;!L.done;T++,L=b.next())L=d(v,L.value,E),L!==null&&(x=r(L,x,T),P===null?C=L:P.sibling=L,P=L);return Ie&&sa(v,T),C}for(N=s(v,N);!L.done;T++,L=b.next())L=m(N,v,T,L.value,E),L!==null&&(n&&L.alternate!==null&&N.delete(L.key===null?T:L.key),x=r(L,x,T),P===null?C=L:P.sibling=L,P=L);return n&&N.forEach(function(ne){return e(v,ne)}),Ie&&sa(v,T),C}function S(v,x,b,E){if(typeof b=="object"&&b!==null&&b.type===Xo&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Td:e:{for(var C=b.key,P=x;P!==null;){if(P.key===C){if(C=b.type,C===Xo){if(P.tag===7){t(v,P.sibling),x=i(P,b.props.children),x.return=v,v=x;break e}}else if(P.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ji&&Sw(C)===P.type){t(v,P.sibling),x=i(P,b.props),x.ref=zc(v,P,b),x.return=v,v=x;break e}t(v,P);break}else e(v,P);P=P.sibling}b.type===Xo?(x=xo(b.props.children,v.mode,E,b.key),x.return=v,v=x):(E=cf(b.type,b.key,b.props,null,v.mode,E),E.ref=zc(v,x,b),E.return=v,v=E)}return a(v);case Go:e:{for(P=b.key;x!==null;){if(x.key===P)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){t(v,x.sibling),x=i(x,b.children||[]),x.return=v,v=x;break e}else{t(v,x);break}else e(v,x);x=x.sibling}x=Vm(b,v.mode,E),x.return=v,v=x}return a(v);case Ji:return P=b._init,S(v,x,P(b._payload),E)}if(Kc(b))return g(v,x,b,E);if(jc(b))return y(v,x,b,E);Ud(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(t(v,x.sibling),x=i(x,b),x.return=v,v=x):(t(v,x),x=Wm(b,v.mode,E),x.return=v,v=x),a(v)):t(v,x)}return S}var Ac=G1(!0),X1=G1(!1),tp=Jr(null),np=null,tl=null,Vv=null;function Gv(){Vv=tl=np=null}function Xv(n){var e=tp.current;Re(tp),n._currentValue=e}function jg(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function hl(n,e){np=n,Vv=tl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(un=!0),n.firstContext=null)}function ts(n){var e=n._currentValue;if(Vv!==n)if(n={context:n,memoizedValue:e,next:null},tl===null){if(np===null)throw Error(D(308));tl=n,np.dependencies={lanes:0,firstContext:n}}else tl=tl.next=n;return e}var da=null;function qv(n){da===null?da=[n]:da.push(n)}function q1(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,qv(e)):(t.next=i.next,i.next=t),e.interleaved=t,$i(n,s)}function $i(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Zi=!1;function Yv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Y1(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Oi(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Br(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,pe&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,$i(n,t)}return i=s.interleaved,i===null?(e.next=e,qv(s)):(e.next=i.next,i.next=e),s.interleaved=e,$i(n,t)}function nf(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,jv(n,t)}}function Aw(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function sp(n,e,t,s){var i=n.updateQueue;Zi=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?r=u:a.next=u,a=l;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=l))}if(r!==null){var d=i.baseState;a=0,h=u=l=null,o=r;do{var p=o.lane,m=o.eventTime;if((s&p)===p){h!==null&&(h=h.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=n,y=o;switch(p=e,m=t,y.tag){case 1:if(g=y.payload,typeof g=="function"){d=g.call(m,d,p);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,p=typeof g=="function"?g.call(m,d,p):g,p==null)break e;d=$e({},d,p);break e;case 2:Zi=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(u=h=m,l=d):h=h.next=m,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(h===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);_o|=a,n.lanes=a,n.memoizedState=d}}function _w(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(D(191,i));i.call(s)}}}var Ed={},ei=Jr(Ed),Fu=Jr(Ed),Ou=Jr(Ed);function fa(n){if(n===Ed)throw Error(D(174));return n}function Kv(n,e){switch(Ne(Ou,e),Ne(Fu,n),Ne(ei,Ed),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pg(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=pg(e,n)}Re(ei),Ne(ei,e)}function _c(){Re(ei),Re(Fu),Re(Ou)}function K1(n){fa(Ou.current);var e=fa(ei.current),t=pg(e,n.type);e!==t&&(Ne(Fu,n),Ne(ei,t))}function Qv(n){Fu.current===n&&(Re(ei),Re(Fu))}var ze=Jr(0);function ip(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Om=[];function Jv(){for(var n=0;n<Om.length;n++)Om[n]._workInProgressVersionPrimary=null;Om.length=0}var sf=Xi.ReactCurrentDispatcher,zm=Xi.ReactCurrentBatchConfig,Ao=0,Ue=null,at=null,gt=null,rp=!1,xu=!1,zu=0,_C=0;function kt(){throw Error(D(321))}function Zv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Es(n[t],e[t]))return!1;return!0}function e0(n,e,t,s,i,r){if(Ao=r,Ue=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,sf.current=n===null||n.memoizedState===null?NC:PC,n=t(s,i),xu){r=0;do{if(xu=!1,zu=0,25<=r)throw Error(D(301));r+=1,gt=at=null,e.updateQueue=null,sf.current=TC,n=t(s,i)}while(xu)}if(sf.current=ap,e=at!==null&&at.next!==null,Ao=0,gt=at=Ue=null,rp=!1,e)throw Error(D(300));return n}function t0(){var n=zu!==0;return zu=0,n}function Ls(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?Ue.memoizedState=gt=n:gt=gt.next=n,gt}function ns(){if(at===null){var n=Ue.alternate;n=n!==null?n.memoizedState:null}else n=at.next;var e=gt===null?Ue.memoizedState:gt.next;if(e!==null)gt=e,at=n;else{if(n===null)throw Error(D(310));at=n,n={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},gt===null?Ue.memoizedState=gt=n:gt=gt.next=n}return gt}function Bu(n,e){return typeof e=="function"?e(n):e}function Bm(n){var e=ns(),t=e.queue;if(t===null)throw Error(D(311));t.lastRenderedReducer=n;var s=at,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var o=a=null,l=null,u=r;do{var h=u.lane;if((Ao&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,a=s):l=l.next=d,Ue.lanes|=h,_o|=h}u=u.next}while(u!==null&&u!==r);l===null?a=s:l.next=o,Es(s,e.memoizedState)||(un=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=l,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,Ue.lanes|=r,_o|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Um(n){var e=ns(),t=e.queue;if(t===null)throw Error(D(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do r=n(r,a.action),a=a.next;while(a!==i);Es(r,e.memoizedState)||(un=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function Q1(){}function J1(n,e){var t=Ue,s=ns(),i=e(),r=!Es(s.memoizedState,i);if(r&&(s.memoizedState=i,un=!0),s=s.queue,n0(tb.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||gt!==null&&gt.memoizedState.tag&1){if(t.flags|=2048,Uu(9,eb.bind(null,t,s,i,e),void 0,null),yt===null)throw Error(D(349));Ao&30||Z1(t,e,i)}return i}function Z1(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function eb(n,e,t,s){e.value=t,e.getSnapshot=s,nb(e)&&sb(n)}function tb(n,e,t){return t(function(){nb(e)&&sb(n)})}function nb(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Es(n,t)}catch{return!0}}function sb(n){var e=$i(n,1);e!==null&&_s(e,n,1,-1)}function Ew(n){var e=Ls();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bu,lastRenderedState:n},e.queue=n,n=n.dispatch=kC.bind(null,Ue,n),[e.memoizedState,n]}function Uu(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=Ue.updateQueue,e===null?(e={lastEffect:null,stores:null},Ue.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function ib(){return ns().memoizedState}function rf(n,e,t,s){var i=Ls();Ue.flags|=n,i.memoizedState=Uu(1|e,t,void 0,s===void 0?null:s)}function Qp(n,e,t,s){var i=ns();s=s===void 0?null:s;var r=void 0;if(at!==null){var a=at.memoizedState;if(r=a.destroy,s!==null&&Zv(s,a.deps)){i.memoizedState=Uu(e,t,r,s);return}}Ue.flags|=n,i.memoizedState=Uu(1|e,t,r,s)}function Cw(n,e){return rf(8390656,8,n,e)}function n0(n,e){return Qp(2048,8,n,e)}function rb(n,e){return Qp(4,2,n,e)}function ab(n,e){return Qp(4,4,n,e)}function ob(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function lb(n,e,t){return t=t!=null?t.concat([n]):null,Qp(4,4,ob.bind(null,e,n),t)}function s0(){}function cb(n,e){var t=ns();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Zv(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function ub(n,e){var t=ns();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Zv(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function hb(n,e,t){return Ao&21?(Es(t,e)||(t=g1(),Ue.lanes|=t,_o|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,un=!0),n.memoizedState=t)}function EC(n,e){var t=Se;Se=t!==0&&4>t?t:4,n(!0);var s=zm.transition;zm.transition={};try{n(!1),e()}finally{Se=t,zm.transition=s}}function db(){return ns().memoizedState}function CC(n,e,t){var s=Hr(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},fb(n))pb(e,t);else if(t=q1(n,e,t,s),t!==null){var i=qt();_s(t,n,s,i),mb(t,e,s)}}function kC(n,e,t){var s=Hr(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(fb(n))pb(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(i.hasEagerState=!0,i.eagerState=o,Es(o,a)){var l=e.interleaved;l===null?(i.next=i,qv(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=q1(n,e,i,s),t!==null&&(i=qt(),_s(t,n,s,i),mb(t,e,s))}}function fb(n){var e=n.alternate;return n===Ue||e!==null&&e===Ue}function pb(n,e){xu=rp=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function mb(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,jv(n,t)}}var ap={readContext:ts,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},NC={readContext:ts,useCallback:function(n,e){return Ls().memoizedState=[n,e===void 0?null:e],n},useContext:ts,useEffect:Cw,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,rf(4194308,4,ob.bind(null,e,n),t)},useLayoutEffect:function(n,e){return rf(4194308,4,n,e)},useInsertionEffect:function(n,e){return rf(4,2,n,e)},useMemo:function(n,e){var t=Ls();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=Ls();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=CC.bind(null,Ue,n),[s.memoizedState,n]},useRef:function(n){var e=Ls();return n={current:n},e.memoizedState=n},useState:Ew,useDebugValue:s0,useDeferredValue:function(n){return Ls().memoizedState=n},useTransition:function(){var n=Ew(!1),e=n[0];return n=EC.bind(null,n[1]),Ls().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=Ue,i=Ls();if(Ie){if(t===void 0)throw Error(D(407));t=t()}else{if(t=e(),yt===null)throw Error(D(349));Ao&30||Z1(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,Cw(tb.bind(null,s,r,n),[n]),s.flags|=2048,Uu(9,eb.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=Ls(),e=yt.identifierPrefix;if(Ie){var t=Fi,s=Di;t=(s&~(1<<32-As(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=zu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=_C++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},PC={readContext:ts,useCallback:cb,useContext:ts,useEffect:n0,useImperativeHandle:lb,useInsertionEffect:rb,useLayoutEffect:ab,useMemo:ub,useReducer:Bm,useRef:ib,useState:function(){return Bm(Bu)},useDebugValue:s0,useDeferredValue:function(n){var e=ns();return hb(e,at.memoizedState,n)},useTransition:function(){var n=Bm(Bu)[0],e=ns().memoizedState;return[n,e]},useMutableSource:Q1,useSyncExternalStore:J1,useId:db,unstable_isNewReconciler:!1},TC={readContext:ts,useCallback:cb,useContext:ts,useEffect:n0,useImperativeHandle:lb,useInsertionEffect:rb,useLayoutEffect:ab,useMemo:ub,useReducer:Um,useRef:ib,useState:function(){return Um(Bu)},useDebugValue:s0,useDeferredValue:function(n){var e=ns();return at===null?e.memoizedState=n:hb(e,at.memoizedState,n)},useTransition:function(){var n=Um(Bu)[0],e=ns().memoizedState;return[n,e]},useMutableSource:Q1,useSyncExternalStore:J1,useId:db,unstable_isNewReconciler:!1};function as(n,e){if(n&&n.defaultProps){e=$e({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Ig(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:$e({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Jp={isMounted:function(n){return(n=n._reactInternals)?jo(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=qt(),i=Hr(n),r=Oi(s,i);r.payload=e,t!=null&&(r.callback=t),e=Br(n,r,i),e!==null&&(_s(e,n,i,s),nf(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=qt(),i=Hr(n),r=Oi(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Br(n,r,i),e!==null&&(_s(e,n,i,s),nf(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=qt(),s=Hr(n),i=Oi(t,s);i.tag=2,e!=null&&(i.callback=e),e=Br(n,i,s),e!==null&&(_s(e,n,s,t),nf(e,n,s))}};function kw(n,e,t,s,i,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!Lu(t,s)||!Lu(i,r):!0}function gb(n,e,t){var s=!1,i=Xr,r=e.contextType;return typeof r=="object"&&r!==null?r=ts(r):(i=dn(e)?bo:zt.current,s=e.contextTypes,r=(s=s!=null)?bc(n,i):Xr),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Jp,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function Nw(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&Jp.enqueueReplaceState(e,e.state,null)}function Dg(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},Yv(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=ts(r):(r=dn(e)?bo:zt.current,i.context=bc(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(Ig(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Jp.enqueueReplaceState(i,i.state,null),sp(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Ec(n,e){try{var t="",s=e;do t+=iE(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function Hm(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Fg(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var RC=typeof WeakMap=="function"?WeakMap:Map;function yb(n,e,t){t=Oi(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){lp||(lp=!0,Xg=s),Fg(n,e)},t}function vb(n,e,t){t=Oi(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){Fg(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){Fg(n,e),typeof s!="function"&&(Ur===null?Ur=new Set([this]):Ur.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function Pw(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new RC;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=VC.bind(null,n,e,t),e.then(n,n))}function Tw(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Rw(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Oi(-1,1),e.tag=2,Br(t,e,1))),t.lanes|=1),n)}var MC=Xi.ReactCurrentOwner,un=!1;function Xt(n,e,t,s){e.child=n===null?X1(e,null,t,s):Ac(e,n.child,t,s)}function Mw(n,e,t,s,i){t=t.render;var r=e.ref;return hl(e,i),s=e0(n,e,t,s,r,i),t=t0(),n!==null&&!un?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Wi(n,e,i)):(Ie&&t&&Hv(e),e.flags|=1,Xt(n,e,s,i),e.child)}function Lw(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!h0(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,wb(n,e,r,s,i)):(n=cf(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Lu,t(a,s)&&n.ref===e.ref)return Wi(n,e,i)}return e.flags|=1,n=$r(r,s),n.ref=e.ref,n.return=e,e.child=n}function wb(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Lu(r,s)&&n.ref===e.ref)if(un=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(un=!0);else return e.lanes=n.lanes,Wi(n,e,i)}return Og(n,e,t,s,i)}function xb(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(sl,Pn),Pn|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ne(sl,Pn),Pn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,Ne(sl,Pn),Pn|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,Ne(sl,Pn),Pn|=s;return Xt(n,e,i,t),e.child}function bb(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Og(n,e,t,s,i){var r=dn(t)?bo:zt.current;return r=bc(e,r),hl(e,i),t=e0(n,e,t,s,r,i),s=t0(),n!==null&&!un?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Wi(n,e,i)):(Ie&&s&&Hv(e),e.flags|=1,Xt(n,e,t,i),e.child)}function jw(n,e,t,s,i){if(dn(t)){var r=!0;Jf(e)}else r=!1;if(hl(e,i),e.stateNode===null)af(n,e),gb(e,t,s),Dg(e,t,s,i),s=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=ts(u):(u=dn(t)?bo:zt.current,u=bc(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==s||l!==u)&&Nw(e,a,s,u),Zi=!1;var p=e.memoizedState;a.state=p,sp(e,s,a,i),l=e.memoizedState,o!==s||p!==l||hn.current||Zi?(typeof h=="function"&&(Ig(e,t,h,s),l=e.memoizedState),(o=Zi||kw(e,t,o,s,p,l,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),a.props=s,a.state=l,a.context=u,s=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,Y1(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:as(e.type,o),a.props=u,d=e.pendingProps,p=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=ts(l):(l=dn(t)?bo:zt.current,l=bc(e,l));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||p!==l)&&Nw(e,a,s,l),Zi=!1,p=e.memoizedState,a.state=p,sp(e,s,a,i);var g=e.memoizedState;o!==d||p!==g||hn.current||Zi?(typeof m=="function"&&(Ig(e,t,m,s),g=e.memoizedState),(u=Zi||kw(e,t,u,s,p,g,l)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,g,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=g),a.props=s,a.state=g,a.context=l,s=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),s=!1)}return zg(n,e,t,s,r,i)}function zg(n,e,t,s,i,r){bb(n,e);var a=(e.flags&128)!==0;if(!s&&!a)return i&&ww(e,t,!1),Wi(n,e,r);s=e.stateNode,MC.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&a?(e.child=Ac(e,n.child,null,r),e.child=Ac(e,null,o,r)):Xt(n,e,o,r),e.memoizedState=s.state,i&&ww(e,t,!0),e.child}function Sb(n){var e=n.stateNode;e.pendingContext?vw(n,e.pendingContext,e.pendingContext!==e.context):e.context&&vw(n,e.context,!1),Kv(n,e.containerInfo)}function Iw(n,e,t,s,i){return Sc(),Wv(i),e.flags|=256,Xt(n,e,t,s),e.child}var Bg={dehydrated:null,treeContext:null,retryLane:0};function Ug(n){return{baseLanes:n,cachePool:null,transitions:null}}function Ab(n,e,t){var s=e.pendingProps,i=ze.current,r=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Ne(ze,i&1),n===null)return Lg(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,n=s.fallback,r?(s=e.mode,r=e.child,a={mode:"hidden",children:a},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=a):r=tm(a,s,0,null),n=xo(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=Ug(t),e.memoizedState=Bg,n):i0(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return LC(n,e,a,s,o,i,t);if(r){r=s.fallback,a=e.mode,i=n.child,o=i.sibling;var l={mode:"hidden",children:s.children};return!(a&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=$r(i,l),s.subtreeFlags=i.subtreeFlags&14680064),o!==null?r=$r(o,r):(r=xo(r,a,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,a=n.child.memoizedState,a=a===null?Ug(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},r.memoizedState=a,r.childLanes=n.childLanes&~t,e.memoizedState=Bg,s}return r=n.child,n=r.sibling,s=$r(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function i0(n,e){return e=tm({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Hd(n,e,t,s){return s!==null&&Wv(s),Ac(e,n.child,null,t),n=i0(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function LC(n,e,t,s,i,r,a){if(t)return e.flags&256?(e.flags&=-257,s=Hm(Error(D(422))),Hd(n,e,a,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=tm({mode:"visible",children:s.children},i,0,null),r=xo(r,i,a,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&Ac(e,n.child,null,a),e.child.memoizedState=Ug(a),e.memoizedState=Bg,r);if(!(e.mode&1))return Hd(n,e,a,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var o=s.dgst;return s=o,r=Error(D(419)),s=Hm(r,s,void 0),Hd(n,e,a,s)}if(o=(a&n.childLanes)!==0,un||o){if(s=yt,s!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|a)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,$i(n,i),_s(s,n,i,-1))}return u0(),s=Hm(Error(D(421))),Hd(n,e,a,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=GC.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,Mn=zr(i.nextSibling),Ln=e,Ie=!0,bs=null,n!==null&&(qn[Yn++]=Di,qn[Yn++]=Fi,qn[Yn++]=So,Di=n.id,Fi=n.overflow,So=e),e=i0(e,s.children),e.flags|=4096,e)}function Dw(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),jg(n.return,e,t)}function $m(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function _b(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(Xt(n,e,s.children,t),s=ze.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Dw(n,t,e);else if(n.tag===19)Dw(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Ne(ze,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&ip(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),$m(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&ip(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}$m(e,!0,t,null,r);break;case"together":$m(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function af(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Wi(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),_o|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(D(153));if(e.child!==null){for(n=e.child,t=$r(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=$r(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function jC(n,e,t){switch(e.tag){case 3:Sb(e),Sc();break;case 5:K1(e);break;case 1:dn(e.type)&&Jf(e);break;case 4:Kv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;Ne(tp,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Ne(ze,ze.current&1),e.flags|=128,null):t&e.child.childLanes?Ab(n,e,t):(Ne(ze,ze.current&1),n=Wi(n,e,t),n!==null?n.sibling:null);Ne(ze,ze.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return _b(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ne(ze,ze.current),s)break;return null;case 22:case 23:return e.lanes=0,xb(n,e,t)}return Wi(n,e,t)}var Eb,Hg,Cb,kb;Eb=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Hg=function(){};Cb=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,fa(ei.current);var r=null;switch(t){case"input":i=ug(n,i),s=ug(n,s),r=[];break;case"select":i=$e({},i,{value:void 0}),s=$e({},s,{value:void 0}),r=[];break;case"textarea":i=fg(n,i),s=fg(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Kf)}mg(t,s);var a;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Cu.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var l=s[u];if(o=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(r||(r=[]),r.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(r=r||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(r=r||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Cu.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Pe("scroll",n),r||o===l||(r=[])):(r=r||[]).push(u,l))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};kb=function(n,e,t,s){t!==s&&(e.flags|=4)};function Bc(n,e){if(!Ie)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Nt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function IC(n,e,t){var s=e.pendingProps;switch($v(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(e),null;case 1:return dn(e.type)&&Qf(),Nt(e),null;case 3:return s=e.stateNode,_c(),Re(hn),Re(zt),Jv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Bd(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bs!==null&&(Kg(bs),bs=null))),Hg(n,e),Nt(e),null;case 5:Qv(e);var i=fa(Ou.current);if(t=e.type,n!==null&&e.stateNode!=null)Cb(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(D(166));return Nt(e),null}if(n=fa(ei.current),Bd(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[Qs]=e,s[Du]=r,n=(e.mode&1)!==0,t){case"dialog":Pe("cancel",s),Pe("close",s);break;case"iframe":case"object":case"embed":Pe("load",s);break;case"video":case"audio":for(i=0;i<Jc.length;i++)Pe(Jc[i],s);break;case"source":Pe("error",s);break;case"img":case"image":case"link":Pe("error",s),Pe("load",s);break;case"details":Pe("toggle",s);break;case"input":V0(s,r),Pe("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},Pe("invalid",s);break;case"textarea":X0(s,r),Pe("invalid",s)}mg(t,r),i=null;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];a==="children"?typeof o=="string"?s.textContent!==o&&(r.suppressHydrationWarning!==!0&&zd(s.textContent,o,n),i=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&zd(s.textContent,o,n),i=["children",""+o]):Cu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Pe("scroll",s)}switch(t){case"input":Rd(s),G0(s,r,!0);break;case"textarea":Rd(s),q0(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=Kf)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=t1(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=a.createElement(t,{is:s.is}):(n=a.createElement(t),t==="select"&&(a=n,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):n=a.createElementNS(n,t),n[Qs]=e,n[Du]=s,Eb(n,e,!1,!1),e.stateNode=n;e:{switch(a=gg(t,s),t){case"dialog":Pe("cancel",n),Pe("close",n),i=s;break;case"iframe":case"object":case"embed":Pe("load",n),i=s;break;case"video":case"audio":for(i=0;i<Jc.length;i++)Pe(Jc[i],n);i=s;break;case"source":Pe("error",n),i=s;break;case"img":case"image":case"link":Pe("error",n),Pe("load",n),i=s;break;case"details":Pe("toggle",n),i=s;break;case"input":V0(n,s),i=ug(n,s),Pe("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=$e({},s,{value:void 0}),Pe("invalid",n);break;case"textarea":X0(n,s),i=fg(n,s),Pe("invalid",n);break;default:i=s}mg(t,i),o=i;for(r in o)if(o.hasOwnProperty(r)){var l=o[r];r==="style"?i1(n,l):r==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&n1(n,l)):r==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&ku(n,l):typeof l=="number"&&ku(n,""+l):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Cu.hasOwnProperty(r)?l!=null&&r==="onScroll"&&Pe("scroll",n):l!=null&&Nv(n,r,l,a))}switch(t){case"input":Rd(n),G0(n,s,!1);break;case"textarea":Rd(n),q0(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Gr(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?ol(n,!!s.multiple,r,!1):s.defaultValue!=null&&ol(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Kf)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nt(e),null;case 6:if(n&&e.stateNode!=null)kb(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(D(166));if(t=fa(Ou.current),fa(ei.current),Bd(e)){if(s=e.stateNode,t=e.memoizedProps,s[Qs]=e,(r=s.nodeValue!==t)&&(n=Ln,n!==null))switch(n.tag){case 3:zd(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&zd(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Qs]=e,e.stateNode=s}return Nt(e),null;case 13:if(Re(ze),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ie&&Mn!==null&&e.mode&1&&!(e.flags&128))V1(),Sc(),e.flags|=98560,r=!1;else if(r=Bd(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(D(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(D(317));r[Qs]=e}else Sc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nt(e),r=!1}else bs!==null&&(Kg(bs),bs=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||ze.current&1?ot===0&&(ot=3):u0())),e.updateQueue!==null&&(e.flags|=4),Nt(e),null);case 4:return _c(),Hg(n,e),n===null&&ju(e.stateNode.containerInfo),Nt(e),null;case 10:return Xv(e.type._context),Nt(e),null;case 17:return dn(e.type)&&Qf(),Nt(e),null;case 19:if(Re(ze),r=e.memoizedState,r===null)return Nt(e),null;if(s=(e.flags&128)!==0,a=r.rendering,a===null)if(s)Bc(r,!1);else{if(ot!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=ip(n),a!==null){for(e.flags|=128,Bc(r,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,a=r.alternate,a===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,n=a.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ne(ze,ze.current&1|2),e.child}n=n.sibling}r.tail!==null&&Ke()>Cc&&(e.flags|=128,s=!0,Bc(r,!1),e.lanes=4194304)}else{if(!s)if(n=ip(a),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Bc(r,!0),r.tail===null&&r.tailMode==="hidden"&&!a.alternate&&!Ie)return Nt(e),null}else 2*Ke()-r.renderingStartTime>Cc&&t!==1073741824&&(e.flags|=128,s=!0,Bc(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(t=r.last,t!==null?t.sibling=a:e.child=a,r.last=a)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Ke(),e.sibling=null,t=ze.current,Ne(ze,s?t&1|2:t&1),e):(Nt(e),null);case 22:case 23:return c0(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Pn&1073741824&&(Nt(e),e.subtreeFlags&6&&(e.flags|=8192)):Nt(e),null;case 24:return null;case 25:return null}throw Error(D(156,e.tag))}function DC(n,e){switch($v(e),e.tag){case 1:return dn(e.type)&&Qf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return _c(),Re(hn),Re(zt),Jv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Qv(e),null;case 13:if(Re(ze),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(D(340));Sc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Re(ze),null;case 4:return _c(),null;case 10:return Xv(e.type._context),null;case 22:case 23:return c0(),null;case 24:return null;default:return null}}var $d=!1,Ft=!1,FC=typeof WeakSet=="function"?WeakSet:Set,G=null;function nl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){Ge(n,e,s)}else t.current=null}function $g(n,e,t){try{t()}catch(s){Ge(n,e,s)}}var Fw=!1;function OC(n,e){if(Cg=Xf,n=M1(),Uv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,h=0,d=n,p=null;t:for(;;){for(var m;d!==t||i!==0&&d.nodeType!==3||(o=a+i),d!==r||s!==0&&d.nodeType!==3||(l=a+s),d.nodeType===3&&(a+=d.nodeValue.length),(m=d.firstChild)!==null;)p=d,d=m;for(;;){if(d===n)break t;if(p===t&&++u===i&&(o=a),p===r&&++h===s&&(l=a),(m=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=m}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(kg={focusedElem:n,selectionRange:t},Xf=!1,G=e;G!==null;)if(e=G,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,G=n;else for(;G!==null;){e=G;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,S=g.memoizedState,v=e.stateNode,x=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:as(e.type,y),S);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(D(163))}}catch(E){Ge(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}return g=Fw,Fw=!1,g}function bu(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&$g(e,t,r)}i=i.next}while(i!==s)}}function Zp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function Wg(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Nb(n){var e=n.alternate;e!==null&&(n.alternate=null,Nb(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Qs],delete e[Du],delete e[Tg],delete e[xC],delete e[bC])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Pb(n){return n.tag===5||n.tag===3||n.tag===4}function Ow(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Pb(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Vg(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Kf));else if(s!==4&&(n=n.child,n!==null))for(Vg(n,e,t),n=n.sibling;n!==null;)Vg(n,e,t),n=n.sibling}function Gg(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(Gg(n,e,t),n=n.sibling;n!==null;)Gg(n,e,t),n=n.sibling}var At=null,xs=!1;function Yi(n,e,t){for(t=t.child;t!==null;)Tb(n,e,t),t=t.sibling}function Tb(n,e,t){if(Zs&&typeof Zs.onCommitFiberUnmount=="function")try{Zs.onCommitFiberUnmount(Vp,t)}catch{}switch(t.tag){case 5:Ft||nl(t,e);case 6:var s=At,i=xs;At=null,Yi(n,e,t),At=s,xs=i,At!==null&&(xs?(n=At,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):At.removeChild(t.stateNode));break;case 18:At!==null&&(xs?(n=At,t=t.stateNode,n.nodeType===8?Dm(n.parentNode,t):n.nodeType===1&&Dm(n,t),Ru(n)):Dm(At,t.stateNode));break;case 4:s=At,i=xs,At=t.stateNode.containerInfo,xs=!0,Yi(n,e,t),At=s,xs=i;break;case 0:case 11:case 14:case 15:if(!Ft&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,a=r.destroy;r=r.tag,a!==void 0&&(r&2||r&4)&&$g(t,e,a),i=i.next}while(i!==s)}Yi(n,e,t);break;case 1:if(!Ft&&(nl(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(o){Ge(t,e,o)}Yi(n,e,t);break;case 21:Yi(n,e,t);break;case 22:t.mode&1?(Ft=(s=Ft)||t.memoizedState!==null,Yi(n,e,t),Ft=s):Yi(n,e,t);break;default:Yi(n,e,t)}}function zw(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new FC),e.forEach(function(s){var i=XC.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function is(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:At=o.stateNode,xs=!1;break e;case 3:At=o.stateNode.containerInfo,xs=!0;break e;case 4:At=o.stateNode.containerInfo,xs=!0;break e}o=o.return}if(At===null)throw Error(D(160));Tb(r,a,i),At=null,xs=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Ge(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Rb(e,n),e=e.sibling}function Rb(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(is(e,n),Ps(n),s&4){try{bu(3,n,n.return),Zp(3,n)}catch(y){Ge(n,n.return,y)}try{bu(5,n,n.return)}catch(y){Ge(n,n.return,y)}}break;case 1:is(e,n),Ps(n),s&512&&t!==null&&nl(t,t.return);break;case 5:if(is(e,n),Ps(n),s&512&&t!==null&&nl(t,t.return),n.flags&32){var i=n.stateNode;try{ku(i,"")}catch(y){Ge(n,n.return,y)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,a=t!==null?t.memoizedProps:r,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&Zx(i,r),gg(o,a);var u=gg(o,r);for(a=0;a<l.length;a+=2){var h=l[a],d=l[a+1];h==="style"?i1(i,d):h==="dangerouslySetInnerHTML"?n1(i,d):h==="children"?ku(i,d):Nv(i,h,d,u)}switch(o){case"input":hg(i,r);break;case"textarea":e1(i,r);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var m=r.value;m!=null?ol(i,!!r.multiple,m,!1):p!==!!r.multiple&&(r.defaultValue!=null?ol(i,!!r.multiple,r.defaultValue,!0):ol(i,!!r.multiple,r.multiple?[]:"",!1))}i[Du]=r}catch(y){Ge(n,n.return,y)}}break;case 6:if(is(e,n),Ps(n),s&4){if(n.stateNode===null)throw Error(D(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(y){Ge(n,n.return,y)}}break;case 3:if(is(e,n),Ps(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Ru(e.containerInfo)}catch(y){Ge(n,n.return,y)}break;case 4:is(e,n),Ps(n);break;case 13:is(e,n),Ps(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(o0=Ke())),s&4&&zw(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Ft=(u=Ft)||h,is(e,n),Ft=u):is(e,n),Ps(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(G=n,h=n.child;h!==null;){for(d=G=h;G!==null;){switch(p=G,m=p.child,p.tag){case 0:case 11:case 14:case 15:bu(4,p,p.return);break;case 1:nl(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){s=p,t=p.return;try{e=s,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(y){Ge(s,t,y)}}break;case 5:nl(p,p.return);break;case 22:if(p.memoizedState!==null){Uw(d);continue}}m!==null?(m.return=p,G=m):Uw(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=s1("display",a))}catch(y){Ge(n,n.return,y)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(y){Ge(n,n.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:is(e,n),Ps(n),s&4&&zw(n);break;case 21:break;default:is(e,n),Ps(n)}}function Ps(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Pb(t)){var s=t;break e}t=t.return}throw Error(D(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(ku(i,""),s.flags&=-33);var r=Ow(n);Gg(n,r,i);break;case 3:case 4:var a=s.stateNode.containerInfo,o=Ow(n);Vg(n,o,a);break;default:throw Error(D(161))}}catch(l){Ge(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function zC(n,e,t){G=n,Mb(n)}function Mb(n,e,t){for(var s=(n.mode&1)!==0;G!==null;){var i=G,r=i.child;if(i.tag===22&&s){var a=i.memoizedState!==null||$d;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Ft;o=$d;var u=Ft;if($d=a,(Ft=l)&&!u)for(G=i;G!==null;)a=G,l=a.child,a.tag===22&&a.memoizedState!==null?Hw(i):l!==null?(l.return=a,G=l):Hw(i);for(;r!==null;)G=r,Mb(r),r=r.sibling;G=i,$d=o,Ft=u}Bw(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,G=r):Bw(n)}}function Bw(n){for(;G!==null;){var e=G;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ft||Zp(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Ft)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:as(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&_w(e,r,s);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}_w(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Ru(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(D(163))}Ft||e.flags&512&&Wg(e)}catch(p){Ge(e,e.return,p)}}if(e===n){G=null;break}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}}function Uw(n){for(;G!==null;){var e=G;if(e===n){G=null;break}var t=e.sibling;if(t!==null){t.return=e.return,G=t;break}G=e.return}}function Hw(n){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Zp(4,e)}catch(l){Ge(e,t,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(l){Ge(e,i,l)}}var r=e.return;try{Wg(e)}catch(l){Ge(e,r,l)}break;case 5:var a=e.return;try{Wg(e)}catch(l){Ge(e,a,l)}}}catch(l){Ge(e,e.return,l)}if(e===n){G=null;break}var o=e.sibling;if(o!==null){o.return=e.return,G=o;break}G=e.return}}var BC=Math.ceil,op=Xi.ReactCurrentDispatcher,r0=Xi.ReactCurrentOwner,Zn=Xi.ReactCurrentBatchConfig,pe=0,yt=null,Ze=null,Et=0,Pn=0,sl=Jr(0),ot=0,Hu=null,_o=0,em=0,a0=0,Su=null,cn=null,o0=0,Cc=1/0,ai=null,lp=!1,Xg=null,Ur=null,Wd=!1,jr=null,cp=0,Au=0,qg=null,of=-1,lf=0;function qt(){return pe&6?Ke():of!==-1?of:of=Ke()}function Hr(n){return n.mode&1?pe&2&&Et!==0?Et&-Et:AC.transition!==null?(lf===0&&(lf=g1()),lf):(n=Se,n!==0||(n=window.event,n=n===void 0?16:A1(n.type)),n):1}function _s(n,e,t,s){if(50<Au)throw Au=0,qg=null,Error(D(185));Sd(n,t,s),(!(pe&2)||n!==yt)&&(n===yt&&(!(pe&2)&&(em|=t),ot===4&&tr(n,Et)),fn(n,s),t===1&&pe===0&&!(e.mode&1)&&(Cc=Ke()+500,Kp&&Zr()))}function fn(n,e){var t=n.callbackNode;AE(n,e);var s=Gf(n,n===yt?Et:0);if(s===0)t!==null&&Q0(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&Q0(t),e===1)n.tag===0?SC($w.bind(null,n)):H1($w.bind(null,n)),vC(function(){!(pe&6)&&Zr()}),t=null;else{switch(y1(s)){case 1:t=Lv;break;case 4:t=p1;break;case 16:t=Vf;break;case 536870912:t=m1;break;default:t=Vf}t=Bb(t,Lb.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Lb(n,e){if(of=-1,lf=0,pe&6)throw Error(D(327));var t=n.callbackNode;if(dl()&&n.callbackNode!==t)return null;var s=Gf(n,n===yt?Et:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=up(n,s);else{e=s;var i=pe;pe|=2;var r=Ib();(yt!==n||Et!==e)&&(ai=null,Cc=Ke()+500,wo(n,e));do try{$C();break}catch(o){jb(n,o)}while(!0);Gv(),op.current=r,pe=i,Ze!==null?e=0:(yt=null,Et=0,e=ot)}if(e!==0){if(e===2&&(i=bg(n),i!==0&&(s=i,e=Yg(n,i))),e===1)throw t=Hu,wo(n,0),tr(n,s),fn(n,Ke()),t;if(e===6)tr(n,s);else{if(i=n.current.alternate,!(s&30)&&!UC(i)&&(e=up(n,s),e===2&&(r=bg(n),r!==0&&(s=r,e=Yg(n,r))),e===1))throw t=Hu,wo(n,0),tr(n,s),fn(n,Ke()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(D(345));case 2:ia(n,cn,ai);break;case 3:if(tr(n,s),(s&130023424)===s&&(e=o0+500-Ke(),10<e)){if(Gf(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){qt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Pg(ia.bind(null,n,cn,ai),e);break}ia(n,cn,ai);break;case 4:if(tr(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var a=31-As(s);r=1<<a,a=e[a],a>i&&(i=a),s&=~r}if(s=i,s=Ke()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*BC(s/1960))-s,10<s){n.timeoutHandle=Pg(ia.bind(null,n,cn,ai),s);break}ia(n,cn,ai);break;case 5:ia(n,cn,ai);break;default:throw Error(D(329))}}}return fn(n,Ke()),n.callbackNode===t?Lb.bind(null,n):null}function Yg(n,e){var t=Su;return n.current.memoizedState.isDehydrated&&(wo(n,e).flags|=256),n=up(n,e),n!==2&&(e=cn,cn=t,e!==null&&Kg(e)),n}function Kg(n){cn===null?cn=n:cn.push.apply(cn,n)}function UC(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!Es(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function tr(n,e){for(e&=~a0,e&=~em,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-As(e),s=1<<t;n[t]=-1,e&=~s}}function $w(n){if(pe&6)throw Error(D(327));dl();var e=Gf(n,0);if(!(e&1))return fn(n,Ke()),null;var t=up(n,e);if(n.tag!==0&&t===2){var s=bg(n);s!==0&&(e=s,t=Yg(n,s))}if(t===1)throw t=Hu,wo(n,0),tr(n,e),fn(n,Ke()),t;if(t===6)throw Error(D(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ia(n,cn,ai),fn(n,Ke()),null}function l0(n,e){var t=pe;pe|=1;try{return n(e)}finally{pe=t,pe===0&&(Cc=Ke()+500,Kp&&Zr())}}function Eo(n){jr!==null&&jr.tag===0&&!(pe&6)&&dl();var e=pe;pe|=1;var t=Zn.transition,s=Se;try{if(Zn.transition=null,Se=1,n)return n()}finally{Se=s,Zn.transition=t,pe=e,!(pe&6)&&Zr()}}function c0(){Pn=sl.current,Re(sl)}function wo(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,yC(t)),Ze!==null)for(t=Ze.return;t!==null;){var s=t;switch($v(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Qf();break;case 3:_c(),Re(hn),Re(zt),Jv();break;case 5:Qv(s);break;case 4:_c();break;case 13:Re(ze);break;case 19:Re(ze);break;case 10:Xv(s.type._context);break;case 22:case 23:c0()}t=t.return}if(yt=n,Ze=n=$r(n.current,null),Et=Pn=e,ot=0,Hu=null,a0=em=_o=0,cn=Su=null,da!==null){for(e=0;e<da.length;e++)if(t=da[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var a=r.next;r.next=i,s.next=a}t.pending=s}da=null}return n}function jb(n,e){do{var t=Ze;try{if(Gv(),sf.current=ap,rp){for(var s=Ue.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}rp=!1}if(Ao=0,gt=at=Ue=null,xu=!1,zu=0,r0.current=null,t===null||t.return===null){ot=1,Hu=e,Ze=null;break}e:{var r=n,a=t.return,o=t,l=e;if(e=Et,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=o,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=Tw(a);if(m!==null){m.flags&=-257,Rw(m,a,o,r,e),m.mode&1&&Pw(r,u,e),e=m,l=u;var g=e.updateQueue;if(g===null){var y=new Set;y.add(l),e.updateQueue=y}else g.add(l);break e}else{if(!(e&1)){Pw(r,u,e),u0();break e}l=Error(D(426))}}else if(Ie&&o.mode&1){var S=Tw(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Rw(S,a,o,r,e),Wv(Ec(l,o));break e}}r=l=Ec(l,o),ot!==4&&(ot=2),Su===null?Su=[r]:Su.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var v=yb(r,l,e);Aw(r,v);break e;case 1:o=l;var x=r.type,b=r.stateNode;if(!(r.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ur===null||!Ur.has(b)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=vb(r,o,e);Aw(r,E);break e}}r=r.return}while(r!==null)}Fb(t)}catch(C){e=C,Ze===t&&t!==null&&(Ze=t=t.return);continue}break}while(!0)}function Ib(){var n=op.current;return op.current=ap,n===null?ap:n}function u0(){(ot===0||ot===3||ot===2)&&(ot=4),yt===null||!(_o&268435455)&&!(em&268435455)||tr(yt,Et)}function up(n,e){var t=pe;pe|=2;var s=Ib();(yt!==n||Et!==e)&&(ai=null,wo(n,e));do try{HC();break}catch(i){jb(n,i)}while(!0);if(Gv(),pe=t,op.current=s,Ze!==null)throw Error(D(261));return yt=null,Et=0,ot}function HC(){for(;Ze!==null;)Db(Ze)}function $C(){for(;Ze!==null&&!pE();)Db(Ze)}function Db(n){var e=zb(n.alternate,n,Pn);n.memoizedProps=n.pendingProps,e===null?Fb(n):Ze=e,r0.current=null}function Fb(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=DC(t,e),t!==null){t.flags&=32767,Ze=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ot=6,Ze=null;return}}else if(t=IC(t,e,Pn),t!==null){Ze=t;return}if(e=e.sibling,e!==null){Ze=e;return}Ze=e=n}while(e!==null);ot===0&&(ot=5)}function ia(n,e,t){var s=Se,i=Zn.transition;try{Zn.transition=null,Se=1,WC(n,e,t,s)}finally{Zn.transition=i,Se=s}return null}function WC(n,e,t,s){do dl();while(jr!==null);if(pe&6)throw Error(D(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(D(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(_E(n,r),n===yt&&(Ze=yt=null,Et=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Wd||(Wd=!0,Bb(Vf,function(){return dl(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Zn.transition,Zn.transition=null;var a=Se;Se=1;var o=pe;pe|=4,r0.current=null,OC(n,t),Rb(t,n),uC(kg),Xf=!!Cg,kg=Cg=null,n.current=t,zC(t),mE(),pe=o,Se=a,Zn.transition=r}else n.current=t;if(Wd&&(Wd=!1,jr=n,cp=i),r=n.pendingLanes,r===0&&(Ur=null),vE(t.stateNode),fn(n,Ke()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(lp)throw lp=!1,n=Xg,Xg=null,n;return cp&1&&n.tag!==0&&dl(),r=n.pendingLanes,r&1?n===qg?Au++:(Au=0,qg=n):Au=0,Zr(),null}function dl(){if(jr!==null){var n=y1(cp),e=Zn.transition,t=Se;try{if(Zn.transition=null,Se=16>n?16:n,jr===null)var s=!1;else{if(n=jr,jr=null,cp=0,pe&6)throw Error(D(331));var i=pe;for(pe|=4,G=n.current;G!==null;){var r=G,a=r.child;if(G.flags&16){var o=r.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(G=u;G!==null;){var h=G;switch(h.tag){case 0:case 11:case 15:bu(8,h,r)}var d=h.child;if(d!==null)d.return=h,G=d;else for(;G!==null;){h=G;var p=h.sibling,m=h.return;if(Nb(h),h===u){G=null;break}if(p!==null){p.return=m,G=p;break}G=m}}}var g=r.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var S=y.sibling;y.sibling=null,y=S}while(y!==null)}}G=r}}if(r.subtreeFlags&2064&&a!==null)a.return=r,G=a;else e:for(;G!==null;){if(r=G,r.flags&2048)switch(r.tag){case 0:case 11:case 15:bu(9,r,r.return)}var v=r.sibling;if(v!==null){v.return=r.return,G=v;break e}G=r.return}}var x=n.current;for(G=x;G!==null;){a=G;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,G=b;else e:for(a=x;G!==null;){if(o=G,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Zp(9,o)}}catch(C){Ge(o,o.return,C)}if(o===a){G=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,G=E;break e}G=o.return}}if(pe=i,Zr(),Zs&&typeof Zs.onPostCommitFiberRoot=="function")try{Zs.onPostCommitFiberRoot(Vp,n)}catch{}s=!0}return s}finally{Se=t,Zn.transition=e}}return!1}function Ww(n,e,t){e=Ec(t,e),e=yb(n,e,1),n=Br(n,e,1),e=qt(),n!==null&&(Sd(n,1,e),fn(n,e))}function Ge(n,e,t){if(n.tag===3)Ww(n,n,t);else for(;e!==null;){if(e.tag===3){Ww(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ur===null||!Ur.has(s))){n=Ec(t,n),n=vb(e,n,1),e=Br(e,n,1),n=qt(),e!==null&&(Sd(e,1,n),fn(e,n));break}}e=e.return}}function VC(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=qt(),n.pingedLanes|=n.suspendedLanes&t,yt===n&&(Et&t)===t&&(ot===4||ot===3&&(Et&130023424)===Et&&500>Ke()-o0?wo(n,0):a0|=t),fn(n,e)}function Ob(n,e){e===0&&(n.mode&1?(e=jd,jd<<=1,!(jd&130023424)&&(jd=4194304)):e=1);var t=qt();n=$i(n,e),n!==null&&(Sd(n,e,t),fn(n,t))}function GC(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Ob(n,t)}function XC(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(D(314))}s!==null&&s.delete(e),Ob(n,t)}var zb;zb=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||hn.current)un=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return un=!1,jC(n,e,t);un=!!(n.flags&131072)}else un=!1,Ie&&e.flags&1048576&&$1(e,ep,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;af(n,e),n=e.pendingProps;var i=bc(e,zt.current);hl(e,t),i=e0(null,e,s,n,i,t);var r=t0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,dn(s)?(r=!0,Jf(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Yv(e),i.updater=Jp,e.stateNode=i,i._reactInternals=e,Dg(e,s,n,t),e=zg(null,e,s,!0,r,t)):(e.tag=0,Ie&&r&&Hv(e),Xt(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(af(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=YC(s),n=as(s,n),i){case 0:e=Og(null,e,s,n,t);break e;case 1:e=jw(null,e,s,n,t);break e;case 11:e=Mw(null,e,s,n,t);break e;case 14:e=Lw(null,e,s,as(s.type,n),t);break e}throw Error(D(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:as(s,i),Og(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:as(s,i),jw(n,e,s,i,t);case 3:e:{if(Sb(e),n===null)throw Error(D(387));s=e.pendingProps,r=e.memoizedState,i=r.element,Y1(n,e),sp(e,s,null,t);var a=e.memoizedState;if(s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=Ec(Error(D(423)),e),e=Iw(n,e,s,t,i);break e}else if(s!==i){i=Ec(Error(D(424)),e),e=Iw(n,e,s,t,i);break e}else for(Mn=zr(e.stateNode.containerInfo.firstChild),Ln=e,Ie=!0,bs=null,t=X1(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Sc(),s===i){e=Wi(n,e,t);break e}Xt(n,e,s,t)}e=e.child}return e;case 5:return K1(e),n===null&&Lg(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,a=i.children,Ng(s,i)?a=null:r!==null&&Ng(s,r)&&(e.flags|=32),bb(n,e),Xt(n,e,a,t),e.child;case 6:return n===null&&Lg(e),null;case 13:return Ab(n,e,t);case 4:return Kv(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=Ac(e,null,s,t):Xt(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:as(s,i),Mw(n,e,s,i,t);case 7:return Xt(n,e,e.pendingProps,t),e.child;case 8:return Xt(n,e,e.pendingProps.children,t),e.child;case 12:return Xt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,a=i.value,Ne(tp,s._currentValue),s._currentValue=a,r!==null)if(Es(r.value,a)){if(r.children===i.children&&!hn.current){e=Wi(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){a=r.child;for(var l=o.firstContext;l!==null;){if(l.context===s){if(r.tag===1){l=Oi(-1,t&-t),l.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}r.lanes|=t,l=r.alternate,l!==null&&(l.lanes|=t),jg(r.return,t,e),o.lanes|=t;break}l=l.next}}else if(r.tag===10)a=r.type===e.type?null:r.child;else if(r.tag===18){if(a=r.return,a===null)throw Error(D(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),jg(a,t,e),a=r.sibling}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===e){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}Xt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,hl(e,t),i=ts(i),s=s(i),e.flags|=1,Xt(n,e,s,t),e.child;case 14:return s=e.type,i=as(s,e.pendingProps),i=as(s.type,i),Lw(n,e,s,i,t);case 15:return wb(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:as(s,i),af(n,e),e.tag=1,dn(s)?(n=!0,Jf(e)):n=!1,hl(e,t),gb(e,s,i),Dg(e,s,i,t),zg(null,e,s,!0,n,t);case 19:return _b(n,e,t);case 22:return xb(n,e,t)}throw Error(D(156,e.tag))};function Bb(n,e){return f1(n,e)}function qC(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jn(n,e,t,s){return new qC(n,e,t,s)}function h0(n){return n=n.prototype,!(!n||!n.isReactComponent)}function YC(n){if(typeof n=="function")return h0(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Tv)return 11;if(n===Rv)return 14}return 2}function $r(n,e){var t=n.alternate;return t===null?(t=Jn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function cf(n,e,t,s,i,r){var a=2;if(s=n,typeof n=="function")h0(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case Xo:return xo(t.children,i,r,e);case Pv:a=8,i|=8;break;case ag:return n=Jn(12,t,e,i|2),n.elementType=ag,n.lanes=r,n;case og:return n=Jn(13,t,e,i),n.elementType=og,n.lanes=r,n;case lg:return n=Jn(19,t,e,i),n.elementType=lg,n.lanes=r,n;case Kx:return tm(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case qx:a=10;break e;case Yx:a=9;break e;case Tv:a=11;break e;case Rv:a=14;break e;case Ji:a=16,s=null;break e}throw Error(D(130,n==null?n:typeof n,""))}return e=Jn(a,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function xo(n,e,t,s){return n=Jn(7,n,s,e),n.lanes=t,n}function tm(n,e,t,s){return n=Jn(22,n,s,e),n.elementType=Kx,n.lanes=t,n.stateNode={isHidden:!1},n}function Wm(n,e,t){return n=Jn(6,n,null,e),n.lanes=t,n}function Vm(n,e,t){return e=Jn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function KC(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Em(0),this.expirationTimes=Em(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Em(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function d0(n,e,t,s,i,r,a,o,l){return n=new KC(n,e,t,o,l),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Jn(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yv(r),n}function QC(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Go,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function Ub(n){if(!n)return Xr;n=n._reactInternals;e:{if(jo(n)!==n||n.tag!==1)throw Error(D(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(dn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(D(171))}if(n.tag===1){var t=n.type;if(dn(t))return U1(n,t,e)}return e}function Hb(n,e,t,s,i,r,a,o,l){return n=d0(t,s,!0,n,i,r,a,o,l),n.context=Ub(null),t=n.current,s=qt(),i=Hr(t),r=Oi(s,i),r.callback=e??null,Br(t,r,i),n.current.lanes=i,Sd(n,i,s),fn(n,s),n}function nm(n,e,t,s){var i=e.current,r=qt(),a=Hr(i);return t=Ub(t),e.context===null?e.context=t:e.pendingContext=t,e=Oi(r,a),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=Br(i,e,a),n!==null&&(_s(n,i,a,r),nf(n,i,a)),a}function hp(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Vw(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function f0(n,e){Vw(n,e),(n=n.alternate)&&Vw(n,e)}function JC(){return null}var $b=typeof reportError=="function"?reportError:function(n){console.error(n)};function p0(n){this._internalRoot=n}sm.prototype.render=p0.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(D(409));nm(n,e,null,null)};sm.prototype.unmount=p0.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Eo(function(){nm(null,n,null,null)}),e[Hi]=null}};function sm(n){this._internalRoot=n}sm.prototype.unstable_scheduleHydration=function(n){if(n){var e=x1();n={blockedOn:null,target:n,priority:e};for(var t=0;t<er.length&&e!==0&&e<er[t].priority;t++);er.splice(t,0,n),t===0&&S1(n)}};function m0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function im(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Gw(){}function ZC(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=hp(a);r.call(u)}}var a=Hb(e,s,n,0,null,!1,!1,"",Gw);return n._reactRootContainer=a,n[Hi]=a.current,ju(n.nodeType===8?n.parentNode:n),Eo(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var o=s;s=function(){var u=hp(l);o.call(u)}}var l=d0(n,0,!1,null,null,!1,!1,"",Gw);return n._reactRootContainer=l,n[Hi]=l.current,ju(n.nodeType===8?n.parentNode:n),Eo(function(){nm(e,l,t,s)}),l}function rm(n,e,t,s,i){var r=t._reactRootContainer;if(r){var a=r;if(typeof i=="function"){var o=i;i=function(){var l=hp(a);o.call(l)}}nm(e,a,n,i)}else a=ZC(t,e,n,i,s);return hp(a)}v1=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Qc(e.pendingLanes);t!==0&&(jv(e,t|1),fn(e,Ke()),!(pe&6)&&(Cc=Ke()+500,Zr()))}break;case 13:Eo(function(){var s=$i(n,1);if(s!==null){var i=qt();_s(s,n,1,i)}}),f0(n,1)}};Iv=function(n){if(n.tag===13){var e=$i(n,134217728);if(e!==null){var t=qt();_s(e,n,134217728,t)}f0(n,134217728)}};w1=function(n){if(n.tag===13){var e=Hr(n),t=$i(n,e);if(t!==null){var s=qt();_s(t,n,e,s)}f0(n,e)}};x1=function(){return Se};b1=function(n,e){var t=Se;try{return Se=n,e()}finally{Se=t}};vg=function(n,e,t){switch(e){case"input":if(hg(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=Yp(s);if(!i)throw Error(D(90));Jx(s),hg(s,i)}}}break;case"textarea":e1(n,t);break;case"select":e=t.value,e!=null&&ol(n,!!t.multiple,e,!1)}};o1=l0;l1=Eo;var ek={usingClientEntryPoint:!1,Events:[_d,Qo,Yp,r1,a1,l0]},Uc={findFiberByHostInstance:ha,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tk={bundleType:Uc.bundleType,version:Uc.version,rendererPackageName:Uc.rendererPackageName,rendererConfig:Uc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xi.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=h1(n),n===null?null:n.stateNode},findFiberByHostInstance:Uc.findFiberByHostInstance||JC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vd.isDisabled&&Vd.supportsFiber)try{Vp=Vd.inject(tk),Zs=Vd}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ek;Dn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m0(e))throw Error(D(200));return QC(n,e,null,t)};Dn.createRoot=function(n,e){if(!m0(n))throw Error(D(299));var t=!1,s="",i=$b;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=d0(n,1,!1,null,null,t,!1,s,i),n[Hi]=e.current,ju(n.nodeType===8?n.parentNode:n),new p0(e)};Dn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(D(188)):(n=Object.keys(n).join(","),Error(D(268,n)));return n=h1(e),n=n===null?null:n.stateNode,n};Dn.flushSync=function(n){return Eo(n)};Dn.hydrate=function(n,e,t){if(!im(e))throw Error(D(200));return rm(null,n,e,!0,t)};Dn.hydrateRoot=function(n,e,t){if(!m0(n))throw Error(D(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",a=$b;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=Hb(e,null,n,1,t??null,i,!1,r,a),n[Hi]=e.current,ju(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new sm(e)};Dn.render=function(n,e,t){if(!im(e))throw Error(D(200));return rm(null,n,e,!1,t)};Dn.unmountComponentAtNode=function(n){if(!im(n))throw Error(D(40));return n._reactRootContainer?(Eo(function(){rm(null,null,n,!1,function(){n._reactRootContainer=null,n[Hi]=null})}),!0):!1};Dn.unstable_batchedUpdates=l0;Dn.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!im(t))throw Error(D(200));if(n==null||n._reactInternals===void 0)throw Error(D(38));return rm(n,e,t,!1,s)};Dn.version="18.3.1-next-f1338f8080-20240426";function Wb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Wb)}catch(n){console.error(n)}}Wb(),Wx.exports=Dn;var nk=Wx.exports,Xw=nk;ig.createRoot=Xw.createRoot,ig.hydrateRoot=Xw.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $u(){return $u=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},$u.apply(this,arguments)}var Ir;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ir||(Ir={}));const qw="popstate";function sk(n){n===void 0&&(n={});function e(s,i){let{pathname:r,search:a,hash:o}=s.location;return Qg("",{pathname:r,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(s,i){return typeof i=="string"?i:dp(i)}return rk(e,t,null,n)}function He(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function g0(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ik(){return Math.random().toString(36).substr(2,8)}function Yw(n,e){return{usr:n.state,key:n.key,idx:e}}function Qg(n,e,t,s){return t===void 0&&(t=null),$u({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Mc(e):e,{state:t,key:e&&e.key||s||ik()})}function dp(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Mc(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function rk(n,e,t,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:r=!1}=s,a=i.history,o=Ir.Pop,l=null,u=h();u==null&&(u=0,a.replaceState($u({},a.state,{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function d(){o=Ir.Pop;let S=h(),v=S==null?null:S-u;u=S,l&&l({action:o,location:y.location,delta:v})}function p(S,v){o=Ir.Push;let x=Qg(y.location,S,v);u=h()+1;let b=Yw(x,u),E=y.createHref(x);try{a.pushState(b,"",E)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(E)}r&&l&&l({action:o,location:y.location,delta:1})}function m(S,v){o=Ir.Replace;let x=Qg(y.location,S,v);u=h();let b=Yw(x,u),E=y.createHref(x);a.replaceState(b,"",E),r&&l&&l({action:o,location:y.location,delta:0})}function g(S){let v=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof S=="string"?S:dp(S);return x=x.replace(/ $/,"%20"),He(v,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,v)}let y={get action(){return o},get location(){return n(i,a)},listen(S){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(qw,d),l=S,()=>{i.removeEventListener(qw,d),l=null}},createHref(S){return e(i,S)},createURL:g,encodeLocation(S){let v=g(S);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:p,replace:m,go(S){return a.go(S)}};return y}var Kw;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Kw||(Kw={}));function ak(n,e,t){return t===void 0&&(t="/"),ok(n,e,t)}function ok(n,e,t,s){let i=typeof e=="string"?Mc(e):e,r=kc(i.pathname||"/",t);if(r==null)return null;let a=Vb(n);lk(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=wk(r);o=yk(a[l],u)}return o}function Vb(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let i=(r,a,o)=>{let l={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};l.relativePath.startsWith("/")&&(He(l.relativePath.startsWith(s),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(s.length));let u=Wr([s,l.relativePath]),h=t.concat(l);r.children&&r.children.length>0&&(He(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Vb(r.children,e,h,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:mk(u,r.index),routesMeta:h})};return n.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))i(r,a);else for(let l of Gb(r.path))i(r,a,l)}),e}function Gb(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),r=t.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let a=Gb(s.join("/")),o=[];return o.push(...a.map(l=>l===""?r:[r,l].join("/"))),i&&o.push(...a),o.map(l=>n.startsWith("/")&&l===""?"/":l)}function lk(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:gk(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const ck=/^:[\w-]+$/,uk=3,hk=2,dk=1,fk=10,pk=-2,Qw=n=>n==="*";function mk(n,e){let t=n.split("/"),s=t.length;return t.some(Qw)&&(s+=pk),e&&(s+=hk),t.filter(i=>!Qw(i)).reduce((i,r)=>i+(ck.test(r)?uk:r===""?dk:fk),s)}function gk(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function yk(n,e,t){let{routesMeta:s}=n,i={},r="/",a=[];for(let o=0;o<s.length;++o){let l=s[o],u=o===s.length-1,h=r==="/"?e:e.slice(r.length)||"/",d=Jg({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},h),p=l.route;if(!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:Wr([r,d.pathname]),pathnameBase:_k(Wr([r,d.pathnameBase])),route:p}),d.pathnameBase!=="/"&&(r=Wr([r,d.pathnameBase]))}return a}function Jg(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=vk(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let r=i[0],a=r.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:s.reduce((u,h,d)=>{let{paramName:p,isOptional:m}=h;if(p==="*"){let y=o[d]||"";a=r.slice(0,r.length-y.length).replace(/(.)\/+$/,"$1")}const g=o[d];return m&&!g?u[p]=void 0:u[p]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:a,pattern:n}}function vk(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),g0(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(s.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function wk(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return g0(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function kc(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const xk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bk=n=>xk.test(n);function Sk(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?Mc(n):n,r;if(t)if(bk(t))r=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),g0(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+t))}t.startsWith("/")?r=Jw(t.substring(1),"/"):r=Jw(t,e)}else r=e;return{pathname:r,search:Ek(s),hash:Ck(i)}}function Jw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Gm(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Ak(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function y0(n,e){let t=Ak(n);return e?t.map((s,i)=>i===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function v0(n,e,t,s){s===void 0&&(s=!1);let i;typeof n=="string"?i=Mc(n):(i=$u({},n),He(!i.pathname||!i.pathname.includes("?"),Gm("?","pathname","search",i)),He(!i.pathname||!i.pathname.includes("#"),Gm("#","pathname","hash",i)),He(!i.search||!i.search.includes("#"),Gm("#","search","hash",i)));let r=n===""||i.pathname==="",a=r?"/":i.pathname,o;if(a==null)o=t;else{let d=e.length-1;if(!s&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),d-=1;i.pathname=p.join("/")}o=d>=0?e[d]:"/"}let l=Sk(i,o),u=a&&a!=="/"&&a.endsWith("/"),h=(r||a===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||h)&&(l.pathname+="/"),l}const Wr=n=>n.join("/").replace(/\/\/+/g,"/"),_k=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Ek=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Ck=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function kk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const Xb=["post","put","patch","delete"];new Set(Xb);const Nk=["get",...Xb];new Set(Nk);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wu(){return Wu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Wu.apply(this,arguments)}const am=k.createContext(null),qb=k.createContext(null),qi=k.createContext(null),om=k.createContext(null),ni=k.createContext({outlet:null,matches:[],isDataRoute:!1}),Yb=k.createContext(null);function Pk(n,e){let{relative:t}=e===void 0?{}:e;Lc()||He(!1);let{basename:s,navigator:i}=k.useContext(qi),{hash:r,pathname:a,search:o}=lm(n,{relative:t}),l=a;return s!=="/"&&(l=a==="/"?s:Wr([s,a])),i.createHref({pathname:l,search:o,hash:r})}function Lc(){return k.useContext(om)!=null}function Io(){return Lc()||He(!1),k.useContext(om).location}function Kb(n){k.useContext(qi).static||k.useLayoutEffect(n)}function ea(){let{isDataRoute:n}=k.useContext(ni);return n?Vk():Tk()}function Tk(){Lc()||He(!1);let n=k.useContext(am),{basename:e,future:t,navigator:s}=k.useContext(qi),{matches:i}=k.useContext(ni),{pathname:r}=Io(),a=JSON.stringify(y0(i,t.v7_relativeSplatPath)),o=k.useRef(!1);return Kb(()=>{o.current=!0}),k.useCallback(function(u,h){if(h===void 0&&(h={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let d=v0(u,JSON.parse(a),r,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Wr([e,d.pathname])),(h.replace?s.replace:s.push)(d,h.state,h)},[e,s,a,r,n])}const Rk=k.createContext(null);function Mk(n){let e=k.useContext(ni).outlet;return e&&k.createElement(Rk.Provider,{value:n},e)}function Lk(){let{matches:n}=k.useContext(ni),e=n[n.length-1];return e?e.params:{}}function lm(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=k.useContext(qi),{matches:i}=k.useContext(ni),{pathname:r}=Io(),a=JSON.stringify(y0(i,s.v7_relativeSplatPath));return k.useMemo(()=>v0(n,JSON.parse(a),r,t==="path"),[n,a,r,t])}function jk(n,e){return Ik(n,e)}function Ik(n,e,t,s){Lc()||He(!1);let{navigator:i}=k.useContext(qi),{matches:r}=k.useContext(ni),a=r[r.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let u=Io(),h;if(e){var d;let S=typeof e=="string"?Mc(e):e;l==="/"||(d=S.pathname)!=null&&d.startsWith(l)||He(!1),h=S}else h=u;let p=h.pathname||"/",m=p;if(l!=="/"){let S=l.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(S.length).join("/")}let g=ak(n,{pathname:m}),y=Bk(g&&g.map(S=>Object.assign({},S,{params:Object.assign({},o,S.params),pathname:Wr([l,i.encodeLocation?i.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?l:Wr([l,i.encodeLocation?i.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),r,t,s);return e&&y?k.createElement(om.Provider,{value:{location:Wu({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ir.Pop}},y):y}function Dk(){let n=Wk(),e=kk(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),t?k.createElement("pre",{style:i},t):null,null)}const Fk=k.createElement(Dk,null);class Ok extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?k.createElement(ni.Provider,{value:this.props.routeContext},k.createElement(Yb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function zk(n){let{routeContext:e,match:t,children:s}=n,i=k.useContext(am);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),k.createElement(ni.Provider,{value:e},s)}function Bk(n,e,t,s){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var r;if(!t)return null;if(t.errors)n=t.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(i=t)==null?void 0:i.errors;if(o!=null){let h=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);h>=0||He(!1),a=a.slice(0,Math.min(a.length,h+1))}let l=!1,u=-1;if(t&&s&&s.v7_partialHydration)for(let h=0;h<a.length;h++){let d=a[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:p,errors:m}=t,g=d.route.loader&&p[d.route.id]===void 0&&(!m||m[d.route.id]===void 0);if(d.route.lazy||g){l=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,d,p)=>{let m,g=!1,y=null,S=null;t&&(m=o&&d.route.id?o[d.route.id]:void 0,y=d.route.errorElement||Fk,l&&(u<0&&p===0?(Gk("route-fallback"),g=!0,S=null):u===p&&(g=!0,S=d.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,p+1)),x=()=>{let b;return m?b=y:g?b=S:d.route.Component?b=k.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=h,k.createElement(zk,{match:d,routeContext:{outlet:h,matches:v,isDataRoute:t!=null},children:b})};return t&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?k.createElement(Ok,{location:t.location,revalidation:t.revalidation,component:y,error:m,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}var Qb=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(Qb||{}),Jb=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(Jb||{});function Uk(n){let e=k.useContext(am);return e||He(!1),e}function Hk(n){let e=k.useContext(qb);return e||He(!1),e}function $k(n){let e=k.useContext(ni);return e||He(!1),e}function Zb(n){let e=$k(),t=e.matches[e.matches.length-1];return t.route.id||He(!1),t.route.id}function Wk(){var n;let e=k.useContext(Yb),t=Hk(),s=Zb();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function Vk(){let{router:n}=Uk(Qb.UseNavigateStable),e=Zb(Jb.UseNavigateStable),t=k.useRef(!1);return Kb(()=>{t.current=!0}),k.useCallback(function(i,r){r===void 0&&(r={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,Wu({fromRouteId:e},r)))},[n,e])}const Zw={};function Gk(n,e,t){Zw[n]||(Zw[n]=!0)}function Xk(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Zg(n){let{to:e,replace:t,state:s,relative:i}=n;Lc()||He(!1);let{future:r,static:a}=k.useContext(qi),{matches:o}=k.useContext(ni),{pathname:l}=Io(),u=ea(),h=v0(e,y0(o,r.v7_relativeSplatPath),l,i==="path"),d=JSON.stringify(h);return k.useEffect(()=>u(JSON.parse(d),{replace:t,state:s,relative:i}),[u,d,i,t,s]),null}function qk(n){return Mk(n.context)}function Bn(n){He(!1)}function Yk(n){let{basename:e="/",children:t=null,location:s,navigationType:i=Ir.Pop,navigator:r,static:a=!1,future:o}=n;Lc()&&He(!1);let l=e.replace(/^\/*/,"/"),u=k.useMemo(()=>({basename:l,navigator:r,static:a,future:Wu({v7_relativeSplatPath:!1},o)}),[l,o,r,a]);typeof s=="string"&&(s=Mc(s));let{pathname:h="/",search:d="",hash:p="",state:m=null,key:g="default"}=s,y=k.useMemo(()=>{let S=kc(h,l);return S==null?null:{location:{pathname:S,search:d,hash:p,state:m,key:g},navigationType:i}},[l,h,d,p,m,g,i]);return y==null?null:k.createElement(qi.Provider,{value:u},k.createElement(om.Provider,{children:t,value:y}))}function Kk(n){let{children:e,location:t}=n;return jk(ey(e),t)}new Promise(()=>{});function ey(n,e){e===void 0&&(e=[]);let t=[];return k.Children.forEach(n,(s,i)=>{if(!k.isValidElement(s))return;let r=[...e,i];if(s.type===k.Fragment){t.push.apply(t,ey(s.props.children,r));return}s.type!==Bn&&He(!1),!s.props.index||!s.props.children||He(!1);let a={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=ey(s.props.children,r)),t.push(a)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fp(){return fp=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},fp.apply(this,arguments)}function eS(n,e){if(n==null)return{};var t={},s=Object.keys(n),i,r;for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function Qk(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Jk(n,e){return n.button===0&&(!e||e==="_self")&&!Qk(n)}function ty(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(i=>[t,i]):[[t,s]])},[]))}function Zk(n,e){let t=ty(n);return e&&e.forEach((s,i)=>{t.has(i)||e.getAll(i).forEach(r=>{t.append(i,r)})}),t}const e2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],t2=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],n2="6";try{window.__reactRouterVersion=n2}catch{}const s2=k.createContext({isTransitioning:!1}),i2="startTransition",ex=V_[i2];function r2(n){let{basename:e,children:t,future:s,window:i}=n,r=k.useRef();r.current==null&&(r.current=sk({window:i,v5Compat:!0}));let a=r.current,[o,l]=k.useState({action:a.action,location:a.location}),{v7_startTransition:u}=s||{},h=k.useCallback(d=>{u&&ex?ex(()=>l(d)):l(d)},[l,u]);return k.useLayoutEffect(()=>a.listen(h),[a,h]),k.useEffect(()=>Xk(s),[s]),k.createElement(Yk,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:s})}const a2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",o2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,l2=k.forwardRef(function(e,t){let{onClick:s,relative:i,reloadDocument:r,replace:a,state:o,target:l,to:u,preventScrollReset:h,viewTransition:d}=e,p=eS(e,e2),{basename:m}=k.useContext(qi),g,y=!1;if(typeof u=="string"&&o2.test(u)&&(g=u,a2))try{let b=new URL(window.location.href),E=u.startsWith("//")?new URL(b.protocol+u):new URL(u),C=kc(E.pathname,m);E.origin===b.origin&&C!=null?u=C+E.search+E.hash:y=!0}catch{}let S=Pk(u,{relative:i}),v=h2(u,{replace:a,state:o,target:l,preventScrollReset:h,relative:i,viewTransition:d});function x(b){s&&s(b),b.defaultPrevented||v(b)}return k.createElement("a",fp({},p,{href:g||S,onClick:y||r?s:x,ref:t,target:l}))}),c2=k.forwardRef(function(e,t){let{"aria-current":s="page",caseSensitive:i=!1,className:r="",end:a=!1,style:o,to:l,viewTransition:u,children:h}=e,d=eS(e,t2),p=lm(l,{relative:d.relative}),m=Io(),g=k.useContext(qb),{navigator:y,basename:S}=k.useContext(qi),v=g!=null&&f2(p)&&u===!0,x=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,b=m.pathname,E=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;i||(b=b.toLowerCase(),E=E?E.toLowerCase():null,x=x.toLowerCase()),E&&S&&(E=kc(E,S)||E);const C=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let P=b===x||!a&&b.startsWith(x)&&b.charAt(C)==="/",N=E!=null&&(E===x||!a&&E.startsWith(x)&&E.charAt(x.length)==="/"),T={isActive:P,isPending:N,isTransitioning:v},R=P?s:void 0,L;typeof r=="function"?L=r(T):L=[r,P?"active":null,N?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let I=typeof o=="function"?o(T):o;return k.createElement(l2,fp({},d,{"aria-current":R,className:L,ref:t,style:I,to:l,viewTransition:u}),typeof h=="function"?h(T):h)});var ny;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(ny||(ny={}));var tx;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(tx||(tx={}));function u2(n){let e=k.useContext(am);return e||He(!1),e}function h2(n,e){let{target:t,replace:s,state:i,preventScrollReset:r,relative:a,viewTransition:o}=e===void 0?{}:e,l=ea(),u=Io(),h=lm(n,{relative:a});return k.useCallback(d=>{if(Jk(d,t)){d.preventDefault();let p=s!==void 0?s:dp(u)===dp(h);l(n,{replace:p,state:i,preventScrollReset:r,relative:a,viewTransition:o})}},[u,l,h,s,i,t,n,r,a,o])}function d2(n){let e=k.useRef(ty(n)),t=k.useRef(!1),s=Io(),i=k.useMemo(()=>Zk(s.search,t.current?null:e.current),[s.search]),r=ea(),a=k.useCallback((o,l)=>{const u=ty(typeof o=="function"?o(i):o);t.current=!0,r("?"+u,l)},[r,i]);return[i,a]}function f2(n,e){e===void 0&&(e={});let t=k.useContext(s2);t==null&&He(!1);let{basename:s}=u2(ny.useViewTransitionState),i=lm(n,{relative:e.relative});if(!t.isTransitioning)return!1;let r=kc(t.currentLocation.pathname,s)||t.currentLocation.pathname,a=kc(t.nextLocation.pathname,s)||t.nextLocation.pathname;return Jg(i.pathname,a)!=null||Jg(i.pathname,r)!=null}const Hc="/api";console.log("[SRAMS] API Service initialized at",new Date().toISOString());function Xm(){const n=document.cookie.split(";");for(const e of n){const[t,s]=e.trim().split("=");if(t==="csrf_token")return decodeURIComponent(s)}return null}class p2{async request(e,t={}){const{method:s="GET",body:i,headers:r={}}=t,a=localStorage.getItem("access_token"),o=localStorage.getItem("device_id"),l=Xm(),u={"Content-Type":"application/json",...r};a&&(u.Authorization=`Bearer ${a}`),o&&(u["X-Device-ID"]=o),l&&s!=="GET"&&(u["X-CSRF-Token"]=l);const h=localStorage.getItem("desktop_session");h&&(u["X-Desktop-Session"]=h);const d=await fetch(`${Hc}${e}`,{method:s,headers:u,body:i?JSON.stringify(i):void 0,credentials:"include"});if(d.status===401){const m=await d.json();if(m.code==="TOKEN_EXPIRED"&&await this.refreshToken())return this.request(e,t);throw new Error(m.error||"Unauthorized")}if(!d.ok){const m=await d.json().catch(()=>({}));throw new Error(m.error||`Request failed: ${d.status}`)}return{data:await d.json()}}async refreshToken(){const e=localStorage.getItem("refresh_token");if(!e)return!1;try{const t=await fetch(`${Hc}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});if(!t.ok)return!1;const s=await t.json();return localStorage.setItem("access_token",s.access_token),localStorage.setItem("refresh_token",s.refresh_token),!0}catch{return!1}}async get(e){return this.request(e)}async post(e,t){return this.request(e,{method:"POST",body:t})}async put(e,t){return this.request(e,{method:"PUT",body:t})}async delete(e){return this.request(e,{method:"DELETE"})}async downloadBlob(e){const t=localStorage.getItem("access_token"),s=localStorage.getItem("device_id"),i=localStorage.getItem("desktop_session"),r={};t&&(r.Authorization=`Bearer ${t}`),s&&(r["X-Device-ID"]=s),i&&(r["X-Desktop-Session"]=i);const a=await fetch(`${Hc}${e}`,{method:"GET",headers:r,credentials:"include"});if(!a.ok){const o=await a.json().catch(()=>({}));throw new Error(o.error||"Download failed")}return a.blob()}async uploadFormData(e,t){const s=localStorage.getItem("access_token"),i=localStorage.getItem("device_id"),r=Xm(),a=localStorage.getItem("desktop_session"),o={};s&&(o.Authorization=`Bearer ${s}`),i&&(o["X-Device-ID"]=i),r&&(o["X-CSRF-Token"]=r),a&&(o["X-Desktop-Session"]=a);const l=await fetch(`${Hc}${e}`,{method:"POST",headers:o,body:t,credentials:"include"});if(!l.ok){const h=await l.json().catch(()=>({}));throw new Error(h.error||"Upload failed")}return{data:await l.json()}}async upload(e,t,s){const i=localStorage.getItem("access_token"),r=localStorage.getItem("device_id"),a=Xm(),o=localStorage.getItem("desktop_session"),l=new FormData;l.append("file",t),s&&l.append("title",s);const u={};i&&(u.Authorization=`Bearer ${i}`),r&&(u["X-Device-ID"]=r),a&&(u["X-CSRF-Token"]=a),o&&(u["X-Desktop-Session"]=o);const h=await fetch(`${Hc}${e}`,{method:"POST",headers:u,body:l,credentials:"include"});if(!h.ok){const p=await h.json().catch(()=>({}));throw new Error(p.error||"Upload failed")}return{data:await h.json()}}async logEvent(e,t,s,i){try{await this.post("/audit/log",{action_type:e,target_type:t,target_id:s,metadata:i})}catch{}}async getDocumentAccess(e){return this.get(`/documents/id/${e}/access`)}async grantAccess(e,t){return this.post(`/documents/id/${e}/access`,{user_id:t})}async revokeAccess(e,t){return this.delete(`/documents/id/${e}/access/${t}`)}}const ae=new p2,tS=k.createContext(null);function m2({children:n}){const[e,t]=k.useState(null),[s,i]=k.useState(!0);k.useEffect(()=>{r()},[]);const r=async()=>{if(!localStorage.getItem("access_token")){i(!1);return}try{const h=await ae.get("/users/me");t(h.data)}catch{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}finally{i(!1)}},a=async(u,h,d)=>{const p=g2(),m=await ae.post("/auth/login",{email:u,password:h,totp_code:d,device_id:p});return m.data.requires_totp?{requiresTOTP:!0}:(localStorage.setItem("access_token",m.data.access_token),localStorage.setItem("refresh_token",m.data.refresh_token),m.data.client_ip&&localStorage.setItem("client_ip",m.data.client_ip),t(m.data.user),{requiresPasswordChange:m.data.requires_password_change||!1,requiresMFAEnrollment:m.data.requires_mfa_enrollment||!1})},o=async()=>{try{await ae.post("/auth/logout")}catch{}localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),t(null)},l=async()=>{const u=await ae.get("/users/me");t(u.data)};return f.jsx(tS.Provider,{value:{user:e,loading:s,login:a,logout:o,refreshUser:l},children:n})}function pn(){const n=k.useContext(tS);if(!n)throw new Error("useAuth must be used within AuthProvider");return n}function g2(){let n=localStorage.getItem("device_id");return n||(n="web-"+y2(),localStorage.setItem("device_id",n)),n}function y2(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}const nS=k.createContext(null);function v2({children:n}){const{user:e}=pn(),[t,s]=k.useState(()=>{const r=localStorage.getItem("theme");return r==="twilight"||r==="glacium"?r:"twilight"});k.useEffect(()=>{e?e.role==="super_admin"||e.role==="admin"?s("twilight"):s("glacium"):s("twilight")},[e]),k.useEffect(()=>{document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t)},[t]);const i=()=>{s(r=>r==="twilight"?"glacium":"twilight")};return f.jsx(nS.Provider,{value:{theme:t,toggleTheme:i},children:n})}function sS(){const n=k.useContext(nS);if(!n)throw new Error("useTheme must be used within ThemeProvider");return n}class w2 extends k.Component{constructor(){super(...arguments);Q(this,"state",{hasError:!1,error:null,errorInfo:null})}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,s){console.error("ErrorBoundary caught an error:",t,s),this.setState({errorInfo:s})}render(){var t,s;return this.state.hasError?f.jsxs("div",{style:{padding:"40px",textAlign:"center",background:"var(--color-bg-primary, #1a1a2e)",color:"var(--color-text-primary, #fff)",minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[f.jsx("h1",{style:{color:"#ff6b6b",marginBottom:"20px"},children:"Something went wrong"}),f.jsx("p",{style:{marginBottom:"20px",opacity:.8},children:"An error occurred while rendering the page."}),f.jsxs("details",{style:{textAlign:"left",maxWidth:"600px",background:"rgba(0,0,0,0.3)",padding:"20px",borderRadius:"8px",marginBottom:"20px"},children:[f.jsx("summary",{style:{cursor:"pointer",marginBottom:"10px"},children:"Error Details"}),f.jsxs("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"12px",color:"#ff6b6b"},children:[(t=this.state.error)==null?void 0:t.toString(),`

`,(s=this.state.errorInfo)==null?void 0:s.componentStack]})]}),f.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",background:"var(--color-accent-primary, #6366f1)",color:"#fff",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"16px"},children:"Reload Page"})]}):this.props.children}}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var x2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),le=(n,e)=>{const t=k.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:o="",children:l,...u},h)=>k.createElement("svg",{ref:h,...x2,width:i,height:i,stroke:s,strokeWidth:a?Number(r)*24/Number(i):r,className:["lucide",`lucide-${b2(n)}`,o].join(" "),...u},[...e.map(([d,p])=>k.createElement(d,p)),...Array.isArray(l)?l:[l]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nx=le("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nc=le("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sx=le("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=le("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=le("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=le("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=le("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=le("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=le("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=le("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=le("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=le("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=le("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=le("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ix=le("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=le("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=le("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w0=le("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=le("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pp=le("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=le("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=le("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=le("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=le("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x0=le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=le("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=le("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=le("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=le("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function O2(){const[n,e]=k.useState(""),[t,s]=k.useState(""),[i,r]=k.useState(""),[a,o]=k.useState(!1),[l,u]=k.useState(!1),[h,d]=k.useState(!1),[p,m]=k.useState(""),{login:g,user:y}=pn(),S=ea(),[v]=d2();k.useEffect(()=>{const b=v.get("auto"),E=v.get("token"),C=v.get("desktop_session"),P=v.get("refresh");if(b==="1"&&E&&C){localStorage.setItem("access_token",E),localStorage.setItem("desktop_session",C),P&&localStorage.setItem("refresh_token",P),window.history.replaceState({},document.title,"/login"),window.location.href="/dashboard";return}C&&!E&&(localStorage.setItem("desktop_session",C),window.history.replaceState({},document.title,"/login")),y&&S("/dashboard")},[v,y,S]);const x=async b=>{b.preventDefault(),m(""),d(!0);try{const E=await g(n,t,l?i:void 0);if(E.requiresTOTP){u(!0),d(!1);return}if(E.requiresPasswordChange){S("/force-change-password");return}if(E.requiresMFAEnrollment){S("/force-enroll-mfa");return}S("/dashboard")}catch(E){m(E instanceof Error?E.message:"Login failed"),d(!1)}};return f.jsxs("div",{className:"login-page",children:[f.jsxs("div",{className:"login-bg",children:[f.jsx("div",{className:"bg-gradient"}),f.jsx("div",{className:"bg-pattern"})]}),f.jsx("div",{className:"login-container animate-slideUp",children:f.jsxs("div",{className:"login-card glass-card",children:[f.jsxs("div",{className:"login-header",children:[f.jsx("div",{className:"logo-icon",children:f.jsx(Vu,{size:40})}),f.jsx("h1",{children:"SRAMS"}),f.jsx("p",{children:"Secure Role-Based Audit Management System"})]}),f.jsxs("form",{onSubmit:x,className:"login-form",children:[f.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to SRAMS Enterprise"}),p&&f.jsx("div",{className:"error-message",children:p}),l?f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Two-Factor Authentication Code"}),f.jsx("input",{type:"text",className:"input totp-input",value:i,onChange:b=>r(b.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",required:!0,autoComplete:"one-time-code",maxLength:6}),f.jsx("p",{className:"totp-hint",children:"Enter the 6-digit code from your authenticator app"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Email"}),f.jsx("input",{type:"email",className:"input",value:n,onChange:b=>e(b.target.value),placeholder:"admin@example.com",required:!0,autoComplete:"email"})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Password"}),f.jsxs("div",{className:"password-input",children:[f.jsx("input",{type:a?"text":"password",className:"input",value:t,onChange:b=>s(b.target.value),placeholder:"",required:!0,autoComplete:"current-password"}),f.jsx("button",{type:"button",className:"toggle-password",onClick:()=>o(!a),children:a?f.jsx(uf,{size:18}):f.jsx(hf,{size:18})})]})]})]}),f.jsx("button",{type:"submit",className:"btn btn-primary login-btn",disabled:h,children:h?f.jsxs(f.Fragment,{children:[f.jsx(P2,{size:18,className:"animate-spin"}),f.jsx("span",{children:"Signing in..."})]}):f.jsx("span",{children:l?"Verify":"Sign In"})}),l&&f.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{u(!1),r("")},children:"Back to Login"})]}),f.jsx("div",{className:"login-footer",children:f.jsx("p",{children:"Secure  Audited  Compliant"})})]})})]})}function z2(){const n=ea(),{refreshUser:e}=pn(),[t,s]=k.useState(""),[i,r]=k.useState(""),[a,o]=k.useState(""),[l,u]=k.useState(!1),[h,d]=k.useState(!1),[p,m]=k.useState(!1),[g,y]=k.useState(""),[S,v]=k.useState(!1),x=async b=>{var E,C;if(b.preventDefault(),y(""),i!==a){y("New passwords do not match");return}if(i.length<8){y("Password must be at least 8 characters");return}if(i===t){y("New password must be different from current password");return}v(!0);try{await ae.post("/auth/change-password",{current_password:t,new_password:i}),await e(),(await ae.get("/auth/profile")).data.must_enroll_mfa?n("/force-enroll-mfa"):n("/dashboard")}catch(P){const N=P;y(((C=(E=N==null?void 0:N.response)==null?void 0:E.data)==null?void 0:C.error)||"Failed to change password")}finally{v(!1)}};return f.jsx("div",{className:"login-page",children:f.jsx("div",{className:"login-container",children:f.jsxs("div",{className:"login-card glass-card",children:[f.jsxs("div",{className:"login-header",children:[f.jsx("div",{className:"login-icon",children:f.jsx(w0,{size:32})}),f.jsx("h1",{children:"Password Change Required"}),f.jsx("p",{children:"For security reasons, you must change your password before continuing."})]}),f.jsxs("form",{onSubmit:x,className:"login-form",children:[g&&f.jsxs("div",{className:"error-message",children:[f.jsx(Nc,{size:16}),f.jsx("span",{children:g})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Current Password"}),f.jsxs("div",{className:"input-wrapper",children:[f.jsx("input",{type:l?"text":"password",className:"input",placeholder:"Enter your current password",value:t,onChange:b=>s(b.target.value),required:!0,autoComplete:"current-password"}),f.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>u(!l),tabIndex:-1,children:l?f.jsx(uf,{size:18}):f.jsx(hf,{size:18})})]})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"New Password"}),f.jsxs("div",{className:"input-wrapper",children:[f.jsx("input",{type:h?"text":"password",className:"input",placeholder:"Enter your new password",value:i,onChange:b=>r(b.target.value),required:!0,minLength:8,autoComplete:"new-password"}),f.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>d(!h),tabIndex:-1,children:h?f.jsx(uf,{size:18}):f.jsx(hf,{size:18})})]})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Confirm New Password"}),f.jsxs("div",{className:"input-wrapper",children:[f.jsx("input",{type:p?"text":"password",className:"input",placeholder:"Confirm your new password",value:a,onChange:b=>o(b.target.value),required:!0,minLength:8,autoComplete:"new-password"}),f.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>m(!p),tabIndex:-1,children:p?f.jsx(uf,{size:18}):f.jsx(hf,{size:18})})]})]}),i.length>=8&&i===a&&f.jsxs("div",{className:"success-hint",children:[f.jsx(iS,{size:16}),f.jsx("span",{children:"Passwords match!"})]}),f.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:S||!t||!i||!a,children:S?"Changing Password...":"Change Password & Continue"})]})]})})})}var B2=Object.defineProperty,mp=Object.getOwnPropertySymbols,hS=Object.prototype.hasOwnProperty,dS=Object.prototype.propertyIsEnumerable,rx=(n,e,t)=>e in n?B2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ay=(n,e)=>{for(var t in e||(e={}))hS.call(e,t)&&rx(n,t,e[t]);if(mp)for(var t of mp(e))dS.call(e,t)&&rx(n,t,e[t]);return n},oy=(n,e)=>{var t={};for(var s in n)hS.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&mp)for(var s of mp(n))e.indexOf(s)<0&&dS.call(n,s)&&(t[s]=n[s]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var ko;(n=>{const e=class he{constructor(l,u,h,d){if(this.version=l,this.errorCorrectionLevel=u,this.modules=[],this.isFunction=[],l<he.MIN_VERSION||l>he.MAX_VERSION)throw new RangeError("Version value out of range");if(d<-1||d>7)throw new RangeError("Mask value out of range");this.size=l*4+17;let p=[];for(let g=0;g<this.size;g++)p.push(!1);for(let g=0;g<this.size;g++)this.modules.push(p.slice()),this.isFunction.push(p.slice());this.drawFunctionPatterns();const m=this.addEccAndInterleave(h);if(this.drawCodewords(m),d==-1){let g=1e9;for(let y=0;y<8;y++){this.applyMask(y),this.drawFormatBits(y);const S=this.getPenaltyScore();S<g&&(d=y,g=S),this.applyMask(y)}}i(0<=d&&d<=7),this.mask=d,this.applyMask(d),this.drawFormatBits(d),this.isFunction=[]}static encodeText(l,u){const h=n.QrSegment.makeSegments(l);return he.encodeSegments(h,u)}static encodeBinary(l,u){const h=n.QrSegment.makeBytes(l);return he.encodeSegments([h],u)}static encodeSegments(l,u,h=1,d=40,p=-1,m=!0){if(!(he.MIN_VERSION<=h&&h<=d&&d<=he.MAX_VERSION)||p<-1||p>7)throw new RangeError("Invalid value");let g,y;for(g=h;;g++){const b=he.getNumDataCodewords(g,u)*8,E=a.getTotalBits(l,g);if(E<=b){y=E;break}if(g>=d)throw new RangeError("Data too long")}for(const b of[he.Ecc.MEDIUM,he.Ecc.QUARTILE,he.Ecc.HIGH])m&&y<=he.getNumDataCodewords(g,b)*8&&(u=b);let S=[];for(const b of l){t(b.mode.modeBits,4,S),t(b.numChars,b.mode.numCharCountBits(g),S);for(const E of b.getData())S.push(E)}i(S.length==y);const v=he.getNumDataCodewords(g,u)*8;i(S.length<=v),t(0,Math.min(4,v-S.length),S),t(0,(8-S.length%8)%8,S),i(S.length%8==0);for(let b=236;S.length<v;b^=253)t(b,8,S);let x=[];for(;x.length*8<S.length;)x.push(0);return S.forEach((b,E)=>x[E>>>3]|=b<<7-(E&7)),new he(g,u,x,p)}getModule(l,u){return 0<=l&&l<this.size&&0<=u&&u<this.size&&this.modules[u][l]}getModules(){return this.modules}drawFunctionPatterns(){for(let h=0;h<this.size;h++)this.setFunctionModule(6,h,h%2==0),this.setFunctionModule(h,6,h%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const l=this.getAlignmentPatternPositions(),u=l.length;for(let h=0;h<u;h++)for(let d=0;d<u;d++)h==0&&d==0||h==0&&d==u-1||h==u-1&&d==0||this.drawAlignmentPattern(l[h],l[d]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(l){const u=this.errorCorrectionLevel.formatBits<<3|l;let h=u;for(let p=0;p<10;p++)h=h<<1^(h>>>9)*1335;const d=(u<<10|h)^21522;i(d>>>15==0);for(let p=0;p<=5;p++)this.setFunctionModule(8,p,s(d,p));this.setFunctionModule(8,7,s(d,6)),this.setFunctionModule(8,8,s(d,7)),this.setFunctionModule(7,8,s(d,8));for(let p=9;p<15;p++)this.setFunctionModule(14-p,8,s(d,p));for(let p=0;p<8;p++)this.setFunctionModule(this.size-1-p,8,s(d,p));for(let p=8;p<15;p++)this.setFunctionModule(8,this.size-15+p,s(d,p));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let l=this.version;for(let h=0;h<12;h++)l=l<<1^(l>>>11)*7973;const u=this.version<<12|l;i(u>>>18==0);for(let h=0;h<18;h++){const d=s(u,h),p=this.size-11+h%3,m=Math.floor(h/3);this.setFunctionModule(p,m,d),this.setFunctionModule(m,p,d)}}drawFinderPattern(l,u){for(let h=-4;h<=4;h++)for(let d=-4;d<=4;d++){const p=Math.max(Math.abs(d),Math.abs(h)),m=l+d,g=u+h;0<=m&&m<this.size&&0<=g&&g<this.size&&this.setFunctionModule(m,g,p!=2&&p!=4)}}drawAlignmentPattern(l,u){for(let h=-2;h<=2;h++)for(let d=-2;d<=2;d++)this.setFunctionModule(l+d,u+h,Math.max(Math.abs(d),Math.abs(h))!=1)}setFunctionModule(l,u,h){this.modules[u][l]=h,this.isFunction[u][l]=!0}addEccAndInterleave(l){const u=this.version,h=this.errorCorrectionLevel;if(l.length!=he.getNumDataCodewords(u,h))throw new RangeError("Invalid argument");const d=he.NUM_ERROR_CORRECTION_BLOCKS[h.ordinal][u],p=he.ECC_CODEWORDS_PER_BLOCK[h.ordinal][u],m=Math.floor(he.getNumRawDataModules(u)/8),g=d-m%d,y=Math.floor(m/d);let S=[];const v=he.reedSolomonComputeDivisor(p);for(let b=0,E=0;b<d;b++){let C=l.slice(E,E+y-p+(b<g?0:1));E+=C.length;const P=he.reedSolomonComputeRemainder(C,v);b<g&&C.push(0),S.push(C.concat(P))}let x=[];for(let b=0;b<S[0].length;b++)S.forEach((E,C)=>{(b!=y-p||C>=g)&&x.push(E[b])});return i(x.length==m),x}drawCodewords(l){if(l.length!=Math.floor(he.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let u=0;for(let h=this.size-1;h>=1;h-=2){h==6&&(h=5);for(let d=0;d<this.size;d++)for(let p=0;p<2;p++){const m=h-p,y=(h+1&2)==0?this.size-1-d:d;!this.isFunction[y][m]&&u<l.length*8&&(this.modules[y][m]=s(l[u>>>3],7-(u&7)),u++)}}i(u==l.length*8)}applyMask(l){if(l<0||l>7)throw new RangeError("Mask value out of range");for(let u=0;u<this.size;u++)for(let h=0;h<this.size;h++){let d;switch(l){case 0:d=(h+u)%2==0;break;case 1:d=u%2==0;break;case 2:d=h%3==0;break;case 3:d=(h+u)%3==0;break;case 4:d=(Math.floor(h/3)+Math.floor(u/2))%2==0;break;case 5:d=h*u%2+h*u%3==0;break;case 6:d=(h*u%2+h*u%3)%2==0;break;case 7:d=((h+u)%2+h*u%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[u][h]&&d&&(this.modules[u][h]=!this.modules[u][h])}}getPenaltyScore(){let l=0;for(let p=0;p<this.size;p++){let m=!1,g=0,y=[0,0,0,0,0,0,0];for(let S=0;S<this.size;S++)this.modules[p][S]==m?(g++,g==5?l+=he.PENALTY_N1:g>5&&l++):(this.finderPenaltyAddHistory(g,y),m||(l+=this.finderPenaltyCountPatterns(y)*he.PENALTY_N3),m=this.modules[p][S],g=1);l+=this.finderPenaltyTerminateAndCount(m,g,y)*he.PENALTY_N3}for(let p=0;p<this.size;p++){let m=!1,g=0,y=[0,0,0,0,0,0,0];for(let S=0;S<this.size;S++)this.modules[S][p]==m?(g++,g==5?l+=he.PENALTY_N1:g>5&&l++):(this.finderPenaltyAddHistory(g,y),m||(l+=this.finderPenaltyCountPatterns(y)*he.PENALTY_N3),m=this.modules[S][p],g=1);l+=this.finderPenaltyTerminateAndCount(m,g,y)*he.PENALTY_N3}for(let p=0;p<this.size-1;p++)for(let m=0;m<this.size-1;m++){const g=this.modules[p][m];g==this.modules[p][m+1]&&g==this.modules[p+1][m]&&g==this.modules[p+1][m+1]&&(l+=he.PENALTY_N2)}let u=0;for(const p of this.modules)u=p.reduce((m,g)=>m+(g?1:0),u);const h=this.size*this.size,d=Math.ceil(Math.abs(u*20-h*10)/h)-1;return i(0<=d&&d<=9),l+=d*he.PENALTY_N4,i(0<=l&&l<=2568888),l}getAlignmentPatternPositions(){if(this.version==1)return[];{const l=Math.floor(this.version/7)+2,u=this.version==32?26:Math.ceil((this.version*4+4)/(l*2-2))*2;let h=[6];for(let d=this.size-7;h.length<l;d-=u)h.splice(1,0,d);return h}}static getNumRawDataModules(l){if(l<he.MIN_VERSION||l>he.MAX_VERSION)throw new RangeError("Version number out of range");let u=(16*l+128)*l+64;if(l>=2){const h=Math.floor(l/7)+2;u-=(25*h-10)*h-55,l>=7&&(u-=36)}return i(208<=u&&u<=29648),u}static getNumDataCodewords(l,u){return Math.floor(he.getNumRawDataModules(l)/8)-he.ECC_CODEWORDS_PER_BLOCK[u.ordinal][l]*he.NUM_ERROR_CORRECTION_BLOCKS[u.ordinal][l]}static reedSolomonComputeDivisor(l){if(l<1||l>255)throw new RangeError("Degree out of range");let u=[];for(let d=0;d<l-1;d++)u.push(0);u.push(1);let h=1;for(let d=0;d<l;d++){for(let p=0;p<u.length;p++)u[p]=he.reedSolomonMultiply(u[p],h),p+1<u.length&&(u[p]^=u[p+1]);h=he.reedSolomonMultiply(h,2)}return u}static reedSolomonComputeRemainder(l,u){let h=u.map(d=>0);for(const d of l){const p=d^h.shift();h.push(0),u.forEach((m,g)=>h[g]^=he.reedSolomonMultiply(m,p))}return h}static reedSolomonMultiply(l,u){if(l>>>8||u>>>8)throw new RangeError("Byte out of range");let h=0;for(let d=7;d>=0;d--)h=h<<1^(h>>>7)*285,h^=(u>>>d&1)*l;return i(h>>>8==0),h}finderPenaltyCountPatterns(l){const u=l[1];i(u<=this.size*3);const h=u>0&&l[2]==u&&l[3]==u*3&&l[4]==u&&l[5]==u;return(h&&l[0]>=u*4&&l[6]>=u?1:0)+(h&&l[6]>=u*4&&l[0]>=u?1:0)}finderPenaltyTerminateAndCount(l,u,h){return l&&(this.finderPenaltyAddHistory(u,h),u=0),u+=this.size,this.finderPenaltyAddHistory(u,h),this.finderPenaltyCountPatterns(h)}finderPenaltyAddHistory(l,u){u[0]==0&&(l+=this.size),u.pop(),u.unshift(l)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],n.QrCode=e;function t(o,l,u){if(l<0||l>31||o>>>l)throw new RangeError("Value out of range");for(let h=l-1;h>=0;h--)u.push(o>>>h&1)}function s(o,l){return(o>>>l&1)!=0}function i(o){if(!o)throw new Error("Assertion error")}const r=class We{constructor(l,u,h){if(this.mode=l,this.numChars=u,this.bitData=h,u<0)throw new RangeError("Invalid argument");this.bitData=h.slice()}static makeBytes(l){let u=[];for(const h of l)t(h,8,u);return new We(We.Mode.BYTE,l.length,u)}static makeNumeric(l){if(!We.isNumeric(l))throw new RangeError("String contains non-numeric characters");let u=[];for(let h=0;h<l.length;){const d=Math.min(l.length-h,3);t(parseInt(l.substring(h,h+d),10),d*3+1,u),h+=d}return new We(We.Mode.NUMERIC,l.length,u)}static makeAlphanumeric(l){if(!We.isAlphanumeric(l))throw new RangeError("String contains unencodable characters in alphanumeric mode");let u=[],h;for(h=0;h+2<=l.length;h+=2){let d=We.ALPHANUMERIC_CHARSET.indexOf(l.charAt(h))*45;d+=We.ALPHANUMERIC_CHARSET.indexOf(l.charAt(h+1)),t(d,11,u)}return h<l.length&&t(We.ALPHANUMERIC_CHARSET.indexOf(l.charAt(h)),6,u),new We(We.Mode.ALPHANUMERIC,l.length,u)}static makeSegments(l){return l==""?[]:We.isNumeric(l)?[We.makeNumeric(l)]:We.isAlphanumeric(l)?[We.makeAlphanumeric(l)]:[We.makeBytes(We.toUtf8ByteArray(l))]}static makeEci(l){let u=[];if(l<0)throw new RangeError("ECI assignment value out of range");if(l<128)t(l,8,u);else if(l<16384)t(2,2,u),t(l,14,u);else if(l<1e6)t(6,3,u),t(l,21,u);else throw new RangeError("ECI assignment value out of range");return new We(We.Mode.ECI,0,u)}static isNumeric(l){return We.NUMERIC_REGEX.test(l)}static isAlphanumeric(l){return We.ALPHANUMERIC_REGEX.test(l)}getData(){return this.bitData.slice()}static getTotalBits(l,u){let h=0;for(const d of l){const p=d.mode.numCharCountBits(u);if(d.numChars>=1<<p)return 1/0;h+=4+p+d.bitData.length}return h}static toUtf8ByteArray(l){l=encodeURI(l);let u=[];for(let h=0;h<l.length;h++)l.charAt(h)!="%"?u.push(l.charCodeAt(h)):(u.push(parseInt(l.substring(h+1,h+3),16)),h+=2);return u}};r.NUMERIC_REGEX=/^[0-9]*$/,r.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,r.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let a=r;n.QrSegment=r})(ko||(ko={}));(n=>{(e=>{const t=class{constructor(i,r){this.ordinal=i,this.formatBits=r}};t.LOW=new t(0,1),t.MEDIUM=new t(1,0),t.QUARTILE=new t(2,3),t.HIGH=new t(3,2),e.Ecc=t})(n.QrCode||(n.QrCode={}))})(ko||(ko={}));(n=>{(e=>{const t=class{constructor(i,r){this.modeBits=i,this.numBitsCharCount=r}numCharCountBits(i){return this.numBitsCharCount[Math.floor((i+7)/17)]}};t.NUMERIC=new t(1,[10,12,14]),t.ALPHANUMERIC=new t(2,[9,11,13]),t.BYTE=new t(4,[8,16,16]),t.KANJI=new t(8,[8,10,12]),t.ECI=new t(7,[0,0,0]),e.Mode=t})(n.QrSegment||(n.QrSegment={}))})(ko||(ko={}));var il=ko;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var U2={L:il.QrCode.Ecc.LOW,M:il.QrCode.Ecc.MEDIUM,Q:il.QrCode.Ecc.QUARTILE,H:il.QrCode.Ecc.HIGH},fS=128,pS="L",mS="#FFFFFF",gS="#000000",yS=!1,vS=1,H2=4,$2=0,W2=.1;function wS(n,e=0){const t=[];return n.forEach(function(s,i){let r=null;s.forEach(function(a,o){if(!a&&r!==null){t.push(`M${r+e} ${i+e}h${o-r}v1H${r+e}z`),r=null;return}if(o===s.length-1){if(!a)return;r===null?t.push(`M${o+e},${i+e} h1v1H${o+e}z`):t.push(`M${r+e},${i+e} h${o+1-r}v1H${r+e}z`);return}a&&r===null&&(r=o)})}),t.join("")}function xS(n,e){return n.slice().map((t,s)=>s<e.y||s>=e.y+e.h?t:t.map((i,r)=>r<e.x||r>=e.x+e.w?i:!1))}function V2(n,e,t,s){if(s==null)return null;const i=n.length+t*2,r=Math.floor(e*W2),a=i/e,o=(s.width||r)*a,l=(s.height||r)*a,u=s.x==null?n.length/2-o/2:s.x*a,h=s.y==null?n.length/2-l/2:s.y*a,d=s.opacity==null?1:s.opacity;let p=null;if(s.excavate){let g=Math.floor(u),y=Math.floor(h),S=Math.ceil(o+u-g),v=Math.ceil(l+h-y);p={x:g,y,w:S,h:v}}const m=s.crossOrigin;return{x:u,y:h,h:l,w:o,excavation:p,opacity:d,crossOrigin:m}}function G2(n,e){return e!=null?Math.max(Math.floor(e),0):n?H2:$2}function bS({value:n,level:e,minVersion:t,includeMargin:s,marginSize:i,imageSettings:r,size:a,boostLevel:o}){let l=Ye.useMemo(()=>{const g=(Array.isArray(n)?n:[n]).reduce((y,S)=>(y.push(...il.QrSegment.makeSegments(S)),y),[]);return il.QrCode.encodeSegments(g,U2[e],t,void 0,void 0,o)},[n,e,t,o]);const{cells:u,margin:h,numCells:d,calculatedImageSettings:p}=Ye.useMemo(()=>{let m=l.getModules();const g=G2(s,i),y=m.length+g*2,S=V2(m,a,g,r);return{cells:m,margin:g,numCells:y,calculatedImageSettings:S}},[l,a,r,s,i]);return{qrcode:l,margin:h,cells:u,numCells:d,calculatedImageSettings:p}}var X2=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),q2=Ye.forwardRef(function(e,t){const s=e,{value:i,size:r=fS,level:a=pS,bgColor:o=mS,fgColor:l=gS,includeMargin:u=yS,minVersion:h=vS,boostLevel:d,marginSize:p,imageSettings:m}=s,y=oy(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:S}=y,v=oy(y,["style"]),x=m==null?void 0:m.src,b=Ye.useRef(null),E=Ye.useRef(null),C=Ye.useCallback(Y=>{b.current=Y,typeof t=="function"?t(Y):t&&(t.current=Y)},[t]),[P,N]=Ye.useState(!1),{margin:T,cells:R,numCells:L,calculatedImageSettings:I}=bS({value:i,level:a,minVersion:h,boostLevel:d,includeMargin:u,marginSize:p,imageSettings:m,size:r});Ye.useEffect(()=>{if(b.current!=null){const Y=b.current,$=Y.getContext("2d");if(!$)return;let j=R;const z=E.current,M=I!=null&&z!==null&&z.complete&&z.naturalHeight!==0&&z.naturalWidth!==0;M&&I.excavation!=null&&(j=xS(R,I.excavation));const F=window.devicePixelRatio||1;Y.height=Y.width=r*F;const H=r/L*F;$.scale(H,H),$.fillStyle=o,$.fillRect(0,0,L,L),$.fillStyle=l,X2?$.fill(new Path2D(wS(j,T))):R.forEach(function(O,J){O.forEach(function(ge,De){ge&&$.fillRect(De+T,J+T,1,1)})}),I&&($.globalAlpha=I.opacity),M&&$.drawImage(z,I.x+T,I.y+T,I.w,I.h)}}),Ye.useEffect(()=>{N(!1)},[x]);const ne=ay({height:r,width:r},S);let B=null;return x!=null&&(B=Ye.createElement("img",{src:x,key:x,style:{display:"none"},onLoad:()=>{N(!0)},ref:E,crossOrigin:I==null?void 0:I.crossOrigin})),Ye.createElement(Ye.Fragment,null,Ye.createElement("canvas",ay({style:ne,height:r,width:r,ref:C,role:"img"},v)),B)});q2.displayName="QRCodeCanvas";var b0=Ye.forwardRef(function(e,t){const s=e,{value:i,size:r=fS,level:a=pS,bgColor:o=mS,fgColor:l=gS,includeMargin:u=yS,minVersion:h=vS,boostLevel:d,title:p,marginSize:m,imageSettings:g}=s,y=oy(s,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:S,cells:v,numCells:x,calculatedImageSettings:b}=bS({value:i,level:a,minVersion:h,boostLevel:d,includeMargin:u,marginSize:m,imageSettings:g,size:r});let E=v,C=null;g!=null&&b!=null&&(b.excavation!=null&&(E=xS(v,b.excavation)),C=Ye.createElement("image",{href:g.src,height:b.h,width:b.w,x:b.x+S,y:b.y+S,preserveAspectRatio:"none",opacity:b.opacity,crossOrigin:b.crossOrigin}));const P=wS(E,S);return Ye.createElement("svg",ay({height:r,width:r,viewBox:`0 0 ${x} ${x}`,ref:t,role:"img"},y),!!p&&Ye.createElement("title",null,p),Ye.createElement("path",{fill:o,d:`M0,0 h${x}v${x}H0z`,shapeRendering:"crispEdges"}),Ye.createElement("path",{fill:l,d:P,shapeRendering:"crispEdges"}),C)});b0.displayName="QRCodeSVG";function Y2(){const n=ea(),{refreshUser:e}=pn(),[t,s]=k.useState("intro"),[i,r]=k.useState(null),[a,o]=k.useState(""),[l,u]=k.useState(""),[h,d]=k.useState(!1),[p,m]=k.useState(!1);k.useEffect(()=>{t==="setup"&&g()},[t]);const g=async()=>{d(!0),u("");try{const x=await ae.get("/auth/totp/setup");r(x.data)}catch(x){u(x instanceof Error?x.message:"Failed to initialize MFA")}finally{d(!1)}},y=async x=>{if(x.preventDefault(),u(""),d(!0),!!i)try{const b=await ae.post("/auth/totp/enable",{secret:i.secret,code:a});r(E=>E?{...E,backup_codes:b.data.backup_codes}:null),s("backup")}catch(b){u(b instanceof Error?b.message:"Invalid verification code")}finally{d(!1)}},S=async()=>{await e(),n("/dashboard")},v=async()=>{if(!(i!=null&&i.backup_codes))return;const x=i.backup_codes.join(`
`);try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(x),m(!0);else throw new Error("Clipboard API unavailable")}catch{try{const E=document.createElement("textarea");E.value=x,E.style.position="fixed",E.style.left="-9999px",E.style.top="0",document.body.appendChild(E),E.focus(),E.select();const C=document.execCommand("copy");document.body.removeChild(E),C?m(!0):console.error("Fallback copy failed")}catch(E){console.error("Copy failed",E)}}setTimeout(()=>m(!1),2e3)};return f.jsx("div",{className:"mfa-page",children:f.jsxs("div",{className:"mfa-card",children:[t==="intro"&&f.jsxs("div",{className:"mfa-content",children:[f.jsxs("div",{className:"mfa-header",children:[f.jsx("div",{className:"mfa-icon-wrapper",children:f.jsx(Vu,{size:40,strokeWidth:1.5})}),f.jsx("h1",{className:"mfa-title",children:"Secure Your Account"}),f.jsx("p",{className:"mfa-subtitle",children:"Protecting your data is our priority. Set up Two-Factor Authentication (2FA) to continue."})]}),f.jsxs("ul",{className:"mfa-list",children:[f.jsxs("li",{className:"mfa-list-item",children:[f.jsx("div",{className:"step-number",children:"1"}),f.jsxs("span",{className:"mfa-list-text",children:["Download ",f.jsx("strong",{children:"Google Authenticator"})," or a similar app on your mobile device."]})]}),f.jsxs("li",{className:"mfa-list-item",children:[f.jsx("div",{className:"step-number",children:"2"}),f.jsx("span",{className:"mfa-list-text",children:"Scan the specific QR code we'll provide in the next step."})]}),f.jsxs("li",{className:"mfa-list-item",children:[f.jsx("div",{className:"step-number",children:"3"}),f.jsx("span",{className:"mfa-list-text",children:"Enter the 6-digit verification code generated by the app."})]})]}),f.jsxs("button",{className:"btn-premium btn-primary-gradient",onClick:()=>s("setup"),children:["Get Started ",f.jsx(sx,{size:20})]})]}),t==="setup"&&f.jsxs("div",{className:"mfa-content",style:{textAlign:"center"},children:[f.jsxs("div",{className:"mfa-header",children:[f.jsx("h2",{className:"mfa-title",children:"Scan QR Code"}),f.jsx("p",{className:"mfa-subtitle",children:"Open your authenticator app and scan the code below."})]}),h||!i?f.jsxs("div",{className:"loading-dots",children:[f.jsx("div",{className:"dot"}),f.jsx("div",{className:"dot"}),f.jsx("div",{className:"dot"})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"qr-section",children:f.jsx(b0,{value:i.qr_url,size:200,level:"L",includeMargin:!0})}),f.jsx("p",{className:"mfa-subtitle",style:{marginBottom:"1rem"},children:"Or enter this code manually:"}),f.jsx("div",{className:"secret-container",children:i.secret}),f.jsxs("button",{className:"btn-premium btn-primary-gradient",onClick:()=>s("verify"),children:["I've Scanned It ",f.jsx(sx,{size:20})]})]}),l&&f.jsxs("div",{className:"error-banner",style:{marginTop:"1rem"},children:[f.jsx(Nc,{size:16})," ",l]})]}),t==="verify"&&f.jsxs("form",{onSubmit:y,className:"mfa-content",children:[f.jsxs("div",{className:"mfa-header",children:[f.jsx("div",{className:"mfa-icon-wrapper",children:f.jsx(w0,{size:40,strokeWidth:1.5})}),f.jsx("h2",{className:"mfa-title",children:"Verify Setup"}),f.jsx("p",{className:"mfa-subtitle",children:"Enter the 6-digit code from your authenticator app to enable 2FA."})]}),f.jsx("div",{className:"code-input-group",children:f.jsx("input",{type:"text",className:"totp-input-premium",placeholder:"000 000",value:a,onChange:x=>o(x.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,pattern:"[0-9]{6}",required:!0,autoFocus:!0})}),l&&f.jsxs("div",{className:"error-banner",children:[f.jsx(Nc,{size:16})," ",l]}),f.jsx("button",{type:"submit",className:"btn-premium btn-primary-gradient",disabled:h||a.length!==6,children:h?"Verifying...":"Verify & Enable"}),f.jsx("button",{type:"button",className:"btn-premium btn-secondary-ghost",onClick:()=>s("setup"),children:"Back to QR Code"})]}),t==="backup"&&f.jsxs("div",{className:"mfa-content",children:[f.jsxs("div",{className:"mfa-header",children:[f.jsx("div",{className:"mfa-icon-wrapper",style:{color:"#10b981",background:"rgba(16, 185, 129, 0.1)",boxShadow:"0 0 0 8px rgba(16, 185, 129, 0.05)"},children:f.jsx(sy,{size:40,strokeWidth:1.5})}),f.jsx("h2",{className:"mfa-title",children:"Setup Complete!"}),f.jsx("p",{className:"mfa-subtitle",children:"Save these backup codes in a secure place. You can use them to login if you lose access to your device."})]}),f.jsx("div",{className:"backup-codes",style:{background:"rgba(0,0,0,0.3)",padding:"1.5rem",borderRadius:"12px",display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"2rem",fontFamily:"monospace"},children:i==null?void 0:i.backup_codes.map((x,b)=>f.jsx("div",{style:{color:"#e2e8f0",textAlign:"center",letterSpacing:"0.05em"},children:x},b))}),f.jsx("button",{className:"btn-premium btn-secondary-ghost",onClick:v,style:{marginBottom:"1rem",marginTop:0},children:p?f.jsxs(f.Fragment,{children:[f.jsx(rS,{size:18})," Copied to Clipboard"]}):f.jsxs(f.Fragment,{children:[f.jsx(E2,{size:18})," Copy All Codes"]})}),f.jsx("button",{className:"btn-premium btn-primary-gradient",onClick:S,children:"Continue to Dashboard"})]})]})})}function K2(){const{user:n}=pn(),[e,t]=k.useState(null),[s,i]=k.useState([]),[r,a]=k.useState([]),[o,l]=k.useState(!0),u=(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="super_admin";k.useEffect(()=>{h(),ae.logEvent("page_view","dashboard")},[]);const h=async()=>{try{if(u){const m=await ae.get("/dashboard/stats");t(m.data)}const d=await ae.get("/documents/my?limit=5");i(d.data.documents||[]);const p=await ae.get("/requests/my?limit=5");a(p.data.requests||[])}catch(d){console.error("Failed to load dashboard:",d)}finally{l(!1)}};return o?f.jsx("div",{className:"loading-container",children:f.jsx("div",{className:"loading-spinner"})}):f.jsxs("div",{className:"dashboard animate-fadeIn",children:[f.jsxs("header",{className:"page-header",children:[f.jsxs("h1",{children:["Welcome back, ",n==null?void 0:n.full_name]}),f.jsx("p",{children:u?"Here's an overview of your system":"Access your documents and manage requests"})]}),u&&e&&f.jsxs("div",{className:"stats-grid",children:[f.jsx(Gd,{icon:f.jsx(Co,{}),label:"Total Users",value:e.total_users,subtext:`${e.active_users??0} active`,color:"blue"}),f.jsx(Gd,{icon:f.jsx(Js,{}),label:"Documents",value:e.total_documents,color:"purple"}),f.jsx(Gd,{icon:f.jsx(Nc,{}),label:"Pending Requests",value:e.pending_requests,color:"yellow"}),f.jsx(Gd,{icon:f.jsx(nx,{}),label:"Active Sessions",value:e.active_sessions,subtext:`${e.today_logins??0} logins today`,color:"green"})]}),f.jsxs("div",{className:"dashboard-grid",children:[f.jsxs("div",{className:"dashboard-section glass-card",children:[f.jsxs("div",{className:"section-header",children:[f.jsxs("h2",{children:[f.jsx(Js,{size:20})," My Documents"]}),f.jsx("a",{href:"/documents",className:"view-all",children:"View All "})]}),s.length>0?f.jsx("div",{className:"document-list",children:s.map(d=>f.jsxs("a",{href:`/documents/${d.id}`,className:"document-item",children:[f.jsx(Js,{size:18}),f.jsxs("div",{className:"document-info",children:[f.jsx("span",{className:"document-title",children:d.title}),f.jsx("span",{className:"document-date",children:new Date(d.created_at).toLocaleDateString()})]})]},d.id))}):f.jsxs("div",{className:"empty-state",children:[f.jsx(Js,{size:40}),f.jsx("p",{children:"No documents assigned yet"})]})]}),f.jsxs("div",{className:"dashboard-section glass-card",children:[f.jsx("div",{className:"section-header",children:f.jsxs("h2",{children:[f.jsx(iy,{size:20})," My Requests"]})}),r.length>0?f.jsx("div",{className:"request-list",children:r.map(d=>f.jsxs("div",{className:"request-item",children:[f.jsx(Q2,{status:d.status}),f.jsxs("div",{className:"request-info",children:[f.jsx("span",{className:"request-reason",children:d.reason||"Document access request"}),f.jsx("span",{className:"request-date",children:new Date(d.created_at).toLocaleDateString()})]}),f.jsx("span",{className:`badge badge-${J2(d.status)}`,children:d.status})]},d.id))}):f.jsxs("div",{className:"empty-state",children:[f.jsx(iy,{size:40}),f.jsx("p",{children:"No requests yet"})]})]})]}),f.jsxs("div",{className:"quick-actions glass-card",children:[f.jsx("h2",{children:"Quick Actions"}),f.jsxs("div",{className:"action-buttons",children:[f.jsxs("a",{href:"/documents",className:"btn btn-primary",children:[f.jsx(Js,{size:18}),"Browse Documents"]}),u&&f.jsxs(f.Fragment,{children:[f.jsxs("a",{href:"/users",className:"btn btn-secondary",children:[f.jsx(Co,{size:18}),"Manage Users"]}),f.jsxs("a",{href:"/audit",className:"btn btn-secondary",children:[f.jsx(nx,{size:18}),"View Audit Logs"]})]})]})]})]})}function Gd({icon:n,label:e,value:t,subtext:s,color:i}){return f.jsxs("div",{className:`stat-card glass-card stat-${i}`,children:[f.jsx("div",{className:"stat-icon",children:n}),f.jsxs("div",{className:"stat-content",children:[f.jsx("span",{className:"stat-value",children:(t??0).toLocaleString()}),f.jsx("span",{className:"stat-label",children:e}),s&&f.jsx("span",{className:"stat-subtext",children:s})]})]})}function Q2({status:n}){switch(n){case"approved":return f.jsx(iS,{size:18,className:"status-approved"});case"rejected":return f.jsx(I2,{size:18,className:"status-rejected"});default:return f.jsx(iy,{size:18,className:"status-pending"})}}function J2(n){switch(n){case"approved":return"success";case"rejected":return"error";default:return"warning"}}function Z2(){const{user:n}=pn(),[e,t]=k.useState([]),[s,i]=k.useState([]),[r,a]=k.useState(!0),[o,l]=k.useState(""),[u,h]=k.useState(!1),[d,p]=k.useState(!1),[m,g]=k.useState(!1),[y,S]=k.useState(null),v=(n==null?void 0:n.role)==="super_admin";k.useEffect(()=>{x()},[]);const x=async()=>{try{const N=await ae.get("/documents/my");if(t(N.data.documents||[]),v){const T=await ae.get("/documents");i(T.data.documents||[])}}catch(N){console.error("Failed to load documents:",N)}finally{a(!1)}},b=N=>N<1024?N+" B":N<1024*1024?(N/1024).toFixed(1)+" KB":(N/(1024*1024)).toFixed(1)+" MB",E=e.filter(N=>N.title.toLowerCase().includes(o.toLowerCase())||N.filename.toLowerCase().includes(o.toLowerCase())),C=s.filter(N=>N.title.toLowerCase().includes(o.toLowerCase())||N.filename.toLowerCase().includes(o.toLowerCase())),P=(N,T)=>{N.preventDefault(),N.stopPropagation(),S(T),g(!0)};return r?f.jsx("div",{className:"loading-container",children:f.jsx("div",{className:"loading-spinner"})}):f.jsxs("div",{className:"documents-page animate-fadeIn",children:[f.jsxs("header",{className:"page-header",children:[f.jsxs("div",{children:[f.jsx("h1",{children:"Documents"}),f.jsx("p",{children:"View and manage your documents"})]}),f.jsxs("div",{className:"header-actions",children:[f.jsxs("button",{className:"btn btn-primary",onClick:()=>h(!0),children:[f.jsx(cm,{size:18}),"Upload"]}),!v&&f.jsxs("button",{className:"btn btn-secondary",onClick:()=>p(!0),children:[f.jsx(cS,{size:18}),"Request Access"]})]})]}),f.jsxs("div",{className:"search-bar glass-card",children:[f.jsx(uS,{size:20}),f.jsx("input",{type:"text",placeholder:"Search documents...",value:o,onChange:N=>l(N.target.value)})]}),!v&&f.jsxs("section",{className:"document-section",children:[f.jsx("h2",{children:"My Documents"}),E.length>0?f.jsx("div",{className:"document-grid",children:E.map(N=>f.jsxs("div",{className:"document-card glass-card",children:[f.jsxs("a",{href:`/documents/${N.id}`,className:"doc-link",children:[f.jsx("div",{className:"doc-icon",children:f.jsx(Js,{size:32})}),f.jsxs("div",{className:"doc-details",children:[f.jsx("h3",{children:N.title}),f.jsx("p",{children:N.filename}),f.jsxs("span",{className:"doc-meta",children:[b(N.file_size),"  ",new Date(N.created_at).toLocaleDateString()]})]})]}),(v||N.can_reassign)&&f.jsxs("button",{className:"btn btn-small btn-secondary assign-btn",onClick:T=>P(T,N),children:[f.jsx(Co,{size:14}),"Assign Users"]})]},N.id))}):f.jsxs("div",{className:"empty-state glass-card",children:[f.jsx(Js,{size:48}),f.jsx("h3",{children:"No documents"}),f.jsx("p",{children:"You don't have any assigned documents yet"})]})]}),v&&f.jsxs("section",{className:"document-section",children:[f.jsx("h2",{children:"All Documents"}),C.length>0?f.jsx("div",{className:"document-grid",children:C.map(N=>f.jsxs("div",{className:"document-card glass-card",children:[f.jsxs("a",{href:`/documents/${N.id}`,className:"doc-link",children:[f.jsx("div",{className:"doc-icon",children:f.jsx(Js,{size:32})}),f.jsxs("div",{className:"doc-details",children:[f.jsx("h3",{children:N.title}),f.jsx("p",{children:N.filename}),f.jsxs("span",{className:"doc-meta",children:[b(N.file_size),"  ",new Date(N.created_at).toLocaleDateString()]})]})]}),f.jsxs("button",{className:"btn btn-small btn-secondary assign-btn",onClick:T=>P(T,N),children:[f.jsx(Co,{size:14}),"Assign Users"]})]},N.id))}):f.jsxs("div",{className:"empty-state glass-card",children:[f.jsx(Js,{size:48}),f.jsx("h3",{children:"No documents uploaded"}),f.jsx("p",{children:"Upload your first document to get started"})]})]}),u&&f.jsx(eN,{onClose:()=>h(!1),onSuccess:x}),d&&f.jsx(tN,{documents:e,onClose:()=>p(!1),onSuccess:x}),m&&y&&f.jsx(nN,{document:y,currentUserRole:(n==null?void 0:n.role)||"",onClose:()=>{g(!1),S(null)},onSuccess:x})]})}function eN({onClose:n,onSuccess:e}){const[t,s]=k.useState(null),[i,r]=k.useState(""),[a,o]=k.useState(!1),[l,u]=k.useState(""),h=async()=>{if(t){o(!0),u("");try{await ae.upload("/documents/upload",t,i||t.name),e(),n()}catch(d){u(d instanceof Error?d.message:"Upload failed")}finally{o(!1)}}};return f.jsx("div",{className:"modal-overlay",onClick:n,children:f.jsxs("div",{className:"modal glass-card",onClick:d=>d.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{children:"Upload Document"}),f.jsx("button",{className:"close-btn",onClick:n,children:f.jsx(ta,{size:24})})]}),f.jsxs("div",{className:"modal-body",children:[l&&f.jsx("div",{className:"error-message",children:l}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Title"}),f.jsx("input",{type:"text",className:"input",value:i,onChange:d=>r(d.target.value),placeholder:"Document title"})]}),f.jsxs("div",{className:"file-input",children:[f.jsx("input",{type:"file",accept:".pdf",onChange:d=>{var p;return s(((p=d.target.files)==null?void 0:p[0])||null)}}),t&&f.jsx("span",{className:"file-name",children:t.name})]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Cancel"}),f.jsx("button",{className:"btn btn-primary",onClick:h,disabled:!t||a,children:a?"Uploading...":"Upload"})]})]})})}function tN({documents:n,onClose:e,onSuccess:t}){const[s,i]=k.useState(""),[r,a]=k.useState(""),[o,l]=k.useState(""),[u,h]=k.useState([]),[d,p]=k.useState(!1),[m,g]=k.useState("");k.useEffect(()=>{ae.get("/users").then(S=>{const v=(S.data.users||[]).filter(x=>x.role==="admin"||x.role==="super_admin");h(v)}).catch(console.error)},[]);const y=async()=>{var S;if(s.trim()){p(!0),g("");try{let v=r;o&&(v=`[Target: ${((S=u.find(b=>b.id===o))==null?void 0:S.full_name)||"Admin"}] ${r}`),await ae.post("/requests",{document_name:s,reason:v}),t(),e()}catch(v){g(v instanceof Error?v.message:"Request failed")}finally{p(!1)}}};return f.jsx("div",{className:"modal-overlay",onClick:e,children:f.jsxs("div",{className:"modal glass-card",onClick:S=>S.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{children:"Request Document Access"}),f.jsx("button",{className:"close-btn",onClick:e,children:f.jsx(ta,{size:24})})]}),f.jsxs("div",{className:"modal-body",children:[m&&f.jsx("div",{className:"error-message",children:m}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Document Name"}),f.jsx("input",{type:"text",className:"input",value:s,onChange:S=>i(S.target.value),placeholder:"Enter document name (e.g., Q3 Report)"})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Reason"}),f.jsx("textarea",{className:"input",value:r,onChange:S=>a(S.target.value),placeholder:"Why do you need access?",rows:2})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Target Admin (Optional)"}),f.jsxs("select",{className:"input",value:o,onChange:S=>l(S.target.value),children:[f.jsx("option",{value:"",children:"Broadcast to All Admins"}),u.map(S=>f.jsxs("option",{value:S.id,children:[S.full_name," (",S.role==="super_admin"?"Super Admin":"Admin",")"]},S.id))]}),f.jsx("p",{className:"hint-text",children:"Select an admin to notify specifically."})]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),f.jsx("button",{className:"btn btn-primary",onClick:y,disabled:!s.trim()||d,children:d?"Submitting...":"Submit Request"})]})]})})}function nN({document:n,currentUserRole:e,onClose:t,onSuccess:s}){const{user:i}=pn(),[r,a]=k.useState([]),[o,l]=k.useState(new Set),[u,h]=k.useState(new Set),[d,p]=k.useState({}),[m,g]=k.useState({}),[y,S]=k.useState({}),[v,x]=k.useState(null),[b,E]=k.useState(!0),[C,P]=k.useState(!1),[N,T]=k.useState("");k.useEffect(()=>{R()},[]);const R=async()=>{try{const j=((await ae.get("/users")).data.users||[]).filter(O=>O.role!=="super_admin"&&O.id!==(i==null?void 0:i.id));a(j);const z=await ae.getDocumentAccess(n.id),M=new Set,F={},H={}(z.data.users||[]).forEach(O=>{M.add(O.id),F[O.id]=O.can_reassign||!1,O.granted_by_name&&(H[O.id]={name:O.granted_by_name,email:O.granted_by_email||"N/A",role:O.granted_by_role||"N/A"})});l(M),h(new Set(M)),p(F),g({...F}),S(H)}catch($){console.error("Failed to load data:",$),T("Failed to load users")}finally{E(!1)}},L=$=>{l(j=>{const z=new Set(j);return z.has($)?z.delete($):z.add($),z})},I=($,j)=>{$.stopPropagation(),p(z=>({...z,[j]:!z[j]}))},ne=async()=>{P(!0),T("");try{const $=[];for(const j of o){const z=!u.has(j),M=d[j]!==m[j];(z||M)&&$.push(ae.post(`/documents/id/${n.id}/access`,{user_id:j,can_reassign:!!d[j]}))}for(const j of u)o.has(j)||$.push(ae.revokeAccess(n.id,j));await Promise.all($),s(),t()}catch($){T($ instanceof Error?$.message:"Failed to save changes")}finally{P(!1)}},B=()=>{if(o.size!==u.size)return!0;for(const $ of o)if(!u.has($)||d[$]!==m[$])return!0;for(const $ of u)if(!o.has($))return!0;return!1},Y=$=>$?$==="super_admin"?"SUPER ADMIN":$.toUpperCase():"";return f.jsx("div",{className:"modal-overlay",onClick:t,children:f.jsxs("div",{className:"modal glass-card modal-large",onClick:$=>{$.stopPropagation(),x(null)},children:[f.jsxs("div",{className:"modal-header",children:[f.jsxs("h2",{children:["Assign Users to: ",n.title]}),f.jsx("button",{className:"close-btn",onClick:t,children:f.jsx(ta,{size:24})})]}),f.jsxs("div",{className:"modal-body",children:[N&&f.jsx("div",{className:"error-message",children:N}),f.jsxs("div",{className:"list-header",children:[f.jsx("span",{children:"Select User"}),f.jsx("span",{children:"Permissions"})]}),b?f.jsx("div",{className:"loading-container",children:f.jsx("div",{className:"loading-spinner"})}):r.length===0?f.jsxs("div",{className:"empty-state",children:[f.jsx(Co,{size:32}),f.jsx("p",{children:"No users available to assign"})]}):f.jsx("div",{className:"user-list",children:r.map($=>{const j=o.has($.id),z=$.role||"user",M=y[$.id];return f.jsxs("div",{className:`user-item ${j?"selected":""}`,onClick:()=>L($.id),children:[f.jsxs("div",{className:"user-left",children:[f.jsx("div",{className:"user-checkbox",children:j&&f.jsx(rS,{size:16})}),f.jsxs("div",{className:"user-info",children:[f.jsxs("div",{className:"user-primary",children:[f.jsx("span",{className:"user-name",children:$.full_name}),f.jsxs("span",{className:"user-role-badge",children:["(",Y(z),")"]})]}),f.jsx("span",{className:"user-email",children:$.email})]})]}),f.jsxs("div",{className:"user-right",onClick:F=>F.stopPropagation(),children:[j&&M&&f.jsxs("div",{className:"assigned-by-container",children:[f.jsx("button",{className:"btn-text",onClick:F=>{F.stopPropagation(),x(v===$.id?null:$.id)},children:"Assigned by..."}),v===$.id&&f.jsxs("div",{className:"popover glass-card",children:[f.jsx("h4",{children:"Assigned By:"}),f.jsxs("div",{className:"popover-row",children:[f.jsx("strong",{children:"Name:"})," ",M.name]}),f.jsxs("div",{className:"popover-row",children:[f.jsx("strong",{children:"Email:"})," ",M.email]}),f.jsxs("div",{className:"popover-row",children:[f.jsx("strong",{children:"Role:"})," ",Y(M.role)]})]})]}),j&&f.jsxs("label",{className:"reassign-label",title:"Allow this user to re-assign/share this document",children:[f.jsx("input",{type:"checkbox",checked:!!d[$.id],onChange:F=>I(F,$.id)}),f.jsx("span",{children:"Allow Re-assign"})]})]})]},$.id)})})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsxs("span",{className:"selection-count",children:[o.size," user",o.size!==1?"s":""," selected"]}),f.jsxs("div",{className:"footer-actions",children:[f.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Cancel"}),f.jsx("button",{className:"btn btn-primary",onClick:ne,disabled:!B()||C,children:C?"Saving...":"Save Changes"})]})]})]})})}var _u={};_u.d=(n,e)=>{for(var t in e)_u.o(e,t)&&!_u.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};_u.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var ee=globalThis.pdfjsLib={};_u.d(ee,{AbortException:()=>qr,AnnotationEditorLayer:()=>gv,AnnotationEditorParamsType:()=>fe,AnnotationEditorType:()=>ie,AnnotationEditorUIManager:()=>Po,AnnotationLayer:()=>QP,AnnotationMode:()=>nr,ColorPicker:()=>bp,DOMSVGFactory:()=>T0,DrawLayer:()=>wv,FeatureTest:()=>Yt,GlobalWorkerOptions:()=>Ii,ImageKind:()=>df,InvalidPDFException:()=>cy,MissingPDFException:()=>Gu,OPS:()=>os,OutputScale:()=>hy,PDFDataRangeTransport:()=>AA,PDFDateString:()=>C0,PDFWorker:()=>pl,PasswordResponses:()=>aN,PermissionFlag:()=>rN,PixelsPerInch:()=>Yr,RenderingCancelledException:()=>_0,TextLayer:()=>Xu,TouchManager:()=>wp,UnexpectedResponseException:()=>gp,Util:()=>K,VerbosityLevel:()=>um,XfaLayer:()=>EA,build:()=>RP,createValidAbsoluteUrl:()=>uN,fetchData:()=>pm,getDocument:()=>SP,getFilenameFromUrl:()=>wN,getPdfFilenameFromUrl:()=>xN,getXfaPageViewport:()=>bN,isDataScheme:()=>mm,isPdfFile:()=>E0,noContextMenu:()=>Cs,normalizeUnicode:()=>gN,setLayerDimensions:()=>No,shadow:()=>ue,stopEvent:()=>Rn,version:()=>TP});const Ot=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),SS=[1,0,0,1,0,0],ly=[.001,0,0,.001,0,0],sN=1e7,qm=1.35,Nn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},nr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},iN="pdfjs_internal_editor_",ie={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},fe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},rN={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Pt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},df={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},nt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},$c={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},um={ERRORS:0,WARNINGS:1,INFOS:5},os={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},aN={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let hm=um.WARNINGS;function oN(n){Number.isInteger(n)&&(hm=n)}function lN(){return hm}function dm(n){hm>=um.INFOS&&console.log(`Info: ${n}`)}function re(n){hm>=um.WARNINGS&&console.log(`Warning: ${n}`)}function Ce(n){throw new Error(n)}function et(n,e){n||Ce(e)}function cN(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function uN(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=mN(n)}catch{}}const s=e?new URL(n,e):new URL(n);if(cN(s))return s}catch{}return null}function ue(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const na=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class ax extends na{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Ym extends na{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class cy extends na{constructor(e){super(e,"InvalidPDFException")}}class Gu extends na{constructor(e){super(e,"MissingPDFException")}}class gp extends na{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class hN extends na{constructor(e){super(e,"FormatError")}}class qr extends na{constructor(e){super(e,"AbortException")}}function AS(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Ce("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function fm(n){typeof n!="string"&&Ce("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function dN(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function S0(n){const e=Object.create(null);for(const[t,s]of n)e[t]=s;return e}function fN(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function pN(){try{return new Function(""),!0}catch{return!1}}class Yt{static get isLittleEndian(){return ue(this,"isLittleEndian",fN())}static get isEvalSupported(){return ue(this,"isEvalSupported",pN())}static get isOffscreenCanvasSupported(){return ue(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ue(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ue(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ue(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return ue(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Km=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var zi,ff,uy;class K{static makeHexColor(e,t,s){return`#${Km[e]}${Km[t]}${Km[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[s,i]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[i,r]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],r[0],a[0]),Math.min(s[1],i[1],r[1],a[1]),Math.max(s[0],i[0],r[0],a[0]),Math.max(s[1],i[1],r[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(s+a)/2,l=Math.sqrt((s+a)**2-4*(s*a-r*i))/2,u=o+l||1,h=o-l||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static bezierBoundingBox(e,t,s,i,r,a,o,l,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,l)):u=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],_(this,zi,uy).call(this,e,s,r,o,t,i,a,l,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),u),_(this,zi,uy).call(this,e,s,r,o,t,i,a,l,3*(-t+3*(i-a)+l),6*(t-2*i+a),3*(i-t),u),u}}zi=new WeakSet,ff=function(e,t,s,i,r,a,o,l,u,h){if(u<=0||u>=1)return;const d=1-u,p=u*u,m=p*u,g=d*(d*(d*e+3*u*t)+3*p*s)+m*i,y=d*(d*(d*r+3*u*a)+3*p*o)+m*l;h[0]=Math.min(h[0],g),h[1]=Math.min(h[1],y),h[2]=Math.max(h[2],g),h[3]=Math.max(h[3],y)},uy=function(e,t,s,i,r,a,o,l,u,h,d,p){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&_(this,zi,ff).call(this,e,t,s,i,r,a,o,l,-d/h,p);return}const m=h**2-4*d*u;if(m<0)return;const g=Math.sqrt(m),y=2*u;_(this,zi,ff).call(this,e,t,s,i,r,a,o,l,(-h+g)/y,p),_(this,zi,ff).call(this,e,t,s,i,r,a,o,l,(-h-g)/y,p)},A(K,zi);function mN(n){return decodeURIComponent(escape(n))}let Qm=null,ox=null;function gN(n){return Qm||(Qm=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,ox=new Map([["","t"]])),n.replaceAll(Qm,(e,t,s)=>t?t.normalize("NFKC"):ox.get(s))}function yN(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),AS(n)}const A0="pdfjs_internal_id_";function vN(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(AS(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const si="http://www.w3.org/2000/svg",ca=class ca{};Q(ca,"CSS",96),Q(ca,"PDF",72),Q(ca,"PDF_TO_CSS_UNITS",ca.CSS/ca.PDF);let Yr=ca;async function pm(n,e="text"){if(Zc(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class Cd{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,d,p,m;switch(i%=360,i<0&&(i+=360),i){case 180:h=-1,d=0,p=0,m=1;break;case 90:h=0,d=1,p=1,m=0;break;case 270:h=0,d=-1,p=-1,m=0;break;case 0:h=1,d=0,p=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,m=-m);let g,y,S,v;h===0?(g=Math.abs(u-e[1])*s+r,y=Math.abs(l-e[0])*s+a,S=(e[3]-e[1])*s,v=(e[2]-e[0])*s):(g=Math.abs(l-e[0])*s+r,y=Math.abs(u-e[1])*s+a,S=(e[2]-e[0])*s,v=(e[3]-e[1])*s),this.transform=[h*s,d*s,p*s,m*s,g-h*s*l-p*s*u,y-d*s*l-m*s*u],this.width=S,this.height=v}get rawDims(){const{userUnit:e,viewBox:t}=this,s=t.map(i=>i*e);return ue(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new Cd({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return K.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=K.applyTransform([e[0],e[1]],this.transform),s=K.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return K.applyInverseTransform([e,t],this.transform)}}class _0 extends na{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function mm(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function E0(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function wN(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function xN(n,e="document.pdf"){if(typeof n!="string")return e;if(mm(n))return re('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class lx{constructor(){Q(this,"started",Object.create(null));Q(this,"times",[])}time(e){e in this.started&&re(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||re(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Zc(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Cs(n){n.preventDefault()}function Rn(n){n.preventDefault(),n.stopPropagation()}var Ku;class C0{static toDateObject(e){if(!e||typeof e!="string")return null;c(this,Ku)||w(this,Ku,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,Ku).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(a+=h,o+=d):u==="+"&&(a-=h,o-=d),new Date(Date.UTC(s,i,r,a,o,l))}}Ku=new WeakMap,A(C0,Ku);function bN(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new Cd({viewBox:r,userUnit:1,scale:e,rotation:t})}function k0(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(re(`Not a valid color format: "${n}"`),[0,0,0])}function SN(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,k0(s))}e.remove()}function Le(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function Ts(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function No(n,e,t=!1,s=!0){if(e instanceof Cd){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,o=Yt.isCSSRoundSupported,l=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${r}px`,h=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,d=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}s&&n.setAttribute("data-main-rotation",e.rotation)}class hy{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var sr,pa,ls,ma,Qu,Ju,Ep,_S,Kt,ES,CS,pf,kS,fy;const oi=class oi{constructor(e){A(this,Kt);A(this,sr,null);A(this,pa,null);A(this,ls);A(this,ma,null);A(this,Qu,null);w(this,ls,e),c(oi,Ju)||w(oi,Ju,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=w(this,sr,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,ls)._uiManager._signal;e.addEventListener("contextmenu",Cs,{signal:t}),e.addEventListener("pointerdown",_(oi,Ep,_S),{signal:t});const s=w(this,ma,document.createElement("div"));s.className="buttons",e.append(s);const i=c(this,ls).toolbarPosition;if(i){const{style:r}=e,a=c(this,ls)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return _(this,Kt,kS).call(this),e}get div(){return c(this,sr)}hide(){var e;c(this,sr).classList.add("hidden"),(e=c(this,pa))==null||e.hideDropdown()}show(){var e;c(this,sr).classList.remove("hidden"),(e=c(this,Qu))==null||e.shown()}async addAltText(e){const t=await e.render();_(this,Kt,pf).call(this,t),c(this,ma).prepend(t,c(this,Kt,fy)),w(this,Qu,e)}addColorPicker(e){w(this,pa,e);const t=e.renderButton();_(this,Kt,pf).call(this,t),c(this,ma).prepend(t,c(this,Kt,fy))}remove(){var e;c(this,sr).remove(),(e=c(this,pa))==null||e.destroy(),w(this,pa,null)}};sr=new WeakMap,pa=new WeakMap,ls=new WeakMap,ma=new WeakMap,Qu=new WeakMap,Ju=new WeakMap,Ep=new WeakSet,_S=function(e){e.stopPropagation()},Kt=new WeakSet,ES=function(e){c(this,ls)._focusEventsAllowed=!1,Rn(e)},CS=function(e){c(this,ls)._focusEventsAllowed=!0,Rn(e)},pf=function(e){const t=c(this,ls)._uiManager._signal;e.addEventListener("focusin",_(this,Kt,ES).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",_(this,Kt,CS).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Cs,{signal:t})},kS=function(){const{editorType:e,_uiManager:t}=c(this,ls),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",c(oi,Ju)[e]),_(this,Kt,pf).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),c(this,ma).append(s)},fy=function(){const e=document.createElement("div");return e.className="divider",e},A(oi,Ep),A(oi,Ju,null);let dy=oi;var Zu,ga,ya,Kr,NS,PS,TS;class AN{constructor(e){A(this,Kr);A(this,Zu,null);A(this,ga,null);A(this,ya);w(this,ya,e)}show(e,t,s){const[i,r]=_(this,Kr,PS).call(this,t,s),{style:a}=c(this,ga)||w(this,ga,_(this,Kr,NS).call(this));e.append(c(this,ga)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,ga).remove()}}Zu=new WeakMap,ga=new WeakMap,ya=new WeakMap,Kr=new WeakSet,NS=function(){const e=w(this,ga,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Cs,{signal:c(this,ya)._signal});const t=w(this,Zu,document.createElement("div"));return t.className="buttons",e.append(t),_(this,Kr,TS).call(this),e},PS=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){i=o,s=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},TS=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=c(this,ya)._signal;e.addEventListener("contextmenu",Cs,{signal:s}),e.addEventListener("click",()=>{c(this,ya).highlightSelection("floating_button")},{signal:s}),c(this,Zu).append(e)};function yp(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var Cp;class _N{constructor(){A(this,Cp,0)}get id(){return`${iN}${Ut(this,Cp)._++}`}}Cp=new WeakMap;var ml,eh,Mt,gl,mf;const M0=class M0{constructor(){A(this,gl);A(this,ml,yN());A(this,eh,0);A(this,Mt,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ue(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return _(this,gl,mf).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return _(this,gl,mf).call(this,e,e)}async getFromBlob(e,t){const s=await t;return _(this,gl,mf).call(this,e,s)}async getFromId(e){c(this,Mt)||w(this,Mt,new Map);const t=c(this,Mt).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,Mt)||w(this,Mt,new Map);let s=c(this,Mt).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${c(this,ml)}_${Ut(this,eh)._++}`,refCounter:1,isSvg:!1},c(this,Mt).set(e,s),c(this,Mt).set(s.id,s),s}getSvgUrl(e){const t=c(this,Mt).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;c(this,Mt)||w(this,Mt,new Map);const t=c(this,Mt).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,ml)}_`)}};ml=new WeakMap,eh=new WeakMap,Mt=new WeakMap,gl=new WeakSet,mf=async function(e,t){c(this,Mt)||w(this,Mt,new Map);let s=c(this,Mt).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${c(this,ml)}_${Ut(this,eh)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await pm(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=M0._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((u,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,u()},a.onload=async()=>{const d=s.svgUrl=a.result;o.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(i),await l}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){re(i),s=null}return c(this,Mt).set(e,s),s&&c(this,Mt).set(s.id,s),s};let py=M0;var Xe,ir,th,Fe;class EN{constructor(e=128){A(this,Xe,[]);A(this,ir,!1);A(this,th);A(this,Fe,-1);w(this,th,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),c(this,ir))return;const l={cmd:e,undo:t,post:s,type:r};if(c(this,Fe)===-1){c(this,Xe).length>0&&(c(this,Xe).length=0),w(this,Fe,0),c(this,Xe).push(l);return}if(a&&c(this,Xe)[c(this,Fe)].type===r){o&&(l.undo=c(this,Xe)[c(this,Fe)].undo),c(this,Xe)[c(this,Fe)]=l;return}const u=c(this,Fe)+1;u===c(this,th)?c(this,Xe).splice(0,1):(w(this,Fe,u),u<c(this,Xe).length&&c(this,Xe).splice(u)),c(this,Xe).push(l)}undo(){if(c(this,Fe)===-1)return;w(this,ir,!0);const{undo:e,post:t}=c(this,Xe)[c(this,Fe)];e(),t==null||t(),w(this,ir,!1),w(this,Fe,c(this,Fe)-1)}redo(){if(c(this,Fe)<c(this,Xe).length-1){w(this,Fe,c(this,Fe)+1),w(this,ir,!0);const{cmd:e,post:t}=c(this,Xe)[c(this,Fe)];e(),t==null||t(),w(this,ir,!1)}}hasSomethingToUndo(){return c(this,Fe)!==-1}hasSomethingToRedo(){return c(this,Fe)<c(this,Xe).length-1}cleanType(e){if(c(this,Fe)!==-1){for(let t=c(this,Fe);t>=0;t--)if(c(this,Xe)[t].type!==e){c(this,Xe).splice(t+1,c(this,Fe)-t),w(this,Fe,t);return}c(this,Xe).length=0,w(this,Fe,-1)}}destroy(){w(this,Xe,null)}}Xe=new WeakMap,ir=new WeakMap,th=new WeakMap,Fe=new WeakMap;var kp,RS;class kd{constructor(e){A(this,kp);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Yt.platform;for(const[s,i,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(_(this,kp,RS).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(i.bind(e,...a,t)(),r||Rn(t))}}kp=new WeakSet,RS=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const Np=class Np{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return SN(e),ue(this,"_colors",e)}convert(e){const t=k0(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return Np._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?K.makeHexColor(...t):e}};Q(Np,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let my=Np;var yl,gn,it,vt,vl,ui,wl,Un,rr,va,xl,wa,js,cs,xa,nh,sh,bl,ih,Is,ar,Sl,or,Ds,Pp,lr,rh,cr,ba,ah,oh,ut,we,hi,Sa,lh,ch,ur,Fs,di,uh,Hn,U,gf,gy,MS,LS,yf,jS,IS,DS,yy,FS,vy,wy,OS,Ht,ii,zS,BS,xy,US,eu,by;const rl=class rl{constructor(e,t,s,i,r,a,o,l,u,h,d,p,m){A(this,U);A(this,yl,new AbortController);A(this,gn,null);A(this,it,new Map);A(this,vt,new Map);A(this,vl,null);A(this,ui,null);A(this,wl,null);A(this,Un,new EN);A(this,rr,null);A(this,va,null);A(this,xl,0);A(this,wa,new Set);A(this,js,null);A(this,cs,null);A(this,xa,new Set);Q(this,"_editorUndoBar",null);A(this,nh,!1);A(this,sh,!1);A(this,bl,!1);A(this,ih,null);A(this,Is,null);A(this,ar,null);A(this,Sl,null);A(this,or,!1);A(this,Ds,null);A(this,Pp,new _N);A(this,lr,!1);A(this,rh,!1);A(this,cr,null);A(this,ba,null);A(this,ah,null);A(this,oh,null);A(this,ut,ie.NONE);A(this,we,new Set);A(this,hi,null);A(this,Sa,null);A(this,lh,null);A(this,ch,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});A(this,ur,[0,0]);A(this,Fs,null);A(this,di,null);A(this,uh,null);A(this,Hn,null);const g=this._signal=c(this,yl).signal;w(this,di,e),w(this,uh,t),w(this,vl,s),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:g}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:g}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:g}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:g}),i._on("setpreference",this.onSetPreference.bind(this),{signal:g}),i._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:g}),_(this,U,jS).call(this),_(this,U,OS).call(this),_(this,U,yy).call(this),w(this,ui,r.annotationStorage),w(this,ih,r.filterFactory),w(this,Sa,a),w(this,Sl,o||null),w(this,nh,l),w(this,sh,u),w(this,bl,h),w(this,oh,d||null),this.viewParameters={realScale:Yr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=rl.prototype,t=a=>c(a,di).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ue(this,"_keyboardManager",new kd([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,di).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,di).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r;(e=c(this,Hn))==null||e.resolve(),w(this,Hn,null),(t=c(this,yl))==null||t.abort(),w(this,yl,null),this._signal=null;for(const a of c(this,vt).values())a.destroy();c(this,vt).clear(),c(this,it).clear(),c(this,xa).clear(),w(this,gn,null),c(this,we).clear(),c(this,Un).destroy(),(s=c(this,vl))==null||s.destroy(),(i=c(this,Ds))==null||i.hide(),w(this,Ds,null),c(this,Is)&&(clearTimeout(c(this,Is)),w(this,Is,null)),c(this,Fs)&&(clearTimeout(c(this,Fs)),w(this,Fs,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,oh)}get useNewAltTextFlow(){return c(this,sh)}get useNewAltTextWhenAddingImage(){return c(this,bl)}get hcmFilter(){return ue(this,"hcmFilter",c(this,Sa)?c(this,ih).addHCMFilter(c(this,Sa).foreground,c(this,Sa).background):"none")}get direction(){return ue(this,"direction",getComputedStyle(c(this,di)).direction)}get highlightColors(){return ue(this,"highlightColors",c(this,Sl)?new Map(c(this,Sl).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return ue(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),w(this,va,e)}setMainHighlightColorPicker(e){w(this,ah,e)}editAltText(e,t=!1){var s;(s=c(this,vl))==null||s.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":w(this,bl,t);break}}onPageChanging({pageNumber:e}){w(this,xl,e-1)}focusMainContainer(){c(this,di).focus()}findParent(e,t){for(const s of c(this,vt).values()){const{x:i,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){c(this,uh).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,xa).add(e)}removeShouldRescale(e){c(this,xa).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Yr.PDF_TO_CSS_UNITS;for(const s of c(this,xa))s.onScaleChanging();(t=c(this,va))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a}=t,o=t.toString(),u=_(this,U,gf).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;t.empty();const d=_(this,U,gy).call(this,u),p=c(this,ut)===ie.NONE,m=()=>{d==null||d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a,text:o}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(ie.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&c(this,ui)&&!c(this,ui).has(e.id)&&c(this,ui).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,c(this,or)&&(w(this,or,!1),_(this,U,yf).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,we))if(t.div.contains(e)){w(this,ba,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,ba))return;const[e,t]=c(this,ba);w(this,ba,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){_(this,U,yy).call(this),_(this,U,vy).call(this)}removeEditListeners(){_(this,U,FS).call(this),_(this,U,wy).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of c(this,cs))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of c(this,cs))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=c(this,gn))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of c(this,we)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of c(this,cs))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){re(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const l of s){const u=await i.deserialize(l);if(!u)return;r.push(u)}const a=()=>{for(const l of r)_(this,U,xy).call(this,l);_(this,U,by).call(this,r)},o=()=>{for(const l of r)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){re(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,ut)!==ie.NONE&&!this.isEditorHandlingKeyboard&&rl._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,or)&&(w(this,or,!1),_(this,U,yf).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(_(this,U,IS).call(this),_(this,U,vy).call(this),_(this,U,Ht).call(this,{isEditing:c(this,ut)!==ie.NONE,isEmpty:_(this,U,eu).call(this),hasSomethingToUndo:c(this,Un).hasSomethingToUndo(),hasSomethingToRedo:c(this,Un).hasSomethingToRedo(),hasSelectedEditor:!1})):(_(this,U,DS).call(this),_(this,U,wy).call(this),_(this,U,Ht).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,cs)){w(this,cs,e);for(const t of c(this,cs))_(this,U,ii).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,Pp).id}get currentLayer(){return c(this,vt).get(c(this,xl))}getLayer(e){return c(this,vt).get(e)}get currentPageIndex(){return c(this,xl)}addLayer(e){c(this,vt).set(e.pageIndex,e),c(this,lr)?e.enable():e.disable()}removeLayer(e){c(this,vt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i;if(c(this,ut)!==e&&!(c(this,Hn)&&(await c(this,Hn).promise,!c(this,Hn)))){if(w(this,Hn,Promise.withResolvers()),w(this,ut,e),e===ie.NONE){this.setEditingState(!1),_(this,U,BS).call(this),(i=this._editorUndoBar)==null||i.hide(),c(this,Hn).resolve();return}this.setEditingState(!0),await _(this,U,zS).call(this),this.unselectAll();for(const r of c(this,vt).values())r.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),c(this,Hn).resolve();return}for(const r of c(this,it).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();c(this,Hn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==c(this,ut)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(c(this,cs)){switch(e){case fe.CREATE:this.currentLayer.addNewEditor();return;case fe.HIGHLIGHT_DEFAULT_COLOR:(s=c(this,ah))==null||s.updateColor(t);break;case fe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,lh)||w(this,lh,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of c(this,we))i.updateParams(e,t);for(const i of c(this,cs))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of c(this,it).values())a.editorType===e&&a.show(t);(((r=c(this,lh))==null?void 0:r.get(fe.HIGHLIGHT_SHOW_ALL))??!0)!==t&&_(this,U,ii).call(this,[[fe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,rh)!==e){w(this,rh,e);for(const t of c(this,vt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of c(this,it).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return c(this,it).get(e)}addEditor(e){c(this,it).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(c(this,Is)&&clearTimeout(c(this,Is)),w(this,Is,setTimeout(()=>{this.focusMainContainer(),w(this,Is,null)},0))),c(this,it).delete(e.id),this.unselect(e),(!e.annotationElementId||!c(this,wa).has(e.annotationElementId))&&((t=c(this,ui))==null||t.remove(e.id))}addDeletedAnnotationElement(e){c(this,wa).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,wa).has(e)}removeDeletedAnnotationElement(e){c(this,wa).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,gn)!==e&&(w(this,gn,e),e&&_(this,U,ii).call(this,e.propertiesToUpdate))}updateUI(e){c(this,U,US)===e&&_(this,U,ii).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){_(this,U,ii).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,we).has(e)){c(this,we).delete(e),e.unselect(),_(this,U,Ht).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,we).add(e),e.select(),_(this,U,ii).call(this,e.propertiesToUpdate),_(this,U,Ht).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=c(this,va))==null||t.commitOrRemove();for(const s of c(this,we))s!==e&&s.unselect();c(this,we).clear(),c(this,we).add(e),e.select(),_(this,U,ii).call(this,e.propertiesToUpdate),_(this,U,Ht).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,we).has(e)}get firstSelectedEditor(){return c(this,we).values().next().value}unselect(e){e.unselect(),c(this,we).delete(e),_(this,U,Ht).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,we).size!==0}get isEnterHandled(){return c(this,we).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;c(this,Un).undo(),_(this,U,Ht).call(this,{hasSomethingToUndo:c(this,Un).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_(this,U,eu).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){c(this,Un).redo(),_(this,U,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,Un).hasSomethingToRedo(),isEmpty:_(this,U,eu).call(this)})}addCommands(e){c(this,Un).add(e),_(this,U,Ht).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_(this,U,eu).call(this)})}cleanUndoStack(e){c(this,Un).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,we)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)_(this,U,xy).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=c(this,gn))==null||e.commitOrRemove()}hasSomethingToControl(){return c(this,gn)||this.hasSelection}selectAll(){for(const e of c(this,we))e.commit();_(this,U,by).call(this,c(this,it).values())}unselectAll(){var e;if(!(c(this,gn)&&(c(this,gn).commitOrRemove(),c(this,ut)!==ie.NONE))&&!((e=c(this,va))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of c(this,we))t.unselect();c(this,we).clear(),_(this,U,Ht).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;c(this,ur)[0]+=e,c(this,ur)[1]+=t;const[i,r]=c(this,ur),a=[...c(this,we)],o=1e3;c(this,Fs)&&clearTimeout(c(this,Fs)),w(this,Fs,setTimeout(()=>{w(this,Fs,null),c(this,ur)[0]=c(this,ur)[1]=0,this.addCommands({cmd:()=>{for(const l of a)c(this,it).has(l.id)&&l.translateInPage(i,r)},undo:()=>{for(const l of a)c(this,it).has(l.id)&&l.translateInPage(-i,-r)},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),w(this,js,new Map);for(const e of c(this,we))c(this,js).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,js))return!1;this.disableUserSelect(!1);const e=c(this,js);w(this,js,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},o]of e)o.newX=i,o.newY=r,o.newPageIndex=a,t||(t=i!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(i,r,a,o)=>{if(c(this,it).has(i.id)){const l=c(this,vt).get(o);l?i._setParentAndPosition(l,r,a):(i.pageIndex=o,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:o}]of e)s(i,r,a,o)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(i,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,js))for(const s of c(this,js).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||c(this,we).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,gn)===e}getActive(){return c(this,gn)}getMode(){return c(this,ut)}get imageManager(){return ue(this,"imageManager",new py)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,h,d,p)=>({x:(h-i)/a,y:1-(u+d-s)/r,width:p/a,height:d/r});break;case"180":o=(u,h,d,p)=>({x:1-(u+d-s)/r,y:1-(h+p-i)/a,width:d/r,height:p/a});break;case"270":o=(u,h,d,p)=>({x:1-(h+p-i)/a,y:(u-s)/r,width:p/a,height:d/r});break;default:o=(u,h,d,p)=>({x:(u-s)/r,y:(h-i)/a,width:d/r,height:p/a});break}const l=[];for(let u=0,h=t.rangeCount;u<h;u++){const d=t.getRangeAt(u);if(!d.collapsed)for(const{x:p,y:m,width:g,height:y}of d.getClientRects())g===0||y===0||l.push(o(p,m,g,y))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,wl)||w(this,wl,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=c(this,wl))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=c(this,wl))==null?void 0:i.get(e.data.id);if(!t)return;const s=c(this,ui).getRawValue(t);s&&(c(this,ut)===ie.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}};yl=new WeakMap,gn=new WeakMap,it=new WeakMap,vt=new WeakMap,vl=new WeakMap,ui=new WeakMap,wl=new WeakMap,Un=new WeakMap,rr=new WeakMap,va=new WeakMap,xl=new WeakMap,wa=new WeakMap,js=new WeakMap,cs=new WeakMap,xa=new WeakMap,nh=new WeakMap,sh=new WeakMap,bl=new WeakMap,ih=new WeakMap,Is=new WeakMap,ar=new WeakMap,Sl=new WeakMap,or=new WeakMap,Ds=new WeakMap,Pp=new WeakMap,lr=new WeakMap,rh=new WeakMap,cr=new WeakMap,ba=new WeakMap,ah=new WeakMap,oh=new WeakMap,ut=new WeakMap,we=new WeakMap,hi=new WeakMap,Sa=new WeakMap,lh=new WeakMap,ch=new WeakMap,ur=new WeakMap,Fs=new WeakMap,di=new WeakMap,uh=new WeakMap,Hn=new WeakMap,U=new WeakSet,gf=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},gy=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of c(this,vt).values())if(s.hasTextLayer(e))return s;return null},MS=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=_(this,U,gf).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(c(this,Ds)||w(this,Ds,new AN(this)),c(this,Ds).show(s,i,this.direction==="ltr"))},LS=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){c(this,hi)&&((r=c(this,Ds))==null||r.hide(),w(this,hi,null),_(this,U,Ht).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,hi))return;const i=_(this,U,gf).call(this,e).closest(".textLayer");if(!i){c(this,hi)&&((a=c(this,Ds))==null||a.hide(),w(this,hi,null),_(this,U,Ht).call(this,{hasSelectedText:!1}));return}if((o=c(this,Ds))==null||o.hide(),w(this,hi,t),_(this,U,Ht).call(this,{hasSelectedText:!0}),!(c(this,ut)!==ie.HIGHLIGHT&&c(this,ut)!==ie.NONE)&&(c(this,ut)===ie.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),w(this,or,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=c(this,ut)===ie.HIGHLIGHT?_(this,U,gy).call(this,i):null;l==null||l.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),d=p=>{p.type==="pointerup"&&p.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&_(this,U,yf).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}},yf=function(e=""){c(this,ut)===ie.HIGHLIGHT?this.highlightSelection(e):c(this,nh)&&_(this,U,MS).call(this)},jS=function(){document.addEventListener("selectionchange",_(this,U,LS).bind(this),{signal:this._signal})},IS=function(){if(c(this,ar))return;w(this,ar,new AbortController);const e=this.combinedSignal(c(this,ar));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},DS=function(){var e;(e=c(this,ar))==null||e.abort(),w(this,ar,null)},yy=function(){if(c(this,cr))return;w(this,cr,new AbortController);const e=this.combinedSignal(c(this,cr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},FS=function(){var e;(e=c(this,cr))==null||e.abort(),w(this,cr,null)},vy=function(){if(c(this,rr))return;w(this,rr,new AbortController);const e=this.combinedSignal(c(this,rr));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},wy=function(){var e;(e=c(this,rr))==null||e.abort(),w(this,rr,null)},OS=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ht=function(e){Object.entries(e).some(([s,i])=>c(this,ch)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,ch),e)}),c(this,ut)===ie.HIGHLIGHT&&e.hasSelectedEditor===!1&&_(this,U,ii).call(this,[[fe.HIGHLIGHT_FREE,!0]]))},ii=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},zS=async function(){if(!c(this,lr)){w(this,lr,!0);const e=[];for(const t of c(this,vt).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,it).values())t.enable()}},BS=function(){if(this.unselectAll(),c(this,lr)){w(this,lr,!1);for(const e of c(this,vt).values())e.disable();for(const e of c(this,it).values())e.disable()}},xy=function(e){const t=c(this,vt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},US=function(){let e=null;for(e of c(this,we));return e},eu=function(){if(c(this,it).size===0)return!0;if(c(this,it).size===1)for(const e of c(this,it).values())return e.isEmpty();return!1},by=function(e){for(const t of c(this,we))t.unselect();c(this,we).clear();for(const t of e)t.isEmpty()||(c(this,we).add(t),t.select());_(this,U,Ht).call(this,{hasSelectedEditor:this.hasSelection})},Q(rl,"TRANSLATE_SMALL",1),Q(rl,"TRANSLATE_BIG",10);let Po=rl;var ht,Os,us,Al,zs,yn,_l,Bs,rn,fi,Aa,Us,hr,Ss,tu,vf;const $t=class $t{constructor(e){A(this,Ss);A(this,ht,null);A(this,Os,!1);A(this,us,null);A(this,Al,null);A(this,zs,null);A(this,yn,null);A(this,_l,!1);A(this,Bs,null);A(this,rn,null);A(this,fi,null);A(this,Aa,null);A(this,Us,!1);w(this,rn,e),w(this,Us,e._uiManager.useNewAltTextFlow),c($t,hr)||w($t,hr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){$t._l10n??($t._l10n=e)}async render(){const e=w(this,us,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=w(this,Al,document.createElement("span"));e.append(t),c(this,Us)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c($t,hr).missing),t.setAttribute("data-l10n-id",c($t,hr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=c(this,rn)._uiManager._signal;e.addEventListener("contextmenu",Cs,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),c(this,rn)._uiManager.editAltText(c(this,rn)),c(this,Us)&&c(this,rn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,Ss,tu)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(w(this,_l,!0),i(r))},{signal:s}),await _(this,Ss,vf).call(this),e}finish(){c(this,us)&&(c(this,us).focus({focusVisible:c(this,_l)}),w(this,_l,!1))}isEmpty(){return c(this,Us)?c(this,ht)===null:!c(this,ht)&&!c(this,Os)}hasData(){return c(this,Us)?c(this,ht)!==null||!!c(this,fi):this.isEmpty()}get guessedText(){return c(this,fi)}async setGuessedText(e){c(this,ht)===null&&(w(this,fi,e),w(this,Aa,await $t._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),_(this,Ss,vf).call(this))}toggleAltTextBadge(e=!1){var t;if(!c(this,Us)||c(this,ht)){(t=c(this,Bs))==null||t.remove(),w(this,Bs,null);return}if(!c(this,Bs)){const s=w(this,Bs,document.createElement("div"));s.className="noAltTextBadge",c(this,rn).div.append(s)}c(this,Bs).classList.toggle("hidden",!e)}serialize(e){let t=c(this,ht);return!e&&c(this,fi)===t&&(t=c(this,Aa)),{altText:t,decorative:c(this,Os),guessedText:c(this,fi),textWithDisclaimer:c(this,Aa)}}get data(){return{altText:c(this,ht),decorative:c(this,Os)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(w(this,fi,s),w(this,Aa,i)),!(c(this,ht)===e&&c(this,Os)===t)&&(r||(w(this,ht,e),w(this,Os,t)),_(this,Ss,vf).call(this))}toggle(e=!1){c(this,us)&&(!e&&c(this,yn)&&(clearTimeout(c(this,yn)),w(this,yn,null)),c(this,us).disabled=!e)}shown(){c(this,rn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,Ss,tu)}})}destroy(){var e,t;(e=c(this,us))==null||e.remove(),w(this,us,null),w(this,Al,null),w(this,zs,null),(t=c(this,Bs))==null||t.remove(),w(this,Bs,null)}};ht=new WeakMap,Os=new WeakMap,us=new WeakMap,Al=new WeakMap,zs=new WeakMap,yn=new WeakMap,_l=new WeakMap,Bs=new WeakMap,rn=new WeakMap,fi=new WeakMap,Aa=new WeakMap,Us=new WeakMap,hr=new WeakMap,Ss=new WeakSet,tu=function(){return c(this,ht)&&"added"||c(this,ht)===null&&this.guessedText&&"review"||"missing"},vf=async function(){var i,r,a;const e=c(this,us);if(!e)return;if(c(this,Us)){if(e.classList.toggle("done",!!c(this,ht)),e.setAttribute("data-l10n-id",c($t,hr)[c(this,Ss,tu)]),(i=c(this,Al))==null||i.setAttribute("data-l10n-id",c($t,hr)[`${c(this,Ss,tu)}-label`]),!c(this,ht)){(r=c(this,zs))==null||r.remove();return}}else{if(!c(this,ht)&&!c(this,Os)){e.classList.remove("done"),(a=c(this,zs))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,zs);if(!t){w(this,zs,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,rn).id}`;const o=100,l=c(this,rn)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(c(this,yn)),w(this,yn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{w(this,yn,setTimeout(()=>{w(this,yn,null),c(this,zs).classList.add("show"),c(this,rn)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;c(this,yn)&&(clearTimeout(c(this,yn)),w(this,yn,null)),(u=c(this,zs))==null||u.classList.remove("show")},{signal:l})}c(this,Os)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,ht)),t.parentNode||e.append(t);const s=c(this,rn).getImageForAltText();s==null||s.setAttribute("aria-describedby",t.id)},A($t,hr,null),Q($t,"_l10n",null);let vp=$t;var hh,_a,dh,fh,ph,mh,gh,El,pi,Ea,dr,Vi,HS,$S,Sy;const L0=class L0{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){A(this,Vi);A(this,hh);A(this,_a,!1);A(this,dh,null);A(this,fh);A(this,ph);A(this,mh);A(this,gh);A(this,El);A(this,pi,null);A(this,Ea);A(this,dr,null);w(this,hh,e),w(this,dh,s),w(this,fh,t),w(this,ph,i),w(this,mh,r),w(this,gh,a),w(this,Ea,new AbortController),w(this,El,AbortSignal.any([o,c(this,Ea).signal])),e.addEventListener("touchstart",_(this,Vi,HS).bind(this),{passive:!1,signal:c(this,El)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ue(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=c(this,Ea))==null||e.abort(),w(this,Ea,null)}};hh=new WeakMap,_a=new WeakMap,dh=new WeakMap,fh=new WeakMap,ph=new WeakMap,mh=new WeakMap,gh=new WeakMap,El=new WeakMap,pi=new WeakMap,Ea=new WeakMap,dr=new WeakMap,Vi=new WeakSet,HS=function(e){var i,r,a;if((i=c(this,fh))!=null&&i.call(this)||e.touches.length<2)return;if(!c(this,dr)){w(this,dr,new AbortController);const o=AbortSignal.any([c(this,El),c(this,dr).signal]),l=c(this,hh),u={signal:o,passive:!1};l.addEventListener("touchmove",_(this,Vi,$S).bind(this),u),l.addEventListener("touchend",_(this,Vi,Sy).bind(this),u),l.addEventListener("touchcancel",_(this,Vi,Sy).bind(this),u),(r=c(this,ph))==null||r.call(this)}if(Rn(e),e.touches.length!==2||(a=c(this,dh))!=null&&a.call(this)){w(this,pi,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),w(this,pi,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},$S=function(e){var E;if(!c(this,pi)||e.touches.length!==2)return;let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:o}=s,l=c(this,pi),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:p}=l,m=d-u,g=p-h,y=a-i,S=o-r,v=Math.hypot(y,S)||1,x=Math.hypot(m,g)||1;if(!c(this,_a)&&Math.abs(x-v)<=L0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=i,l.touch0Y=r,l.touch1X=a,l.touch1Y=o,e.preventDefault(),!c(this,_a)){w(this,_a,!0);return}const b=[(i+a)/2,(r+o)/2];(E=c(this,mh))==null||E.call(this,b,x,v)},Sy=function(e){var t;c(this,dr).abort(),w(this,dr,null),(t=c(this,gh))==null||t.call(this),c(this,pi)&&(e.preventDefault(),w(this,pi,null),w(this,_a,!1))};let wp=L0;var Ca,hs,Te,Cl,fr,yh,ka,wt,Na,mi,pr,vh,Pa,vn,wh,Ta,gi,Hs,kl,Nl,$n,Ra,xh,Tp,Z,Ay,bh,_y,wf,WS,VS,Ey,xf,Cy,GS,XS,qS,ky,YS,Ny,KS,QS,JS,Py,nu;const oe=class oe{constructor(e){A(this,Z);A(this,Ca,null);A(this,hs,null);A(this,Te,null);A(this,Cl,!1);A(this,fr,null);A(this,yh,"");A(this,ka,!1);A(this,wt,null);A(this,Na,null);A(this,mi,null);A(this,pr,null);A(this,vh,"");A(this,Pa,!1);A(this,vn,null);A(this,wh,!1);A(this,Ta,!1);A(this,gi,!1);A(this,Hs,null);A(this,kl,0);A(this,Nl,0);A(this,$n,null);A(this,Ra,null);Q(this,"_editToolbar",null);Q(this,"_initialOptions",Object.create(null));Q(this,"_initialData",null);Q(this,"_isVisible",!0);Q(this,"_uiManager",null);Q(this,"_focusEventsAllowed",!0);A(this,xh,!1);A(this,Tp,oe._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=oe.prototype._resizeWithKeyboard,t=Po.TRANSLATE_SMALL,s=Po.TRANSLATE_BIG;return ue(this,"_resizerKeyboardManager",new kd([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],oe.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ue(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new CN({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(oe._l10n??(oe._l10n=e),oe._l10nResizer||(oe._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),oe._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);oe._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ce("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,xh)}set _isDraggable(e){var t;w(this,xh,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,Tp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):_(this,Z,nu).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,Pa)?w(this,Pa,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}translate(e,t){_(this,Z,Ay).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,vn)||w(this,vn,[this.x,this.y,this.width,this.height]),_(this,Z,Ay).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){c(this,vn)||w(this,vn,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,u]=this.getBaseTranslation();a+=l,o+=u;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,vn)&&(c(this,vn)[0]!==this.x||c(this,vn)[1]!==this.y)}get _hasBeenResized(){return!!c(this,vn)&&(c(this,vn)[2]!==this.width||c(this,vn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=oe,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:o,height:l}=this;if(o*=s,l*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(s-o,r)),a=Math.max(0,Math.min(i-l,a));break;case 90:r=Math.max(0,Math.min(s-l,r)),a=Math.min(i,Math.max(o,a));break;case 180:r=Math.min(s,Math.max(o,r)),a=Math.min(i,Math.max(l,a));break;case 270:r=Math.min(s,Math.max(l,r)),a=Math.max(0,Math.min(i-o,a));break}this.x=r/=s,this.y=a/=i;const[u,h]=this.getBaseTranslation();r+=u,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return _(s=oe,bh,_y).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return _(s=oe,bh,_y).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,c(this,ka)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!c(this,ka)&&t.endsWith("%");if(i&&r)return;const[a,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!c(this,ka)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=c(this,Te))==null||e.finish()}async addEditToolbar(){return this._editToolbar||c(this,Ta)?this._editToolbar:(this._editToolbar=new dy(this),this.div.append(this._editToolbar.render()),c(this,Te)&&await this._editToolbar.addAltText(c(this,Te)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=c(this,Te))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){c(this,Te)||(vp.initialize(oe._l10n),w(this,Te,new vp(this)),c(this,Ca)&&(c(this,Te).data=c(this,Ca),w(this,Ca,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=c(this,Te))==null?void 0:e.data}set altTextData(e){c(this,Te)&&(c(this,Te).data=e)}get guessedAltText(){var e;return(e=c(this,Te))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=c(this,Te))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=c(this,Te))==null?void 0:t.serialize(e)}hasAltText(){return!!c(this,Te)&&!c(this,Te).isEmpty()}hasAltTextData(){var e;return((e=c(this,Te))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=c(this,Cl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),_(this,Z,Ny).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),yp(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(c(this,Ra)||w(this,Ra,new wp({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:_(this,Z,GS).bind(this),onPinching:_(this,Z,XS).bind(this),onPinchEnd:_(this,Z,qS).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Yt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(w(this,Pa,!0),this._isDraggable){_(this,Z,YS).call(this,e);return}_(this,Z,ky).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,Hs)&&clearTimeout(c(this,Hs)),w(this,Hs,setTimeout(()=>{var e;w(this,Hs,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/i,h=t/i,d=this.x*r,p=this.y*a,m=this.width*r,g=this.height*a;switch(s){case 0:return[d+u+o,a-p-h-g+l,d+u+m+o,a-p-h+l];case 90:return[d+h+o,a-p+u+l,d+h+g+o,a-p+u+m+l];case 180:return[d-u-m+o,a-p+h+l,d-u+o,a-p+h+g+l];case 270:return[d-h-g+o,a-p-u-m+l,d-h+o,a-p-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,o=r-s,l=a-i;switch(this.rotation){case 0:return[s,t-a,o,l];case 90:return[s,t-i,l,o];case 180:return[r,t-i,o,l];case 270:return[r,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){w(this,Ta,!0)}disableEditMode(){w(this,Ta,!1)}isInEditMode(){return c(this,Ta)}shouldGetKeyboardEvents(){return c(this,gi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){_(this,Z,Ny).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Ce("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,w(i,Ca,e.accessibilityData);const[r,a]=i.pageDimensions,[o,l,u,h]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/r,i.y=l/a,i.width=u/r,i.height=h/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=c(this,pr))==null||e.abort(),w(this,pr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),c(this,Hs)&&(clearTimeout(c(this,Hs)),w(this,Hs,null)),_(this,Z,nu).call(this),this.removeEditToolbar(),c(this,$n)){for(const s of c(this,$n).values())clearTimeout(s);w(this,$n,null)}this.parent=null,(t=c(this,Ra))==null||t.destroy(),w(this,Ra,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(_(this,Z,WS).call(this),c(this,wt).classList.remove("hidden"),yp(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),w(this,mi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,wt).children;if(!c(this,hs)){w(this,hs,Array.from(t));const a=_(this,Z,KS).bind(this),o=_(this,Z,QS).bind(this),l=this._uiManager._signal;for(const u of c(this,hs)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",_(this,Z,JS).bind(this,h),{signal:l}),u.setAttribute("data-l10n-id",oe._l10nResizer[h])}}const s=c(this,hs)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(c(this,hs).length/4);if(r!==i){if(r<i)for(let o=0;o<i-r;o++)c(this,wt).append(c(this,wt).firstChild);else if(r>i)for(let o=0;o<r-i;o++)c(this,wt).firstChild.before(c(this,wt).lastChild);let a=0;for(const o of t){const u=c(this,hs)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",oe._l10nResizer[u])}}_(this,Z,Py).call(this,0),w(this,gi,!0),c(this,wt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,gi)&&_(this,Z,Cy).call(this,c(this,vh),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){_(this,Z,nu).call(this),this.div.focus()}select(){var e,t,s;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=c(this,Te))==null||s.toggleAltTextBadge(!1)}unselect(){var e,t,s,i,r;(e=c(this,wt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=c(this,Te))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return c(this,wh)}set isEditing(e){w(this,wh,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){w(this,ka,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,$n)||w(this,$n,new Map);const{action:s}=e;let i=c(this,$n).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),c(this,$n).delete(s),c(this,$n).size===0&&w(this,$n,null)},oe._telemetryTimeout),c(this,$n).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),w(this,Cl,!1)}disable(){this.div&&(this.div.tabIndex=-1),w(this,Cl,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Ca=new WeakMap,hs=new WeakMap,Te=new WeakMap,Cl=new WeakMap,fr=new WeakMap,yh=new WeakMap,ka=new WeakMap,wt=new WeakMap,Na=new WeakMap,mi=new WeakMap,pr=new WeakMap,vh=new WeakMap,Pa=new WeakMap,vn=new WeakMap,wh=new WeakMap,Ta=new WeakMap,gi=new WeakMap,Hs=new WeakMap,kl=new WeakMap,Nl=new WeakMap,$n=new WeakMap,Ra=new WeakMap,xh=new WeakMap,Tp=new WeakMap,Z=new WeakSet,Ay=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},bh=new WeakSet,_y=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},wf=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},WS=function(){if(c(this,wt))return;w(this,wt,document.createElement("div")),c(this,wt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");c(this,wt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",_(this,Z,VS).bind(this,s),{signal:t}),i.addEventListener("contextmenu",Cs,{signal:t}),i.tabIndex=-1}this.div.prepend(c(this,wt))},VS=function(e,t){var h;t.preventDefault();const{isMac:s}=Yt.platform;if(t.button!==0||t.ctrlKey&&s)return;(h=c(this,Te))==null||h.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,w(this,Na,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",_(this,Z,Cy).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Rn,{passive:!1,signal:a}),window.addEventListener("contextmenu",Cs,{signal:a}),w(this,mi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=c(this,Te))==null||d.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=l,_(this,Z,xf).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},Ey=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*s,a*i),this.fixAndSetPosition(),this._onResized()},xf=function(){if(!c(this,mi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=c(this,mi);w(this,mi,null);const r=this.x,a=this.y,o=this.width,l=this.height;r===e&&a===t&&o===s&&l===i||this.addCommands({cmd:_(this,Z,Ey).bind(this,r,a,o,l),undo:_(this,Z,Ey).bind(this,e,t,s,i),mustExec:!0})},Cy=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,o=this.width,l=this.height,u=oe.MIN_SIZE/s,h=oe.MIN_SIZE/i,d=_(this,Z,wf).call(this,this.rotation),p=(j,z)=>[d[0]*j+d[2]*z,d[1]*j+d[3]*z],m=_(this,Z,wf).call(this,360-this.rotation),g=(j,z)=>[m[0]*j+m[2]*z,m[1]*j+m[3]*z];let y,S,v=!1,x=!1;switch(e){case"topLeft":v=!0,y=(j,z)=>[0,0],S=(j,z)=>[j,z];break;case"topMiddle":y=(j,z)=>[j/2,0],S=(j,z)=>[j/2,z];break;case"topRight":v=!0,y=(j,z)=>[j,0],S=(j,z)=>[0,z];break;case"middleRight":x=!0,y=(j,z)=>[j,z/2],S=(j,z)=>[0,z/2];break;case"bottomRight":v=!0,y=(j,z)=>[j,z],S=(j,z)=>[0,0];break;case"bottomMiddle":y=(j,z)=>[j/2,z],S=(j,z)=>[j/2,0];break;case"bottomLeft":v=!0,y=(j,z)=>[0,z],S=(j,z)=>[j,0];break;case"middleLeft":x=!0,y=(j,z)=>[0,z/2],S=(j,z)=>[j,z/2];break}const b=y(o,l),E=S(o,l);let C=p(...E);const P=oe._round(r+C[0]),N=oe._round(a+C[1]);let T=1,R=1,L,I;if(t.fromKeyboard)({deltaX:L,deltaY:I}=t);else{const{screenX:j,screenY:z}=t,[M,F]=c(this,Na);[L,I]=this.screenToPageTranslation(j-M,z-F),c(this,Na)[0]=j,c(this,Na)[1]=z}if([L,I]=g(L/s,I/i),v){const j=Math.hypot(o,l);T=R=Math.max(Math.min(Math.hypot(E[0]-b[0]-L,E[1]-b[1]-I)/j,1/o,1/l),u/o,h/l)}else x?T=Math.max(u,Math.min(1,Math.abs(E[0]-b[0]-L)))/o:R=Math.max(h,Math.min(1,Math.abs(E[1]-b[1]-I)))/l;const ne=oe._round(o*T),B=oe._round(l*R);C=p(...S(ne,B));const Y=P-C[0],$=N-C[1];c(this,vn)||w(this,vn,[this.x,this.y,this.width,this.height]),this.width=ne,this.height=B,this.x=Y,this.y=$,this.setDims(s*ne,i*B),this.fixAndSetPosition(),this._onResizing()},GS=function(){var e;w(this,mi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=c(this,Te))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},XS=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=_(this,Z,wf).call(this,this.rotation),o=(P,N)=>[a[0]*P+a[2]*N,a[1]*P+a[3]*N],[l,u]=this.parentDimensions,h=this.x,d=this.y,p=this.width,m=this.height,g=oe.MIN_SIZE/l,y=oe.MIN_SIZE/u;r=Math.max(Math.min(r,1/p,1/m),g/p,y/m);const S=oe._round(p*r),v=oe._round(m*r);if(S===p&&v===m)return;c(this,vn)||w(this,vn,[h,d,p,m]);const x=o(p/2,m/2),b=oe._round(h+x[0]),E=oe._round(d+x[1]),C=o(S/2,v/2);this.x=b-C[0],this.y=E-C[1],this.width=S,this.height=v,this.setDims(l*S,u*v),this.fixAndSetPosition(),this._onResizing()},qS=function(){var e;(e=c(this,Te))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),_(this,Z,xf).call(this)},ky=function(e){const{isMac:t}=Yt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},YS=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},o=u=>{i.abort(),w(this,fr,null),w(this,Pa,!1),this._uiManager.endDragSession()||_(this,Z,ky).call(this,u),s&&this._onStopDragging()};t&&(w(this,kl,e.clientX),w(this,Nl,e.clientY),w(this,fr,e.pointerId),w(this,yh,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:h,clientY:d,pointerId:p}=u;if(p!==c(this,fr)){Rn(u);return}const[m,g]=this.screenToPageTranslation(h-c(this,kl),d-c(this,Nl));w(this,kl,h),w(this,Nl,d),this._uiManager.dragSelectedEditors(m,g)},a),window.addEventListener("touchmove",Rn,a),window.addEventListener("pointerdown",u=>{u.pointerType===c(this,yh)&&(c(this,Ra)||u.isPrimary)&&o(u),Rn(u)},a));const l=u=>{if(!c(this,fr)||c(this,fr)===u.pointerId){o(u);return}Rn(u)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},Ny=function(){if(c(this,pr)||!this.div)return;w(this,pr,new AbortController);const e=this._uiManager.combinedSignal(c(this,pr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},KS=function(e){oe._resizerKeyboardManager.exec(this,e)},QS=function(e){var t;c(this,gi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==c(this,wt)&&_(this,Z,nu).call(this)},JS=function(e){w(this,vh,c(this,gi)?e:"")},Py=function(e){if(c(this,hs))for(const t of c(this,hs))t.tabIndex=e},nu=function(){w(this,gi,!1),_(this,Z,Py).call(this,-1),_(this,Z,xf).call(this)},A(oe,bh),Q(oe,"_l10n",null),Q(oe,"_l10nResizer",null),Q(oe,"_borderLineWidth",-1),Q(oe,"_colorManager",new my),Q(oe,"_zIndex",1),Q(oe,"_telemetryTimeout",1e3);let Be=oe;class CN extends Be{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const cx=3285377520,zn=4294901760,Rs=65535;class ZS{constructor(e){this.h1=e?e&4294967295:cx,this.h2=e?e&4294967295:cx}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let y=0,S=e.length;y<S;y++){const v=e.charCodeAt(y);v<=255?t[s++]=v:(t[s++]=v>>>8,t[s++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,l=0,u=this.h1,h=this.h2;const d=3432918353,p=461845907,m=d&Rs,g=p&Rs;for(let y=0;y<i;y++)y&1?(o=a[y],o=o*d&zn|o*m&Rs,o=o<<15|o>>>17,o=o*p&zn|o*g&Rs,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=a[y],l=l*d&zn|l*m&Rs,l=l<<15|l>>>17,l=l*p&zn|l*g&Rs,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*d&zn|o*m&Rs,o=o<<15|o>>>17,o=o*p&zn|o*g&Rs,i&1?u^=o:h^=o}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&zn|e*36045&Rs,t=t*4283543511&zn|((t<<16|e>>>16)*2950163797&zn)>>>16,e^=t>>>1,e=e*444984403&zn|e*60499&Rs,t=t*3301882366&zn|((t<<16|e>>>16)*3120437893&zn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Ty=Object.freeze({map:null,hash:"",transfer:void 0});var Ma,La,dt,Rp,eA;class N0{constructor(){A(this,Rp);A(this,Ma,!1);A(this,La,null);A(this,dt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=c(this,dt).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return c(this,dt).get(e)}remove(e){if(c(this,dt).delete(e),c(this,dt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of c(this,dt).values())if(t instanceof Be)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=c(this,dt).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,c(this,dt).set(e,t);i&&_(this,Rp,eA).call(this),t instanceof Be&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return c(this,dt).has(e)}getAll(){return c(this,dt).size>0?S0(c(this,dt)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return c(this,dt).size}resetModified(){c(this,Ma)&&(w(this,Ma,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new tA(this)}get serializable(){if(c(this,dt).size===0)return Ty;const e=new Map,t=new ZS,s=[],i=Object.create(null);let r=!1;for(const[a,o]of c(this,dt)){const l=o instanceof Be?o.serialize(!1,i):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:Ty}get editorStats(){let e=null;const t=new Map;for(const s of c(this,dt).values()){if(!(s instanceof Be))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,l]of Object.entries(i)){if(o==="type")continue;let u=a.get(o);u||(u=new Map,a.set(o,u));const h=u.get(l)??0;u.set(l,h+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){w(this,La,null)}get modifiedIds(){if(c(this,La))return c(this,La);const e=[];for(const t of c(this,dt).values())!(t instanceof Be)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return w(this,La,{ids:new Set(e),hash:e.join(",")})}}Ma=new WeakMap,La=new WeakMap,dt=new WeakMap,Rp=new WeakSet,eA=function(){c(this,Ma)||(w(this,Ma,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Sh;class tA extends N0{constructor(t){super();A(this,Sh);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);w(this,Sh,{map:a,hash:i,transfer:r})}get print(){Ce("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,Sh)}get modifiedIds(){return ue(this,"modifiedIds",{ids:new Set,hash:""})}}Sh=new WeakMap;var Pl;class kN{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){A(this,Pl,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,Pl).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||c(this,Pl).has(e.loadedName))){if(et(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:r}=e,a=new FontFace(s,i,r);this.addNativeFontFace(a);try{await a.load(),c(this,Pl).add(s),t==null||t(e)}catch{re(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}Ce("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw re(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ue(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Ot||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),ue(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(et(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ue(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,C){return E.charCodeAt(C)<<24|E.charCodeAt(C+1)<<16|E.charCodeAt(C+2)<<8|E.charCodeAt(C+3)&255}function i(E,C,P,N){const T=E.substring(0,C),R=E.substring(C+P);return T+N+R}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let u=0;function h(E,C){if(++u>30){re("Load test font never loaded."),C();return}if(l.font="30px "+E,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(h.bind(null,E,C))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=i(p,976,d.length,d);const g=16,y=1482184792;let S=s(p,g);for(r=0,a=d.length-3;r<a;r+=4)S=S-y+s(d,r)|0;r<d.length&&(S=S-y+s(d+"XXX",r)|0),p=i(p,g,4,dN(S));const v=`url(data:font/opentype;base64,${btoa(p)});`,x=`@font-face {font-family:"${d}";src:${v}}`;this.insertRule(x);const b=this._document.createElement("div");b.style.visibility="hidden",b.style.width=b.style.height="10px",b.style.position="absolute",b.style.top=b.style.left="0px";for(const E of[e.loadedName,d]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=E,b.append(C)}this._document.body.append(b),h(d,()=>{b.remove(),t.complete()})}}Pl=new WeakMap;class NN{constructor(e,{disableFontFace:t=!1,fontExtraProperties:s=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=s===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${vN(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){re(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}const Xd={DATA:1,ERROR:2},Je={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function ux(){}function nn(n){if(n instanceof qr||n instanceof cy||n instanceof Gu||n instanceof ax||n instanceof gp||n instanceof Ym)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Ce('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new qr(n.message);case"InvalidPDFException":return new cy(n.message);case"MissingPDFException":return new Gu(n.message);case"PasswordException":return new ax(n.message,n.code);case"UnexpectedResponseException":return new gp(n.message,n.status);case"UnknownErrorException":return new Ym(n.message,n.details)}return new Ym(n.message,n.toString())}var Tl,es,nA,sA,iA,bf;class su{constructor(e,t,s){A(this,es);A(this,Tl,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",_(this,es,nA).bind(this),{signal:c(this,Tl).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:Je.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{et(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:Je.CANCEL,streamId:r,reason:nn(u)}),h.promise}},s)}destroy(){var e;(e=c(this,Tl))==null||e.abort(),w(this,Tl,null)}}Tl=new WeakMap,es=new WeakSet,nA=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){_(this,es,iA).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Xd.DATA)i.resolve(e.data);else if(e.callback===Xd.ERROR)i.reject(nn(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:Xd.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:Xd.ERROR,callbackId:e.callbackId,reason:nn(a)})});return}if(e.streamId){_(this,es,sA).call(this,e);return}t(e.data)},sA=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(u,h=1,d){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:Je.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Je.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){et(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:Je.ERROR,streamId:t,reason:nn(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Je.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Je.START_COMPLETE,streamId:t,reason:nn(u)})})},iA=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case Je.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(nn(e.reason));break;case Je.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(nn(e.reason));break;case Je.PULL:if(!o){r.postMessage({sourceName:s,targetName:i,stream:Je.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||ux).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Je.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Je.PULL_COMPLETE,streamId:t,reason:nn(u)})});break;case Je.ENQUEUE:if(et(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case Je.CLOSE:if(et(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),_(this,es,bf).call(this,a,t);break;case Je.ERROR:et(a,"error should have stream controller"),a.controller.error(nn(e.reason)),_(this,es,bf).call(this,a,t);break;case Je.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(nn(e.reason)),_(this,es,bf).call(this,a,t);break;case Je.CANCEL:if(!o)break;const l=nn(e.reason);Promise.try(o.onCancel||ux,l).then(function(){r.postMessage({sourceName:s,targetName:i,stream:Je.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:Je.CANCEL_COMPLETE,streamId:t,reason:nn(u)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},bf=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var Ah;class rA{constructor({enableHWA:e=!1}){A(this,Ah,!1);w(this,Ah,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!c(this,Ah)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ce("Abstract method `_createCanvas` called.")}}Ah=new WeakMap;class PN extends rA{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class aA{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ce("Abstract method `_fetch` called.")}}class oA extends aA{async _fetch(e){const t=await pm(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):fm(t)}}class lA{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var ja,Rl,yi,vi,Lt,Ia,Da,W,Tt,iu,zo,Sf,Bo,cA,Ry,Uo,ru,au,My,ou;class TN extends lA{constructor({docId:t,ownerDocument:s=globalThis.document}){super();A(this,W);A(this,ja);A(this,Rl);A(this,yi);A(this,vi);A(this,Lt);A(this,Ia);A(this,Da,0);w(this,vi,t),w(this,Lt,s)}addFilter(t){if(!t)return"none";let s=c(this,W,Tt).get(t);if(s)return s;const[i,r,a]=_(this,W,Sf).call(this,t),o=t.length===1?i:`${i}${r}${a}`;if(s=c(this,W,Tt).get(o),s)return c(this,W,Tt).set(t,s),s;const l=`g_${c(this,vi)}_transfer_map_${Ut(this,Da)._++}`,u=_(this,W,Bo).call(this,l);c(this,W,Tt).set(t,u),c(this,W,Tt).set(o,u);const h=_(this,W,Uo).call(this,l);return _(this,W,au).call(this,i,r,a,h),u}addHCMFilter(t,s){var g;const i=`${t}-${s}`,r="base";let a=c(this,W,iu).get(r);if((a==null?void 0:a.key)===i||(a?((g=a.filter)==null||g.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},c(this,W,iu).set(r,a)),!t||!s))return a.url;const o=_(this,W,ou).call(this,t);t=K.makeHexColor(...o);const l=_(this,W,ou).call(this,s);if(s=K.makeHexColor(...l),c(this,W,zo).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const u=new Array(256);for(let y=0;y<=255;y++){const S=y/255;u[y]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const h=u.join(","),d=`g_${c(this,vi)}_hcm_filter`,p=a.filter=_(this,W,Uo).call(this,d);_(this,W,au).call(this,h,h,h,p),_(this,W,Ry).call(this,p);const m=(y,S)=>{const v=o[y]/255,x=l[y]/255,b=new Array(S+1);for(let E=0;E<=S;E++)b[E]=v+E/S*(x-v);return b.join(",")};return _(this,W,au).call(this,m(0,5),m(1,5),m(2,5),p),a.url=_(this,W,Bo).call(this,d),a.url}addAlphaFilter(t){let s=c(this,W,Tt).get(t);if(s)return s;const[i]=_(this,W,Sf).call(this,[t]),r=`alpha_${i}`;if(s=c(this,W,Tt).get(r),s)return c(this,W,Tt).set(t,s),s;const a=`g_${c(this,vi)}_alpha_map_${Ut(this,Da)._++}`,o=_(this,W,Bo).call(this,a);c(this,W,Tt).set(t,o),c(this,W,Tt).set(r,o);const l=_(this,W,Uo).call(this,a);return _(this,W,My).call(this,i,l),o}addLuminosityFilter(t){let s=c(this,W,Tt).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=_(this,W,Sf).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=c(this,W,Tt).get(r),s)return c(this,W,Tt).set(t,s),s;const a=`g_${c(this,vi)}_luminosity_map_${Ut(this,Da)._++}`,o=_(this,W,Bo).call(this,a);c(this,W,Tt).set(t,o),c(this,W,Tt).set(r,o);const l=_(this,W,Uo).call(this,a);return _(this,W,cA).call(this,l),t&&_(this,W,My).call(this,i,l),o}addHighlightHCMFilter(t,s,i,r,a){var x;const o=`${s}-${i}-${r}-${a}`;let l=c(this,W,iu).get(t);if((l==null?void 0:l.key)===o||(l?((x=l.filter)==null||x.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},c(this,W,iu).set(t,l)),!s||!i))return l.url;const[u,h]=[s,i].map(_(this,W,ou).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,g]=[r,a].map(_(this,W,ou).bind(this));p<d&&([d,p,m,g]=[p,d,g,m]),c(this,W,zo).style.color="";const y=(b,E,C)=>{const P=new Array(256),N=(p-d)/C,T=b/255,R=(E-b)/(255*C);let L=0;for(let I=0;I<=C;I++){const ne=Math.round(d+I*N),B=T+I*R;for(let Y=L;Y<=ne;Y++)P[Y]=B;L=ne+1}for(let I=L;I<256;I++)P[I]=P[L-1];return P.join(",")},S=`g_${c(this,vi)}_hcm_${t}_filter`,v=l.filter=_(this,W,Uo).call(this,S);return _(this,W,Ry).call(this,v),_(this,W,au).call(this,y(m[0],g[0],5),y(m[1],g[1],5),y(m[2],g[2],5),v),l.url=_(this,W,Bo).call(this,S),l.url}destroy(t=!1){var s,i,r,a;t&&((s=c(this,Ia))!=null&&s.size)||((i=c(this,yi))==null||i.parentNode.parentNode.remove(),w(this,yi,null),(r=c(this,Rl))==null||r.clear(),w(this,Rl,null),(a=c(this,Ia))==null||a.clear(),w(this,Ia,null),w(this,Da,0))}}ja=new WeakMap,Rl=new WeakMap,yi=new WeakMap,vi=new WeakMap,Lt=new WeakMap,Ia=new WeakMap,Da=new WeakMap,W=new WeakSet,Tt=function(){return c(this,Rl)||w(this,Rl,new Map)},iu=function(){return c(this,Ia)||w(this,Ia,new Map)},zo=function(){if(!c(this,yi)){const t=c(this,Lt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=c(this,Lt).createElementNS(si,"svg");i.setAttribute("width",0),i.setAttribute("height",0),w(this,yi,c(this,Lt).createElementNS(si,"defs")),t.append(i),i.append(c(this,yi)),c(this,Lt).body.append(t)}return c(this,yi)},Sf=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let p=0;p<256;p++)h[p]=u[p]/255;const d=h.join(",");return[d,d,d]}const[s,i,r]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)a[u]=s[u]/255,o[u]=i[u]/255,l[u]=r[u]/255;return[a.join(","),o.join(","),l.join(",")]},Bo=function(t){if(c(this,ja)===void 0){w(this,ja,"");const s=c(this,Lt).URL;s!==c(this,Lt).baseURI&&(mm(s)?re('#createUrl: ignore "data:"-URL for performance reasons.'):w(this,ja,s.split("#",1)[0]))}return`url(${c(this,ja)}#${t})`},cA=function(t){const s=c(this,Lt).createElementNS(si,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},Ry=function(t){const s=c(this,Lt).createElementNS(si,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Uo=function(t){const s=c(this,Lt).createElementNS(si,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),c(this,W,zo).append(s),s},ru=function(t,s,i){const r=c(this,Lt).createElementNS(si,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},au=function(t,s,i,r){const a=c(this,Lt).createElementNS(si,"feComponentTransfer");r.append(a),_(this,W,ru).call(this,a,"feFuncR",t),_(this,W,ru).call(this,a,"feFuncG",s),_(this,W,ru).call(this,a,"feFuncB",i)},My=function(t,s){const i=c(this,Lt).createElementNS(si,"feComponentTransfer");s.append(i),_(this,W,ru).call(this,i,"feFuncA",t)},ou=function(t){return c(this,W,zo).style.color=t,k0(getComputedStyle(c(this,W,zo)).getPropertyValue("color"))};class uA{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ce("Abstract method `_fetch` called.")}}class hA extends uA{async _fetch(e){const t=await pm(e,"arraybuffer");return new Uint8Array(t)}}Ot&&re("Please use the `legacy` build in Node.js environments.");async function dA(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class RN extends lA{}class MN extends rA{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class LN extends aA{async _fetch(e){return dA(e)}}class jN extends uA{async _fetch(e){return dA(e)}}const Dt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Ly(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class P0{getPattern(){Ce("Abstract method `getPattern` called.")}}class IN extends P0{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Dt.STROKE||i===Dt.FILL){const a=t.current.getClippedPathBoundingBox(i,Le(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,l),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=K.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),Ly(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else Ly(e,this._bbox),r=this._createGradient(e);return r}}function Jm(n,e,t,s,i,r,a,o){const l=e.coords,u=e.colors,h=n.data,d=n.width*4;let p;l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p),l[s+1]>l[i+1]&&(p=s,s=i,i=p,p=a,a=o,o=p),l[t+1]>l[s+1]&&(p=t,t=s,s=p,p=r,r=a,a=p);const m=(l[t]+e.offsetX)*e.scaleX,g=(l[t+1]+e.offsetY)*e.scaleY,y=(l[s]+e.offsetX)*e.scaleX,S=(l[s+1]+e.offsetY)*e.scaleY,v=(l[i]+e.offsetX)*e.scaleX,x=(l[i+1]+e.offsetY)*e.scaleY;if(g>=x)return;const b=u[r],E=u[r+1],C=u[r+2],P=u[a],N=u[a+1],T=u[a+2],R=u[o],L=u[o+1],I=u[o+2],ne=Math.round(g),B=Math.round(x);let Y,$,j,z,M,F,H,O;for(let J=ne;J<=B;J++){if(J<S){const se=J<g?0:(g-J)/(g-S);Y=m-(m-y)*se,$=b-(b-P)*se,j=E-(E-N)*se,z=C-(C-T)*se}else{let se;J>x?se=1:S===x?se=0:se=(S-J)/(S-x),Y=y-(y-v)*se,$=P-(P-R)*se,j=N-(N-L)*se,z=T-(T-I)*se}let ge;J<g?ge=0:J>x?ge=1:ge=(g-J)/(g-x),M=m-(m-v)*ge,F=b-(b-R)*ge,H=E-(E-L)*ge,O=C-(C-I)*ge;const De=Math.round(Math.min(Y,M)),ct=Math.round(Math.max(Y,M));let Ee=d*J+De*4;for(let se=De;se<=ct;se++)ge=(Y-se)/(Y-M),ge<0?ge=0:ge>1&&(ge=1),h[Ee++]=$-($-F)*ge|0,h[Ee++]=j-(j-H)*ge|0,h[Ee++]=z-(z-O)*ge|0,h[Ee++]=255}}function DN(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(s.length/o)-1,u=o-1;for(r=0;r<l;r++){let h=r*o;for(let d=0;d<u;d++,h++)Jm(n,t,s[h],s[h+1],s[h+o],i[h],i[h+1],i[h+o]),Jm(n,t,s[h+o+1],s[h+1],s[h+o],i[h+o+1],i[h+1],i[h+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)Jm(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class FN extends P0{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),m=u/d,g=h/p,y={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/m,scaleY:1/g},S=d+2*2,v=p+2*2,x=s.getCanvas("mesh",S,v),b=x.context,E=b.createImageData(d,p);if(t){const P=E.data;for(let N=0,T=P.length;N<T;N+=4)P[N]=t[0],P[N+1]=t[1],P[N+2]=t[2],P[N+3]=255}for(const P of this._figures)DN(E,P,y);return b.putImageData(E,2,2),{canvas:x.canvas,offsetX:o-2*m,offsetY:l-2*g,scaleX:m,scaleY:g}}getPattern(e,t,s,i){Ly(e,this._bbox);let r;if(i===Dt.SHADING)r=K.singularValueDecompose2dScale(Le(e));else if(r=K.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=K.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,i===Dt.SHADING?null:this._background,t.cachedCanvases);return i!==Dt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class ON extends P0{getPattern(){return"hotpink"}}function zN(n){switch(n[0]){case"RadialAxial":return new IN(n);case"Mesh":return new FN(n);case"Dummy":return new ON}throw new Error(`Unknown IR type: ${n[0]}`)}const hx={COLORED:1,UNCOLORED:2},Mp=class Mp{constructor(e,t,s,i,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:u}=this;l=Math.abs(l),u=Math.abs(u),dm("TilingType: "+r);const h=t[0],d=t[1],p=t[2],m=t[3],g=p-h,y=m-d,S=K.singularValueDecompose2dScale(this.matrix),v=K.singularValueDecompose2dScale(this.baseTransform),x=S[0]*v[0],b=S[1]*v[1];let E=g,C=y,P=!1,N=!1;const T=Math.ceil(l*x),R=Math.ceil(u*b),L=Math.ceil(g*x),I=Math.ceil(y*b);T>=L?E=l:P=!0,R>=I?C=u:N=!0;const ne=this.getSizeAndScale(E,this.ctx.canvas.width,x),B=this.getSizeAndScale(C,this.ctx.canvas.height,b),Y=e.cachedCanvases.getCanvas("pattern",ne.size,B.size),$=Y.context,j=o.createCanvasGraphics($);if(j.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(j,i,a),$.translate(-ne.scale*h,-B.scale*d),j.transform(ne.scale,0,0,B.scale,0,0),$.save(),this.clipBbox(j,h,d,p,m),j.baseTransform=Le(j.ctx),j.executeOperatorList(s),j.endDrawing(),$.restore(),P||N){const z=Y.canvas;P&&(E=l),N&&(C=u);const M=this.getSizeAndScale(E,this.ctx.canvas.width,x),F=this.getSizeAndScale(C,this.ctx.canvas.height,b),H=M.size,O=F.size,J=e.cachedCanvases.getCanvas("pattern-workaround",H,O),ge=J.context,De=P?Math.floor(g/l):0,ct=N?Math.floor(y/u):0;for(let Ee=0;Ee<=De;Ee++)for(let se=0;se<=ct;se++)ge.drawImage(z,H*Ee,O*se,H,O,0,0,H,O);return{canvas:J.canvas,scaleX:M.scale,scaleY:F.scale,offsetX:h,offsetY:d}}return{canvas:Y.canvas,scaleX:ne.scale,scaleY:B.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,s){const i=Math.max(Mp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,o=r-s;e.ctx.rect(t,s,a,o),e.current.updateRectMinMax(Le(e.ctx),[t,s,i,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case hx.COLORED:const a=this.ctx;i.fillStyle=a.fillStyle,i.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case hx.UNCOLORED:const o=K.makeHexColor(s[0],s[1],s[2]);i.fillStyle=o,i.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new hN(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let r=s;i!==Dt.SHADING&&(r=K.transform(r,t.baseTransform),this.matrix&&(r=K.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};Q(Mp,"MAX_PATTERN_SIZE",3e3);let jy=Mp;function BN({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=Yt.isLittleEndian?4278190080:255,[l,u]=a?[r,o]:[o,r],h=s>>3,d=s&7,p=n.length;t=new Uint32Array(t.buffer);let m=0;for(let g=0;g<i;g++){for(const S=e+h;e<S;e++){const v=e<p?n[e]:255;t[m++]=v&128?u:l,t[m++]=v&64?u:l,t[m++]=v&32?u:l,t[m++]=v&16?u:l,t[m++]=v&8?u:l,t[m++]=v&4?u:l,t[m++]=v&2?u:l,t[m++]=v&1?u:l}if(d===0)continue;const y=e<p?n[e++]:255;for(let S=0;S<d;S++)t[m++]=y&1<<7-S?u:l}return{srcPos:e,destPos:m}}const dx=16,fx=100,UN=15,px=10,mx=1e3,ln=16;function HN(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(s,i){e.translate(s,i),this.__originalTranslate(s,i)},n.scale=function(s,i){e.scale(s,i),this.__originalScale(s,i)},n.transform=function(s,i,r,a,o,l){e.transform(s,i,r,a,o,l),this.__originalTransform(s,i,r,a,o,l)},n.setTransform=function(s,i,r,a,o,l){e.setTransform(s,i,r,a,o,l),this.__originalSetTransform(s,i,r,a,o,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(s){e.rotate(s),this.__originalRotate(s)},n.clip=function(s){e.clip(s),this.__originalClip(s)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,o){e.bezierCurveTo(t,s,i,r,a,o),this.__originalBezierCurveTo(t,s,i,r,a,o)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class $N{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function qd(n,e,t,s,i,r,a,o,l,u){const[h,d,p,m,g,y]=Le(n);if(d===0&&p===0){const x=a*h+g,b=Math.round(x),E=o*m+y,C=Math.round(E),P=(a+l)*h+g,N=Math.abs(Math.round(P)-b)||1,T=(o+u)*m+y,R=Math.abs(Math.round(T)-C)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(m),b,C),n.drawImage(e,t,s,i,r,0,0,N,R),n.setTransform(h,d,p,m,g,y),[N,R]}if(h===0&&m===0){const x=o*p+g,b=Math.round(x),E=a*d+y,C=Math.round(E),P=(o+u)*p+g,N=Math.abs(Math.round(P)-b)||1,T=(a+l)*d+y,R=Math.abs(Math.round(T)-C)||1;return n.setTransform(0,Math.sign(d),Math.sign(p),0,b,C),n.drawImage(e,t,s,i,r,0,0,R,N),n.setTransform(h,d,p,m,g,y),[R,N]}n.drawImage(e,t,s,i,r,a,o,l,u);const S=Math.hypot(h,d),v=Math.hypot(p,m);return[S*l,v*u]}function WN(n){const{width:e,height:t}=n;if(e>mx||t>mx)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a=new Uint8Array(r*(t+1)),o,l,u;const h=e+7&-8;let d=new Uint8Array(h*t),p=0;for(const v of n.data){let x=128;for(;x>0;)d[p++]=v&x?0:255,x>>=1}let m=0;for(p=0,d[p]!==0&&(a[0]=1,++m),l=1;l<e;l++)d[p]!==d[p+1]&&(a[l]=d[p]?2:1,++m),p++;for(d[p]!==0&&(a[l]=2,++m),o=1;o<t;o++){p=o*h,u=o*r,d[p-h]!==d[p]&&(a[u]=d[p]?1:8,++m);let v=(d[p]?4:0)+(d[p-h]?8:0);for(l=1;l<e;l++)v=(v>>2)+(d[p+1]?4:0)+(d[p-h+1]?8:0),i[v]&&(a[u+l]=i[v],++m),p++;if(d[p-h]!==d[p]&&(a[u+l]=d[p]?2:4,++m),m>s)return null}for(p=h*(t-1),u=o*r,d[p]!==0&&(a[u]=8,++m),l=1;l<e;l++)d[p]!==d[p+1]&&(a[u+l]=d[p]?4:8,++m),p++;if(d[p]!==0&&(a[u+l]=4,++m),m>s)return null;const g=new Int32Array([0,r,-1,0,-r,0,0,0,1]),y=new Path2D;for(o=0;m&&o<=t;o++){let v=o*r;const x=v+e;for(;v<x&&!a[v];)v++;if(v===x)continue;y.moveTo(v%r,o);const b=v;let E=a[v];do{const C=g[E];do v+=C;while(!a[v]);const P=a[v];P!==5&&P!==10?(E=P,a[v]=0):(E=P&51*E>>4,a[v]&=E>>2|E<<2),y.lineTo(v%r,v/r|0),a[v]||--m}while(b!==v);--o}return d=null,a=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(y),v.beginPath(),v.restore()}}class gx{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=SS,this.textMatrixScale=1,this.fontMatrix=ly,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Pt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=K.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=K.applyTransform(t,e),i=K.applyTransform(t.slice(2),e),r=K.applyTransform([t[0],t[3]],e),a=K.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],r[0],a[0]),this.minY=Math.min(this.minY,s[1],i[1],r[1],a[1]),this.maxX=Math.max(this.maxX,s[0],i[0],r[0],a[0]),this.maxY=Math.max(this.maxY,s[1],i[1],r[1],a[1])}updateScalingPathMinMax(e,t){K.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,r,a,o,l,u,h){const d=K.bezierBoundingBox(t,s,i,r,a,o,l,u,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=Dt.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Dt.STROKE){t||Ce("Stroke bounding box must include transform.");const i=K.singularValueDecompose2dScale(t),r=i[0]*this.lineWidth/2,a=i[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const e=K.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Dt.FILL,t=null){return K.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function yx(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%ln,r=(t-i)/ln,a=i===0?r:r+1,o=n.createImageData(s,ln);let l=0,u;const h=e.data,d=o.data;let p,m,g,y;if(e.kind===df.GRAYSCALE_1BPP){const S=h.byteLength,v=new Uint32Array(d.buffer,0,d.byteLength>>2),x=v.length,b=s+7>>3,E=4294967295,C=Yt.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(g=p<r?ln:i,u=0,m=0;m<g;m++){const P=S-l;let N=0;const T=P>b?s:P*8-7,R=T&-8;let L=0,I=0;for(;N<R;N+=8)I=h[l++],v[u++]=I&128?E:C,v[u++]=I&64?E:C,v[u++]=I&32?E:C,v[u++]=I&16?E:C,v[u++]=I&8?E:C,v[u++]=I&4?E:C,v[u++]=I&2?E:C,v[u++]=I&1?E:C;for(;N<T;N++)L===0&&(I=h[l++],L=128),v[u++]=I&L?E:C,L>>=1}for(;u<x;)v[u++]=0;n.putImageData(o,0,p*ln)}}else if(e.kind===df.RGBA_32BPP){for(m=0,y=s*ln*4,p=0;p<r;p++)d.set(h.subarray(l,l+y)),l+=y,n.putImageData(o,0,m),m+=ln;p<a&&(y=s*i*4,d.set(h.subarray(l,l+y)),n.putImageData(o,0,m))}else if(e.kind===df.RGB_24BPP)for(g=ln,y=s*g,p=0;p<a;p++){for(p>=r&&(g=i,y=s*g),u=0,m=y;m--;)d[u++]=h[l++],d[u++]=h[l++],d[u++]=h[l++],d[u++]=255;n.putImageData(o,0,p*ln)}else throw new Error(`bad image kind: ${e.kind}`)}function vx(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%ln,r=(t-i)/ln,a=i===0?r:r+1,o=n.createImageData(s,ln);let l=0;const u=e.data,h=o.data;for(let d=0;d<a;d++){const p=d<r?ln:i;({srcPos:l}=BN({src:u,srcPos:l,dest:h,width:s,height:p,nonBlackColor:0})),n.putImageData(o,0,d*ln)}}function Wc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Yd(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Ot){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function wx(n,e){if(e)return!0;const t=K.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*Yr.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const VN=["butt","round","square"],GN=["miter","round","bevel"],XN={},xx={};var ks,Iy,Dy,Fy;const j0=class j0{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:o=null},l,u){A(this,ks);this.ctx=e,this.current=new gx(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new $N(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const l=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Le(this.compositeCtx))}this.ctx.save(),Yd(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Le(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,a=e.fnArray;let o=t||0;const l=r.length;if(l===o)return o;const u=l-o>px&&typeof s=="function",h=u?Date.now()+UN:0;let d=0;const p=this.commonObjs,m=this.objs;let g;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,s),o;if(g=a[o],g!==os.dependency)this[g].apply(this,r[o]);else for(const y of r[o]){const S=y.startsWith("g_")?p:m;if(!S.has(y))return S.get(y,s),o}if(o++,o===l)return o;if(u&&++d>px){if(Date.now()>h)return s(),o;d=0}}}endDrawing(){_(this,ks,Iy).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),_(this,ks,Dy).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,l=i,u="prescale1",h,d;for(;r>2&&o>1||a>2&&l>1;){let p=o,m=l;r>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/p),a>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/m),h=this.cachedCanvases.getCanvas(u,p,m),d=h.context,d.clearRect(0,0,p,m),d.drawImage(e,0,0,o,l,0,0,p,m),e=h.canvas,o=p,l=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,a=this.current.patternFill,o=Le(t);let l,u,h,d;if((e.bitmap||e.data)&&e.count>1){const T=e.bitmap||e.data.buffer;u=JSON.stringify(a?o:[o.slice(0,4),r]),l=this._cachedBitmapsMap.get(T),l||(l=new Map,this._cachedBitmapsMap.set(T,l));const R=l.get(u);if(R&&!a){const L=Math.round(Math.min(o[0],o[2])+o[4]),I=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:R,offsetX:L,offsetY:I}}h=R}h||(d=this.cachedCanvases.getCanvas("maskCanvas",s,i),vx(d.context,e));let p=K.transform(o,[1/s,0,0,-1/i,0,0]);p=K.transform(p,[1,0,0,1,0,-i]);const[m,g,y,S]=K.getAxialAlignedBoundingBox([0,0,s,i],p),v=Math.round(y-m)||1,x=Math.round(S-g)||1,b=this.cachedCanvases.getCanvas("fillCanvas",v,x),E=b.context,C=m,P=g;E.translate(-C,-P),E.transform(...p),h||(h=this._scaleImage(d.canvas,Ts(E)),h=h.img,l&&a&&l.set(u,h)),E.imageSmoothingEnabled=wx(Le(E),e.interpolate),qd(E,h,0,0,h.width,h.height,0,0,s,i),E.globalCompositeOperation="source-in";const N=K.transform(Ts(E),[1,0,0,1,-C,-P]);return E.fillStyle=a?r.getPattern(t,this,N,Dt.FILL):r,E.fillRect(0,0,s,i),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(u,b.canvas)),{canvas:b.canvas,offsetX:Math.round(C),offsetY:Math.round(P)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=VN[e]}setLineJoin(e){this.ctx.lineJoin=GN[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...Le(this.suspendedCtx)),Wc(this.suspendedCtx,r),HN(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Wc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],o=i[2]-r,l=i[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,s,o,l,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,o,l,u,h,d){let p=e.canvas,m=l-h,g=u-d;if(a){const S=K.makeHexColor(...a);if(m<0||g<0||m+s>p.width||g+i>p.height){const v=this.cachedCanvases.getCanvas("maskExtension",s,i),x=v.context;x.drawImage(p,-m,-g),x.globalCompositeOperation="destination-atop",x.fillStyle=S,x.fillRect(0,0,s,i),x.globalCompositeOperation="source-over",p=v.canvas,m=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(m,g,s,i),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=S,e.fillRect(m,g,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const y=new Path2D;y.rect(l,u,s,i),t.clip(y),t.globalCompositeOperation="destination-in",t.drawImage(p,m,g,s,i,l,u,s,i),t.restore()}save(){this.inSMaskMode?(Wc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Wc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,r,a){this.ctx.transform(e,t,s,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,r=this.current;let a=r.x,o=r.y,l,u;const h=Le(i),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,p=d?s.slice(0):null;for(let m=0,g=0,y=e.length;m<y;m++)switch(e[m]|0){case os.rectangle:a=t[g++],o=t[g++];const S=t[g++],v=t[g++],x=a+S,b=o+v;i.moveTo(a,o),S===0||v===0?i.lineTo(x,b):(i.lineTo(x,o),i.lineTo(x,b),i.lineTo(a,b)),d||r.updateRectMinMax(h,[a,o,x,b]),i.closePath();break;case os.moveTo:a=t[g++],o=t[g++],i.moveTo(a,o),d||r.updatePathMinMax(h,a,o);break;case os.lineTo:a=t[g++],o=t[g++],i.lineTo(a,o),d||r.updatePathMinMax(h,a,o);break;case os.curveTo:l=a,u=o,a=t[g+4],o=t[g+5],i.bezierCurveTo(t[g],t[g+1],t[g+2],t[g+3],a,o),r.updateCurvePathMinMax(h,l,u,t[g],t[g+1],t[g+2],t[g+3],a,o,p),g+=6;break;case os.curveTo2:l=a,u=o,i.bezierCurveTo(a,o,t[g],t[g+1],t[g+2],t[g+3]),r.updateCurvePathMinMax(h,l,u,a,o,t[g],t[g+1],t[g+2],t[g+3],p),a=t[g+2],o=t[g+3],g+=4;break;case os.curveTo3:l=a,u=o,a=t[g+2],o=t[g+3],i.bezierCurveTo(t[g],t[g+1],a,o,a,o),r.updateCurvePathMinMax(h,l,u,t[g],t[g+1],a,o,a,o,p),g+=4;break;case os.closePath:i.closePath();break}d&&r.updateScalingPathMinMax(h,p),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,Ts(t),Dt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let r=!1;i&&(t.save(),t.fillStyle=s.getPattern(t,this,Ts(t),Dt.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=XN}eoClip(){this.pendingClip=xx}beginText(){this.current.textMatrix=SS,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:l,path:u}of e)s.addPath(u,new DOMMatrix(r).preMultiplySelf(i).translate(a,o).scale(l,-l));t.clip(s),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||ly,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&re("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",a=((h=s.systemFontInfo)==null?void 0:h.css)||`"${r}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const l=s.italic?"italic":"normal";let u=t;t<dx?u=dx:t>fx&&(u=fx),this.current.fontSizeScale=t/u,this.ctx.font=`${l} ${o} ${u}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,r,a){this.current.textMatrix=[e,t,s,i,r,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const a=this.ctx,o=this.current,l=o.font,u=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=u&Pt.FILL_STROKE_MASK,p=!!(u&Pt.ADD_TO_PATH_FLAG),m=o.patternFill&&!l.missingFile,g=o.patternStroke&&!l.missingFile;let y;if((l.disableFontFace||p||m||g)&&(y=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||m||g){if(a.save(),a.translate(t,s),a.scale(h,-h),d===Pt.FILL||d===Pt.FILL_STROKE)if(i){const S=a.getTransform();a.setTransform(...i),a.fill(_(this,ks,Fy).call(this,y,S,i))}else a.fill(y);if(d===Pt.STROKE||d===Pt.FILL_STROKE)if(r){const S=a.getTransform();a.setTransform(...r),a.stroke(_(this,ks,Fy).call(this,y,S,r))}else a.lineWidth/=h,a.stroke(y);a.restore()}else(d===Pt.FILL||d===Pt.FILL_STROKE)&&a.fillText(e,t,s),(d===Pt.STROKE||d===Pt.FILL_STROKE)&&a.strokeText(e,t,s);p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Le(a),x:t,y:s,fontSize:h,path:y})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return ue(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,d=e.length,p=s.vertical,m=p?1:-1,g=s.defaultVMetrics,y=i*t.fontMatrix[0],S=t.textRenderingMode===Pt.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(h,-1):r.scale(h,1);let v,x;if(t.patternFill){r.save();const N=t.fillColor.getPattern(r,this,Ts(r),Dt.FILL);v=Le(r),r.restore(),r.fillStyle=N}if(t.patternStroke){r.save();const N=t.strokeColor.getPattern(r,this,Ts(r),Dt.STROKE);x=Le(r),r.restore(),r.strokeStyle=N}let b=t.lineWidth;const E=t.textMatrixScale;if(E===0||b===0){const N=t.textRenderingMode&Pt.FILL_STROKE_MASK;(N===Pt.STROKE||N===Pt.FILL_STROKE)&&(b=this.getSinglePixelWidth())}else b/=E;if(a!==1&&(r.scale(a,a),b/=a),r.lineWidth=b,s.isInvalidPDFjsFont){const N=[];let T=0;for(const R of e)N.push(R.unicode),T+=R.width;r.fillText(N.join(""),0,0),t.x+=T*y*h,r.restore(),this.compose();return}let C=0,P;for(P=0;P<d;++P){const N=e[P];if(typeof N=="number"){C+=m*N*i/1e3;continue}let T=!1;const R=(N.isSpace?l:0)+o,L=N.fontChar,I=N.accent;let ne,B,Y=N.width;if(p){const j=N.vmetric||g,z=-(N.vmetric?j[1]:Y*.5)*y,M=j[2]*y;Y=j?-j[0]:Y,ne=z/a,B=(C+M)/a}else ne=C/a,B=0;if(s.remeasure&&Y>0){const j=r.measureText(L).width*1e3/i*a;if(Y<j&&this.isFontSubpixelAAEnabled){const z=Y/j;T=!0,r.save(),r.scale(z,1),ne/=z}else Y!==j&&(ne+=(Y-j)/2e3*i/a)}if(this.contentVisible&&(N.isInFont||s.missingFile)){if(S&&!I)r.fillText(L,ne,B);else if(this.paintChar(L,ne,B,v,x),I){const j=ne+i*I.offset.x/a,z=B-i*I.offset.y/a;this.paintChar(I.fontChar,j,z,v,x)}}const $=p?Y*y-R*u:Y*y+R*u;C+=$,T&&r.restore()}p?t.y-=C:t.x+=C*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,a=s.fontDirection,o=i.vertical?1:-1,l=s.charSpacing,u=s.wordSpacing,h=s.textHScale*a,d=s.fontMatrix||ly,p=e.length,m=s.textRenderingMode===Pt.INVISIBLE;let g,y,S,v;if(!(m||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(h,a),g=0;g<p;++g){if(y=e[g],typeof y=="number"){v=o*y*r/1e3,this.ctx.translate(v,0),s.x+=v*h;continue}const x=(y.isSpace?u:0)+l,b=i.charProcOperatorList[y.operatorListId];if(!b){re(`Type3 character "${y.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=y,this.save(),t.scale(r,r),t.transform(...d),this.executeOperatorList(b),this.restore()),S=K.applyTransform([y.width,0],d)[0]*r+x,t.translate(S,0),s.x+=S*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,a){this.ctx.rect(s,i,r-s,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||Le(this.ctx),r={createCanvasGraphics:a=>new j0(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new jy(e,s,this.ctx,r,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=K.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=K.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=zN(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Ts(t),Dt.SHADING);const i=Ts(t);if(i){const{width:r,height:a}=t.canvas,[o,l,u,h]=K.getAxialAlignedBoundingBox([0,0,r,a],i);this.ctx.fillRect(o,l,u-o,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Ce("Should not call beginInlineImage")}beginImageData(){Ce("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Le(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(Le(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||dm("TODO: Support non-isolated groups."),e.knockout&&re("Knockout groups not supported.");const s=Le(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=K.getAxialAlignedBoundingBox(e.bbox,Le(t));const r=[0,0,t.canvas.width,t.canvas.height];i=K.intersect(i,r)||[0,0,0,0];const a=Math.floor(i[0]),o=Math.floor(i[1]),l=Math.max(Math.ceil(i[2])-a,1),u=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,l,u),p=d.context;p.translate(-a,-o),p.transform(...s),e.smask?this.smaskStack.push({canvas:d.canvas,context:p,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Wc(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Le(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=K.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(_(this,ks,Iy).call(this),Yd(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[l,u]=K.singularValueDecompose2dScale(Le(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),p=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,p);const{canvas:m,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(l,0,0,-u,0,o*u),Yd(this.ctx)}else Yd(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new gx(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),_(this,ks,Dy).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=WN(e)),i.compiled)){i.compiled(s);return}const r=this._createMaskCanvas(e),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=Le(o);o.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-l[4],u.offsetY-l[5]);for(let h=0,d=a.length;h<d;h+=2){const p=K.transform(l,[t,s,i,r,a[h],a[h+1]]),[m,g]=K.applyTransform([0,0],p);o.drawImage(u.canvas,m,g)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:a,width:o,height:l,transform:u}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,l),d=h.context;d.save();const p=this.getObject(a,r);vx(d,p),d.globalCompositeOperation="source-in",d.fillStyle=i?s.getPattern(d,this,Ts(t),Dt.FILL):s,d.fillRect(0,0,o,l),d.restore(),t.save(),t.transform(...u),t.scale(1,-1),qd(t,h.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){re("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){re("Dependent image isn't ready yet");return}const a=r.width,o=r.height,l=[];for(let u=0,h=i.length;u<h;u+=2)l.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!Ot){const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/s);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,s).context;yx(l,e),r=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(r,Ts(i));i.imageSmoothingEnabled=wx(Le(i),e.interpolate),qd(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,a).context;yx(l,e),i=this.applyTransferMapsToCanvas(l)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),qd(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===xx?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Le(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,o;if(s===0&&i===0){const l=Math.abs(t),u=Math.abs(r);if(l===u)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/u;else{const h=l*e,d=u*e;a=h<1?1/h:1,o=d<1?1/d:1}}else{const l=Math.abs(t*r-s*i),u=Math.hypot(t,s),h=Math.hypot(i,r);if(e===0)a=h/l,o=u/l;else{const d=e*l;a=h>d?h/d:1,o=u>d?u/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,r]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&r===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(i,r),a.length>0){const o=Math.max(i,r);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};ks=new WeakSet,Iy=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Dy=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},Fy=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let fl=j0;for(const n in os)fl.prototype[n]!==void 0&&(fl.prototype[os[n]]=fl.prototype[n]);var _h,Eh;class Ii{static get workerPort(){return c(this,_h)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");w(this,_h,e)}static get workerSrc(){return c(this,Eh)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");w(this,Eh,e)}}_h=new WeakMap,Eh=new WeakMap,A(Ii,_h,null),A(Ii,Eh,"");var Fa,Ch;class qN{constructor({parsedData:e,rawData:t}){A(this,Fa);A(this,Ch);w(this,Fa,e),w(this,Ch,t)}getRaw(){return c(this,Ch)}get(e){return c(this,Fa).get(e)??null}getAll(){return S0(c(this,Fa))}has(e){return c(this,Fa).has(e)}}Fa=new WeakMap,Ch=new WeakMap;const Ho=Symbol("INTERNAL");var kh,Nh,Ph,Ml;class YN{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){A(this,kh,!1);A(this,Nh,!1);A(this,Ph,!1);A(this,Ml,!0);w(this,kh,!!(e&Nn.DISPLAY)),w(this,Nh,!!(e&Nn.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(c(this,Ph))return c(this,Ml);if(!c(this,Ml))return!1;const{print:e,view:t}=this.usage;return c(this,kh)?(t==null?void 0:t.viewState)!=="OFF":c(this,Nh)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Ho&&Ce("Internal method `_setVisible` called."),w(this,Ph,s),w(this,Ml,t)}}kh=new WeakMap,Nh=new WeakMap,Ph=new WeakMap,Ml=new WeakMap;var mr,xe,Ll,jl,Th,Oy;class KN{constructor(e,t=Nn.DISPLAY){A(this,Th);A(this,mr,null);A(this,xe,new Map);A(this,Ll,null);A(this,jl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,w(this,jl,e.order);for(const s of e.groups)c(this,xe).set(s.id,new YN(t,s));if(e.baseState==="OFF")for(const s of c(this,xe).values())s._setVisible(Ho,!1);for(const s of e.on)c(this,xe).get(s)._setVisible(Ho,!0);for(const s of e.off)c(this,xe).get(s)._setVisible(Ho,!1);w(this,Ll,this.getHash())}}isVisible(e){if(c(this,xe).size===0)return!0;if(!e)return dm("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,xe).has(e.id)?c(this,xe).get(e.id).visible:(re(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return _(this,Th,Oy).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,xe).has(t))return re(`Optional content group not found: ${t}`),!0;if(c(this,xe).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,xe).has(t))return re(`Optional content group not found: ${t}`),!0;if(!c(this,xe).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,xe).has(t))return re(`Optional content group not found: ${t}`),!0;if(!c(this,xe).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,xe).has(t))return re(`Optional content group not found: ${t}`),!0;if(c(this,xe).get(t).visible)return!1}return!0}return re(`Unknown optional content policy ${e.policy}.`),!0}return re(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=c(this,xe).get(e);if(!i){re(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((r=c(this,xe).get(o))==null||r._setVisible(Ho,!1,!0));i._setVisible(Ho,!!t,!0),w(this,mr,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=c(this,xe).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}w(this,mr,null)}get hasInitialVisibility(){return c(this,Ll)===null||this.getHash()===c(this,Ll)}getOrder(){return c(this,xe).size?c(this,jl)?c(this,jl).slice():[...c(this,xe).keys()]:null}getGroups(){return c(this,xe).size>0?S0(c(this,xe)):null}getGroup(e){return c(this,xe).get(e)||null}getHash(){if(c(this,mr)!==null)return c(this,mr);const e=new ZS;for(const[t,s]of c(this,xe))e.update(`${t}:${s.visible}`);return w(this,mr,e.hexdigest())}}mr=new WeakMap,xe=new WeakMap,Ll=new WeakMap,jl=new WeakMap,Th=new WeakSet,Oy=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=_(this,Th,Oy).call(this,r);else if(c(this,xe).has(r))a=c(this,xe).get(r).visible;else return re(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class QN{constructor(e,{disableRange:t=!1,disableStream:s=!1}){et(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});et(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){et(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new JN(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new ZN(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class JN{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=E0(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ZN{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function eP(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=u(h),r(h)}if(t=a(n),t){const h=u(t);return r(h)}if(t=s("filename","i").exec(n),t){t=t[1];let h=o(t);return h=u(h),r(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const p=new TextDecoder(h,{fatal:!0}),m=fm(d);d=p.decode(m),e=!1}catch{}}return d}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),e&&(h=i("iso-8859-1",h))),h}function a(h){const d=[];let p;const m=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=m.exec(h))!==null;){let[,y,S,v]=p;if(y=parseInt(y,10),y in d){if(y===0)break;continue}d[y]=[S,v]}const g=[];for(let y=0;y<d.length&&y in d;++y){let[S,v]=d[y];v=o(v),S&&(v=unescape(v),y===0&&(v=l(v))),g.push(v)}return g.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let p=0;p<d.length;++p){const m=d[p].indexOf('"');m!==-1&&(d[p]=d[p].slice(0,m),d.length=p+1),d[p]=d[p].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function l(h){const d=h.indexOf("'");if(d===-1)return h;const p=h.slice(0,d),g=h.slice(d+1).replace(/^[^']*'/,"");return i(p,g)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,p,m,g){if(m==="q"||m==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,S){return String.fromCharCode(parseInt(S,16))}),i(p,g);try{g=atob(g)}catch{}return i(p,g)})}return""}function fA(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function gm(n){try{return new URL(n).origin}catch{}return null}function pA({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function mA(n){const e=n.get("Content-Disposition");if(e){let t=eP(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(E0(t))return t}return null}function ym(n,e){return n===404||n===0&&e.startsWith("file:")?new Gu('Missing PDF "'+e+'".'):new gp(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function gA(n){return n===200||n===206}function yA(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function vA(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(re(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class bx{constructor(e){Q(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=fA(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return et(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new tP(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new nP(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class tP{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,yA(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=gm(r.url),!gA(r.status))throw ym(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:l}=pA({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=mA(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new qr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:vA(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class nP{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,yA(r,this._withCredentials,this._abortController)).then(o=>{const l=gm(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!gA(o.status))throw ym(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:vA(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const Zm=200,eg=206;function sP(n){const e=n.response;return typeof e!="string"?e:fm(e).buffer}class iP{constructor({url:e,httpHeaders:t,withCredentials:s}){Q(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=fA(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=eg):i.expectedStatus=Zm,t.responseType="arraybuffer",et(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||Zm;if(!(r===Zm&&s.expectedStatus===eg)&&r!==s.expectedStatus){s.onError(i.status);return}const o=sP(i);if(r===eg){const l=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?s.onDone({begin:parseInt(u[1],10),chunk:o}):(re('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class rP{constructor(e){this._source=e,this._manager=new iP(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return et(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new aP(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new oP(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class aP{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=gm(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...u]=o.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=pA({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=mA(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=ym(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class oP{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=gm((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=ym(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const lP=/^[a-z][a-z0-9\-+.]+:/i;function cP(n){if(lP.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class uP{constructor(e){this.source=e,this.url=cP(e.url),et(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return et(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new hP(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new dP(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class hP{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Gu(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new qr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class dP{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const fP=1e5,tn=30,pP=.8;var Mx,gr,an,Rh,Mh,Oa,wi,Lh,jh,za,Il,Dl,yr,Fl,Ih,Ol,Ba,Dh,Fh,Ua,Ha,Oh,vr,zl,Gi,wA,xA,zy,jn,Af,By,bA,SA;const st=class st{constructor({textContentSource:e,container:t,viewport:s}){A(this,Gi);A(this,gr,Promise.withResolvers());A(this,an,null);A(this,Rh,!1);A(this,Mh,!!((Mx=globalThis.FontInspector)!=null&&Mx.enabled));A(this,Oa,null);A(this,wi,null);A(this,Lh,0);A(this,jh,0);A(this,za,null);A(this,Il,null);A(this,Dl,0);A(this,yr,0);A(this,Fl,Object.create(null));A(this,Ih,[]);A(this,Ol,null);A(this,Ba,[]);A(this,Dh,new WeakMap);A(this,Fh,null);var l;if(e instanceof ReadableStream)w(this,Ol,e);else if(typeof e=="object")w(this,Ol,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');w(this,an,w(this,Il,t)),w(this,yr,s.scale*(globalThis.devicePixelRatio||1)),w(this,Dl,s.rotation),w(this,wi,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:o}=s.rawDims;w(this,Fh,[1,0,0,-1,-a,o+r]),w(this,jh,i),w(this,Lh,r),_(l=st,jn,bA).call(l),No(t,s),c(this,gr).promise.finally(()=>{c(st,zl).delete(this),w(this,wi,null),w(this,Fl,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Yt.platform;return ue(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,za).read().then(({value:t,done:s})=>{if(s){c(this,gr).resolve();return}c(this,Oa)??w(this,Oa,t.lang),Object.assign(c(this,Fl),t.styles),_(this,Gi,wA).call(this,t.items),e()},c(this,gr).reject)};return w(this,za,c(this,Ol).getReader()),c(st,zl).add(this),e(),c(this,gr).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==c(this,Dl)&&(t==null||t(),w(this,Dl,i),No(c(this,Il),{rotation:i})),s!==c(this,yr)){t==null||t(),w(this,yr,s);const a={div:null,properties:null,ctx:_(r=st,jn,Af).call(r,c(this,Oa))};for(const o of c(this,Ba))a.properties=c(this,Dh).get(o),a.div=o,_(this,Gi,zy).call(this,a)}}cancel(){var t;const e=new qr("TextLayer task cancelled.");(t=c(this,za))==null||t.cancel(e).catch(()=>{}),w(this,za,null),c(this,gr).reject(e)}get textDivs(){return c(this,Ba)}get textContentItemsStr(){return c(this,Ih)}static cleanup(){if(!(c(this,zl).size>0)){c(this,Ua).clear();for(const{canvas:e}of c(this,Ha).values())e.remove();c(this,Ha).clear()}}};gr=new WeakMap,an=new WeakMap,Rh=new WeakMap,Mh=new WeakMap,Oa=new WeakMap,wi=new WeakMap,Lh=new WeakMap,jh=new WeakMap,za=new WeakMap,Il=new WeakMap,Dl=new WeakMap,yr=new WeakMap,Fl=new WeakMap,Ih=new WeakMap,Ol=new WeakMap,Ba=new WeakMap,Dh=new WeakMap,Fh=new WeakMap,Ua=new WeakMap,Ha=new WeakMap,Oh=new WeakMap,vr=new WeakMap,zl=new WeakMap,Gi=new WeakSet,wA=function(e){var i,r;if(c(this,Rh))return;(r=c(this,wi)).ctx??(r.ctx=_(i=st,jn,Af).call(i,c(this,Oa)));const t=c(this,Ba),s=c(this,Ih);for(const a of e){if(t.length>fP){re("Ignoring additional textDivs for performance reasons."),w(this,Rh,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=c(this,an);w(this,an,document.createElement("span")),c(this,an).classList.add("markedContent"),a.id!==null&&c(this,an).setAttribute("id",`${a.id}`),o.append(c(this,an))}else a.type==="endMarkedContent"&&w(this,an,c(this,an).parentNode);continue}s.push(a.str),_(this,Gi,xA).call(this,a)}},xA=function(e){var y;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,Ba).push(t);const i=K.transform(c(this,Fh),e.transform);let r=Math.atan2(i[1],i[0]);const a=c(this,Fl)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=c(this,Mh)&&a.fontSubstitution||a.fontFamily;o=st.fontFamilyMap.get(o)||o;const l=Math.hypot(i[2],i[3]),u=l*_(y=st,jn,SA).call(y,o,c(this,Oa));let h,d;r===0?(h=i[4],d=i[5]-u):(h=i[4]+u*Math.sin(r),d=i[5]-u*Math.cos(r));const p="calc(var(--scale-factor)*",m=t.style;c(this,an)===c(this,Il)?(m.left=`${(100*h/c(this,jh)).toFixed(2)}%`,m.top=`${(100*d/c(this,Lh)).toFixed(2)}%`):(m.left=`${p}${h.toFixed(2)}px)`,m.top=`${p}${d.toFixed(2)}px)`),m.fontSize=`${p}${(c(st,vr)*l).toFixed(2)}px)`,m.fontFamily=o,s.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,Mh)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const S=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);S!==v&&Math.max(S,v)/Math.min(S,v)>1.5&&(g=!0)}if(g&&(s.canvasWidth=a.vertical?e.height:e.width),c(this,Dh).set(t,s),c(this,wi).div=t,c(this,wi).properties=s,_(this,Gi,zy).call(this,c(this,wi)),s.hasText&&c(this,an).append(t),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),c(this,an).append(S)}},zy=function(e){var o;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let a="";if(c(st,vr)>1&&(a=`scale(${1/c(st,vr)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=r,{canvasWidth:u,fontSize:h}=s;_(o=st,jn,By).call(o,i,h*c(this,yr),l);const{width:d}=i.measureText(t.textContent);d>0&&(a=`scaleX(${u*c(this,yr)/d}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},jn=new WeakSet,Af=function(e=null){let t=c(this,Ha).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,Ha).set(e,t),c(this,Oh).set(t,{size:0,family:""})}return t},By=function(e,t,s){const i=c(this,Oh).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},bA=function(){if(c(this,vr)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),w(this,vr,e.getBoundingClientRect().height),e.remove()},SA=function(e,t){const s=c(this,Ua).get(e);if(s)return s;const i=_(this,jn,Af).call(this,t);i.canvas.width=i.canvas.height=tn,_(this,jn,By).call(this,i,tn,e);const r=i.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return c(this,Ua).set(e,h),i.canvas.width=i.canvas.height=0,h}i.strokeStyle="red",i.clearRect(0,0,tn,tn),i.strokeText("g",0,0);let l=i.getImageData(0,0,tn,tn).data;o=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){o=Math.ceil(h/4/tn);break}i.clearRect(0,0,tn,tn),i.strokeText("A",0,tn),l=i.getImageData(0,0,tn,tn).data,a=0;for(let h=0,d=l.length;h<d;h+=4)if(l[h]>0){a=tn-Math.floor(h/4/tn);break}i.canvas.width=i.canvas.height=0;const u=a?a/(a+o):pP;return c(this,Ua).set(e,u),u},A(st,jn),A(st,Ua,new Map),A(st,Ha,new Map),A(st,Oh,new WeakMap),A(st,vr,null),A(st,zl,new Set);let Xu=st;class qu{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var l;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(qu.shouldBuildText(o))(l=r==null?void 0:r.attributes)!=null&&l.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const mP=65536,gP=100,yP=5e3,vP=Ot?MN:PN,wP=Ot?LN:oA,xP=Ot?RN:TN,bP=Ot?jN:hA;function SP(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Uy,{docId:t}=e,s=n.url?AP(n.url):null,i=n.data?_P(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof AA?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:mP;let h=n.worker instanceof pl?n.worker:null;const d=n.verbosity,p=typeof n.docBaseUrl=="string"&&!mm(n.docBaseUrl)?n.docBaseUrl:null,m=typeof n.cMapUrl=="string"?n.cMapUrl:null,g=n.cMapPacked!==!1,y=n.CMapReaderFactory||wP,S=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||bP,x=n.stopAtErrors!==!0,b=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,E=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Ot,P=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Ot&&(Yt.platform.isFirefox||!globalThis.chrome),N=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,T=typeof n.disableFontFace=="boolean"?n.disableFontFace:Ot,R=n.fontExtraProperties===!0,L=n.enableXfa===!0,I=n.ownerDocument||globalThis.document,ne=n.disableRange===!0,B=n.disableStream===!0,Y=n.disableAutoFetch===!0,$=n.pdfBug===!0,j=n.CanvasFactory||vP,z=n.FilterFactory||xP,M=n.enableHWA===!0,F=l?l.length:n.length??NaN,H=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Ot&&!T,O=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:y===oA&&v===hA&&m&&S&&Zc(m,document.baseURI)&&Zc(S,document.baseURI),J=null;oN(d);const ge={canvasFactory:new j({ownerDocument:I,enableHWA:M}),filterFactory:new z({docId:t,ownerDocument:I}),cMapReaderFactory:O?null:new y({baseUrl:m,isCompressed:g}),standardFontDataFactory:O?null:new v({baseUrl:S})};if(!h){const Ee={verbosity:d,port:Ii.workerPort};h=Ee.port?pl.fromPort(Ee):new pl(Ee),e._worker=h}const De={docId:t,apiVersion:"4.10.38",data:i,password:o,disableAutoFetch:Y,rangeChunkSize:u,length:F,docBaseUrl:p,enableXfa:L,evaluatorOptions:{maxImageSize:b,disableFontFace:T,ignoreErrors:x,isEvalSupported:E,isOffscreenCanvasSupported:C,isImageDecoderSupported:P,canvasMaxAreaInBytes:N,fontExtraProperties:R,useSystemFonts:H,cMapUrl:O?m:null,standardFontDataUrl:O?S:null}},ct={disableFontFace:T,fontExtraProperties:R,ownerDocument:I,pdfBug:$,styleElement:J,loadingParams:{disableAutoFetch:Y,enableXfa:L}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ee=h.messageHandler.sendWithPromise("GetDocRequest",De,i?[i.buffer]:null);let se;if(l)se=new QN(l,{disableRange:ne,disableStream:B});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let Bt;if(Ot)if(Zc(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Bt=bx}else Bt=uP;else Bt=Zc(s)?bx:rP;se=new Bt({url:s,length:F,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:ne,disableStream:B})}return Ee.then(Bt=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const On=new su(t,Bt,h.port),en=new NP(On,e,se,ct,ge);e._transport=en,On.send("Ready",null)})}).catch(e._capability.reject),e}function AP(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Ot&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function _P(n){if(Ot&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return fm(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Sx(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var Lp;const jp=class jp{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ut(jp,Lp)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};Lp=new WeakMap,A(jp,Lp,0);let Uy=jp;class AA{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Ce("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class EP{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ue(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var wr,xi,Kn,$o,_f;class CP{constructor(e,t,s,i=!1){A(this,Kn);A(this,wr,null);A(this,xi,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new lx:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new _A,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new Cd({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ue(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=nr.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:d=!1}){var E,C;(E=this._stats)==null||E.time("Overall");const p=this._transport.getRenderingIntent(s,i,h,d),{renderingIntent:m,cacheKey:g}=p;w(this,xi,!1),_(this,Kn,_f).call(this),o||(o=this._transport.getOptionalContentConfig(m));let y=this._intentStates.get(g);y||(y=Object.create(null),this._intentStates.set(g,y)),y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null);const S=!!(m&Nn.PRINT);y.displayReadyCapability||(y.displayReadyCapability=Promise.withResolvers(),y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(p));const v=P=>{var N;y.renderTasks.delete(x),(this._maybeCleanupAfterRender||S)&&w(this,xi,!0),_(this,Kn,$o).call(this,!S),P?(x.capability.reject(P),this._abortOperatorList({intentState:y,reason:P instanceof Error?P:new Error(P)})):x.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(N=globalThis.Stats)!=null&&N.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},x=new $y({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:u});(y.renderTasks||(y.renderTasks=new Set)).add(x);const b=x.task;return Promise.all([y.displayReadyCapability.promise,o]).then(([P,N])=>{var T;if(this.destroyed){v();return}if((T=this._stats)==null||T.time("Rendering"),!(N.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");x.initializeGraphics({transparency:P,optionalContentConfig:N}),x.operatorListChanged()}).catch(v),b}getOperatorList({intent:e="display",annotationMode:t=nr.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>qu.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:l,done:u}){if(u){s(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),r()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),w(this,xi,!1),_(this,Kn,_f).call(this),Promise.all(e)}cleanup(e=!1){w(this,xi,!0);const t=_(this,Kn,$o).call(this,!1);return e&&t&&this._stats&&(this._stats=new lx),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&_(this,Kn,$o).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=l;const h=()=>{l.read().then(({value:d,done:p})=>{if(p){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const p of u.renderTasks)p.operatorListChanged();_(this,Kn,$o).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof _0){let i=gP;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new qr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}wr=new WeakMap,xi=new WeakMap,Kn=new WeakSet,$o=function(e=!1){if(_(this,Kn,_f).call(this),!c(this,xi)||this.destroyed)return!1;if(e)return w(this,wr,setTimeout(()=>{w(this,wr,null),_(this,Kn,$o).call(this,!1)},yP)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),w(this,xi,!1),!0},_f=function(){c(this,wr)&&(clearTimeout(c(this,wr)),w(this,wr,null))};var bi,Ip;class kP{constructor(){A(this,bi,new Map);A(this,Ip,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};c(this,Ip).then(()=>{for(const[i]of c(this,bi))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){re("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}c(this,bi).set(t,i)}removeEventListener(e,t){const s=c(this,bi).get(t);s==null||s(),c(this,bi).delete(t)}terminate(){for(const[,e]of c(this,bi))e==null||e();c(this,bi).clear()}}bi=new WeakMap,Ip=new WeakMap;var Dp,$a,Wa,Bl,Ef,Ul,Cf;const Me=class Me{constructor({name:e=null,port:t=null,verbosity:s=lN()}={}){A(this,Bl);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=c(Me,Wa))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(c(Me,Wa)||w(Me,Wa,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new su("main","worker",e),this._messageHandler.on("ready",function(){}),_(this,Bl,Ef).call(this)}_initialize(){if(c(Me,$a)||c(Me,Ul,Cf)){this._setupFakeWorker();return}let{workerSrc:e}=Me;try{Me._isSameOrigin(window.location.href,e)||(e=Me._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new su("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){i();return}this._messageHandler=s,this._port=t,this._webWorker=t,_(this,Bl,Ef).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{dm("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){c(Me,$a)||(re("Setting up fake worker."),w(Me,$a,!0)),Me._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new kP;this._port=t;const s=`fake${Ut(Me,Dp)._++}`,i=new su(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new su(s,s+"_worker",t),_(this,Bl,Ef).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,s;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=c(Me,Wa))==null||t.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=c(this,Wa))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Me(e)}static get workerSrc(){if(Ii.workerSrc)return Ii.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ue(this,"_setupFakeWorkerGlobal",(async()=>c(this,Ul,Cf)?c(this,Ul,Cf):(await import(this.workerSrc)).WorkerMessageHandler)())}};Dp=new WeakMap,$a=new WeakMap,Wa=new WeakMap,Bl=new WeakSet,Ef=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ul=new WeakSet,Cf=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},A(Me,Ul),A(Me,Dp,0),A(Me,$a,!1),A(Me,Wa),Ot&&(w(Me,$a,!0),Ii.workerSrc||(Ii.workerSrc="./pdf.worker.mjs")),Me._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},Me._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let pl=Me;var Si,$s,Hl,$l,Ai,Va,lu;class NP{constructor(e,t,s,i,r){A(this,Va);A(this,Si,new Map);A(this,$s,new Map);A(this,Hl,new Map);A(this,$l,new Map);A(this,Ai,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new _A,this.fontLoader=new kN({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ue(this,"annotationStorage",new N0)}getRenderingIntent(e,t=nr.ENABLE,s=null,i=!1,r=!1){let a=Nn.DISPLAY,o=Ty;switch(e){case"any":a=Nn.ANY;break;case"display":break;case"print":a=Nn.PRINT;break;default:re(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Nn.PRINT&&s instanceof tA?s:this.annotationStorage;switch(t){case nr.DISABLE:a+=Nn.ANNOTATIONS_DISABLE;break;case nr.ENABLE:break;case nr.ENABLE_FORMS:a+=Nn.ANNOTATIONS_FORMS;break;case nr.ENABLE_STORAGE:a+=Nn.ANNOTATIONS_STORAGE,o=l.serializable;break;default:re(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=Nn.IS_EDITING),r&&(a+=Nn.OPLIST);const{ids:u,hash:h}=l.modifiedIds,d=[a,o.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=c(this,Ai))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of c(this,$s).values())e.push(i._destroy());c(this,$s).clear(),c(this,Hl).clear(),c(this,$l).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),c(this,Si).clear(),this.filterFactory.destroy(),Xu.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new qr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{et(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}et(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{et(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){i.close();return}et(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new EP(s,this))}),e.on("DocException",s=>{t._capability.reject(nn(s))}),e.on("PasswordRequest",s=>{w(this,Ai,Promise.withResolvers());try{if(!t.onPassword)throw nn(s);const i=r=>{r instanceof Error?c(this,Ai).reject(r):c(this,Ai).resolve({password:r})};t.onPassword(i,s.code)}catch(i){c(this,Ai).reject(i)}return c(this,Ai).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;c(this,$s).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:o,fontExtraProperties:l,pdfBug:u}=this._params;if("error"in r){const m=r.error;re(`Error during font loading: ${m}`),this.commonObjs.resolve(s,m);break}const h=u&&((a=globalThis.FontInspector)!=null&&a.enabled)?(m,g)=>globalThis.FontInspector.fontAdded(m,g):null,d=new NN(r,{disableFontFace:o,fontExtraProperties:l,inspectFont:h});this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!l&&d.data&&(d.data=null),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:p}=r;et(p,"The imageRef must be defined.");for(const m of c(this,$s).values())for(const[,g]of m.objs)if((g==null?void 0:g.ref)===p)return g.dataLen?(this.commonObjs.resolve(s,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var l;if(this.destroyed)return;const o=c(this,$s).get(i);if(!o.objs.has(s)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(r){case"Image":o.objs.resolve(s,a),(a==null?void 0:a.dataLen)>sN&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&re("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=c(this,Hl).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&c(this,$l).set(r.refStr,e);const a=new CP(t,r,this,this._params.pdfBug);return c(this,$s).set(t,a),a});return c(this,Hl).set(t,i),i}getPageIndex(e){return Sx(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return _(this,Va,lu).call(this,"GetFieldObjects")}hasJSActions(){return _(this,Va,lu).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return _(this,Va,lu).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return _(this,Va,lu).call(this,"GetOptionalContentConfig").then(t=>new KN(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,Si).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new qN(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return c(this,Si).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,$s).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,Si).clear(),this.filterFactory.destroy(!0),Xu.cleanup()}}cachedPageNumber(e){if(!Sx(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return c(this,$l).get(t)??null}}Si=new WeakMap,$s=new WeakMap,Hl=new WeakMap,$l=new WeakMap,Ai=new WeakMap,Va=new WeakSet,lu=function(e,t=null){const s=c(this,Si).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return c(this,Si).set(e,i),i};const Vc=Symbol("INITIAL_DATA");var wn,zh,Hy;class _A{constructor(){A(this,zh);A(this,wn,Object.create(null))}get(e,t=null){if(t){const i=_(this,zh,Hy).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=c(this,wn)[e];if(!s||s.data===Vc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=c(this,wn)[e];return!!t&&t.data!==Vc}delete(e){const t=c(this,wn)[e];return!t||t.data===Vc?!1:(delete c(this,wn)[e],!0)}resolve(e,t=null){const s=_(this,zh,Hy).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in c(this,wn)){const{data:s}=c(this,wn)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}w(this,wn,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,wn)){const{data:t}=c(this,wn)[e];t!==Vc&&(yield[e,t])}}}wn=new WeakMap,zh=new WeakSet,Hy=function(e){var t;return(t=c(this,wn))[e]||(t[e]={...Promise.withResolvers(),data:Vc})};var xr;class PP{constructor(e){A(this,xr,null);w(this,xr,e),this.onContinue=null}get promise(){return c(this,xr).capability.promise}cancel(e=0){c(this,xr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=c(this,xr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=c(this,xr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}xr=new WeakMap;var br,Ga;const ua=class ua{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:p=null}){A(this,br,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=d,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new PP(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(c(ua,Ga).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(ua,Ga).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:a}=this.params;this.gfx=new fl(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),c(this,br)&&(window.cancelAnimationFrame(c(this,br)),w(this,br,null)),c(ua,Ga).delete(this._canvas),this.callback(e||new _0(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?w(this,br,window.requestAnimationFrame(()=>{w(this,br,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(ua,Ga).delete(this._canvas),this.callback())))}};br=new WeakMap,Ga=new WeakMap,A(ua,Ga,new WeakSet);let $y=ua;const TP="4.10.38",RP="f9bea397f";function Ax(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Gc(n){return Math.max(0,Math.min(255,255*n))}class _x{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Gc(e),[e,e,e]}static G_HTML([e]){const t=Ax(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Gc)}static RGB_HTML(e){return`#${e.map(Ax).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Gc(1-Math.min(1,e+i)),Gc(1-Math.min(1,s+i)),Gc(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,o=Math.min(i,r,a);return["CMYK",i,r,a,o]}}class MP{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ce("Abstract method `_createSVG` called.")}}class T0 extends MP{_createSVG(e){return document.createElementNS(si,e)}}class EA{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[l,u]of Object.entries(a))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var d,p;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const o=r!=="richText",l=e.div;if(l.append(a),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=m}o&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const m=document.createTextNode(i.value);a.append(m),o&&qu.shouldBuildText(i.name)&&u.push(m)}return{textDivs:u}}const h=[[i,-1,a]];for(;h.length>0;){const[m,g,y]=h.at(-1);if(g+1===m.children.length){h.pop();continue}const S=m.children[++h.at(-1)[1]];if(S===null)continue;const{name:v}=S;if(v==="#text"){const b=document.createTextNode(S.value);u.push(b),y.append(b);continue}const x=(d=S==null?void 0:S.attributes)!=null&&d.xmlns?document.createElementNS(S.attributes.xmlns,v):document.createElement(v);if(y.append(x),S.attributes&&this.setAttributes({html:x,element:S,storage:t,intent:r,linkService:s}),((p=S.children)==null?void 0:p.length)>0)h.push([S,-1,x]);else if(S.value){const b=document.createTextNode(S.value);o&&qu.shouldBuildText(v)&&u.push(b),x.append(b)}}for(const m of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Nd=1e3,LP=9,To=new WeakSet;function Vr(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class jP{static create(e){switch(e.data.annotationType){case nt.LINK:return new CA(e);case nt.TEXT:return new IP(e);case nt.WIDGET:switch(e.data.fieldType){case"Tx":return new DP(e);case"Btn":return e.data.radioButton?new PA(e):e.data.checkBox?new OP(e):new zP(e);case"Ch":return new BP(e);case"Sig":return new FP(e)}return new Do(e);case nt.POPUP:return new Vy(e);case nt.FREETEXT:return new jA(e);case nt.LINE:return new HP(e);case nt.SQUARE:return new $P(e);case nt.CIRCLE:return new WP(e);case nt.POLYLINE:return new IA(e);case nt.CARET:return new GP(e);case nt.INK:return new R0(e);case nt.POLYGON:return new VP(e);case nt.HIGHLIGHT:return new DA(e);case nt.UNDERLINE:return new XP(e);case nt.SQUIGGLY:return new qP(e);case nt.STRIKEOUT:return new YP(e);case nt.STAMP:return new FA(e);case nt.FILEATTACHMENT:return new KP(e);default:return new Qe(e)}}}var Xa,Wl,Vl,Bh,Wy;const I0=class I0{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){A(this,Bh);A(this,Xa,null);A(this,Wl,!1);A(this,Vl,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return I0._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;c(this,Xa)||w(this,Xa,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&_(this,Bh,Wy).call(this,t),(s=c(this,Vl))==null||s.popup.updateEdited(e)}resetEdited(){var e;c(this,Xa)&&(_(this,Bh,Wy).call(this,c(this,Xa).rect),(e=c(this,Vl))==null||e.popup.resetEdited(),w(this,Xa,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Do||(r.tabIndex=Nd);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof Vy){const{rotation:y}=t;return!t.hasOwnCanvas&&y!==0&&this.setRotation(y,r),r}const{width:o,height:l}=Vr(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const y=t.borderStyle.horizontalCornerRadius,S=t.borderStyle.verticalCornerRadius;if(y>0||S>0){const x=`calc(${y}px * var(--scale-factor)) / calc(${S}px * var(--scale-factor))`;a.borderRadius=x}else if(this instanceof PA){const x=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=x}switch(t.borderStyle.style){case $c.SOLID:a.borderStyle="solid";break;case $c.DASHED:a.borderStyle="dashed";break;case $c.BEVELED:re("Unimplemented border style: beveled");break;case $c.INSET:re("Unimplemented border style: inset");break;case $c.UNDERLINE:a.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(w(this,Wl,!0),a.borderColor=K.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}const u=K.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:p,pageY:m}=i.rawDims;a.left=`${100*(u[0]-p)/h}%`,a.top=`${100*(u[1]-m)/d}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*o/h}%`,a.height=`${100*l/d}%`):this.setRotation(g,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:a}=Vr(this.data.rect);let o,l;e%180===0?(o=100*r/s,l=100*a/i):(o=100*a/s,l=100*r/i),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],o=r.slice(1);i.target.style[s]=_x[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:_x[`${a}_rgb`](o)})};return ue(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const o={detail:{[i]:r},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(y=>Math.fround(y));if(e.length===8){const[y,S,v,x]=e.subarray(2,6);if(i===y&&r===S&&t===v&&s===x)return}const{style:a}=this.container;let o;if(c(this,Wl)){const{borderColor:y,borderWidth:S}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const l=i-t,u=r-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const p=h.createElement("defs");d.append(p);const m=h.createElement("clipPath"),g=`clippath_${this.data.id}`;m.setAttribute("id",g),m.setAttribute("clipPathUnits","objectBoundingBox"),p.append(m);for(let y=2,S=e.length;y<S;y+=8){const v=e[y],x=e[y+1],b=e[y+2],E=e[y+3],C=h.createElement("rect"),P=(b-t)/l,N=(r-x)/u,T=(v-b)/l,R=(x-E)/u;C.setAttribute("x",P),C.setAttribute("y",N),C.setAttribute("width",T),C.setAttribute("height",R),m.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${P}" y="${N}" width="${T}" height="${R}"/>`)}c(this,Wl)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${g})`}_createPopup(){const{data:e}=this,t=w(this,Vl,new Vy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Ce("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:o}of i){if(r===-1||a===t)continue;const l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!To.has(u)){re(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:l,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&To.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Xa=new WeakMap,Wl=new WeakMap,Vl=new WeakMap,Bh=new WeakSet,Wy=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}}}=this;s==null||s.splice(0,4,...e);const{width:u,height:h}=Vr(e);t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+l)/a}%`,i===0?(t.width=`${100*u/r}%`,t.height=`${100*h/a}%`):this.setRotation(i)};let Qe=I0;var Tn,ra,kA,NA;class CA extends Qe{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});A(this,Tn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(_(this,Tn,kA).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(_(this,Tn,NA).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&_(this,Tn,ra).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),_(this,Tn,ra).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),_(this,Tn,ra).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),_(this,Tn,ra).call(this),!this._fieldObjects){re('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var d;i==null||i();const{fields:r,refs:a,include:o}=s,l=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const m of r){const g=this._fieldObjects[m]||[];for(const{id:y}of g)p.add(y)}for(const m of Object.values(this._fieldObjects))for(const g of m)p.has(g.id)===o&&l.push(g)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const u=this.annotationStorage,h=[];for(const p of l){const{id:m}=p;switch(h.push(m),p.type){case"text":{const y=p.defaultValue||"";u.setValue(m,{value:y});break}case"checkbox":case"radiobutton":{const y=p.defaultValue===p.exportValues;u.setValue(m,{value:y});break}case"combobox":case"listbox":{const y=p.defaultValue||"";u.setValue(m,{value:y});break}default:continue}const g=document.querySelector(`[data-element-id="${m}"]`);if(g){if(!To.has(g)){re(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Tn=new WeakSet,ra=function(){this.container.setAttribute("data-internal-link","")},kA=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},_(this,Tn,ra).call(this)},NA=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),_(this,Tn,ra).call(this)};class IP extends Qe{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Do extends Qe{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Yt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,o;for(const[l,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":K.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||LP,r=e.style;let a;const o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(u/(qm*i))||1,d=u/h;a=Math.min(i,l(d/qm))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,l(u/qm))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=K.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class DP extends Do{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),To.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=Nd,this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",p=>{e.setValue(t,{value:p.target.value}),this.setPropertyOnSiblings(s,"value",p.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue??"";s.value=h.userValue=m,h.formattedValue=null});let d=p=>{const{formattedValue:m}=h;m!=null&&(p.target.value=m),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",m=>{var y;if(h.focused)return;const{target:g}=m;h.userValue&&(g.value=h.userValue),h.lastCommittedValue=g.value,h.commitKey=1,(y=this.data.actions)!=null&&y.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const g={value(y){h.userValue=y.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),y.target.value=h.userValue},formattedValue(y){const{formattedValue:S}=y.detail;h.formattedValue=S,S!=null&&y.target!==document.activeElement&&(y.target.value=S),e.setValue(t,{formattedValue:S})},selRange(y){y.target.setSelectionRange(...y.detail.selRange)},charLimit:y=>{var b;const{charLimit:S}=y.detail,{target:v}=y;if(S===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",S);let x=h.userValue;!x||x.length<=S||(x=x.slice(0,S),v.value=h.userValue=x,e.setValue(t,{value:x}),(b=this.linkService.eventBus)==null||b.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(g,m)}),s.addEventListener("keydown",m=>{var S;h.commitKey=1;let g=-1;if(m.key==="Escape"?g=0:m.key==="Enter"&&!this.data.multiLine?g=2:m.key==="Tab"&&(h.commitKey=3),g===-1)return;const{value:y}=m.target;h.lastCommittedValue!==y&&(h.lastCommittedValue=y,h.userValue=y,(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:g,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const p=d;d=null,s.addEventListener("blur",m=>{var y,S;if(!h.focused||!m.relatedTarget)return;(y=this.data.actions)!=null&&y.Blur||(h.focused=!1);const{value:g}=m.target;h.userValue=g,h.lastCommittedValue!==g&&((S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:g,willCommit:!0,commitKey:h.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),p(m)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",m=>{var C;h.lastCommittedValue=null;const{data:g,target:y}=m,{value:S,selectionStart:v,selectionEnd:x}=y;let b=v,E=x;switch(m.inputType){case"deleteWordBackward":{const P=S.substring(0,v).match(/\w*[^\w]*$/);P&&(b-=P[0].length);break}case"deleteWordForward":{const P=S.substring(v).match(/^[^\w]*\w*/);P&&(E+=P[0].length);break}case"deleteContentBackward":v===x&&(b-=1);break;case"deleteContentForward":v===x&&(E+=1);break}m.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,change:g||"",willCommit:!1,selStart:b,selEnd:E}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(d&&s.addEventListener("blur",d),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${m}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class FP extends Do{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class OP extends Do{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return To.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=Nd,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,s)){const h=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(s,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class PA extends Do{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(To.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=Nd,r.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:l})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const l={value:u=>{const h=a===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const p=h&&d.id===s;d.domElement&&(d.domElement.checked=p),e.setValue(d.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class zP extends CA{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class BP extends Do{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");To.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Nd;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const p of i.options)p.selected=p.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),r=!1),i.append(d)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),i.prepend(h),a=()=>{h.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:p,multiple:m}=i;return m?Array.prototype.filter.call(p,g=>g.selected).map(g=>g[d]):p.selectedIndex===-1?null:p[p.selectedIndex][d]};let l=o(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",h=>{const d={value(p){a==null||a();const m=p.detail.value,g=new Set(Array.isArray(m)?m:[m]);for(const y of i.options)y.selected=g.has(y.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(p){i.multiple=!0},remove(p){const m=i.options,g=p.detail.remove;m[g].selected=!1,i.remove(g),m.length>0&&Array.prototype.findIndex.call(m,S=>S.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},clear(p){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(p){const{index:m,displayValue:g,exportValue:y}=p.detail.insert,S=i.children[m],v=document.createElement("option");v.textContent=g,v.value=y,S?S.before(v):i.append(v),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},items(p){const{items:m}=p.detail;for(;i.length!==0;)i.remove(0);for(const g of m){const{displayValue:y,exportValue:S}=g,v=document.createElement("option");v.textContent=y,v.value=S,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},indices(p){const m=new Set(p.detail.indices);for(const g of p.target.options)g.selected=m.has(g.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(d,h)}),i.addEventListener("input",h=>{var m;const d=o(!0),p=o(!1);e.setValue(t,{value:d}),h.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):i.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Vy extends Qe{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Qe._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new UP({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${A0}${s}`).join(",")),this.container}}var Gl,Fp,Op,Xl,qa,Ve,_i,ql,Uh,Hh,Yl,Ei,ds,Ci,$h,ki,Wh,Ya,Ka,_e,kf,Gy,TA,RA,MA,LA,Nf,Pf,Xy;class UP{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:o,parent:l,rect:u,parentRect:h,open:d}){A(this,_e);A(this,Gl,_(this,_e,MA).bind(this));A(this,Fp,_(this,_e,Xy).bind(this));A(this,Op,_(this,_e,Pf).bind(this));A(this,Xl,_(this,_e,Nf).bind(this));A(this,qa,null);A(this,Ve,null);A(this,_i,null);A(this,ql,null);A(this,Uh,null);A(this,Hh,null);A(this,Yl,null);A(this,Ei,!1);A(this,ds,null);A(this,Ci,null);A(this,$h,null);A(this,ki,null);A(this,Wh,null);A(this,Ya,null);A(this,Ka,!1);var p;w(this,Ve,e),w(this,Wh,i),w(this,_i,a),w(this,ki,o),w(this,Hh,l),w(this,qa,t),w(this,$h,u),w(this,Yl,h),w(this,Uh,s),w(this,ql,C0.toDateObject(r)),this.trigger=s.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",c(this,Xl)),m.addEventListener("mouseenter",c(this,Op)),m.addEventListener("mouseleave",c(this,Fp)),m.classList.add("popupTriggerArea");for(const m of s)(p=m.container)==null||p.addEventListener("keydown",c(this,Gl));c(this,Ve).hidden=!0,d&&_(this,_e,Nf).call(this)}render(){if(c(this,ds))return;const e=w(this,ds,document.createElement("div"));if(e.className="popup",c(this,qa)){const r=e.style.outlineColor=K.makeHexColor(...c(this,qa));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=K.makeHexColor(...c(this,qa).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=c(this,Wh),e.append(t),c(this,ql)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,ql).valueOf()})),t.append(r)}const i=c(this,_e,kf);if(i)EA.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(c(this,_i));e.append(r)}c(this,Ve).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,a=i.length;r<a;++r){const o=i[r];s.append(document.createTextNode(o)),r<a-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;c(this,Ya)||w(this,Ya,{contentsObj:c(this,_i),richText:c(this,ki)}),e&&w(this,Ci,null),t&&(w(this,ki,_(this,_e,RA).call(this,t)),w(this,_i,null)),(s=c(this,ds))==null||s.remove(),w(this,ds,null)}resetEdited(){var e;c(this,Ya)&&({contentsObj:Ut(this,_i)._,richText:Ut(this,ki)._}=c(this,Ya),w(this,Ya,null),(e=c(this,ds))==null||e.remove(),w(this,ds,null),w(this,Ci,null))}forceHide(){w(this,Ka,this.isVisible),c(this,Ka)&&(c(this,Ve).hidden=!0)}maybeShow(){c(this,Ka)&&(c(this,ds)||_(this,_e,Pf).call(this),w(this,Ka,!1),c(this,Ve).hidden=!1)}get isVisible(){return c(this,Ve).hidden===!1}}Gl=new WeakMap,Fp=new WeakMap,Op=new WeakMap,Xl=new WeakMap,qa=new WeakMap,Ve=new WeakMap,_i=new WeakMap,ql=new WeakMap,Uh=new WeakMap,Hh=new WeakMap,Yl=new WeakMap,Ei=new WeakMap,ds=new WeakMap,Ci=new WeakMap,$h=new WeakMap,ki=new WeakMap,Wh=new WeakMap,Ya=new WeakMap,Ka=new WeakMap,_e=new WeakSet,kf=function(){const e=c(this,ki),t=c(this,_i);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&c(this,ki).html||null},Gy=function(){var e,t,s;return((s=(t=(e=c(this,_e,kf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},TA=function(){var e,t,s;return((s=(t=(e=c(this,_e,kf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},RA=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:c(this,_e,TA),fontSize:c(this,_e,Gy)?`calc(${c(this,_e,Gy)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},MA=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,Ei))&&_(this,_e,Nf).call(this)},LA=function(){if(c(this,Ci)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=c(this,Hh);let a=!!c(this,Yl),o=a?c(this,Yl):c(this,$h);for(const g of c(this,Uh))if(!o||K.intersect(g.data.rect,o)!==null){o=g.data.rect,a=!0;break}const l=K.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,d=l[0]+h,p=l[1];w(this,Ci,[100*(d-i)/t,100*(p-r)/s]);const{style:m}=c(this,Ve);m.left=`${c(this,Ci)[0]}%`,m.top=`${c(this,Ci)[1]}%`},Nf=function(){w(this,Ei,!c(this,Ei)),c(this,Ei)?(_(this,_e,Pf).call(this),c(this,Ve).addEventListener("click",c(this,Xl)),c(this,Ve).addEventListener("keydown",c(this,Gl))):(_(this,_e,Xy).call(this),c(this,Ve).removeEventListener("click",c(this,Xl)),c(this,Ve).removeEventListener("keydown",c(this,Gl)))},Pf=function(){c(this,ds)||this.render(),this.isVisible?c(this,Ei)&&c(this,Ve).classList.add("focused"):(_(this,_e,LA).call(this),c(this,Ve).hidden=!1,c(this,Ve).style.zIndex=parseInt(c(this,Ve).style.zIndex)+1e3)},Xy=function(){c(this,Ve).classList.remove("focused"),!(c(this,Ei)||!this.isVisible)&&(c(this,Ve).hidden=!0,c(this,Ve).style.zIndex=parseInt(c(this,Ve).style.zIndex)-1e3)};class jA extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ie.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Vh;class HP extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Vh,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=Vr(t.rect),r=this.svgFactory.create(s,i,!0),a=w(this,Vh,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Vh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Vh=new WeakMap;var Gh;class $P extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Gh,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=Vr(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=w(this,Gh,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Gh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gh=new WeakMap;var Xh;class WP extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Xh,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=Vr(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=w(this,Xh,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Xh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xh=new WeakMap;var qh;class IA extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,qh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r}}=this;if(!s)return this.container;const{width:a,height:o}=Vr(t),l=this.svgFactory.create(a,o,!0);let u=[];for(let d=0,p=s.length;d<p;d+=2){const m=s[d]-t[0],g=t[3]-s[d+1];u.push(`${m},${g}`)}u=u.join(" ");const h=w(this,qh,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,qh)}addHighlightArea(){this.container.classList.add("highlightArea")}}qh=new WeakMap;class VP extends IA{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class GP extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Yh,Qa,Kh,qy;class R0 extends Qe{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});A(this,Kh);A(this,Yh,null);A(this,Qa,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ie.HIGHLIGHT:ie.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:l,height:u}=_(this,Kh,qy).call(this,s,t),h=this.svgFactory.create(l,u,!0),d=w(this,Yh,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let p=0,m=i.length;p<m;p++){const g=this.svgFactory.createElement(this.svgElementName);c(this,Qa).push(g),g.setAttribute("points",i[p].join(",")),d.append(g)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=c(this,Yh);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let o=0,l=c(this,Qa).length;o<l;o++)c(this,Qa)[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:l,height:u}=_(this,Kh,qy).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return c(this,Qa)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yh=new WeakMap,Qa=new WeakMap,Kh=new WeakSet,qy=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class DA extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ie.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class XP extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class qP extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class YP extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class FA extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ie.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Qh,Jh,Yy;class KP extends Qe{constructor(t){var i;super(t,{isRenderable:!0});A(this,Jh);A(this,Qh,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",_(this,Jh,Yy).bind(this)),w(this,Qh,i);const{isMac:r}=Yt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&_(this,Jh,Yy).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return c(this,Qh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qh=new WeakMap,Jh=new WeakSet,Yy=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Zh,Ja,Za,ed,Mo,OA,Ky;class QP{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:o}){A(this,Mo);A(this,Zh,null);A(this,Ja,null);A(this,Za,new Map);A(this,ed,null);this.div=e,w(this,Zh,t),w(this,Ja,s),w(this,ed,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return c(this,Za).size>0}async render(e){var a;const{annotations:t}=e,s=this.div;No(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new T0,annotationStorage:e.annotationStorage||new N0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===nt.POPUP;if(l){const d=i.get(o.id);if(!d)continue;r.elements=d}else{const{width:d,height:p}=Vr(o.rect);if(d<=0||p<=0)continue}r.data=o;const u=jP.create(r);if(!u.isRenderable)continue;if(!l&&o.popupRef){const d=i.get(o.popupRef);d?d.push(u):i.set(o.popupRef,[u])}const h=u.render();o.hidden&&(h.style.visibility="hidden"),await _(this,Mo,OA).call(this,h,o.id),u._isEditable&&(c(this,Za).set(u.data.id,u),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(u))}_(this,Mo,Ky).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,No(t,{rotation:e.rotation}),_(this,Mo,Ky).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,Za).values())}getEditableAnnotation(e){return c(this,Za).get(e)}}Zh=new WeakMap,Ja=new WeakMap,Za=new WeakMap,ed=new WeakMap,Mo=new WeakSet,OA=async function(e,t){var a,o;const s=e.firstChild||e,i=s.id=`${A0}${t}`,r=await((a=c(this,ed))==null?void 0:a.getAriaAttributes(i));if(r)for(const[l,u]of r)s.setAttribute(l,u);this.div.append(e),(o=c(this,Zh))==null||o.moveElementInDOM(this.div,e,s,!1)},Ky=function(){if(!c(this,Ja))return;const e=this.div;for(const[t,s]of c(this,Ja)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:r}=i;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):i.append(s)}c(this,Ja).clear()};const Kd=/\r\n?|\n/g;var fs,xn,td,eo,bn,tt,zA,BA,UA,Tf,Bi,Rf,Mf,HA,Jy,$A;const ke=class ke extends Be{constructor(t){super({...t,name:"freeTextEditor"});A(this,tt);A(this,fs);A(this,xn,"");A(this,td,`${this.id}-editor`);A(this,eo,null);A(this,bn);w(this,fs,t.color||ke._defaultColor||Be._defaultLineColor),w(this,bn,t.fontSize||ke._defaultFontSize)}static get _keyboardManager(){const t=ke.prototype,s=a=>a.isEmpty(),i=Po.TRANSLATE_SMALL,r=Po.TRANSLATE_BIG;return ue(this,"_keyboardManager",new kd([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Be.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case fe.FREETEXT_SIZE:ke._defaultFontSize=s;break;case fe.FREETEXT_COLOR:ke._defaultColor=s;break}}updateParams(t,s){switch(t){case fe.FREETEXT_SIZE:_(this,tt,zA).call(this,s);break;case fe.FREETEXT_COLOR:_(this,tt,BA).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[fe.FREETEXT_SIZE,ke._defaultFontSize],[fe.FREETEXT_COLOR,ke._defaultColor||Be._defaultLineColor]]}get propertiesToUpdate(){return[[fe.FREETEXT_SIZE,c(this,bn)],[fe.FREETEXT_COLOR,c(this,fs)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-ke._internalPadding*t,-(ke._internalPadding+c(this,bn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ie.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),w(this,eo,new AbortController);const t=this._uiManager.combinedSignal(c(this,eo));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,td)),this._isDraggable=!0,(t=c(this,eo))==null||t.abort(),w(this,eo,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,xn),s=w(this,xn,_(this,tt,UA).call(this).trimEnd());if(t===s)return;const i=r=>{if(w(this,xn,r),!r){this.remove();return}_(this,tt,Mf).call(this),this._uiManager.rebuild(this),_(this,tt,Tf).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),_(this,tt,Tf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ke._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,td)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${c(this,bn)}px * var(--scale-factor))`,i.color=c(this,fs),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),yp(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[h,d]=this.pageDimensions,[p,m]=this.pageTranslation;let g,y;switch(this.rotation){case 0:g=t+(o[0]-p)/h,y=s+this.height-(o[1]-m)/d;break;case 90:g=t+(o[0]-p)/h,y=s-(o[1]-m)/d,[l,u]=[u,-l];break;case 180:g=t-this.width+(o[0]-p)/h,y=s-(o[1]-m)/d,[l,u]=[-l,-u];break;case 270:g=t+(o[0]-p-this.height*d)/h,y=s+(o[1]-m-this.width*h)/d,[l,u]=[-u,l];break}this.setAt(g*r,y*a,l,u)}else this.setAt(t*r,s*a,this.width*r,this.height*a);_(this,tt,Mf).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var g,y,S;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=_(g=ke,Bi,Jy).call(g,s.getData("text")||"").replaceAll(Kd,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:u}=o,h=[],d=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(d.push(l.nodeValue.slice(u).replaceAll(Kd,"")),v!==this.editorDiv){let x=h;for(const b of this.editorDiv.childNodes){if(b===v){x=d;continue}x.push(_(y=ke,Bi,Rf).call(y,b))}}h.push(l.nodeValue.slice(0,u).replaceAll(Kd,""))}else if(l===this.editorDiv){let v=h,x=0;for(const b of this.editorDiv.childNodes)x++===u&&(v=d),v.push(_(S=ke,Bi,Rf).call(S,b))}w(this,xn,`${h.join(`
`)}${r}${d.join(`
`)}`),_(this,tt,Mf).call(this);const p=new Range;let m=h.reduce((v,x)=>v+x.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const x=v.nodeValue.length;if(m<=x){p.setStart(v,m),p.setEnd(v,m);break}m-=x}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var o;let r=null;if(t instanceof jA){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:d,id:p,popupRef:m},textContent:g,textPosition:y,parent:{page:{pageNumber:S}}}=t;if(!g||g.length===0)return null;r=t={annotationType:ie.FREETEXT,color:Array.from(u),fontSize:l,value:g.join(`
`),position:y,pageIndex:S-1,rect:h.slice(0),rotation:d,id:p,deleted:!1,popupRef:m}}const a=await super.deserialize(t,s,i);return w(a,bn,t.fontSize),w(a,fs,K.makeHexColor(...t.color)),w(a,xn,_(o=ke,Bi,Jy).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=ke._internalPadding*this.parentScale,i=this.getRect(s,s),r=Be._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:c(this,fs)),a={annotationType:ie.FREETEXT,color:r,fontSize:c(this,bn),value:_(this,tt,HA).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!_(this,tt,$A).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${c(this,bn)}px * var(--scale-factor))`,i.color=c(this,fs),s.replaceChildren();for(const a of c(this,xn).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),s.append(o)}const r=ke._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:c(this,xn)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};fs=new WeakMap,xn=new WeakMap,td=new WeakMap,eo=new WeakMap,bn=new WeakMap,tt=new WeakSet,zA=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-c(this,bn))*this.parentScale),w(this,bn,r),_(this,tt,Tf).call(this)},i=c(this,bn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},BA=function(t){const s=r=>{w(this,fs,this.editorDiv.style.color=r)},i=c(this,fs);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},UA=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(_(i=ke,Bi,Rf).call(i,r)),s=r);return t.join(`
`)},Tf=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},Bi=new WeakSet,Rf=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Kd,"")},Mf=function(){if(this.editorDiv.replaceChildren(),!!c(this,xn))for(const t of c(this,xn).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},HA=function(){return c(this,xn).replaceAll(""," ")},Jy=function(t){return t.replaceAll(" ","")},$A=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,l)=>o!==r[l])||t.pageIndex!==a},A(ke,Bi),Q(ke,"_freeTextDefaultContent",""),Q(ke,"_internalPadding",0),Q(ke,"_defaultColor",null),Q(ke,"_defaultFontSize",10),Q(ke,"_type","freetext"),Q(ke,"_editorType",ie.FREETEXT);let Qy=ke;class V{toSVGPath(){Ce("Abstract method `toSVGPath` must be implemented.")}get box(){Ce("Abstract getter `box` must be implemented.")}serialize(e,t){Ce("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*i,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*i,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}Q(V,"PRECISION",1e-4);var Sn,ps,Kl,Ql,Ws,ce,to,no,nd,sd,Jl,Zl,Sr,id,zp,Bp,lt,cu,WA,VA,GA,XA,qA,YA;const li=class li{constructor({x:e,y:t},s,i,r,a,o=0){A(this,lt);A(this,Sn);A(this,ps,[]);A(this,Kl);A(this,Ql);A(this,Ws,[]);A(this,ce,new Float32Array(18));A(this,to);A(this,no);A(this,nd);A(this,sd);A(this,Jl);A(this,Zl);A(this,Sr,[]);w(this,Sn,s),w(this,Zl,r*i),w(this,Ql,a),c(this,ce).set([NaN,NaN,NaN,NaN,e,t],6),w(this,Kl,o),w(this,sd,c(li,id)*i),w(this,nd,c(li,Bp)*i),w(this,Jl,i),c(this,Sr).push(e,t)}isEmpty(){return isNaN(c(this,ce)[8])}add({x:e,y:t}){var R;w(this,to,e),w(this,no,t);const[s,i,r,a]=c(this,Sn);let[o,l,u,h]=c(this,ce).subarray(8,12);const d=e-u,p=t-h,m=Math.hypot(d,p);if(m<c(this,nd))return!1;const g=m-c(this,sd),y=g/m,S=y*d,v=y*p;let x=o,b=l;o=u,l=h,u+=S,h+=v,(R=c(this,Sr))==null||R.push(e,t);const E=-v/g,C=S/g,P=E*c(this,Zl),N=C*c(this,Zl);return c(this,ce).set(c(this,ce).subarray(2,8),0),c(this,ce).set([u+P,h+N],4),c(this,ce).set(c(this,ce).subarray(14,18),12),c(this,ce).set([u-P,h-N],16),isNaN(c(this,ce)[6])?(c(this,Ws).length===0&&(c(this,ce).set([o+P,l+N],2),c(this,Ws).push(NaN,NaN,NaN,NaN,(o+P-s)/r,(l+N-i)/a),c(this,ce).set([o-P,l-N],14),c(this,ps).push(NaN,NaN,NaN,NaN,(o-P-s)/r,(l-N-i)/a)),c(this,ce).set([x,b,o,l,u,h],6),!this.isEmpty()):(c(this,ce).set([x,b,o,l,u,h],6),Math.abs(Math.atan2(b-l,x-o)-Math.atan2(v,S))<Math.PI/2?([o,l,u,h]=c(this,ce).subarray(2,6),c(this,Ws).push(NaN,NaN,NaN,NaN,((o+u)/2-s)/r,((l+h)/2-i)/a),[o,l,x,b]=c(this,ce).subarray(14,18),c(this,ps).push(NaN,NaN,NaN,NaN,((x+o)/2-s)/r,((b+l)/2-i)/a),!0):([x,b,o,l,u,h]=c(this,ce).subarray(0,6),c(this,Ws).push(((x+5*o)/6-s)/r,((b+5*l)/6-i)/a,((5*o+u)/6-s)/r,((5*l+h)/6-i)/a,((o+u)/2-s)/r,((l+h)/2-i)/a),[u,h,o,l,x,b]=c(this,ce).subarray(12,18),c(this,ps).push(((x+5*o)/6-s)/r,((b+5*l)/6-i)/a,((5*o+u)/6-s)/r,((5*l+h)/6-i)/a,((o+u)/2-s)/r,((l+h)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,Ws),t=c(this,ps);if(isNaN(c(this,ce)[6])&&!this.isEmpty())return _(this,lt,WA).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);_(this,lt,GA).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return _(this,lt,VA).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new KA(e,t,s,i,r,a)}getOutlines(){var d;const e=c(this,Ws),t=c(this,ps),s=c(this,ce),[i,r,a,o]=c(this,Sn),l=new Float32Array((((d=c(this,Sr))==null?void 0:d.length)??0)+2);for(let p=0,m=l.length-2;p<m;p+=2)l[p]=(c(this,Sr)[p]-i)/a,l[p+1]=(c(this,Sr)[p+1]-r)/o;if(l[l.length-2]=(c(this,to)-i)/a,l[l.length-1]=(c(this,no)-r)/o,isNaN(s[6])&&!this.isEmpty())return _(this,lt,XA).call(this,l);const u=new Float32Array(c(this,Ws).length+24+c(this,ps).length);let h=e.length;for(let p=0;p<h;p+=2){if(isNaN(e[p])){u[p]=u[p+1]=NaN;continue}u[p]=e[p],u[p+1]=e[p+1]}h=_(this,lt,YA).call(this,u,h);for(let p=t.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(t[p+m])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[p+m],u[h+1]=t[p+m+1],h+=2}return _(this,lt,qA).call(this,u,h),this.newFreeDrawOutline(u,l,c(this,Sn),c(this,Jl),c(this,Kl),c(this,Ql))}};Sn=new WeakMap,ps=new WeakMap,Kl=new WeakMap,Ql=new WeakMap,Ws=new WeakMap,ce=new WeakMap,to=new WeakMap,no=new WeakMap,nd=new WeakMap,sd=new WeakMap,Jl=new WeakMap,Zl=new WeakMap,Sr=new WeakMap,id=new WeakMap,zp=new WeakMap,Bp=new WeakMap,lt=new WeakSet,cu=function(){const e=c(this,ce).subarray(4,6),t=c(this,ce).subarray(16,18),[s,i,r,a]=c(this,Sn);return[(c(this,to)+(e[0]-t[0])/2-s)/r,(c(this,no)+(e[1]-t[1])/2-i)/a,(c(this,to)+(t[0]-e[0])/2-s)/r,(c(this,no)+(t[1]-e[1])/2-i)/a]},WA=function(){const[e,t,s,i]=c(this,Sn),[r,a,o,l]=_(this,lt,cu).call(this);return`M${(c(this,ce)[2]-e)/s} ${(c(this,ce)[3]-t)/i} L${(c(this,ce)[4]-e)/s} ${(c(this,ce)[5]-t)/i} L${r} ${a} L${o} ${l} L${(c(this,ce)[16]-e)/s} ${(c(this,ce)[17]-t)/i} L${(c(this,ce)[14]-e)/s} ${(c(this,ce)[15]-t)/i} Z`},VA=function(e){const t=c(this,ps);e.push(`L${t[4]} ${t[5]} Z`)},GA=function(e){const[t,s,i,r]=c(this,Sn),a=c(this,ce).subarray(4,6),o=c(this,ce).subarray(16,18),[l,u,h,d]=_(this,lt,cu).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${l} ${u} L${h} ${d} L${(o[0]-t)/i} ${(o[1]-s)/r}`)},XA=function(e){const t=c(this,ce),[s,i,r,a]=c(this,Sn),[o,l,u,h]=_(this,lt,cu).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(d,e,c(this,Sn),c(this,Jl),c(this,Kl),c(this,Ql))},qA=function(e,t){const s=c(this,ps);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},YA=function(e,t){const s=c(this,ce).subarray(4,6),i=c(this,ce).subarray(16,18),[r,a,o,l]=c(this,Sn),[u,h,d,p]=_(this,lt,cu).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,p,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/l],t),t+=24},A(li,id,8),A(li,zp,2),A(li,Bp,c(li,id)+c(li,zp));let xp=li;var ec,so,Ni,rd,An,ad,qe,Up,QA;class KA extends V{constructor(t,s,i,r,a,o){super();A(this,Up);A(this,ec);A(this,so,new Float32Array(4));A(this,Ni);A(this,rd);A(this,An);A(this,ad);A(this,qe);w(this,qe,t),w(this,An,s),w(this,ec,i),w(this,ad,r),w(this,Ni,a),w(this,rd,o),this.lastPoint=[NaN,NaN],_(this,Up,QA).call(this,o);const[l,u,h,d]=c(this,so);for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/h,t[p+1]=(t[p+1]-u)/d;for(let p=0,m=s.length;p<m;p+=2)s[p]=(s[p]-l)/h,s[p+1]=(s[p+1]-u)/d}toSVGPath(){const t=[`M${c(this,qe)[4]} ${c(this,qe)[5]}`];for(let s=6,i=c(this,qe).length;s<i;s+=6){if(isNaN(c(this,qe)[s])){t.push(`L${c(this,qe)[s+4]} ${c(this,qe)[s+5]}`);continue}t.push(`C${c(this,qe)[s]} ${c(this,qe)[s+1]} ${c(this,qe)[s+2]} ${c(this,qe)[s+3]} ${c(this,qe)[s+4]} ${c(this,qe)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const o=i-t,l=r-s;let u,h;switch(a){case 0:u=V._rescale(c(this,qe),t,r,o,-l),h=V._rescale(c(this,An),t,r,o,-l);break;case 90:u=V._rescaleAndSwap(c(this,qe),t,s,o,l),h=V._rescaleAndSwap(c(this,An),t,s,o,l);break;case 180:u=V._rescale(c(this,qe),i,s,-o,l),h=V._rescale(c(this,An),i,s,-o,l);break;case 270:u=V._rescaleAndSwap(c(this,qe),i,r,-o,-l),h=V._rescaleAndSwap(c(this,An),i,r,-o,-l);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return c(this,so)}newOutliner(t,s,i,r,a,o=0){return new xp(t,s,i,r,a,o)}getNewOutline(t,s){const[i,r,a,o]=c(this,so),[l,u,h,d]=c(this,ec),p=a*h,m=o*d,g=i*h+l,y=r*d+u,S=this.newOutliner({x:c(this,An)[0]*p+g,y:c(this,An)[1]*m+y},c(this,ec),c(this,ad),t,c(this,rd),s??c(this,Ni));for(let v=2;v<c(this,An).length;v+=2)S.add({x:c(this,An)[v]*p+g,y:c(this,An)[v+1]*m+y});return S.getOutlines()}}ec=new WeakMap,so=new WeakMap,Ni=new WeakMap,rd=new WeakMap,An=new WeakMap,ad=new WeakMap,qe=new WeakMap,Up=new WeakSet,QA=function(t){const s=c(this,qe);let i=s[4],r=s[5],a=i,o=r,l=i,u=r,h=i,d=r;const p=t?Math.max:Math.min;for(let g=6,y=s.length;g<y;g+=6){if(isNaN(s[g]))a=Math.min(a,s[g+4]),o=Math.min(o,s[g+5]),l=Math.max(l,s[g+4]),u=Math.max(u,s[g+5]),d<s[g+5]?(h=s[g+4],d=s[g+5]):d===s[g+5]&&(h=p(h,s[g+4]));else{const S=K.bezierBoundingBox(i,r,...s.slice(g,g+6));a=Math.min(a,S[0]),o=Math.min(o,S[1]),l=Math.max(l,S[2]),u=Math.max(u,S[3]),d<S[3]?(h=S[2],d=S[3]):d===S[3]&&(h=p(h,S[2]))}i=s[g+4],r=s[g+5]}const m=c(this,so);m[0]=a-c(this,Ni),m[1]=o-c(this,Ni),m[2]=l-a+2*c(this,Ni),m[3]=u-o+2*c(this,Ni),this.lastPoint=[h,d]};var od,ld,Ar,ms,Qt,JA,Lf,ZA,e_,ev;class Zy{constructor(e,t=0,s=0,i=!0){A(this,Qt);A(this,od);A(this,ld);A(this,Ar,[]);A(this,ms,[]);let r=1/0,a=-1/0,o=1/0,l=-1/0;const u=10**-4;for(const{x:S,y:v,width:x,height:b}of e){const E=Math.floor((S-t)/u)*u,C=Math.ceil((S+x+t)/u)*u,P=Math.floor((v-t)/u)*u,N=Math.ceil((v+b+t)/u)*u,T=[E,P,N,!0],R=[C,P,N,!1];c(this,Ar).push(T,R),r=Math.min(r,E),a=Math.max(a,C),o=Math.min(o,P),l=Math.max(l,N)}const h=a-r+2*s,d=l-o+2*s,p=r-s,m=o-s,g=c(this,Ar).at(i?-1:-2),y=[g[0],g[2]];for(const S of c(this,Ar)){const[v,x,b]=S;S[0]=(v-p)/h,S[1]=(x-m)/d,S[2]=(b-m)/d}w(this,od,new Float32Array([p,m,h,d])),w(this,ld,y)}getOutlines(){c(this,Ar).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of c(this,Ar))t[3]?(e.push(..._(this,Qt,ev).call(this,t)),_(this,Qt,ZA).call(this,t)):(_(this,Qt,e_).call(this,t),e.push(..._(this,Qt,ev).call(this,t)));return _(this,Qt,JA).call(this,e)}}od=new WeakMap,ld=new WeakMap,Ar=new WeakMap,ms=new WeakMap,Qt=new WeakSet,JA=function(e){const t=[],s=new Set;for(const a of e){const[o,l,u]=a;t.push([o,l,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],u=t[a+1][2];l.push(u),u.push(l),s.add(l),s.add(u)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,l,u,h,d]=a;s.delete(a);let p=o,m=l;for(r=[o,u],i.push(r);;){let g;if(s.has(h))g=h;else if(s.has(d))g=d;else break;s.delete(g),[o,l,u,h,d]=g,p!==o&&(r.push(p,m,o,m===l?l:u),p=o),m=m===l?u:l}r.push(p,m)}return new JP(i,c(this,od),c(this,ld))},Lf=function(e){const t=c(this,ms);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},ZA=function([,e,t]){const s=_(this,Qt,Lf).call(this,e);c(this,ms).splice(s,0,[e,t])},e_=function([,e,t]){const s=_(this,Qt,Lf).call(this,e);for(let i=s;i<c(this,ms).length;i++){const[r,a]=c(this,ms)[i];if(r!==e)break;if(r===e&&a===t){c(this,ms).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=c(this,ms)[i];if(r!==e)break;if(r===e&&a===t){c(this,ms).splice(i,1);return}}},ev=function(e){const[t,s,i]=e,r=[[t,s,i]],a=_(this,Qt,Lf).call(this,i);for(let o=0;o<a;o++){const[l,u]=c(this,ms)[o];for(let h=0,d=r.length;h<d;h++){const[,p,m]=r[h];if(!(u<=p||m<=l)){if(p>=l){if(m>u)r[h][1]=u;else{if(d===1)return[];r.splice(h,1),h--,d--}continue}r[h][2]=l,m>u&&r.push([t,u,m])}}}return r};var cd,tc;class JP extends V{constructor(t,s,i){super();A(this,cd);A(this,tc);w(this,tc,t),w(this,cd,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of c(this,tc)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const o=s[a],l=s[a+1];o===i?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const o=[],l=i-t,u=r-s;for(const h of c(this,tc)){const d=new Array(h.length);for(let p=0;p<h.length;p+=2)d[p]=t+h[p]*l,d[p+1]=r-h[p+1]*u;o.push(d)}return o}get box(){return c(this,cd)}get classNamesForOutlining(){return["highlightOutline"]}}cd=new WeakMap,tc=new WeakMap;class tv extends xp{newFreeDrawOutline(e,t,s,i,r,a){return new ZP(e,t,s,i,r,a)}}class ZP extends KA{newOutliner(e,t,s,i,r,a=0){return new tv(e,t,s,i,r,a)}}var gs,io,nc,rt,ud,sc,hd,dd,_r,ys,ic,fd,Ae,nv,sv,iv,aa,t_,Qi;const sn=class sn{constructor({editor:e=null,uiManager:t=null}){A(this,Ae);A(this,gs,null);A(this,io,null);A(this,nc);A(this,rt,null);A(this,ud,!1);A(this,sc,!1);A(this,hd,null);A(this,dd);A(this,_r,null);A(this,ys,null);A(this,ic);var s;e?(w(this,sc,!1),w(this,ic,fe.HIGHLIGHT_COLOR),w(this,hd,e)):(w(this,sc,!0),w(this,ic,fe.HIGHLIGHT_DEFAULT_COLOR)),w(this,ys,(e==null?void 0:e._uiManager)||t),w(this,dd,c(this,ys)._eventBus),w(this,nc,(e==null?void 0:e.color)||((s=c(this,ys))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),c(sn,fd)||w(sn,fd,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ue(this,"_keyboardManager",new kd([[["Escape","mac+Escape"],sn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],sn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],sn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],sn.prototype._moveToPrevious],[["Home","mac+Home"],sn.prototype._moveToBeginning],[["End","mac+End"],sn.prototype._moveToEnd]]))}renderButton(){const e=w(this,gs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=c(this,ys)._signal;e.addEventListener("click",_(this,Ae,aa).bind(this),{signal:t}),e.addEventListener("keydown",_(this,Ae,iv).bind(this),{signal:t});const s=w(this,io,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=c(this,nc),e.append(s),e}renderMainDropdown(){const e=w(this,rt,_(this,Ae,nv).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===c(this,gs)){_(this,Ae,aa).call(this,e);return}const t=e.target.getAttribute("data-color");t&&_(this,Ae,sv).call(this,t,e)}_moveToNext(e){var t,s;if(!c(this,Ae,Qi)){_(this,Ae,aa).call(this,e);return}if(e.target===c(this,gs)){(t=c(this,rt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=c(this,rt))==null?void 0:t.firstChild)||e.target===c(this,gs)){c(this,Ae,Qi)&&this._hideDropdownFromKeyboard();return}c(this,Ae,Qi)||_(this,Ae,aa).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!c(this,Ae,Qi)){_(this,Ae,aa).call(this,e);return}(t=c(this,rt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!c(this,Ae,Qi)){_(this,Ae,aa).call(this,e);return}(t=c(this,rt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=c(this,rt))==null||e.classList.add("hidden"),(t=c(this,_r))==null||t.abort(),w(this,_r,null)}_hideDropdownFromKeyboard(){var e;if(!c(this,sc)){if(!c(this,Ae,Qi)){(e=c(this,hd))==null||e.unselect();return}this.hideDropdown(),c(this,gs).focus({preventScroll:!0,focusVisible:c(this,ud)})}}updateColor(e){if(c(this,io)&&(c(this,io).style.backgroundColor=e),!c(this,rt))return;const t=c(this,ys).highlightColors.values();for(const s of c(this,rt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=c(this,gs))==null||e.remove(),w(this,gs,null),w(this,io,null),(t=c(this,rt))==null||t.remove(),w(this,rt,null)}};gs=new WeakMap,io=new WeakMap,nc=new WeakMap,rt=new WeakMap,ud=new WeakMap,sc=new WeakMap,hd=new WeakMap,dd=new WeakMap,_r=new WeakMap,ys=new WeakMap,ic=new WeakMap,fd=new WeakMap,Ae=new WeakSet,nv=function(){const e=document.createElement("div"),t=c(this,ys)._signal;e.addEventListener("contextmenu",Cs,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of c(this,ys).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",c(sn,fd)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.setAttribute("aria-selected",i===c(this,nc)),r.addEventListener("click",_(this,Ae,sv).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",_(this,Ae,iv).bind(this),{signal:t}),e},sv=function(e,t){t.stopPropagation(),c(this,dd).dispatch("switchannotationeditorparams",{source:this,type:c(this,ic),value:e})},iv=function(e){sn._keyboardManager.exec(this,e)},aa=function(e){if(c(this,Ae,Qi)){this.hideDropdown();return}if(w(this,ud,e.detail===0),c(this,_r)||(w(this,_r,new AbortController),window.addEventListener("pointerdown",_(this,Ae,t_).bind(this),{signal:c(this,ys).combinedSignal(c(this,_r))})),c(this,rt)){c(this,rt).classList.remove("hidden");return}const t=w(this,rt,_(this,Ae,nv).call(this));c(this,gs).append(t)},t_=function(e){var t;(t=c(this,rt))!=null&&t.contains(e.target)||this.hideDropdown()},Qi=function(){return c(this,rt)&&!c(this,rt).classList.contains("hidden")},A(sn,fd,null);let bp=sn;var rc,pd,Pi,ro,ac,on,md,gd,ao,Wn,_n,xt,oc,Ti,jt,lc,Vn,yd,te,rv,jf,n_,s_,i_,av,oa,Qn,Wo,r_,If,uu,a_,o_,l_,c_,u_;const ve=class ve extends Be{constructor(t){super({...t,name:"highlightEditor"});A(this,te);A(this,rc,null);A(this,pd,0);A(this,Pi);A(this,ro,null);A(this,ac,null);A(this,on,null);A(this,md,null);A(this,gd,0);A(this,ao,null);A(this,Wn,null);A(this,_n,null);A(this,xt,!1);A(this,oc,null);A(this,Ti);A(this,jt,null);A(this,lc,"");A(this,Vn);A(this,yd,"");this.color=t.color||ve._defaultColor,w(this,Vn,t.thickness||ve._defaultThickness),w(this,Ti,t.opacity||ve._defaultOpacity),w(this,Pi,t.boxes||null),w(this,yd,t.methodOfCreation||""),w(this,lc,t.text||""),this._isDraggable=!1,t.highlightId>-1?(w(this,xt,!0),_(this,te,jf).call(this,t),_(this,te,oa).call(this)):c(this,Pi)&&(w(this,rc,t.anchorNode),w(this,pd,t.anchorOffset),w(this,md,t.focusNode),w(this,gd,t.focusOffset),_(this,te,rv).call(this),_(this,te,oa).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ve.prototype;return ue(this,"_keyboardManager",new kd([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,xt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:c(this,Vn),methodOfCreation:c(this,yd)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Be.initialize(t,s),ve._defaultColor||(ve._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case fe.HIGHLIGHT_DEFAULT_COLOR:ve._defaultColor=s;break;case fe.HIGHLIGHT_THICKNESS:ve._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return c(this,oc)}updateParams(t,s){switch(t){case fe.HIGHLIGHT_COLOR:_(this,te,n_).call(this,s);break;case fe.HIGHLIGHT_THICKNESS:_(this,te,s_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[fe.HIGHLIGHT_DEFAULT_COLOR,ve._defaultColor],[fe.HIGHLIGHT_THICKNESS,ve._defaultThickness]]}get propertiesToUpdate(){return[[fe.HIGHLIGHT_COLOR,this.color||ve._defaultColor],[fe.HIGHLIGHT_THICKNESS,c(this,Vn)||ve._defaultThickness],[fe.HIGHLIGHT_FREE,c(this,xt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(w(this,ac,new bp({editor:this})),t.addColorPicker(c(this,ac))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(_(this,te,uu).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,_(this,te,uu).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){_(this,te,av).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,te,oa).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?_(this,te,av).call(this):t&&(_(this,te,oa).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,o;const{drawLayer:s}=this.parent;let i;c(this,xt)?(t=(t-this.rotation+360)%360,i=_(r=ve,Qn,Wo).call(r,c(this,Wn).box,t)):i=_(a=ve,Qn,Wo).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(c(this,_n),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(c(this,jt),{bbox:_(o=ve,Qn,Wo).call(o,c(this,on).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,lc)&&(t.setAttribute("aria-label",c(this,lc)),t.setAttribute("role","mark")),c(this,xt)?t.classList.add("free"):this.div.addEventListener("keydown",_(this,te,r_).bind(this),{signal:this._uiManager._signal});const s=w(this,ao,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=c(this,ro);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),yp(this,c(this,ao),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,jt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,jt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:_(this,te,If).call(this,!0);break;case 1:case 3:_(this,te,If).call(this,!1);break}}select(){var t;super.select(),c(this,jt)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,jt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),c(this,jt)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,jt),{rootClass:{selected:!1}}),c(this,xt)||_(this,te,If).call(this,!1))}get _mustFixPosition(){return!c(this,xt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,_n),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,jt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:o,y:l,width:u,height:h}=i.getBoundingClientRect(),d=new AbortController,p=t.combinedSignal(d),m=g=>{d.abort(),_(this,Qn,c_).call(this,t,g)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",Rn,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Cs,{signal:p}),i.addEventListener("pointermove",_(this,Qn,l_).bind(this,t),{signal:p}),this._freeHighlight=new tv({x:r,y:a},[o,l,u,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var y,S,v,x;let r=null;if(t instanceof DA){const{data:{quadPoints:b,rect:E,rotation:C,id:P,color:N,opacity:T,popupRef:R},parent:{page:{pageNumber:L}}}=t;r=t={annotationType:ie.HIGHLIGHT,color:Array.from(N),opacity:T,quadPoints:b,boxes:null,pageIndex:L-1,rect:E.slice(0),rotation:C,id:P,deleted:!1,popupRef:R}}else if(t instanceof R0){const{data:{inkLists:b,rect:E,rotation:C,id:P,color:N,borderStyle:{rawWidth:T},popupRef:R},parent:{page:{pageNumber:L}}}=t;r=t={annotationType:ie.HIGHLIGHT,color:Array.from(N),thickness:T,inkLists:b,boxes:null,pageIndex:L-1,rect:E.slice(0),rotation:C,id:P,deleted:!1,popupRef:R}}const{color:a,quadPoints:o,inkLists:l,opacity:u}=t,h=await super.deserialize(t,s,i);h.color=K.makeHexColor(...a),w(h,Ti,u||1),l&&w(h,Vn,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[d,p]=h.pageDimensions,[m,g]=h.pageTranslation;if(o){const b=w(h,Pi,[]);for(let E=0;E<o.length;E+=8)b.push({x:(o[E]-m)/d,y:1-(o[E+1]-g)/p,width:(o[E+2]-o[E])/d,height:(o[E+1]-o[E+5])/p});_(y=h,te,rv).call(y),_(S=h,te,oa).call(S),h.rotate(h.rotation)}else if(l){w(h,xt,!0);const b=l[0],E={x:b[0]-m,y:p-(b[1]-g)},C=new tv(E,[0,0,d,p],1,c(h,Vn)/2,!0,.001);for(let T=0,R=b.length;T<R;T+=2)E.x=b[T]-m,E.y=p-(b[T+1]-g),C.add(E);const{id:P,clipPathId:N}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);_(v=h,te,jf).call(v,{highlightOutlines:C.getOutlines(),highlightId:P,clipPathId:N}),_(x=h,te,oa).call(x)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=Be._colorManager.convert(this.color),r={annotationType:ie.HIGHLIGHT,color:i,opacity:c(this,Ti),thickness:c(this,Vn),quadPoints:_(this,te,a_).call(this),outlines:_(this,te,o_).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:_(this,te,uu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!_(this,te,u_).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};rc=new WeakMap,pd=new WeakMap,Pi=new WeakMap,ro=new WeakMap,ac=new WeakMap,on=new WeakMap,md=new WeakMap,gd=new WeakMap,ao=new WeakMap,Wn=new WeakMap,_n=new WeakMap,xt=new WeakMap,oc=new WeakMap,Ti=new WeakMap,jt=new WeakMap,lc=new WeakMap,Vn=new WeakMap,yd=new WeakMap,te=new WeakSet,rv=function(){const t=new Zy(c(this,Pi),.001);w(this,Wn,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,Wn).box;const s=new Zy(c(this,Pi),.0025,.001,this._uiManager.direction==="ltr");w(this,on,s.getOutlines());const{lastPoint:i}=c(this,on);w(this,oc,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},jf=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var d,p;if(w(this,Wn,t),w(this,on,t.getNewOutline(c(this,Vn)/2+1.5,.0025)),s>=0)w(this,_n,s),w(this,ro,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),w(this,jt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,on).box,path:{d:c(this,on).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,_n),{bbox:_(d=ve,Qn,Wo).call(d,c(this,Wn).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,jt),{bbox:_(p=ve,Qn,Wo).call(p,c(this,on).box,m),path:{d:c(this,on).toSVGPath()}})}const[a,o,l,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=u;break;case 90:{const[m,g]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*g/m,this.height=u*m/g;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[m,g]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*g/m,this.height=u*m/g;break}}const{lastPoint:h}=c(this,on);w(this,oc,[(h[0]-a)/l,(h[1]-o)/u])},n_=function(t){const s=(a,o)=>{var l,u;this.color=a,w(this,Ti,o),(l=this.parent)==null||l.drawLayer.updateProperties(c(this,_n),{root:{fill:a,"fill-opacity":o}}),(u=c(this,ac))==null||u.updateColor(a)},i=this.color,r=c(this,Ti);this.addCommands({cmd:s.bind(this,t,ve._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},s_=function(t){const s=c(this,Vn),i=r=>{w(this,Vn,r),_(this,te,i_).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:fe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},i_=function(t){if(!c(this,xt))return;_(this,te,jf).call(this,{highlightOutlines:c(this,Wn).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},av=function(){c(this,_n)===null||!this.parent||(this.parent.drawLayer.remove(c(this,_n)),w(this,_n,null),this.parent.drawLayer.remove(c(this,jt)),w(this,jt,null))},oa=function(t=this.parent){c(this,_n)===null&&({id:Ut(this,_n)._,clipPathId:Ut(this,ro)._}=t.drawLayer.draw({bbox:c(this,Wn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":c(this,Ti)},rootClass:{highlight:!0,free:c(this,xt)},path:{d:c(this,Wn).toSVGPath()}},!1,!0),w(this,jt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,xt)},bbox:c(this,on).box,path:{d:c(this,on).toSVGPath()}},c(this,xt))),c(this,ao)&&(c(this,ao).style.clipPath=c(this,ro)))},Qn=new WeakSet,Wo=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},r_=function(t){ve._keyboardManager.exec(this,t)},If=function(t){if(!c(this,rc))return;const s=window.getSelection();t?s.setPosition(c(this,rc),c(this,pd)):s.setPosition(c(this,md),c(this,gd))},uu=function(){return c(this,xt)?this.rotation:0},a_=function(){if(c(this,xt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=c(this,Pi),o=new Float32Array(a.length*8);let l=0;for(const{x:u,y:h,width:d,height:p}of a){const m=u*t+i,g=(1-h)*s+r;o[l]=o[l+4]=m,o[l+1]=o[l+3]=g,o[l+2]=o[l+6]=m+d*t,o[l+5]=o[l+7]=g-p*s,l+=8}return o},o_=function(t){return c(this,Wn).serialize(t,_(this,te,uu).call(this))},l_=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},c_=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},u_=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},A(ve,Qn),Q(ve,"_defaultColor",null),Q(ve,"_defaultOpacity",1),Q(ve,"_defaultThickness",12),Q(ve,"_type","highlight"),Q(ve,"_editorType",ie.HIGHLIGHT),Q(ve,"_freeHighlightId",-1),Q(ve,"_freeHighlight",null),Q(ve,"_freeHighlightClipId","");let Sp=ve;var oo;class eT{constructor(){A(this,oo,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){c(this,oo)[e]=t}toSVGProperties(){const e=c(this,oo);return w(this,oo,Object.create(null)),{root:e}}reset(){w(this,oo,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Ce("Not implemented")}}oo=new WeakMap;var En,cc,ft,lo,co,Er,Cr,kr,uo,me,lv,cv,uv,hu,h_,Df,du,Vo;const X=class X extends Be{constructor(t){super(t);A(this,me);A(this,En,null);A(this,cc);Q(this,"_drawId",null);w(this,cc,t.mustBeCommitted||!1),t.drawOutlines&&(_(this,me,lv).call(this,t),_(this,me,hu).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){Ce("Not implemented")}static get typesMap(){Ce("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(c(X,ft).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],o=l=>{var h;r.updateProperty(s,l);const u=c(this,En).updateProperty(s,l);u&&_(this,me,du).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,X._mergeSVGProperties(c(this,En).getPathResizingSVGProperties(_(this,me,Df).call(this)),{bbox:_(this,me,Vo).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,X._mergeSVGProperties(c(this,En).getPathResizedSVGProperties(_(this,me,Df).call(this)),{bbox:_(this,me,Vo).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:_(this,me,Vo).call(this,t,s)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,X._mergeSVGProperties(c(this,En).getPathTranslatedSVGProperties(_(this,me,Df).call(this),this.parentDimensions),{bbox:_(this,me,Vo).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,cc)&&(w(this,cc,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){_(this,me,uv).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,me,hu).call(this),_(this,me,du).call(this,c(this,En).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),_(this,me,uv).call(this)):t&&(this._uiManager.addShouldRescale(this),_(this,me,hu).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,X._mergeSVGProperties({bbox:_(this,me,Vo).call(this)},c(this,En).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&_(this,me,du).call(this,c(this,En).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,i,r,a){Ce("Not implemented")}static startDrawing(t,s,i,r){var S;const{target:a,offsetX:o,offsetY:l,pointerId:u,pointerType:h}=r;if(c(X,Cr)&&c(X,Cr)!==h)return;const{viewport:{rotation:d}}=t,{width:p,height:m}=a.getBoundingClientRect(),g=w(X,lo,new AbortController),y=t.combinedSignal(g);if(c(X,Er)||w(X,Er,u),c(X,Cr)??w(X,Cr,h),window.addEventListener("pointerup",v=>{var x;c(X,Er)===v.pointerId?this._endDraw(v):(x=c(X,kr))==null||x.delete(v.pointerId)},{signal:y}),window.addEventListener("pointercancel",v=>{var x;c(X,Er)===v.pointerId?this._currentParent.endDrawingSession():(x=c(X,kr))==null||x.delete(v.pointerId)},{signal:y}),window.addEventListener("pointerdown",v=>{c(X,Cr)===v.pointerType&&((c(X,kr)||w(X,kr,new Set)).add(v.pointerId),c(X,ft).isCancellable()&&(c(X,ft).removeLastElement(),c(X,ft).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Cs,{signal:y}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),a.addEventListener("touchmove",v=>{v.timeStamp===c(X,uo)&&Rn(v)},{signal:y}),t.toggleDrawing(),(S=s._editorUndoBar)==null||S.hide(),c(X,ft)){t.drawLayer.updateProperties(this._currentDrawId,c(X,ft).startNew(o,l,p,m,d));return}s.updateUIForDefaultProperties(this),w(X,ft,this.createDrawerInstance(o,l,p,m,d)),w(X,co,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c(X,co).toSVGProperties(),c(X,ft).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(w(X,uo,-1),!c(X,ft))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(c(X,Er)===r){if(((a=c(X,kr))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c(X,ft).add(s,i)),w(X,uo,t.timeStamp),Rn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,w(X,ft,null),w(X,co,null),w(X,Cr,null),w(X,uo,NaN)),c(X,lo)&&(c(X,lo).abort(),w(X,lo,null),w(X,Er,NaN),w(X,kr,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),t&&s.drawLayer.updateProperties(this._currentDrawId,c(X,ft).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=c(X,ft),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:fe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(fe.DRAW_STEP),!c(X,ft).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c(X,ft).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:c(X,co),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,o){Ce("Not implemented")}static async deserialize(t,s,i){var d,p;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:l}}=s.viewport,u=this.deserializeDraw(o,l,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,s,i);return h.createDrawingOptions(t),_(d=h,me,lv).call(d,{drawOutlines:u}),_(p=h,me,hu).call(p),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return c(this,En).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};En=new WeakMap,cc=new WeakMap,ft=new WeakMap,lo=new WeakMap,co=new WeakMap,Er=new WeakMap,Cr=new WeakMap,kr=new WeakMap,uo=new WeakMap,me=new WeakSet,lv=function({drawOutlines:t,drawId:s,drawingOptions:i}){w(this,En,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=_(this,me,cv).call(this,t,this.parent),_(this,me,du).call(this,t.box)},cv=function(t,s){const{id:i}=s.drawLayer.draw(X._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},uv=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},hu=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=_(this,me,cv).call(this,c(this,En),t)}},h_=function([t,s,i,r]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[s,1-t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},Df=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-s,t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},du=function(t){if([this.x,this.y,this.width,this.height]=_(this,me,h_).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},Vo=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[l,u]}=this;switch((a*4+o)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(l/u),r*(u/l),i*(l/u)];case 5:return[1-s,t,i*(l/u),r*(u/l)];case 6:return[1-t-r*(u/l),1-s,r*(u/l),i*(l/u)];case 7:return[s-i*(l/u),1-t-r*(u/l),i*(l/u),r*(u/l)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/l),s,r*(u/l),i*(l/u)];case 13:return[1-s-i*(l/u),t-r*(u/l),i*(l/u),r*(u/l)];case 14:return[1-t,1-s-i*(l/u),r*(u/l),i*(l/u)];case 15:return[s,1-t,i*(l/u),r*(u/l)];default:return[t,s,i,r]}},Q(X,"_currentDrawId",-1),Q(X,"_currentParent",null),A(X,ft,null),A(X,lo,null),A(X,co,null),A(X,Er,NaN),A(X,Cr,null),A(X,kr,null),A(X,uo,NaN),Q(X,"_INNER_MARGIN",3);let ov=X;var Vs,pt,mt,ho,uc,Wt,bt,Gn,fo,po,mo,hc,Ff;class tT{constructor(e,t,s,i,r,a){A(this,hc);A(this,Vs,new Float64Array(6));A(this,pt);A(this,mt);A(this,ho);A(this,uc);A(this,Wt);A(this,bt,"");A(this,Gn,0);A(this,fo,new Ap);A(this,po);A(this,mo);w(this,po,s),w(this,mo,i),w(this,ho,r),w(this,uc,a),[e,t]=_(this,hc,Ff).call(this,e,t);const o=w(this,pt,[NaN,NaN,NaN,NaN,e,t]);w(this,Wt,[e,t]),w(this,mt,[{line:o,points:c(this,Wt)}]),c(this,Vs).set(o,0)}updateProperty(e,t){e==="stroke-width"&&w(this,uc,t)}isEmpty(){return!c(this,mt)||c(this,mt).length===0}isCancellable(){return c(this,Wt).length<=10}add(e,t){[e,t]=_(this,hc,Ff).call(this,e,t);const[s,i,r,a]=c(this,Vs).subarray(2,6),o=e-r,l=t-a;return Math.hypot(c(this,po)*o,c(this,mo)*l)<=2?null:(c(this,Wt).push(e,t),isNaN(s)?(c(this,Vs).set([r,a,e,t],2),c(this,pt).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,Vs)[0])&&c(this,pt).splice(6,6),c(this,Vs).set([s,i,r,a,e,t],0),c(this,pt).push(...V.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(c(this,Wt).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){w(this,po,s),w(this,mo,i),w(this,ho,r),[e,t]=_(this,hc,Ff).call(this,e,t);const a=w(this,pt,[NaN,NaN,NaN,NaN,e,t]);w(this,Wt,[e,t]);const o=c(this,mt).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),c(this,mt).push({line:a,points:c(this,Wt)}),c(this,Vs).set(a,0),w(this,Gn,0),this.toSVGPath(),null}getLastElement(){return c(this,mt).at(-1)}setLastElement(e){return c(this,mt)?(c(this,mt).push(e),w(this,pt,e.line),w(this,Wt,e.points),w(this,Gn,0),{path:{d:this.toSVGPath()}}):c(this,fo).setLastElement(e)}removeLastElement(){if(!c(this,mt))return c(this,fo).removeLastElement();c(this,mt).pop(),w(this,bt,"");for(let e=0,t=c(this,mt).length;e<t;e++){const{line:s,points:i}=c(this,mt)[e];w(this,pt,s),w(this,Wt,i),w(this,Gn,0),this.toSVGPath()}return{path:{d:c(this,bt)}}}toSVGPath(){const e=V.svgRound(c(this,pt)[4]),t=V.svgRound(c(this,pt)[5]);if(c(this,Wt).length===2)return w(this,bt,`${c(this,bt)} M ${e} ${t} Z`),c(this,bt);if(c(this,Wt).length<=6){const i=c(this,bt).lastIndexOf("M");w(this,bt,`${c(this,bt).slice(0,i)} M ${e} ${t}`),w(this,Gn,6)}if(c(this,Wt).length===4){const i=V.svgRound(c(this,pt)[10]),r=V.svgRound(c(this,pt)[11]);return w(this,bt,`${c(this,bt)} L ${i} ${r}`),w(this,Gn,12),c(this,bt)}const s=[];c(this,Gn)===0&&(s.push(`M ${e} ${t}`),w(this,Gn,6));for(let i=c(this,Gn),r=c(this,pt).length;i<r;i+=6){const[a,o,l,u,h,d]=c(this,pt).slice(i,i+6).map(V.svgRound);s.push(`C${a} ${o} ${l} ${u} ${h} ${d}`)}return w(this,bt,c(this,bt)+s.join(" ")),w(this,Gn,c(this,pt).length),c(this,bt)}getOutlines(e,t,s,i){const r=c(this,mt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),c(this,fo).build(c(this,mt),e,t,s,c(this,ho),c(this,uc),i),w(this,Vs,null),w(this,pt,null),w(this,mt,null),w(this,bt,null),c(this,fo)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Vs=new WeakMap,pt=new WeakMap,mt=new WeakMap,ho=new WeakMap,uc=new WeakMap,Wt=new WeakMap,bt=new WeakMap,Gn=new WeakMap,fo=new WeakMap,po=new WeakMap,mo=new WeakMap,hc=new WeakSet,Ff=function(e,t){return V._normalizePoint(e,t,c(this,po),c(this,mo),c(this,ho))};var Vt,vd,wd,Cn,Gs,Xs,dc,fc,pc,_t,ri,d_,f_,p_;const D0=class D0 extends V{constructor(){super(...arguments);A(this,_t);A(this,Vt);A(this,vd,0);A(this,wd);A(this,Cn);A(this,Gs);A(this,Xs);A(this,dc);A(this,fc);A(this,pc)}build(t,s,i,r,a,o,l){w(this,Gs,s),w(this,Xs,i),w(this,dc,r),w(this,fc,a),w(this,pc,o),w(this,wd,l??0),w(this,Cn,t),_(this,_t,f_).call(this)}setLastElement(t){return c(this,Cn).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,Cn).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of c(this,Cn)){if(t.push(`M${V.svgRound(s[4])} ${V.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${V.svgRound(s[10])} ${V.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,o,l,u,h,d]=s.subarray(i,i+6).map(V.svgRound);t.push(`C${a} ${o} ${l} ${u} ${h} ${d}`)}}return t.join("")}serialize([t,s,i,r],a){const o=[],l=[],[u,h,d,p]=_(this,_t,d_).call(this);let m,g,y,S,v,x,b,E,C;switch(c(this,fc)){case 0:C=V._rescale,m=t,g=s+r,y=i,S=-r,v=t+u*i,x=s+(1-h-p)*r,b=t+(u+d)*i,E=s+(1-h)*r;break;case 90:C=V._rescaleAndSwap,m=t,g=s,y=i,S=r,v=t+h*i,x=s+u*r,b=t+(h+p)*i,E=s+(u+d)*r;break;case 180:C=V._rescale,m=t+i,g=s,y=-i,S=r,v=t+(1-u-d)*i,x=s+h*r,b=t+(1-u)*i,E=s+(h+p)*r;break;case 270:C=V._rescaleAndSwap,m=t+i,g=s+r,y=-i,S=-r,v=t+(1-h-p)*i,x=s+(1-u-d)*r,b=t+(1-h)*i,E=s+(1-u)*r;break}for(const{line:P,points:N}of c(this,Cn))o.push(C(P,m,g,y,S,a?new Array(P.length):null)),l.push(C(N,m,g,y,S,a?new Array(N.length):null));return{lines:o,points:l,rect:[v,x,b,E]}}static deserialize(t,s,i,r,a,{paths:{lines:o,points:l},rotation:u,thickness:h}){const d=[];let p,m,g,y,S;switch(u){case 0:S=V._rescale,p=-t/i,m=s/r+1,g=1/i,y=-1/r;break;case 90:S=V._rescaleAndSwap,p=-s/r,m=-t/i,g=1/r,y=1/i;break;case 180:S=V._rescale,p=t/i+1,m=-s/r,g=-1/i,y=1/r;break;case 270:S=V._rescaleAndSwap,p=s/r+1,m=t/i+1,g=-1/r,y=-1/i;break}if(!o){o=[];for(const x of l){const b=x.length;if(b===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(b===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const E=new Float32Array(3*(b-2));o.push(E);let[C,P,N,T]=x.subarray(0,4);E.set([NaN,NaN,NaN,NaN,C,P],0);for(let R=4;R<b;R+=2){const L=x[R],I=x[R+1];E.set(V.createBezierPoints(C,P,N,T,L,I),(R-2)*3),[C,P,N,T]=[N,T,L,I]}}}for(let x=0,b=o.length;x<b;x++)d.push({line:S(o[x].map(E=>E??NaN),p,m,g,y),points:S(l[x].map(E=>E??NaN),p,m,g,y)});const v=new D0;return v.build(d,i,r,1,u,h,a),v}get box(){return c(this,Vt)}updateProperty(t,s){return t==="stroke-width"?_(this,_t,p_).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=_(this,_t,ri).call(this);w(this,Gs,t),w(this,Xs,s),w(this,dc,i);const[o,l]=_(this,_t,ri).call(this),u=o-r,h=l-a,d=c(this,Vt);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(t){return w(this,vd,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,Vt).map(V.svgRound).join(" ")}get defaultProperties(){const[t,s]=c(this,Vt);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${V.svgRound(t)} ${V.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=c(this,Vt);let i=0,r=0,a=0,o=0,l=0,u=0;switch(c(this,vd)){case 90:r=s/t,a=-t/s,l=t;break;case 180:i=-1,o=-1,l=t,u=s;break;case 270:r=-s/t,a=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${V.svgRound(l)} ${V.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,o]=_(this,_t,ri).call(this),[l,u,h,d]=c(this,Vt);if(Math.abs(h-a)<=V.PRECISION||Math.abs(d-o)<=V.PRECISION){const S=t+i/2-(l+h/2),v=s+r/2-(u+d/2);return{path:{"transform-origin":`${V.svgRound(t)} ${V.svgRound(s)}`,transform:`${this.rotationTransform} translate(${S} ${v})`}}}const p=(i-2*a)/(h-2*a),m=(r-2*o)/(d-2*o),g=h/i,y=d/r;return{path:{"transform-origin":`${V.svgRound(l)} ${V.svgRound(u)}`,transform:`${this.rotationTransform} scale(${g} ${y}) translate(${V.svgRound(a)} ${V.svgRound(o)}) scale(${p} ${m}) translate(${V.svgRound(-a)} ${V.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,o]=_(this,_t,ri).call(this),l=c(this,Vt),[u,h,d,p]=l;if(l[0]=t,l[1]=s,l[2]=i,l[3]=r,Math.abs(d-a)<=V.PRECISION||Math.abs(p-o)<=V.PRECISION){const v=t+i/2-(u+d/2),x=s+r/2-(h+p/2);for(const{line:b,points:E}of c(this,Cn))V._translate(b,v,x,b),V._translate(E,v,x,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${V.svgRound(t)} ${V.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(i-2*a)/(d-2*a),g=(r-2*o)/(p-2*o),y=-m*(u+a)+t+a,S=-g*(h+o)+s+o;if(m!==1||g!==1||y!==0||S!==0)for(const{line:v,points:x}of c(this,Cn))V._rescale(v,y,S,m,g,v),V._rescale(x,y,S,m,g,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${V.svgRound(t)} ${V.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,o=c(this,Vt),l=t-o[0],u=s-o[1];if(c(this,Gs)===r&&c(this,Xs)===a)for(const{line:h,points:d}of c(this,Cn))V._translate(h,l,u,h),V._translate(d,l,u,d);else{const h=c(this,Gs)/r,d=c(this,Xs)/a;w(this,Gs,r),w(this,Xs,a);for(const{line:p,points:m}of c(this,Cn))V._rescale(p,l,u,h,d,p),V._rescale(m,l,u,h,d,m);o[2]*=h,o[3]*=d}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${V.svgRound(t)} ${V.svgRound(s)}`}}}get defaultSVGProperties(){const t=c(this,Vt);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${V.svgRound(t[0])} ${V.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Vt=new WeakMap,vd=new WeakMap,wd=new WeakMap,Cn=new WeakMap,Gs=new WeakMap,Xs=new WeakMap,dc=new WeakMap,fc=new WeakMap,pc=new WeakMap,_t=new WeakSet,ri=function(t=c(this,pc)){const s=c(this,wd)+t/2*c(this,dc);return c(this,fc)%180===0?[s/c(this,Gs),s/c(this,Xs)]:[s/c(this,Xs),s/c(this,Gs)]},d_=function(){const[t,s,i,r]=c(this,Vt),[a,o]=_(this,_t,ri).call(this,0);return[t+a,s+o,i-2*a,r-2*o]},f_=function(){const t=w(this,Vt,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of c(this,Cn)){if(r.length<=12){for(let l=4,u=r.length;l<u;l+=6){const[h,d]=r.subarray(l,l+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],d),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],d)}continue}let a=r[4],o=r[5];for(let l=6,u=r.length;l<u;l+=6){const[h,d,p,m,g,y]=r.subarray(l,l+6);K.bezierBoundingBox(a,o,h,d,p,m,g,y,t),a=g,o=y}}const[s,i]=_(this,_t,ri).call(this);t[0]=Math.min(1,Math.max(0,t[0]-s)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+s)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},p_=function(t){const[s,i]=_(this,_t,ri).call(this);w(this,pc,t);const[r,a]=_(this,_t,ri).call(this),[o,l]=[r-s,a-i],u=c(this,Vt);return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u};let Ap=D0;var mc;const F0=class F0 extends eT{constructor(t){super();A(this,mc);w(this,mc,t),super.updateProperties({fill:"none",stroke:Be._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??(s=this["stroke-width"]),s*=c(this,mc).realScale),super.updateSVGProperty(t,s)}clone(){const t=new F0(c(this,mc));return t.updateAll(this),t}};mc=new WeakMap;let hv=F0;var Hp,m_;const al=class al extends ov{constructor(t){super({...t,name:"inkEditor"});A(this,Hp);this._willKeepAspectRatio=!0}static initialize(t,s){Be.initialize(t,s),this._defaultDrawingOptions=new hv(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ue(this,"typesMap",new Map([[fe.INK_THICKNESS,"stroke-width"],[fe.INK_COLOR,"stroke"],[fe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new tT(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,o){return Ap.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){let r=null;if(t instanceof R0){const{data:{inkLists:o,rect:l,rotation:u,id:h,color:d,opacity:p,borderStyle:{rawWidth:m},popupRef:g},parent:{page:{pageNumber:y}}}=t;r=t={annotationType:ie.INK,color:Array.from(d),thickness:m,opacity:p,paths:{points:o},boxes:null,pageIndex:y-1,rect:l.slice(0),rotation:u,id:h,deleted:!1,popupRef:g}}const a=await super.deserialize(t,s,i);return a.annotationElementId=t.id||null,a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=al.getDefaultDrawingOptions({stroke:K.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,u={annotationType:ie.INK,color:Be._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!_(this,Hp,m_).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};Hp=new WeakSet,m_=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==s[l])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},Q(al,"_type","ink"),Q(al,"_editorType",ie.INK),Q(al,"_defaultDrawingOptions",null);let dv=al;var Oe,St,Nr,Ri,Pr,gc,qs,Ys,kn,yc,ye,fu,pu,Of,pv,zf,mv,Bf,g_;const Eu=class Eu extends Be{constructor(t){super({...t,name:"stampEditor"});A(this,ye);A(this,Oe,null);A(this,St,null);A(this,Nr,null);A(this,Ri,null);A(this,Pr,null);A(this,gc,"");A(this,qs,null);A(this,Ys,null);A(this,kn,!1);A(this,yc,!1);w(this,Ri,t.bitmapUrl),w(this,Pr,t.bitmapFile)}static initialize(t,s){Be.initialize(t,s)}static get supportedTypes(){return ue(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return ue(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(ie.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;c(this,St)&&(w(this,Oe,null),this._uiManager.imageManager.deleteId(c(this,St)),(t=c(this,qs))==null||t.remove(),w(this,qs,null),c(this,Ys)&&(clearTimeout(c(this,Ys)),w(this,Ys,null))),super.remove()}rebuild(){if(!this.parent){c(this,St)&&_(this,ye,Of).call(this);return}super.rebuild(),this.div!==null&&(c(this,St)&&c(this,qs)===null&&_(this,ye,Of).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(c(this,Nr)||c(this,Oe)||c(this,Ri)||c(this,Pr)||c(this,St))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),c(this,Oe)?_(this,ye,pv).call(this):_(this,ye,Of).call(this),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(t*i,s*r,this.width*i,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;c(this,Ys)!==null&&clearTimeout(c(this,Ys)),w(this,Ys,setTimeout(()=>{w(this,Ys,null),_(this,ye,mv).call(this)},200))}copyCanvas(t,s,i=!1){var m;t||(t=224);const{width:r,height:a}=c(this,Oe),o=new hy;let l=c(this,Oe),u=r,h=a,d=null;if(s){if(r>s||a>s){const T=Math.min(s/r,s/a);u=Math.floor(r*T),h=Math.floor(a*T)}d=document.createElement("canvas");const g=d.width=Math.ceil(u*o.sx),y=d.height=Math.ceil(h*o.sy);c(this,kn)||(l=_(this,ye,zf).call(this,g,y));const S=d.getContext("2d");S.filter=this._uiManager.hcmFilter;let v="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":(m=window.matchMedia)!=null&&m.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",x="#42414d");const b=15,E=b*o.sx,C=b*o.sy,P=new OffscreenCanvas(E*2,C*2),N=P.getContext("2d");N.fillStyle=v,N.fillRect(0,0,E*2,C*2),N.fillStyle=x,N.fillRect(0,0,E,C),N.fillRect(E,C,E,C),S.fillStyle=S.createPattern(P,"repeat"),S.fillRect(0,0,g,y),S.drawImage(l,0,0,l.width,l.height,0,0,g,y)}let p=null;if(i){let g,y;if(o.symmetric&&l.width<t&&l.height<t)g=l.width,y=l.height;else if(l=c(this,Oe),r>t||a>t){const x=Math.min(t/r,t/a);g=Math.floor(r*x),y=Math.floor(a*x),c(this,kn)||(l=_(this,ye,zf).call(this,g,y))}const v=new OffscreenCanvas(g,y).getContext("2d",{willReadFrequently:!0});v.drawImage(l,0,0,l.width,l.height,0,0,g,y),p={width:g,height:y,data:v.getImageData(0,0,g,y).data}}return{canvas:d,width:u,height:h,imageData:p}}getImageForAltText(){return c(this,qs)}static async deserialize(t,s,i){var y;let r=null;if(t instanceof FA){const{data:{rect:S,rotation:v,id:x,structParent:b,popupRef:E},container:C,parent:{page:{pageNumber:P}}}=t,N=C.querySelector("canvas"),T=i.imageManager.getFromCanvas(C.id,N);N.remove();const R=((y=await s._structTree.getAriaAttributes(`${A0}${x}`))==null?void 0:y.get("aria-label"))||"";r=t={annotationType:ie.STAMP,bitmapId:T.id,bitmap:T.bitmap,pageIndex:P-1,rect:S.slice(0),rotation:v,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:R},isSvg:!1,structParent:b,popupRef:E}}const a=await super.deserialize(t,s,i),{rect:o,bitmap:l,bitmapUrl:u,bitmapId:h,isSvg:d,accessibilityData:p}=t;h&&i.imageManager.isValidId(h)?(w(a,St,h),l&&w(a,Oe,l)):w(a,Ri,u),w(a,kn,d);const[m,g]=a.pageDimensions;return a.width=(o[2]-o[0])/m,a.height=(o[3]-o[1])/g,a.annotationElementId=t.id||null,p&&(a.altTextData=p),a._initialData=r,w(a,yc,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:ie.STAMP,bitmapId:c(this,St),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:c(this,kn),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=_(this,ye,Bf).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=_(this,ye,g_).call(this,i);if(l.isSame)return null;l.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const o=c(this,kn)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(c(this,St)))s.stamps.set(c(this,St),{area:o,serialized:i}),i.bitmap=_(this,ye,Bf).call(this,!1);else if(c(this,kn)){const l=s.stamps.get(c(this,St));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=_(this,ye,Bf).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Oe=new WeakMap,St=new WeakMap,Nr=new WeakMap,Ri=new WeakMap,Pr=new WeakMap,gc=new WeakMap,qs=new WeakMap,Ys=new WeakMap,kn=new WeakMap,yc=new WeakMap,ye=new WeakSet,fu=function(t,s=!1){if(!t){this.remove();return}w(this,Oe,t.bitmap),s||(w(this,St,t.id),w(this,kn,t.isSvg)),t.file&&w(this,gc,t.file.name),_(this,ye,pv).call(this)},pu=function(){if(w(this,Nr,null),this._uiManager.enableWaiting(!1),!!c(this,qs)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Oe)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Oe)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Of=function(){if(c(this,St)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,St)).then(i=>_(this,ye,fu).call(this,i,!0)).finally(()=>_(this,ye,pu).call(this));return}if(c(this,Ri)){const i=c(this,Ri);w(this,Ri,null),this._uiManager.enableWaiting(!0),w(this,Nr,this._uiManager.imageManager.getFromUrl(i).then(r=>_(this,ye,fu).call(this,r)).finally(()=>_(this,ye,pu).call(this)));return}if(c(this,Pr)){const i=c(this,Pr);w(this,Pr,null),this._uiManager.enableWaiting(!0),w(this,Nr,this._uiManager.imageManager.getFromFile(i).then(r=>_(this,ye,fu).call(this,r)).finally(()=>_(this,ye,pu).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Eu.supportedTypesStr;const s=this._uiManager._signal;w(this,Nr,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),_(this,ye,fu).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>_(this,ye,pu).call(this))),t.click()},pv=function(){var d;const{div:t}=this;let{width:s,height:i}=c(this,Oe);const[r,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>o*r||i>o*a){const p=Math.min(o*r/s,o*a/i);s*=p,i*=p}const[l,u]=this.parentDimensions;this.setDims(s*l/r,i*u/a),this._uiManager.enableWaiting(!1);const h=w(this,qs,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=s/r,this.height=i/a,(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),_(this,ye,mv).call(this),c(this,yc)||(this.parent.addUndoableEditor(this),w(this,yc,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,gc)&&h.setAttribute("aria-label",c(this,gc))},zf=function(t,s){const{width:i,height:r}=c(this,Oe);let a=i,o=r,l=c(this,Oe);for(;a>2*t||o>2*s;){const u=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(a,o);d.getContext("2d").drawImage(l,0,0,u,h,0,0,a,o),l=d.transferToImageBitmap()}return l},mv=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new hy,o=Math.ceil(i*t*a.sx),l=Math.ceil(r*s*a.sy),u=c(this,qs);if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const h=c(this,kn)?c(this,Oe):_(this,ye,zf).call(this,o,l),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,o,l)},Bf=function(t){if(t){if(c(this,kn)){const r=this._uiManager.imageManager.getSvgUrl(c(this,St));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=c(this,Oe),s.getContext("2d").drawImage(c(this,Oe),0,0),s.toDataURL()}if(c(this,kn)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*Yr.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*Yr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(c(this,Oe),0,0,c(this,Oe).width,c(this,Oe).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(c(this,Oe))},g_=function(t){var o;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},Q(Eu,"_type","stamp"),Q(Eu,"_editorType",ie.STAMP);let fv=Eu;var go,vc,Ks,Tr,Mi,Xn,Rr,wc,yo,vs,Li,It,ji,q,Mr,je,y_,Ms,yv,vv,Uf;const rs=class rs{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:l,viewport:u,l10n:h}){A(this,je);A(this,go);A(this,vc,!1);A(this,Ks,null);A(this,Tr,null);A(this,Mi,null);A(this,Xn,new Map);A(this,Rr,!1);A(this,wc,!1);A(this,yo,!1);A(this,vs,null);A(this,Li,null);A(this,It,null);A(this,ji,null);A(this,q);const d=[...c(rs,Mr).values()];if(!rs._initialized){rs._initialized=!0;for(const p of d)p.initialize(h,e)}e.registerEditorTypes(d),w(this,q,e),this.pageIndex=t,this.div=s,w(this,go,r),w(this,Ks,a),this.viewport=u,w(this,It,l),this.drawLayer=o,this._structTree=i,c(this,q).addLayer(this)}get isEmpty(){return c(this,Xn).size===0}get isInvisible(){return this.isEmpty&&c(this,q).getMode()===ie.NONE}updateToolbar(e){c(this,q).updateToolbar(e)}updateMode(e=c(this,q).getMode()){switch(_(this,je,Uf).call(this),e){case ie.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ie.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ie.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of c(rs,Mr).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=c(this,It))==null?void 0:t.div)}setEditingState(e){c(this,q).setEditingState(e)}addCommands(e){c(this,q).addCommands(e)}cleanUndoStack(e){c(this,q).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=c(this,Ks))==null||t.div.classList.toggle("disabled",!e)}async enable(){w(this,yo,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of c(this,Xn).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(c(this,q).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!c(this,Ks)){w(this,yo,!1);return}const t=c(this,Ks).getEditableAnnotations();for(const s of t){if(s.hide(),c(this,q).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}w(this,yo,!1)}disable(){var i;w(this,wc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of c(this,Xn).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(c(this,Ks)){const r=c(this,Ks).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(c(this,q).isDeletedAnnotationElement(o))continue;let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(c(this,q).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}_(this,je,Uf).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of c(rs,Mr).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),w(this,wc,!1)}getEditableAnnotation(e){var t;return((t=c(this,Ks))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){c(this,q).getActive()!==e&&c(this,q).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=c(this,It))!=null&&e.div&&!c(this,ji)){w(this,ji,new AbortController);const t=c(this,q).combinedSignal(c(this,ji));c(this,It).div.addEventListener("pointerdown",_(this,je,y_).bind(this),{signal:t}),c(this,It).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=c(this,It))!=null&&e.div&&c(this,ji)&&(c(this,ji).abort(),w(this,ji,null),c(this,It).div.classList.remove("highlighting"))}enableClick(){if(c(this,Tr))return;w(this,Tr,new AbortController);const e=c(this,q).combinedSignal(c(this,Tr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=c(this,Tr))==null||e.abort(),w(this,Tr,null)}attach(e){c(this,Xn).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,q).isDeletedAnnotationElement(t)&&c(this,q).removeDeletedAnnotationElement(e)}detach(e){var t;c(this,Xn).delete(e.id),(t=c(this,go))==null||t.removePointerInTextLayer(e.contentDiv),!c(this,wc)&&e.annotationElementId&&c(this,q).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,q).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,q).addDeletedAnnotationElement(e.annotationElementId),Be.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,q).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!c(this,yo)),c(this,q).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,Mi)&&(e._focusEventsAllowed=!1,w(this,Mi,setTimeout(()=>{w(this,Mi,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,q)._signal}),t.focus())},0))),e._structTreeParentId=(s=c(this,go))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return c(this,q).getId()}combinedSignal(e){return c(this,q).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=c(this,je,Ms))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){c(this,q).updateToolbar(e),c(this,q).updateMode(e);const{offsetX:s,offsetY:i}=_(this,je,vv).call(this),r=this.getNextId(),a=_(this,je,yv).call(this,{parent:this,id:r,x:s,y:i,uiManager:c(this,q),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=c(rs,Mr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,c(this,q)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=_(this,je,yv).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:c(this,q),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(_(this,je,vv).call(this),!0)}setSelected(e){c(this,q).setSelected(e)}toggleSelected(e){c(this,q).toggleSelected(e)}unselect(e){c(this,q).unselect(e)}pointerup(e){var s;const{isMac:t}=Yt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&c(this,Rr)&&(w(this,Rr,!1),!((s=c(this,je,Ms))!=null&&s.isDrawer&&c(this,je,Ms).supportMultipleDrawings))){if(!c(this,vc)){w(this,vc,!0);return}if(c(this,q).getMode()===ie.STAMP){c(this,q).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(c(this,q).getMode()===ie.HIGHLIGHT&&this.enableTextSelection(),c(this,Rr)){w(this,Rr,!1);return}const{isMac:t}=Yt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(w(this,Rr,!0),(i=c(this,je,Ms))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=c(this,q).getActive();w(this,vc,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus(),c(this,vs)){c(this,je,Ms).startDrawing(this,c(this,q),!1,e);return}c(this,q).setCurrentDrawingSession(this),w(this,vs,new AbortController);const t=c(this,q).combinedSignal(c(this,vs));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(w(this,Li,null),this.commitOrRemove())},{signal:t}),c(this,je,Ms).startDrawing(this,c(this,q),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&w(this,Li,t);return}c(this,Li)&&setTimeout(()=>{var t;(t=c(this,Li))==null||t.focus(),w(this,Li,null)},0)}endDrawingSession(e=!1){return c(this,vs)?(c(this,q).setCurrentDrawingSession(null),c(this,vs).abort(),w(this,vs,null),w(this,Li,null),c(this,je,Ms).endDrawing(e)):null}findNewParent(e,t,s){const i=c(this,q).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return c(this,vs)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,vs)&&c(this,je,Ms).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=c(this,q).getActive())==null?void 0:e.parent)===this&&(c(this,q).commitOrRemove(),c(this,q).setActiveEditor(null)),c(this,Mi)&&(clearTimeout(c(this,Mi)),w(this,Mi,null));for(const s of c(this,Xn).values())(t=c(this,go))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,c(this,Xn).clear(),c(this,q).removeLayer(this)}render({viewport:e}){this.viewport=e,No(this.div,e);for(const t of c(this,q).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,q).commitOrRemove(),_(this,je,Uf).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,No(this.div,{rotation:s}),t!==s)for(const i of c(this,Xn).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,q).viewParameters.realScale}};go=new WeakMap,vc=new WeakMap,Ks=new WeakMap,Tr=new WeakMap,Mi=new WeakMap,Xn=new WeakMap,Rr=new WeakMap,wc=new WeakMap,yo=new WeakMap,vs=new WeakMap,Li=new WeakMap,It=new WeakMap,ji=new WeakMap,q=new WeakMap,Mr=new WeakMap,je=new WeakSet,y_=function(e){c(this,q).unselectAll();const{target:t}=e;if(t===c(this,It).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,It).div.contains(t)){const{isMac:s}=Yt.platform;if(e.button!==0||e.ctrlKey&&s)return;c(this,q).showAllEditors("highlight",!0,!0),c(this,It).div.classList.add("free"),this.toggleDrawing(),Sp.startHighlighting(this,c(this,q).direction==="ltr",{target:c(this,It).div,x:e.x,y:e.y}),c(this,It).div.addEventListener("pointerup",()=>{c(this,It).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,q)._signal}),e.preventDefault()}},Ms=function(){return c(rs,Mr).get(c(this,q).getMode())},yv=function(e){const t=c(this,je,Ms);return t?new t.prototype.constructor(e):null},vv=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+i),u=(r+o)/2-e,h=(a+l)/2-t,[d,p]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:p}},Uf=function(){for(const e of c(this,Xn).values())e.isEmpty()&&e.remove()},Q(rs,"_initialized",!1),A(rs,Mr,new Map([Qy,dv,fv,Sp].map(e=>[e._editorType,e])));let gv=rs;var ws,xd,Gt,vo,$p,v_,ti,xv,w_,bv;const Rt=class Rt{constructor({pageIndex:e}){A(this,ti);A(this,ws,null);A(this,xd,0);A(this,Gt,new Map);A(this,vo,new Map);this.pageIndex=e}setParent(e){if(!c(this,ws)){w(this,ws,e);return}if(c(this,ws)!==e){if(c(this,Gt).size>0)for(const t of c(this,Gt).values())t.remove(),e.append(t);w(this,ws,e)}}static get _svgFactory(){return ue(this,"_svgFactory",new T0)}draw(e,t=!1,s=!1){const i=Ut(this,xd)._++,r=_(this,ti,xv).call(this),a=Rt._svgFactory.createElement("defs");r.append(a);const o=Rt._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,vo).set(i,o);const u=s?_(this,ti,w_).call(this,a,l):null,h=Rt._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,e),c(this,Gt).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=Ut(this,xd)._++,i=_(this,ti,xv).call(this),r=Rt._svgFactory.createElement("defs");i.append(r);const a=Rt._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const d=Rt._svgFactory.createElement("mask");r.append(d),l=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",l),d.setAttribute("maskUnits","objectBoundingBox");const p=Rt._svgFactory.createElement("rect");d.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const m=Rt._svgFactory.createElement("use");d.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=Rt._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${o}`),l&&u.setAttribute("mask",`url(#${l})`);const h=u.cloneNode();return i.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(i,e),c(this,Gt).set(s,i),s}finalizeDraw(e,t){c(this,vo).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,o=typeof e=="number"?c(this,Gt).get(e):e;if(o){if(s&&_(this,ti,bv).call(this,o,s),i&&_(l=Rt,$p,v_).call(l,o,i),r){const{classList:u}=o;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(a){const h=o.firstChild.firstChild;_(this,ti,bv).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const s=c(this,Gt).get(e);s&&(c(t,ws).append(s),c(this,Gt).delete(e),c(t,Gt).set(e,s))}remove(e){c(this,vo).delete(e),c(this,ws)!==null&&(c(this,Gt).get(e).remove(),c(this,Gt).delete(e))}destroy(){w(this,ws,null);for(const e of c(this,Gt).values())e.remove();c(this,Gt).clear(),c(this,vo).clear()}};ws=new WeakMap,xd=new WeakMap,Gt=new WeakMap,vo=new WeakMap,$p=new WeakSet,v_=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},ti=new WeakSet,xv=function(){const e=Rt._svgFactory.create(1,1,!0);return c(this,ws).append(e),e.setAttribute("aria-hidden",!0),e},w_=function(e,t){const s=Rt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Rt._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},bv=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},A(Rt,$p);let wv=Rt;globalThis.pdfjsTestingUtils={HighlightOutliner:Zy};ee.AbortException;ee.AnnotationEditorLayer;ee.AnnotationEditorParamsType;ee.AnnotationEditorType;ee.AnnotationEditorUIManager;ee.AnnotationLayer;ee.AnnotationMode;ee.ColorPicker;ee.DOMSVGFactory;ee.DrawLayer;ee.FeatureTest;var nT=ee.GlobalWorkerOptions;ee.ImageKind;ee.InvalidPDFException;ee.MissingPDFException;ee.OPS;ee.OutputScale;ee.PDFDataRangeTransport;ee.PDFDateString;ee.PDFWorker;ee.PasswordResponses;ee.PermissionFlag;ee.PixelsPerInch;ee.RenderingCancelledException;ee.TextLayer;ee.TouchManager;ee.UnexpectedResponseException;ee.Util;ee.VerbosityLevel;ee.XfaLayer;ee.build;ee.createValidAbsoluteUrl;ee.fetchData;var sT=ee.getDocument;ee.getFilenameFromUrl;ee.getPdfFilenameFromUrl;ee.getXfaPageViewport;ee.isDataScheme;ee.isPdfFile;ee.noContextMenu;ee.normalizeUnicode;ee.setLayerDimensions;ee.shadow;ee.stopEvent;ee.version;const iT="/assets/pdf.worker.min-yatZIOMy.mjs";nT.workerSrc=iT;function rT(){const{id:n}=Lk(),{user:e}=pn(),t=ea(),s=k.useRef(null),i=k.useRef(null),r=k.useRef(null),[a,o]=k.useState(null),[l,u]=k.useState(1),[h,d]=k.useState(0),[p,m]=k.useState(1.2),[g,y]=k.useState(!0),[S,v]=k.useState(""),[x,b]=k.useState(null),[E,C]=k.useState([]),[P,N]=k.useState(!1),[T,R]=k.useState(20),[L,I]=k.useState(!1);k.useEffect(()=>{ne();const M=H=>H.preventDefault();document.addEventListener("contextmenu",M);const F=H=>{H.key==="ArrowLeft"?u(O=>Math.max(1,O-1)):H.key==="ArrowRight"?u(O=>Math.min(h||1,O+1)):H.key==="-"||H.key==="_"?m(O=>Math.max(.5,O-.2)):(H.key==="+"||H.key==="=")&&m(O=>Math.min(3,O+.2))};return document.addEventListener("keydown",F),ae.logEvent("document_view","document",n),()=>{document.removeEventListener("contextmenu",M),document.removeEventListener("keydown",F),x&&ae.post(`/documents/view/${x}/end`,{pages_viewed:E})}},[n,h]),k.useEffect(()=>{a&&L&&Y()},[a,l,p,L]);const ne=async()=>{var M;try{try{const se={Authorization:`Bearer ${localStorage.getItem("access_token")}`},Bt=localStorage.getItem("desktop_session");Bt&&(se["X-Desktop-Session"]=Bt);const On=await fetch("/api/system/logo",{headers:se});if(On.ok){const en=await On.blob(),mn=URL.createObjectURL(en),ss=document.createElement("img");ss.src=mn,await new Promise((__,E_)=>{ss.onload=__,ss.onerror=E_}),r.current=ss,N(!0),console.log("Custom logo loaded successfully")}}catch(se){console.log("No custom logo found, using default text",se)}try{const se={Authorization:`Bearer ${localStorage.getItem("access_token")}`},Bt=localStorage.getItem("desktop_session");Bt&&(se["X-Desktop-Session"]=Bt);const On=await fetch("/api/system/config",{headers:se});if(On.ok){const en=await On.json(),mn=parseInt(((M=en.config)==null?void 0:M.watermark_opacity)||"20",10);R(mn),console.log("Watermark opacity loaded:",mn)}}catch(se){console.log("Failed to load opacity setting, using default",se)}I(!0);const F={Authorization:`Bearer ${localStorage.getItem("access_token")}`,"X-Device-ID":localStorage.getItem("device_id")||""},H=localStorage.getItem("desktop_session");H&&(F["X-Desktop-Session"]=H);const O=await fetch(`/api/documents/id/${n}/view`,{headers:F,credentials:"include"});if(!O.ok)throw new Error("Failed to load document");const J=O.headers.get("X-View-ID");J&&b(J);const De=await(await O.blob()).arrayBuffer(),Ee=await sT({data:De}).promise;o(Ee),d(Ee.numPages),y(!1)}catch(F){v(F instanceof Error?F.message:"Failed to load document"),y(!1)}},B=k.useRef(null),Y=async()=>{if(!a||!s.current)return;if(B.current){try{await B.current.cancel()}catch{}B.current=null}const M=await a.getPage(l),F=window.devicePixelRatio||1,H=M.getViewport({scale:p*F}),O=s.current,J=O.getContext("2d");O.height=H.height,O.width=H.width,O.style.width=`${H.width/F}px`,O.style.height=`${H.height/F}px`,J.save(),J.setTransform(1,0,0,1,0,0),J.globalCompositeOperation="source-over",J.globalAlpha=1,J.clearRect(0,0,O.width,O.height),J.restore();const ge={canvasContext:J,viewport:H},De=M.render(ge);B.current=De;try{await De.promise,B.current=null}catch(ct){if(ct.name==="RenderingCancelledException")return;console.error("Render error:",ct)}$(J,O.width,O.height,F),E.includes(l)||(C(ct=>[...ct,l]),x&&ae.post(`/documents/view/${x}/page/${l}`,{}))},$=(M,F,H,O=1)=>{const J=localStorage.getItem("client_ip")||"Local",ge=new Date,De=ge.toLocaleDateString()+" "+ge.toLocaleTimeString();M.save(),M.globalCompositeOperation="multiply",M.globalAlpha=T/100,M.textAlign="center";const ct=-35*Math.PI/180;M.rotate(ct);const Ee=450*O,se=300*O,Bt=120*O,On=50*O;for(let en=-F;en<F*2;en+=Ee)for(let mn=-H;mn<H*2;mn+=se){let ss=0;r.current?(M.drawImage(r.current,en-Bt/2,mn-On/2,Bt,On),ss=On/2+15*O):(M.fillStyle="#0066CC",M.font=`bold ${28*O}px Arial, sans-serif`,M.fillText(" SRAMS",en,mn),ss=30*O),M.fillStyle="#333333",M.font=`bold ${16*O}px Arial, sans-serif`,M.fillText((e==null?void 0:e.full_name)||"User",en,mn+ss),M.fillStyle="#666666",M.font=`${14*O}px Arial, sans-serif`,M.fillText(`IP: ${J}`,en,mn+ss+20*O),M.fillText(De,en,mn+ss+40*O),M.fillStyle="#CC0000",M.font=`bold ${12*O}px Arial, sans-serif`,M.fillText(" CONFIDENTIAL - DO NOT COPY",en,mn+ss+65*O)}M.restore()},j=M=>{M>=1&&M<=h&&u(M)},z=M=>{m(F=>Math.max(.5,Math.min(3,F+M)))};return g?f.jsxs("div",{className:"viewer-loading",children:[f.jsx("div",{className:"loading-spinner"}),f.jsx("p",{children:"Loading document..."})]}):S?f.jsxs("div",{className:"viewer-error",children:[f.jsx("p",{children:S}),f.jsx("button",{className:"btn btn-primary",onClick:()=>t("/documents"),children:"Back to Documents"})]}):f.jsxs("div",{className:"document-viewer",ref:i,children:[f.jsxs("div",{className:"viewer-toolbar glass",children:[f.jsx("button",{className:"toolbar-btn",onClick:()=>t("/documents"),children:f.jsx(S2,{size:20})}),f.jsx("div",{className:"toolbar-separator"}),f.jsxs("div",{className:"page-controls",children:[f.jsx("button",{className:"toolbar-btn",onClick:()=>j(l-1),disabled:l<=1,children:f.jsx(A2,{size:20})}),f.jsxs("span",{className:"page-indicator",children:[l," / ",h]}),f.jsx("button",{className:"toolbar-btn",onClick:()=>j(l+1),disabled:l>=h,children:f.jsx(_2,{size:20})})]}),f.jsx("div",{className:"toolbar-separator"}),f.jsxs("div",{className:"zoom-controls",children:[f.jsx("button",{className:"toolbar-btn",onClick:()=>z(-.2),children:f.jsx(F2,{size:20})}),f.jsxs("span",{className:"zoom-indicator",children:[Math.round(p*100),"%"]}),f.jsx("button",{className:"toolbar-btn",onClick:()=>z(.2),children:f.jsx(D2,{size:20})})]}),f.jsx("div",{style:{flex:1}}),f.jsx("button",{className:"toolbar-btn close-viewer-btn",onClick:()=>t("/documents"),title:"Close Viewer",children:f.jsx(ta,{size:20})})]}),f.jsx("div",{className:"canvas-container",children:f.jsx("canvas",{ref:s,className:"pdf-canvas"})}),f.jsx("div",{className:"security-overlay"})]})}function aT({onClose:n,onSuccess:e}){const[t,s]=k.useState("upload"),[i,r]=k.useState(null),[a,o]=k.useState([]),[l,u]=k.useState(0),[h,d]=k.useState(0),[p,m]=k.useState(!1),[g,y]=k.useState(""),[S,v]=k.useState(null),x=k.useRef(null),[b,E]=k.useState(""),[C,P]=k.useState(""),[N,T]=k.useState(!0),[R,L]=k.useState(!1),I=async B=>{var $;const Y=($=B.target.files)==null?void 0:$[0];if(Y){if(!Y.name.endsWith(".xlsx")&&!Y.name.endsWith(".xls")){y("Please upload an Excel file (.xlsx or .xls)");return}r(Y),y(""),m(!0);try{const j=new FormData;j.append("file",Y);const z=await ae.uploadFormData("/users/bulk/preview",j);o(z.data.rows||[]),u(z.data.valid),d(z.data.invalid),s("preview")}catch(j){y(j instanceof Error?j.message:"Failed to parse file")}finally{m(!1)}}},ne=async()=>{if(b!==C){y("Passwords do not match");return}if(b.length<8){y("Password must be at least 8 characters");return}m(!0),y("");try{const B=new FormData;B.append("file",i),B.append("default_password",b),B.append("force_password_change",N.toString()),B.append("force_mfa_enrollment",R.toString()),B.append("skip_duplicates","true");const Y=await ae.uploadFormData("/users/bulk/import",B);v(Y.data),s("result")}catch(B){y(B instanceof Error?B.message:"Failed to import users")}finally{m(!1)}};return f.jsx("div",{className:"modal-overlay",onClick:n,children:f.jsxs("div",{className:"modal import-modal glass-card",onClick:B=>B.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsxs("h2",{children:[f.jsx(cm,{size:20}),"Import Users"]}),f.jsx("button",{className:"close-btn",onClick:n,children:f.jsx(ta,{size:24})})]}),f.jsxs("div",{className:"modal-body",children:[g&&f.jsxs("div",{className:"error-message",children:[f.jsx(Nc,{size:16})," ",g]}),t==="upload"&&f.jsxs("div",{className:"upload-step",children:[f.jsxs("div",{className:"upload-zone",onClick:()=>{var B;return(B=x.current)==null?void 0:B.click()},children:[f.jsx(oS,{size:48}),f.jsx("h3",{children:"Drop Excel file here or click to browse"}),f.jsx("p",{children:"Supported formats: .xlsx, .xls"}),f.jsx("input",{ref:x,type:"file",accept:".xlsx,.xls",onChange:I,style:{display:"none"}})]}),f.jsxs("div",{className:"upload-tips",children:[f.jsx("h4",{children:"Required Columns:"}),f.jsxs("ul",{children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Email"})," - Valid email address (required)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Full Name"})," - User's display name (required)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Mobile"})," - Phone number (optional)"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"Role"})," - Must be 'user' or 'admin' (required)"]})]})]})]}),t==="preview"&&f.jsxs("div",{className:"preview-step",children:[f.jsxs("div",{className:"preview-stats",children:[f.jsxs("div",{className:"stat valid",children:[f.jsx(sy,{size:20}),f.jsxs("span",{children:[l," Valid"]})]}),f.jsxs("div",{className:"stat invalid",children:[f.jsx(Nc,{size:20}),f.jsxs("span",{children:[h," Invalid"]})]})]}),f.jsxs("div",{className:"preview-table-container",children:[f.jsxs("table",{className:"preview-table",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Row"}),f.jsx("th",{children:"Email"}),f.jsx("th",{children:"Full Name"}),f.jsx("th",{children:"Mobile"}),f.jsx("th",{children:"Role"}),f.jsx("th",{children:"Status"})]})}),f.jsx("tbody",{children:a.slice(0,10).map((B,Y)=>f.jsxs("tr",{className:B.error?"invalid-row":"",children:[f.jsx("td",{children:B.row}),f.jsx("td",{children:B.email}),f.jsx("td",{children:B.full_name}),f.jsx("td",{children:B.mobile||"-"}),f.jsx("td",{children:B.role}),f.jsx("td",{children:B.error?f.jsx("span",{className:"badge badge-error",children:B.error}):f.jsx("span",{className:"badge badge-success",children:"Valid"})})]},Y))})]}),a.length>10&&f.jsxs("p",{className:"preview-note",children:["Showing 10 of ",a.length," rows"]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{className:"btn btn-secondary",onClick:()=>s("upload"),children:"Back"}),f.jsxs("button",{className:"btn btn-primary",onClick:()=>s("configure"),disabled:l===0,children:["Continue (",l," users)"]})]})]}),t==="configure"&&f.jsxs("div",{className:"configure-step",children:[f.jsx("h3",{children:"Set Password for Imported Users"}),f.jsxs("p",{className:"configure-description",children:["All ",l," users will be created with this password."]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Common Password"}),f.jsx("input",{type:"password",className:"input",value:b,onChange:B=>E(B.target.value),placeholder:"Enter password for all users",minLength:8,required:!0})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Confirm Password"}),f.jsx("input",{type:"password",className:"input",value:C,onChange:B=>P(B.target.value),placeholder:"Confirm password",required:!0})]}),f.jsxs("div",{className:"options-section",children:[f.jsx("h4",{children:"First Login Options"}),f.jsxs("label",{className:"checkbox-label",children:[f.jsx("input",{type:"checkbox",checked:N,onChange:B=>T(B.target.checked)}),f.jsx("span",{children:"Force password change on first login"})]}),f.jsxs("label",{className:"checkbox-label",children:[f.jsx("input",{type:"checkbox",checked:R,onChange:B=>L(B.target.checked)}),f.jsx("span",{children:"Require MFA enrollment (Google Authenticator)"})]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{className:"btn btn-secondary",onClick:()=>s("preview"),children:"Back"}),f.jsx("button",{className:"btn btn-primary",onClick:ne,disabled:p||!b||b!==C,children:p?"Importing...":`Import ${l} Users`})]})]}),t==="result"&&S&&f.jsxs("div",{className:"result-step",children:[f.jsx("div",{className:"result-icon success",children:f.jsx(sy,{size:48})}),f.jsx("h3",{children:"Import Complete!"}),f.jsxs("div",{className:"result-stats",children:[f.jsxs("div",{className:"result-stat",children:[f.jsx("span",{className:"label",children:"Imported"}),f.jsx("span",{className:"value success",children:S.imported})]}),f.jsxs("div",{className:"result-stat",children:[f.jsx("span",{className:"label",children:"Skipped"}),f.jsx("span",{className:"value warning",children:S.skipped})]}),f.jsxs("div",{className:"result-stat",children:[f.jsx("span",{className:"label",children:"Failed"}),f.jsx("span",{className:"value error",children:S.failed})]})]}),S.errors&&S.errors.length>0&&f.jsxs("div",{className:"result-errors",children:[f.jsx("h4",{children:"Errors:"}),f.jsx("ul",{children:S.errors.slice(0,5).map((B,Y)=>f.jsxs("li",{children:["Row ",B.row,": ",B.error]},Y))})]}),f.jsx("div",{className:"modal-footer",children:f.jsx("button",{className:"btn btn-primary",onClick:e,children:"Done"})})]})]}),p&&t==="upload"&&f.jsxs("div",{className:"loading-overlay",children:[f.jsx("div",{className:"loading-spinner"}),f.jsx("p",{children:"Parsing file..."})]})]})})}function oT(){const{user:n}=pn(),[e,t]=k.useState([]),[s,i]=k.useState(!0),[r,a]=k.useState(""),[o,l]=k.useState(""),[u,h]=k.useState(!1),[d,p]=k.useState(!1),[m,g]=k.useState(null),y=(n==null?void 0:n.role)==="super_admin",S=(n==null?void 0:n.role)==="admin";k.useEffect(()=>{v()},[o]);const v=async()=>{try{const R=o?`?role=${o}`:"",L=await ae.get(`/users${R}`);t(L.data.users||[])}catch(R){console.error("Failed to load users:",R)}finally{i(!1)}},x=async R=>{if(confirm(`Are you sure you want to delete ${R.full_name}?`))try{await ae.delete(`/users/${R.id}`),v()}catch(L){alert(L instanceof Error?L.message:"Failed to delete user")}},b=async()=>{try{const R=await ae.downloadBlob("/users/bulk/export"),L=window.URL.createObjectURL(R),I=document.createElement("a");I.href=L,I.download="srams_users_export.xlsx",I.click(),window.URL.revokeObjectURL(L)}catch(R){alert(R instanceof Error?R.message:"Failed to export users")}},E=async()=>{try{const R=await ae.downloadBlob("/users/bulk/template"),L=window.URL.createObjectURL(R),I=document.createElement("a");I.href=L,I.download="srams_user_import_template.xlsx",I.click(),window.URL.revokeObjectURL(L)}catch(R){alert(R instanceof Error?R.message:"Failed to download template")}},P=e.filter(R=>!(!y&&R.role==="super_admin")).filter(R=>R.full_name.toLowerCase().includes(r.toLowerCase())||R.email.toLowerCase().includes(r.toLowerCase())),N=R=>!(R.id===(n==null?void 0:n.id)||!y&&R.role==="super_admin"),T=R=>!(R.id===(n==null?void 0:n.id)||R.role==="super_admin"||S&&!y&&R.role==="admin");return s?f.jsx("div",{className:"loading-container",children:f.jsx("div",{className:"loading-spinner"})}):f.jsxs("div",{className:"users-page animate-fadeIn",children:[f.jsxs("header",{className:"page-header",children:[f.jsxs("div",{children:[f.jsx("h1",{children:"Users"}),f.jsx("p",{children:"Manage system users and their roles"})]}),f.jsxs("div",{className:"header-actions",children:[f.jsxs("div",{className:"bulk-actions",children:[f.jsxs("button",{className:"btn btn-outline",onClick:()=>p(!0),children:[f.jsx(cm,{size:16}),"Import"]}),f.jsxs("button",{className:"btn btn-outline",onClick:b,children:[f.jsx(C2,{size:16}),"Export"]}),f.jsxs("button",{className:"btn btn-outline",onClick:E,children:[f.jsx(oS,{size:16}),"Template"]})]}),f.jsxs("button",{className:"btn btn-primary",onClick:()=>{g(null),h(!0)},children:[f.jsx(cS,{size:18}),"Add User"]})]})]}),f.jsxs("div",{className:"filters glass-card",children:[f.jsxs("div",{className:"search-input",children:[f.jsx(uS,{size:20}),f.jsx("input",{type:"text",placeholder:"Search users...",value:r,onChange:R=>a(R.target.value)})]}),f.jsxs("select",{className:"input",value:o,onChange:R=>l(R.target.value),children:[f.jsx("option",{value:"",children:"All Roles"}),f.jsx("option",{value:"user",children:"Users"}),f.jsx("option",{value:"admin",children:"Admins"}),y&&f.jsx("option",{value:"super_admin",children:"Super Admins"})]})]}),f.jsxs("div",{className:"table-container glass-card",children:[f.jsxs("table",{className:"table",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Name"}),f.jsx("th",{children:"Email"}),f.jsx("th",{children:"Role"}),f.jsx("th",{children:"Status"}),f.jsx("th",{children:"Last Login"}),f.jsx("th",{children:"Actions"})]})}),f.jsx("tbody",{children:P.map(R=>f.jsxs("tr",{children:[f.jsx("td",{children:f.jsxs("div",{className:"user-cell",children:[f.jsx("div",{className:"user-avatar",children:R.full_name.charAt(0).toUpperCase()}),f.jsx("span",{children:R.full_name})]})}),f.jsx("td",{children:R.email}),f.jsx("td",{children:f.jsx("span",{className:`badge badge-${uT(R.role)}`,children:cT(R.role)})}),f.jsx("td",{children:f.jsx("span",{className:`badge badge-${R.is_active?"success":"error"}`,children:R.is_active?"Active":"Inactive"})}),f.jsx("td",{children:R.last_login?new Date(R.last_login).toLocaleDateString():"Never"}),f.jsx("td",{children:f.jsxs("div",{className:"action-buttons",children:[N(R)&&f.jsx("button",{className:"action-btn",onClick:()=>{g(R),h(!0)},children:f.jsx(R2,{size:16})}),T(R)&&f.jsx("button",{className:"action-btn danger",onClick:()=>x(R),children:f.jsx(x0,{size:16})})]})})]},R.id))})]}),P.length===0&&f.jsxs("div",{className:"empty-state",children:[f.jsx(Co,{size:48}),f.jsx("p",{children:"No users found"})]})]}),u&&f.jsx(lT,{user:m,isSuperAdmin:y,onClose:()=>h(!1),onSuccess:()=>{h(!1),v()}}),d&&f.jsx(aT,{onClose:()=>p(!1),onSuccess:()=>{p(!1),v()}})]})}function lT({user:n,isSuperAdmin:e,onClose:t,onSuccess:s}){const[i,r]=k.useState({email:(n==null?void 0:n.email)||"",password:"",full_name:(n==null?void 0:n.full_name)||"",mobile:(n==null?void 0:n.mobile)||"",role:(n==null?void 0:n.role)||"user",is_active:(n==null?void 0:n.is_active)??!0,must_change_password:!0,must_enroll_mfa:!1}),[a,o]=k.useState(!1),[l,u]=k.useState(""),h=async d=>{d.preventDefault(),o(!0),u("");try{n?await ae.put(`/users/${n.id}`,{full_name:i.full_name,mobile:i.mobile,role:e?i.role:void 0,is_active:i.is_active}):await ae.post("/users",i),s()}catch(p){u(p instanceof Error?p.message:"Failed to save user")}finally{o(!1)}};return f.jsx("div",{className:"modal-overlay",onClick:t,children:f.jsxs("div",{className:"modal glass-card",onClick:d=>d.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{children:n?"Edit User":"Add User"}),f.jsx("button",{className:"close-btn",onClick:t,children:f.jsx(ta,{size:24})})]}),f.jsxs("form",{onSubmit:h,className:"modal-body",children:[l&&f.jsx("div",{className:"error-message",children:l}),!n&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Email"}),f.jsx("input",{type:"email",className:"input",value:i.email,onChange:d=>r({...i,email:d.target.value}),required:!0})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Password"}),f.jsx("input",{type:"password",className:"input",value:i.password,onChange:d=>r({...i,password:d.target.value}),required:!0,minLength:8})]}),f.jsx("div",{className:"input-group",children:f.jsxs("label",{className:"checkbox-label",children:[f.jsx("input",{type:"checkbox",checked:i.must_change_password,onChange:d=>r({...i,must_change_password:d.target.checked})}),f.jsx("span",{children:"Force password change on first login"})]})}),f.jsx("div",{className:"input-group",children:f.jsxs("label",{className:"checkbox-label",children:[f.jsx("input",{type:"checkbox",checked:i.must_enroll_mfa,onChange:d=>r({...i,must_enroll_mfa:d.target.checked})}),f.jsx("span",{children:"Require MFA enrollment (Google Authenticator)"})]})})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Full Name"}),f.jsx("input",{type:"text",className:"input",value:i.full_name,onChange:d=>r({...i,full_name:d.target.value}),required:!0})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Mobile"}),f.jsx("input",{type:"tel",className:"input",value:i.mobile,onChange:d=>r({...i,mobile:d.target.value})})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Role"}),f.jsxs("select",{className:"input",value:i.role,onChange:d=>r({...i,role:d.target.value}),disabled:!e||(n==null?void 0:n.role)==="super_admin",children:[f.jsx("option",{value:"user",children:"User"}),f.jsx("option",{value:"admin",children:"Admin"})]})]}),n&&f.jsx("div",{className:"input-group",children:f.jsxs("label",{className:"checkbox-label",children:[f.jsx("input",{type:"checkbox",checked:i.is_active,onChange:d=>r({...i,is_active:d.target.checked})}),f.jsx("span",{children:"Active"})]})}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{type:"button",className:"btn btn-secondary",onClick:t,children:"Cancel"}),f.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a,children:a?"Saving...":"Save"})]})]})]})})}function cT(n){return n.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function uT(n){switch(n){case"super_admin":return"error";case"admin":return"warning";default:return"info"}}function Ns(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function Ro(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}const x_=6048e5,hT=864e5;let dT={};function vm(){return dT}function Yu(n,e){var o,l,u,h;const t=vm(),s=(e==null?void 0:e.weekStartsOn)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??t.weekStartsOn??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??0,i=Ns(n),r=i.getDay(),a=(r<s?7:0)+r-s;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function _p(n){return Yu(n,{weekStartsOn:1})}function b_(n){const e=Ns(n),t=e.getFullYear(),s=Ro(n,0);s.setFullYear(t+1,0,4),s.setHours(0,0,0,0);const i=_p(s),r=Ro(n,0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);const a=_p(r);return e.getTime()>=i.getTime()?t+1:e.getTime()>=a.getTime()?t:t-1}function Ex(n){const e=Ns(n);return e.setHours(0,0,0,0),e}function Cx(n){const e=Ns(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function fT(n,e){const t=Ex(n),s=Ex(e),i=+t-Cx(t),r=+s-Cx(s);return Math.round((i-r)/hT)}function pT(n){const e=b_(n),t=Ro(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),_p(t)}function mT(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function gT(n){if(!mT(n)&&typeof n!="number")return!1;const e=Ns(n);return!isNaN(Number(e))}function yT(n){const e=Ns(n),t=Ro(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const vT={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},wT=(n,e,t)=>{let s;const i=vT[n];return typeof i=="string"?s=i:e===1?s=i.one:s=i.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function tg(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const xT={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},bT={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ST={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},AT={date:tg({formats:xT,defaultWidth:"full"}),time:tg({formats:bT,defaultWidth:"full"}),dateTime:tg({formats:ST,defaultWidth:"full"})},_T={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ET=(n,e,t,s)=>_T[n];function Xc(n){return(e,t)=>{const s=t!=null&&t.context?String(t.context):"standalone";let i;if(s==="formatting"&&n.formattingValues){const a=n.defaultFormattingWidth||n.defaultWidth,o=t!=null&&t.width?String(t.width):a;i=n.formattingValues[o]||n.formattingValues[a]}else{const a=n.defaultWidth,o=t!=null&&t.width?String(t.width):n.defaultWidth;i=n.values[o]||n.values[a]}const r=n.argumentCallback?n.argumentCallback(e):e;return i[r]}}const CT={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},kT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},NT={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},PT={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},TT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},RT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},MT=(n,e)=>{const t=Number(n),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},LT={ordinalNumber:MT,era:Xc({values:CT,defaultWidth:"wide"}),quarter:Xc({values:kT,defaultWidth:"wide",argumentCallback:n=>n-1}),month:Xc({values:NT,defaultWidth:"wide"}),day:Xc({values:PT,defaultWidth:"wide"}),dayPeriod:Xc({values:TT,defaultWidth:"wide",formattingValues:RT,defaultFormattingWidth:"wide"})};function qc(n){return(e,t={})=>{const s=t.width,i=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],r=e.match(i);if(!r)return null;const a=r[0],o=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],l=Array.isArray(o)?IT(o,d=>d.test(a)):jT(o,d=>d.test(a));let u;u=n.valueCallback?n.valueCallback(l):l,u=t.valueCallback?t.valueCallback(u):u;const h=e.slice(a.length);return{value:u,rest:h}}}function jT(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function IT(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function DT(n){return(e,t={})=>{const s=e.match(n.matchPattern);if(!s)return null;const i=s[0],r=e.match(n.parsePattern);if(!r)return null;let a=n.valueCallback?n.valueCallback(r[0]):r[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(i.length);return{value:a,rest:o}}}const FT=/^(\d+)(th|st|nd|rd)?/i,OT=/\d+/i,zT={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},BT={any:[/^b/i,/^(a|c)/i]},UT={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},HT={any:[/1/i,/2/i,/3/i,/4/i]},$T={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},WT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},VT={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},GT={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},XT={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},qT={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},YT={ordinalNumber:DT({matchPattern:FT,parsePattern:OT,valueCallback:n=>parseInt(n,10)}),era:qc({matchPatterns:zT,defaultMatchWidth:"wide",parsePatterns:BT,defaultParseWidth:"any"}),quarter:qc({matchPatterns:UT,defaultMatchWidth:"wide",parsePatterns:HT,defaultParseWidth:"any",valueCallback:n=>n+1}),month:qc({matchPatterns:$T,defaultMatchWidth:"wide",parsePatterns:WT,defaultParseWidth:"any"}),day:qc({matchPatterns:VT,defaultMatchWidth:"wide",parsePatterns:GT,defaultParseWidth:"any"}),dayPeriod:qc({matchPatterns:XT,defaultMatchWidth:"any",parsePatterns:qT,defaultParseWidth:"any"})},KT={code:"en-US",formatDistance:wT,formatLong:AT,formatRelative:ET,localize:LT,match:YT,options:{weekStartsOn:0,firstWeekContainsDate:1}};function QT(n){const e=Ns(n);return fT(e,yT(e))+1}function JT(n){const e=Ns(n),t=+_p(e)-+pT(e);return Math.round(t/x_)+1}function S_(n,e){var h,d,p,m;const t=Ns(n),s=t.getFullYear(),i=vm(),r=(e==null?void 0:e.firstWeekContainsDate)??((d=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??i.firstWeekContainsDate??((m=(p=i.locale)==null?void 0:p.options)==null?void 0:m.firstWeekContainsDate)??1,a=Ro(n,0);a.setFullYear(s+1,0,r),a.setHours(0,0,0,0);const o=Yu(a,e),l=Ro(n,0);l.setFullYear(s,0,r),l.setHours(0,0,0,0);const u=Yu(l,e);return t.getTime()>=o.getTime()?s+1:t.getTime()>=u.getTime()?s:s-1}function ZT(n,e){var o,l,u,h;const t=vm(),s=(e==null?void 0:e.firstWeekContainsDate)??((l=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,i=S_(n,e),r=Ro(n,0);return r.setFullYear(i,0,s),r.setHours(0,0,0,0),Yu(r,e)}function eR(n,e){const t=Ns(n),s=+Yu(t,e)-+ZT(t,e);return Math.round(s/x_)+1}function be(n,e){const t=n<0?"-":"",s=Math.abs(n).toString().padStart(e,"0");return t+s}const Ki={y(n,e){const t=n.getFullYear(),s=t>0?t:1-t;return be(e==="yy"?s%100:s,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):be(t+1,2)},d(n,e){return be(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return be(n.getHours()%12||12,e.length)},H(n,e){return be(n.getHours(),e.length)},m(n,e){return be(n.getMinutes(),e.length)},s(n,e){return be(n.getSeconds(),e.length)},S(n,e){const t=e.length,s=n.getMilliseconds(),i=Math.trunc(s*Math.pow(10,t-3));return be(i,e.length)}},Oo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},kx={G:function(n,e,t){const s=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const s=n.getFullYear(),i=s>0?s:1-s;return t.ordinalNumber(i,{unit:"year"})}return Ki.y(n,e)},Y:function(n,e,t,s){const i=S_(n,s),r=i>0?i:1-i;if(e==="YY"){const a=r%100;return be(a,2)}return e==="Yo"?t.ordinalNumber(r,{unit:"year"}):be(r,e.length)},R:function(n,e){const t=b_(n);return be(t,e.length)},u:function(n,e){const t=n.getFullYear();return be(t,e.length)},Q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return be(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return be(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(n,e,t){const s=n.getMonth();switch(e){case"M":case"MM":return Ki.M(n,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(n,e,t){const s=n.getMonth();switch(e){case"L":return String(s+1);case"LL":return be(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(n,e,t,s){const i=eR(n,s);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):be(i,e.length)},I:function(n,e,t){const s=JT(n);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):be(s,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Ki.d(n,e)},D:function(n,e,t){const s=QT(n);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):be(s,e.length)},E:function(n,e,t){const s=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(n,e,t,s){const i=n.getDay(),r=(i-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(r);case"ee":return be(r,2);case"eo":return t.ordinalNumber(r,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(n,e,t,s){const i=n.getDay(),r=(i-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(r);case"cc":return be(r,e.length);case"co":return t.ordinalNumber(r,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(n,e,t){const s=n.getDay(),i=s===0?7:s;switch(e){case"i":return String(i);case"ii":return be(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(n,e,t){const i=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,e,t){const s=n.getHours();let i;switch(s===12?i=Oo.noon:s===0?i=Oo.midnight:i=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,e,t){const s=n.getHours();let i;switch(s>=17?i=Oo.evening:s>=12?i=Oo.afternoon:s>=4?i=Oo.morning:i=Oo.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let s=n.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return Ki.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Ki.H(n,e)},K:function(n,e,t){const s=n.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):be(s,e.length)},k:function(n,e,t){let s=n.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):be(s,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Ki.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Ki.s(n,e)},S:function(n,e){return Ki.S(n,e)},X:function(n,e,t){const s=n.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return Px(s);case"XXXX":case"XX":return la(s);case"XXXXX":case"XXX":default:return la(s,":")}},x:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"x":return Px(s);case"xxxx":case"xx":return la(s);case"xxxxx":case"xxx":default:return la(s,":")}},O:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Nx(s,":");case"OOOO":default:return"GMT"+la(s,":")}},z:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Nx(s,":");case"zzzz":default:return"GMT"+la(s,":")}},t:function(n,e,t){const s=Math.trunc(n.getTime()/1e3);return be(s,e.length)},T:function(n,e,t){const s=n.getTime();return be(s,e.length)}};function Nx(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),i=Math.trunc(s/60),r=s%60;return r===0?t+String(i):t+String(i)+e+be(r,2)}function Px(n,e){return n%60===0?(n>0?"-":"+")+be(Math.abs(n)/60,2):la(n,e)}function la(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),i=be(Math.trunc(s/60),2),r=be(s%60,2);return t+i+e+r}const Tx=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},A_=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},tR=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],s=t[1],i=t[2];if(!i)return Tx(n,e);let r;switch(s){case"P":r=e.dateTime({width:"short"});break;case"PP":r=e.dateTime({width:"medium"});break;case"PPP":r=e.dateTime({width:"long"});break;case"PPPP":default:r=e.dateTime({width:"full"});break}return r.replace("{{date}}",Tx(s,e)).replace("{{time}}",A_(i,e))},nR={p:A_,P:tR},sR=/^D+$/,iR=/^Y+$/,rR=["D","DD","YY","YYYY"];function aR(n){return sR.test(n)}function oR(n){return iR.test(n)}function lR(n,e,t){const s=cR(n,e,t);if(console.warn(s),rR.includes(n))throw new RangeError(s)}function cR(n,e,t){const s=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const uR=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,hR=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,dR=/^'([^]*?)'?$/,fR=/''/g,pR=/[a-zA-Z]/;function mR(n,e,t){var h,d,p,m;const s=vm(),i=s.locale??KT,r=s.firstWeekContainsDate??((d=(h=s.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??1,a=s.weekStartsOn??((m=(p=s.locale)==null?void 0:p.options)==null?void 0:m.weekStartsOn)??0,o=Ns(n);if(!gT(o))throw new RangeError("Invalid time value");let l=e.match(hR).map(g=>{const y=g[0];if(y==="p"||y==="P"){const S=nR[y];return S(g,i.formatLong)}return g}).join("").match(uR).map(g=>{if(g==="''")return{isToken:!1,value:"'"};const y=g[0];if(y==="'")return{isToken:!1,value:gR(g)};if(kx[y])return{isToken:!0,value:g};if(y.match(pR))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:g}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));const u={firstWeekContainsDate:r,weekStartsOn:a,locale:i};return l.map(g=>{if(!g.isToken)return g.value;const y=g.value;(oR(y)||aR(y))&&lR(y,e,String(n));const S=kx[y[0]];return S(o,y,i.localize,u)}).join("")}function gR(n){const e=n.match(dR);return e?e[1].replace(fR,"'"):n}function yR(){const{user:n}=pn(),[e,t]=k.useState([]),[s,i]=k.useState(!0),[r,a]=k.useState(0),[o,l]=k.useState(0),[u,h]=k.useState([]),[d,p]=k.useState({action_type:"",start_date:"",end_date:""}),[m,g]=k.useState(!1),[y,S]=k.useState([]),v=(n==null?void 0:n.role)==="super_admin",x=50;k.useEffect(()=>{b(),E()},[o,d]);const b=async()=>{i(!0);try{const T=new URLSearchParams;T.append("offset",String(o*x)),T.append("limit",String(x)),d.action_type&&T.append("action_type",d.action_type),d.start_date&&T.append("start_date",d.start_date),d.end_date&&T.append("end_date",d.end_date);const R=await ae.get(`/audit?${T}`);t(R.data.logs||[]),a(R.data.total)}catch(T){console.error("Failed to load logs:",T)}finally{i(!1)}},E=async()=>{try{const T=await ae.get("/audit/types");h(T.data.action_types||[])}catch{}},C=async T=>{if(!(!y.length||!T))try{await ae.post("/audit/bulk-delete",{log_ids:y,reason:T}),S([]),g(!1),b()}catch(R){alert(R instanceof Error?R.message:"Failed to delete logs")}},P=T=>{S(R=>R.includes(T)?R.filter(L=>L!==T):[...R,T])},N=Math.ceil(r/x);return f.jsxs("div",{className:"audit-page animate-fadeIn",children:[f.jsxs("header",{className:"page-header",children:[f.jsxs("div",{children:[f.jsx("h1",{children:"Audit Logs"}),f.jsx("p",{children:"View system activity and security events"})]}),v&&y.length>0&&f.jsxs("button",{className:"btn btn-danger",onClick:()=>g(!0),children:[f.jsx(x0,{size:18}),"Delete Selected (",y.length,")"]})]}),f.jsxs("div",{className:"filters glass-card",children:[f.jsxs("div",{className:"filter-group",children:[f.jsx(k2,{size:20}),f.jsx("span",{children:"Filters:"})]}),f.jsxs("select",{className:"input",value:d.action_type,onChange:T=>p({...d,action_type:T.target.value}),children:[f.jsx("option",{value:"",children:"All Actions"}),u.map(T=>f.jsx("option",{value:T,children:Rx(T)},T))]}),f.jsx("input",{type:"date",className:"input",value:d.start_date,onChange:T=>p({...d,start_date:T.target.value}),placeholder:"Start Date"}),f.jsx("input",{type:"date",className:"input",value:d.end_date,onChange:T=>p({...d,end_date:T.target.value}),placeholder:"End Date"}),(d.action_type||d.start_date||d.end_date)&&f.jsx("button",{className:"btn btn-secondary",onClick:()=>p({action_type:"",start_date:"",end_date:""}),children:"Clear"})]}),f.jsxs("div",{className:"table-container glass-card",children:[s?f.jsx("div",{className:"loading-container",children:f.jsx("div",{className:"loading-spinner"})}):f.jsxs("table",{className:"table",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[v&&f.jsx("th",{className:"checkbox-col"}),f.jsx("th",{children:"Timestamp"}),f.jsx("th",{children:"Action"}),f.jsx("th",{children:"Actor"}),f.jsx("th",{children:"Target"}),f.jsx("th",{children:"IP Address"}),f.jsx("th",{children:"Details"})]})}),f.jsx("tbody",{children:e.map(T=>f.jsxs("tr",{className:T.deleted_at?"deleted":"",children:[v&&f.jsx("td",{className:"checkbox-col",children:!T.deleted_at&&f.jsx("input",{type:"checkbox",checked:y.includes(T.id),onChange:()=>P(T.id)})}),f.jsx("td",{className:"timestamp",children:mR(new Date(T.created_at),"MMM d, yyyy HH:mm:ss")}),f.jsx("td",{children:f.jsx("span",{className:`badge badge-${wR(T.action_type)}`,children:Rx(T.action_type)})}),f.jsx("td",{children:f.jsx("span",{className:"actor-role",children:T.actor_role||"System"})}),f.jsx("td",{children:T.target_type||"-"}),f.jsx("td",{className:"ip-cell",children:T.ip_address||"-"}),f.jsx("td",{children:Object.keys(T.metadata||{}).length>0&&f.jsxs("code",{className:"metadata",children:[JSON.stringify(T.metadata).slice(0,50),"..."]})})]},T.id))})]}),e.length===0&&!s&&f.jsxs("div",{className:"empty-state",children:[f.jsx(aS,{size:48}),f.jsx("p",{children:"No audit logs found"})]}),N>1&&f.jsxs("div",{className:"pagination",children:[f.jsx("button",{className:"btn btn-secondary",disabled:o===0,onClick:()=>l(T=>T-1),children:"Previous"}),f.jsxs("span",{children:["Page ",o+1," of ",N]}),f.jsx("button",{className:"btn btn-secondary",disabled:o>=N-1,onClick:()=>l(T=>T+1),children:"Next"})]})]}),m&&f.jsx(vR,{count:y.length,onClose:()=>g(!1),onConfirm:C})]})}function vR({count:n,onClose:e,onConfirm:t}){const[s,i]=k.useState("");return f.jsx("div",{className:"modal-overlay",onClick:e,children:f.jsxs("div",{className:"modal glass-card",onClick:r=>r.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{children:"Delete Audit Logs"}),f.jsx("button",{className:"close-btn",onClick:e,children:f.jsx(ta,{size:24})})]}),f.jsxs("div",{className:"modal-body",children:[f.jsxs("p",{className:"warning-text",children:["You are about to delete ",n," audit log(s). This action is logged and cannot be undone."]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Deletion Reason (required)"}),f.jsx("textarea",{className:"input",value:s,onChange:r=>i(r.target.value),placeholder:"Explain why these logs are being deleted...",rows:3,required:!0})]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),f.jsx("button",{className:"btn btn-danger",onClick:()=>t(s),disabled:!s.trim(),children:"Delete Logs"})]})]})})}function Rx(n){return n.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function wR(n){return n.includes("login")||n.includes("logout")?"info":n.includes("failed")||n.includes("delete")?"error":n.includes("create")||n.includes("approve")?"success":"warning"}function xR(){const{user:n,refreshUser:e}=pn(),{theme:t,toggleTheme:s}=sS(),i=(n==null?void 0:n.role)==="super_admin";return f.jsxs("div",{className:"settings-page animate-fadeIn",children:[f.jsxs("header",{className:"page-header",children:[f.jsx("h1",{children:"Settings"}),f.jsx("p",{children:"Manage your account and preferences"})]}),f.jsxs("div",{className:"settings-grid",children:[f.jsx(bR,{user:n,onUpdate:e}),f.jsx(SR,{user:n,onUpdate:e}),f.jsxs("section",{className:"settings-section glass-card",children:[f.jsxs("div",{className:"section-header",children:[f.jsx(pp,{size:24}),f.jsx("h2",{children:"Preferences"})]}),f.jsxs("div",{className:"preference-item",children:[f.jsxs("div",{className:"preference-info",children:[f.jsx("h3",{children:"Theme"}),f.jsx("p",{children:"Choose your preferred color scheme"})]}),f.jsxs("button",{className:"theme-toggle",onClick:s,children:[t==="dark"?f.jsx(ry,{size:20}):f.jsx(pp,{size:20}),f.jsx("span",{children:t==="dark"?"Light Mode":"Dark Mode"})]})]})]}),i&&f.jsx(_R,{}),f.jsx(AR,{})]})]})}function bR({user:n,onUpdate:e}){const[t,s]=k.useState(!1),[i,r]=k.useState((n==null?void 0:n.full_name)||""),[a,o]=k.useState((n==null?void 0:n.mobile)||""),[l,u]=k.useState(!1),h=async()=>{u(!0);try{await ae.put(`/users/${n.id}`,{full_name:i,mobile:a}),await e(),s(!1)}catch{alert("Failed to update profile")}finally{u(!1)}};return f.jsxs("section",{className:"settings-section glass-card",children:[f.jsxs("div",{className:"section-header",children:[f.jsx(j2,{size:24}),f.jsx("h2",{children:"Profile"})]}),f.jsxs("div",{className:"profile-content",children:[f.jsx("div",{className:"profile-avatar",children:((n==null?void 0:n.full_name)||"").charAt(0).toUpperCase()}),t?f.jsxs("div",{className:"profile-form",children:[f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Full Name"}),f.jsx("input",{type:"text",className:"input",value:i,onChange:d=>r(d.target.value)})]}),f.jsxs("div",{className:"input-group",children:[f.jsx("label",{className:"input-label",children:"Mobile"}),f.jsx("input",{type:"tel",className:"input",value:a,onChange:d=>o(d.target.value)})]}),f.jsxs("div",{className:"button-group",children:[f.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),f.jsx("button",{className:"btn btn-primary",onClick:h,disabled:l,children:l?"Saving...":"Save"})]})]}):f.jsxs("div",{className:"profile-info",children:[f.jsxs("div",{className:"info-row",children:[f.jsx("span",{className:"label",children:"Name"}),f.jsx("span",{className:"value",children:n==null?void 0:n.full_name})]}),f.jsxs("div",{className:"info-row",children:[f.jsx("span",{className:"label",children:"Email"}),f.jsx("span",{className:"value",children:n==null?void 0:n.email})]}),f.jsxs("div",{className:"info-row",children:[f.jsx("span",{className:"label",children:"Mobile"}),f.jsx("span",{className:"value",children:(n==null?void 0:n.mobile)||"Not set"})]}),f.jsxs("div",{className:"info-row",children:[f.jsx("span",{className:"label",children:"Role"}),f.jsx("span",{className:"value badge badge-info",children:n==null?void 0:n.role})]}),f.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!0),children:"Edit Profile"})]})]})]})}function SR({user:n,onUpdate:e}){const[t,s]=k.useState(!1),[i,r]=k.useState(""),[a,o]=k.useState(""),[l,u]=k.useState(!1),[h,d]=k.useState(!1),[p,m]=k.useState(""),[g,y]=k.useState(""),[S,v]=k.useState(""),x=async()=>{u(!0);try{await ae.post("/auth/change-password",{current_password:i,new_password:a}),alert("Password changed successfully"),s(!1),r(""),o("")}catch(P){alert(P instanceof Error?P.message:"Failed to change password")}finally{u(!1)}},b=async()=>{try{const P=await ae.get("/auth/totp/setup");m(P.data.secret),y(P.data.qr_url),d(!0)}catch{alert("Failed to setup 2FA")}},E=async()=>{try{await ae.post("/auth/totp/enable",{secret:p,code:S}),await e(),d(!1),v(""),y(""),alert("2FA enabled successfully")}catch{alert("Invalid code")}},C=async()=>{if(confirm("Are you sure you want to disable 2FA?"))try{await ae.post("/auth/totp/disable",{}),await e()}catch{alert("Failed to disable 2FA")}};return f.jsxs("section",{className:"settings-section glass-card",children:[f.jsxs("div",{className:"section-header",children:[f.jsx(Vu,{size:24}),f.jsx("h2",{children:"Security"})]}),f.jsxs("div",{className:"security-item",children:[f.jsxs("div",{className:"security-info",children:[f.jsx(w0,{size:20}),f.jsxs("div",{children:[f.jsx("h3",{children:"Password"}),f.jsx("p",{children:"Change your account password"})]})]}),t?f.jsxs("div",{className:"password-form",children:[f.jsx("div",{className:"input-group",children:f.jsx("input",{type:"password",className:"input",placeholder:"Current password",value:i,onChange:P=>r(P.target.value)})}),f.jsx("div",{className:"input-group",children:f.jsx("input",{type:"password",className:"input",placeholder:"New password (min 8 characters)",value:a,onChange:P=>o(P.target.value),minLength:8})}),f.jsxs("div",{className:"button-group",children:[f.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),f.jsx("button",{className:"btn btn-primary",onClick:x,disabled:l||a.length<8,children:l?"Changing...":"Change Password"})]})]}):f.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!0),children:"Change"})]}),f.jsxs("div",{className:"security-item",children:[f.jsxs("div",{className:"security-info",children:[f.jsx(L2,{size:20}),f.jsxs("div",{children:[f.jsx("h3",{children:"Two-Factor Authentication"}),f.jsx("p",{children:n!=null&&n.totp_enabled?"Enabled":"Add extra security to your account"})]})]}),h?f.jsxs("div",{className:"totp-form",children:[f.jsx("div",{className:"totp-qr",children:g&&f.jsx("div",{className:"qr-container bg-white p-4 rounded-lg mb-4 inline-block",children:f.jsx(b0,{value:g,size:192,level:"L",includeMargin:!0})})}),f.jsx("p",{className:"totp-instructions",children:"Scan the QR code with your authenticator app, or enter this secret manually:"}),f.jsx("code",{className:"totp-secret",children:p}),f.jsx("div",{className:"input-group mt-4",children:f.jsx("input",{type:"text",className:"input",placeholder:"Enter 6-digit code",value:S,onChange:P=>v(P.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6})}),f.jsxs("div",{className:"button-group",children:[f.jsx("button",{className:"btn btn-secondary",onClick:()=>d(!1),children:"Cancel"}),f.jsx("button",{className:"btn btn-primary",onClick:E,disabled:S.length!==6,children:"Enable 2FA"})]})]}):n!=null&&n.totp_enabled?f.jsx("button",{className:"btn btn-danger",onClick:C,children:"Disable"}):f.jsx("button",{className:"btn btn-secondary",onClick:b,children:"Setup"})]})]})}function AR(){const[n,e]=k.useState([]),[t,s]=k.useState(!1),i=async()=>{s(!0);try{const r=await ae.get("/auth/sessions");e(r.data.sessions||[])}catch(r){console.error("Failed to load sessions:",r)}finally{s(!1)}};return f.jsxs("section",{className:"settings-section glass-card",children:[f.jsxs("div",{className:"section-header",children:[f.jsx(lS,{size:24}),f.jsx("h2",{children:"Active Sessions"}),f.jsx("button",{className:"btn btn-secondary",onClick:i,disabled:t,children:t?"Loading...":"View Sessions"})]}),n.length>0&&f.jsx("div",{className:"sessions-list",children:n.map((r,a)=>{var o;return f.jsx("div",{className:"session-item",children:f.jsxs("div",{className:"session-info",children:[f.jsx("span",{className:"session-ip",children:r.ip_address}),f.jsxs("span",{className:"session-agent",children:[(o=r.user_agent)==null?void 0:o.slice(0,50),"..."]}),f.jsxs("span",{className:"session-time",children:["Last active: ",new Date(r.last_activity).toLocaleString()]})]})},r.id||a)})})]})}function _R(){const[n,e]=k.useState(null),[t,s]=k.useState(!0),[i,r]=k.useState(!1),[a,o]=k.useState(""),[l,u]=k.useState(""),[h,d]=k.useState(20),[p,m]=k.useState(20),[g,y]=k.useState(!1);k.useEffect(()=>{x(),S()},[]);const S=async()=>{var C;try{const P=localStorage.getItem("access_token"),N=localStorage.getItem("desktop_session"),T={Authorization:`Bearer ${P}`};N&&(T["X-Desktop-Session"]=N);const R=await fetch("/api/system/config",{headers:T});if(R.ok){const L=await R.json(),I=parseInt(((C=L.config)==null?void 0:C.watermark_opacity)||"20",10);d(I),m(I)}}catch(P){console.log("Failed to load opacity setting:",P)}},v=async()=>{y(!0),o(""),u("");try{const C=localStorage.getItem("access_token"),P=localStorage.getItem("desktop_session"),N={"Content-Type":"application/json",Authorization:`Bearer ${C||""}`};P&&(N["X-Desktop-Session"]=P);const T=await fetch("/api/system/config",{method:"PUT",headers:N,body:JSON.stringify({key:"watermark_opacity",value:String(h)})});if(T.ok)m(h),u(`Watermark opacity set to ${h}%`);else{const R=await T.json();o(R.error||"Failed to save opacity")}}catch{o("Failed to save opacity setting")}finally{y(!1)}},x=async()=>{try{const C=localStorage.getItem("access_token"),P=localStorage.getItem("desktop_session"),N={Authorization:`Bearer ${C}`};P&&(N["X-Desktop-Session"]=P);const T=await fetch("/api/system/logo",{headers:N});if(T.ok){const R=await T.blob();e(URL.createObjectURL(R)),console.log("Logo loaded successfully")}else e(null),console.log("No logo found:",T.status)}catch(C){e(null),console.log("Failed to load logo:",C)}finally{s(!1)}},b=async C=>{var N;const P=(N=C.target.files)==null?void 0:N[0];if(P){if(!["image/png","image/jpeg","image/gif"].includes(P.type)){o("Only PNG, JPG, or GIF files allowed");return}if(P.size>500*1024){o("Logo file too large (max 500KB)");return}o(""),u(""),r(!0);try{const T=localStorage.getItem("access_token"),R=localStorage.getItem("desktop_session"),L=new FormData;L.append("logo",P);const I={Authorization:`Bearer ${T||""}`};R&&(I["X-Desktop-Session"]=R);const ne=await fetch("/api/system/logo",{method:"POST",headers:I,body:L});if(ne.ok)u("Logo uploaded successfully"),x();else{const B=await ne.json();o(B.error||"Failed to upload logo")}}catch{o("Failed to upload logo")}finally{r(!1)}}},E=async()=>{if(confirm("Are you sure you want to delete the company logo?")){o(""),u("");try{const C=localStorage.getItem("access_token"),P=localStorage.getItem("desktop_session"),N={Authorization:`Bearer ${C||""}`};P&&(N["X-Desktop-Session"]=P);const T=await fetch("/api/system/logo",{method:"DELETE",headers:N});if(T.ok)u("Logo deleted"),e(null);else{const R=await T.json();o(R.error||"Failed to delete logo")}}catch{o("Failed to delete logo")}}};return f.jsxs("section",{className:"settings-section glass-card",children:[f.jsxs("div",{className:"section-header",children:[f.jsx(ix,{size:24}),f.jsx("h2",{children:"Company Logo"})]}),f.jsx("p",{className:"section-description",children:"Upload a company logo to display in document watermarks. The logo will be visible on all documents viewed by users."}),a&&f.jsx("div",{className:"error-message",children:a}),l&&f.jsx("div",{className:"success-message",children:l}),f.jsx("div",{className:"logo-preview-container",children:t?f.jsx("div",{className:"loading-spinner"}):n?f.jsx("img",{src:n,alt:"Company Logo",className:"logo-preview"}):f.jsxs("div",{className:"logo-placeholder",children:[f.jsx(ix,{size:48}),f.jsx("span",{children:"No logo uploaded"})]})}),f.jsxs("div",{className:"logo-actions",children:[f.jsxs("label",{className:"btn btn-primary upload-btn",children:[f.jsx(cm,{size:16}),i?"Uploading...":"Upload Logo",f.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/gif",onChange:b,disabled:i,style:{display:"none"}})]}),n&&f.jsxs("button",{className:"btn btn-danger",onClick:E,children:[f.jsx(x0,{size:16}),"Delete Logo"]})]}),f.jsx("p",{className:"help-text",children:"Supported formats: PNG, JPG, GIF  Max size: 500KB"}),f.jsxs("div",{className:"opacity-control",children:[f.jsx("h3",{children:"Watermark Opacity"}),f.jsx("p",{className:"section-description",children:"Adjust how visible the watermark appears on documents (1% = very faint, 100% = solid)"}),f.jsxs("div",{className:"opacity-slider-container",children:[f.jsx("input",{type:"range",min:"1",max:"100",value:h,onChange:C=>d(parseInt(C.target.value,10)),className:"opacity-slider"}),f.jsxs("span",{className:"opacity-value",children:[h,"%"]})]}),f.jsxs("div",{className:"opacity-actions",children:[f.jsx("button",{className:"btn btn-primary",onClick:v,disabled:g||h===p,children:g?"Applying...":"Apply Opacity"}),h!==p&&f.jsx("span",{className:"unsaved-indicator",children:"Unsaved changes"})]})]})]})}const ng={CONFIG_UPDATE:"CONFIG_UPDATE",FORCE_LOGOUT:"FORCE_LOGOUT",SESSION_REVOKED:"SESSION_REVOKED"};function ER(n={}){const{user:e,logout:t}=pn(),s=k.useRef(null),i=k.useRef(null),r=k.useRef(0),a=5,o=k.useCallback(()=>{if(!e)return;s.current&&s.current.close();const u=localStorage.getItem("access_token");if(!u)return;const h=`/api/realtime/subscribe?token=${encodeURIComponent(u)}`,d=new EventSource(h,{withCredentials:!0});s.current=d,d.addEventListener("connected",p=>{var m;r.current=0;try{const g=JSON.parse(p.data);(m=n.onConnected)==null||m.call(n,g.client_id)}catch{}}),d.addEventListener(ng.CONFIG_UPDATE,p=>{var m;try{const g=JSON.parse(p.data);g.payload&&((m=n.onConfigUpdate)==null||m.call(n,g.payload.key,g.payload.value))}catch{console.error("Failed to parse CONFIG_UPDATE event")}}),d.addEventListener(ng.FORCE_LOGOUT,p=>{var m,g;try{const S=((m=JSON.parse(p.data).payload)==null?void 0:m.reason)||"Your session has been terminated";(g=n.onForceLogout)==null||g.call(n,S),t(),alert(S)}catch{t()}}),d.addEventListener(ng.SESSION_REVOKED,p=>{var m,g;try{const S=((m=JSON.parse(p.data).payload)==null?void 0:m.reason)||"Session revoked by administrator";(g=n.onForceLogout)==null||g.call(n,S),t(),alert(S)}catch{t()}}),d.onerror=p=>{var m;if((m=n.onError)==null||m.call(n,p),d.close(),r.current<a){const g=Math.min(1e3*Math.pow(2,r.current),3e4);r.current++,i.current=window.setTimeout(o,g)}}},[e,t,n]);return k.useEffect(()=>(o(),()=>{s.current&&s.current.close(),i.current&&window.clearTimeout(i.current)}),[o]),{reconnect:k.useCallback(()=>{r.current=0,o()},[o])}}function CR(){const{user:n,logout:e}=pn(),{theme:t,toggleTheme:s}=sS(),i=ea(),[r,a]=k.useState(!1),o=k.useCallback((m,g)=>{console.log(`[SSE] Config updated: ${m} =`,g),window.dispatchEvent(new CustomEvent("srams:config-update",{detail:{key:m,value:g}}))},[]),l=k.useCallback(m=>{console.log("[SSE] Force logout:",m)},[]);ER({onConfigUpdate:o,onForceLogout:l,onConnected:m=>console.log(`[SSE] Connected: ${m}`),onError:()=>console.warn("[SSE] Connection error, will retry...")});const u=async()=>{await e(),i("/login")},h=(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="super_admin",d=(n==null?void 0:n.role)==="super_admin",p=[{to:"/dashboard",icon:N2,label:"Dashboard"},{to:"/documents",icon:Js,label:"Documents"},...h?[{to:"/users",icon:Co,label:"Users"},{to:"/audit",icon:aS,label:"Audit Logs"}]:[],{to:"/settings",icon:M2,label:"Settings"}];return f.jsxs("div",{className:"layout",children:[f.jsxs("header",{className:"mobile-header",children:[f.jsx("button",{className:"menu-btn",onClick:()=>a(!0),children:f.jsx(T2,{size:24})}),f.jsxs("div",{className:"logo",children:[f.jsx(Vu,{size:24}),f.jsx("span",{children:"SRAMS"})]}),f.jsx("button",{className:"theme-btn",onClick:s,children:t==="twilight"?f.jsx(ry,{size:20}):f.jsx(pp,{size:20})})]}),r&&f.jsx("div",{className:"sidebar-overlay",onClick:()=>a(!1)}),f.jsxs("aside",{className:`sidebar ${r?"open":""}`,children:[f.jsxs("div",{className:"sidebar-header",children:[f.jsxs("div",{className:"logo",children:[f.jsx(Vu,{size:28}),f.jsx("span",{children:"SRAMS"})]}),f.jsx("button",{className:"close-btn",onClick:()=>a(!1),children:f.jsx(ta,{size:24})})]}),f.jsx("nav",{className:"sidebar-nav",children:p.map(m=>f.jsxs(c2,{to:m.to,className:({isActive:g})=>`nav-item ${g?"active":""}`,onClick:()=>a(!1),children:[f.jsx(m.icon,{size:20}),f.jsx("span",{children:m.label})]},m.to))}),f.jsxs("div",{className:"sidebar-footer",children:[f.jsxs("div",{className:"user-info",children:[f.jsx("div",{className:"user-avatar",children:((n==null?void 0:n.full_name)||"").charAt(0).toUpperCase()}),f.jsxs("div",{className:"user-details",children:[f.jsx("span",{className:"user-name",children:(n==null?void 0:n.full_name)||"User"}),f.jsx("span",{className:"user-role",children:d?"Super Admin":h?"Admin":"User"})]})]}),f.jsxs("div",{className:"sidebar-actions",children:[f.jsx("button",{className:"action-btn",onClick:s,title:"Toggle theme",children:t==="twilight"?f.jsx(ry,{size:18}):f.jsx(pp,{size:18})}),f.jsx("button",{className:"action-btn logout",onClick:u,title:"Logout",children:f.jsx(lS,{size:18})})]})]})]}),f.jsx("main",{className:"main-content",children:f.jsx(qk,{})})]})}function sg({children:n,roles:e}){const{user:t,loading:s}=pn();return s?f.jsx("div",{className:"flex items-center justify-center",style:{height:"100vh"},children:f.jsx("div",{className:"animate-spin",style:{width:40,height:40,border:"3px solid var(--color-border)",borderTopColor:"var(--color-accent-primary)",borderRadius:"50%"}})}):t?e&&!e.includes(t.role)?f.jsx(Zg,{to:"/dashboard",replace:!0}):f.jsx(f.Fragment,{children:n}):f.jsx(Zg,{to:"/login",replace:!0})}function kR(){return f.jsx(w2,{children:f.jsx(m2,{children:f.jsx(v2,{children:f.jsx(r2,{children:f.jsxs(Kk,{children:[f.jsx(Bn,{path:"/login",element:f.jsx(O2,{})}),f.jsx(Bn,{path:"/force-change-password",element:f.jsx(z2,{})}),f.jsx(Bn,{path:"/force-enroll-mfa",element:f.jsx(Y2,{})}),f.jsxs(Bn,{path:"/",element:f.jsx(sg,{children:f.jsx(CR,{})}),children:[f.jsx(Bn,{index:!0,element:f.jsx(Zg,{to:"/dashboard",replace:!0})}),f.jsx(Bn,{path:"dashboard",element:f.jsx(K2,{})}),f.jsx(Bn,{path:"documents",element:f.jsx(Z2,{})}),f.jsx(Bn,{path:"documents/:id",element:f.jsx(rT,{})}),f.jsx(Bn,{path:"users",element:f.jsx(sg,{roles:["admin","super_admin"],children:f.jsx(oT,{})})}),f.jsx(Bn,{path:"audit",element:f.jsx(sg,{roles:["admin","super_admin"],children:f.jsx(yR,{})})}),f.jsx(Bn,{path:"settings",element:f.jsx(xR,{})})]})]})})})})})}console.log("SRAMS Enterprise v2.0.1 - Fix Applied");ig.createRoot(document.getElementById("root")).render(f.jsx(Ye.StrictMode,{children:f.jsx(kR,{})}));
