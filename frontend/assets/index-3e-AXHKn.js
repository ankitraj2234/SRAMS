(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(i){if(i.ep)return;i.ep=!0;const n=s(i);fetch(i.href,n)}})();var iA=Object.defineProperty,b0=e=>{throw TypeError(e)},nA=(e,t,s)=>t in e?iA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,X=(e,t,s)=>nA(e,typeof t!="symbol"?t+"":t,s),Qv=(e,t,s)=>t.has(e)||b0("Cannot "+s),o=(e,t,s)=>(Qv(e,t,"read from private field"),s?s.call(e):t.get(e)),k=(e,t,s)=>t.has(e)?b0("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),m=(e,t,s,a)=>(Qv(e,t,"write to private field"),t.set(e,s),s),_=(e,t,s)=>(Qv(e,t,"access private method"),s),Je=(e,t,s,a)=>({set _(i){m(e,t,i)},get _(){return o(e,t,a)}});function rA(e,t){for(var s=0;s<t.length;s++){const a=t[s];if(typeof a!="string"&&!Array.isArray(a)){for(const i in a)if(i!=="default"&&!(i in e)){const n=Object.getOwnPropertyDescriptor(a,i);n&&Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:()=>a[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();function oA(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var y0={exports:{}},yp={},w0={exports:{}},st={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Gu=Symbol.for("react.element"),lA=Symbol.for("react.portal"),cA=Symbol.for("react.fragment"),uA=Symbol.for("react.strict_mode"),hA=Symbol.for("react.profiler"),dA=Symbol.for("react.provider"),fA=Symbol.for("react.context"),pA=Symbol.for("react.forward_ref"),gA=Symbol.for("react.suspense"),mA=Symbol.for("react.memo"),vA=Symbol.for("react.lazy"),oy=Symbol.iterator;function bA(e){return e===null||typeof e!="object"?null:(e=oy&&e[oy]||e["@@iterator"],typeof e=="function"?e:null)}var x0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k0=Object.assign,_0={};function pl(e,t,s){this.props=e,this.context=t,this.refs=_0,this.updater=s||x0}pl.prototype.isReactComponent={};pl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};pl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function A0(){}A0.prototype=pl.prototype;function Jv(e,t,s){this.props=e,this.context=t,this.refs=_0,this.updater=s||x0}var Zv=Jv.prototype=new A0;Zv.constructor=Jv;k0(Zv,pl.prototype);Zv.isPureReactComponent=!0;var ly=Array.isArray,S0=Object.prototype.hasOwnProperty,tb={current:null},E0={key:!0,ref:!0,__self:!0,__source:!0};function C0(e,t,s){var a,i={},n=null,r=null;if(t!=null)for(a in t.ref!==void 0&&(r=t.ref),t.key!==void 0&&(n=""+t.key),t)S0.call(t,a)&&!E0.hasOwnProperty(a)&&(i[a]=t[a]);var l=arguments.length-2;if(l===1)i.children=s;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps,l)i[a]===void 0&&(i[a]=l[a]);return{$$typeof:Gu,type:e,key:n,ref:r,props:i,_owner:tb.current}}function yA(e,t){return{$$typeof:Gu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function eb(e){return typeof e=="object"&&e!==null&&e.$$typeof===Gu}function wA(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var cy=/\/+/g;function qp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?wA(""+e.key):t.toString(36)}function Ch(e,t,s,a,i){var n=typeof e;(n==="undefined"||n==="boolean")&&(e=null);var r=!1;if(e===null)r=!0;else switch(n){case"string":case"number":r=!0;break;case"object":switch(e.$$typeof){case Gu:case lA:r=!0}}if(r)return r=e,i=i(r),e=a===""?"."+qp(r,0):a,ly(i)?(s="",e!=null&&(s=e.replace(cy,"$&/")+"/"),Ch(i,t,s,"",function(u){return u})):i!=null&&(eb(i)&&(i=yA(i,s+(!i.key||r&&r.key===i.key?"":(""+i.key).replace(cy,"$&/")+"/")+e)),t.push(i)),1;if(r=0,a=a===""?".":a+":",ly(e))for(var l=0;l<e.length;l++){n=e[l];var c=a+qp(n,l);r+=Ch(n,t,s,c,i)}else if(c=bA(e),typeof c=="function")for(e=c.call(e),l=0;!(n=e.next()).done;)n=n.value,c=a+qp(n,l++),r+=Ch(n,t,s,c,i);else if(n==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return r}function th(e,t,s){if(e==null)return e;var a=[],i=0;return Ch(e,a,"","",function(n){return t.call(s,n,i++)}),a}function xA(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ze={current:null},Mh={transition:null},kA={ReactCurrentDispatcher:ze,ReactCurrentBatchConfig:Mh,ReactCurrentOwner:tb};function M0(){throw Error("act(...) is not supported in production builds of React.")}st.Children={map:th,forEach:function(e,t,s){th(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return th(e,function(){t++}),t},toArray:function(e){return th(e,function(t){return t})||[]},only:function(e){if(!eb(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};st.Component=pl;st.Fragment=cA;st.Profiler=hA;st.PureComponent=Jv;st.StrictMode=uA;st.Suspense=gA;st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kA;st.act=M0;st.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=k0({},e.props),i=e.key,n=e.ref,r=e._owner;if(t!=null){if(t.ref!==void 0&&(n=t.ref,r=tb.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)S0.call(t,c)&&!E0.hasOwnProperty(c)&&(a[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)a.children=s;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];a.children=l}return{$$typeof:Gu,type:e.type,key:i,ref:n,props:a,_owner:r}};st.createContext=function(e){return e={$$typeof:fA,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:dA,_context:e},e.Consumer=e};st.createElement=C0;st.createFactory=function(e){var t=C0.bind(null,e);return t.type=e,t};st.createRef=function(){return{current:null}};st.forwardRef=function(e){return{$$typeof:pA,render:e}};st.isValidElement=eb;st.lazy=function(e){return{$$typeof:vA,_payload:{_status:-1,_result:e},_init:xA}};st.memo=function(e,t){return{$$typeof:mA,type:e,compare:t===void 0?null:t}};st.startTransition=function(e){var t=Mh.transition;Mh.transition={};try{e()}finally{Mh.transition=t}};st.unstable_act=M0;st.useCallback=function(e,t){return ze.current.useCallback(e,t)};st.useContext=function(e){return ze.current.useContext(e)};st.useDebugValue=function(){};st.useDeferredValue=function(e){return ze.current.useDeferredValue(e)};st.useEffect=function(e,t){return ze.current.useEffect(e,t)};st.useId=function(){return ze.current.useId()};st.useImperativeHandle=function(e,t,s){return ze.current.useImperativeHandle(e,t,s)};st.useInsertionEffect=function(e,t){return ze.current.useInsertionEffect(e,t)};st.useLayoutEffect=function(e,t){return ze.current.useLayoutEffect(e,t)};st.useMemo=function(e,t){return ze.current.useMemo(e,t)};st.useReducer=function(e,t,s){return ze.current.useReducer(e,t,s)};st.useRef=function(e){return ze.current.useRef(e)};st.useState=function(e){return ze.current.useState(e)};st.useSyncExternalStore=function(e,t,s){return ze.current.useSyncExternalStore(e,t,s)};st.useTransition=function(){return ze.current.useTransition()};st.version="18.3.1";w0.exports=st;var C=w0.exports;const N0=oA(C),_A=rA({__proto__:null,default:N0},[C]);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var AA=C,SA=Symbol.for("react.element"),EA=Symbol.for("react.fragment"),CA=Object.prototype.hasOwnProperty,MA=AA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NA={key:!0,ref:!0,__self:!0,__source:!0};function P0(e,t,s){var a,i={},n=null,r=null;s!==void 0&&(n=""+s),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(r=t.ref);for(a in t)CA.call(t,a)&&!NA.hasOwnProperty(a)&&(i[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)i[a]===void 0&&(i[a]=t[a]);return{$$typeof:SA,type:e,key:n,ref:r,props:i,_owner:MA.current}}yp.Fragment=EA;yp.jsx=P0;yp.jsxs=P0;y0.exports=yp;var p=y0.exports,Fg={},T0={exports:{}},fs={},L0={exports:{}},R0={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(e){function t(L,j){var D=L.length;L.push(j);t:for(;0<D;){var Y=D-1>>>1,Q=L[Y];if(0<i(Q,j))L[Y]=j,L[D]=Q,D=Y;else break t}}function s(L){return L.length===0?null:L[0]}function a(L){if(L.length===0)return null;var j=L[0],D=L.pop();if(D!==j){L[0]=D;t:for(var Y=0,Q=L.length,ft=Q>>>1;Y<ft;){var wt=2*(Y+1)-1,ae=L[wt],dt=wt+1,at=L[dt];if(0>i(ae,D))dt<Q&&0>i(at,ae)?(L[Y]=at,L[dt]=D,Y=dt):(L[Y]=ae,L[wt]=D,Y=wt);else if(dt<Q&&0>i(at,D))L[Y]=at,L[dt]=D,Y=dt;else break t}}return j}function i(L,j){var D=L.sortIndex-j.sortIndex;return D!==0?D:L.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var n=performance;e.unstable_now=function(){return n.now()}}else{var r=Date,l=r.now();e.unstable_now=function(){return r.now()-l}}var c=[],u=[],h=1,d=null,f=3,g=!1,v=!1,y=!1,A=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(L){for(var j=s(u);j!==null;){if(j.callback===null)a(u);else if(j.startTime<=L)a(u),j.sortIndex=j.expirationTime,t(c,j);else break;j=s(u)}}function S(L){if(y=!1,w(L),!v)if(s(c)!==null)v=!0,F(E);else{var j=s(u);j!==null&&B(S,j.startTime-L)}}function E(L,j){v=!1,y&&(y=!1,b(P),P=-1),g=!0;var D=f;try{for(w(j),d=s(c);d!==null&&(!(d.expirationTime>j)||L&&!V());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,f=d.priorityLevel;var Q=Y(d.expirationTime<=j);j=e.unstable_now(),typeof Q=="function"?d.callback=Q:d===s(c)&&a(c),w(j)}else a(c);d=s(c)}if(d!==null)var ft=!0;else{var wt=s(u);wt!==null&&B(S,wt.startTime-j),ft=!1}return ft}finally{d=null,f=D,g=!1}}var M=!1,N=null,P=-1,T=5,I=-1;function V(){return!(e.unstable_now()-I<T)}function rt(){if(N!==null){var L=e.unstable_now();I=L;var j=!0;try{j=N(!0,L)}finally{j?ut():(M=!1,N=null)}}else M=!1}var ut;if(typeof x=="function")ut=function(){x(rt)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,G=ht.port2;ht.port1.onmessage=rt,ut=function(){G.postMessage(null)}}else ut=function(){A(rt,0)};function F(L){N=L,M||(M=!0,ut())}function B(L,j){P=A(function(){L(e.unstable_now())},j)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(L){L.callback=null},e.unstable_continueExecution=function(){v||g||(v=!0,F(E))},e.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<L?Math.floor(1e3/L):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function(L){switch(f){case 1:case 2:case 3:var j=3;break;default:j=f}var D=f;f=j;try{return L()}finally{f=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(L,j){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var D=f;f=L;try{return j()}finally{f=D}},e.unstable_scheduleCallback=function(L,j,D){var Y=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?Y+D:Y):D=Y,L){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=D+Q,L={id:h++,callback:j,priorityLevel:L,startTime:D,expirationTime:Q,sortIndex:-1},D>Y?(L.sortIndex=D,t(u,L),s(c)===null&&L===s(u)&&(y?(b(P),P=-1):y=!0,B(S,D-Y))):(L.sortIndex=Q,t(c,L),v||g||(v=!0,F(E))),L},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(L){var j=f;return function(){var D=f;f=j;try{return L.apply(this,arguments)}finally{f=D}}}})(R0);L0.exports=R0;var PA=L0.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var TA=C,ds=PA;function R(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var I0=new Set,_u={};function kr(e,t){il(e,t),il(e+"Capture",t)}function il(e,t){for(_u[e]=t,e=0;e<t.length;e++)I0.add(t[e])}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Og=Object.prototype.hasOwnProperty,LA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uy={},hy={};function RA(e){return Og.call(hy,e)?!0:Og.call(uy,e)?!1:LA.test(e)?hy[e]=!0:(uy[e]=!0,!1)}function IA(e,t,s,a){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function DA(e,t,s,a){if(t===null||typeof t>"u"||IA(e,t,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $e(e,t,s,a,i,n,r){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=a,this.attributeNamespace=i,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=n,this.removeEmptyString=r}var ge={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ge[e]=new $e(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ge[t]=new $e(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ge[e]=new $e(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ge[e]=new $e(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ge[e]=new $e(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ge[e]=new $e(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ge[e]=new $e(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ge[e]=new $e(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ge[e]=new $e(e,5,!1,e.toLowerCase(),null,!1,!1)});var sb=/[\-:]([a-z])/g;function ab(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(sb,ab);ge[t]=new $e(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(sb,ab);ge[t]=new $e(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(sb,ab);ge[t]=new $e(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ge[e]=new $e(e,1,!1,e.toLowerCase(),null,!1,!1)});ge.xlinkHref=new $e("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ge[e]=new $e(e,1,!1,e.toLowerCase(),null,!0,!0)});function ib(e,t,s,a){var i=ge.hasOwnProperty(t)?ge[t]:null;(i!==null?i.type!==0:a||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(DA(t,s,i,a)&&(s=null),a||i===null?RA(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):i.mustUseProperty?e[i.propertyName]=s===null?i.type===3?!1:"":s:(t=i.attributeName,a=i.attributeNamespace,s===null?e.removeAttribute(t):(i=i.type,s=i===3||i===4&&s===!0?"":""+s,a?e.setAttributeNS(a,t,s):e.setAttribute(t,s))))}var li=TA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,eh=Symbol.for("react.element"),po=Symbol.for("react.portal"),go=Symbol.for("react.fragment"),nb=Symbol.for("react.strict_mode"),Wg=Symbol.for("react.profiler"),D0=Symbol.for("react.provider"),j0=Symbol.for("react.context"),rb=Symbol.for("react.forward_ref"),zg=Symbol.for("react.suspense"),$g=Symbol.for("react.suspense_list"),ob=Symbol.for("react.memo"),Mi=Symbol.for("react.lazy"),F0=Symbol.for("react.offscreen"),dy=Symbol.iterator;function wl(e){return e===null||typeof e!="object"?null:(e=dy&&e[dy]||e["@@iterator"],typeof e=="function"?e:null)}var Rt=Object.assign,Xp;function Fl(e){if(Xp===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Xp=t&&t[1]||""}return`
`+Xp+e}var Yp=!1;function Kp(e,t){if(!e||Yp)return"";Yp=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var a=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){a=u}e.call(t.prototype)}else{try{throw Error()}catch(u){a=u}e()}}catch(u){if(u&&a&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),n=a.stack.split(`
`),r=i.length-1,l=n.length-1;1<=r&&0<=l&&i[r]!==n[l];)l--;for(;1<=r&&0<=l;r--,l--)if(i[r]!==n[l]){if(r!==1||l!==1)do if(r--,l--,0>l||i[r]!==n[l]){var c=`
`+i[r].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=r&&0<=l);break}}}finally{Yp=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Fl(e):""}function jA(e){switch(e.tag){case 5:return Fl(e.type);case 16:return Fl("Lazy");case 13:return Fl("Suspense");case 19:return Fl("SuspenseList");case 0:case 2:case 15:return e=Kp(e.type,!1),e;case 11:return e=Kp(e.type.render,!1),e;case 1:return e=Kp(e.type,!0),e;default:return""}}function Bg(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case go:return"Fragment";case po:return"Portal";case Wg:return"Profiler";case nb:return"StrictMode";case zg:return"Suspense";case $g:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case j0:return(e.displayName||"Context")+".Consumer";case D0:return(e._context.displayName||"Context")+".Provider";case rb:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ob:return t=e.displayName||null,t!==null?t:Bg(e.type)||"Memo";case Mi:t=e._payload,e=e._init;try{return Bg(e(t))}catch{}}return null}function FA(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bg(t);case 8:return t===nb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function hn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function O0(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function OA(e){var t=O0(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var i=s.get,n=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(r){a=""+r,n.call(this,r)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(r){a=""+r},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function sh(e){e._valueTracker||(e._valueTracker=OA(e))}function W0(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),a="";return e&&(a=O0(e)?e.checked?"true":"false":e.value),e=a,e!==s?(t.setValue(e),!0):!1}function ef(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ug(e,t){var s=t.checked;return Rt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function fy(e,t){var s=t.defaultValue==null?"":t.defaultValue,a=t.checked!=null?t.checked:t.defaultChecked;s=hn(t.value!=null?t.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function z0(e,t){t=t.checked,t!=null&&ib(e,"checked",t,!1)}function Hg(e,t){z0(e,t);var s=hn(t.value),a=t.type;if(s!=null)a==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Vg(e,t.type,s):t.hasOwnProperty("defaultValue")&&Vg(e,t.type,hn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function py(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!(a!=="submit"&&a!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function Vg(e,t,s){(t!=="number"||ef(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Ol=Array.isArray;function Uo(e,t,s,a){if(e=e.options,t){t={};for(var i=0;i<s.length;i++)t["$"+s[i]]=!0;for(s=0;s<e.length;s++)i=t.hasOwnProperty("$"+e[s].value),e[s].selected!==i&&(e[s].selected=i),i&&a&&(e[s].defaultSelected=!0)}else{for(s=""+hn(s),t=null,i=0;i<e.length;i++){if(e[i].value===s){e[i].selected=!0,a&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Gg(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(R(91));return Rt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function gy(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(R(92));if(Ol(s)){if(1<s.length)throw Error(R(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:hn(s)}}function $0(e,t){var s=hn(t.value),a=hn(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),a!=null&&(e.defaultValue=""+a)}function my(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function B0(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qg(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?B0(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ah,U0=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,a,i){MSApp.execUnsafeLocalFunction(function(){return e(t,s,a,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ah=ah||document.createElement("div"),ah.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ah.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Au(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var Fc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},WA=["Webkit","ms","Moz","O"];Object.keys(Fc).forEach(function(e){WA.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fc[t]=Fc[e]})});function H0(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||Fc.hasOwnProperty(e)&&Fc[e]?(""+t).trim():t+"px"}function V0(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var a=s.indexOf("--")===0,i=H0(s,t[s],a);s==="float"&&(s="cssFloat"),a?e.setProperty(s,i):e[s]=i}}var zA=Rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xg(e,t){if(t){if(zA[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(R(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(R(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(R(61))}if(t.style!=null&&typeof t.style!="object")throw Error(R(62))}}function Yg(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kg=null;function lb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qg=null,Ho=null,Vo=null;function vy(e){if(e=Yu(e)){if(typeof Qg!="function")throw Error(R(280));var t=e.stateNode;t&&(t=Ap(t),Qg(e.stateNode,e.type,t))}}function G0(e){Ho?Vo?Vo.push(e):Vo=[e]:Ho=e}function q0(){if(Ho){var e=Ho,t=Vo;if(Vo=Ho=null,vy(e),t)for(e=0;e<t.length;e++)vy(t[e])}}function X0(e,t){return e(t)}function Y0(){}var Qp=!1;function K0(e,t,s){if(Qp)return e(t,s);Qp=!0;try{return X0(e,t,s)}finally{Qp=!1,(Ho!==null||Vo!==null)&&(Y0(),q0())}}function Su(e,t){var s=e.stateNode;if(s===null)return null;var a=Ap(s);if(a===null)return null;s=a[t];t:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break t;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(R(231,t,typeof s));return s}var Jg=!1;if(ii)try{var xl={};Object.defineProperty(xl,"passive",{get:function(){Jg=!0}}),window.addEventListener("test",xl,xl),window.removeEventListener("test",xl,xl)}catch{Jg=!1}function $A(e,t,s,a,i,n,r,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(s,u)}catch(h){this.onError(h)}}var Oc=!1,sf=null,af=!1,Zg=null,BA={onError:function(e){Oc=!0,sf=e}};function UA(e,t,s,a,i,n,r,l,c){Oc=!1,sf=null,$A.apply(BA,arguments)}function HA(e,t,s,a,i,n,r,l,c){if(UA.apply(this,arguments),Oc){if(Oc){var u=sf;Oc=!1,sf=null}else throw Error(R(198));af||(af=!0,Zg=u)}}function _r(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function Q0(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function by(e){if(_r(e)!==e)throw Error(R(188))}function VA(e){var t=e.alternate;if(!t){if(t=_r(e),t===null)throw Error(R(188));return t!==e?null:e}for(var s=e,a=t;;){var i=s.return;if(i===null)break;var n=i.alternate;if(n===null){if(a=i.return,a!==null){s=a;continue}break}if(i.child===n.child){for(n=i.child;n;){if(n===s)return by(i),e;if(n===a)return by(i),t;n=n.sibling}throw Error(R(188))}if(s.return!==a.return)s=i,a=n;else{for(var r=!1,l=i.child;l;){if(l===s){r=!0,s=i,a=n;break}if(l===a){r=!0,a=i,s=n;break}l=l.sibling}if(!r){for(l=n.child;l;){if(l===s){r=!0,s=n,a=i;break}if(l===a){r=!0,a=n,s=i;break}l=l.sibling}if(!r)throw Error(R(189))}}if(s.alternate!==a)throw Error(R(190))}if(s.tag!==3)throw Error(R(188));return s.stateNode.current===s?e:t}function J0(e){return e=VA(e),e!==null?Z0(e):null}function Z0(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Z0(e);if(t!==null)return t;e=e.sibling}return null}var tx=ds.unstable_scheduleCallback,yy=ds.unstable_cancelCallback,GA=ds.unstable_shouldYield,qA=ds.unstable_requestPaint,Wt=ds.unstable_now,XA=ds.unstable_getCurrentPriorityLevel,cb=ds.unstable_ImmediatePriority,ex=ds.unstable_UserBlockingPriority,nf=ds.unstable_NormalPriority,YA=ds.unstable_LowPriority,sx=ds.unstable_IdlePriority,wp=null,Ea=null;function KA(e){if(Ea&&typeof Ea.onCommitFiberRoot=="function")try{Ea.onCommitFiberRoot(wp,e,void 0,(e.current.flags&128)===128)}catch{}}var Qs=Math.clz32?Math.clz32:ZA,QA=Math.log,JA=Math.LN2;function ZA(e){return e>>>=0,e===0?32:31-(QA(e)/JA|0)|0}var ih=64,nh=4194304;function Wl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function rf(e,t){var s=e.pendingLanes;if(s===0)return 0;var a=0,i=e.suspendedLanes,n=e.pingedLanes,r=s&268435455;if(r!==0){var l=r&~i;l!==0?a=Wl(l):(n&=r,n!==0&&(a=Wl(n)))}else r=s&~i,r!==0?a=Wl(r):n!==0&&(a=Wl(n));if(a===0)return 0;if(t!==0&&t!==a&&!(t&i)&&(i=a&-a,n=t&-t,i>=n||i===16&&(n&4194240)!==0))return t;if(a&4&&(a|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=a;0<t;)s=31-Qs(t),i=1<<s,a|=e[s],t&=~i;return a}function tS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eS(e,t){for(var s=e.suspendedLanes,a=e.pingedLanes,i=e.expirationTimes,n=e.pendingLanes;0<n;){var r=31-Qs(n),l=1<<r,c=i[r];c===-1?(!(l&s)||l&a)&&(i[r]=tS(l,t)):c<=t&&(e.expiredLanes|=l),n&=~l}}function tm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ax(){var e=ih;return ih<<=1,!(ih&4194240)&&(ih=64),e}function Jp(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function qu(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Qs(t),e[t]=s}function sS(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var i=31-Qs(s),n=1<<i;t[i]=0,a[i]=-1,e[i]=-1,s&=~n}}function ub(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var a=31-Qs(s),i=1<<a;i&t|e[a]&t&&(e[a]|=t),s&=~i}}var mt=0;function ix(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var nx,hb,rx,ox,lx,em=!1,rh=[],en=null,sn=null,an=null,Eu=new Map,Cu=new Map,Fi=[],aS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wy(e,t){switch(e){case"focusin":case"focusout":en=null;break;case"dragenter":case"dragleave":sn=null;break;case"mouseover":case"mouseout":an=null;break;case"pointerover":case"pointerout":Eu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cu.delete(t.pointerId)}}function kl(e,t,s,a,i,n){return e===null||e.nativeEvent!==n?(e={blockedOn:t,domEventName:s,eventSystemFlags:a,nativeEvent:n,targetContainers:[i]},t!==null&&(t=Yu(t),t!==null&&hb(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function iS(e,t,s,a,i){switch(t){case"focusin":return en=kl(en,e,t,s,a,i),!0;case"dragenter":return sn=kl(sn,e,t,s,a,i),!0;case"mouseover":return an=kl(an,e,t,s,a,i),!0;case"pointerover":var n=i.pointerId;return Eu.set(n,kl(Eu.get(n)||null,e,t,s,a,i)),!0;case"gotpointercapture":return n=i.pointerId,Cu.set(n,kl(Cu.get(n)||null,e,t,s,a,i)),!0}return!1}function cx(e){var t=tr(e.target);if(t!==null){var s=_r(t);if(s!==null){if(t=s.tag,t===13){if(t=Q0(s),t!==null){e.blockedOn=t,lx(e.priority,function(){rx(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nh(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=sm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var a=new s.constructor(s.type,s);Kg=a,s.target.dispatchEvent(a),Kg=null}else return t=Yu(s),t!==null&&hb(t),e.blockedOn=s,!1;t.shift()}return!0}function xy(e,t,s){Nh(e)&&s.delete(t)}function nS(){em=!1,en!==null&&Nh(en)&&(en=null),sn!==null&&Nh(sn)&&(sn=null),an!==null&&Nh(an)&&(an=null),Eu.forEach(xy),Cu.forEach(xy)}function _l(e,t){e.blockedOn===t&&(e.blockedOn=null,em||(em=!0,ds.unstable_scheduleCallback(ds.unstable_NormalPriority,nS)))}function Mu(e){function t(i){return _l(i,e)}if(0<rh.length){_l(rh[0],e);for(var s=1;s<rh.length;s++){var a=rh[s];a.blockedOn===e&&(a.blockedOn=null)}}for(en!==null&&_l(en,e),sn!==null&&_l(sn,e),an!==null&&_l(an,e),Eu.forEach(t),Cu.forEach(t),s=0;s<Fi.length;s++)a=Fi[s],a.blockedOn===e&&(a.blockedOn=null);for(;0<Fi.length&&(s=Fi[0],s.blockedOn===null);)cx(s),s.blockedOn===null&&Fi.shift()}var Go=li.ReactCurrentBatchConfig,of=!0;function rS(e,t,s,a){var i=mt,n=Go.transition;Go.transition=null;try{mt=1,db(e,t,s,a)}finally{mt=i,Go.transition=n}}function oS(e,t,s,a){var i=mt,n=Go.transition;Go.transition=null;try{mt=4,db(e,t,s,a)}finally{mt=i,Go.transition=n}}function db(e,t,s,a){if(of){var i=sm(e,t,s,a);if(i===null)lg(e,t,a,lf,s),wy(e,a);else if(iS(i,e,t,s,a))a.stopPropagation();else if(wy(e,a),t&4&&-1<aS.indexOf(e)){for(;i!==null;){var n=Yu(i);if(n!==null&&nx(n),n=sm(e,t,s,a),n===null&&lg(e,t,a,lf,s),n===i)break;i=n}i!==null&&a.stopPropagation()}else lg(e,t,a,null,s)}}var lf=null;function sm(e,t,s,a){if(lf=null,e=lb(a),e=tr(e),e!==null)if(t=_r(e),t===null)e=null;else if(s=t.tag,s===13){if(e=Q0(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return lf=e,null}function ux(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XA()){case cb:return 1;case ex:return 4;case nf:case YA:return 16;case sx:return 536870912;default:return 16}default:return 16}}var qi=null,fb=null,Ph=null;function hx(){if(Ph)return Ph;var e,t=fb,s=t.length,a,i="value"in qi?qi.value:qi.textContent,n=i.length;for(e=0;e<s&&t[e]===i[e];e++);var r=s-e;for(a=1;a<=r&&t[s-a]===i[n-a];a++);return Ph=i.slice(e,1<a?1-a:void 0)}function Th(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function oh(){return!0}function ky(){return!1}function ps(e){function t(s,a,i,n,r){this._reactName=s,this._targetInst=i,this.type=a,this.nativeEvent=n,this.target=r,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(s=e[l],this[l]=s?s(n):n[l]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?oh:ky,this.isPropagationStopped=ky,this}return Rt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=oh)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=oh)},persist:function(){},isPersistent:oh}),t}var gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pb=ps(gl),Xu=Rt({},gl,{view:0,detail:0}),lS=ps(Xu),Zp,tg,Al,xp=Rt({},Xu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gb,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Al&&(Al&&e.type==="mousemove"?(Zp=e.screenX-Al.screenX,tg=e.screenY-Al.screenY):tg=Zp=0,Al=e),Zp)},movementY:function(e){return"movementY"in e?e.movementY:tg}}),_y=ps(xp),cS=Rt({},xp,{dataTransfer:0}),uS=ps(cS),hS=Rt({},Xu,{relatedTarget:0}),eg=ps(hS),dS=Rt({},gl,{animationName:0,elapsedTime:0,pseudoElement:0}),fS=ps(dS),pS=Rt({},gl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),gS=ps(pS),mS=Rt({},gl,{data:0}),Ay=ps(mS),vS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wS(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=yS[e])?!!t[e]:!1}function gb(){return wS}var xS=Rt({},Xu,{key:function(e){if(e.key){var t=vS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Th(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?bS[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gb,charCode:function(e){return e.type==="keypress"?Th(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Th(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),kS=ps(xS),_S=Rt({},xp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sy=ps(_S),AS=Rt({},Xu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gb}),SS=ps(AS),ES=Rt({},gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),CS=ps(ES),MS=Rt({},xp,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),NS=ps(MS),PS=[9,13,27,32],mb=ii&&"CompositionEvent"in window,Wc=null;ii&&"documentMode"in document&&(Wc=document.documentMode);var TS=ii&&"TextEvent"in window&&!Wc,dx=ii&&(!mb||Wc&&8<Wc&&11>=Wc),Ey=" ",Cy=!1;function fx(e,t){switch(e){case"keyup":return PS.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function px(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var mo=!1;function LS(e,t){switch(e){case"compositionend":return px(t);case"keypress":return t.which!==32?null:(Cy=!0,Ey);case"textInput":return e=t.data,e===Ey&&Cy?null:e;default:return null}}function RS(e,t){if(mo)return e==="compositionend"||!mb&&fx(e,t)?(e=hx(),Ph=fb=qi=null,mo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return dx&&t.locale!=="ko"?null:t.data;default:return null}}var IS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function My(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!IS[e.type]:t==="textarea"}function gx(e,t,s,a){G0(a),t=cf(t,"onChange"),0<t.length&&(s=new pb("onChange","change",null,s,a),e.push({event:s,listeners:t}))}var zc=null,Nu=null;function DS(e){Ex(e,0)}function kp(e){var t=yo(e);if(W0(t))return e}function jS(e,t){if(e==="change")return t}var mx=!1;if(ii){var sg;if(ii){var ag="oninput"in document;if(!ag){var Ny=document.createElement("div");Ny.setAttribute("oninput","return;"),ag=typeof Ny.oninput=="function"}sg=ag}else sg=!1;mx=sg&&(!document.documentMode||9<document.documentMode)}function Py(){zc&&(zc.detachEvent("onpropertychange",vx),Nu=zc=null)}function vx(e){if(e.propertyName==="value"&&kp(Nu)){var t=[];gx(t,Nu,e,lb(e)),K0(DS,t)}}function FS(e,t,s){e==="focusin"?(Py(),zc=t,Nu=s,zc.attachEvent("onpropertychange",vx)):e==="focusout"&&Py()}function OS(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kp(Nu)}function WS(e,t){if(e==="click")return kp(t)}function zS(e,t){if(e==="input"||e==="change")return kp(t)}function $S(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zs=typeof Object.is=="function"?Object.is:$S;function Pu(e,t){if(Zs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var i=s[a];if(!Og.call(t,i)||!Zs(e[i],t[i]))return!1}return!0}function Ty(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ly(e,t){var s=Ty(e);e=0;for(var a;s;){if(s.nodeType===3){if(a=e+s.textContent.length,e<=t&&a>=t)return{node:s,offset:t-e};e=a}t:{for(;s;){if(s.nextSibling){s=s.nextSibling;break t}s=s.parentNode}s=void 0}s=Ty(s)}}function bx(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?bx(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function yx(){for(var e=window,t=ef();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=ef(e.document)}return t}function vb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function BS(e){var t=yx(),s=e.focusedElem,a=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&bx(s.ownerDocument.documentElement,s)){if(a!==null&&vb(s)){if(t=a.start,e=a.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=s.textContent.length,n=Math.min(a.start,i);a=a.end===void 0?n:Math.min(a.end,i),!e.extend&&n>a&&(i=a,a=n,n=i),i=Ly(s,n);var r=Ly(s,a);i&&r&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==r.node||e.focusOffset!==r.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),n>a?(e.addRange(t),e.extend(r.node,r.offset)):(t.setEnd(r.node,r.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var US=ii&&"documentMode"in document&&11>=document.documentMode,vo=null,am=null,$c=null,im=!1;function Ry(e,t,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;im||vo==null||vo!==ef(a)||(a=vo,"selectionStart"in a&&vb(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),$c&&Pu($c,a)||($c=a,a=cf(am,"onSelect"),0<a.length&&(t=new pb("onSelect","select",null,t,s),e.push({event:t,listeners:a}),t.target=vo)))}function lh(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var bo={animationend:lh("Animation","AnimationEnd"),animationiteration:lh("Animation","AnimationIteration"),animationstart:lh("Animation","AnimationStart"),transitionend:lh("Transition","TransitionEnd")},ig={},wx={};ii&&(wx=document.createElement("div").style,"AnimationEvent"in window||(delete bo.animationend.animation,delete bo.animationiteration.animation,delete bo.animationstart.animation),"TransitionEvent"in window||delete bo.transitionend.transition);function _p(e){if(ig[e])return ig[e];if(!bo[e])return e;var t=bo[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in wx)return ig[e]=t[s];return e}var xx=_p("animationend"),kx=_p("animationiteration"),_x=_p("animationstart"),Ax=_p("transitionend"),Sx=new Map,Iy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mn(e,t){Sx.set(e,t),kr(t,[e])}for(var ng=0;ng<Iy.length;ng++){var rg=Iy[ng],HS=rg.toLowerCase(),VS=rg[0].toUpperCase()+rg.slice(1);mn(HS,"on"+VS)}mn(xx,"onAnimationEnd");mn(kx,"onAnimationIteration");mn(_x,"onAnimationStart");mn("dblclick","onDoubleClick");mn("focusin","onFocus");mn("focusout","onBlur");mn(Ax,"onTransitionEnd");il("onMouseEnter",["mouseout","mouseover"]);il("onMouseLeave",["mouseout","mouseover"]);il("onPointerEnter",["pointerout","pointerover"]);il("onPointerLeave",["pointerout","pointerover"]);kr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));kr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));kr("onBeforeInput",["compositionend","keypress","textInput","paste"]);kr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));kr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));kr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GS=new Set("cancel close invalid load scroll toggle".split(" ").concat(zl));function Dy(e,t,s){var a=e.type||"unknown-event";e.currentTarget=s,HA(a,t,void 0,e),e.currentTarget=null}function Ex(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var a=e[s],i=a.event;a=a.listeners;t:{var n=void 0;if(t)for(var r=a.length-1;0<=r;r--){var l=a[r],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==n&&i.isPropagationStopped())break t;Dy(i,l,u),n=c}else for(r=0;r<a.length;r++){if(l=a[r],c=l.instance,u=l.currentTarget,l=l.listener,c!==n&&i.isPropagationStopped())break t;Dy(i,l,u),n=c}}}if(af)throw e=Zg,af=!1,Zg=null,e}function kt(e,t){var s=t[cm];s===void 0&&(s=t[cm]=new Set);var a=e+"__bubble";s.has(a)||(Cx(t,e,2,!1),s.add(a))}function og(e,t,s){var a=0;t&&(a|=4),Cx(s,e,a,t)}var ch="_reactListening"+Math.random().toString(36).slice(2);function Tu(e){if(!e[ch]){e[ch]=!0,I0.forEach(function(s){s!=="selectionchange"&&(GS.has(s)||og(s,!1,e),og(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ch]||(t[ch]=!0,og("selectionchange",!1,t))}}function Cx(e,t,s,a){switch(ux(t)){case 1:var i=rS;break;case 4:i=oS;break;default:i=db}s=i.bind(null,t,s,e),i=void 0,!Jg||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),a?i!==void 0?e.addEventListener(t,s,{capture:!0,passive:i}):e.addEventListener(t,s,!0):i!==void 0?e.addEventListener(t,s,{passive:i}):e.addEventListener(t,s,!1)}function lg(e,t,s,a,i){var n=a;if(!(t&1)&&!(t&2)&&a!==null)t:for(;;){if(a===null)return;var r=a.tag;if(r===3||r===4){var l=a.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(r===4)for(r=a.return;r!==null;){var c=r.tag;if((c===3||c===4)&&(c=r.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;r=r.return}for(;l!==null;){if(r=tr(l),r===null)return;if(c=r.tag,c===5||c===6){a=n=r;continue t}l=l.parentNode}}a=a.return}K0(function(){var u=n,h=lb(s),d=[];t:{var f=Sx.get(e);if(f!==void 0){var g=pb,v=e;switch(e){case"keypress":if(Th(s)===0)break t;case"keydown":case"keyup":g=kS;break;case"focusin":v="focus",g=eg;break;case"focusout":v="blur",g=eg;break;case"beforeblur":case"afterblur":g=eg;break;case"click":if(s.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=_y;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=uS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=SS;break;case xx:case kx:case _x:g=fS;break;case Ax:g=CS;break;case"scroll":g=lS;break;case"wheel":g=NS;break;case"copy":case"cut":case"paste":g=gS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Sy}var y=(t&4)!==0,A=!y&&e==="scroll",b=y?f!==null?f+"Capture":null:f;y=[];for(var x=u,w;x!==null;){w=x;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,b!==null&&(S=Su(x,b),S!=null&&y.push(Lu(x,S,w)))),A)break;x=x.return}0<y.length&&(f=new g(f,v,null,s,h),d.push({event:f,listeners:y}))}}if(!(t&7)){t:{if(f=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",f&&s!==Kg&&(v=s.relatedTarget||s.fromElement)&&(tr(v)||v[ni]))break t;if((g||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,g?(v=s.relatedTarget||s.toElement,g=u,v=v?tr(v):null,v!==null&&(A=_r(v),v!==A||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=u),g!==v)){if(y=_y,S="onMouseLeave",b="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(y=Sy,S="onPointerLeave",b="onPointerEnter",x="pointer"),A=g==null?f:yo(g),w=v==null?f:yo(v),f=new y(S,x+"leave",g,s,h),f.target=A,f.relatedTarget=w,S=null,tr(h)===u&&(y=new y(b,x+"enter",v,s,h),y.target=w,y.relatedTarget=A,S=y),A=S,g&&v)e:{for(y=g,b=v,x=0,w=y;w;w=Cr(w))x++;for(w=0,S=b;S;S=Cr(S))w++;for(;0<x-w;)y=Cr(y),x--;for(;0<w-x;)b=Cr(b),w--;for(;x--;){if(y===b||b!==null&&y===b.alternate)break e;y=Cr(y),b=Cr(b)}y=null}else y=null;g!==null&&jy(d,f,g,y,!1),v!==null&&A!==null&&jy(d,A,v,y,!0)}}t:{if(f=u?yo(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var E=jS;else if(My(f))if(mx)E=zS;else{E=OS;var M=FS}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=WS);if(E&&(E=E(e,u))){gx(d,E,s,h);break t}M&&M(e,f,u),e==="focusout"&&(M=f._wrapperState)&&M.controlled&&f.type==="number"&&Vg(f,"number",f.value)}switch(M=u?yo(u):window,e){case"focusin":(My(M)||M.contentEditable==="true")&&(vo=M,am=u,$c=null);break;case"focusout":$c=am=vo=null;break;case"mousedown":im=!0;break;case"contextmenu":case"mouseup":case"dragend":im=!1,Ry(d,s,h);break;case"selectionchange":if(US)break;case"keydown":case"keyup":Ry(d,s,h)}var N;if(mb)t:{switch(e){case"compositionstart":var P="onCompositionStart";break t;case"compositionend":P="onCompositionEnd";break t;case"compositionupdate":P="onCompositionUpdate";break t}P=void 0}else mo?fx(e,s)&&(P="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(P="onCompositionStart");P&&(dx&&s.locale!=="ko"&&(mo||P!=="onCompositionStart"?P==="onCompositionEnd"&&mo&&(N=hx()):(qi=h,fb="value"in qi?qi.value:qi.textContent,mo=!0)),M=cf(u,P),0<M.length&&(P=new Ay(P,e,null,s,h),d.push({event:P,listeners:M}),N?P.data=N:(N=px(s),N!==null&&(P.data=N)))),(N=TS?LS(e,s):RS(e,s))&&(u=cf(u,"onBeforeInput"),0<u.length&&(h=new Ay("onBeforeInput","beforeinput",null,s,h),d.push({event:h,listeners:u}),h.data=N))}Ex(d,t)})}function Lu(e,t,s){return{instance:e,listener:t,currentTarget:s}}function cf(e,t){for(var s=t+"Capture",a=[];e!==null;){var i=e,n=i.stateNode;i.tag===5&&n!==null&&(i=n,n=Su(e,s),n!=null&&a.unshift(Lu(e,n,i)),n=Su(e,t),n!=null&&a.push(Lu(e,n,i))),e=e.return}return a}function Cr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function jy(e,t,s,a,i){for(var n=t._reactName,r=[];s!==null&&s!==a;){var l=s,c=l.alternate,u=l.stateNode;if(c!==null&&c===a)break;l.tag===5&&u!==null&&(l=u,i?(c=Su(s,n),c!=null&&r.unshift(Lu(s,c,l))):i||(c=Su(s,n),c!=null&&r.push(Lu(s,c,l)))),s=s.return}r.length!==0&&e.push({event:t,listeners:r})}var qS=/\r\n?/g,XS=/\u0000|\uFFFD/g;function Fy(e){return(typeof e=="string"?e:""+e).replace(qS,`
`).replace(XS,"")}function uh(e,t,s){if(t=Fy(t),Fy(e)!==t&&s)throw Error(R(425))}function uf(){}var nm=null,rm=null;function om(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var lm=typeof setTimeout=="function"?setTimeout:void 0,YS=typeof clearTimeout=="function"?clearTimeout:void 0,Oy=typeof Promise=="function"?Promise:void 0,KS=typeof queueMicrotask=="function"?queueMicrotask:typeof Oy<"u"?function(e){return Oy.resolve(null).then(e).catch(QS)}:lm;function QS(e){setTimeout(function(){throw e})}function cg(e,t){var s=t,a=0;do{var i=s.nextSibling;if(e.removeChild(s),i&&i.nodeType===8)if(s=i.data,s==="/$"){if(a===0){e.removeChild(i),Mu(t);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=i}while(s);Mu(t)}function nn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Wy(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var ml=Math.random().toString(36).slice(2),_a="__reactFiber$"+ml,Ru="__reactProps$"+ml,ni="__reactContainer$"+ml,cm="__reactEvents$"+ml,JS="__reactListeners$"+ml,ZS="__reactHandles$"+ml;function tr(e){var t=e[_a];if(t)return t;for(var s=e.parentNode;s;){if(t=s[ni]||s[_a]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=Wy(e);e!==null;){if(s=e[_a])return s;e=Wy(e)}return t}e=s,s=e.parentNode}return null}function Yu(e){return e=e[_a]||e[ni],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(R(33))}function Ap(e){return e[Ru]||null}var um=[],wo=-1;function vn(e){return{current:e}}function At(e){0>wo||(e.current=um[wo],um[wo]=null,wo--)}function xt(e,t){wo++,um[wo]=e.current,e.current=t}var dn={},Pe=vn(dn),Ze=vn(!1),pr=dn;function nl(e,t){var s=e.type.contextTypes;if(!s)return dn;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var i={},n;for(n in s)i[n]=t[n];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ts(e){return e=e.childContextTypes,e!=null}function hf(){At(Ze),At(Pe)}function zy(e,t,s){if(Pe.current!==dn)throw Error(R(168));xt(Pe,t),xt(Ze,s)}function Mx(e,t,s){var a=e.stateNode;if(t=t.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var i in a)if(!(i in t))throw Error(R(108,FA(e)||"Unknown",i));return Rt({},s,a)}function df(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||dn,pr=Pe.current,xt(Pe,e),xt(Ze,Ze.current),!0}function $y(e,t,s){var a=e.stateNode;if(!a)throw Error(R(169));s?(e=Mx(e,t,pr),a.__reactInternalMemoizedMergedChildContext=e,At(Ze),At(Pe),xt(Pe,e)):At(Ze),xt(Ze,s)}var qa=null,Sp=!1,ug=!1;function Nx(e){qa===null?qa=[e]:qa.push(e)}function tE(e){Sp=!0,Nx(e)}function bn(){if(!ug&&qa!==null){ug=!0;var e=0,t=mt;try{var s=qa;for(mt=1;e<s.length;e++){var a=s[e];do a=a(!0);while(a!==null)}qa=null,Sp=!1}catch(i){throw qa!==null&&(qa=qa.slice(e+1)),tx(cb,bn),i}finally{mt=t,ug=!1}}return null}var xo=[],ko=0,ff=null,pf=0,Ts=[],Ls=0,gr=null,ei=1,si="";function xn(e,t){xo[ko++]=pf,xo[ko++]=ff,ff=e,pf=t}function Px(e,t,s){Ts[Ls++]=ei,Ts[Ls++]=si,Ts[Ls++]=gr,gr=e;var a=ei;e=si;var i=32-Qs(a)-1;a&=~(1<<i),s+=1;var n=32-Qs(t)+i;if(30<n){var r=i-i%5;n=(a&(1<<r)-1).toString(32),a>>=r,i-=r,ei=1<<32-Qs(t)+i|s<<i|a,si=n+e}else ei=1<<n|s<<i|a,si=e}function bb(e){e.return!==null&&(xn(e,1),Px(e,1,0))}function yb(e){for(;e===ff;)ff=xo[--ko],xo[ko]=null,pf=xo[--ko],xo[ko]=null;for(;e===gr;)gr=Ts[--Ls],Ts[Ls]=null,si=Ts[--Ls],Ts[Ls]=null,ei=Ts[--Ls],Ts[Ls]=null}var hs=null,us=null,Nt=!1,Ks=null;function Tx(e,t){var s=Rs(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function By(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,hs=e,us=nn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,hs=e,us=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=gr!==null?{id:ei,overflow:si}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=Rs(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,hs=e,us=null,!0):!1;default:return!1}}function hm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function dm(e){if(Nt){var t=us;if(t){var s=t;if(!By(e,t)){if(hm(e))throw Error(R(418));t=nn(s.nextSibling);var a=hs;t&&By(e,t)?Tx(a,s):(e.flags=e.flags&-4097|2,Nt=!1,hs=e)}}else{if(hm(e))throw Error(R(418));e.flags=e.flags&-4097|2,Nt=!1,hs=e}}}function Uy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;hs=e}function hh(e){if(e!==hs)return!1;if(!Nt)return Uy(e),Nt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!om(e.type,e.memoizedProps)),t&&(t=us)){if(hm(e))throw Lx(),Error(R(418));for(;t;)Tx(e,t),t=nn(t.nextSibling)}if(Uy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(R(317));t:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){us=nn(e.nextSibling);break t}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}us=null}}else us=hs?nn(e.stateNode.nextSibling):null;return!0}function Lx(){for(var e=us;e;)e=nn(e.nextSibling)}function rl(){us=hs=null,Nt=!1}function wb(e){Ks===null?Ks=[e]:Ks.push(e)}var eE=li.ReactCurrentBatchConfig;function Sl(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(R(309));var a=s.stateNode}if(!a)throw Error(R(147,e));var i=a,n=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===n?t.ref:(t=function(r){var l=i.refs;r===null?delete l[n]:l[n]=r},t._stringRef=n,t)}if(typeof e!="string")throw Error(R(284));if(!s._owner)throw Error(R(290,e))}return e}function dh(e,t){throw e=Object.prototype.toString.call(t),Error(R(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Hy(e){var t=e._init;return t(e._payload)}function Rx(e){function t(b,x){if(e){var w=b.deletions;w===null?(b.deletions=[x],b.flags|=16):w.push(x)}}function s(b,x){if(!e)return null;for(;x!==null;)t(b,x),x=x.sibling;return null}function a(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function i(b,x){return b=cn(b,x),b.index=0,b.sibling=null,b}function n(b,x,w){return b.index=w,e?(w=b.alternate,w!==null?(w=w.index,w<x?(b.flags|=2,x):w):(b.flags|=2,x)):(b.flags|=1048576,x)}function r(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,x,w,S){return x===null||x.tag!==6?(x=vg(w,b.mode,S),x.return=b,x):(x=i(x,w),x.return=b,x)}function c(b,x,w,S){var E=w.type;return E===go?h(b,x,w.props.children,S,w.key):x!==null&&(x.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Mi&&Hy(E)===x.type)?(S=i(x,w.props),S.ref=Sl(b,x,w),S.return=b,S):(S=Oh(w.type,w.key,w.props,null,b.mode,S),S.ref=Sl(b,x,w),S.return=b,S)}function u(b,x,w,S){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=bg(w,b.mode,S),x.return=b,x):(x=i(x,w.children||[]),x.return=b,x)}function h(b,x,w,S,E){return x===null||x.tag!==7?(x=fr(w,b.mode,S,E),x.return=b,x):(x=i(x,w),x.return=b,x)}function d(b,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=vg(""+x,b.mode,w),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case eh:return w=Oh(x.type,x.key,x.props,null,b.mode,w),w.ref=Sl(b,null,x),w.return=b,w;case po:return x=bg(x,b.mode,w),x.return=b,x;case Mi:var S=x._init;return d(b,S(x._payload),w)}if(Ol(x)||wl(x))return x=fr(x,b.mode,w,null),x.return=b,x;dh(b,x)}return null}function f(b,x,w,S){var E=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return E!==null?null:l(b,x,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case eh:return w.key===E?c(b,x,w,S):null;case po:return w.key===E?u(b,x,w,S):null;case Mi:return E=w._init,f(b,x,E(w._payload),S)}if(Ol(w)||wl(w))return E!==null?null:h(b,x,w,S,null);dh(b,w)}return null}function g(b,x,w,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(w)||null,l(x,b,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case eh:return b=b.get(S.key===null?w:S.key)||null,c(x,b,S,E);case po:return b=b.get(S.key===null?w:S.key)||null,u(x,b,S,E);case Mi:var M=S._init;return g(b,x,w,M(S._payload),E)}if(Ol(S)||wl(S))return b=b.get(w)||null,h(x,b,S,E,null);dh(x,S)}return null}function v(b,x,w,S){for(var E=null,M=null,N=x,P=x=0,T=null;N!==null&&P<w.length;P++){N.index>P?(T=N,N=null):T=N.sibling;var I=f(b,N,w[P],S);if(I===null){N===null&&(N=T);break}e&&N&&I.alternate===null&&t(b,N),x=n(I,x,P),M===null?E=I:M.sibling=I,M=I,N=T}if(P===w.length)return s(b,N),Nt&&xn(b,P),E;if(N===null){for(;P<w.length;P++)N=d(b,w[P],S),N!==null&&(x=n(N,x,P),M===null?E=N:M.sibling=N,M=N);return Nt&&xn(b,P),E}for(N=a(b,N);P<w.length;P++)T=g(N,b,P,w[P],S),T!==null&&(e&&T.alternate!==null&&N.delete(T.key===null?P:T.key),x=n(T,x,P),M===null?E=T:M.sibling=T,M=T);return e&&N.forEach(function(V){return t(b,V)}),Nt&&xn(b,P),E}function y(b,x,w,S){var E=wl(w);if(typeof E!="function")throw Error(R(150));if(w=E.call(w),w==null)throw Error(R(151));for(var M=E=null,N=x,P=x=0,T=null,I=w.next();N!==null&&!I.done;P++,I=w.next()){N.index>P?(T=N,N=null):T=N.sibling;var V=f(b,N,I.value,S);if(V===null){N===null&&(N=T);break}e&&N&&V.alternate===null&&t(b,N),x=n(V,x,P),M===null?E=V:M.sibling=V,M=V,N=T}if(I.done)return s(b,N),Nt&&xn(b,P),E;if(N===null){for(;!I.done;P++,I=w.next())I=d(b,I.value,S),I!==null&&(x=n(I,x,P),M===null?E=I:M.sibling=I,M=I);return Nt&&xn(b,P),E}for(N=a(b,N);!I.done;P++,I=w.next())I=g(N,b,P,I.value,S),I!==null&&(e&&I.alternate!==null&&N.delete(I.key===null?P:I.key),x=n(I,x,P),M===null?E=I:M.sibling=I,M=I);return e&&N.forEach(function(rt){return t(b,rt)}),Nt&&xn(b,P),E}function A(b,x,w,S){if(typeof w=="object"&&w!==null&&w.type===go&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case eh:t:{for(var E=w.key,M=x;M!==null;){if(M.key===E){if(E=w.type,E===go){if(M.tag===7){s(b,M.sibling),x=i(M,w.props.children),x.return=b,b=x;break t}}else if(M.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Mi&&Hy(E)===M.type){s(b,M.sibling),x=i(M,w.props),x.ref=Sl(b,M,w),x.return=b,b=x;break t}s(b,M);break}else t(b,M);M=M.sibling}w.type===go?(x=fr(w.props.children,b.mode,S,w.key),x.return=b,b=x):(S=Oh(w.type,w.key,w.props,null,b.mode,S),S.ref=Sl(b,x,w),S.return=b,b=S)}return r(b);case po:t:{for(M=w.key;x!==null;){if(x.key===M)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){s(b,x.sibling),x=i(x,w.children||[]),x.return=b,b=x;break t}else{s(b,x);break}else t(b,x);x=x.sibling}x=bg(w,b.mode,S),x.return=b,b=x}return r(b);case Mi:return M=w._init,A(b,x,M(w._payload),S)}if(Ol(w))return v(b,x,w,S);if(wl(w))return y(b,x,w,S);dh(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(s(b,x.sibling),x=i(x,w),x.return=b,b=x):(s(b,x),x=vg(w,b.mode,S),x.return=b,b=x),r(b)):s(b,x)}return A}var ol=Rx(!0),Ix=Rx(!1),gf=vn(null),mf=null,_o=null,xb=null;function kb(){xb=_o=mf=null}function _b(e){var t=gf.current;At(gf),e._currentValue=t}function fm(e,t,s){for(;e!==null;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,a!==null&&(a.childLanes|=t)):a!==null&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===s)break;e=e.return}}function qo(e,t){mf=e,xb=_o=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qe=!0),e.firstContext=null)}function Ds(e){var t=e._currentValue;if(xb!==e)if(e={context:e,memoizedValue:t,next:null},_o===null){if(mf===null)throw Error(R(308));_o=e,mf.dependencies={lanes:0,firstContext:e}}else _o=_o.next=e;return t}var er=null;function Ab(e){er===null?er=[e]:er.push(e)}function Dx(e,t,s,a){var i=t.interleaved;return i===null?(s.next=s,Ab(t)):(s.next=i.next,i.next=s),t.interleaved=s,ri(e,a)}function ri(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Ni=!1;function Sb(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jx(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ai(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function rn(e,t,s){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,lt&2){var i=a.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),a.pending=t,ri(e,s)}return i=a.interleaved,i===null?(t.next=t,Ab(a)):(t.next=i.next,i.next=t),a.interleaved=t,ri(e,s)}function Lh(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var a=t.lanes;a&=e.pendingLanes,s|=a,t.lanes=s,ub(e,s)}}function Vy(e,t){var s=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var i=null,n=null;if(s=s.firstBaseUpdate,s!==null){do{var r={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};n===null?i=n=r:n=n.next=r,s=s.next}while(s!==null);n===null?i=n=t:n=n.next=t}else i=n=t;s={baseState:a.baseState,firstBaseUpdate:i,lastBaseUpdate:n,shared:a.shared,effects:a.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function vf(e,t,s,a){var i=e.updateQueue;Ni=!1;var n=i.firstBaseUpdate,r=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,r===null?n=u:r.next=u,r=c;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==r&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(n!==null){var d=i.baseState;r=0,h=u=c=null,l=n;do{var f=l.lane,g=l.eventTime;if((a&f)===f){h!==null&&(h=h.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});t:{var v=e,y=l;switch(f=t,g=s,y.tag){case 1:if(v=y.payload,typeof v=="function"){d=v.call(g,d,f);break t}d=v;break t;case 3:v.flags=v.flags&-65537|128;case 0:if(v=y.payload,f=typeof v=="function"?v.call(g,d,f):v,f==null)break t;d=Rt({},d,f);break t;case 2:Ni=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=i.effects,f===null?i.effects=[l]:f.push(l))}else g={eventTime:g,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=g,c=d):h=h.next=g,r|=f;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;f=l,l=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(h===null&&(c=d),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,t=i.shared.interleaved,t!==null){i=t;do r|=i.lane,i=i.next;while(i!==t)}else n===null&&(i.shared.lanes=0);vr|=r,e.lanes=r,e.memoizedState=d}}function Gy(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var a=e[t],i=a.callback;if(i!==null){if(a.callback=null,a=s,typeof i!="function")throw Error(R(191,i));i.call(a)}}}var Ku={},Ca=vn(Ku),Iu=vn(Ku),Du=vn(Ku);function sr(e){if(e===Ku)throw Error(R(174));return e}function Eb(e,t){switch(xt(Du,t),xt(Iu,e),xt(Ca,Ku),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:qg(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=qg(t,e)}At(Ca),xt(Ca,t)}function ll(){At(Ca),At(Iu),At(Du)}function Fx(e){sr(Du.current);var t=sr(Ca.current),s=qg(t,e.type);t!==s&&(xt(Iu,e),xt(Ca,s))}function Cb(e){Iu.current===e&&(At(Ca),At(Iu))}var Pt=vn(0);function bf(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var hg=[];function Mb(){for(var e=0;e<hg.length;e++)hg[e]._workInProgressVersionPrimary=null;hg.length=0}var Rh=li.ReactCurrentDispatcher,dg=li.ReactCurrentBatchConfig,mr=0,Tt=null,Kt=null,ee=null,yf=!1,Bc=!1,ju=0,sE=0;function ve(){throw Error(R(321))}function Nb(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!Zs(e[s],t[s]))return!1;return!0}function Pb(e,t,s,a,i,n){if(mr=n,Tt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Rh.current=e===null||e.memoizedState===null?rE:oE,e=s(a,i),Bc){n=0;do{if(Bc=!1,ju=0,25<=n)throw Error(R(301));n+=1,ee=Kt=null,t.updateQueue=null,Rh.current=lE,e=s(a,i)}while(Bc)}if(Rh.current=wf,t=Kt!==null&&Kt.next!==null,mr=0,ee=Kt=Tt=null,yf=!1,t)throw Error(R(300));return e}function Tb(){var e=ju!==0;return ju=0,e}function la(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ee===null?Tt.memoizedState=ee=e:ee=ee.next=e,ee}function js(){if(Kt===null){var e=Tt.alternate;e=e!==null?e.memoizedState:null}else e=Kt.next;var t=ee===null?Tt.memoizedState:ee.next;if(t!==null)ee=t,Kt=e;else{if(e===null)throw Error(R(310));Kt=e,e={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},ee===null?Tt.memoizedState=ee=e:ee=ee.next=e}return ee}function Fu(e,t){return typeof t=="function"?t(e):t}function fg(e){var t=js(),s=t.queue;if(s===null)throw Error(R(311));s.lastRenderedReducer=e;var a=Kt,i=a.baseQueue,n=s.pending;if(n!==null){if(i!==null){var r=i.next;i.next=n.next,n.next=r}a.baseQueue=i=n,s.pending=null}if(i!==null){n=i.next,a=a.baseState;var l=r=null,c=null,u=n;do{var h=u.lane;if((mr&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),a=u.hasEagerState?u.eagerState:e(a,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=d,r=a):c=c.next=d,Tt.lanes|=h,vr|=h}u=u.next}while(u!==null&&u!==n);c===null?r=a:c.next=l,Zs(a,t.memoizedState)||(Qe=!0),t.memoizedState=a,t.baseState=r,t.baseQueue=c,s.lastRenderedState=a}if(e=s.interleaved,e!==null){i=e;do n=i.lane,Tt.lanes|=n,vr|=n,i=i.next;while(i!==e)}else i===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function pg(e){var t=js(),s=t.queue;if(s===null)throw Error(R(311));s.lastRenderedReducer=e;var a=s.dispatch,i=s.pending,n=t.memoizedState;if(i!==null){s.pending=null;var r=i=i.next;do n=e(n,r.action),r=r.next;while(r!==i);Zs(n,t.memoizedState)||(Qe=!0),t.memoizedState=n,t.baseQueue===null&&(t.baseState=n),s.lastRenderedState=n}return[n,a]}function Ox(){}function Wx(e,t){var s=Tt,a=js(),i=t(),n=!Zs(a.memoizedState,i);if(n&&(a.memoizedState=i,Qe=!0),a=a.queue,Lb(Bx.bind(null,s,a,e),[e]),a.getSnapshot!==t||n||ee!==null&&ee.memoizedState.tag&1){if(s.flags|=2048,Ou(9,$x.bind(null,s,a,i,t),void 0,null),se===null)throw Error(R(349));mr&30||zx(s,t,i)}return i}function zx(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=Tt.updateQueue,t===null?(t={lastEffect:null,stores:null},Tt.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function $x(e,t,s,a){t.value=s,t.getSnapshot=a,Ux(t)&&Hx(e)}function Bx(e,t,s){return s(function(){Ux(t)&&Hx(e)})}function Ux(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Zs(e,s)}catch{return!0}}function Hx(e){var t=ri(e,1);t!==null&&Js(t,e,1,-1)}function qy(e){var t=la();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fu,lastRenderedState:e},t.queue=e,e=e.dispatch=nE.bind(null,Tt,e),[t.memoizedState,e]}function Ou(e,t,s,a){return e={tag:e,create:t,destroy:s,deps:a,next:null},t=Tt.updateQueue,t===null?(t={lastEffect:null,stores:null},Tt.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,t.lastEffect=e)),e}function Vx(){return js().memoizedState}function Ih(e,t,s,a){var i=la();Tt.flags|=e,i.memoizedState=Ou(1|t,s,void 0,a===void 0?null:a)}function Ep(e,t,s,a){var i=js();a=a===void 0?null:a;var n=void 0;if(Kt!==null){var r=Kt.memoizedState;if(n=r.destroy,a!==null&&Nb(a,r.deps)){i.memoizedState=Ou(t,s,n,a);return}}Tt.flags|=e,i.memoizedState=Ou(1|t,s,n,a)}function Xy(e,t){return Ih(8390656,8,e,t)}function Lb(e,t){return Ep(2048,8,e,t)}function Gx(e,t){return Ep(4,2,e,t)}function qx(e,t){return Ep(4,4,e,t)}function Xx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Yx(e,t,s){return s=s!=null?s.concat([e]):null,Ep(4,4,Xx.bind(null,t,e),s)}function Rb(){}function Kx(e,t){var s=js();t=t===void 0?null:t;var a=s.memoizedState;return a!==null&&t!==null&&Nb(t,a[1])?a[0]:(s.memoizedState=[e,t],e)}function Qx(e,t){var s=js();t=t===void 0?null:t;var a=s.memoizedState;return a!==null&&t!==null&&Nb(t,a[1])?a[0]:(e=e(),s.memoizedState=[e,t],e)}function Jx(e,t,s){return mr&21?(Zs(s,t)||(s=ax(),Tt.lanes|=s,vr|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qe=!0),e.memoizedState=s)}function aE(e,t){var s=mt;mt=s!==0&&4>s?s:4,e(!0);var a=dg.transition;dg.transition={};try{e(!1),t()}finally{mt=s,dg.transition=a}}function Zx(){return js().memoizedState}function iE(e,t,s){var a=ln(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},t1(e))e1(t,s);else if(s=Dx(e,t,s,a),s!==null){var i=Oe();Js(s,e,a,i),s1(s,t,a)}}function nE(e,t,s){var a=ln(e),i={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(t1(e))e1(t,i);else{var n=e.alternate;if(e.lanes===0&&(n===null||n.lanes===0)&&(n=t.lastRenderedReducer,n!==null))try{var r=t.lastRenderedState,l=n(r,s);if(i.hasEagerState=!0,i.eagerState=l,Zs(l,r)){var c=t.interleaved;c===null?(i.next=i,Ab(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}s=Dx(e,t,i,a),s!==null&&(i=Oe(),Js(s,e,a,i),s1(s,t,a))}}function t1(e){var t=e.alternate;return e===Tt||t!==null&&t===Tt}function e1(e,t){Bc=yf=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function s1(e,t,s){if(s&4194240){var a=t.lanes;a&=e.pendingLanes,s|=a,t.lanes=s,ub(e,s)}}var wf={readContext:Ds,useCallback:ve,useContext:ve,useEffect:ve,useImperativeHandle:ve,useInsertionEffect:ve,useLayoutEffect:ve,useMemo:ve,useReducer:ve,useRef:ve,useState:ve,useDebugValue:ve,useDeferredValue:ve,useTransition:ve,useMutableSource:ve,useSyncExternalStore:ve,useId:ve,unstable_isNewReconciler:!1},rE={readContext:Ds,useCallback:function(e,t){return la().memoizedState=[e,t===void 0?null:t],e},useContext:Ds,useEffect:Xy,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,Ih(4194308,4,Xx.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Ih(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ih(4,2,e,t)},useMemo:function(e,t){var s=la();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var a=la();return t=s!==void 0?s(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=iE.bind(null,Tt,e),[a.memoizedState,e]},useRef:function(e){var t=la();return e={current:e},t.memoizedState=e},useState:qy,useDebugValue:Rb,useDeferredValue:function(e){return la().memoizedState=e},useTransition:function(){var e=qy(!1),t=e[0];return e=aE.bind(null,e[1]),la().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var a=Tt,i=la();if(Nt){if(s===void 0)throw Error(R(407));s=s()}else{if(s=t(),se===null)throw Error(R(349));mr&30||zx(a,t,s)}i.memoizedState=s;var n={value:s,getSnapshot:t};return i.queue=n,Xy(Bx.bind(null,a,n,e),[e]),a.flags|=2048,Ou(9,$x.bind(null,a,n,s,t),void 0,null),s},useId:function(){var e=la(),t=se.identifierPrefix;if(Nt){var s=si,a=ei;s=(a&~(1<<32-Qs(a)-1)).toString(32)+s,t=":"+t+"R"+s,s=ju++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=sE++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oE={readContext:Ds,useCallback:Kx,useContext:Ds,useEffect:Lb,useImperativeHandle:Yx,useInsertionEffect:Gx,useLayoutEffect:qx,useMemo:Qx,useReducer:fg,useRef:Vx,useState:function(){return fg(Fu)},useDebugValue:Rb,useDeferredValue:function(e){var t=js();return Jx(t,Kt.memoizedState,e)},useTransition:function(){var e=fg(Fu)[0],t=js().memoizedState;return[e,t]},useMutableSource:Ox,useSyncExternalStore:Wx,useId:Zx,unstable_isNewReconciler:!1},lE={readContext:Ds,useCallback:Kx,useContext:Ds,useEffect:Lb,useImperativeHandle:Yx,useInsertionEffect:Gx,useLayoutEffect:qx,useMemo:Qx,useReducer:pg,useRef:Vx,useState:function(){return pg(Fu)},useDebugValue:Rb,useDeferredValue:function(e){var t=js();return Kt===null?t.memoizedState=e:Jx(t,Kt.memoizedState,e)},useTransition:function(){var e=pg(Fu)[0],t=js().memoizedState;return[e,t]},useMutableSource:Ox,useSyncExternalStore:Wx,useId:Zx,unstable_isNewReconciler:!1};function Gs(e,t){if(e&&e.defaultProps){t=Rt({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function pm(e,t,s,a){t=e.memoizedState,s=s(a,t),s=s==null?t:Rt({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Cp={isMounted:function(e){return(e=e._reactInternals)?_r(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var a=Oe(),i=ln(e),n=ai(a,i);n.payload=t,s!=null&&(n.callback=s),t=rn(e,n,i),t!==null&&(Js(t,e,i,a),Lh(t,e,i))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var a=Oe(),i=ln(e),n=ai(a,i);n.tag=1,n.payload=t,s!=null&&(n.callback=s),t=rn(e,n,i),t!==null&&(Js(t,e,i,a),Lh(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=Oe(),a=ln(e),i=ai(s,a);i.tag=2,t!=null&&(i.callback=t),t=rn(e,i,a),t!==null&&(Js(t,e,a,s),Lh(t,e,a))}};function Yy(e,t,s,a,i,n,r){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,n,r):t.prototype&&t.prototype.isPureReactComponent?!Pu(s,a)||!Pu(i,n):!0}function a1(e,t,s){var a=!1,i=dn,n=t.contextType;return typeof n=="object"&&n!==null?n=Ds(n):(i=ts(t)?pr:Pe.current,a=t.contextTypes,n=(a=a!=null)?nl(e,i):dn),t=new t(s,n),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Cp,e.stateNode=t,t._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=n),t}function Ky(e,t,s,a){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,a),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,a),t.state!==e&&Cp.enqueueReplaceState(t,t.state,null)}function gm(e,t,s,a){var i=e.stateNode;i.props=s,i.state=e.memoizedState,i.refs={},Sb(e);var n=t.contextType;typeof n=="object"&&n!==null?i.context=Ds(n):(n=ts(t)?pr:Pe.current,i.context=nl(e,n)),i.state=e.memoizedState,n=t.getDerivedStateFromProps,typeof n=="function"&&(pm(e,t,n,s),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Cp.enqueueReplaceState(i,i.state,null),vf(e,s,i,a),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function cl(e,t){try{var s="",a=t;do s+=jA(a),a=a.return;while(a);var i=s}catch(n){i=`
Error generating stack: `+n.message+`
`+n.stack}return{value:e,source:t,stack:i,digest:null}}function gg(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function mm(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var cE=typeof WeakMap=="function"?WeakMap:Map;function i1(e,t,s){s=ai(-1,s),s.tag=3,s.payload={element:null};var a=t.value;return s.callback=function(){kf||(kf=!0,Sm=a),mm(e,t)},s}function n1(e,t,s){s=ai(-1,s),s.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var i=t.value;s.payload=function(){return a(i)},s.callback=function(){mm(e,t)}}var n=e.stateNode;return n!==null&&typeof n.componentDidCatch=="function"&&(s.callback=function(){mm(e,t),typeof a!="function"&&(on===null?on=new Set([this]):on.add(this));var r=t.stack;this.componentDidCatch(t.value,{componentStack:r!==null?r:""})}),s}function Qy(e,t,s){var a=e.pingCache;if(a===null){a=e.pingCache=new cE;var i=new Set;a.set(t,i)}else i=a.get(t),i===void 0&&(i=new Set,a.set(t,i));i.has(s)||(i.add(s),e=_E.bind(null,e,t,s),t.then(e,e))}function Jy(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Zy(e,t,s,a,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=ai(-1,1),t.tag=2,rn(s,t,1))),s.lanes|=1),e)}var uE=li.ReactCurrentOwner,Qe=!1;function De(e,t,s,a){t.child=e===null?Ix(t,null,s,a):ol(t,e.child,s,a)}function tw(e,t,s,a,i){s=s.render;var n=t.ref;return qo(t,i),a=Pb(e,t,s,a,n,i),s=Tb(),e!==null&&!Qe?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,oi(e,t,i)):(Nt&&s&&bb(t),t.flags|=1,De(e,t,a,i),t.child)}function ew(e,t,s,a,i){if(e===null){var n=s.type;return typeof n=="function"&&!$b(n)&&n.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=n,r1(e,t,n,a,i)):(e=Oh(s.type,null,a,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(n=e.child,!(e.lanes&i)){var r=n.memoizedProps;if(s=s.compare,s=s!==null?s:Pu,s(r,a)&&e.ref===t.ref)return oi(e,t,i)}return t.flags|=1,e=cn(n,a),e.ref=t.ref,e.return=t,t.child=e}function r1(e,t,s,a,i){if(e!==null){var n=e.memoizedProps;if(Pu(n,a)&&e.ref===t.ref)if(Qe=!1,t.pendingProps=a=n,(e.lanes&i)!==0)e.flags&131072&&(Qe=!0);else return t.lanes=e.lanes,oi(e,t,i)}return vm(e,t,s,a,i)}function o1(e,t,s){var a=t.pendingProps,i=a.children,n=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xt(So,rs),rs|=s;else{if(!(s&1073741824))return e=n!==null?n.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xt(So,rs),rs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=n!==null?n.baseLanes:s,xt(So,rs),rs|=a}else n!==null?(a=n.baseLanes|s,t.memoizedState=null):a=s,xt(So,rs),rs|=a;return De(e,t,i,s),t.child}function l1(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function vm(e,t,s,a,i){var n=ts(s)?pr:Pe.current;return n=nl(t,n),qo(t,i),s=Pb(e,t,s,a,n,i),a=Tb(),e!==null&&!Qe?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,oi(e,t,i)):(Nt&&a&&bb(t),t.flags|=1,De(e,t,s,i),t.child)}function sw(e,t,s,a,i){if(ts(s)){var n=!0;df(t)}else n=!1;if(qo(t,i),t.stateNode===null)Dh(e,t),a1(t,s,a),gm(t,s,a,i),a=!0;else if(e===null){var r=t.stateNode,l=t.memoizedProps;r.props=l;var c=r.context,u=s.contextType;typeof u=="object"&&u!==null?u=Ds(u):(u=ts(s)?pr:Pe.current,u=nl(t,u));var h=s.getDerivedStateFromProps,d=typeof h=="function"||typeof r.getSnapshotBeforeUpdate=="function";d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(l!==a||c!==u)&&Ky(t,r,a,u),Ni=!1;var f=t.memoizedState;r.state=f,vf(t,a,r,i),c=t.memoizedState,l!==a||f!==c||Ze.current||Ni?(typeof h=="function"&&(pm(t,s,h,a),c=t.memoizedState),(l=Ni||Yy(t,s,l,a,f,c,u))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(t.flags|=4194308)):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=c),r.props=a,r.state=c,r.context=u,a=l):(typeof r.componentDidMount=="function"&&(t.flags|=4194308),a=!1)}else{r=t.stateNode,jx(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Gs(t.type,l),r.props=u,d=t.pendingProps,f=r.context,c=s.contextType,typeof c=="object"&&c!==null?c=Ds(c):(c=ts(s)?pr:Pe.current,c=nl(t,c));var g=s.getDerivedStateFromProps;(h=typeof g=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(l!==d||f!==c)&&Ky(t,r,a,c),Ni=!1,f=t.memoizedState,r.state=f,vf(t,a,r,i);var v=t.memoizedState;l!==d||f!==v||Ze.current||Ni?(typeof g=="function"&&(pm(t,s,g,a),v=t.memoizedState),(u=Ni||Yy(t,s,u,a,f,v,c)||!1)?(h||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(a,v,c),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(a,v,c)),typeof r.componentDidUpdate=="function"&&(t.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof r.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=v),r.props=a,r.state=v,r.context=c,a=u):(typeof r.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),a=!1)}return bm(e,t,s,a,n,i)}function bm(e,t,s,a,i,n){l1(e,t);var r=(t.flags&128)!==0;if(!a&&!r)return i&&$y(t,s,!1),oi(e,t,n);a=t.stateNode,uE.current=t;var l=r&&typeof s.getDerivedStateFromError!="function"?null:a.render();return t.flags|=1,e!==null&&r?(t.child=ol(t,e.child,null,n),t.child=ol(t,null,l,n)):De(e,t,l,n),t.memoizedState=a.state,i&&$y(t,s,!0),t.child}function c1(e){var t=e.stateNode;t.pendingContext?zy(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zy(e,t.context,!1),Eb(e,t.containerInfo)}function aw(e,t,s,a,i){return rl(),wb(i),t.flags|=256,De(e,t,s,a),t.child}var ym={dehydrated:null,treeContext:null,retryLane:0};function wm(e){return{baseLanes:e,cachePool:null,transitions:null}}function u1(e,t,s){var a=t.pendingProps,i=Pt.current,n=!1,r=(t.flags&128)!==0,l;if((l=r)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(n=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),xt(Pt,i&1),e===null)return dm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(r=a.children,e=a.fallback,n?(a=t.mode,n=t.child,r={mode:"hidden",children:r},!(a&1)&&n!==null?(n.childLanes=0,n.pendingProps=r):n=Pp(r,a,0,null),e=fr(e,a,s,null),n.return=t,e.return=t,n.sibling=e,t.child=n,t.child.memoizedState=wm(s),t.memoizedState=ym,e):Ib(t,r));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return hE(e,t,r,a,l,i,s);if(n){n=a.fallback,r=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:a.children};return!(r&1)&&t.child!==i?(a=t.child,a.childLanes=0,a.pendingProps=c,t.deletions=null):(a=cn(i,c),a.subtreeFlags=i.subtreeFlags&14680064),l!==null?n=cn(l,n):(n=fr(n,r,s,null),n.flags|=2),n.return=t,a.return=t,a.sibling=n,t.child=a,a=n,n=t.child,r=e.child.memoizedState,r=r===null?wm(s):{baseLanes:r.baseLanes|s,cachePool:null,transitions:r.transitions},n.memoizedState=r,n.childLanes=e.childLanes&~s,t.memoizedState=ym,a}return n=e.child,e=n.sibling,a=cn(n,{mode:"visible",children:a.children}),!(t.mode&1)&&(a.lanes=s),a.return=t,a.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=a,t.memoizedState=null,a}function Ib(e,t){return t=Pp({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function fh(e,t,s,a){return a!==null&&wb(a),ol(t,e.child,null,s),e=Ib(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function hE(e,t,s,a,i,n,r){if(s)return t.flags&256?(t.flags&=-257,a=gg(Error(R(422))),fh(e,t,r,a)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(n=a.fallback,i=t.mode,a=Pp({mode:"visible",children:a.children},i,0,null),n=fr(n,i,r,null),n.flags|=2,a.return=t,n.return=t,a.sibling=n,t.child=a,t.mode&1&&ol(t,e.child,null,r),t.child.memoizedState=wm(r),t.memoizedState=ym,n);if(!(t.mode&1))return fh(e,t,r,null);if(i.data==="$!"){if(a=i.nextSibling&&i.nextSibling.dataset,a)var l=a.dgst;return a=l,n=Error(R(419)),a=gg(n,a,void 0),fh(e,t,r,a)}if(l=(r&e.childLanes)!==0,Qe||l){if(a=se,a!==null){switch(r&-r){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(a.suspendedLanes|r)?0:i,i!==0&&i!==n.retryLane&&(n.retryLane=i,ri(e,i),Js(a,e,i,-1))}return zb(),a=gg(Error(R(421))),fh(e,t,r,a)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=AE.bind(null,e),i._reactRetry=t,null):(e=n.treeContext,us=nn(i.nextSibling),hs=t,Nt=!0,Ks=null,e!==null&&(Ts[Ls++]=ei,Ts[Ls++]=si,Ts[Ls++]=gr,ei=e.id,si=e.overflow,gr=t),t=Ib(t,a.children),t.flags|=4096,t)}function iw(e,t,s){e.lanes|=t;var a=e.alternate;a!==null&&(a.lanes|=t),fm(e.return,t,s)}function mg(e,t,s,a,i){var n=e.memoizedState;n===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:i}:(n.isBackwards=t,n.rendering=null,n.renderingStartTime=0,n.last=a,n.tail=s,n.tailMode=i)}function h1(e,t,s){var a=t.pendingProps,i=a.revealOrder,n=a.tail;if(De(e,t,a.children,s),a=Pt.current,a&2)a=a&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&iw(e,s,t);else if(e.tag===19)iw(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;e.sibling===null;){if(e.return===null||e.return===t)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(xt(Pt,a),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(s=t.child,i=null;s!==null;)e=s.alternate,e!==null&&bf(e)===null&&(i=s),s=s.sibling;s=i,s===null?(i=t.child,t.child=null):(i=s.sibling,s.sibling=null),mg(t,!1,i,s,n);break;case"backwards":for(s=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&bf(e)===null){t.child=i;break}e=i.sibling,i.sibling=s,s=i,i=e}mg(t,!0,s,null,n);break;case"together":mg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Dh(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function oi(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),vr|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(R(153));if(t.child!==null){for(e=t.child,s=cn(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=cn(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function dE(e,t,s){switch(t.tag){case 3:c1(t),rl();break;case 5:Fx(t);break;case 1:ts(t.type)&&df(t);break;case 4:Eb(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,i=t.memoizedProps.value;xt(gf,a._currentValue),a._currentValue=i;break;case 13:if(a=t.memoizedState,a!==null)return a.dehydrated!==null?(xt(Pt,Pt.current&1),t.flags|=128,null):s&t.child.childLanes?u1(e,t,s):(xt(Pt,Pt.current&1),e=oi(e,t,s),e!==null?e.sibling:null);xt(Pt,Pt.current&1);break;case 19:if(a=(s&t.childLanes)!==0,e.flags&128){if(a)return h1(e,t,s);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xt(Pt,Pt.current),a)break;return null;case 22:case 23:return t.lanes=0,o1(e,t,s)}return oi(e,t,s)}var d1,xm,f1,p1;d1=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};xm=function(){};f1=function(e,t,s,a){var i=e.memoizedProps;if(i!==a){e=t.stateNode,sr(Ca.current);var n=null;switch(s){case"input":i=Ug(e,i),a=Ug(e,a),n=[];break;case"select":i=Rt({},i,{value:void 0}),a=Rt({},a,{value:void 0}),n=[];break;case"textarea":i=Gg(e,i),a=Gg(e,a),n=[];break;default:typeof i.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=uf)}Xg(s,a);var r;s=null;for(u in i)if(!a.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(r in l)l.hasOwnProperty(r)&&(s||(s={}),s[r]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(_u.hasOwnProperty(u)?n||(n=[]):(n=n||[]).push(u,null));for(u in a){var c=a[u];if(l=i!=null?i[u]:void 0,a.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(s||(s={}),s[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(s||(s={}),s[r]=c[r])}else s||(n||(n=[]),n.push(u,s)),s=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(n=n||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(n=n||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(_u.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&kt("scroll",e),n||l===c||(n=[])):(n=n||[]).push(u,c))}s&&(n=n||[]).push("style",s);var u=n;(t.updateQueue=u)&&(t.flags|=4)}};p1=function(e,t,s,a){s!==a&&(t.flags|=4)};function El(e,t){if(!Nt)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function be(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,a=0;if(t)for(var i=e.child;i!==null;)s|=i.lanes|i.childLanes,a|=i.subtreeFlags&14680064,a|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)s|=i.lanes|i.childLanes,a|=i.subtreeFlags,a|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=a,e.childLanes=s,t}function fE(e,t,s){var a=t.pendingProps;switch(yb(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return be(t),null;case 1:return ts(t.type)&&hf(),be(t),null;case 3:return a=t.stateNode,ll(),At(Ze),At(Pe),Mb(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(hh(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ks!==null&&(Mm(Ks),Ks=null))),xm(e,t),be(t),null;case 5:Cb(t);var i=sr(Du.current);if(s=t.type,e!==null&&t.stateNode!=null)f1(e,t,s,a,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(t.stateNode===null)throw Error(R(166));return be(t),null}if(e=sr(Ca.current),hh(t)){a=t.stateNode,s=t.type;var n=t.memoizedProps;switch(a[_a]=t,a[Ru]=n,e=(t.mode&1)!==0,s){case"dialog":kt("cancel",a),kt("close",a);break;case"iframe":case"object":case"embed":kt("load",a);break;case"video":case"audio":for(i=0;i<zl.length;i++)kt(zl[i],a);break;case"source":kt("error",a);break;case"img":case"image":case"link":kt("error",a),kt("load",a);break;case"details":kt("toggle",a);break;case"input":fy(a,n),kt("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!n.multiple},kt("invalid",a);break;case"textarea":gy(a,n),kt("invalid",a)}Xg(s,n),i=null;for(var r in n)if(n.hasOwnProperty(r)){var l=n[r];r==="children"?typeof l=="string"?a.textContent!==l&&(n.suppressHydrationWarning!==!0&&uh(a.textContent,l,e),i=["children",l]):typeof l=="number"&&a.textContent!==""+l&&(n.suppressHydrationWarning!==!0&&uh(a.textContent,l,e),i=["children",""+l]):_u.hasOwnProperty(r)&&l!=null&&r==="onScroll"&&kt("scroll",a)}switch(s){case"input":sh(a),py(a,n,!0);break;case"textarea":sh(a),my(a);break;case"select":case"option":break;default:typeof n.onClick=="function"&&(a.onclick=uf)}a=i,t.updateQueue=a,a!==null&&(t.flags|=4)}else{r=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=B0(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=r.createElement(s,{is:a.is}):(e=r.createElement(s),s==="select"&&(r=e,a.multiple?r.multiple=!0:a.size&&(r.size=a.size))):e=r.createElementNS(e,s),e[_a]=t,e[Ru]=a,d1(e,t,!1,!1),t.stateNode=e;t:{switch(r=Yg(s,a),s){case"dialog":kt("cancel",e),kt("close",e),i=a;break;case"iframe":case"object":case"embed":kt("load",e),i=a;break;case"video":case"audio":for(i=0;i<zl.length;i++)kt(zl[i],e);i=a;break;case"source":kt("error",e),i=a;break;case"img":case"image":case"link":kt("error",e),kt("load",e),i=a;break;case"details":kt("toggle",e),i=a;break;case"input":fy(e,a),i=Ug(e,a),kt("invalid",e);break;case"option":i=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},i=Rt({},a,{value:void 0}),kt("invalid",e);break;case"textarea":gy(e,a),i=Gg(e,a),kt("invalid",e);break;default:i=a}Xg(s,i),l=i;for(n in l)if(l.hasOwnProperty(n)){var c=l[n];n==="style"?V0(e,c):n==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&U0(e,c)):n==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&Au(e,c):typeof c=="number"&&Au(e,""+c):n!=="suppressContentEditableWarning"&&n!=="suppressHydrationWarning"&&n!=="autoFocus"&&(_u.hasOwnProperty(n)?c!=null&&n==="onScroll"&&kt("scroll",e):c!=null&&ib(e,n,c,r))}switch(s){case"input":sh(e),py(e,a,!1);break;case"textarea":sh(e),my(e);break;case"option":a.value!=null&&e.setAttribute("value",""+hn(a.value));break;case"select":e.multiple=!!a.multiple,n=a.value,n!=null?Uo(e,!!a.multiple,n,!1):a.defaultValue!=null&&Uo(e,!!a.multiple,a.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=uf)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break t;case"img":a=!0;break t;default:a=!1}}a&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return be(t),null;case 6:if(e&&t.stateNode!=null)p1(e,t,e.memoizedProps,a);else{if(typeof a!="string"&&t.stateNode===null)throw Error(R(166));if(s=sr(Du.current),sr(Ca.current),hh(t)){if(a=t.stateNode,s=t.memoizedProps,a[_a]=t,(n=a.nodeValue!==s)&&(e=hs,e!==null))switch(e.tag){case 3:uh(a.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&uh(a.nodeValue,s,(e.mode&1)!==0)}n&&(t.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[_a]=t,t.stateNode=a}return be(t),null;case 13:if(At(Pt),a=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Nt&&us!==null&&t.mode&1&&!(t.flags&128))Lx(),rl(),t.flags|=98560,n=!1;else if(n=hh(t),a!==null&&a.dehydrated!==null){if(e===null){if(!n)throw Error(R(318));if(n=t.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(R(317));n[_a]=t}else rl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;be(t),n=!1}else Ks!==null&&(Mm(Ks),Ks=null),n=!0;if(!n)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(t.child.flags|=8192,t.mode&1&&(e===null||Pt.current&1?Qt===0&&(Qt=3):zb())),t.updateQueue!==null&&(t.flags|=4),be(t),null);case 4:return ll(),xm(e,t),e===null&&Tu(t.stateNode.containerInfo),be(t),null;case 10:return _b(t.type._context),be(t),null;case 17:return ts(t.type)&&hf(),be(t),null;case 19:if(At(Pt),n=t.memoizedState,n===null)return be(t),null;if(a=(t.flags&128)!==0,r=n.rendering,r===null)if(a)El(n,!1);else{if(Qt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(r=bf(e),r!==null){for(t.flags|=128,El(n,!1),a=r.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=s,s=t.child;s!==null;)n=s,e=a,n.flags&=14680066,r=n.alternate,r===null?(n.childLanes=0,n.lanes=e,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=r.childLanes,n.lanes=r.lanes,n.child=r.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=r.memoizedProps,n.memoizedState=r.memoizedState,n.updateQueue=r.updateQueue,n.type=r.type,e=r.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return xt(Pt,Pt.current&1|2),t.child}e=e.sibling}n.tail!==null&&Wt()>ul&&(t.flags|=128,a=!0,El(n,!1),t.lanes=4194304)}else{if(!a)if(e=bf(r),e!==null){if(t.flags|=128,a=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),El(n,!0),n.tail===null&&n.tailMode==="hidden"&&!r.alternate&&!Nt)return be(t),null}else 2*Wt()-n.renderingStartTime>ul&&s!==1073741824&&(t.flags|=128,a=!0,El(n,!1),t.lanes=4194304);n.isBackwards?(r.sibling=t.child,t.child=r):(s=n.last,s!==null?s.sibling=r:t.child=r,n.last=r)}return n.tail!==null?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=Wt(),t.sibling=null,s=Pt.current,xt(Pt,a?s&1|2:s&1),t):(be(t),null);case 22:case 23:return Wb(),a=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(t.flags|=8192),a&&t.mode&1?rs&1073741824&&(be(t),t.subtreeFlags&6&&(t.flags|=8192)):be(t),null;case 24:return null;case 25:return null}throw Error(R(156,t.tag))}function pE(e,t){switch(yb(t),t.tag){case 1:return ts(t.type)&&hf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ll(),At(Ze),At(Pe),Mb(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Cb(t),null;case 13:if(At(Pt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(R(340));rl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return At(Pt),null;case 4:return ll(),null;case 10:return _b(t.type._context),null;case 22:case 23:return Wb(),null;case 24:return null;default:return null}}var ph=!1,Me=!1,gE=typeof WeakSet=="function"?WeakSet:Set,W=null;function Ao(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){jt(e,t,a)}else s.current=null}function g1(e,t,s){try{s()}catch(a){jt(e,t,a)}}var nw=!1;function mE(e,t){if(nm=of,e=yx(),vb(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else t:{s=(s=e.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var i=a.anchorOffset,n=a.focusNode;a=a.focusOffset;try{s.nodeType,n.nodeType}catch{s=null;break t}var r=0,l=-1,c=-1,u=0,h=0,d=e,f=null;e:for(;;){for(var g;d!==s||i!==0&&d.nodeType!==3||(l=r+i),d!==n||a!==0&&d.nodeType!==3||(c=r+a),d.nodeType===3&&(r+=d.nodeValue.length),(g=d.firstChild)!==null;)f=d,d=g;for(;;){if(d===e)break e;if(f===s&&++u===i&&(l=r),f===n&&++h===a&&(c=r),(g=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=g}s=l===-1||c===-1?null:{start:l,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(rm={focusedElem:e,selectionRange:s},of=!1,W=t;W!==null;)if(t=W,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,W=e;else for(;W!==null;){t=W;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var y=v.memoizedProps,A=v.memoizedState,b=t.stateNode,x=b.getSnapshotBeforeUpdate(t.elementType===t.type?y:Gs(t.type,y),A);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(S){jt(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,W=e;break}W=t.return}return v=nw,nw=!1,v}function Uc(e,t,s){var a=t.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var i=a=a.next;do{if((i.tag&e)===e){var n=i.destroy;i.destroy=void 0,n!==void 0&&g1(t,s,n)}i=i.next}while(i!==a)}}function Mp(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==t)}}function km(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function m1(e){var t=e.alternate;t!==null&&(e.alternate=null,m1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[_a],delete t[Ru],delete t[cm],delete t[JS],delete t[ZS])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function v1(e){return e.tag===5||e.tag===3||e.tag===4}function rw(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||v1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _m(e,t,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=uf));else if(a!==4&&(e=e.child,e!==null))for(_m(e,t,s),e=e.sibling;e!==null;)_m(e,t,s),e=e.sibling}function Am(e,t,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Am(e,t,s),e=e.sibling;e!==null;)Am(e,t,s),e=e.sibling}var he=null,Xs=!1;function hi(e,t,s){for(s=s.child;s!==null;)b1(e,t,s),s=s.sibling}function b1(e,t,s){if(Ea&&typeof Ea.onCommitFiberUnmount=="function")try{Ea.onCommitFiberUnmount(wp,s)}catch{}switch(s.tag){case 5:Me||Ao(s,t);case 6:var a=he,i=Xs;he=null,hi(e,t,s),he=a,Xs=i,he!==null&&(Xs?(e=he,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):he.removeChild(s.stateNode));break;case 18:he!==null&&(Xs?(e=he,s=s.stateNode,e.nodeType===8?cg(e.parentNode,s):e.nodeType===1&&cg(e,s),Mu(e)):cg(he,s.stateNode));break;case 4:a=he,i=Xs,he=s.stateNode.containerInfo,Xs=!0,hi(e,t,s),he=a,Xs=i;break;case 0:case 11:case 14:case 15:if(!Me&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){i=a=a.next;do{var n=i,r=n.destroy;n=n.tag,r!==void 0&&(n&2||n&4)&&g1(s,t,r),i=i.next}while(i!==a)}hi(e,t,s);break;case 1:if(!Me&&(Ao(s,t),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(l){jt(s,t,l)}hi(e,t,s);break;case 21:hi(e,t,s);break;case 22:s.mode&1?(Me=(a=Me)||s.memoizedState!==null,hi(e,t,s),Me=a):hi(e,t,s);break;default:hi(e,t,s)}}function ow(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new gE),t.forEach(function(a){var i=SE.bind(null,e,a);s.has(a)||(s.add(a),a.then(i,i))})}}function Os(e,t){var s=t.deletions;if(s!==null)for(var a=0;a<s.length;a++){var i=s[a];try{var n=e,r=t,l=r;t:for(;l!==null;){switch(l.tag){case 5:he=l.stateNode,Xs=!1;break t;case 3:he=l.stateNode.containerInfo,Xs=!0;break t;case 4:he=l.stateNode.containerInfo,Xs=!0;break t}l=l.return}if(he===null)throw Error(R(160));b1(n,r,i),he=null,Xs=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){jt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)y1(t,e),t=t.sibling}function y1(e,t){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Os(t,e),sa(e),a&4){try{Uc(3,e,e.return),Mp(3,e)}catch(y){jt(e,e.return,y)}try{Uc(5,e,e.return)}catch(y){jt(e,e.return,y)}}break;case 1:Os(t,e),sa(e),a&512&&s!==null&&Ao(s,s.return);break;case 5:if(Os(t,e),sa(e),a&512&&s!==null&&Ao(s,s.return),e.flags&32){var i=e.stateNode;try{Au(i,"")}catch(y){jt(e,e.return,y)}}if(a&4&&(i=e.stateNode,i!=null)){var n=e.memoizedProps,r=s!==null?s.memoizedProps:n,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&n.type==="radio"&&n.name!=null&&z0(i,n),Yg(l,r);var u=Yg(l,n);for(r=0;r<c.length;r+=2){var h=c[r],d=c[r+1];h==="style"?V0(i,d):h==="dangerouslySetInnerHTML"?U0(i,d):h==="children"?Au(i,d):ib(i,h,d,u)}switch(l){case"input":Hg(i,n);break;case"textarea":$0(i,n);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!n.multiple;var g=n.value;g!=null?Uo(i,!!n.multiple,g,!1):f!==!!n.multiple&&(n.defaultValue!=null?Uo(i,!!n.multiple,n.defaultValue,!0):Uo(i,!!n.multiple,n.multiple?[]:"",!1))}i[Ru]=n}catch(y){jt(e,e.return,y)}}break;case 6:if(Os(t,e),sa(e),a&4){if(e.stateNode===null)throw Error(R(162));i=e.stateNode,n=e.memoizedProps;try{i.nodeValue=n}catch(y){jt(e,e.return,y)}}break;case 3:if(Os(t,e),sa(e),a&4&&s!==null&&s.memoizedState.isDehydrated)try{Mu(t.containerInfo)}catch(y){jt(e,e.return,y)}break;case 4:Os(t,e),sa(e);break;case 13:Os(t,e),sa(e),i=e.child,i.flags&8192&&(n=i.memoizedState!==null,i.stateNode.isHidden=n,!n||i.alternate!==null&&i.alternate.memoizedState!==null||(Fb=Wt())),a&4&&ow(e);break;case 22:if(h=s!==null&&s.memoizedState!==null,e.mode&1?(Me=(u=Me)||h,Os(t,e),Me=u):Os(t,e),sa(e),a&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!h&&e.mode&1)for(W=e,h=e.child;h!==null;){for(d=W=h;W!==null;){switch(f=W,g=f.child,f.tag){case 0:case 11:case 14:case 15:Uc(4,f,f.return);break;case 1:Ao(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){a=f,s=f.return;try{t=a,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(y){jt(a,s,y)}}break;case 5:Ao(f,f.return);break;case 22:if(f.memoizedState!==null){cw(d);continue}}g!==null?(g.return=f,W=g):cw(d)}h=h.sibling}t:for(h=null,d=e;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,u?(n=i.style,typeof n.setProperty=="function"?n.setProperty("display","none","important"):n.display="none"):(l=d.stateNode,c=d.memoizedProps.style,r=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=H0("display",r))}catch(y){jt(e,e.return,y)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(y){jt(e,e.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break t;for(;d.sibling===null;){if(d.return===null||d.return===e)break t;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Os(t,e),sa(e),a&4&&ow(e);break;case 21:break;default:Os(t,e),sa(e)}}function sa(e){var t=e.flags;if(t&2){try{t:{for(var s=e.return;s!==null;){if(v1(s)){var a=s;break t}s=s.return}throw Error(R(160))}switch(a.tag){case 5:var i=a.stateNode;a.flags&32&&(Au(i,""),a.flags&=-33);var n=rw(e);Am(e,n,i);break;case 3:case 4:var r=a.stateNode.containerInfo,l=rw(e);_m(e,l,r);break;default:throw Error(R(161))}}catch(c){jt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function vE(e,t,s){W=e,w1(e)}function w1(e,t,s){for(var a=(e.mode&1)!==0;W!==null;){var i=W,n=i.child;if(i.tag===22&&a){var r=i.memoizedState!==null||ph;if(!r){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Me;l=ph;var u=Me;if(ph=r,(Me=c)&&!u)for(W=i;W!==null;)r=W,c=r.child,r.tag===22&&r.memoizedState!==null?uw(i):c!==null?(c.return=r,W=c):uw(i);for(;n!==null;)W=n,w1(n),n=n.sibling;W=i,ph=l,Me=u}lw(e)}else i.subtreeFlags&8772&&n!==null?(n.return=i,W=n):lw(e)}}function lw(e){for(;W!==null;){var t=W;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Me||Mp(5,t);break;case 1:var a=t.stateNode;if(t.flags&4&&!Me)if(s===null)a.componentDidMount();else{var i=t.elementType===t.type?s.memoizedProps:Gs(t.type,s.memoizedProps);a.componentDidUpdate(i,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var n=t.updateQueue;n!==null&&Gy(t,n,a);break;case 3:var r=t.updateQueue;if(r!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}Gy(t,r,s)}break;case 5:var l=t.stateNode;if(s===null&&t.flags&4){s=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Mu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}Me||t.flags&512&&km(t)}catch(f){jt(t,t.return,f)}}if(t===e){W=null;break}if(s=t.sibling,s!==null){s.return=t.return,W=s;break}W=t.return}}function cw(e){for(;W!==null;){var t=W;if(t===e){W=null;break}var s=t.sibling;if(s!==null){s.return=t.return,W=s;break}W=t.return}}function uw(e){for(;W!==null;){var t=W;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{Mp(4,t)}catch(c){jt(t,s,c)}break;case 1:var a=t.stateNode;if(typeof a.componentDidMount=="function"){var i=t.return;try{a.componentDidMount()}catch(c){jt(t,i,c)}}var n=t.return;try{km(t)}catch(c){jt(t,n,c)}break;case 5:var r=t.return;try{km(t)}catch(c){jt(t,r,c)}}}catch(c){jt(t,t.return,c)}if(t===e){W=null;break}var l=t.sibling;if(l!==null){l.return=t.return,W=l;break}W=t.return}}var bE=Math.ceil,xf=li.ReactCurrentDispatcher,Db=li.ReactCurrentOwner,Is=li.ReactCurrentBatchConfig,lt=0,se=null,Ht=null,pe=0,rs=0,So=vn(0),Qt=0,Wu=null,vr=0,Np=0,jb=0,Hc=null,Ke=null,Fb=0,ul=1/0,Ba=null,kf=!1,Sm=null,on=null,gh=!1,Xi=null,_f=0,Vc=0,Em=null,jh=-1,Fh=0;function Oe(){return lt&6?Wt():jh!==-1?jh:jh=Wt()}function ln(e){return e.mode&1?lt&2&&pe!==0?pe&-pe:eE.transition!==null?(Fh===0&&(Fh=ax()),Fh):(e=mt,e!==0||(e=window.event,e=e===void 0?16:ux(e.type)),e):1}function Js(e,t,s,a){if(50<Vc)throw Vc=0,Em=null,Error(R(185));qu(e,s,a),(!(lt&2)||e!==se)&&(e===se&&(!(lt&2)&&(Np|=s),Qt===4&&Oi(e,pe)),es(e,a),s===1&&lt===0&&!(t.mode&1)&&(ul=Wt()+500,Sp&&bn()))}function es(e,t){var s=e.callbackNode;eS(e,t);var a=rf(e,e===se?pe:0);if(a===0)s!==null&&yy(s),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(s!=null&&yy(s),t===1)e.tag===0?tE(hw.bind(null,e)):Nx(hw.bind(null,e)),KS(function(){!(lt&6)&&bn()}),s=null;else{switch(ix(a)){case 1:s=cb;break;case 4:s=ex;break;case 16:s=nf;break;case 536870912:s=sx;break;default:s=nf}s=M1(s,x1.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function x1(e,t){if(jh=-1,Fh=0,lt&6)throw Error(R(327));var s=e.callbackNode;if(Xo()&&e.callbackNode!==s)return null;var a=rf(e,e===se?pe:0);if(a===0)return null;if(a&30||a&e.expiredLanes||t)t=Af(e,a);else{t=a;var i=lt;lt|=2;var n=_1();(se!==e||pe!==t)&&(Ba=null,ul=Wt()+500,dr(e,t));do try{xE();break}catch(l){k1(e,l)}while(!0);kb(),xf.current=n,lt=i,Ht!==null?t=0:(se=null,pe=0,t=Qt)}if(t!==0){if(t===2&&(i=tm(e),i!==0&&(a=i,t=Cm(e,i))),t===1)throw s=Wu,dr(e,0),Oi(e,a),es(e,Wt()),s;if(t===6)Oi(e,a);else{if(i=e.current.alternate,!(a&30)&&!yE(i)&&(t=Af(e,a),t===2&&(n=tm(e),n!==0&&(a=n,t=Cm(e,n))),t===1))throw s=Wu,dr(e,0),Oi(e,a),es(e,Wt()),s;switch(e.finishedWork=i,e.finishedLanes=a,t){case 0:case 1:throw Error(R(345));case 2:kn(e,Ke,Ba);break;case 3:if(Oi(e,a),(a&130023424)===a&&(t=Fb+500-Wt(),10<t)){if(rf(e,0)!==0)break;if(i=e.suspendedLanes,(i&a)!==a){Oe(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=lm(kn.bind(null,e,Ke,Ba),t);break}kn(e,Ke,Ba);break;case 4:if(Oi(e,a),(a&4194240)===a)break;for(t=e.eventTimes,i=-1;0<a;){var r=31-Qs(a);n=1<<r,r=t[r],r>i&&(i=r),a&=~n}if(a=i,a=Wt()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*bE(a/1960))-a,10<a){e.timeoutHandle=lm(kn.bind(null,e,Ke,Ba),a);break}kn(e,Ke,Ba);break;case 5:kn(e,Ke,Ba);break;default:throw Error(R(329))}}}return es(e,Wt()),e.callbackNode===s?x1.bind(null,e):null}function Cm(e,t){var s=Hc;return e.current.memoizedState.isDehydrated&&(dr(e,t).flags|=256),e=Af(e,t),e!==2&&(t=Ke,Ke=s,t!==null&&Mm(t)),e}function Mm(e){Ke===null?Ke=e:Ke.push.apply(Ke,e)}function yE(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var i=s[a],n=i.getSnapshot;i=i.value;try{if(!Zs(n(),i))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Oi(e,t){for(t&=~jb,t&=~Np,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Qs(t),a=1<<s;e[s]=-1,t&=~a}}function hw(e){if(lt&6)throw Error(R(327));Xo();var t=rf(e,0);if(!(t&1))return es(e,Wt()),null;var s=Af(e,t);if(e.tag!==0&&s===2){var a=tm(e);a!==0&&(t=a,s=Cm(e,a))}if(s===1)throw s=Wu,dr(e,0),Oi(e,t),es(e,Wt()),s;if(s===6)throw Error(R(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kn(e,Ke,Ba),es(e,Wt()),null}function Ob(e,t){var s=lt;lt|=1;try{return e(t)}finally{lt=s,lt===0&&(ul=Wt()+500,Sp&&bn())}}function br(e){Xi!==null&&Xi.tag===0&&!(lt&6)&&Xo();var t=lt;lt|=1;var s=Is.transition,a=mt;try{if(Is.transition=null,mt=1,e)return e()}finally{mt=a,Is.transition=s,lt=t,!(lt&6)&&bn()}}function Wb(){rs=So.current,At(So)}function dr(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,YS(s)),Ht!==null)for(s=Ht.return;s!==null;){var a=s;switch(yb(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&hf();break;case 3:ll(),At(Ze),At(Pe),Mb();break;case 5:Cb(a);break;case 4:ll();break;case 13:At(Pt);break;case 19:At(Pt);break;case 10:_b(a.type._context);break;case 22:case 23:Wb()}s=s.return}if(se=e,Ht=e=cn(e.current,null),pe=rs=t,Qt=0,Wu=null,jb=Np=vr=0,Ke=Hc=null,er!==null){for(t=0;t<er.length;t++)if(s=er[t],a=s.interleaved,a!==null){s.interleaved=null;var i=a.next,n=s.pending;if(n!==null){var r=n.next;n.next=i,a.next=r}s.pending=a}er=null}return e}function k1(e,t){do{var s=Ht;try{if(kb(),Rh.current=wf,yf){for(var a=Tt.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}yf=!1}if(mr=0,ee=Kt=Tt=null,Bc=!1,ju=0,Db.current=null,s===null||s.return===null){Qt=1,Wu=t,Ht=null;break}t:{var n=e,r=s.return,l=s,c=t;if(t=pe,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=Jy(r);if(g!==null){g.flags&=-257,Zy(g,r,l,n,t),g.mode&1&&Qy(n,u,t),t=g,c=u;var v=t.updateQueue;if(v===null){var y=new Set;y.add(c),t.updateQueue=y}else v.add(c);break t}else{if(!(t&1)){Qy(n,u,t),zb();break t}c=Error(R(426))}}else if(Nt&&l.mode&1){var A=Jy(r);if(A!==null){!(A.flags&65536)&&(A.flags|=256),Zy(A,r,l,n,t),wb(cl(c,l));break t}}n=c=cl(c,l),Qt!==4&&(Qt=2),Hc===null?Hc=[n]:Hc.push(n),n=r;do{switch(n.tag){case 3:n.flags|=65536,t&=-t,n.lanes|=t;var b=i1(n,c,t);Vy(n,b);break t;case 1:l=c;var x=n.type,w=n.stateNode;if(!(n.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(on===null||!on.has(w)))){n.flags|=65536,t&=-t,n.lanes|=t;var S=n1(n,l,t);Vy(n,S);break t}}n=n.return}while(n!==null)}S1(s)}catch(E){t=E,Ht===s&&s!==null&&(Ht=s=s.return);continue}break}while(!0)}function _1(){var e=xf.current;return xf.current=wf,e===null?wf:e}function zb(){(Qt===0||Qt===3||Qt===2)&&(Qt=4),se===null||!(vr&268435455)&&!(Np&268435455)||Oi(se,pe)}function Af(e,t){var s=lt;lt|=2;var a=_1();(se!==e||pe!==t)&&(Ba=null,dr(e,t));do try{wE();break}catch(i){k1(e,i)}while(!0);if(kb(),lt=s,xf.current=a,Ht!==null)throw Error(R(261));return se=null,pe=0,Qt}function wE(){for(;Ht!==null;)A1(Ht)}function xE(){for(;Ht!==null&&!GA();)A1(Ht)}function A1(e){var t=C1(e.alternate,e,rs);e.memoizedProps=e.pendingProps,t===null?S1(e):Ht=t,Db.current=null}function S1(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=pE(s,t),s!==null){s.flags&=32767,Ht=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Qt=6,Ht=null;return}}else if(s=fE(s,t,rs),s!==null){Ht=s;return}if(t=t.sibling,t!==null){Ht=t;return}Ht=t=e}while(t!==null);Qt===0&&(Qt=5)}function kn(e,t,s){var a=mt,i=Is.transition;try{Is.transition=null,mt=1,kE(e,t,s,a)}finally{Is.transition=i,mt=a}return null}function kE(e,t,s,a){do Xo();while(Xi!==null);if(lt&6)throw Error(R(327));s=e.finishedWork;var i=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(R(177));e.callbackNode=null,e.callbackPriority=0;var n=s.lanes|s.childLanes;if(sS(e,n),e===se&&(Ht=se=null,pe=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||gh||(gh=!0,M1(nf,function(){return Xo(),null})),n=(s.flags&15990)!==0,s.subtreeFlags&15990||n){n=Is.transition,Is.transition=null;var r=mt;mt=1;var l=lt;lt|=4,Db.current=null,mE(e,s),y1(s,e),BS(rm),of=!!nm,rm=nm=null,e.current=s,vE(s),qA(),lt=l,mt=r,Is.transition=n}else e.current=s;if(gh&&(gh=!1,Xi=e,_f=i),n=e.pendingLanes,n===0&&(on=null),KA(s.stateNode),es(e,Wt()),t!==null)for(a=e.onRecoverableError,s=0;s<t.length;s++)i=t[s],a(i.value,{componentStack:i.stack,digest:i.digest});if(kf)throw kf=!1,e=Sm,Sm=null,e;return _f&1&&e.tag!==0&&Xo(),n=e.pendingLanes,n&1?e===Em?Vc++:(Vc=0,Em=e):Vc=0,bn(),null}function Xo(){if(Xi!==null){var e=ix(_f),t=Is.transition,s=mt;try{if(Is.transition=null,mt=16>e?16:e,Xi===null)var a=!1;else{if(e=Xi,Xi=null,_f=0,lt&6)throw Error(R(331));var i=lt;for(lt|=4,W=e.current;W!==null;){var n=W,r=n.child;if(W.flags&16){var l=n.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(W=u;W!==null;){var h=W;switch(h.tag){case 0:case 11:case 15:Uc(8,h,n)}var d=h.child;if(d!==null)d.return=h,W=d;else for(;W!==null;){h=W;var f=h.sibling,g=h.return;if(m1(h),h===u){W=null;break}if(f!==null){f.return=g,W=f;break}W=g}}}var v=n.alternate;if(v!==null){var y=v.child;if(y!==null){v.child=null;do{var A=y.sibling;y.sibling=null,y=A}while(y!==null)}}W=n}}if(n.subtreeFlags&2064&&r!==null)r.return=n,W=r;else t:for(;W!==null;){if(n=W,n.flags&2048)switch(n.tag){case 0:case 11:case 15:Uc(9,n,n.return)}var b=n.sibling;if(b!==null){b.return=n.return,W=b;break t}W=n.return}}var x=e.current;for(W=x;W!==null;){r=W;var w=r.child;if(r.subtreeFlags&2064&&w!==null)w.return=r,W=w;else t:for(r=x;W!==null;){if(l=W,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Mp(9,l)}}catch(E){jt(l,l.return,E)}if(l===r){W=null;break t}var S=l.sibling;if(S!==null){S.return=l.return,W=S;break t}W=l.return}}if(lt=i,bn(),Ea&&typeof Ea.onPostCommitFiberRoot=="function")try{Ea.onPostCommitFiberRoot(wp,e)}catch{}a=!0}return a}finally{mt=s,Is.transition=t}}return!1}function dw(e,t,s){t=cl(s,t),t=i1(e,t,1),e=rn(e,t,1),t=Oe(),e!==null&&(qu(e,1,t),es(e,t))}function jt(e,t,s){if(e.tag===3)dw(e,e,s);else for(;t!==null;){if(t.tag===3){dw(t,e,s);break}else if(t.tag===1){var a=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(on===null||!on.has(a))){e=cl(s,e),e=n1(t,e,1),t=rn(t,e,1),e=Oe(),t!==null&&(qu(t,1,e),es(t,e));break}}t=t.return}}function _E(e,t,s){var a=e.pingCache;a!==null&&a.delete(t),t=Oe(),e.pingedLanes|=e.suspendedLanes&s,se===e&&(pe&s)===s&&(Qt===4||Qt===3&&(pe&130023424)===pe&&500>Wt()-Fb?dr(e,0):jb|=s),es(e,t)}function E1(e,t){t===0&&(e.mode&1?(t=nh,nh<<=1,!(nh&130023424)&&(nh=4194304)):t=1);var s=Oe();e=ri(e,t),e!==null&&(qu(e,t,s),es(e,s))}function AE(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),E1(e,s)}function SE(e,t){var s=0;switch(e.tag){case 13:var a=e.stateNode,i=e.memoizedState;i!==null&&(s=i.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(R(314))}a!==null&&a.delete(t),E1(e,s)}var C1;C1=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ze.current)Qe=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return Qe=!1,dE(e,t,s);Qe=!!(e.flags&131072)}else Qe=!1,Nt&&t.flags&1048576&&Px(t,pf,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Dh(e,t),e=t.pendingProps;var i=nl(t,Pe.current);qo(t,s),i=Pb(null,t,a,e,i,s);var n=Tb();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ts(a)?(n=!0,df(t)):n=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Sb(t),i.updater=Cp,t.stateNode=i,i._reactInternals=t,gm(t,a,e,s),t=bm(null,t,a,!0,n,s)):(t.tag=0,Nt&&n&&bb(t),De(null,t,i,s),t=t.child),t;case 16:a=t.elementType;t:{switch(Dh(e,t),e=t.pendingProps,i=a._init,a=i(a._payload),t.type=a,i=t.tag=CE(a),e=Gs(a,e),i){case 0:t=vm(null,t,a,e,s);break t;case 1:t=sw(null,t,a,e,s);break t;case 11:t=tw(null,t,a,e,s);break t;case 14:t=ew(null,t,a,Gs(a.type,e),s);break t}throw Error(R(306,a,""))}return t;case 0:return a=t.type,i=t.pendingProps,i=t.elementType===a?i:Gs(a,i),vm(e,t,a,i,s);case 1:return a=t.type,i=t.pendingProps,i=t.elementType===a?i:Gs(a,i),sw(e,t,a,i,s);case 3:t:{if(c1(t),e===null)throw Error(R(387));a=t.pendingProps,n=t.memoizedState,i=n.element,jx(e,t),vf(t,a,null,s);var r=t.memoizedState;if(a=r.element,n.isDehydrated)if(n={element:a,isDehydrated:!1,cache:r.cache,pendingSuspenseBoundaries:r.pendingSuspenseBoundaries,transitions:r.transitions},t.updateQueue.baseState=n,t.memoizedState=n,t.flags&256){i=cl(Error(R(423)),t),t=aw(e,t,a,s,i);break t}else if(a!==i){i=cl(Error(R(424)),t),t=aw(e,t,a,s,i);break t}else for(us=nn(t.stateNode.containerInfo.firstChild),hs=t,Nt=!0,Ks=null,s=Ix(t,null,a,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(rl(),a===i){t=oi(e,t,s);break t}De(e,t,a,s)}t=t.child}return t;case 5:return Fx(t),e===null&&dm(t),a=t.type,i=t.pendingProps,n=e!==null?e.memoizedProps:null,r=i.children,om(a,i)?r=null:n!==null&&om(a,n)&&(t.flags|=32),l1(e,t),De(e,t,r,s),t.child;case 6:return e===null&&dm(t),null;case 13:return u1(e,t,s);case 4:return Eb(t,t.stateNode.containerInfo),a=t.pendingProps,e===null?t.child=ol(t,null,a,s):De(e,t,a,s),t.child;case 11:return a=t.type,i=t.pendingProps,i=t.elementType===a?i:Gs(a,i),tw(e,t,a,i,s);case 7:return De(e,t,t.pendingProps,s),t.child;case 8:return De(e,t,t.pendingProps.children,s),t.child;case 12:return De(e,t,t.pendingProps.children,s),t.child;case 10:t:{if(a=t.type._context,i=t.pendingProps,n=t.memoizedProps,r=i.value,xt(gf,a._currentValue),a._currentValue=r,n!==null)if(Zs(n.value,r)){if(n.children===i.children&&!Ze.current){t=oi(e,t,s);break t}}else for(n=t.child,n!==null&&(n.return=t);n!==null;){var l=n.dependencies;if(l!==null){r=n.child;for(var c=l.firstContext;c!==null;){if(c.context===a){if(n.tag===1){c=ai(-1,s&-s),c.tag=2;var u=n.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}n.lanes|=s,c=n.alternate,c!==null&&(c.lanes|=s),fm(n.return,s,t),l.lanes|=s;break}c=c.next}}else if(n.tag===10)r=n.type===t.type?null:n.child;else if(n.tag===18){if(r=n.return,r===null)throw Error(R(341));r.lanes|=s,l=r.alternate,l!==null&&(l.lanes|=s),fm(r,s,t),r=n.sibling}else r=n.child;if(r!==null)r.return=n;else for(r=n;r!==null;){if(r===t){r=null;break}if(n=r.sibling,n!==null){n.return=r.return,r=n;break}r=r.return}n=r}De(e,t,i.children,s),t=t.child}return t;case 9:return i=t.type,a=t.pendingProps.children,qo(t,s),i=Ds(i),a=a(i),t.flags|=1,De(e,t,a,s),t.child;case 14:return a=t.type,i=Gs(a,t.pendingProps),i=Gs(a.type,i),ew(e,t,a,i,s);case 15:return r1(e,t,t.type,t.pendingProps,s);case 17:return a=t.type,i=t.pendingProps,i=t.elementType===a?i:Gs(a,i),Dh(e,t),t.tag=1,ts(a)?(e=!0,df(t)):e=!1,qo(t,s),a1(t,a,i),gm(t,a,i,s),bm(null,t,a,!0,e,s);case 19:return h1(e,t,s);case 22:return o1(e,t,s)}throw Error(R(156,t.tag))};function M1(e,t){return tx(e,t)}function EE(e,t,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rs(e,t,s,a){return new EE(e,t,s,a)}function $b(e){return e=e.prototype,!(!e||!e.isReactComponent)}function CE(e){if(typeof e=="function")return $b(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rb)return 11;if(e===ob)return 14}return 2}function cn(e,t){var s=e.alternate;return s===null?(s=Rs(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Oh(e,t,s,a,i,n){var r=2;if(a=e,typeof e=="function")$b(e)&&(r=1);else if(typeof e=="string")r=5;else t:switch(e){case go:return fr(s.children,i,n,t);case nb:r=8,i|=8;break;case Wg:return e=Rs(12,s,t,i|2),e.elementType=Wg,e.lanes=n,e;case zg:return e=Rs(13,s,t,i),e.elementType=zg,e.lanes=n,e;case $g:return e=Rs(19,s,t,i),e.elementType=$g,e.lanes=n,e;case F0:return Pp(s,i,n,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case D0:r=10;break t;case j0:r=9;break t;case rb:r=11;break t;case ob:r=14;break t;case Mi:r=16,a=null;break t}throw Error(R(130,e==null?e:typeof e,""))}return t=Rs(r,s,t,i),t.elementType=e,t.type=a,t.lanes=n,t}function fr(e,t,s,a){return e=Rs(7,e,a,t),e.lanes=s,e}function Pp(e,t,s,a){return e=Rs(22,e,a,t),e.elementType=F0,e.lanes=s,e.stateNode={isHidden:!1},e}function vg(e,t,s){return e=Rs(6,e,null,t),e.lanes=s,e}function bg(e,t,s){return t=Rs(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ME(e,t,s,a,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jp(0),this.expirationTimes=Jp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jp(0),this.identifierPrefix=a,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bb(e,t,s,a,i,n,r,l,c){return e=new ME(e,t,s,l,c),t===1?(t=1,n===!0&&(t|=8)):t=0,n=Rs(3,null,null,t),e.current=n,n.stateNode=e,n.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sb(n),e}function NE(e,t,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:po,key:a==null?null:""+a,children:e,containerInfo:t,implementation:s}}function N1(e){if(!e)return dn;e=e._reactInternals;t:{if(_r(e)!==e||e.tag!==1)throw Error(R(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break t;case 1:if(ts(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break t}}t=t.return}while(t!==null);throw Error(R(171))}if(e.tag===1){var s=e.type;if(ts(s))return Mx(e,s,t)}return t}function P1(e,t,s,a,i,n,r,l,c){return e=Bb(s,a,!0,e,i,n,r,l,c),e.context=N1(null),s=e.current,a=Oe(),i=ln(s),n=ai(a,i),n.callback=t??null,rn(s,n,i),e.current.lanes=i,qu(e,i,a),es(e,a),e}function Tp(e,t,s,a){var i=t.current,n=Oe(),r=ln(i);return s=N1(s),t.context===null?t.context=s:t.pendingContext=s,t=ai(n,r),t.payload={element:e},a=a===void 0?null:a,a!==null&&(t.callback=a),e=rn(i,t,r),e!==null&&(Js(e,i,r,n),Lh(e,i,r)),r}function Sf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function Ub(e,t){fw(e,t),(e=e.alternate)&&fw(e,t)}function PE(){return null}var T1=typeof reportError=="function"?reportError:function(e){console.error(e)};function Hb(e){this._internalRoot=e}Lp.prototype.render=Hb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(R(409));Tp(e,t,null,null)};Lp.prototype.unmount=Hb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;br(function(){Tp(null,e,null,null)}),t[ni]=null}};function Lp(e){this._internalRoot=e}Lp.prototype.unstable_scheduleHydration=function(e){if(e){var t=ox();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Fi.length&&t!==0&&t<Fi[s].priority;s++);Fi.splice(s,0,e),s===0&&cx(e)}};function Vb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pw(){}function TE(e,t,s,a,i){if(i){if(typeof a=="function"){var n=a;a=function(){var u=Sf(r);n.call(u)}}var r=P1(t,a,e,0,null,!1,!1,"",pw);return e._reactRootContainer=r,e[ni]=r.current,Tu(e.nodeType===8?e.parentNode:e),br(),r}for(;i=e.lastChild;)e.removeChild(i);if(typeof a=="function"){var l=a;a=function(){var u=Sf(c);l.call(u)}}var c=Bb(e,0,!1,null,null,!1,!1,"",pw);return e._reactRootContainer=c,e[ni]=c.current,Tu(e.nodeType===8?e.parentNode:e),br(function(){Tp(t,c,s,a)}),c}function Ip(e,t,s,a,i){var n=s._reactRootContainer;if(n){var r=n;if(typeof i=="function"){var l=i;i=function(){var c=Sf(r);l.call(c)}}Tp(t,r,e,i)}else r=TE(s,t,e,i,a);return Sf(r)}nx=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=Wl(t.pendingLanes);s!==0&&(ub(t,s|1),es(t,Wt()),!(lt&6)&&(ul=Wt()+500,bn()))}break;case 13:br(function(){var a=ri(e,1);if(a!==null){var i=Oe();Js(a,e,1,i)}}),Ub(e,1)}};hb=function(e){if(e.tag===13){var t=ri(e,134217728);if(t!==null){var s=Oe();Js(t,e,134217728,s)}Ub(e,134217728)}};rx=function(e){if(e.tag===13){var t=ln(e),s=ri(e,t);if(s!==null){var a=Oe();Js(s,e,t,a)}Ub(e,t)}};ox=function(){return mt};lx=function(e,t){var s=mt;try{return mt=e,t()}finally{mt=s}};Qg=function(e,t,s){switch(t){case"input":if(Hg(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var a=s[t];if(a!==e&&a.form===e.form){var i=Ap(a);if(!i)throw Error(R(90));W0(a),Hg(a,i)}}}break;case"textarea":$0(e,s);break;case"select":t=s.value,t!=null&&Uo(e,!!s.multiple,t,!1)}};X0=Ob;Y0=br;var LE={usingClientEntryPoint:!1,Events:[Yu,yo,Ap,G0,q0,Ob]},Cl={findFiberByHostInstance:tr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RE={bundleType:Cl.bundleType,version:Cl.version,rendererPackageName:Cl.rendererPackageName,rendererConfig:Cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:li.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=J0(e),e===null?null:e.stateNode},findFiberByHostInstance:Cl.findFiberByHostInstance||PE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mh.isDisabled&&mh.supportsFiber)try{wp=mh.inject(RE),Ea=mh}catch{}}fs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LE;fs.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vb(t))throw Error(R(200));return NE(e,t,null,s)};fs.createRoot=function(e,t){if(!Vb(e))throw Error(R(299));var s=!1,a="",i=T1;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Bb(e,1,!1,null,null,s,!1,a,i),e[ni]=t.current,Tu(e.nodeType===8?e.parentNode:e),new Hb(t)};fs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(R(188)):(e=Object.keys(e).join(","),Error(R(268,e)));return e=J0(t),e=e===null?null:e.stateNode,e};fs.flushSync=function(e){return br(e)};fs.hydrate=function(e,t,s){if(!Rp(t))throw Error(R(200));return Ip(null,e,t,!0,s)};fs.hydrateRoot=function(e,t,s){if(!Vb(e))throw Error(R(405));var a=s!=null&&s.hydratedSources||null,i=!1,n="",r=T1;if(s!=null&&(s.unstable_strictMode===!0&&(i=!0),s.identifierPrefix!==void 0&&(n=s.identifierPrefix),s.onRecoverableError!==void 0&&(r=s.onRecoverableError)),t=P1(t,null,e,1,s??null,i,!1,n,r),e[ni]=t.current,Tu(e),a)for(e=0;e<a.length;e++)s=a[e],i=s._getVersion,i=i(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,i]:t.mutableSourceEagerHydrationData.push(s,i);return new Lp(t)};fs.render=function(e,t,s){if(!Rp(t))throw Error(R(200));return Ip(null,e,t,!1,s)};fs.unmountComponentAtNode=function(e){if(!Rp(e))throw Error(R(40));return e._reactRootContainer?(br(function(){Ip(null,null,e,!1,function(){e._reactRootContainer=null,e[ni]=null})}),!0):!1};fs.unstable_batchedUpdates=Ob;fs.unstable_renderSubtreeIntoContainer=function(e,t,s,a){if(!Rp(s))throw Error(R(200));if(e==null||e._reactInternals===void 0)throw Error(R(38));return Ip(e,t,s,!1,a)};fs.version="18.3.1-next-f1338f8080-20240426";function L1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L1)}catch(e){console.error(e)}}L1(),T0.exports=fs;var IE=T0.exports,gw=IE;Fg.createRoot=gw.createRoot,Fg.hydrateRoot=gw.hydrateRoot;/**
* @remix-run/router v1.23.1
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function zu(){return zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},zu.apply(this,arguments)}var Yi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Yi||(Yi={}));const mw="popstate";function DE(e){e===void 0&&(e={});function t(a,i){let{pathname:n,search:r,hash:l}=a.location;return Nm("",{pathname:n,search:r,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function s(a,i){return typeof i=="string"?i:Ef(i)}return FE(t,s,null,e)}function Lt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Gb(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function jE(){return Math.random().toString(36).substr(2,8)}function vw(e,t){return{usr:e.state,key:e.key,idx:t}}function Nm(e,t,s,a){return s===void 0&&(s=null),zu({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?vl(t):t,{state:s,key:t&&t.key||a||jE()})}function Ef(e){let{pathname:t="/",search:s="",hash:a=""}=e;return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function vl(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function FE(e,t,s,a){a===void 0&&(a={});let{window:i=document.defaultView,v5Compat:n=!1}=a,r=i.history,l=Yi.Pop,c=null,u=h();u==null&&(u=0,r.replaceState(zu({},r.state,{idx:u}),""));function h(){return(r.state||{idx:null}).idx}function d(){l=Yi.Pop;let A=h(),b=A==null?null:A-u;u=A,c&&c({action:l,location:y.location,delta:b})}function f(A,b){l=Yi.Push;let x=Nm(y.location,A,b);u=h()+1;let w=vw(x,u),S=y.createHref(x);try{r.pushState(w,"",S)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;i.location.assign(S)}n&&c&&c({action:l,location:y.location,delta:1})}function g(A,b){l=Yi.Replace;let x=Nm(y.location,A,b);u=h();let w=vw(x,u),S=y.createHref(x);r.replaceState(w,"",S),n&&c&&c({action:l,location:y.location,delta:0})}function v(A){let b=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof A=="string"?A:Ef(A);return x=x.replace(/ $/,"%20"),Lt(b,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,b)}let y={get action(){return l},get location(){return e(i,r)},listen(A){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(mw,d),c=A,()=>{i.removeEventListener(mw,d),c=null}},createHref(A){return t(i,A)},createURL:v,encodeLocation(A){let b=v(A);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:g,go(A){return r.go(A)}};return y}var bw;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(bw||(bw={}));function OE(e,t,s){return s===void 0&&(s="/"),WE(e,t,s)}function WE(e,t,s,a){let i=typeof t=="string"?vl(t):t,n=hl(i.pathname||"/",s);if(n==null)return null;let r=R1(e);zE(r);let l=null;for(let c=0;l==null&&c<r.length;++c){let u=QE(n);l=YE(r[c],u)}return l}function R1(e,t,s,a){t===void 0&&(t=[]),s===void 0&&(s=[]),a===void 0&&(a="");let i=(n,r,l)=>{let c={relativePath:l===void 0?n.path||"":l,caseSensitive:n.caseSensitive===!0,childrenIndex:r,route:n};c.relativePath.startsWith("/")&&(Lt(c.relativePath.startsWith(a),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(a.length));let u=un([a,c.relativePath]),h=s.concat(c);n.children&&n.children.length>0&&(Lt(n.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),R1(n.children,t,h,u)),!(n.path==null&&!n.index)&&t.push({path:u,score:qE(u,n.index),routesMeta:h})};return e.forEach((n,r)=>{var l;if(n.path===""||!((l=n.path)!=null&&l.includes("?")))i(n,r);else for(let c of I1(n.path))i(n,r,c)}),t}function I1(e){let t=e.split("/");if(t.length===0)return[];let[s,...a]=t,i=s.endsWith("?"),n=s.replace(/\?$/,"");if(a.length===0)return i?[n,""]:[n];let r=I1(a.join("/")),l=[];return l.push(...r.map(c=>c===""?n:[n,c].join("/"))),i&&l.push(...r),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function zE(e){e.sort((t,s)=>t.score!==s.score?s.score-t.score:XE(t.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}const $E=/^:[\w-]+$/,BE=3,UE=2,HE=1,VE=10,GE=-2,yw=e=>e==="*";function qE(e,t){let s=e.split("/"),a=s.length;return s.some(yw)&&(a+=GE),t&&(a+=UE),s.filter(i=>!yw(i)).reduce((i,n)=>i+($E.test(n)?BE:n===""?HE:VE),a)}function XE(e,t){return e.length===t.length&&e.slice(0,-1).every((s,a)=>s===t[a])?e[e.length-1]-t[t.length-1]:0}function YE(e,t,s){let{routesMeta:a}=e,i={},n="/",r=[];for(let l=0;l<a.length;++l){let c=a[l],u=l===a.length-1,h=n==="/"?t:t.slice(n.length)||"/",d=Pm({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!d)return null;Object.assign(i,d.params),r.push({params:i,pathname:un([n,d.pathname]),pathnameBase:sC(un([n,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(n=un([n,d.pathnameBase]))}return r}function Pm(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=KE(e.path,e.caseSensitive,e.end),i=t.match(s);if(!i)return null;let n=i[0],r=n.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:a.reduce((c,u,h)=>{let{paramName:d,isOptional:f}=u;if(d==="*"){let v=l[h]||"";r=n.slice(0,n.length-v.length).replace(/(.)\/+$/,"$1")}const g=l[h];return f&&!g?c[d]=void 0:c[d]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:n,pathnameBase:r,pattern:e}}function KE(e,t,s){t===void 0&&(t=!1),s===void 0&&(s=!0),Gb(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(n,r,l)=>(a.push({paramName:r,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),a]}function QE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Gb(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function hl(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,a=e.charAt(s);return a&&a!=="/"?null:e.slice(s)||"/"}const JE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ZE=e=>JE.test(e);function tC(e,t){t===void 0&&(t="/");let{pathname:s,search:a="",hash:i=""}=typeof e=="string"?vl(e):e,n;if(s)if(ZE(s))n=s;else{if(s.includes("//")){let r=s;s=s.replace(/\/\/+/g,"/"),Gb(!1,"Pathnames cannot have embedded double slashes - normalizing "+(r+" -> "+s))}s.startsWith("/")?n=ww(s.substring(1),"/"):n=ww(s,t)}else n=t;return{pathname:n,search:aC(a),hash:iC(i)}}function ww(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?s.length>1&&s.pop():a!=="."&&s.push(a)}),s.length>1?s.join("/"):"/"}function yg(e,t,s,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function eC(e){return e.filter((t,s)=>s===0||t.route.path&&t.route.path.length>0)}function qb(e,t){let s=eC(e);return t?s.map((a,i)=>i===s.length-1?a.pathname:a.pathnameBase):s.map(a=>a.pathnameBase)}function Xb(e,t,s,a){a===void 0&&(a=!1);let i;typeof e=="string"?i=vl(e):(i=zu({},e),Lt(!i.pathname||!i.pathname.includes("?"),yg("?","pathname","search",i)),Lt(!i.pathname||!i.pathname.includes("#"),yg("#","pathname","hash",i)),Lt(!i.search||!i.search.includes("#"),yg("#","search","hash",i)));let n=e===""||i.pathname==="",r=n?"/":i.pathname,l;if(r==null)l=s;else{let d=t.length-1;if(!a&&r.startsWith("..")){let f=r.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}l=d>=0?t[d]:"/"}let c=tC(i,l),u=r&&r!=="/"&&r.endsWith("/"),h=(n||r===".")&&s.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const un=e=>e.join("/").replace(/\/\/+/g,"/"),sC=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),aC=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,iC=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function nC(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const D1=["post","put","patch","delete"];new Set(D1);const rC=["get",...D1];new Set(rC);/**
* React Router v6.30.2
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function $u(){return $u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},$u.apply(this,arguments)}const Dp=C.createContext(null),j1=C.createContext(null),ci=C.createContext(null),jp=C.createContext(null),Ma=C.createContext({outlet:null,matches:[],isDataRoute:!1}),F1=C.createContext(null);function oC(e,t){let{relative:s}=t===void 0?{}:t;bl()||Lt(!1);let{basename:a,navigator:i}=C.useContext(ci),{hash:n,pathname:r,search:l}=Fp(e,{relative:s}),c=r;return a!=="/"&&(c=r==="/"?a:un([a,r])),i.createHref({pathname:c,search:l,hash:n})}function bl(){return C.useContext(jp)!=null}function Ar(){return bl()||Lt(!1),C.useContext(jp).location}function O1(e){C.useContext(ci).static||C.useLayoutEffect(e)}function Sr(){let{isDataRoute:e}=C.useContext(Ma);return e?_C():lC()}function lC(){bl()||Lt(!1);let e=C.useContext(Dp),{basename:t,future:s,navigator:a}=C.useContext(ci),{matches:i}=C.useContext(Ma),{pathname:n}=Ar(),r=JSON.stringify(qb(i,s.v7_relativeSplatPath)),l=C.useRef(!1);return O1(()=>{l.current=!0}),C.useCallback(function(c,u){if(u===void 0&&(u={}),!l.current)return;if(typeof c=="number"){a.go(c);return}let h=Xb(c,JSON.parse(r),n,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:un([t,h.pathname])),(u.replace?a.replace:a.push)(h,u.state,u)},[t,a,r,n,e])}const cC=C.createContext(null);function uC(e){let t=C.useContext(Ma).outlet;return t&&C.createElement(cC.Provider,{value:e},t)}function hC(){let{matches:e}=C.useContext(Ma),t=e[e.length-1];return t?t.params:{}}function Fp(e,t){let{relative:s}=t===void 0?{}:t,{future:a}=C.useContext(ci),{matches:i}=C.useContext(Ma),{pathname:n}=Ar(),r=JSON.stringify(qb(i,a.v7_relativeSplatPath));return C.useMemo(()=>Xb(e,JSON.parse(r),n,s==="path"),[e,r,n,s])}function dC(e,t){return fC(e,t)}function fC(e,t,s,a){bl()||Lt(!1);let{navigator:i}=C.useContext(ci),{matches:n}=C.useContext(Ma),r=n[n.length-1],l=r?r.params:{};r&&r.pathname;let c=r?r.pathnameBase:"/";r&&r.route;let u=Ar(),h;if(t){var d;let A=typeof t=="string"?vl(t):t;c==="/"||(d=A.pathname)!=null&&d.startsWith(c)||Lt(!1),h=A}else h=u;let f=h.pathname||"/",g=f;if(c!=="/"){let A=c.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(A.length).join("/")}let v=OE(e,{pathname:g}),y=bC(v&&v.map(A=>Object.assign({},A,{params:Object.assign({},l,A.params),pathname:un([c,i.encodeLocation?i.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?c:un([c,i.encodeLocation?i.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),n,s,a);return t&&y?C.createElement(jp.Provider,{value:{location:$u({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Yi.Pop}},y):y}function pC(){let e=kC(),t=nC(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),s?C.createElement("pre",{style:a},s):null,null)}const gC=C.createElement(pC,null);class mC extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){console.error("React Router caught the following error during render",t,s)}render(){return this.state.error!==void 0?C.createElement(Ma.Provider,{value:this.props.routeContext},C.createElement(F1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vC(e){let{routeContext:t,match:s,children:a}=e,i=C.useContext(Dp);return i&&i.static&&i.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=s.route.id),C.createElement(Ma.Provider,{value:t},a)}function bC(e,t,s,a){var i;if(t===void 0&&(t=[]),s===void 0&&(s=null),a===void 0&&(a=null),e==null){var n;if(!s)return null;if(s.errors)e=s.matches;else if((n=a)!=null&&n.v7_partialHydration&&t.length===0&&!s.initialized&&s.matches.length>0)e=s.matches;else return null}let r=e,l=(i=s)==null?void 0:i.errors;if(l!=null){let h=r.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);h>=0||Lt(!1),r=r.slice(0,Math.min(r.length,h+1))}let c=!1,u=-1;if(s&&a&&a.v7_partialHydration)for(let h=0;h<r.length;h++){let d=r[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:g}=s,v=d.route.loader&&f[d.route.id]===void 0&&(!g||g[d.route.id]===void 0);if(d.route.lazy||v){c=!0,u>=0?r=r.slice(0,u+1):r=[r[0]];break}}}return r.reduceRight((h,d,f)=>{let g,v=!1,y=null,A=null;s&&(g=l&&d.route.id?l[d.route.id]:void 0,y=d.route.errorElement||gC,c&&(u<0&&f===0?(AC("route-fallback"),v=!0,A=null):u===f&&(v=!0,A=d.route.hydrateFallbackElement||null)));let b=t.concat(r.slice(0,f+1)),x=()=>{let w;return g?w=y:v?w=A:d.route.Component?w=C.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=h,C.createElement(vC,{match:d,routeContext:{outlet:h,matches:b,isDataRoute:s!=null},children:w})};return s&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?C.createElement(mC,{location:s.location,revalidation:s.revalidation,component:y,error:g,children:x(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):x()},null)}var W1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(W1||{}),z1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(z1||{});function yC(e){let t=C.useContext(Dp);return t||Lt(!1),t}function wC(e){let t=C.useContext(j1);return t||Lt(!1),t}function xC(e){let t=C.useContext(Ma);return t||Lt(!1),t}function $1(e){let t=xC(),s=t.matches[t.matches.length-1];return s.route.id||Lt(!1),s.route.id}function kC(){var e;let t=C.useContext(F1),s=wC(),a=$1();return t!==void 0?t:(e=s.errors)==null?void 0:e[a]}function _C(){let{router:e}=yC(W1.UseNavigateStable),t=$1(z1.UseNavigateStable),s=C.useRef(!1);return O1(()=>{s.current=!0}),C.useCallback(function(a,i){i===void 0&&(i={}),s.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,$u({fromRouteId:t},i)))},[e,t])}const xw={};function AC(e,t,s){xw[e]||(xw[e]=!0)}function SC(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Tm(e){let{to:t,replace:s,state:a,relative:i}=e;bl()||Lt(!1);let{future:n,static:r}=C.useContext(ci),{matches:l}=C.useContext(Ma),{pathname:c}=Ar(),u=Sr(),h=Xb(t,qb(l,n.v7_relativeSplatPath),c,i==="path"),d=JSON.stringify(h);return C.useEffect(()=>u(JSON.parse(d),{replace:s,state:a,relative:i}),[u,d,i,s,a]),null}function EC(e){return uC(e.context)}function Ws(e){Lt(!1)}function CC(e){let{basename:t="/",children:s=null,location:a,navigationType:i=Yi.Pop,navigator:n,static:r=!1,future:l}=e;bl()&&Lt(!1);let c=t.replace(/^\/*/,"/"),u=C.useMemo(()=>({basename:c,navigator:n,static:r,future:$u({v7_relativeSplatPath:!1},l)}),[c,l,n,r]);typeof a=="string"&&(a=vl(a));let{pathname:h="/",search:d="",hash:f="",state:g=null,key:v="default"}=a,y=C.useMemo(()=>{let A=hl(h,c);return A==null?null:{location:{pathname:A,search:d,hash:f,state:g,key:v},navigationType:i}},[c,h,d,f,g,v,i]);return y==null?null:C.createElement(ci.Provider,{value:u},C.createElement(jp.Provider,{children:s,value:y}))}function MC(e){let{children:t,location:s}=e;return dC(Lm(t),s)}new Promise(()=>{});function Lm(e,t){t===void 0&&(t=[]);let s=[];return C.Children.forEach(e,(a,i)=>{if(!C.isValidElement(a))return;let n=[...t,i];if(a.type===C.Fragment){s.push.apply(s,Lm(a.props.children,n));return}a.type!==Ws&&Lt(!1),!a.props.index||!a.props.children||Lt(!1);let r={id:a.props.id||n.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(r.children=Lm(a.props.children,n)),s.push(r)}),s}/**
* React Router DOM v6.30.2
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function Cf(){return Cf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Cf.apply(this,arguments)}function B1(e,t){if(e==null)return{};var s={},a=Object.keys(e),i,n;for(n=0;n<a.length;n++)i=a[n],!(t.indexOf(i)>=0)&&(s[i]=e[i]);return s}function NC(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function PC(e,t){return e.button===0&&(!t||t==="_self")&&!NC(e)}function Rm(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,s)=>{let a=e[s];return t.concat(Array.isArray(a)?a.map(i=>[s,i]):[[s,a]])},[]))}function TC(e,t){let s=Rm(e);return t&&t.forEach((a,i)=>{s.has(i)||t.getAll(i).forEach(n=>{s.append(i,n)})}),s}const LC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],RC=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],IC="6";try{window.__reactRouterVersion=IC}catch{}const DC=C.createContext({isTransitioning:!1}),jC="startTransition",kw=_A[jC];function FC(e){let{basename:t,children:s,future:a,window:i}=e,n=C.useRef();n.current==null&&(n.current=DE({window:i,v5Compat:!0}));let r=n.current,[l,c]=C.useState({action:r.action,location:r.location}),{v7_startTransition:u}=a||{},h=C.useCallback(d=>{u&&kw?kw(()=>c(d)):c(d)},[c,u]);return C.useLayoutEffect(()=>r.listen(h),[r,h]),C.useEffect(()=>SC(a),[a]),C.createElement(CC,{basename:t,children:s,location:l.location,navigationType:l.action,navigator:r,future:a})}const OC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",WC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zC=C.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:i,replace:n,state:r,target:l,to:c,preventScrollReset:u,viewTransition:h}=e,d=B1(e,LC),{basename:f}=C.useContext(ci),g,v=!1;if(typeof c=="string"&&WC.test(c)&&(g=c,OC))try{let x=new URL(window.location.href),w=c.startsWith("//")?new URL(x.protocol+c):new URL(c),S=hl(w.pathname,f);w.origin===x.origin&&S!=null?c=S+w.search+w.hash:v=!0}catch{}let y=oC(c,{relative:a}),A=UC(c,{replace:n,state:r,target:l,preventScrollReset:u,relative:a,viewTransition:h});function b(x){s&&s(x),x.defaultPrevented||A(x)}return C.createElement("a",Cf({},d,{href:g||y,onClick:v||i?s:b,ref:t,target:l}))}),$C=C.forwardRef(function(e,t){let{"aria-current":s="page",caseSensitive:a=!1,className:i="",end:n=!1,style:r,to:l,viewTransition:c,children:u}=e,h=B1(e,RC),d=Fp(l,{relative:h.relative}),f=Ar(),g=C.useContext(j1),{navigator:v,basename:y}=C.useContext(ci),A=g!=null&&VC(d)&&c===!0,b=v.encodeLocation?v.encodeLocation(d).pathname:d.pathname,x=f.pathname,w=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;a||(x=x.toLowerCase(),w=w?w.toLowerCase():null,b=b.toLowerCase()),w&&y&&(w=hl(w,y)||w);const S=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let E=x===b||!n&&x.startsWith(b)&&x.charAt(S)==="/",M=w!=null&&(w===b||!n&&w.startsWith(b)&&w.charAt(b.length)==="/"),N={isActive:E,isPending:M,isTransitioning:A},P=E?s:void 0,T;typeof i=="function"?T=i(N):T=[i,E?"active":null,M?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let I=typeof r=="function"?r(N):r;return C.createElement(zC,Cf({},h,{"aria-current":P,className:T,ref:t,style:I,to:l,viewTransition:c}),typeof u=="function"?u(N):u)});var Im;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Im||(Im={}));var _w;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(_w||(_w={}));function BC(e){let t=C.useContext(Dp);return t||Lt(!1),t}function UC(e,t){let{target:s,replace:a,state:i,preventScrollReset:n,relative:r,viewTransition:l}=t===void 0?{}:t,c=Sr(),u=Ar(),h=Fp(e,{relative:r});return C.useCallback(d=>{if(PC(d,s)){d.preventDefault();let f=a!==void 0?a:Ef(u)===Ef(h);c(e,{replace:f,state:i,preventScrollReset:n,relative:r,viewTransition:l})}},[u,c,h,a,i,s,e,n,r,l])}function HC(e){let t=C.useRef(Rm(e)),s=C.useRef(!1),a=Ar(),i=C.useMemo(()=>TC(a.search,s.current?null:t.current),[a.search]),n=Sr(),r=C.useCallback((l,c)=>{const u=Rm(typeof l=="function"?l(i):l);s.current=!0,n("?"+u,c)},[n,i]);return[i,r]}function VC(e,t){t===void 0&&(t={});let s=C.useContext(DC);s==null&&Lt(!1);let{basename:a}=BC(Im.useViewTransitionState),i=Fp(e,{relative:t.relative});if(!s.isTransitioning)return!1;let n=hl(s.currentLocation.pathname,a)||s.currentLocation.pathname,r=hl(s.nextLocation.pathname,a)||s.nextLocation.pathname;return Pm(i.pathname,r)!=null||Pm(i.pathname,n)!=null}const wg="/api/v1";function Aw(){const e=document.cookie.split(";");for(const t of e){const[s,a]=t.trim().split("=");if(s==="csrf_token")return decodeURIComponent(a)}return null}class GC{async request(t,s={}){const{method:a="GET",body:i,headers:n={}}=s,r=localStorage.getItem("access_token"),l=localStorage.getItem("device_id"),c=Aw(),u={"Content-Type":"application/json",...n};r&&(u.Authorization=`Bearer ${r}`),l&&(u["X-Device-ID"]=l),c&&a!=="GET"&&(u["X-CSRF-Token"]=c);const h=localStorage.getItem("desktop_session");h&&(u["X-Desktop-Session"]=h);const d=await fetch(`${wg}${t}`,{method:a,headers:u,body:i?JSON.stringify(i):void 0,credentials:"include"});if(d.status===401){const f=await d.json();if(f.code==="TOKEN_EXPIRED"&&await this.refreshToken())return this.request(t,s);throw new Error(f.error||"Unauthorized")}if(!d.ok){const f=await d.json().catch(()=>({}));throw new Error(f.error||`Request failed: ${d.status}`)}return{data:await d.json()}}async refreshToken(){const t=localStorage.getItem("refresh_token");if(!t)return!1;try{const s=await fetch(`${wg}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:t})});if(!s.ok)return!1;const a=await s.json();return localStorage.setItem("access_token",a.access_token),localStorage.setItem("refresh_token",a.refresh_token),!0}catch{return!1}}async get(t){return this.request(t)}async post(t,s){return this.request(t,{method:"POST",body:s})}async put(t,s){return this.request(t,{method:"PUT",body:s})}async delete(t){return this.request(t,{method:"DELETE"})}async upload(t,s,a){const i=localStorage.getItem("access_token"),n=localStorage.getItem("device_id"),r=Aw(),l=localStorage.getItem("desktop_session"),c=new FormData;c.append("file",s),a&&c.append("title",a);const u={};i&&(u.Authorization=`Bearer ${i}`),n&&(u["X-Device-ID"]=n),r&&(u["X-CSRF-Token"]=r),l&&(u["X-Desktop-Session"]=l);const h=await fetch(`${wg}${t}`,{method:"POST",headers:u,body:c,credentials:"include"});if(!h.ok){const d=await h.json().catch(()=>({}));throw new Error(d.error||"Upload failed")}return{data:await h.json()}}async logEvent(t,s,a,i){try{await this.post("/audit/log",{action_type:t,target_type:s,target_id:a,metadata:i})}catch{}}async getDocumentAccess(t){return this.get(`/documents/${t}/access`)}async grantAccess(t,s){return this.post(`/documents/${t}/access`,{user_id:s})}async revokeAccess(t,s){return this.delete(`/documents/${t}/access/${s}`)}}const ct=new GC,U1=C.createContext(null);function qC({children:e}){const[t,s]=C.useState(null),[a,i]=C.useState(!0);C.useEffect(()=>{n()},[]);const n=async()=>{if(!localStorage.getItem("access_token")){i(!1);return}try{const u=await ct.get("/auth/profile");s(u.data)}catch{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}finally{i(!1)}},r=async(u,h,d)=>{const f=XC(),g=await ct.post("/auth/login",{email:u,password:h,totp_code:d,device_id:f});return g.data.requires_totp?{requiresTOTP:!0}:(localStorage.setItem("access_token",g.data.access_token),localStorage.setItem("refresh_token",g.data.refresh_token),g.data.client_ip&&localStorage.setItem("client_ip",g.data.client_ip),s(g.data.user),{requiresPasswordChange:g.data.requires_password_change||!1,requiresMFAEnrollment:g.data.requires_mfa_enrollment||!1})},l=async()=>{try{await ct.post("/auth/logout")}catch{}localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),s(null)},c=async()=>{const u=await ct.get("/auth/profile");s(u.data)};return p.jsx(U1.Provider,{value:{user:t,loading:a,login:r,logout:l,refreshUser:c},children:e})}function Fs(){const e=C.useContext(U1);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function XC(){let e=localStorage.getItem("device_id");return e||(e="web-"+YC(),localStorage.setItem("device_id",e)),e}function YC(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}const H1=C.createContext(null);function KC({children:e}){const{user:t}=Fs(),[s,a]=C.useState(()=>{const n=localStorage.getItem("theme");return n==="twilight"||n==="glacium"?n:"twilight"});C.useEffect(()=>{t?t.role==="super_admin"||t.role==="admin"?a("twilight"):a("glacium"):a("twilight")},[t]),C.useEffect(()=>{document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s)},[s]);const i=()=>{a(n=>n==="twilight"?"glacium":"twilight")};return p.jsx(H1.Provider,{value:{theme:s,toggleTheme:i},children:e})}function V1(){const e=C.useContext(H1);if(!e)throw new Error("useTheme must be used within ThemeProvider");return e}/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/var QC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const JC=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),nt=(e,t)=>{const s=C.forwardRef(({color:a="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:l="",children:c,...u},h)=>C.createElement("svg",{ref:h,...QC,width:i,height:i,stroke:a,strokeWidth:r?Number(n)*24/Number(i):n,className:["lucide",`lucide-${JC(e)}`,l].join(" "),...u},[...t.map(([d,f])=>C.createElement(d,f)),...Array.isArray(c)?c:[c]]));return s.displayName=`${e}`,s};/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Sw=nt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const G1=nt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const ZC=nt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const q1=nt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const tM=nt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const eM=nt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const sM=nt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const X1=nt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Dm=nt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Wh=nt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const zh=nt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Aa=nt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const aM=nt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Ew=nt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const iM=nt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const nM=nt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Y1=nt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const K1=nt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const rM=nt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Mf=nt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const oM=nt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Q1=nt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const J1=nt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const lM=nt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Nf=nt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const cM=nt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const jm=nt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Yb=nt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Z1=nt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const uM=nt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const dl=nt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const hM=nt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const yl=nt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const dM=nt("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const fM=nt("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function pM(){const[e,t]=C.useState(""),[s,a]=C.useState(""),[i,n]=C.useState(""),[r,l]=C.useState(!1),[c,u]=C.useState(!1),[h,d]=C.useState(!1),[f,g]=C.useState(""),{login:v,user:y}=Fs(),A=Sr(),[b]=HC();C.useEffect(()=>{const w=b.get("auto"),S=b.get("token"),E=b.get("desktop_session"),M=b.get("refresh");if(w==="1"&&S&&E){localStorage.setItem("access_token",S),localStorage.setItem("desktop_session",E),M&&localStorage.setItem("refresh_token",M),window.history.replaceState({},document.title,"/login"),window.location.href="/dashboard";return}E&&!S&&(localStorage.setItem("desktop_session",E),window.history.replaceState({},document.title,"/login")),y&&A("/dashboard")},[b,y,A]);const x=async w=>{w.preventDefault(),g(""),d(!0);try{const S=await v(e,s,c?i:void 0);if(S.requiresTOTP){u(!0),d(!1);return}if(S.requiresPasswordChange){A("/force-change-password");return}if(S.requiresMFAEnrollment){A("/force-enroll-mfa");return}A("/dashboard")}catch(S){g(S instanceof Error?S.message:"Login failed"),d(!1)}};return p.jsxs("div",{className:"login-page",children:[p.jsxs("div",{className:"login-bg",children:[p.jsx("div",{className:"bg-gradient"}),p.jsx("div",{className:"bg-pattern"})]}),p.jsx("div",{className:"login-container animate-slideUp",children:p.jsxs("div",{className:"login-card glass-card",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("div",{className:"logo-icon",children:p.jsx(Nf,{size:40})}),p.jsx("h1",{children:"SRAMS"}),p.jsx("p",{children:"Secure Role-Based Audit Management System"})]}),p.jsxs("form",{onSubmit:x,className:"login-form",children:[f&&p.jsx("div",{className:"error-message",children:f}),c?p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Two-Factor Authentication Code"}),p.jsx("input",{type:"text",className:"input totp-input",value:i,onChange:w=>n(w.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",required:!0,autoComplete:"one-time-code",maxLength:6}),p.jsx("p",{className:"totp-hint",children:"Enter the 6-digit code from your authenticator app"})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Email"}),p.jsx("input",{type:"email",className:"input",value:e,onChange:w=>t(w.target.value),placeholder:"admin@example.com",required:!0,autoComplete:"email"})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Password"}),p.jsxs("div",{className:"password-input",children:[p.jsx("input",{type:r?"text":"password",className:"input",value:s,onChange:w=>a(w.target.value),placeholder:"",required:!0,autoComplete:"current-password"}),p.jsx("button",{type:"button",className:"toggle-password",onClick:()=>l(!r),children:r?p.jsx(Wh,{size:18}):p.jsx(zh,{size:18})})]})]})]}),p.jsx("button",{type:"submit",className:"btn btn-primary login-btn",disabled:h,children:h?p.jsxs(p.Fragment,{children:[p.jsx(nM,{size:18,className:"animate-spin"}),p.jsx("span",{children:"Signing in..."})]}):p.jsx("span",{children:c?"Verify":"Sign In"})}),c&&p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{u(!1),n("")},children:"Back to Login"})]}),p.jsx("div",{className:"login-footer",children:p.jsx("p",{children:"Secure  Audited  Compliant"})})]})})]})}function gM(){const e=Sr(),{refreshUser:t}=Fs(),[s,a]=C.useState(""),[i,n]=C.useState(""),[r,l]=C.useState(""),[c,u]=C.useState(!1),[h,d]=C.useState(!1),[f,g]=C.useState(!1),[v,y]=C.useState(""),[A,b]=C.useState(!1),x=async w=>{var S,E;if(w.preventDefault(),y(""),i!==r){y("New passwords do not match");return}if(i.length<8){y("Password must be at least 8 characters");return}if(i===s){y("New password must be different from current password");return}b(!0);try{await ct.post("/auth/change-password",{current_password:s,new_password:i}),await t(),e("/dashboard")}catch(M){const N=M;y(((E=(S=N==null?void 0:N.response)==null?void 0:S.data)==null?void 0:E.error)||"Failed to change password")}finally{b(!1)}};return p.jsx("div",{className:"login-page",children:p.jsx("div",{className:"login-container",children:p.jsxs("div",{className:"login-card glass-card",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("div",{className:"login-icon",children:p.jsx(Y1,{size:32})}),p.jsx("h1",{children:"Password Change Required"}),p.jsx("p",{children:"For security reasons, you must change your password before continuing."})]}),p.jsxs("form",{onSubmit:x,className:"login-form",children:[v&&p.jsxs("div",{className:"error-message",children:[p.jsx(G1,{size:16}),p.jsx("span",{children:v})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Current Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:c?"text":"password",className:"input",placeholder:"Enter your current password",value:s,onChange:w=>a(w.target.value),required:!0,autoComplete:"current-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>u(!c),tabIndex:-1,children:c?p.jsx(Wh,{size:18}):p.jsx(zh,{size:18})})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"New Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:h?"text":"password",className:"input",placeholder:"Enter your new password",value:i,onChange:w=>n(w.target.value),required:!0,minLength:8,autoComplete:"new-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>d(!h),tabIndex:-1,children:h?p.jsx(Wh,{size:18}):p.jsx(zh,{size:18})})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Confirm New Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:f?"text":"password",className:"input",placeholder:"Confirm your new password",value:r,onChange:w=>l(w.target.value),required:!0,minLength:8,autoComplete:"new-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>g(!f),tabIndex:-1,children:f?p.jsx(Wh,{size:18}):p.jsx(zh,{size:18})})]})]}),i.length>=8&&i===r&&p.jsxs("div",{className:"success-hint",children:[p.jsx(q1,{size:16}),p.jsx("span",{children:"Passwords match!"})]}),p.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:A||!s||!i||!r,children:A?"Changing Password...":"Change Password & Continue"})]})]})})})}function mM(){const{user:e}=Fs(),[t,s]=C.useState(null),[a,i]=C.useState([]),[n,r]=C.useState([]),[l,c]=C.useState(!0),u=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin";C.useEffect(()=>{h(),ct.logEvent("page_view","dashboard")},[]);const h=async()=>{try{if(u){const g=await ct.get("/dashboard/stats");s(g.data)}const d=await ct.get("/documents/my?limit=5");i(d.data.documents||[]);const f=await ct.get("/requests/my?limit=5");r(f.data.requests||[])}catch(d){console.error("Failed to load dashboard:",d)}finally{c(!1)}};return l?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"dashboard animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("h1",{children:["Welcome back, ",e==null?void 0:e.full_name]}),p.jsx("p",{children:u?"Here's an overview of your system":"Access your documents and manage requests"})]}),u&&t&&p.jsxs("div",{className:"stats-grid",children:[p.jsx(vh,{icon:p.jsx(dl,{}),label:"Total Users",value:t.total_users,subtext:`${t.active_users} active`,color:"blue"}),p.jsx(vh,{icon:p.jsx(Aa,{}),label:"Documents",value:t.total_documents,color:"purple"}),p.jsx(vh,{icon:p.jsx(G1,{}),label:"Pending Requests",value:t.pending_requests,color:"yellow"}),p.jsx(vh,{icon:p.jsx(Sw,{}),label:"Active Sessions",value:t.active_sessions,subtext:`${t.today_logins} logins today`,color:"green"})]}),p.jsxs("div",{className:"dashboard-grid",children:[p.jsxs("div",{className:"dashboard-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsxs("h2",{children:[p.jsx(Aa,{size:20})," My Documents"]}),p.jsx("a",{href:"/documents",className:"view-all",children:"View All "})]}),a.length>0?p.jsx("div",{className:"document-list",children:a.map(d=>p.jsxs("a",{href:`/documents/${d.id}`,className:"document-item",children:[p.jsx(Aa,{size:18}),p.jsxs("div",{className:"document-info",children:[p.jsx("span",{className:"document-title",children:d.title}),p.jsx("span",{className:"document-date",children:new Date(d.created_at).toLocaleDateString()})]})]},d.id))}):p.jsxs("div",{className:"empty-state",children:[p.jsx(Aa,{size:40}),p.jsx("p",{children:"No documents assigned yet"})]})]}),p.jsxs("div",{className:"dashboard-section glass-card",children:[p.jsx("div",{className:"section-header",children:p.jsxs("h2",{children:[p.jsx(Dm,{size:20})," My Requests"]})}),n.length>0?p.jsx("div",{className:"request-list",children:n.map(d=>p.jsxs("div",{className:"request-item",children:[p.jsx(vM,{status:d.status}),p.jsxs("div",{className:"request-info",children:[p.jsx("span",{className:"request-reason",children:d.reason||"Document access request"}),p.jsx("span",{className:"request-date",children:new Date(d.created_at).toLocaleDateString()})]}),p.jsx("span",{className:`badge badge-${bM(d.status)}`,children:d.status})]},d.id))}):p.jsxs("div",{className:"empty-state",children:[p.jsx(Dm,{size:40}),p.jsx("p",{children:"No requests yet"})]})]})]}),p.jsxs("div",{className:"quick-actions glass-card",children:[p.jsx("h2",{children:"Quick Actions"}),p.jsxs("div",{className:"action-buttons",children:[p.jsxs("a",{href:"/documents",className:"btn btn-primary",children:[p.jsx(Aa,{size:18}),"Browse Documents"]}),u&&p.jsxs(p.Fragment,{children:[p.jsxs("a",{href:"/users",className:"btn btn-secondary",children:[p.jsx(dl,{size:18}),"Manage Users"]}),p.jsxs("a",{href:"/audit",className:"btn btn-secondary",children:[p.jsx(Sw,{size:18}),"View Audit Logs"]})]})]})]})]})}function vh({icon:e,label:t,value:s,subtext:a,color:i}){return p.jsxs("div",{className:`stat-card glass-card stat-${i}`,children:[p.jsx("div",{className:"stat-icon",children:e}),p.jsxs("div",{className:"stat-content",children:[p.jsx("span",{className:"stat-value",children:s.toLocaleString()}),p.jsx("span",{className:"stat-label",children:t}),a&&p.jsx("span",{className:"stat-subtext",children:a})]})]})}function vM({status:e}){switch(e){case"approved":return p.jsx(q1,{size:18,className:"status-approved"});case"rejected":return p.jsx(hM,{size:18,className:"status-rejected"});default:return p.jsx(Dm,{size:18,className:"status-pending"})}}function bM(e){switch(e){case"approved":return"success";case"rejected":return"error";default:return"warning"}}function yM(){const{user:e}=Fs(),[t,s]=C.useState([]),[a,i]=C.useState([]),[n,r]=C.useState(!0),[l,c]=C.useState(""),[u,h]=C.useState(!1),[d,f]=C.useState(!1),[g,v]=C.useState(!1),[y,A]=C.useState(null),b=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin";C.useEffect(()=>{x()},[]);const x=async()=>{try{const M=await ct.get("/documents/my");if(s(M.data.documents||[]),b){const N=await ct.get("/documents");i(N.data.documents||[])}}catch(M){console.error("Failed to load documents:",M)}finally{r(!1)}},w=M=>M<1024?M+" B":M<1024*1024?(M/1024).toFixed(1)+" KB":(M/(1024*1024)).toFixed(1)+" MB",S=t.filter(M=>M.title.toLowerCase().includes(l.toLowerCase())||M.filename.toLowerCase().includes(l.toLowerCase())),E=a.filter(M=>M.title.toLowerCase().includes(l.toLowerCase())||M.filename.toLowerCase().includes(l.toLowerCase()));return n?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"documents-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Documents"}),p.jsx("p",{children:"View and manage your documents"})]}),p.jsxs("div",{className:"header-actions",children:[b&&p.jsxs("button",{className:"btn btn-primary",onClick:()=>h(!0),children:[p.jsx(Z1,{size:18}),"Upload"]}),!b&&p.jsxs("button",{className:"btn btn-secondary",onClick:()=>f(!0),children:[p.jsx(Q1,{size:18}),"Request Access"]})]})]}),p.jsxs("div",{className:"search-bar glass-card",children:[p.jsx(J1,{size:20}),p.jsx("input",{type:"text",placeholder:"Search documents...",value:l,onChange:M=>c(M.target.value)})]}),p.jsxs("section",{className:"document-section",children:[p.jsx("h2",{children:"My Documents"}),S.length>0?p.jsx("div",{className:"document-grid",children:S.map(M=>p.jsxs("a",{href:`/documents/${M.id}`,className:"document-card glass-card",children:[p.jsx("div",{className:"doc-icon",children:p.jsx(Aa,{size:32})}),p.jsxs("div",{className:"doc-details",children:[p.jsx("h3",{children:M.title}),p.jsx("p",{children:M.filename}),p.jsxs("span",{className:"doc-meta",children:[w(M.file_size),"  ",new Date(M.created_at).toLocaleDateString()]})]})]},M.id))}):p.jsxs("div",{className:"empty-state glass-card",children:[p.jsx(Aa,{size:48}),p.jsx("h3",{children:"No documents"}),p.jsx("p",{children:"You don't have any assigned documents yet"})]})]}),b&&p.jsxs("section",{className:"document-section",children:[p.jsx("h2",{children:"All Documents"}),E.length>0?p.jsx("div",{className:"document-grid",children:E.map(M=>p.jsxs("div",{className:"document-card glass-card",children:[p.jsxs("a",{href:`/documents/${M.id}`,className:"doc-link",children:[p.jsx("div",{className:"doc-icon",children:p.jsx(Aa,{size:32})}),p.jsxs("div",{className:"doc-details",children:[p.jsx("h3",{children:M.title}),p.jsx("p",{children:M.filename}),p.jsxs("span",{className:"doc-meta",children:[w(M.file_size),"  ",new Date(M.created_at).toLocaleDateString()]})]})]}),p.jsxs("button",{className:"btn btn-small btn-secondary assign-btn",onClick:N=>{N.preventDefault(),N.stopPropagation(),A(M),v(!0)},children:[p.jsx(dl,{size:14}),"Assign Users"]})]},M.id))}):p.jsxs("div",{className:"empty-state glass-card",children:[p.jsx(Aa,{size:48}),p.jsx("h3",{children:"No documents uploaded"}),p.jsx("p",{children:"Upload your first document to get started"})]})]}),u&&p.jsx(wM,{onClose:()=>h(!1),onSuccess:x}),d&&p.jsx(xM,{documents:a,onClose:()=>f(!1),onSuccess:x}),g&&y&&p.jsx(kM,{document:y,onClose:()=>{v(!1),A(null)},onSuccess:x})]})}function wM({onClose:e,onSuccess:t}){const[s,a]=C.useState(null),[i,n]=C.useState(""),[r,l]=C.useState(!1),[c,u]=C.useState(""),h=async()=>{if(s){l(!0),u("");try{await ct.upload("/documents",s,i||s.name),t(),e()}catch(d){u(d instanceof Error?d.message:"Upload failed")}finally{l(!1)}}};return p.jsx("div",{className:"modal-overlay",onClick:e,children:p.jsxs("div",{className:"modal glass-card",onClick:d=>d.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Upload Document"}),p.jsx("button",{className:"close-btn",onClick:e,children:p.jsx(yl,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[c&&p.jsx("div",{className:"error-message",children:c}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Title"}),p.jsx("input",{type:"text",className:"input",value:i,onChange:d=>n(d.target.value),placeholder:"Document title"})]}),p.jsxs("div",{className:"file-input",children:[p.jsx("input",{type:"file",accept:".pdf",onChange:d=>{var f;return a(((f=d.target.files)==null?void 0:f[0])||null)}}),s&&p.jsx("span",{className:"file-name",children:s.name})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:h,disabled:!s||r,children:r?"Uploading...":"Upload"})]})]})})}function xM({documents:e,onClose:t,onSuccess:s}){const[a,i]=C.useState(""),[n,r]=C.useState(""),[l,c]=C.useState(!1),[u,h]=C.useState(""),d=async()=>{if(a){c(!0),h("");try{await ct.post("/requests",{document_id:a,reason:n}),s(),t()}catch(f){h(f instanceof Error?f.message:"Request failed")}finally{c(!1)}}};return p.jsx("div",{className:"modal-overlay",onClick:t,children:p.jsxs("div",{className:"modal glass-card",onClick:f=>f.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Request Document Access"}),p.jsx("button",{className:"close-btn",onClick:t,children:p.jsx(yl,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[u&&p.jsx("div",{className:"error-message",children:u}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Select Document"}),p.jsxs("select",{className:"input",value:a,onChange:f=>i(f.target.value),children:[p.jsx("option",{value:"",children:"Choose a document..."}),e.map(f=>p.jsx("option",{value:f.id,children:f.title},f.id))]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Reason (optional)"}),p.jsx("textarea",{className:"input",value:n,onChange:f=>r(f.target.value),placeholder:"Why do you need access to this document?",rows:3})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:d,disabled:!a||l,children:l?"Submitting...":"Submit Request"})]})]})})}function kM({document:e,onClose:t,onSuccess:s}){const[a,i]=C.useState([]),[n,r]=C.useState(new Set),[l,c]=C.useState(new Set),[u,h]=C.useState(!0),[d,f]=C.useState(!1),[g,v]=C.useState("");C.useEffect(()=>{y()},[]);const y=async()=>{try{const w=((await ct.get("/users")).data.users||[]).filter(M=>!["admin","super_admin"].includes(M.role||""));i(w);const S=await ct.getDocumentAccess(e.id),E=new Set((S.data.users||[]).map(M=>M.id));r(E),c(new Set(E))}catch(w){console.error("Failed to load data:",w),v("Failed to load users")}finally{h(!1)}},A=w=>{r(S=>{const E=new Set(S);return E.has(w)?E.delete(w):E.add(w),E})},b=async()=>{f(!0),v("");try{const w=[...n].filter(E=>!l.has(E)),S=[...l].filter(E=>!n.has(E));for(const E of w)await ct.grantAccess(e.id,E);for(const E of S)await ct.revokeAccess(e.id,E);s(),t()}catch(w){v(w instanceof Error?w.message:"Failed to save changes")}finally{f(!1)}},x=()=>{if(n.size!==l.size)return!0;for(const w of n)if(!l.has(w))return!0;return!1};return p.jsx("div",{className:"modal-overlay",onClick:t,children:p.jsxs("div",{className:"modal glass-card modal-large",onClick:w=>w.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsxs("h2",{children:["Assign Users to: ",e.title]}),p.jsx("button",{className:"close-btn",onClick:t,children:p.jsx(yl,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[g&&p.jsx("div",{className:"error-message",children:g}),u?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):a.length===0?p.jsxs("div",{className:"empty-state",children:[p.jsx(dl,{size:32}),p.jsx("p",{children:"No users available to assign"})]}):p.jsx("div",{className:"user-list",children:a.map(w=>p.jsxs("div",{className:`user-item ${n.has(w.id)?"selected":""}`,onClick:()=>A(w.id),children:[p.jsx("div",{className:"user-checkbox",children:n.has(w.id)&&p.jsx(tM,{size:16})}),p.jsxs("div",{className:"user-info",children:[p.jsx("span",{className:"user-name",children:w.full_name}),p.jsx("span",{className:"user-email",children:w.email})]})]},w.id))})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsxs("span",{className:"selection-count",children:[n.size," user",n.size!==1?"s":""," selected"]}),p.jsxs("div",{className:"footer-actions",children:[p.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:b,disabled:!x()||d,children:d?"Saving...":"Save Changes"})]})]})]})})}var Gc={};Gc.d=(e,t)=>{for(var s in t)Gc.o(t,s)&&!Gc.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})};Gc.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var K=globalThis.pdfjsLib={};Gc.d(K,{AbortException:()=>fn,AnnotationEditorLayer:()=>FN,AnnotationEditorParamsType:()=>it,AnnotationEditorType:()=>J,AnnotationEditorUIManager:()=>Uu,AnnotationLayer:()=>SN,AnnotationMode:()=>Wi,ColorPicker:()=>R_,DOMSVGFactory:()=>ny,DrawLayer:()=>ON,FeatureTest:()=>We,GlobalWorkerOptions:()=>pn,ImageKind:()=>$h,InvalidPDFException:()=>Om,MissingPDFException:()=>Bu,OPS:()=>qs,OutputScale:()=>sy,PDFDataRangeTransport:()=>t_,PDFDateString:()=>ty,PDFWorker:()=>yd,PasswordResponses:()=>EM,PermissionFlag:()=>SM,PixelsPerInch:()=>fl,RenderingCancelledException:()=>Jb,TextLayer:()=>mv,TouchManager:()=>wk,UnexpectedResponseException:()=>Pf,Util:()=>$,VerbosityLevel:()=>Op,XfaLayer:()=>a_,build:()=>iN,createValidAbsoluteUrl:()=>PM,fetchData:()=>Bp,getDocument:()=>q2,getFilenameFromUrl:()=>WM,getPdfFilenameFromUrl:()=>zM,getXfaPageViewport:()=>$M,isDataScheme:()=>Up,isPdfFile:()=>Zb,noContextMenu:()=>ta,normalizeUnicode:()=>jM,setLayerDimensions:()=>yr,shadow:()=>tt,stopEvent:()=>cs,version:()=>aN});const Ne=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),tk=[1,0,0,1,0,0],Fm=[.001,0,0,.001,0,0],_M=1e7,xg=1.35,ns={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Wi={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},AM="pdfjs_internal_editor_",J={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},it={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},SM={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ye={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},$h={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Gt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Ml={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Op={ERRORS:0,WARNINGS:1,INFOS:5},qs={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},EM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Wp=Op.WARNINGS;function CM(e){Number.isInteger(e)&&(Wp=e)}function MM(){return Wp}function zp(e){Wp>=Op.INFOS&&console.log(`Info: ${e}`)}function Z(e){Wp>=Op.WARNINGS&&console.log(`Warning: ${e}`)}function yt(e){throw new Error(e)}function Vt(e,t){e||yt(t)}function NM(e){switch(e==null?void 0:e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function PM(e,t=null,s=null){if(!e)return null;try{if(s&&typeof e=="string"){if(s.addDefaultProtocol&&e.startsWith("www.")){const i=e.match(/\./g);(i==null?void 0:i.length)>=2&&(e=`http://${e}`)}if(s.tryConvertEncoding)try{e=DM(e)}catch{}}const a=t?new URL(e,t):new URL(e);if(NM(a))return a}catch{}return null}function tt(e,t,s,a=!1){return Object.defineProperty(e,t,{value:s,enumerable:!a,configurable:!0,writable:!1}),s}const yn=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class Cw extends yn{constructor(t,s){super(t,"PasswordException"),this.code=s}}class kg extends yn{constructor(t,s){super(t,"UnknownErrorException"),this.details=s}}class Om extends yn{constructor(t){super(t,"InvalidPDFException")}}class Bu extends yn{constructor(t){super(t,"MissingPDFException")}}class Pf extends yn{constructor(t,s){super(t,"UnexpectedResponseException"),this.status=s}}class TM extends yn{constructor(t){super(t,"FormatError")}}class fn extends yn{constructor(t){super(t,"AbortException")}}function ek(e){(typeof e!="object"||(e==null?void 0:e.length)===void 0)&&yt("Invalid argument for bytesToString");const t=e.length,s=8192;if(t<s)return String.fromCharCode.apply(null,e);const a=[];for(let i=0;i<t;i+=s){const n=Math.min(i+s,t),r=e.subarray(i,n);a.push(String.fromCharCode.apply(null,r))}return a.join("")}function $p(e){typeof e!="string"&&yt("Invalid argument for stringToBytes");const t=e.length,s=new Uint8Array(t);for(let a=0;a<t;++a)s[a]=e.charCodeAt(a)&255;return s}function LM(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function Kb(e){const t=Object.create(null);for(const[s,a]of e)t[s]=a;return t}function RM(){const e=new Uint8Array(4);return e[0]=1,new Uint32Array(e.buffer,0,1)[0]===1}function IM(){try{return new Function(""),!0}catch{return!1}}class We{static get isLittleEndian(){return tt(this,"isLittleEndian",RM())}static get isEvalSupported(){return tt(this,"isEvalSupported",IM())}static get isOffscreenCanvasSupported(){return tt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return tt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?tt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):tt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,s;return tt(this,"isCSSRoundSupported",(s=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:s.call(t,"width: round(1.5px, 1px)"))}}const _g=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,"0"));var qn,bh,Wm;class ${static makeHexColor(t,s,a){return`#${_g[t]}${_g[s]}${_g[a]}`}static scaleMinMax(t,s){let a;t[0]?(t[0]<0&&(a=s[0],s[0]=s[2],s[2]=a),s[0]*=t[0],s[2]*=t[0],t[3]<0&&(a=s[1],s[1]=s[3],s[3]=a),s[1]*=t[3],s[3]*=t[3]):(a=s[0],s[0]=s[1],s[1]=a,a=s[2],s[2]=s[3],s[3]=a,t[1]<0&&(a=s[1],s[1]=s[3],s[3]=a),s[1]*=t[1],s[3]*=t[1],t[2]<0&&(a=s[0],s[0]=s[2],s[2]=a),s[0]*=t[2],s[2]*=t[2]),s[0]+=t[4],s[1]+=t[5],s[2]+=t[4],s[3]+=t[5]}static transform(t,s){return[t[0]*s[0]+t[2]*s[1],t[1]*s[0]+t[3]*s[1],t[0]*s[2]+t[2]*s[3],t[1]*s[2]+t[3]*s[3],t[0]*s[4]+t[2]*s[5]+t[4],t[1]*s[4]+t[3]*s[5]+t[5]]}static applyTransform(t,s){const a=t[0]*s[0]+t[1]*s[2]+s[4],i=t[0]*s[1]+t[1]*s[3]+s[5];return[a,i]}static applyInverseTransform(t,s){const a=s[0]*s[3]-s[1]*s[2],i=(t[0]*s[3]-t[1]*s[2]+s[2]*s[5]-s[4]*s[3])/a,n=(-t[0]*s[1]+t[1]*s[0]+s[4]*s[1]-s[5]*s[0])/a;return[i,n]}static getAxialAlignedBoundingBox(t,s){const a=this.applyTransform(t,s),i=this.applyTransform(t.slice(2,4),s),n=this.applyTransform([t[0],t[3]],s),r=this.applyTransform([t[2],t[1]],s);return[Math.min(a[0],i[0],n[0],r[0]),Math.min(a[1],i[1],n[1],r[1]),Math.max(a[0],i[0],n[0],r[0]),Math.max(a[1],i[1],n[1],r[1])]}static inverseTransform(t){const s=t[0]*t[3]-t[1]*t[2];return[t[3]/s,-t[1]/s,-t[2]/s,t[0]/s,(t[2]*t[5]-t[4]*t[3])/s,(t[4]*t[1]-t[5]*t[0])/s]}static singularValueDecompose2dScale(t){const s=[t[0],t[2],t[1],t[3]],a=t[0]*s[0]+t[1]*s[2],i=t[0]*s[1]+t[1]*s[3],n=t[2]*s[0]+t[3]*s[2],r=t[2]*s[1]+t[3]*s[3],l=(a+r)/2,c=Math.sqrt((a+r)**2-4*(a*r-n*i))/2,u=l+c||1,h=l-c||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(t){const s=t.slice(0);return t[0]>t[2]&&(s[0]=t[2],s[2]=t[0]),t[1]>t[3]&&(s[1]=t[3],s[3]=t[1]),s}static intersect(t,s){const a=Math.max(Math.min(t[0],t[2]),Math.min(s[0],s[2])),i=Math.min(Math.max(t[0],t[2]),Math.max(s[0],s[2]));if(a>i)return null;const n=Math.max(Math.min(t[1],t[3]),Math.min(s[1],s[3])),r=Math.min(Math.max(t[1],t[3]),Math.max(s[1],s[3]));return n>r?null:[a,n,i,r]}static bezierBoundingBox(t,s,a,i,n,r,l,c,u){return u?(u[0]=Math.min(u[0],t,l),u[1]=Math.min(u[1],s,c),u[2]=Math.max(u[2],t,l),u[3]=Math.max(u[3],s,c)):u=[Math.min(t,l),Math.min(s,c),Math.max(t,l),Math.max(s,c)],_(this,qn,Wm).call(this,t,a,n,l,s,i,r,c,3*(-t+3*(a-n)+l),6*(t-2*a+n),3*(a-t),u),_(this,qn,Wm).call(this,t,a,n,l,s,i,r,c,3*(-s+3*(i-r)+c),6*(s-2*i+r),3*(i-s),u),u}}qn=new WeakSet,bh=function(e,t,s,a,i,n,r,l,c,u){if(c<=0||c>=1)return;const h=1-c,d=c*c,f=d*c,g=h*(h*(h*e+3*c*t)+3*d*s)+f*a,v=h*(h*(h*i+3*c*n)+3*d*r)+f*l;u[0]=Math.min(u[0],g),u[1]=Math.min(u[1],v),u[2]=Math.max(u[2],g),u[3]=Math.max(u[3],v)},Wm=function(e,t,s,a,i,n,r,l,c,u,h,d){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&_(this,qn,bh).call(this,e,t,s,a,i,n,r,l,-h/u,d);return}const f=u**2-4*h*c;if(f<0)return;const g=Math.sqrt(f),v=2*c;_(this,qn,bh).call(this,e,t,s,a,i,n,r,l,(-u+g)/v,d),_(this,qn,bh).call(this,e,t,s,a,i,n,r,l,(-u-g)/v,d)},k($,qn);function DM(e){return decodeURIComponent(escape(e))}let Ag=null,Mw=null;function jM(e){return Ag||(Ag=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Mw=new Map([["","t"]])),e.replaceAll(Ag,(t,s,a)=>s?s.normalize("NFKC"):Mw.get(a))}function FM(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const e=new Uint8Array(32);return crypto.getRandomValues(e),ek(e)}const Qb="pdfjs_internal_id_";function OM(e){return Uint8Array.prototype.toBase64?e.toBase64():btoa(ek(e))}typeof Promise.try!="function"&&(Promise.try=function(e,...t){return new Promise(s=>{s(e(...t))})});const Na="http://www.w3.org/2000/svg",Nr=class{};X(Nr,"CSS",96),X(Nr,"PDF",72),X(Nr,"PDF_TO_CSS_UNITS",Nr.CSS/Nr.PDF);let fl=Nr;async function Bp(e,t="text"){if($l(e,document.baseURI)){const s=await fetch(e);if(!s.ok)throw new Error(s.statusText);switch(t){case"arraybuffer":return s.arrayBuffer();case"blob":return s.blob();case"json":return s.json()}return s.text()}return new Promise((s,a)=>{const i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case"arraybuffer":case"blob":case"json":s(i.response);return}s(i.responseText);return}a(new Error(i.statusText))}},i.send(null)})}class Qu{constructor({viewBox:t,userUnit:s,scale:a,rotation:i,offsetX:n=0,offsetY:r=0,dontFlip:l=!1}){this.viewBox=t,this.userUnit=s,this.scale=a,this.rotation=i,this.offsetX=n,this.offsetY=r,a*=s;const c=(t[2]+t[0])/2,u=(t[3]+t[1])/2;let h,d,f,g;switch(i%=360,i<0&&(i+=360),i){case 180:h=-1,d=0,f=0,g=1;break;case 90:h=0,d=1,f=1,g=0;break;case 270:h=0,d=-1,f=-1,g=0;break;case 0:h=1,d=0,f=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(f=-f,g=-g);let v,y,A,b;h===0?(v=Math.abs(u-t[1])*a+n,y=Math.abs(c-t[0])*a+r,A=(t[3]-t[1])*a,b=(t[2]-t[0])*a):(v=Math.abs(c-t[0])*a+n,y=Math.abs(u-t[1])*a+r,A=(t[2]-t[0])*a,b=(t[3]-t[1])*a),this.transform=[h*a,d*a,f*a,g*a,v-h*a*c-f*a*u,y-d*a*c-g*a*u],this.width=A,this.height=b}get rawDims(){const{userUnit:t,viewBox:s}=this,a=s.map(i=>i*t);return tt(this,"rawDims",{pageWidth:a[2]-a[0],pageHeight:a[3]-a[1],pageX:a[0],pageY:a[1]})}clone({scale:t=this.scale,rotation:s=this.rotation,offsetX:a=this.offsetX,offsetY:i=this.offsetY,dontFlip:n=!1}={}){return new Qu({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:s,offsetX:a,offsetY:i,dontFlip:n})}convertToViewportPoint(t,s){return $.applyTransform([t,s],this.transform)}convertToViewportRectangle(t){const s=$.applyTransform([t[0],t[1]],this.transform),a=$.applyTransform([t[2],t[3]],this.transform);return[s[0],s[1],a[0],a[1]]}convertToPdfPoint(t,s){return $.applyInverseTransform([t,s],this.transform)}}class Jb extends yn{constructor(t,s=0){super(t,"RenderingCancelledException"),this.extraDelay=s}}function Up(e){const t=e.length;let s=0;for(;s<t&&e[s].trim()==="";)s++;return e.substring(s,s+5).toLowerCase()==="data:"}function Zb(e){return typeof e=="string"&&/\.pdf$/i.test(e)}function WM(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf("/")+1)}function zM(e,t="document.pdf"){if(typeof e!="string")return t;if(Up(e))return Z('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,a=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=s.exec(e);let n=a.exec(i[1])||a.exec(i[2])||a.exec(i[3]);if(n&&(n=n[0],n.includes("%")))try{n=a.exec(decodeURIComponent(n))[0]}catch{}return n||t}class Nw{constructor(){X(this,"started",Object.create(null)),X(this,"times",[])}time(t){t in this.started&&Z(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Z(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let s=0;for(const{name:a}of this.times)s=Math.max(a.length,s);for(const{name:a,start:i,end:n}of this.times)t.push(`${a.padEnd(s)} ${n-i}ms
`);return t.join("")}}function $l(e,t){try{const{protocol:s}=t?new URL(e,t):new URL(e);return s==="http:"||s==="https:"}catch{return!1}}function ta(e){e.preventDefault()}function cs(e){e.preventDefault(),e.stopPropagation()}var qc;class ty{static toDateObject(t){if(!t||typeof t!="string")return null;o(this,qc)||m(this,qc,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const s=o(this,qc).exec(t);if(!s)return null;const a=parseInt(s[1],10);let i=parseInt(s[2],10);i=i>=1&&i<=12?i-1:0;let n=parseInt(s[3],10);n=n>=1&&n<=31?n:1;let r=parseInt(s[4],10);r=r>=0&&r<=23?r:0;let l=parseInt(s[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(s[6],10);c=c>=0&&c<=59?c:0;const u=s[7]||"Z";let h=parseInt(s[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(s[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(r+=h,l+=d):u==="+"&&(r-=h,l-=d),new Date(Date.UTC(a,i,n,r,l,c))}}qc=new WeakMap,k(ty,qc);function $M(e,{scale:t=1,rotation:s=0}){const{width:a,height:i}=e.attributes.style,n=[0,0,parseInt(a),parseInt(i)];return new Qu({viewBox:n,userUnit:1,scale:t,rotation:s})}function ey(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(t=>parseInt(t)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Z(`Not a valid color format: "${e}"`),[0,0,0])}function BM(e){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const s of e.keys()){t.style.color=s;const a=window.getComputedStyle(t).color;e.set(s,ey(a))}t.remove()}function Et(e){const{a:t,b:s,c:a,d:i,e:n,f:r}=e.getTransform();return[t,s,a,i,n,r]}function aa(e){const{a:t,b:s,c:a,d:i,e:n,f:r}=e.getTransform().invertSelf();return[t,s,a,i,n,r]}function yr(e,t,s=!1,a=!0){if(t instanceof Qu){const{pageWidth:i,pageHeight:n}=t.rawDims,{style:r}=e,l=We.isCSSRoundSupported,c=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${n}px`,h=l?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,d=l?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!s||t.rotation%180===0?(r.width=h,r.height=d):(r.width=d,r.height=h)}a&&e.setAttribute("data-main-rotation",t.rotation)}class sy{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var _n,Pr,Sa,Eo,Bh,Xc,zm,sk,wa,Pw,Tw,Tf,ak,$m;const Uh=class Hh{constructor(t){k(this,wa),k(this,_n,null),k(this,Pr,null),k(this,Sa),k(this,Eo,null),k(this,Bh,null),m(this,Sa,t),o(Hh,Xc)||m(Hh,Xc,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=m(this,_n,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const s=o(this,Sa)._uiManager._signal;t.addEventListener("contextmenu",ta,{signal:s}),t.addEventListener("pointerdown",_(Hh,zm,sk),{signal:s});const a=m(this,Eo,document.createElement("div"));a.className="buttons",t.append(a);const i=o(this,Sa).toolbarPosition;if(i){const{style:n}=t,r=o(this,Sa)._uiManager.direction==="ltr"?1-i[0]:i[0];n.insetInlineEnd=`${100*r}%`,n.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return _(this,wa,ak).call(this),t}get div(){return o(this,_n)}hide(){var t;o(this,_n).classList.add("hidden"),(t=o(this,Pr))==null||t.hideDropdown()}show(){var t;o(this,_n).classList.remove("hidden"),(t=o(this,Bh))==null||t.shown()}async addAltText(t){const s=await t.render();_(this,wa,Tf).call(this,s),o(this,Eo).prepend(s,o(this,wa,$m)),m(this,Bh,t)}addColorPicker(t){m(this,Pr,t);const s=t.renderButton();_(this,wa,Tf).call(this,s),o(this,Eo).prepend(s,o(this,wa,$m))}remove(){var t;o(this,_n).remove(),(t=o(this,Pr))==null||t.destroy(),m(this,Pr,null)}};_n=new WeakMap,Pr=new WeakMap,Sa=new WeakMap,Eo=new WeakMap,Bh=new WeakMap,Xc=new WeakMap,zm=new WeakSet,sk=function(e){e.stopPropagation()},wa=new WeakSet,Pw=function(e){o(this,Sa)._focusEventsAllowed=!1,cs(e)},Tw=function(e){o(this,Sa)._focusEventsAllowed=!0,cs(e)},Tf=function(e){const t=o(this,Sa)._uiManager._signal;e.addEventListener("focusin",_(this,wa,Pw).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",_(this,wa,Tw).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ta,{signal:t})},ak=function(){const{editorType:e,_uiManager:t}=o(this,Sa),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",o(Uh,Xc)[e]),_(this,wa,Tf).call(this,s),s.addEventListener("click",a=>{t.delete()},{signal:t._signal}),o(this,Eo).append(s)},$m=function(){const e=document.createElement("div");return e.className="divider",e},k(Uh,zm),k(Uh,Xc,null);let UM=Uh;var Vh,Xn,Co,Yc,ik,nk,Lw;class HM{constructor(t){k(this,Yc),k(this,Vh,null),k(this,Xn,null),k(this,Co),m(this,Co,t)}show(t,s,a){const[i,n]=_(this,Yc,nk).call(this,s,a),{style:r}=o(this,Xn)||m(this,Xn,_(this,Yc,ik).call(this));t.append(o(this,Xn)),r.insetInlineEnd=`${100*i}%`,r.top=`calc(${100*n}% + var(--editor-toolbar-vert-offset))`}hide(){o(this,Xn).remove()}}Vh=new WeakMap,Xn=new WeakMap,Co=new WeakMap,Yc=new WeakSet,ik=function(){const e=m(this,Xn,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",ta,{signal:o(this,Co)._signal});const t=m(this,Vh,document.createElement("div"));return t.className="buttons",e.append(t),_(this,Yc,Lw).call(this),e},nk=function(e,t){let s=0,a=0;for(const i of e){const n=i.y+i.height;if(n<s)continue;const r=i.x+(t?i.width:0);if(n>s){a=r,s=n;continue}t?r>a&&(a=r):r<a&&(a=r)}return[t?1-a:a,s]},Lw=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=o(this,Co)._signal;e.addEventListener("contextmenu",ta,{signal:s}),e.addEventListener("click",()=>{o(this,Co).highlightSelection("floating_button")},{signal:s}),o(this,Vh).append(e)};function Lf(e,t,s){for(const a of s)t.addEventListener(a,e[a].bind(e))}var Bm;class VM{constructor(){k(this,Bm,0)}get id(){return`${AM}${Je(this,Bm)._++}`}}Bm=new WeakMap;var Kc,Rf,Xt,Bl,Gh;const rk=class{constructor(){k(this,Bl),k(this,Kc,FM()),k(this,Rf,0),k(this,Xt,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const i=a.decode().then(()=>(s.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return tt(this,"_isSVGFittingCanvas",i)}async getFromFile(t){const{lastModified:s,name:a,size:i,type:n}=t;return _(this,Bl,Gh).call(this,`${s}_${a}_${i}_${n}`,t)}async getFromUrl(t){return _(this,Bl,Gh).call(this,t,t)}async getFromBlob(t,s){const a=await s;return _(this,Bl,Gh).call(this,t,a)}async getFromId(t){o(this,Xt)||m(this,Xt,new Map);const s=o(this,Xt).get(t);if(!s)return null;if(s.bitmap)return s.refCounter+=1,s;if(s.file)return this.getFromFile(s.file);if(s.blobPromise){const{blobPromise:a}=s;return delete s.blobPromise,this.getFromBlob(s.id,a)}return this.getFromUrl(s.url)}getFromCanvas(t,s){o(this,Xt)||m(this,Xt,new Map);let a=o(this,Xt).get(t);if(a!=null&&a.bitmap)return a.refCounter+=1,a;const i=new OffscreenCanvas(s.width,s.height);return i.getContext("2d").drawImage(s,0,0),a={bitmap:i.transferToImageBitmap(),id:`image_${o(this,Kc)}_${Je(this,Rf)._++}`,refCounter:1,isSvg:!1},o(this,Xt).set(t,a),o(this,Xt).set(a.id,a),a}getSvgUrl(t){const s=o(this,Xt).get(t);return s!=null&&s.isSvg?s.svgUrl:null}deleteId(t){var s;o(this,Xt)||m(this,Xt,new Map);const a=o(this,Xt).get(t);if(!a||(a.refCounter-=1,a.refCounter!==0))return;const{bitmap:i}=a;if(!a.url&&!a.file){const n=new OffscreenCanvas(i.width,i.height);n.getContext("bitmaprenderer").transferFromImageBitmap(i),a.blobPromise=n.convertToBlob()}(s=i.close)==null||s.call(i),a.bitmap=null}isValidId(t){return t.startsWith(`image_${o(this,Kc)}_`)}};Kc=new WeakMap,Rf=new WeakMap,Xt=new WeakMap,Bl=new WeakSet,Gh=async function(e,t){o(this,Xt)||m(this,Xt,new Map);let s=o(this,Xt).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${o(this,Kc)}_${Je(this,Rf)._++}`,refCounter:0,isSvg:!1});let a;if(typeof t=="string"?(s.url=t,a=await Bp(t,"blob")):t instanceof File?a=s.file=t:t instanceof Blob&&(a=t),a.type==="image/svg+xml"){const i=rk._isSVGFittingCanvas,n=new FileReader,r=new Image,l=new Promise((c,u)=>{r.onload=()=>{s.bitmap=r,s.isSvg=!0,c()},n.onload=async()=>{const h=s.svgUrl=n.result;r.src=await i?`${h}#svgView(preserveAspectRatio(none))`:h},r.onerror=n.onerror=u});n.readAsDataURL(a),await l}else s.bitmap=await createImageBitmap(a);s.refCounter=1}catch(a){Z(a),s=null}return o(this,Xt).set(e,s),s&&o(this,Xt).set(s.id,s),s};let GM=rk;var $t,An,qh,St;class qM{constructor(t=128){k(this,$t,[]),k(this,An,!1),k(this,qh),k(this,St,-1),m(this,qh,t)}add({cmd:t,undo:s,post:a,mustExec:i,type:n=NaN,overwriteIfSameType:r=!1,keepUndo:l=!1}){if(i&&t(),o(this,An))return;const c={cmd:t,undo:s,post:a,type:n};if(o(this,St)===-1){o(this,$t).length>0&&(o(this,$t).length=0),m(this,St,0),o(this,$t).push(c);return}if(r&&o(this,$t)[o(this,St)].type===n){l&&(c.undo=o(this,$t)[o(this,St)].undo),o(this,$t)[o(this,St)]=c;return}const u=o(this,St)+1;u===o(this,qh)?o(this,$t).splice(0,1):(m(this,St,u),u<o(this,$t).length&&o(this,$t).splice(u)),o(this,$t).push(c)}undo(){if(o(this,St)===-1)return;m(this,An,!0);const{undo:t,post:s}=o(this,$t)[o(this,St)];t(),s==null||s(),m(this,An,!1),m(this,St,o(this,St)-1)}redo(){if(o(this,St)<o(this,$t).length-1){m(this,St,o(this,St)+1),m(this,An,!0);const{cmd:t,post:s}=o(this,$t)[o(this,St)];t(),s==null||s(),m(this,An,!1)}}hasSomethingToUndo(){return o(this,St)!==-1}hasSomethingToRedo(){return o(this,St)<o(this,$t).length-1}cleanType(t){if(o(this,St)!==-1){for(let s=o(this,St);s>=0;s--)if(o(this,$t)[s].type!==t){o(this,$t).splice(s+1,o(this,St)-s),m(this,St,s);return}o(this,$t).length=0,m(this,St,-1)}}destroy(){m(this,$t,null)}}$t=new WeakMap,An=new WeakMap,qh=new WeakMap,St=new WeakMap;var Um,ok;class Ju{constructor(t){k(this,Um),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:s}=We.platform;for(const[a,i,n={}]of t)for(const r of a){const l=r.startsWith("mac+");s&&l?(this.callbacks.set(r.slice(4),{callback:i,options:n}),this.allKeys.add(r.split("+").at(-1))):!s&&!l&&(this.callbacks.set(r,{callback:i,options:n}),this.allKeys.add(r.split("+").at(-1)))}}exec(t,s){if(!this.allKeys.has(s.key))return;const a=this.callbacks.get(_(this,Um,ok).call(this,s));if(!a)return;const{callback:i,options:{bubbles:n=!1,args:r=[],checker:l=null}}=a;l&&!l(t,s)||(i.bind(t,...r,s)(),n||cs(s))}}Um=new WeakSet,ok=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const lk=class ck{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return BM(t),tt(this,"_colors",t)}convert(t){const s=ey(t);if(!window.matchMedia("(forced-colors: active)").matches)return s;for(const[a,i]of this._colors)if(i.every((n,r)=>n===s[r]))return ck._colorsMapping.get(a);return s}getHexCode(t){const s=this._colors.get(t);return s?$.makeHexColor(...s):t}};X(lk,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let XM=lk;var Ul,vs,Zt,ke,Hl,fi,Tr,zs,Sn,Lr,Vl,Rr,Pa,na,Ir,If,Xh,Gl,Yh,Ta,En,ql,Yn,pa,Hm,Kn,Kh,Cn,Dr,Qh,Jh,de,bt,pi,jr,Xl,Zh,Mn,La,gi,td,$s,H,ed,Vm,Rw,Iw,Df,uk,hk,dk,Gm,fk,qm,Xm,pk,Ie,Ua,gk,mk,Ym,vk,Yl,Km;const Qm=class Jm{constructor(t,s,a,i,n,r,l,c,u,h,d,f,g){k(this,H),k(this,Ul,new AbortController),k(this,vs,null),k(this,Zt,new Map),k(this,ke,new Map),k(this,Hl,null),k(this,fi,null),k(this,Tr,null),k(this,zs,new qM),k(this,Sn,null),k(this,Lr,null),k(this,Vl,0),k(this,Rr,new Set),k(this,Pa,null),k(this,na,null),k(this,Ir,new Set),X(this,"_editorUndoBar",null),k(this,If,!1),k(this,Xh,!1),k(this,Gl,!1),k(this,Yh,null),k(this,Ta,null),k(this,En,null),k(this,ql,null),k(this,Yn,!1),k(this,pa,null),k(this,Hm,new VM),k(this,Kn,!1),k(this,Kh,!1),k(this,Cn,null),k(this,Dr,null),k(this,Qh,null),k(this,Jh,null),k(this,de,J.NONE),k(this,bt,new Set),k(this,pi,null),k(this,jr,null),k(this,Xl,null),k(this,Zh,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),k(this,Mn,[0,0]),k(this,La,null),k(this,gi,null),k(this,td,null),k(this,$s,null);const v=this._signal=o(this,Ul).signal;m(this,gi,t),m(this,td,s),m(this,Hl,a),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:v}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),i._on("setpreference",this.onSetPreference.bind(this),{signal:v}),i._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:v}),_(this,H,uk).call(this),_(this,H,pk).call(this),_(this,H,Gm).call(this),m(this,fi,n.annotationStorage),m(this,Yh,n.filterFactory),m(this,jr,r),m(this,ql,l||null),m(this,If,c),m(this,Xh,u),m(this,Gl,h),m(this,Jh,d||null),this.viewParameters={realScale:fl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=g!==!1}static get _keyboardManager(){const t=Jm.prototype,s=r=>o(r,gi).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&r.hasSomethingToControl(),a=(r,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,n=this.TRANSLATE_BIG;return tt(this,"_keyboardManager",new Ju([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:a}],[["ctrl+z","mac+meta+z"],t.undo,{checker:a}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:a}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:a}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(r,{target:l})=>!(l instanceof HTMLButtonElement)&&o(r,gi).contains(l)&&!r.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(r,{target:l})=>!(l instanceof HTMLButtonElement)&&o(r,gi).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-n,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[n,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-n],checker:s}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,n],checker:s}]]))}destroy(){var t,s,a,i,n;(t=o(this,$s))==null||t.resolve(),m(this,$s,null),(s=o(this,Ul))==null||s.abort(),m(this,Ul,null),this._signal=null;for(const r of o(this,ke).values())r.destroy();o(this,ke).clear(),o(this,Zt).clear(),o(this,Ir).clear(),m(this,vs,null),o(this,bt).clear(),o(this,zs).destroy(),(a=o(this,Hl))==null||a.destroy(),(i=o(this,pa))==null||i.hide(),m(this,pa,null),o(this,Ta)&&(clearTimeout(o(this,Ta)),m(this,Ta,null)),o(this,La)&&(clearTimeout(o(this,La)),m(this,La,null)),(n=this._editorUndoBar)==null||n.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return o(this,Jh)}get useNewAltTextFlow(){return o(this,Xh)}get useNewAltTextWhenAddingImage(){return o(this,Gl)}get hcmFilter(){return tt(this,"hcmFilter",o(this,jr)?o(this,Yh).addHCMFilter(o(this,jr).foreground,o(this,jr).background):"none")}get direction(){return tt(this,"direction",getComputedStyle(o(this,gi)).direction)}get highlightColors(){return tt(this,"highlightColors",o(this,ql)?new Map(o(this,ql).split(",").map(t=>t.split("=").map(s=>s.trim()))):null)}get highlightColorNames(){return tt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),m(this,Lr,t)}setMainHighlightColorPicker(t){m(this,Qh,t)}editAltText(t,s=!1){var a;(a=o(this,Hl))==null||a.editAltText(this,t,s)}switchToMode(t,s){this._eventBus.on("annotationeditormodechanged",s,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,s){this._eventBus.dispatch("setpreference",{source:this,name:t,value:s})}onSetPreference({name:t,value:s}){switch(t){case"enableNewAltTextWhenAddingImage":m(this,Gl,s);break}}onPageChanging({pageNumber:t}){m(this,Vl,t-1)}focusMainContainer(){o(this,gi).focus()}findParent(t,s){for(const a of o(this,ke).values()){const{x:i,y:n,width:r,height:l}=a.div.getBoundingClientRect();if(t>=i&&t<=i+r&&s>=n&&s<=n+l)return a}return null}disableUserSelect(t=!1){o(this,td).classList.toggle("noUserSelect",t)}addShouldRescale(t){o(this,Ir).add(t)}removeShouldRescale(t){o(this,Ir).delete(t)}onScaleChanging({scale:t}){var s;this.commitOrRemove(),this.viewParameters.realScale=t*fl.PDF_TO_CSS_UNITS;for(const a of o(this,Ir))a.onScaleChanging();(s=o(this,Lr))==null||s.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const s=document.getSelection();if(!s||s.isCollapsed)return;const{anchorNode:a,anchorOffset:i,focusNode:n,focusOffset:r}=s,l=s.toString(),c=_(this,H,ed).call(this,s).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;s.empty();const h=_(this,H,Vm).call(this,c),d=o(this,de)===J.NONE,f=()=>{h==null||h.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:u,anchorNode:a,anchorOffset:i,focusNode:n,focusOffset:r,text:l}),d&&this.showAllEditors("highlight",!0,!0)};if(d){this.switchToMode(J.HIGHLIGHT,f);return}f()}addToAnnotationStorage(t){!t.isEmpty()&&o(this,fi)&&!o(this,fi).has(t.id)&&o(this,fi).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,o(this,Yn)&&(m(this,Yn,!1),_(this,H,Df).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const s of o(this,bt))if(s.div.contains(t)){m(this,Dr,[s,t]),s._focusEventsAllowed=!1;break}}focus(){if(!o(this,Dr))return;const[t,s]=o(this,Dr);m(this,Dr,null),s.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),s.focus()}addEditListeners(){_(this,H,Gm).call(this),_(this,H,qm).call(this)}removeEditListeners(){_(this,H,fk).call(this),_(this,H,Xm).call(this)}dragOver(t){for(const{type:s}of t.dataTransfer.items)for(const a of o(this,na))if(a.isHandlingMimeForPasting(s)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const s of t.dataTransfer.items)for(const a of o(this,na))if(a.isHandlingMimeForPasting(s.type)){a.paste(s,this.currentLayer),t.preventDefault();return}}copy(t){var s;if(t.preventDefault(),(s=o(this,vs))==null||s.commitOrRemove(),!this.hasSelection)return;const a=[];for(const i of o(this,bt)){const n=i.serialize(!0);n&&a.push(n)}a.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(a))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:s}=t;for(const n of s.items)for(const r of o(this,na))if(r.isHandlingMimeForPasting(n.type)){r.paste(n,this.currentLayer);return}let a=s.getData("application/pdfjs");if(!a)return;try{a=JSON.parse(a)}catch(n){Z(`paste: "${n.message}".`);return}if(!Array.isArray(a))return;this.unselectAll();const i=this.currentLayer;try{const n=[];for(const c of a){const u=await i.deserialize(c);if(!u)return;n.push(u)}const r=()=>{for(const c of n)_(this,H,Ym).call(this,c);_(this,H,Km).call(this,n)},l=()=>{for(const c of n)c.remove()};this.addCommands({cmd:r,undo:l,mustExec:!0})}catch(n){Z(`paste: "${n.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),o(this,de)!==J.NONE&&!this.isEditorHandlingKeyboard&&Jm._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,o(this,Yn)&&(m(this,Yn,!1),_(this,H,Df).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(_(this,H,hk).call(this),_(this,H,qm).call(this),_(this,H,Ie).call(this,{isEditing:o(this,de)!==J.NONE,isEmpty:_(this,H,Yl).call(this),hasSomethingToUndo:o(this,zs).hasSomethingToUndo(),hasSomethingToRedo:o(this,zs).hasSomethingToRedo(),hasSelectedEditor:!1})):(_(this,H,dk).call(this),_(this,H,Xm).call(this),_(this,H,Ie).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!o(this,na)){m(this,na,t);for(const s of o(this,na))_(this,H,Ua).call(this,s.defaultPropertiesToUpdate)}}getId(){return o(this,Hm).id}get currentLayer(){return o(this,ke).get(o(this,Vl))}getLayer(t){return o(this,ke).get(t)}get currentPageIndex(){return o(this,Vl)}addLayer(t){o(this,ke).set(t.pageIndex,t),o(this,Kn)?t.enable():t.disable()}removeLayer(t){o(this,ke).delete(t.pageIndex)}async updateMode(t,s=null,a=!1){var i;if(o(this,de)!==t&&!(o(this,$s)&&(await o(this,$s).promise,!o(this,$s)))){if(m(this,$s,Promise.withResolvers()),m(this,de,t),t===J.NONE){this.setEditingState(!1),_(this,H,mk).call(this),(i=this._editorUndoBar)==null||i.hide(),o(this,$s).resolve();return}this.setEditingState(!0),await _(this,H,gk).call(this),this.unselectAll();for(const n of o(this,ke).values())n.updateMode(t);if(!s){a&&this.addNewEditorFromKeyboard(),o(this,$s).resolve();return}for(const n of o(this,Zt).values())n.annotationElementId===s?(this.setSelected(n),n.enterInEditMode()):n.unselect();o(this,$s).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==o(this,de)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,s){var a;if(o(this,na)){switch(t){case it.CREATE:this.currentLayer.addNewEditor();return;case it.HIGHLIGHT_DEFAULT_COLOR:(a=o(this,Qh))==null||a.updateColor(s);break;case it.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(o(this,Xl)||m(this,Xl,new Map)).set(t,s),this.showAllEditors("highlight",s);break}for(const i of o(this,bt))i.updateParams(t,s);for(const i of o(this,na))i.updateDefaultParams(t,s)}}showAllEditors(t,s,a=!1){var i;for(const n of o(this,Zt).values())n.editorType===t&&n.show(s);(((i=o(this,Xl))==null?void 0:i.get(it.HIGHLIGHT_SHOW_ALL))??!0)!==s&&_(this,H,Ua).call(this,[[it.HIGHLIGHT_SHOW_ALL,s]])}enableWaiting(t=!1){if(o(this,Kh)!==t){m(this,Kh,t);for(const s of o(this,ke).values())t?s.disableClick():s.enableClick(),s.div.classList.toggle("waiting",t)}}getEditors(t){const s=[];for(const a of o(this,Zt).values())a.pageIndex===t&&s.push(a);return s}getEditor(t){return o(this,Zt).get(t)}addEditor(t){o(this,Zt).set(t.id,t)}removeEditor(t){var s;t.div.contains(document.activeElement)&&(o(this,Ta)&&clearTimeout(o(this,Ta)),m(this,Ta,setTimeout(()=>{this.focusMainContainer(),m(this,Ta,null)},0))),o(this,Zt).delete(t.id),this.unselect(t),(!t.annotationElementId||!o(this,Rr).has(t.annotationElementId))&&((s=o(this,fi))==null||s.remove(t.id))}addDeletedAnnotationElement(t){o(this,Rr).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return o(this,Rr).has(t)}removeDeletedAnnotationElement(t){o(this,Rr).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){o(this,vs)!==t&&(m(this,vs,t),t&&_(this,H,Ua).call(this,t.propertiesToUpdate))}updateUI(t){o(this,H,vk)===t&&_(this,H,Ua).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){_(this,H,Ua).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(o(this,bt).has(t)){o(this,bt).delete(t),t.unselect(),_(this,H,Ie).call(this,{hasSelectedEditor:this.hasSelection});return}o(this,bt).add(t),t.select(),_(this,H,Ua).call(this,t.propertiesToUpdate),_(this,H,Ie).call(this,{hasSelectedEditor:!0})}setSelected(t){var s;(s=o(this,Lr))==null||s.commitOrRemove();for(const a of o(this,bt))a!==t&&a.unselect();o(this,bt).clear(),o(this,bt).add(t),t.select(),_(this,H,Ua).call(this,t.propertiesToUpdate),_(this,H,Ie).call(this,{hasSelectedEditor:!0})}isSelected(t){return o(this,bt).has(t)}get firstSelectedEditor(){return o(this,bt).values().next().value}unselect(t){t.unselect(),o(this,bt).delete(t),_(this,H,Ie).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return o(this,bt).size!==0}get isEnterHandled(){return o(this,bt).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;o(this,zs).undo(),_(this,H,Ie).call(this,{hasSomethingToUndo:o(this,zs).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_(this,H,Yl).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){o(this,zs).redo(),_(this,H,Ie).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:o(this,zs).hasSomethingToRedo(),isEmpty:_(this,H,Yl).call(this)})}addCommands(t){o(this,zs).add(t),_(this,H,Ie).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_(this,H,Yl).call(this)})}cleanUndoStack(t){o(this,zs).cleanType(t)}delete(){var t;this.commitOrRemove();const s=(t=this.currentLayer)==null?void 0:t.endDrawingSession(!0);if(!this.hasSelection&&!s)return;const a=s?[s]:[...o(this,bt)],i=()=>{var r;(r=this._editorUndoBar)==null||r.show(n,a.length===1?a[0].editorType:a.length);for(const l of a)l.remove()},n=()=>{for(const r of a)_(this,H,Ym).call(this,r)};this.addCommands({cmd:i,undo:n,mustExec:!0})}commitOrRemove(){var t;(t=o(this,vs))==null||t.commitOrRemove()}hasSomethingToControl(){return o(this,vs)||this.hasSelection}selectAll(){for(const t of o(this,bt))t.commit();_(this,H,Km).call(this,o(this,Zt).values())}unselectAll(){var t;if(!(o(this,vs)&&(o(this,vs).commitOrRemove(),o(this,de)!==J.NONE))&&!((t=o(this,Lr))!=null&&t.commitOrRemove())&&this.hasSelection){for(const s of o(this,bt))s.unselect();o(this,bt).clear(),_(this,H,Ie).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,s,a=!1){if(a||this.commitOrRemove(),!this.hasSelection)return;o(this,Mn)[0]+=t,o(this,Mn)[1]+=s;const[i,n]=o(this,Mn),r=[...o(this,bt)];o(this,La)&&clearTimeout(o(this,La)),m(this,La,setTimeout(()=>{m(this,La,null),o(this,Mn)[0]=o(this,Mn)[1]=0,this.addCommands({cmd:()=>{for(const c of r)o(this,Zt).has(c.id)&&c.translateInPage(i,n)},undo:()=>{for(const c of r)o(this,Zt).has(c.id)&&c.translateInPage(-i,-n)},mustExec:!1})},1e3));for(const c of r)c.translateInPage(t,s)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,Pa,new Map);for(const t of o(this,bt))o(this,Pa).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!o(this,Pa))return!1;this.disableUserSelect(!1);const t=o(this,Pa);m(this,Pa,null);let s=!1;for(const[{x:i,y:n,pageIndex:r},l]of t)l.newX=i,l.newY=n,l.newPageIndex=r,s||(s=i!==l.savedX||n!==l.savedY||r!==l.savedPageIndex);if(!s)return!1;const a=(i,n,r,l)=>{if(o(this,Zt).has(i.id)){const c=o(this,ke).get(l);c?i._setParentAndPosition(c,n,r):(i.pageIndex=l,i.x=n,i.y=r)}};return this.addCommands({cmd:()=>{for(const[i,{newX:n,newY:r,newPageIndex:l}]of t)a(i,n,r,l)},undo:()=>{for(const[i,{savedX:n,savedY:r,savedPageIndex:l}]of t)a(i,n,r,l)},mustExec:!0}),!0}dragSelectedEditors(t,s){if(o(this,Pa))for(const a of o(this,Pa).keys())a.drag(t,s)}rebuild(t){if(t.parent===null){const s=this.getLayer(t.pageIndex);s?(s.changeParent(t),s.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||o(this,bt).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return o(this,vs)===t}getActive(){return o(this,vs)}getMode(){return o(this,de)}get imageManager(){return tt(this,"imageManager",new GM)}getSelectionBoxes(t){if(!t)return null;const s=document.getSelection();for(let u=0,h=s.rangeCount;u<h;u++)if(!t.contains(s.getRangeAt(u).commonAncestorContainer))return null;const{x:a,y:i,width:n,height:r}=t.getBoundingClientRect();let l;switch(t.getAttribute("data-main-rotation")){case"90":l=(u,h,d,f)=>({x:(h-i)/r,y:1-(u+d-a)/n,width:f/r,height:d/n});break;case"180":l=(u,h,d,f)=>({x:1-(u+d-a)/n,y:1-(h+f-i)/r,width:d/n,height:f/r});break;case"270":l=(u,h,d,f)=>({x:1-(h+f-i)/r,y:(u-a)/n,width:f/r,height:d/n});break;default:l=(u,h,d,f)=>({x:(u-a)/n,y:(h-i)/r,width:d/n,height:f/r});break}const c=[];for(let u=0,h=s.rangeCount;u<h;u++){const d=s.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:g,width:v,height:y}of d.getClientRects())v===0||y===0||c.push(l(f,g,v,y))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:t,id:s}){(o(this,Tr)||m(this,Tr,new Map)).set(t,s)}removeChangedExistingAnnotation({annotationElementId:t}){var s;(s=o(this,Tr))==null||s.delete(t)}renderAnnotationElement(t){var s;const a=(s=o(this,Tr))==null?void 0:s.get(t.data.id);if(!a)return;const i=o(this,fi).getRawValue(a);i&&(o(this,de)===J.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}};Ul=new WeakMap,vs=new WeakMap,Zt=new WeakMap,ke=new WeakMap,Hl=new WeakMap,fi=new WeakMap,Tr=new WeakMap,zs=new WeakMap,Sn=new WeakMap,Lr=new WeakMap,Vl=new WeakMap,Rr=new WeakMap,Pa=new WeakMap,na=new WeakMap,Ir=new WeakMap,If=new WeakMap,Xh=new WeakMap,Gl=new WeakMap,Yh=new WeakMap,Ta=new WeakMap,En=new WeakMap,ql=new WeakMap,Yn=new WeakMap,pa=new WeakMap,Hm=new WeakMap,Kn=new WeakMap,Kh=new WeakMap,Cn=new WeakMap,Dr=new WeakMap,Qh=new WeakMap,Jh=new WeakMap,de=new WeakMap,bt=new WeakMap,pi=new WeakMap,jr=new WeakMap,Xl=new WeakMap,Zh=new WeakMap,Mn=new WeakMap,La=new WeakMap,gi=new WeakMap,td=new WeakMap,$s=new WeakMap,H=new WeakSet,ed=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Vm=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of o(this,ke).values())if(s.hasTextLayer(e))return s;return null},Rw=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const t=_(this,H,ed).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(t);s&&(o(this,pa)||m(this,pa,new HM(this)),o(this,pa).show(t,s,this.direction==="ltr"))},Iw=function(){var e,t,s;const a=document.getSelection();if(!a||a.isCollapsed){o(this,pi)&&((e=o(this,pa))==null||e.hide(),m(this,pi,null),_(this,H,Ie).call(this,{hasSelectedText:!1}));return}const{anchorNode:i}=a;if(i===o(this,pi))return;const n=_(this,H,ed).call(this,a).closest(".textLayer");if(!n){o(this,pi)&&((t=o(this,pa))==null||t.hide(),m(this,pi,null),_(this,H,Ie).call(this,{hasSelectedText:!1}));return}if((s=o(this,pa))==null||s.hide(),m(this,pi,i),_(this,H,Ie).call(this,{hasSelectedText:!0}),!(o(this,de)!==J.HIGHLIGHT&&o(this,de)!==J.NONE)&&(o(this,de)===J.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Yn,this.isShiftKeyDown),!this.isShiftKeyDown)){const r=o(this,de)===J.HIGHLIGHT?_(this,H,Vm).call(this,n):null;r==null||r.toggleDrawing();const l=new AbortController,c=this.combinedSignal(l),u=h=>{h.type==="pointerup"&&h.button!==0||(l.abort(),r==null||r.toggleDrawing(!0),h.type==="pointerup"&&_(this,H,Df).call(this,"main_toolbar"))};window.addEventListener("pointerup",u,{signal:c}),window.addEventListener("blur",u,{signal:c})}},Df=function(e=""){o(this,de)===J.HIGHLIGHT?this.highlightSelection(e):o(this,If)&&_(this,H,Rw).call(this)},uk=function(){document.addEventListener("selectionchange",_(this,H,Iw).bind(this),{signal:this._signal})},hk=function(){if(o(this,En))return;m(this,En,new AbortController);const e=this.combinedSignal(o(this,En));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},dk=function(){var e;(e=o(this,En))==null||e.abort(),m(this,En,null)},Gm=function(){if(o(this,Cn))return;m(this,Cn,new AbortController);const e=this.combinedSignal(o(this,Cn));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},fk=function(){var e;(e=o(this,Cn))==null||e.abort(),m(this,Cn,null)},qm=function(){if(o(this,Sn))return;m(this,Sn,new AbortController);const e=this.combinedSignal(o(this,Sn));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Xm=function(){var e;(e=o(this,Sn))==null||e.abort(),m(this,Sn,null)},pk=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ie=function(e){Object.entries(e).some(([t,s])=>o(this,Zh)[t]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(o(this,Zh),e)}),o(this,de)===J.HIGHLIGHT&&e.hasSelectedEditor===!1&&_(this,H,Ua).call(this,[[it.HIGHLIGHT_FREE,!0]]))},Ua=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},gk=async function(){if(!o(this,Kn)){m(this,Kn,!0);const e=[];for(const t of o(this,ke).values())e.push(t.enable());await Promise.all(e);for(const t of o(this,Zt).values())t.enable()}},mk=function(){if(this.unselectAll(),o(this,Kn)){m(this,Kn,!1);for(const e of o(this,ke).values())e.disable();for(const e of o(this,Zt).values())e.disable()}},Ym=function(e){const t=o(this,ke).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},vk=function(){let e=null;for(e of o(this,bt));return e},Yl=function(){if(o(this,Zt).size===0)return!0;if(o(this,Zt).size===1)for(const e of o(this,Zt).values())return e.isEmpty();return!1},Km=function(e){for(const t of o(this,bt))t.unselect();o(this,bt).clear();for(const t of e)t.isEmpty()||(o(this,bt).add(t),t.select());_(this,H,Ie).call(this,{hasSelectedEditor:this.hasSelection})},X(Qm,"TRANSLATE_SMALL",1),X(Qm,"TRANSLATE_BIG",10);let Uu=Qm;var fe,Xa,ca,Qc,Ha,Ss,Kl,Ra,os,mi,Fr,Va,Ki,Ya,Jc,sd;const Ql=class vi{constructor(t){k(this,Ya),k(this,fe,null),k(this,Xa,!1),k(this,ca,null),k(this,Qc,null),k(this,Ha,null),k(this,Ss,null),k(this,Kl,!1),k(this,Ra,null),k(this,os,null),k(this,mi,null),k(this,Fr,null),k(this,Va,!1),m(this,os,t),m(this,Va,t._uiManager.useNewAltTextFlow),o(vi,Ki)||m(vi,Ki,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){vi._l10n??(vi._l10n=t)}async render(){const t=m(this,ca,document.createElement("button"));t.className="altText",t.tabIndex="0";const s=m(this,Qc,document.createElement("span"));t.append(s),o(this,Va)?(t.classList.add("new"),t.setAttribute("data-l10n-id",o(vi,Ki).missing),s.setAttribute("data-l10n-id",o(vi,Ki)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),s.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const a=o(this,os)._uiManager._signal;t.addEventListener("contextmenu",ta,{signal:a}),t.addEventListener("pointerdown",n=>n.stopPropagation(),{signal:a});const i=n=>{n.preventDefault(),o(this,os)._uiManager.editAltText(o(this,os)),o(this,Va)&&o(this,os)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:o(this,Ya,Jc)}})};return t.addEventListener("click",i,{capture:!0,signal:a}),t.addEventListener("keydown",n=>{n.target===t&&n.key==="Enter"&&(m(this,Kl,!0),i(n))},{signal:a}),await _(this,Ya,sd).call(this),t}finish(){o(this,ca)&&(o(this,ca).focus({focusVisible:o(this,Kl)}),m(this,Kl,!1))}isEmpty(){return o(this,Va)?o(this,fe)===null:!o(this,fe)&&!o(this,Xa)}hasData(){return o(this,Va)?o(this,fe)!==null||!!o(this,mi):this.isEmpty()}get guessedText(){return o(this,mi)}async setGuessedText(t){o(this,fe)===null&&(m(this,mi,t),m(this,Fr,await vi._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),_(this,Ya,sd).call(this))}toggleAltTextBadge(t=!1){var s;if(!o(this,Va)||o(this,fe)){(s=o(this,Ra))==null||s.remove(),m(this,Ra,null);return}if(!o(this,Ra)){const a=m(this,Ra,document.createElement("div"));a.className="noAltTextBadge",o(this,os).div.append(a)}o(this,Ra).classList.toggle("hidden",!t)}serialize(t){let s=o(this,fe);return!t&&o(this,mi)===s&&(s=o(this,Fr)),{altText:s,decorative:o(this,Xa),guessedText:o(this,mi),textWithDisclaimer:o(this,Fr)}}get data(){return{altText:o(this,fe),decorative:o(this,Xa)}}set data({altText:t,decorative:s,guessedText:a,textWithDisclaimer:i,cancel:n=!1}){a&&(m(this,mi,a),m(this,Fr,i)),!(o(this,fe)===t&&o(this,Xa)===s)&&(n||(m(this,fe,t),m(this,Xa,s)),_(this,Ya,sd).call(this))}toggle(t=!1){o(this,ca)&&(!t&&o(this,Ss)&&(clearTimeout(o(this,Ss)),m(this,Ss,null)),o(this,ca).disabled=!t)}shown(){o(this,os)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:o(this,Ya,Jc)}})}destroy(){var t,s;(t=o(this,ca))==null||t.remove(),m(this,ca,null),m(this,Qc,null),m(this,Ha,null),(s=o(this,Ra))==null||s.remove(),m(this,Ra,null)}};fe=new WeakMap,Xa=new WeakMap,ca=new WeakMap,Qc=new WeakMap,Ha=new WeakMap,Ss=new WeakMap,Kl=new WeakMap,Ra=new WeakMap,os=new WeakMap,mi=new WeakMap,Fr=new WeakMap,Va=new WeakMap,Ki=new WeakMap,Ya=new WeakSet,Jc=function(){return o(this,fe)&&"added"||o(this,fe)===null&&this.guessedText&&"review"||"missing"},sd=async function(){var e,t,s;const a=o(this,ca);if(!a)return;if(o(this,Va)){if(a.classList.toggle("done",!!o(this,fe)),a.setAttribute("data-l10n-id",o(Ql,Ki)[o(this,Ya,Jc)]),(e=o(this,Qc))==null||e.setAttribute("data-l10n-id",o(Ql,Ki)[`${o(this,Ya,Jc)}-label`]),!o(this,fe)){(t=o(this,Ha))==null||t.remove();return}}else{if(!o(this,fe)&&!o(this,Xa)){a.classList.remove("done"),(s=o(this,Ha))==null||s.remove();return}a.classList.add("done"),a.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let i=o(this,Ha);if(!i){m(this,Ha,i=document.createElement("span")),i.className="tooltip",i.setAttribute("role","tooltip"),i.id=`alt-text-tooltip-${o(this,os).id}`;const r=100,l=o(this,os)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(o(this,Ss)),m(this,Ss,null)},{once:!0}),a.addEventListener("mouseenter",()=>{m(this,Ss,setTimeout(()=>{m(this,Ss,null),o(this,Ha).classList.add("show"),o(this,os)._reportTelemetry({action:"alt_text_tooltip"})},r))},{signal:l}),a.addEventListener("mouseleave",()=>{var c;o(this,Ss)&&(clearTimeout(o(this,Ss)),m(this,Ss,null)),(c=o(this,Ha))==null||c.classList.remove("show")},{signal:l})}o(this,Xa)?i.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(i.removeAttribute("data-l10n-id"),i.textContent=o(this,fe)),i.parentNode||a.append(i);const n=o(this,os).getImageForAltText();n==null||n.setAttribute("aria-describedby",i.id)},k(Ql,Ki,null),X(Ql,"_l10n",null);let Dw=Ql;var jf,Or,Ff,Of,Wf,zf,$f,Zc,bi,Wr,Nn,Mo,bk,jw,Sg;const yk=class{constructor({container:t,isPinchingDisabled:s=null,isPinchingStopped:a=null,onPinchStart:i=null,onPinching:n=null,onPinchEnd:r=null,signal:l}){k(this,Mo),k(this,jf),k(this,Or,!1),k(this,Ff,null),k(this,Of),k(this,Wf),k(this,zf),k(this,$f),k(this,Zc),k(this,bi,null),k(this,Wr),k(this,Nn,null),m(this,jf,t),m(this,Ff,a),m(this,Of,s),m(this,Wf,i),m(this,zf,n),m(this,$f,r),m(this,Wr,new AbortController),m(this,Zc,AbortSignal.any([l,o(this,Wr).signal])),t.addEventListener("touchstart",_(this,Mo,bk).bind(this),{passive:!1,signal:o(this,Zc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return tt(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var t;(t=o(this,Wr))==null||t.abort(),m(this,Wr,null)}};jf=new WeakMap,Or=new WeakMap,Ff=new WeakMap,Of=new WeakMap,Wf=new WeakMap,zf=new WeakMap,$f=new WeakMap,Zc=new WeakMap,bi=new WeakMap,Wr=new WeakMap,Nn=new WeakMap,Mo=new WeakSet,bk=function(e){var t,s,a;if((t=o(this,Of))!=null&&t.call(this)||e.touches.length<2)return;if(!o(this,Nn)){m(this,Nn,new AbortController);const r=AbortSignal.any([o(this,Zc),o(this,Nn).signal]),l=o(this,jf),c={signal:r,passive:!1};l.addEventListener("touchmove",_(this,Mo,jw).bind(this),c),l.addEventListener("touchend",_(this,Mo,Sg).bind(this),c),l.addEventListener("touchcancel",_(this,Mo,Sg).bind(this),c),(s=o(this,Wf))==null||s.call(this)}if(cs(e),e.touches.length!==2||(a=o(this,Ff))!=null&&a.call(this)){m(this,bi,null);return}let[i,n]=e.touches;i.identifier>n.identifier&&([i,n]=[n,i]),m(this,bi,{touch0X:i.screenX,touch0Y:i.screenY,touch1X:n.screenX,touch1Y:n.screenY})},jw=function(e){var t;if(!o(this,bi)||e.touches.length!==2)return;let[s,a]=e.touches;s.identifier>a.identifier&&([s,a]=[a,s]);const{screenX:i,screenY:n}=s,{screenX:r,screenY:l}=a,c=o(this,bi),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,g=d-u,v=f-h,y=r-i,A=l-n,b=Math.hypot(y,A)||1,x=Math.hypot(g,v)||1;if(!o(this,Or)&&Math.abs(x-b)<=yk.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=n,c.touch1X=r,c.touch1Y=l,e.preventDefault(),!o(this,Or)){m(this,Or,!0);return}const w=[(i+r)/2,(n+l)/2];(t=o(this,zf))==null||t.call(this,w,x,b)},Sg=function(e){var t;o(this,Nn).abort(),m(this,Nn,null),(t=o(this,$f))==null||t.call(this),o(this,bi)&&(e.preventDefault(),m(this,bi,null),m(this,Or,!1))};let wk=yk;var zr,ga,Ct,Jl,Pn,ad,$r,Se,Br,Pi,ar,Bf,No,_e,id,Ur,Qi,Ia,Zl,tc,bs,Qn,nd,Zm,ot,tv,Uf,ev,yh,xk,Fw,Eg,wh,sv,kk,_k,Ak,av,Sk,iv,Ek,Ck,Mk,nv,tu;const Ft=class ie{constructor(t){k(this,ot),k(this,zr,null),k(this,ga,null),k(this,Ct,null),k(this,Jl,!1),k(this,Pn,null),k(this,ad,""),k(this,$r,!1),k(this,Se,null),k(this,Br,null),k(this,Pi,null),k(this,ar,null),k(this,Bf,""),k(this,No,!1),k(this,_e,null),k(this,id,!1),k(this,Ur,!1),k(this,Qi,!1),k(this,Ia,null),k(this,Zl,0),k(this,tc,0),k(this,bs,null),k(this,Qn,null),X(this,"_editToolbar",null),X(this,"_initialOptions",Object.create(null)),X(this,"_initialData",null),X(this,"_isVisible",!0),X(this,"_uiManager",null),X(this,"_focusEventsAllowed",!0),k(this,nd,!1),k(this,Zm,ie._zIndex++),this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:s,rawDims:{pageWidth:a,pageHeight:i,pageX:n,pageY:r}}=this.parent.viewport;this.rotation=s,this.pageRotation=(360+s-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[a,i],this.pageTranslation=[n,r];const[l,c]=this.parentDimensions;this.x=t.x/l,this.y=t.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=ie.prototype._resizeWithKeyboard,s=Uu.TRANSLATE_SMALL,a=Uu.TRANSLATE_BIG;return tt(this,"_resizerKeyboardManager",new Ju([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-s,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-a,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[s,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[a,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-s]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-a]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,s]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,a]}],[["Escape","mac+Escape"],ie.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return tt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const s=new YM({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});s.annotationElementId=t.annotationElementId,s.deleted=!0,s._uiManager.addToAnnotationStorage(s)}static initialize(t,s){if(ie._l10n??(ie._l10n=t),ie._l10nResizer||(ie._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ie._borderLineWidth!==-1)return;const a=getComputedStyle(document.documentElement);ie._borderLineWidth=parseFloat(a.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,s){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,s){yt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return o(this,nd)}set _isDraggable(t){var s;m(this,nd,t),(s=this.div)==null||s.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,s]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*s/(t*2),this.y+=this.width*t/(s*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*s/(t*2),this.y-=this.width*t/(s*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=o(this,Zm)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):_(this,ot,tu).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(o(this,No)?m(this,No,!1):this.parent.setSelected(this))}focusout(t){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const a=t.relatedTarget;a!=null&&a.closest(`#${this.id}`)||(t.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,s,a,i){const[n,r]=this.parentDimensions;[a,i]=this.screenToPageTranslation(a,i),this.x=(t+a)/n,this.y=(s+i)/r,this.fixAndSetPosition()}translate(t,s){_(this,ot,tv).call(this,this.parentDimensions,t,s)}translateInPage(t,s){o(this,_e)||m(this,_e,[this.x,this.y,this.width,this.height]),_(this,ot,tv).call(this,this.pageDimensions,t,s),this.div.scrollIntoView({block:"nearest"})}drag(t,s){o(this,_e)||m(this,_e,[this.x,this.y,this.width,this.height]);const{div:a,parentDimensions:[i,n]}=this;if(this.x+=t/i,this.y+=s/n,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:l}=this;const[c,u]=this.getBaseTranslation();r+=c,l+=u;const{style:h}=a;h.left=`${(100*r).toFixed(2)}%`,h.top=`${(100*l).toFixed(2)}%`,this._onTranslating(r,l),a.scrollIntoView({block:"nearest"})}_onTranslating(t,s){}_onTranslated(t,s){}get _hasBeenMoved(){return!!o(this,_e)&&(o(this,_e)[0]!==this.x||o(this,_e)[1]!==this.y)}get _hasBeenResized(){return!!o(this,_e)&&(o(this,_e)[2]!==this.width||o(this,_e)[3]!==this.height)}getBaseTranslation(){const[t,s]=this.parentDimensions,{_borderLineWidth:a}=ie,i=a/t,n=a/s;switch(this.rotation){case 90:return[-i,n];case 180:return[i,n];case 270:return[i,-n];default:return[-i,-n]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:s},pageDimensions:[a,i]}=this;let{x:n,y:r,width:l,height:c}=this;if(l*=a,c*=i,n*=a,r*=i,this._mustFixPosition)switch(t){case 0:n=Math.max(0,Math.min(a-l,n)),r=Math.max(0,Math.min(i-c,r));break;case 90:n=Math.max(0,Math.min(a-c,n)),r=Math.min(i,Math.max(l,r));break;case 180:n=Math.min(a,Math.max(l,n)),r=Math.min(i,Math.max(c,r));break;case 270:n=Math.min(a,Math.max(c,n)),r=Math.max(0,Math.min(i-l,r));break}this.x=n/=a,this.y=r/=i;const[u,h]=this.getBaseTranslation();n+=u,r+=h,s.left=`${(100*n).toFixed(2)}%`,s.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,s){var a;return _(a=ie,Uf,ev).call(a,t,s,this.parentRotation)}pageTranslationToScreen(t,s){var a;return _(a=ie,Uf,ev).call(a,t,s,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[s,a]}=this;return[s*t,a*t]}setDims(t,s){const[a,i]=this.parentDimensions,{style:n}=this.div;n.width=`${(100*t/a).toFixed(2)}%`,o(this,$r)||(n.height=`${(100*s/i).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:s,width:a}=t,i=a.endsWith("%"),n=!o(this,$r)&&s.endsWith("%");if(i&&n)return;const[r,l]=this.parentDimensions;i||(t.width=`${(100*parseFloat(a)/r).toFixed(2)}%`),!o(this,$r)&&!n&&(t.height=`${(100*parseFloat(s)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=o(this,Ct))==null||t.finish()}async addEditToolbar(){return this._editToolbar||o(this,Ur)?this._editToolbar:(this._editToolbar=new UM(this),this.div.append(this._editToolbar.render()),o(this,Ct)&&await this._editToolbar.addAltText(o(this,Ct)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=o(this,Ct))==null||t.destroy())}addContainer(t){var s;const a=(s=this._editToolbar)==null?void 0:s.div;a?a.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){o(this,Ct)||(Dw.initialize(ie._l10n),m(this,Ct,new Dw(this)),o(this,zr)&&(o(this,Ct).data=o(this,zr),m(this,zr,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=o(this,Ct))==null?void 0:t.data}set altTextData(t){o(this,Ct)&&(o(this,Ct).data=t)}get guessedAltText(){var t;return(t=o(this,Ct))==null?void 0:t.guessedText}async setGuessedAltText(t){var s;await((s=o(this,Ct))==null?void 0:s.setGuessedText(t))}serializeAltText(t){var s;return(s=o(this,Ct))==null?void 0:s.serialize(t)}hasAltText(){return!!o(this,Ct)&&!o(this,Ct).isEmpty()}hasAltTextData(){var t;return((t=o(this,Ct))==null?void 0:t.hasData())??!1}render(){var t;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=o(this,Jl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),_(this,ot,iv).call(this);const[s,a]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*a/s).toFixed(2)}%`,this.div.style.maxHeight=`${(100*s/a).toFixed(2)}%`);const[i,n]=this.getInitialTranslation();return this.translate(i,n),Lf(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(o(this,Qn)||m(this,Qn,new wk({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:_(this,ot,kk).bind(this),onPinching:_(this,ot,_k).bind(this),onPinchEnd:_(this,ot,Ak).bind(this),signal:this._uiManager._signal}))),(t=this._uiManager._editorUndoBar)==null||t.hide(),this.div}pointerdown(t){const{isMac:s}=We.platform;if(t.button!==0||t.ctrlKey&&s){t.preventDefault();return}if(m(this,No,!0),this._isDraggable){_(this,ot,Sk).call(this,t);return}_(this,ot,av).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){o(this,Ia)&&clearTimeout(o(this,Ia)),m(this,Ia,setTimeout(()=>{var t;m(this,Ia,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,s,a){t.changeParent(this),this.x=s,this.y=a,this.fixAndSetPosition(),this._onTranslated()}getRect(t,s,a=this.rotation){const i=this.parentScale,[n,r]=this.pageDimensions,[l,c]=this.pageTranslation,u=t/i,h=s/i,d=this.x*n,f=this.y*r,g=this.width*n,v=this.height*r;switch(a){case 0:return[d+u+l,r-f-h-v+c,d+u+g+l,r-f-h+c];case 90:return[d+h+l,r-f+u+c,d+h+v+l,r-f+u+g+c];case 180:return[d-u-g+l,r-f+h+c,d-u+l,r-f+h+v+c];case 270:return[d-h-v+l,r-f-u-g+c,d-h+l,r-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,s){const[a,i,n,r]=t,l=n-a,c=r-i;switch(this.rotation){case 0:return[a,s-r,l,c];case 90:return[a,s-i,c,l];case 180:return[n,s-i,l,c];case 270:return[n,s-r,c,l];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){m(this,Ur,!0)}disableEditMode(){m(this,Ur,!1)}isInEditMode(){return o(this,Ur)}shouldGetKeyboardEvents(){return o(this,Qi)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:s,bottom:a,right:i}=this.getClientDimensions(),{innerHeight:n,innerWidth:r}=window;return s<r&&i>0&&t<n&&a>0}rebuild(){_(this,ot,iv).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,s=null){yt("An editor must be serializable")}static async deserialize(t,s,a){const i=new this.prototype.constructor({parent:s,id:s.getNextId(),uiManager:a});i.rotation=t.rotation,m(i,zr,t.accessibilityData);const[n,r]=i.pageDimensions,[l,c,u,h]=i.getRectInCurrentCoords(t.rect,r);return i.x=l/n,i.y=c/r,i.width=u/n,i.height=h/r,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,s;if((t=o(this,ar))==null||t.abort(),m(this,ar,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),o(this,Ia)&&(clearTimeout(o(this,Ia)),m(this,Ia,null)),_(this,ot,tu).call(this),this.removeEditToolbar(),o(this,bs)){for(const a of o(this,bs).values())clearTimeout(a);m(this,bs,null)}this.parent=null,(s=o(this,Qn))==null||s.destroy(),m(this,Qn,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(_(this,ot,xk).call(this),o(this,Se).classList.remove("hidden"),Lf(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),m(this,Pi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const s=o(this,Se).children;if(!o(this,ga)){m(this,ga,Array.from(s));const r=_(this,ot,Ek).bind(this),l=_(this,ot,Ck).bind(this),c=this._uiManager._signal;for(const u of o(this,ga)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",r,{signal:c}),u.addEventListener("blur",l,{signal:c}),u.addEventListener("focus",_(this,ot,Mk).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",ie._l10nResizer[h])}}const a=o(this,ga)[0];let i=0;for(const r of s){if(r===a)break;i++}const n=(360-this.rotation+this.parentRotation)%360/90*(o(this,ga).length/4);if(n!==i){if(n<i)for(let l=0;l<i-n;l++)o(this,Se).append(o(this,Se).firstChild);else if(n>i)for(let l=0;l<n-i;l++)o(this,Se).firstChild.before(o(this,Se).lastChild);let r=0;for(const l of s){const c=o(this,ga)[r++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",ie._l10nResizer[c])}}_(this,ot,nv).call(this,0),m(this,Qi,!0),o(this,Se).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,s){o(this,Qi)&&_(this,ot,sv).call(this,o(this,Bf),{deltaX:t,deltaY:s,fromKeyboard:!0})}_stopResizingWithKeyboard(){_(this,ot,tu).call(this),this.div.focus()}select(){var t,s,a;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,n;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((n=this._editToolbar)==null||n.show())});return}(s=this._editToolbar)==null||s.show(),(a=o(this,Ct))==null||a.toggleAltTextBadge(!1)}unselect(){var t,s,a,i,n;(t=o(this,Se))==null||t.classList.add("hidden"),(s=this.div)==null||s.classList.remove("selectedEditor"),(a=this.div)!=null&&a.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(n=o(this,Ct))==null||n.toggleAltTextBadge(!0)}updateParams(t,s){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return o(this,id)}set isEditing(t){m(this,id,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,s){m(this,$r,!0);const a=t/s,{style:i}=this.div;i.aspectRatio=a,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,s=!1){if(s){o(this,bs)||m(this,bs,new Map);const{action:a}=t;let i=o(this,bs).get(a);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(t),o(this,bs).delete(a),o(this,bs).size===0&&m(this,bs,null)},ie._telemetryTimeout),o(this,bs).set(a,i);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),m(this,Jl,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,Jl,!0)}renderAnnotationElement(t){let s=t.container.querySelector(".annotationContent");if(!s)s=document.createElement("div"),s.classList.add("annotationContent",this.editorType),t.container.prepend(s);else if(s.nodeName==="CANVAS"){const a=s;s=document.createElement("div"),s.classList.add("annotationContent",this.editorType),a.before(s)}return s}resetAnnotationElement(t){const{firstChild:s}=t.container;(s==null?void 0:s.nodeName)==="DIV"&&s.classList.contains("annotationContent")&&s.remove()}};zr=new WeakMap,ga=new WeakMap,Ct=new WeakMap,Jl=new WeakMap,Pn=new WeakMap,ad=new WeakMap,$r=new WeakMap,Se=new WeakMap,Br=new WeakMap,Pi=new WeakMap,ar=new WeakMap,Bf=new WeakMap,No=new WeakMap,_e=new WeakMap,id=new WeakMap,Ur=new WeakMap,Qi=new WeakMap,Ia=new WeakMap,Zl=new WeakMap,tc=new WeakMap,bs=new WeakMap,Qn=new WeakMap,nd=new WeakMap,Zm=new WeakMap,ot=new WeakSet,tv=function([e,t],s,a){[s,a]=this.screenToPageTranslation(s,a),this.x+=s/e,this.y+=a/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Uf=new WeakSet,ev=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},yh=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},xk=function(){if(o(this,Se))return;m(this,Se,document.createElement("div")),o(this,Se).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const a=document.createElement("div");o(this,Se).append(a),a.classList.add("resizer",s),a.setAttribute("data-resizer-name",s),a.addEventListener("pointerdown",_(this,ot,Fw).bind(this,s),{signal:t}),a.addEventListener("contextmenu",ta,{signal:t}),a.tabIndex=-1}this.div.prepend(o(this,Se))},Fw=function(e,t){var s;t.preventDefault();const{isMac:a}=We.platform;if(t.button!==0||t.ctrlKey&&a)return;(s=o(this,Ct))==null||s.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,m(this,Br,[t.screenX,t.screenY]);const n=new AbortController,r=this._uiManager.combinedSignal(n);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",_(this,ot,sv).bind(this,e),{passive:!0,capture:!0,signal:r}),window.addEventListener("touchmove",cs,{passive:!1,signal:r}),window.addEventListener("contextmenu",ta,{signal:r}),m(this,Pi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var h;n.abort(),this.parent.togglePointerEvents(!0),(h=o(this,Ct))==null||h.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=c,_(this,ot,wh).call(this)};window.addEventListener("pointerup",u,{signal:r}),window.addEventListener("blur",u,{signal:r})},Eg=function(e,t,s,a){this.width=s,this.height=a,this.x=e,this.y=t;const[i,n]=this.parentDimensions;this.setDims(i*s,n*a),this.fixAndSetPosition(),this._onResized()},wh=function(){if(!o(this,Pi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:a}=o(this,Pi);m(this,Pi,null);const i=this.x,n=this.y,r=this.width,l=this.height;i===e&&n===t&&r===s&&l===a||this.addCommands({cmd:_(this,ot,Eg).bind(this,i,n,r,l),undo:_(this,ot,Eg).bind(this,e,t,s,a),mustExec:!0})},sv=function(e,t){const[s,a]=this.parentDimensions,i=this.x,n=this.y,r=this.width,l=this.height,c=Ft.MIN_SIZE/s,u=Ft.MIN_SIZE/a,h=_(this,ot,yh).call(this,this.rotation),d=(G,F)=>[h[0]*G+h[2]*F,h[1]*G+h[3]*F],f=_(this,ot,yh).call(this,360-this.rotation),g=(G,F)=>[f[0]*G+f[2]*F,f[1]*G+f[3]*F];let v,y,A=!1,b=!1;switch(e){case"topLeft":A=!0,v=(G,F)=>[0,0],y=(G,F)=>[G,F];break;case"topMiddle":v=(G,F)=>[G/2,0],y=(G,F)=>[G/2,F];break;case"topRight":A=!0,v=(G,F)=>[G,0],y=(G,F)=>[0,F];break;case"middleRight":b=!0,v=(G,F)=>[G,F/2],y=(G,F)=>[0,F/2];break;case"bottomRight":A=!0,v=(G,F)=>[G,F],y=(G,F)=>[0,0];break;case"bottomMiddle":v=(G,F)=>[G/2,F],y=(G,F)=>[G/2,0];break;case"bottomLeft":A=!0,v=(G,F)=>[0,F],y=(G,F)=>[G,0];break;case"middleLeft":b=!0,v=(G,F)=>[0,F/2],y=(G,F)=>[G,F/2];break}const x=v(r,l),w=y(r,l);let S=d(...w);const E=Ft._round(i+S[0]),M=Ft._round(n+S[1]);let N=1,P=1,T,I;if(t.fromKeyboard)({deltaX:T,deltaY:I}=t);else{const{screenX:G,screenY:F}=t,[B,L]=o(this,Br);[T,I]=this.screenToPageTranslation(G-B,F-L),o(this,Br)[0]=G,o(this,Br)[1]=F}if([T,I]=g(T/s,I/a),A){const G=Math.hypot(r,l);N=P=Math.max(Math.min(Math.hypot(w[0]-x[0]-T,w[1]-x[1]-I)/G,1/r,1/l),c/r,u/l)}else b?N=Math.max(c,Math.min(1,Math.abs(w[0]-x[0]-T)))/r:P=Math.max(u,Math.min(1,Math.abs(w[1]-x[1]-I)))/l;const V=Ft._round(r*N),rt=Ft._round(l*P);S=d(...y(V,rt));const ut=E-S[0],ht=M-S[1];o(this,_e)||m(this,_e,[this.x,this.y,this.width,this.height]),this.width=V,this.height=rt,this.x=ut,this.y=ht,this.setDims(s*V,a*rt),this.fixAndSetPosition(),this._onResizing()},kk=function(){var e;m(this,Pi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=o(this,Ct))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},_k=function(e,t,s){let a=.7*(s/t)+1-.7;if(a===1)return;const i=_(this,ot,yh).call(this,this.rotation),n=(S,E)=>[i[0]*S+i[2]*E,i[1]*S+i[3]*E],[r,l]=this.parentDimensions,c=this.x,u=this.y,h=this.width,d=this.height,f=Ft.MIN_SIZE/r,g=Ft.MIN_SIZE/l;a=Math.max(Math.min(a,1/h,1/d),f/h,g/d);const v=Ft._round(h*a),y=Ft._round(d*a);if(v===h&&y===d)return;o(this,_e)||m(this,_e,[c,u,h,d]);const A=n(h/2,d/2),b=Ft._round(c+A[0]),x=Ft._round(u+A[1]),w=n(v/2,y/2);this.x=b-w[0],this.y=x-w[1],this.width=v,this.height=y,this.setDims(r*v,l*y),this.fixAndSetPosition(),this._onResizing()},Ak=function(){var e;(e=o(this,Ct))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),_(this,ot,wh).call(this)},av=function(e){const{isMac:t}=We.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},Sk=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const a=new AbortController,i=this._uiManager.combinedSignal(a),n={capture:!0,passive:!1,signal:i},r=c=>{a.abort(),m(this,Pn,null),m(this,No,!1),this._uiManager.endDragSession()||_(this,ot,av).call(this,c),s&&this._onStopDragging()};t&&(m(this,Zl,e.clientX),m(this,tc,e.clientY),m(this,Pn,e.pointerId),m(this,ad,e.pointerType),window.addEventListener("pointermove",c=>{s||(s=!0,this._onStartDragging());const{clientX:u,clientY:h,pointerId:d}=c;if(d!==o(this,Pn)){cs(c);return}const[f,g]=this.screenToPageTranslation(u-o(this,Zl),h-o(this,tc));m(this,Zl,u),m(this,tc,h),this._uiManager.dragSelectedEditors(f,g)},n),window.addEventListener("touchmove",cs,n),window.addEventListener("pointerdown",c=>{c.pointerType===o(this,ad)&&(o(this,Qn)||c.isPrimary)&&r(c),cs(c)},n));const l=c=>{if(!o(this,Pn)||o(this,Pn)===c.pointerId){r(c);return}cs(c)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})},iv=function(){if(o(this,ar)||!this.div)return;m(this,ar,new AbortController);const e=this._uiManager.combinedSignal(o(this,ar));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},Ek=function(e){Ft._resizerKeyboardManager.exec(this,e)},Ck=function(e){var t;o(this,Qi)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==o(this,Se)&&_(this,ot,tu).call(this)},Mk=function(e){m(this,Bf,o(this,Qi)?e:"")},nv=function(e){if(o(this,ga))for(const t of o(this,ga))t.tabIndex=e},tu=function(){m(this,Qi,!1),_(this,ot,nv).call(this,-1),_(this,ot,wh).call(this)},k(Ft,Uf),X(Ft,"_l10n",null),X(Ft,"_l10nResizer",null),X(Ft,"_borderLineWidth",-1),X(Ft,"_colorManager",new XM),X(Ft,"_zIndex",1),X(Ft,"_telemetryTimeout",1e3);let zt=Ft;class YM extends zt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ow=3285377520,ms=4294901760,ia=65535;class Nk{constructor(t){this.h1=t?t&4294967295:Ow,this.h2=t?t&4294967295:Ow}update(t){let s,a;if(typeof t=="string"){s=new Uint8Array(t.length*2),a=0;for(let y=0,A=t.length;y<A;y++){const b=t.charCodeAt(y);b<=255?s[a++]=b:(s[a++]=b>>>8,s[a++]=b&255)}}else if(ArrayBuffer.isView(t))s=t.slice(),a=s.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=a>>2,n=a-i*4,r=new Uint32Array(s.buffer,0,i);let l=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,g=d&ia,v=f&ia;for(let y=0;y<i;y++)y&1?(l=r[y],l=l*d&ms|l*g&ia,l=l<<15|l>>>17,l=l*f&ms|l*v&ia,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(c=r[y],c=c*d&ms|c*g&ia,c=c<<15|c>>>17,c=c*f&ms|c*v&ia,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(l=0,n){case 3:l^=s[i*4+2]<<16;case 2:l^=s[i*4+1]<<8;case 1:l^=s[i*4],l=l*d&ms|l*g&ia,l=l<<15|l>>>17,l=l*f&ms|l*v&ia,i&1?u^=l:h^=l}this.h1=u,this.h2=h}hexdigest(){let t=this.h1,s=this.h2;return t^=s>>>1,t=t*3981806797&ms|t*36045&ia,s=s*4283543511&ms|((s<<16|t>>>16)*2950163797&ms)>>>16,t^=s>>>1,t=t*444984403&ms|t*60499&ia,s=s*3301882366&ms|((s<<16|t>>>16)*3120437893&ms)>>>16,t^=s>>>1,(t>>>0).toString(16).padStart(8,"0")+(s>>>0).toString(16).padStart(8,"0")}}const rv=Object.freeze({map:null,hash:"",transfer:void 0});var Yo,Hr,ne,ov,Pk;class ay{constructor(){k(this,ov),k(this,Yo,!1),k(this,Hr,null),k(this,ne,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,s){const a=o(this,ne).get(t);return a===void 0?s:Object.assign(s,a)}getRawValue(t){return o(this,ne).get(t)}remove(t){if(o(this,ne).delete(t),o(this,ne).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const s of o(this,ne).values())if(s instanceof zt)return;this.onAnnotationEditor(null)}}setValue(t,s){const a=o(this,ne).get(t);let i=!1;if(a!==void 0)for(const[n,r]of Object.entries(s))a[n]!==r&&(i=!0,a[n]=r);else i=!0,o(this,ne).set(t,s);i&&_(this,ov,Pk).call(this),s instanceof zt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(s.constructor._type)}has(t){return o(this,ne).has(t)}getAll(){return o(this,ne).size>0?Kb(o(this,ne)):null}setAll(t){for(const[s,a]of Object.entries(t))this.setValue(s,a)}get size(){return o(this,ne).size}resetModified(){o(this,Yo)&&(m(this,Yo,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Tk(this)}get serializable(){if(o(this,ne).size===0)return rv;const t=new Map,s=new Nk,a=[],i=Object.create(null);let n=!1;for(const[r,l]of o(this,ne)){const c=l instanceof zt?l.serialize(!1,i):l;c&&(t.set(r,c),s.update(`${r}:${JSON.stringify(c)}`),n||(n=!!c.bitmap))}if(n)for(const r of t.values())r.bitmap&&a.push(r.bitmap);return t.size>0?{map:t,hash:s.hexdigest(),transfer:a}:rv}get editorStats(){let t=null;const s=new Map;for(const a of o(this,ne).values()){if(!(a instanceof zt))continue;const i=a.telemetryFinalData;if(!i)continue;const{type:n}=i;s.has(n)||s.set(n,Object.getPrototypeOf(a).constructor),t||(t=Object.create(null));const r=t[n]||(t[n]=new Map);for(const[l,c]of Object.entries(i)){if(l==="type")continue;let u=r.get(l);u||(u=new Map,r.set(l,u));const h=u.get(c)??0;u.set(c,h+1)}}for(const[a,i]of s)t[a]=i.computeTelemetryFinalData(t[a]);return t}resetModifiedIds(){m(this,Hr,null)}get modifiedIds(){if(o(this,Hr))return o(this,Hr);const t=[];for(const s of o(this,ne).values())!(s instanceof zt)||!s.annotationElementId||!s.serialize()||t.push(s.annotationElementId);return m(this,Hr,{ids:new Set(t),hash:t.join(",")})}}Yo=new WeakMap,Hr=new WeakMap,ne=new WeakMap,ov=new WeakSet,Pk=function(){o(this,Yo)||(m(this,Yo,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var rd;class Tk extends ay{constructor(t){super(),k(this,rd);const{map:s,hash:a,transfer:i}=t.serializable,n=structuredClone(s,i?{transfer:i}:null);m(this,rd,{map:n,hash:a,transfer:i})}get print(){yt("Should not call PrintAnnotationStorage.print")}get serializable(){return o(this,rd)}get modifiedIds(){return tt(this,"modifiedIds",{ids:new Set,hash:""})}}rd=new WeakMap;var ec;class KM{constructor({ownerDocument:t=globalThis.document,styleElement:s=null}){k(this,ec,new Set),this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const s=this.styleElement.sheet;s.insertRule(t,s.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),o(this,ec).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:s}){if(!(!t||o(this,ec).has(t.loadedName))){if(Vt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:i,style:n}=t,r=new FontFace(a,i,n);this.addNativeFontFace(r);try{await r.load(),o(this,ec).add(a),s==null||s(t)}catch{Z(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}return}yt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const a=t.createNativeFontFace();if(a){this.addNativeFontFace(a);try{await a.loaded}catch(i){throw Z(`Failed to load font '${a.family}': '${i}'.`),t.disableFontFace=!0,i}}return}const s=t.createFontFaceRule();if(s){if(this.insertRule(s),this.isSyncFontLoadingSupported)return;await new Promise(a=>{const i=this._queueLoadingCallback(a);this._prepareFontLoadEvent(t,i)})}}get isFontLoadingAPISupported(){var t;const s=!!((t=this._document)!=null&&t.fonts);return tt(this,"isFontLoadingAPISupported",s)}get isSyncFontLoadingSupported(){let t=!1;return(Ne||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),tt(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function s(){for(Vt(!i.done,"completeRequest() cannot be called twice."),i.done=!0;a.length>0&&a[0].done;){const n=a.shift();setTimeout(n.callback,0)}}const{loadingRequests:a}=this,i={done:!1,complete:s,callback:t};return a.push(i),i}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return tt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,s){function a(w,S){return w.charCodeAt(S)<<24|w.charCodeAt(S+1)<<16|w.charCodeAt(S+2)<<8|w.charCodeAt(S+3)&255}function i(w,S,E,M){const N=w.substring(0,S),P=w.substring(S+E);return N+M+P}let n,r;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;function h(w,S){if(++u>30){Z("Load test font never loaded."),S();return}if(c.font="30px "+w,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){S();return}setTimeout(h.bind(null,w,S))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,d.length,d);const g=16,v=1482184792;let y=a(f,g);for(n=0,r=d.length-3;n<r;n+=4)y=y-v+a(d,n)|0;n<d.length&&(y=y-v+a(d+"XXX",n)|0),f=i(f,g,4,LM(y));const A=`url(data:font/opentype;base64,${btoa(f)});`,b=`@font-face {font-family:"${d}";src:${A}}`;this.insertRule(b);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const w of[t.loadedName,d]){const S=this._document.createElement("span");S.textContent="Hi",S.style.fontFamily=w,x.append(S)}this._document.body.append(x),h(d,()=>{x.remove(),s.complete()})}}ec=new WeakMap;class QM{constructor(t,{disableFontFace:s=!1,fontExtraProperties:a=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this.disableFontFace=s===!0,this.fontExtraProperties=a===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let s;if(!this.cssFontInfo)s=new FontFace(this.loadedName,this.data,{});else{const a={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(a.style=`oblique ${this.cssFontInfo.italicAngle}deg`),s=new FontFace(this.cssFontInfo.fontFamily,this.data,a)}return(t=this._inspectFont)==null||t.call(this,this),s}createFontFaceRule(){var t;if(!this.data||this.disableFontFace)return null;const s=`url(data:${this.mimetype};base64,${OM(this.data)});`;let a;if(!this.cssFontInfo)a=`@font-face {font-family:"${this.loadedName}";src:${s}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),a=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${s}}`}return(t=this._inspectFont)==null||t.call(this,this,s),a}getPathGenerator(t,s){if(this.compiledGlyphs[s]!==void 0)return this.compiledGlyphs[s];const a=this.loadedName+"_path_"+s;let i;try{i=t.get(a)}catch(r){Z(`getPathGenerator - ignoring character: "${r}".`)}const n=new Path2D(i||"");return this.fontExtraProperties||t.delete(a),this.compiledGlyphs[s]=n}}const xh={DATA:1,ERROR:2},Bt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Ww(){}function qe(e){if(e instanceof fn||e instanceof Om||e instanceof Bu||e instanceof Cw||e instanceof Pf||e instanceof kg)return e;switch(e instanceof Error||typeof e=="object"&&e!==null||yt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new fn(e.message);case"InvalidPDFException":return new Om(e.message);case"MissingPDFException":return new Bu(e.message);case"PasswordException":return new Cw(e.message,e.code);case"UnexpectedResponseException":return new Pf(e.message,e.status);case"UnknownErrorException":return new kg(e.message,e.details)}return new kg(e.message,e.toString())}var sc,Ti,Lk,zw,$w,kh;class ac{constructor(t,s,a){k(this,Ti),k(this,sc,new AbortController),this.sourceName=t,this.targetName=s,this.comObj=a,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),a.addEventListener("message",_(this,Ti,Lk).bind(this),{signal:o(this,sc).signal})}on(t,s){const a=this.actionHandler;if(a[t])throw new Error(`There is already an actionName called "${t}"`);a[t]=s}send(t,s,a){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:s},a)}sendWithPromise(t,s,a){const i=this.callbackId++,n=Promise.withResolvers();this.callbackCapabilities[i]=n;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:i,data:s},a)}catch(r){n.reject(r)}return n.promise}sendWithStream(t,s,a,i){const n=this.streamId++,r=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[n]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:r,targetName:l,action:t,streamId:n,data:s,desiredSize:u.desiredSize},i),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[n].pullCall=h,c.postMessage({sourceName:r,targetName:l,stream:Bt.PULL,streamId:n,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Vt(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[n].cancelCall=h,this.streamControllers[n].isClosed=!0,c.postMessage({sourceName:r,targetName:l,stream:Bt.CANCEL,streamId:n,reason:qe(u)}),h.promise}},a)}destroy(){var t;(t=o(this,sc))==null||t.abort(),m(this,sc,null)}}sc=new WeakMap,Ti=new WeakSet,Lk=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){_(this,Ti,$w).call(this,e);return}if(e.callback){const s=e.callbackId,a=this.callbackCapabilities[s];if(!a)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===xh.DATA)a.resolve(e.data);else if(e.callback===xh.ERROR)a.reject(qe(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,a=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(n){i.postMessage({sourceName:s,targetName:a,callback:xh.DATA,callbackId:e.callbackId,data:n})},function(n){i.postMessage({sourceName:s,targetName:a,callback:xh.ERROR,callbackId:e.callbackId,reason:qe(n)})});return}if(e.streamId){_(this,Ti,zw).call(this,e);return}t(e.data)},zw=function(e){const t=e.streamId,s=this.sourceName,a=e.sourceName,i=this.comObj,n=this,r=this.actionHandler[e.action],l={enqueue(c,u=1,h){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=u,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:s,targetName:a,stream:Bt.ENQUEUE,streamId:t,chunk:c},h)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:a,stream:Bt.CLOSE,streamId:t}),delete n.streamSinks[t])},error(c){Vt(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:s,targetName:a,stream:Bt.ERROR,streamId:t,reason:qe(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(r,e.data,l).then(function(){i.postMessage({sourceName:s,targetName:a,stream:Bt.START_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:a,stream:Bt.START_COMPLETE,streamId:t,reason:qe(c)})})},$w=function(e){const t=e.streamId,s=this.sourceName,a=e.sourceName,i=this.comObj,n=this.streamControllers[t],r=this.streamSinks[t];switch(e.stream){case Bt.START_COMPLETE:e.success?n.startCall.resolve():n.startCall.reject(qe(e.reason));break;case Bt.PULL_COMPLETE:e.success?n.pullCall.resolve():n.pullCall.reject(qe(e.reason));break;case Bt.PULL:if(!r){i.postMessage({sourceName:s,targetName:a,stream:Bt.PULL_COMPLETE,streamId:t,success:!0});break}r.desiredSize<=0&&e.desiredSize>0&&r.sinkCapability.resolve(),r.desiredSize=e.desiredSize,Promise.try(r.onPull||Ww).then(function(){i.postMessage({sourceName:s,targetName:a,stream:Bt.PULL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:a,stream:Bt.PULL_COMPLETE,streamId:t,reason:qe(c)})});break;case Bt.ENQUEUE:if(Vt(n,"enqueue should have stream controller"),n.isClosed)break;n.controller.enqueue(e.chunk);break;case Bt.CLOSE:if(Vt(n,"close should have stream controller"),n.isClosed)break;n.isClosed=!0,n.controller.close(),_(this,Ti,kh).call(this,n,t);break;case Bt.ERROR:Vt(n,"error should have stream controller"),n.controller.error(qe(e.reason)),_(this,Ti,kh).call(this,n,t);break;case Bt.CANCEL_COMPLETE:e.success?n.cancelCall.resolve():n.cancelCall.reject(qe(e.reason)),_(this,Ti,kh).call(this,n,t);break;case Bt.CANCEL:if(!r)break;const l=qe(e.reason);Promise.try(r.onCancel||Ww,l).then(function(){i.postMessage({sourceName:s,targetName:a,stream:Bt.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:s,targetName:a,stream:Bt.CANCEL_COMPLETE,streamId:t,reason:qe(c)})}),r.sinkCapability.reject(l),r.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},kh=async function(e,t){var s,a,i;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(a=e.pullCall)==null?void 0:a.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var od;class Rk{constructor({enableHWA:t=!1}){k(this,od,!1),m(this,od,t)}create(t,s){if(t<=0||s<=0)throw new Error("Invalid canvas size");const a=this._createCanvas(t,s);return{canvas:a,context:a.getContext("2d",{willReadFrequently:!o(this,od)})}}reset(t,s,a){if(!t.canvas)throw new Error("Canvas is not specified");if(s<=0||a<=0)throw new Error("Invalid canvas size");t.canvas.width=s,t.canvas.height=a}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,s){yt("Abstract method `_createCanvas` called.")}}od=new WeakMap;class JM extends Rk{constructor({ownerDocument:t=globalThis.document,enableHWA:s=!1}){super({enableHWA:s}),this._document=t}_createCanvas(t,s){const a=this._document.createElement("canvas");return a.width=t,a.height=s,a}}class Ik{constructor({baseUrl:t=null,isCompressed:s=!0}){this.baseUrl=t,this.isCompressed=s}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const s=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(s).then(a=>({cMapData:a,isCompressed:this.isCompressed})).catch(a=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${s}`)})}async _fetch(t){yt("Abstract method `_fetch` called.")}}class Dk extends Ik{async _fetch(t){const s=await Bp(t,this.isCompressed?"arraybuffer":"text");return s instanceof ArrayBuffer?new Uint8Array(s):$p(s)}}class jk{addFilter(t){return"none"}addHCMFilter(t,s){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,s,a,i,n){return"none"}destroy(t=!1){}}var Vr,Ko,zi,yi,Re,ir,Gr,U,we,ic,Po,ld,qr,Fk,lv,Xr,Nl,nc,cv,rc;class ZM extends jk{constructor({docId:t,ownerDocument:s=globalThis.document}){super(),k(this,U),k(this,Vr),k(this,Ko),k(this,zi),k(this,yi),k(this,Re),k(this,ir),k(this,Gr,0),m(this,yi,t),m(this,Re,s)}addFilter(t){if(!t)return"none";let s=o(this,U,we).get(t);if(s)return s;const[a,i,n]=_(this,U,ld).call(this,t),r=t.length===1?a:`${a}${i}${n}`;if(s=o(this,U,we).get(r),s)return o(this,U,we).set(t,s),s;const l=`g_${o(this,yi)}_transfer_map_${Je(this,Gr)._++}`,c=_(this,U,qr).call(this,l);o(this,U,we).set(t,c),o(this,U,we).set(r,c);const u=_(this,U,Xr).call(this,l);return _(this,U,nc).call(this,a,i,n,u),c}addHCMFilter(t,s){var a;const i=`${t}-${s}`,n="base";let r=o(this,U,ic).get(n);if((r==null?void 0:r.key)===i||(r?((a=r.filter)==null||a.remove(),r.key=i,r.url="none",r.filter=null):(r={key:i,url:"none",filter:null},o(this,U,ic).set(n,r)),!t||!s))return r.url;const l=_(this,U,rc).call(this,t);t=$.makeHexColor(...l);const c=_(this,U,rc).call(this,s);if(s=$.makeHexColor(...c),o(this,U,Po).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return r.url;const u=new Array(256);for(let v=0;v<=255;v++){const y=v/255;u[v]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const h=u.join(","),d=`g_${o(this,yi)}_hcm_filter`,f=r.filter=_(this,U,Xr).call(this,d);_(this,U,nc).call(this,h,h,h,f),_(this,U,lv).call(this,f);const g=(v,y)=>{const A=l[v]/255,b=c[v]/255,x=new Array(y+1);for(let w=0;w<=y;w++)x[w]=A+w/y*(b-A);return x.join(",")};return _(this,U,nc).call(this,g(0,5),g(1,5),g(2,5),f),r.url=_(this,U,qr).call(this,d),r.url}addAlphaFilter(t){let s=o(this,U,we).get(t);if(s)return s;const[a]=_(this,U,ld).call(this,[t]),i=`alpha_${a}`;if(s=o(this,U,we).get(i),s)return o(this,U,we).set(t,s),s;const n=`g_${o(this,yi)}_alpha_map_${Je(this,Gr)._++}`,r=_(this,U,qr).call(this,n);o(this,U,we).set(t,r),o(this,U,we).set(i,r);const l=_(this,U,Xr).call(this,n);return _(this,U,cv).call(this,a,l),r}addLuminosityFilter(t){let s=o(this,U,we).get(t||"luminosity");if(s)return s;let a,i;if(t?([a]=_(this,U,ld).call(this,[t]),i=`luminosity_${a}`):i="luminosity",s=o(this,U,we).get(i),s)return o(this,U,we).set(t,s),s;const n=`g_${o(this,yi)}_luminosity_map_${Je(this,Gr)._++}`,r=_(this,U,qr).call(this,n);o(this,U,we).set(t,r),o(this,U,we).set(i,r);const l=_(this,U,Xr).call(this,n);return _(this,U,Fk).call(this,l),t&&_(this,U,cv).call(this,a,l),r}addHighlightHCMFilter(t,s,a,i,n){var r;const l=`${s}-${a}-${i}-${n}`;let c=o(this,U,ic).get(t);if((c==null?void 0:c.key)===l||(c?((r=c.filter)==null||r.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},o(this,U,ic).set(t,c)),!s||!a))return c.url;const[u,h]=[s,a].map(_(this,U,rc).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,v]=[i,n].map(_(this,U,rc).bind(this));f<d&&([d,f,g,v]=[f,d,v,g]),o(this,U,Po).style.color="";const y=(x,w,S)=>{const E=new Array(256),M=(f-d)/S,N=x/255,P=(w-x)/(255*S);let T=0;for(let I=0;I<=S;I++){const V=Math.round(d+I*M),rt=N+I*P;for(let ut=T;ut<=V;ut++)E[ut]=rt;T=V+1}for(let I=T;I<256;I++)E[I]=E[T-1];return E.join(",")},A=`g_${o(this,yi)}_hcm_${t}_filter`,b=c.filter=_(this,U,Xr).call(this,A);return _(this,U,lv).call(this,b),_(this,U,nc).call(this,y(g[0],v[0],5),y(g[1],v[1],5),y(g[2],v[2],5),b),c.url=_(this,U,qr).call(this,A),c.url}destroy(t=!1){var s,a,i,n;t&&(s=o(this,ir))!=null&&s.size||((a=o(this,zi))==null||a.parentNode.parentNode.remove(),m(this,zi,null),(i=o(this,Ko))==null||i.clear(),m(this,Ko,null),(n=o(this,ir))==null||n.clear(),m(this,ir,null),m(this,Gr,0))}}Vr=new WeakMap,Ko=new WeakMap,zi=new WeakMap,yi=new WeakMap,Re=new WeakMap,ir=new WeakMap,Gr=new WeakMap,U=new WeakSet,we=function(){return o(this,Ko)||m(this,Ko,new Map)},ic=function(){return o(this,ir)||m(this,ir,new Map)},Po=function(){if(!o(this,zi)){const e=o(this,Re).createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const s=o(this,Re).createElementNS(Na,"svg");s.setAttribute("width",0),s.setAttribute("height",0),m(this,zi,o(this,Re).createElementNS(Na,"defs")),e.append(s),s.append(o(this,zi)),o(this,Re).body.append(e)}return o(this,zi)},ld=function(e){if(e.length===1){const l=e[0],c=new Array(256);for(let h=0;h<256;h++)c[h]=l[h]/255;const u=c.join(",");return[u,u,u]}const[t,s,a]=e,i=new Array(256),n=new Array(256),r=new Array(256);for(let l=0;l<256;l++)i[l]=t[l]/255,n[l]=s[l]/255,r[l]=a[l]/255;return[i.join(","),n.join(","),r.join(",")]},qr=function(e){if(o(this,Vr)===void 0){m(this,Vr,"");const t=o(this,Re).URL;t!==o(this,Re).baseURI&&(Up(t)?Z('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,Vr,t.split("#",1)[0]))}return`url(${o(this,Vr)}#${e})`},Fk=function(e){const t=o(this,Re).createElementNS(Na,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)},lv=function(e){const t=o(this,Re).createElementNS(Na,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)},Xr=function(e){const t=o(this,Re).createElementNS(Na,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),o(this,U,Po).append(t),t},Nl=function(e,t,s){const a=o(this,Re).createElementNS(Na,t);a.setAttribute("type","discrete"),a.setAttribute("tableValues",s),e.append(a)},nc=function(e,t,s,a){const i=o(this,Re).createElementNS(Na,"feComponentTransfer");a.append(i),_(this,U,Nl).call(this,i,"feFuncR",e),_(this,U,Nl).call(this,i,"feFuncG",t),_(this,U,Nl).call(this,i,"feFuncB",s)},cv=function(e,t){const s=o(this,Re).createElementNS(Na,"feComponentTransfer");t.append(s),_(this,U,Nl).call(this,s,"feFuncA",e)},rc=function(e){return o(this,U,Po).style.color=e,ey(getComputedStyle(o(this,U,Po)).getPropertyValue("color"))};class Ok{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const s=`${this.baseUrl}${t}`;return this._fetch(s).catch(a=>{throw new Error(`Unable to load font data at: ${s}`)})}async _fetch(t){yt("Abstract method `_fetch` called.")}}class Wk extends Ok{async _fetch(t){const s=await Bp(t,"arraybuffer");return new Uint8Array(s)}}Ne&&Z("Please use the `legacy` build in Node.js environments.");async function zk(e){const t=await process.getBuiltinModule("fs").promises.readFile(e);return new Uint8Array(t)}class t2 extends jk{}class e2 extends Rk{_createCanvas(t,s){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,s)}}class s2 extends Ik{async _fetch(t){return zk(t)}}class a2 extends Ok{async _fetch(t){return zk(t)}}const Ce={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function uv(e,t){if(!t)return;const s=t[2]-t[0],a=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],s,a),e.clip(i)}class iy{getPattern(){yt("Abstract method `getPattern` called.")}}class i2 extends iy{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let s;this._type==="axial"?s=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(s=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const a of this._colorStops)s.addColorStop(a[0],a[1]);return s}getPattern(t,s,a,i){let n;if(i===Ce.STROKE||i===Ce.FILL){const r=s.current.getClippedPathBoundingBox(i,Et(t))||[0,0,0,0],l=Math.ceil(r[2]-r[0])||1,c=Math.ceil(r[3]-r[1])||1,u=s.cachedCanvases.getCanvas("pattern",l,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-r[0],-r[1]),a=$.transform(a,[1,0,0,1,r[0],r[1]]),h.transform(...s.baseTransform),this.matrix&&h.transform(...this.matrix),uv(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),n=t.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(a);n.setTransform(d)}else uv(t,this._bbox),n=this._createGradient(t);return n}}function Cg(e,t,s,a,i,n,r,l){const c=t.coords,u=t.colors,h=e.data,d=e.width*4;let f;c[s+1]>c[a+1]&&(f=s,s=a,a=f,f=n,n=r,r=f),c[a+1]>c[i+1]&&(f=a,a=i,i=f,f=r,r=l,l=f),c[s+1]>c[a+1]&&(f=s,s=a,a=f,f=n,n=r,r=f);const g=(c[s]+t.offsetX)*t.scaleX,v=(c[s+1]+t.offsetY)*t.scaleY,y=(c[a]+t.offsetX)*t.scaleX,A=(c[a+1]+t.offsetY)*t.scaleY,b=(c[i]+t.offsetX)*t.scaleX,x=(c[i+1]+t.offsetY)*t.scaleY;if(v>=x)return;const w=u[n],S=u[n+1],E=u[n+2],M=u[r],N=u[r+1],P=u[r+2],T=u[l],I=u[l+1],V=u[l+2],rt=Math.round(v),ut=Math.round(x);let ht,G,F,B,L,j,D,Y;for(let Q=rt;Q<=ut;Q++){if(Q<A){const at=Q<v?0:(v-Q)/(v-A);ht=g-(g-y)*at,G=w-(w-M)*at,F=S-(S-N)*at,B=E-(E-P)*at}else{let at;Q>x?at=1:A===x?at=0:at=(A-Q)/(A-x),ht=y-(y-b)*at,G=M-(M-T)*at,F=N-(N-I)*at,B=P-(P-V)*at}let ft;Q<v?ft=0:Q>x?ft=1:ft=(v-Q)/(v-x),L=g-(g-b)*ft,j=w-(w-T)*ft,D=S-(S-I)*ft,Y=E-(E-V)*ft;const wt=Math.round(Math.min(ht,L)),ae=Math.round(Math.max(ht,L));let dt=d*Q+wt*4;for(let at=wt;at<=ae;at++)ft=(ht-at)/(ht-L),ft<0?ft=0:ft>1&&(ft=1),h[dt++]=G-(G-j)*ft|0,h[dt++]=F-(F-D)*ft|0,h[dt++]=B-(B-Y)*ft|0,h[dt++]=255}}function n2(e,t,s){const a=t.coords,i=t.colors;let n,r;switch(t.type){case"lattice":const l=t.verticesPerRow,c=Math.floor(a.length/l)-1,u=l-1;for(n=0;n<c;n++){let h=n*l;for(let d=0;d<u;d++,h++)Cg(e,s,a[h],a[h+1],a[h+l],i[h],i[h+1],i[h+l]),Cg(e,s,a[h+l+1],a[h+1],a[h+l],i[h+l+1],i[h+1],i[h+l])}break;case"triangles":for(n=0,r=a.length;n<r;n+=3)Cg(e,s,a[n],a[n+1],a[n+2],i[n],i[n+1],i[n+2]);break;default:throw new Error("illegal figure")}}class r2 extends iy{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,s,a){const i=Math.floor(this._bounds[0]),n=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-i,l=Math.ceil(this._bounds[3])-n,c=Math.min(Math.ceil(Math.abs(r*t[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(l*t[1]*1.1)),3e3),h=r/c,d=l/u,f={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-n,scaleX:1/h,scaleY:1/d},g=c+2*2,v=u+2*2,y=a.getCanvas("mesh",g,v),A=y.context,b=A.createImageData(c,u);if(s){const x=b.data;for(let w=0,S=x.length;w<S;w+=4)x[w]=s[0],x[w+1]=s[1],x[w+2]=s[2],x[w+3]=255}for(const x of this._figures)n2(b,x,f);return A.putImageData(b,2,2),{canvas:y.canvas,offsetX:i-2*h,offsetY:n-2*d,scaleX:h,scaleY:d}}getPattern(t,s,a,i){uv(t,this._bbox);let n;if(i===Ce.SHADING)n=$.singularValueDecompose2dScale(Et(t));else if(n=$.singularValueDecompose2dScale(s.baseTransform),this.matrix){const l=$.singularValueDecompose2dScale(this.matrix);n=[n[0]*l[0],n[1]*l[1]]}const r=this._createMeshCanvas(n,i===Ce.SHADING?null:this._background,s.cachedCanvases);return i!==Ce.SHADING&&(t.setTransform(...s.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(r.offsetX,r.offsetY),t.scale(r.scaleX,r.scaleY),t.createPattern(r.canvas,"no-repeat")}}class o2 extends iy{getPattern(){return"hotpink"}}function l2(e){switch(e[0]){case"RadialAxial":return new i2(e);case"Mesh":return new r2(e);case"Dummy":return new o2}throw new Error(`Unknown IR type: ${e[0]}`)}const Bw={COLORED:1,UNCOLORED:2},$k=class Bk{constructor(t,s,a,i,n){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=s,this.ctx=a,this.canvasGraphicsFactory=i,this.baseTransform=n}createPatternCanvas(t){const{bbox:s,operatorList:a,paintType:i,tilingType:n,color:r,canvasGraphicsFactory:l}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),zp("TilingType: "+n);const h=s[0],d=s[1],f=s[2],g=s[3],v=f-h,y=g-d,A=$.singularValueDecompose2dScale(this.matrix),b=$.singularValueDecompose2dScale(this.baseTransform),x=A[0]*b[0],w=A[1]*b[1];let S=v,E=y,M=!1,N=!1;const P=Math.ceil(c*x),T=Math.ceil(u*w),I=Math.ceil(v*x),V=Math.ceil(y*w);P>=I?S=c:M=!0,T>=V?E=u:N=!0;const rt=this.getSizeAndScale(S,this.ctx.canvas.width,x),ut=this.getSizeAndScale(E,this.ctx.canvas.height,w),ht=t.cachedCanvases.getCanvas("pattern",rt.size,ut.size),G=ht.context,F=l.createCanvasGraphics(G);if(F.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(F,i,r),G.translate(-rt.scale*h,-ut.scale*d),F.transform(rt.scale,0,0,ut.scale,0,0),G.save(),this.clipBbox(F,h,d,f,g),F.baseTransform=Et(F.ctx),F.executeOperatorList(a),F.endDrawing(),G.restore(),M||N){const B=ht.canvas;M&&(S=c),N&&(E=u);const L=this.getSizeAndScale(S,this.ctx.canvas.width,x),j=this.getSizeAndScale(E,this.ctx.canvas.height,w),D=L.size,Y=j.size,Q=t.cachedCanvases.getCanvas("pattern-workaround",D,Y),ft=Q.context,wt=M?Math.floor(v/c):0,ae=N?Math.floor(y/u):0;for(let dt=0;dt<=wt;dt++)for(let at=0;at<=ae;at++)ft.drawImage(B,D*dt,Y*at,D,Y,0,0,D,Y);return{canvas:Q.canvas,scaleX:L.scale,scaleY:j.scale,offsetX:h,offsetY:d}}return{canvas:ht.canvas,scaleX:rt.scale,scaleY:ut.scale,offsetX:h,offsetY:d}}getSizeAndScale(t,s,a){const i=Math.max(Bk.MAX_PATTERN_SIZE,s);let n=Math.ceil(t*a);return n>=i?n=i:a=n/t,{scale:a,size:n}}clipBbox(t,s,a,i,n){const r=i-s,l=n-a;t.ctx.rect(s,a,r,l),t.current.updateRectMinMax(Et(t.ctx),[s,a,i,n]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,s,a){const i=t.ctx,n=t.current;switch(s){case Bw.COLORED:const r=this.ctx;i.fillStyle=r.fillStyle,i.strokeStyle=r.strokeStyle,n.fillColor=r.fillStyle,n.strokeColor=r.strokeStyle;break;case Bw.UNCOLORED:const l=$.makeHexColor(a[0],a[1],a[2]);i.fillStyle=l,i.strokeStyle=l,n.fillColor=l,n.strokeColor=l;break;default:throw new TM(`Unsupported paint type: ${s}`)}}getPattern(t,s,a,i){let n=a;i!==Ce.SHADING&&(n=$.transform(n,s.baseTransform),this.matrix&&(n=$.transform(n,this.matrix)));const r=this.createPatternCanvas(s);let l=new DOMMatrix(n);l=l.translate(r.offsetX,r.offsetY),l=l.scale(1/r.scaleX,1/r.scaleY);const c=t.createPattern(r.canvas,"repeat");return c.setTransform(l),c}};X($k,"MAX_PATTERN_SIZE",3e3);let c2=$k;function u2({src:e,srcPos:t=0,dest:s,width:a,height:i,nonBlackColor:n=4294967295,inverseDecode:r=!1}){const l=We.isLittleEndian?4278190080:255,[c,u]=r?[n,l]:[l,n],h=a>>3,d=a&7,f=e.length;s=new Uint32Array(s.buffer);let g=0;for(let v=0;v<i;v++){for(const A=t+h;t<A;t++){const b=t<f?e[t]:255;s[g++]=b&128?u:c,s[g++]=b&64?u:c,s[g++]=b&32?u:c,s[g++]=b&16?u:c,s[g++]=b&8?u:c,s[g++]=b&4?u:c,s[g++]=b&2?u:c,s[g++]=b&1?u:c}if(d===0)continue;const y=t<f?e[t++]:255;for(let A=0;A<d;A++)s[g++]=y&1<<7-A?u:c}return{srcPos:t,destPos:g}}const Uw=16,Hw=100,h2=15,Vw=10,Gw=1e3,Ye=16;function d2(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(s,a){t.translate(s,a),this.__originalTranslate(s,a)},e.scale=function(s,a){t.scale(s,a),this.__originalScale(s,a)},e.transform=function(s,a,i,n,r,l){t.transform(s,a,i,n,r,l),this.__originalTransform(s,a,i,n,r,l)},e.setTransform=function(s,a,i,n,r,l){t.setTransform(s,a,i,n,r,l),this.__originalSetTransform(s,a,i,n,r,l)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(s){t.rotate(s),this.__originalRotate(s)},e.clip=function(s){t.clip(s),this.__originalClip(s)},e.moveTo=function(s,a){t.moveTo(s,a),this.__originalMoveTo(s,a)},e.lineTo=function(s,a){t.lineTo(s,a),this.__originalLineTo(s,a)},e.bezierCurveTo=function(s,a,i,n,r,l){t.bezierCurveTo(s,a,i,n,r,l),this.__originalBezierCurveTo(s,a,i,n,r,l)},e.rect=function(s,a,i,n){t.rect(s,a,i,n),this.__originalRect(s,a,i,n)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class f2{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,s,a){let i;return this.cache[t]!==void 0?(i=this.cache[t],this.canvasFactory.reset(i,s,a)):(i=this.canvasFactory.create(s,a),this.cache[t]=i),i}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const s=this.cache[t];this.canvasFactory.destroy(s),delete this.cache[t]}}}function _h(e,t,s,a,i,n,r,l,c,u){const[h,d,f,g,v,y]=Et(e);if(d===0&&f===0){const x=r*h+v,w=Math.round(x),S=l*g+y,E=Math.round(S),M=(r+c)*h+v,N=Math.abs(Math.round(M)-w)||1,P=(l+u)*g+y,T=Math.abs(Math.round(P)-E)||1;return e.setTransform(Math.sign(h),0,0,Math.sign(g),w,E),e.drawImage(t,s,a,i,n,0,0,N,T),e.setTransform(h,d,f,g,v,y),[N,T]}if(h===0&&g===0){const x=l*f+v,w=Math.round(x),S=r*d+y,E=Math.round(S),M=(l+u)*f+v,N=Math.abs(Math.round(M)-w)||1,P=(r+c)*d+y,T=Math.abs(Math.round(P)-E)||1;return e.setTransform(0,Math.sign(d),Math.sign(f),0,w,E),e.drawImage(t,s,a,i,n,0,0,T,N),e.setTransform(h,d,f,g,v,y),[T,N]}e.drawImage(t,s,a,i,n,r,l,c,u);const A=Math.hypot(h,d),b=Math.hypot(f,g);return[A*c,b*u]}function p2(e){const{width:t,height:s}=e;if(t>Gw||s>Gw)return null;const a=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),n=t+1;let r=new Uint8Array(n*(s+1)),l,c,u;const h=t+7&-8;let d=new Uint8Array(h*s),f=0;for(const A of e.data){let b=128;for(;b>0;)d[f++]=A&b?0:255,b>>=1}let g=0;for(f=0,d[f]!==0&&(r[0]=1,++g),c=1;c<t;c++)d[f]!==d[f+1]&&(r[c]=d[f]?2:1,++g),f++;for(d[f]!==0&&(r[c]=2,++g),l=1;l<s;l++){f=l*h,u=l*n,d[f-h]!==d[f]&&(r[u]=d[f]?1:8,++g);let A=(d[f]?4:0)+(d[f-h]?8:0);for(c=1;c<t;c++)A=(A>>2)+(d[f+1]?4:0)+(d[f-h+1]?8:0),i[A]&&(r[u+c]=i[A],++g),f++;if(d[f-h]!==d[f]&&(r[u+c]=d[f]?2:4,++g),g>a)return null}for(f=h*(s-1),u=l*n,d[f]!==0&&(r[u]=8,++g),c=1;c<t;c++)d[f]!==d[f+1]&&(r[u+c]=d[f]?4:8,++g),f++;if(d[f]!==0&&(r[u+c]=4,++g),g>a)return null;const v=new Int32Array([0,n,-1,0,-n,0,0,0,1]),y=new Path2D;for(l=0;g&&l<=s;l++){let A=l*n;const b=A+t;for(;A<b&&!r[A];)A++;if(A===b)continue;y.moveTo(A%n,l);const x=A;let w=r[A];do{const S=v[w];do A+=S;while(!r[A]);const E=r[A];E!==5&&E!==10?(w=E,r[A]=0):(w=E&51*w>>4,r[A]&=w>>2|w<<2),y.lineTo(A%n,A/n|0),r[A]||--g}while(x!==A);--l}return d=null,r=null,function(A){A.save(),A.scale(1/t,-1/s),A.translate(0,-s),A.fill(y),A.beginPath(),A.restore()}}class qw{constructor(t,s){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=tk,this.textMatrixScale=1,this.fontMatrix=Fm,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=ye.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,s])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,s){this.x=t,this.y=s}updatePathMinMax(t,s,a){[s,a]=$.applyTransform([s,a],t),this.minX=Math.min(this.minX,s),this.minY=Math.min(this.minY,a),this.maxX=Math.max(this.maxX,s),this.maxY=Math.max(this.maxY,a)}updateRectMinMax(t,s){const a=$.applyTransform(s,t),i=$.applyTransform(s.slice(2),t),n=$.applyTransform([s[0],s[3]],t),r=$.applyTransform([s[2],s[1]],t);this.minX=Math.min(this.minX,a[0],i[0],n[0],r[0]),this.minY=Math.min(this.minY,a[1],i[1],n[1],r[1]),this.maxX=Math.max(this.maxX,a[0],i[0],n[0],r[0]),this.maxY=Math.max(this.maxY,a[1],i[1],n[1],r[1])}updateScalingPathMinMax(t,s){$.scaleMinMax(t,s),this.minX=Math.min(this.minX,s[0]),this.minY=Math.min(this.minY,s[1]),this.maxX=Math.max(this.maxX,s[2]),this.maxY=Math.max(this.maxY,s[3])}updateCurvePathMinMax(t,s,a,i,n,r,l,c,u,h){const d=$.bezierBoundingBox(s,a,i,n,r,l,c,u,h);h||this.updateRectMinMax(t,d)}getPathBoundingBox(t=Ce.FILL,s=null){const a=[this.minX,this.minY,this.maxX,this.maxY];if(t===Ce.STROKE){s||yt("Stroke bounding box must include transform.");const i=$.singularValueDecompose2dScale(s),n=i[0]*this.lineWidth/2,r=i[1]*this.lineWidth/2;a[0]-=n,a[1]-=r,a[2]+=n,a[3]+=r}return a}updateClipFromPath(){const t=$.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=Ce.FILL,s=null){return $.intersect(this.clipBox,this.getPathBoundingBox(t,s))}}function Xw(e,t){if(t instanceof ImageData){e.putImageData(t,0,0);return}const s=t.height,a=t.width,i=s%Ye,n=(s-i)/Ye,r=i===0?n:n+1,l=e.createImageData(a,Ye);let c=0,u;const h=t.data,d=l.data;let f,g,v,y;if(t.kind===$h.GRAYSCALE_1BPP){const A=h.byteLength,b=new Uint32Array(d.buffer,0,d.byteLength>>2),x=b.length,w=a+7>>3,S=4294967295,E=We.isLittleEndian?4278190080:255;for(f=0;f<r;f++){for(v=f<n?Ye:i,u=0,g=0;g<v;g++){const M=A-c;let N=0;const P=M>w?a:M*8-7,T=P&-8;let I=0,V=0;for(;N<T;N+=8)V=h[c++],b[u++]=V&128?S:E,b[u++]=V&64?S:E,b[u++]=V&32?S:E,b[u++]=V&16?S:E,b[u++]=V&8?S:E,b[u++]=V&4?S:E,b[u++]=V&2?S:E,b[u++]=V&1?S:E;for(;N<P;N++)I===0&&(V=h[c++],I=128),b[u++]=V&I?S:E,I>>=1}for(;u<x;)b[u++]=0;e.putImageData(l,0,f*Ye)}}else if(t.kind===$h.RGBA_32BPP){for(g=0,y=a*Ye*4,f=0;f<n;f++)d.set(h.subarray(c,c+y)),c+=y,e.putImageData(l,0,g),g+=Ye;f<r&&(y=a*i*4,d.set(h.subarray(c,c+y)),e.putImageData(l,0,g))}else if(t.kind===$h.RGB_24BPP)for(v=Ye,y=a*v,f=0;f<r;f++){for(f>=n&&(v=i,y=a*v),u=0,g=y;g--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;e.putImageData(l,0,f*Ye)}else throw new Error(`bad image kind: ${t.kind}`)}function Yw(e,t){if(t.bitmap){e.drawImage(t.bitmap,0,0);return}const s=t.height,a=t.width,i=s%Ye,n=(s-i)/Ye,r=i===0?n:n+1,l=e.createImageData(a,Ye);let c=0;const u=t.data,h=l.data;for(let d=0;d<r;d++){const f=d<n?Ye:i;({srcPos:c}=u2({src:u,srcPos:c,dest:h,width:a,height:f,nonBlackColor:0})),e.putImageData(l,0,d*Ye)}}function Pl(e,t){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const a of s)e[a]!==void 0&&(t[a]=e[a]);e.setLineDash!==void 0&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function Ah(e){if(e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",e.setLineDash!==void 0&&(e.setLineDash([]),e.lineDashOffset=0),!Ne){const{filter:t}=e;t!=="none"&&t!==""&&(e.filter="none")}}function Kw(e,t){if(t)return!0;const s=$.singularValueDecompose2dScale(e);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const a=Math.fround((globalThis.devicePixelRatio||1)*fl.PDF_TO_CSS_UNITS);return s[0]<=a&&s[1]<=a}const g2=["butt","round","square"],m2=["miter","round","bevel"],v2={},Qw={};var wi,hv,dv,fv;const b2=class Uk{constructor(t,s,a,i,n,{optionalContentConfig:r,markedContentStack:l=null},c,u){k(this,wi),this.ctx=t,this.current=new qw(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=s,this.objs=a,this.canvasFactory=i,this.filterFactory=n,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=r,this.cachedCanvases=new f2(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,s=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):s}beginDrawing({transform:t,viewport:s,transparency:a=!1,background:i=null}){const n=this.ctx.canvas.width,r=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,n,r),this.ctx.fillStyle=l,a){const c=this.cachedCanvases.getCanvas("transparent",n,r);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Et(this.compositeCtx))}this.ctx.save(),Ah(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...s.transform),this.viewportScale=s.scale,this.baseTransform=Et(this.ctx)}executeOperatorList(t,s,a,i){const n=t.argsArray,r=t.fnArray;let l=s||0;const c=n.length;if(c===l)return l;const u=c-l>Vw&&typeof a=="function",h=u?Date.now()+h2:0;let d=0;const f=this.commonObjs,g=this.objs;let v;for(;;){if(i!==void 0&&l===i.nextBreakPoint)return i.breakIt(l,a),l;if(v=r[l],v!==qs.dependency)this[v].apply(this,n[l]);else for(const y of n[l]){const A=y.startsWith("g_")?f:g;if(!A.has(y))return A.get(y,a),l}if(l++,l===c)return l;if(u&&++d>Vw){if(Date.now()>h)return a(),l;d=0}}}endDrawing(){_(this,wi,hv).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const s of t.values())typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&(s.width=s.height=0);t.clear()}this._cachedBitmapsMap.clear(),_(this,wi,dv).call(this)}_scaleImage(t,s){const a=t.width??t.displayWidth,i=t.height??t.displayHeight;let n=Math.max(Math.hypot(s[0],s[1]),1),r=Math.max(Math.hypot(s[2],s[3]),1),l=a,c=i,u="prescale1",h,d;for(;n>2&&l>1||r>2&&c>1;){let f=l,g=c;n>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),n/=l/f),r>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,r/=c/g),h=this.cachedCanvases.getCanvas(u,f,g),d=h.context,d.clearRect(0,0,f,g),d.drawImage(t,0,0,l,c,0,0,f,g),t=h.canvas,l=f,c=g,u=u==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:l,paintHeight:c}}_createMaskCanvas(t){const s=this.ctx,{width:a,height:i}=t,n=this.current.fillColor,r=this.current.patternFill,l=Et(s);let c,u,h,d;if((t.bitmap||t.data)&&t.count>1){const P=t.bitmap||t.data.buffer;u=JSON.stringify(r?l:[l.slice(0,4),n]),c=this._cachedBitmapsMap.get(P),c||(c=new Map,this._cachedBitmapsMap.set(P,c));const T=c.get(u);if(T&&!r){const I=Math.round(Math.min(l[0],l[2])+l[4]),V=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:T,offsetX:I,offsetY:V}}h=T}h||(d=this.cachedCanvases.getCanvas("maskCanvas",a,i),Yw(d.context,t));let f=$.transform(l,[1/a,0,0,-1/i,0,0]);f=$.transform(f,[1,0,0,1,0,-i]);const[g,v,y,A]=$.getAxialAlignedBoundingBox([0,0,a,i],f),b=Math.round(y-g)||1,x=Math.round(A-v)||1,w=this.cachedCanvases.getCanvas("fillCanvas",b,x),S=w.context,E=g,M=v;S.translate(-E,-M),S.transform(...f),h||(h=this._scaleImage(d.canvas,aa(S)),h=h.img,c&&r&&c.set(u,h)),S.imageSmoothingEnabled=Kw(Et(S),t.interpolate),_h(S,h,0,0,h.width,h.height,0,0,a,i),S.globalCompositeOperation="source-in";const N=$.transform(aa(S),[1,0,0,1,-E,-M]);return S.fillStyle=r?n.getPattern(s,this,N,Ce.FILL):n,S.fillRect(0,0,a,i),c&&!r&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,w.canvas)),{canvas:w.canvas,offsetX:Math.round(E),offsetY:Math.round(M)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=g2[t]}setLineJoin(t){this.ctx.lineJoin=m2[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,s){const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(t),a.lineDashOffset=s)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[s,a]of t)switch(s){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=a;break;case"ca":this.current.fillAlpha=a,this.ctx.globalAlpha=a;break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,s=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(a,t,s);this.suspendedCtx=this.ctx,this.ctx=i.context;const n=this.ctx;n.setTransform(...Et(this.suspendedCtx)),Pl(this.suspendedCtx,n),d2(n,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Pl(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const s=this.current.activeSMask,a=this.suspendedCtx;this.composeSMask(a,s,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,s,a,i){const n=i[0],r=i[1],l=i[2]-n,c=i[3]-r;l===0||c===0||(this.genericComposeSMask(s.context,a,l,c,s.subtype,s.backdrop,s.transferMap,n,r,s.offsetX,s.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(a.canvas,0,0),t.restore())}genericComposeSMask(t,s,a,i,n,r,l,c,u,h,d){let f=t.canvas,g=c-h,v=u-d;if(r){const A=$.makeHexColor(...r);if(g<0||v<0||g+a>f.width||v+i>f.height){const b=this.cachedCanvases.getCanvas("maskExtension",a,i),x=b.context;x.drawImage(f,-g,-v),x.globalCompositeOperation="destination-atop",x.fillStyle=A,x.fillRect(0,0,a,i),x.globalCompositeOperation="source-over",f=b.canvas,g=v=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(g,v,a,i),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=A,t.fillRect(g,v,a,i),t.restore()}}s.save(),s.globalAlpha=1,s.setTransform(1,0,0,1,0,0),n==="Alpha"&&l?s.filter=this.filterFactory.addAlphaFilter(l):n==="Luminosity"&&(s.filter=this.filterFactory.addLuminosityFilter(l));const y=new Path2D;y.rect(c,u,a,i),s.clip(y),s.globalCompositeOperation="destination-in",s.drawImage(f,g,v,a,i,c,u,a,i),s.restore()}save(){this.inSMaskMode?(Pl(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Pl(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,s,a,i,n,r){this.ctx.transform(t,s,a,i,n,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,s,a){const i=this.ctx,n=this.current;let r=n.x,l=n.y,c,u;const h=Et(i),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,f=d?a.slice(0):null;for(let g=0,v=0,y=t.length;g<y;g++)switch(t[g]|0){case qs.rectangle:r=s[v++],l=s[v++];const A=s[v++],b=s[v++],x=r+A,w=l+b;i.moveTo(r,l),A===0||b===0?i.lineTo(x,w):(i.lineTo(x,l),i.lineTo(x,w),i.lineTo(r,w)),d||n.updateRectMinMax(h,[r,l,x,w]),i.closePath();break;case qs.moveTo:r=s[v++],l=s[v++],i.moveTo(r,l),d||n.updatePathMinMax(h,r,l);break;case qs.lineTo:r=s[v++],l=s[v++],i.lineTo(r,l),d||n.updatePathMinMax(h,r,l);break;case qs.curveTo:c=r,u=l,r=s[v+4],l=s[v+5],i.bezierCurveTo(s[v],s[v+1],s[v+2],s[v+3],r,l),n.updateCurvePathMinMax(h,c,u,s[v],s[v+1],s[v+2],s[v+3],r,l,f),v+=6;break;case qs.curveTo2:c=r,u=l,i.bezierCurveTo(r,l,s[v],s[v+1],s[v+2],s[v+3]),n.updateCurvePathMinMax(h,c,u,r,l,s[v],s[v+1],s[v+2],s[v+3],f),r=s[v+2],l=s[v+3],v+=4;break;case qs.curveTo3:c=r,u=l,r=s[v+2],l=s[v+3],i.bezierCurveTo(s[v],s[v+1],r,l,r,l),n.updateCurvePathMinMax(h,c,u,s[v],s[v+1],r,l,r,l,f),v+=4;break;case qs.closePath:i.closePath();break}d&&n.updateScalingPathMinMax(h,f),n.setCurrentPoint(r,l)}closePath(){this.ctx.closePath()}stroke(t=!0){const s=this.ctx,a=this.current.strokeColor;s.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof a=="object"&&a!=null&&a.getPattern?(s.save(),s.strokeStyle=a.getPattern(s,this,aa(s),Ce.STROKE),this.rescaleAndStroke(!1),s.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),s.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const s=this.ctx,a=this.current.fillColor,i=this.current.patternFill;let n=!1;i&&(s.save(),s.fillStyle=a.getPattern(s,this,aa(s),Ce.FILL),n=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&r!==null&&(this.pendingEOFill?(s.fill("evenodd"),this.pendingEOFill=!1):s.fill()),n&&s.restore(),t&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=v2}eoClip(){this.pendingClip=Qw}beginText(){this.current.textMatrix=tk,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,s=this.ctx;if(t===void 0){s.beginPath();return}const a=new Path2D,i=s.getTransform().invertSelf();for(const{transform:n,x:r,y:l,fontSize:c,path:u}of t)a.addPath(u,new DOMMatrix(n).preMultiplySelf(i).translate(r,l).scale(c,-c));s.clip(a),s.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,s){var a;const i=this.commonObjs.get(t),n=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(n.fontMatrix=i.fontMatrix||Fm,(n.fontMatrix[0]===0||n.fontMatrix[3]===0)&&Z("Invalid font matrix for font "+t),s<0?(s=-s,n.fontDirection=-1):n.fontDirection=1,this.current.font=i,this.current.fontSize=s,i.isType3Font)return;const r=i.loadedName||"sans-serif",l=((a=i.systemFontInfo)==null?void 0:a.css)||`"${r}", ${i.fallbackName}`;let c="normal";i.black?c="900":i.bold&&(c="bold");const u=i.italic?"italic":"normal";let h=s;s<Uw?h=Uw:s>Hw&&(h=Hw),this.current.fontSizeScale=s/h,this.ctx.font=`${u} ${c} ${h}px ${l}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,s){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=s}setLeadingMoveText(t,s){this.setLeading(-s),this.moveText(t,s)}setTextMatrix(t,s,a,i,n,r){this.current.textMatrix=[t,s,a,i,n,r],this.current.textMatrixScale=Math.hypot(t,s),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,s,a,i,n){const r=this.ctx,l=this.current,c=l.font,u=l.textRenderingMode,h=l.fontSize/l.fontSizeScale,d=u&ye.FILL_STROKE_MASK,f=!!(u&ye.ADD_TO_PATH_FLAG),g=l.patternFill&&!c.missingFile,v=l.patternStroke&&!c.missingFile;let y;if((c.disableFontFace||f||g||v)&&(y=c.getPathGenerator(this.commonObjs,t)),c.disableFontFace||g||v){if(r.save(),r.translate(s,a),r.scale(h,-h),d===ye.FILL||d===ye.FILL_STROKE)if(i){const A=r.getTransform();r.setTransform(...i),r.fill(_(this,wi,fv).call(this,y,A,i))}else r.fill(y);if(d===ye.STROKE||d===ye.FILL_STROKE)if(n){const A=r.getTransform();r.setTransform(...n),r.stroke(_(this,wi,fv).call(this,y,A,n))}else r.lineWidth/=h,r.stroke(y);r.restore()}else(d===ye.FILL||d===ye.FILL_STROKE)&&r.fillText(t,s,a),(d===ye.STROKE||d===ye.FILL_STROKE)&&r.strokeText(t,s,a);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Et(r),x:s,y:a,fontSize:h,path:y})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const s=t.getImageData(0,0,10,10).data;let a=!1;for(let i=3;i<s.length;i+=4)if(s[i]>0&&s[i]<255){a=!0;break}return tt(this,"isFontSubpixelAAEnabled",a)}showText(t){const s=this.current,a=s.font;if(a.isType3Font)return this.showType3Text(t);const i=s.fontSize;if(i===0)return;const n=this.ctx,r=s.fontSizeScale,l=s.charSpacing,c=s.wordSpacing,u=s.fontDirection,h=s.textHScale*u,d=t.length,f=a.vertical,g=f?1:-1,v=a.defaultVMetrics,y=i*s.fontMatrix[0],A=s.textRenderingMode===ye.FILL&&!a.disableFontFace&&!s.patternFill;n.save(),n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),u>0?n.scale(h,-1):n.scale(h,1);let b,x;if(s.patternFill){n.save();const N=s.fillColor.getPattern(n,this,aa(n),Ce.FILL);b=Et(n),n.restore(),n.fillStyle=N}if(s.patternStroke){n.save();const N=s.strokeColor.getPattern(n,this,aa(n),Ce.STROKE);x=Et(n),n.restore(),n.strokeStyle=N}let w=s.lineWidth;const S=s.textMatrixScale;if(S===0||w===0){const N=s.textRenderingMode&ye.FILL_STROKE_MASK;(N===ye.STROKE||N===ye.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=S;if(r!==1&&(n.scale(r,r),w/=r),n.lineWidth=w,a.isInvalidPDFjsFont){const N=[];let P=0;for(const T of t)N.push(T.unicode),P+=T.width;n.fillText(N.join(""),0,0),s.x+=P*y*h,n.restore(),this.compose();return}let E=0,M;for(M=0;M<d;++M){const N=t[M];if(typeof N=="number"){E+=g*N*i/1e3;continue}let P=!1;const T=(N.isSpace?c:0)+l,I=N.fontChar,V=N.accent;let rt,ut,ht=N.width;if(f){const F=N.vmetric||v,B=-(N.vmetric?F[1]:ht*.5)*y,L=F[2]*y;ht=F?-F[0]:ht,rt=B/r,ut=(E+L)/r}else rt=E/r,ut=0;if(a.remeasure&&ht>0){const F=n.measureText(I).width*1e3/i*r;if(ht<F&&this.isFontSubpixelAAEnabled){const B=ht/F;P=!0,n.save(),n.scale(B,1),rt/=B}else ht!==F&&(rt+=(ht-F)/2e3*i/r)}if(this.contentVisible&&(N.isInFont||a.missingFile)){if(A&&!V)n.fillText(I,rt,ut);else if(this.paintChar(I,rt,ut,b,x),V){const F=rt+i*V.offset.x/r,B=ut-i*V.offset.y/r;this.paintChar(V.fontChar,F,B,b,x)}}const G=f?ht*y-T*u:ht*y+T*u;E+=G,P&&n.restore()}f?s.y-=E:s.x+=E*h,n.restore(),this.compose()}showType3Text(t){const s=this.ctx,a=this.current,i=a.font,n=a.fontSize,r=a.fontDirection,l=i.vertical?1:-1,c=a.charSpacing,u=a.wordSpacing,h=a.textHScale*r,d=a.fontMatrix||Fm,f=t.length,g=a.textRenderingMode===ye.INVISIBLE;let v,y,A,b;if(!(g||n===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,s.save(),s.transform(...a.textMatrix),s.translate(a.x,a.y),s.scale(h,r),v=0;v<f;++v){if(y=t[v],typeof y=="number"){b=l*y*n/1e3,this.ctx.translate(b,0),a.x+=b*h;continue}const x=(y.isSpace?u:0)+c,w=i.charProcOperatorList[y.operatorListId];if(!w){Z(`Type3 character "${y.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=y,this.save(),s.scale(n,n),s.transform(...d),this.executeOperatorList(w),this.restore()),A=$.applyTransform([y.width,0],d)[0]*n+x,s.translate(A,0),a.x+=A*h}s.restore(),this.processingType3=null}}setCharWidth(t,s){}setCharWidthAndBounds(t,s,a,i,n,r){this.ctx.rect(a,i,n-a,r-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let s;if(t[0]==="TilingPattern"){const a=t[1],i=this.baseTransform||Et(this.ctx),n={createCanvasGraphics:r=>new Uk(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};s=new c2(t,a,this.ctx,n,i)}else s=this._getPattern(t[1],t[2]);return s}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,s,a){this.ctx.strokeStyle=this.current.strokeColor=$.makeHexColor(t,s,a),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,s,a){this.ctx.fillStyle=this.current.fillColor=$.makeHexColor(t,s,a),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,s=null){let a;return this.cachedPatterns.has(t)?a=this.cachedPatterns.get(t):(a=l2(this.getObject(t)),this.cachedPatterns.set(t,a)),s&&(a.matrix=s),a}shadingFill(t){if(!this.contentVisible)return;const s=this.ctx;this.save();const a=this._getPattern(t);s.fillStyle=a.getPattern(s,this,aa(s),Ce.SHADING);const i=aa(s);if(i){const{width:n,height:r}=s.canvas,[l,c,u,h]=$.getAxialAlignedBoundingBox([0,0,n,r],i);this.ctx.fillRect(l,c,u-l,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){yt("Should not call beginInlineImage")}beginImageData(){yt("Should not call beginImageData")}paintFormXObjectBegin(t,s){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Et(this.ctx),s)){const a=s[2]-s[0],i=s[3]-s[1];this.ctx.rect(s[0],s[1],a,i),this.current.updateRectMinMax(Et(this.ctx),s),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const s=this.ctx;t.isolated||zp("TODO: Support non-isolated groups."),t.knockout&&Z("Knockout groups not supported.");const a=Et(s);if(t.matrix&&s.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=$.getAxialAlignedBoundingBox(t.bbox,Et(s));const n=[0,0,s.canvas.width,s.canvas.height];i=$.intersect(i,n)||[0,0,0,0];const r=Math.floor(i[0]),l=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-r,1),u=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;t.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,c,u),f=d.context;f.translate(-r,-l),f.transform(...a),t.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:r,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(s.setTransform(1,0,0,1,0,0),s.translate(r,l),s.save()),Pl(s,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const s=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Et(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const n=$.getAxialAlignedBoundingBox([0,0,s.canvas.width,s.canvas.height],i);this.ctx.drawImage(s.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(t,s,a,i,n){if(_(this,wi,hv).call(this),Ah(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),s){const r=s[2]-s[0],l=s[3]-s[1];if(n&&this.annotationCanvasMap){a=a.slice(),a[4]-=s[0],a[5]-=s[1],s=s.slice(),s[0]=s[1]=0,s[2]=r,s[3]=l;const[c,u]=$.singularValueDecompose2dScale(Et(this.ctx)),{viewportScale:h}=this,d=Math.ceil(r*this.outputScaleX*h),f=Math.ceil(l*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:g,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(t,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(c,0,0,-u,0,l*u),Ah(this.ctx)}else Ah(this.ctx),this.endPath(),this.ctx.rect(s[0],s[1],r,l),this.ctx.clip(),this.ctx.beginPath()}this.current=new qw(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...a),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),_(this,wi,dv).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const s=t.count;t=this.getObject(t.data,t),t.count=s;const a=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=p2(t)),i.compiled)){i.compiled(a);return}const n=this._createMaskCanvas(t),r=n.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(r,n.offsetX,n.offsetY),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,s,a=0,i=0,n,r){if(!this.contentVisible)return;t=this.getObject(t.data,t);const l=this.ctx;l.save();const c=Et(l);l.transform(s,a,i,n,0,0);const u=this._createMaskCanvas(t);l.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let h=0,d=r.length;h<d;h+=2){const f=$.transform(c,[s,a,i,n,r[h],r[h+1]]),[g,v]=$.applyTransform([0,0],f);l.drawImage(u.canvas,g,v)}l.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const s=this.ctx,a=this.current.fillColor,i=this.current.patternFill;for(const n of t){const{data:r,width:l,height:c,transform:u}=n,h=this.cachedCanvases.getCanvas("maskCanvas",l,c),d=h.context;d.save();const f=this.getObject(r,n);Yw(d,f),d.globalCompositeOperation="source-in",d.fillStyle=i?a.getPattern(d,this,aa(s),Ce.FILL):a,d.fillRect(0,0,l,c),d.restore(),s.save(),s.transform(...u),s.scale(1,-1),_h(s,h.canvas,0,0,l,c,0,-1,1,1),s.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){Z("Dependent image isn't ready yet");return}this.paintInlineImageXObject(s)}paintImageXObjectRepeat(t,s,a,i){if(!this.contentVisible)return;const n=this.getObject(t);if(!n){Z("Dependent image isn't ready yet");return}const r=n.width,l=n.height,c=[];for(let u=0,h=i.length;u<h;u+=2)c.push({transform:[s,0,0,a,i[u],i[u+1]],x:0,y:0,w:r,h:l});this.paintInlineImageXObjectGroup(n,c)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:s,width:a,height:i}=t,n=this.cachedCanvases.getCanvas("inlineImage",a,i),r=n.context;return r.filter=this.current.transferMaps,r.drawImage(s,0,0),r.filter="none",n.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const s=t.width,a=t.height,i=this.ctx;if(this.save(),!Ne){const{filter:l}=i;l!=="none"&&l!==""&&(i.filter="none")}i.scale(1/s,-1/a);let n;if(t.bitmap)n=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)n=t;else{const l=this.cachedCanvases.getCanvas("inlineImage",s,a).context;Xw(l,t),n=this.applyTransferMapsToCanvas(l)}const r=this._scaleImage(n,aa(i));i.imageSmoothingEnabled=Kw(Et(i),t.interpolate),_h(i,r.img,0,0,r.paintWidth,r.paintHeight,0,-a,s,a),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,s){if(!this.contentVisible)return;const a=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const n=t.width,r=t.height,l=this.cachedCanvases.getCanvas("inlineImage",n,r).context;Xw(l,t),i=this.applyTransferMapsToCanvas(l)}for(const n of s)a.save(),a.transform(...n.transform),a.scale(1,-1),_h(a,i,n.x,n.y,n.w,n.h,0,-1,1,1),a.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,s){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,s){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(s)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const a=this.ctx;this.pendingClip&&(s||(this.pendingClip===Qw?a.clip("evenodd"):a.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),a.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Et(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const s=Math.abs(t[0]*t[3]-t[2]*t[1]),a=Math.hypot(t[0],t[2]),i=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(a,i)/s}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:s,b:a,c:i,d:n}=this.ctx.getTransform();let r,l;if(a===0&&i===0){const c=Math.abs(s),u=Math.abs(n);if(c===u)if(t===0)r=l=1/c;else{const h=c*t;r=l=h<1?1/h:1}else if(t===0)r=1/c,l=1/u;else{const h=c*t,d=u*t;r=h<1?1/h:1,l=d<1?1/d:1}}else{const c=Math.abs(s*n-a*i),u=Math.hypot(s,a),h=Math.hypot(i,n);if(t===0)r=h/c,l=u/c;else{const d=t*c;r=h>d?h/d:1,l=u>d?u/d:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:s}=this,{lineWidth:a}=this.current,[i,n]=this.getScaleForStroking();if(s.lineWidth=a||1,i===1&&n===1){s.stroke();return}const r=s.getLineDash();if(t&&s.save(),s.scale(i,n),r.length>0){const l=Math.max(i,n);s.setLineDash(r.map(c=>c/l)),s.lineDashOffset/=l}s.stroke(),t&&s.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};wi=new WeakSet,hv=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},dv=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},fv=function(e,t,s){const a=new Path2D;return a.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),a};let cd=b2;for(const e in qs)cd.prototype[e]!==void 0&&(cd.prototype[qs[e]]=cd.prototype[e]);var Hf,Vf;class pn{static get workerPort(){return o(this,Hf)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");m(this,Hf,t)}static get workerSrc(){return o(this,Vf)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");m(this,Vf,t)}}Hf=new WeakMap,Vf=new WeakMap,k(pn,Hf,null),k(pn,Vf,"");var Yr,ud;class y2{constructor({parsedData:t,rawData:s}){k(this,Yr),k(this,ud),m(this,Yr,t),m(this,ud,s)}getRaw(){return o(this,ud)}get(t){return o(this,Yr).get(t)??null}getAll(){return Kb(o(this,Yr))}has(t){return o(this,Yr).has(t)}}Yr=new WeakMap,ud=new WeakMap;const Kr=Symbol("INTERNAL");var hd,dd,fd,oc;class w2{constructor(t,{name:s,intent:a,usage:i,rbGroups:n}){k(this,hd,!1),k(this,dd,!1),k(this,fd,!1),k(this,oc,!0),m(this,hd,!!(t&ns.DISPLAY)),m(this,dd,!!(t&ns.PRINT)),this.name=s,this.intent=a,this.usage=i,this.rbGroups=n}get visible(){if(o(this,fd))return o(this,oc);if(!o(this,oc))return!1;const{print:t,view:s}=this.usage;return o(this,hd)?(s==null?void 0:s.viewState)!=="OFF":o(this,dd)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,s,a=!1){t!==Kr&&yt("Internal method `_setVisible` called."),m(this,fd,a),m(this,oc,s)}}hd=new WeakMap,dd=new WeakMap,fd=new WeakMap,oc=new WeakMap;var Tn,vt,lc,cc,Gf,pv;class x2{constructor(t,s=ns.DISPLAY){if(k(this,Gf),k(this,Tn,null),k(this,vt,new Map),k(this,lc,null),k(this,cc,null),this.renderingIntent=s,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,m(this,cc,t.order);for(const a of t.groups)o(this,vt).set(a.id,new w2(s,a));if(t.baseState==="OFF")for(const a of o(this,vt).values())a._setVisible(Kr,!1);for(const a of t.on)o(this,vt).get(a)._setVisible(Kr,!0);for(const a of t.off)o(this,vt).get(a)._setVisible(Kr,!1);m(this,lc,this.getHash())}}isVisible(t){if(o(this,vt).size===0)return!0;if(!t)return zp("Optional content group not defined."),!0;if(t.type==="OCG")return o(this,vt).has(t.id)?o(this,vt).get(t.id).visible:(Z(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return _(this,Gf,pv).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const s of t.ids){if(!o(this,vt).has(s))return Z(`Optional content group not found: ${s}`),!0;if(o(this,vt).get(s).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const s of t.ids){if(!o(this,vt).has(s))return Z(`Optional content group not found: ${s}`),!0;if(!o(this,vt).get(s).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const s of t.ids){if(!o(this,vt).has(s))return Z(`Optional content group not found: ${s}`),!0;if(!o(this,vt).get(s).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const s of t.ids){if(!o(this,vt).has(s))return Z(`Optional content group not found: ${s}`),!0;if(o(this,vt).get(s).visible)return!1}return!0}return Z(`Unknown optional content policy ${t.policy}.`),!0}return Z(`Unknown group type ${t.type}.`),!0}setVisibility(t,s=!0,a=!0){var i;const n=o(this,vt).get(t);if(!n){Z(`Optional content group not found: ${t}`);return}if(a&&s&&n.rbGroups.length)for(const r of n.rbGroups)for(const l of r)l!==t&&((i=o(this,vt).get(l))==null||i._setVisible(Kr,!1,!0));n._setVisible(Kr,!!s,!0),m(this,Tn,null)}setOCGState({state:t,preserveRB:s}){let a;for(const i of t){switch(i){case"ON":case"OFF":case"Toggle":a=i;continue}const n=o(this,vt).get(i);if(n)switch(a){case"ON":this.setVisibility(i,!0,s);break;case"OFF":this.setVisibility(i,!1,s);break;case"Toggle":this.setVisibility(i,!n.visible,s);break}}m(this,Tn,null)}get hasInitialVisibility(){return o(this,lc)===null||this.getHash()===o(this,lc)}getOrder(){return o(this,vt).size?o(this,cc)?o(this,cc).slice():[...o(this,vt).keys()]:null}getGroups(){return o(this,vt).size>0?Kb(o(this,vt)):null}getGroup(t){return o(this,vt).get(t)||null}getHash(){if(o(this,Tn)!==null)return o(this,Tn);const t=new Nk;for(const[s,a]of o(this,vt))t.update(`${s}:${a.visible}`);return m(this,Tn,t.hexdigest())}}Tn=new WeakMap,vt=new WeakMap,lc=new WeakMap,cc=new WeakMap,Gf=new WeakSet,pv=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let a=1;a<t;a++){const i=e[a];let n;if(Array.isArray(i))n=_(this,Gf,pv).call(this,i);else if(o(this,vt).has(i))n=o(this,vt).get(i).visible;else return Z(`Optional content group not found: ${i}`),!0;switch(s){case"And":if(!n)return!1;break;case"Or":if(n)return!0;break;case"Not":return!n;default:return!0}}return s==="And"};class k2{constructor(t,{disableRange:s=!1,disableStream:a=!1}){Vt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:n,progressiveDone:r,contentDispositionFilename:l}=t;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=l,(n==null?void 0:n.length)>0){const c=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!a,this._isRangeSupported=!s,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),t.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),t.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:s}){const a=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(a):this._queuedChunks.push(a);else{const i=this._rangeReaders.some(function(n){return n._begin!==t?!1:(n._enqueue(a),!0)});Vt(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var s,a,i,n;t.total===void 0?(a=(s=this._rangeReaders[0])==null?void 0:s.onProgress)==null||a.call(s,{loaded:t.loaded}):(n=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||n.call(i,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const s=this._rangeReaders.indexOf(t);s>=0&&this._rangeReaders.splice(s,1)}getFullReader(){Vt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new _2(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,s){if(s<=this._progressiveDataLength)return null;const a=new A2(this,t,s);return this._pdfDataRangeTransport.requestDataRange(t,s),this._rangeReaders.push(a),a}cancelAllRequests(t){var s;(s=this._fullRequestReader)==null||s.cancel(t);for(const a of this._rangeReaders.slice(0))a.cancel(t);this._pdfDataRangeTransport.abort()}}class _2{constructor(t,s,a=!1,i=null){this._stream=t,this._done=a||!1,this._filename=Zb(i)?i:null,this._queuedChunks=s||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class A2{constructor(t,s,a){this._stream=t,this._begin=s,this._end=a,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const s=this._queuedChunk;return this._queuedChunk=null,{value:s,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function S2(e){let t=!0,s=a("filename\\*","i").exec(e);if(s){s=s[1];let h=l(s);return h=unescape(h),h=c(h),h=u(h),n(h)}if(s=r(e),s){const h=u(s);return n(h)}if(s=a("filename","i").exec(e),s){s=s[1];let h=l(s);return h=u(h),n(h)}function a(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),g=$p(d);d=f.decode(g),t=!1}catch{}}return d}function n(h){return t&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),t&&(h=i("iso-8859-1",h))),h}function r(h){const d=[];let f;const g=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=g.exec(h))!==null;){let[,y,A,b]=f;if(y=parseInt(y,10),y in d){if(y===0)break;continue}d[y]=[A,b]}const v=[];for(let y=0;y<d.length&&y in d;++y){let[A,b]=d[y];b=l(b),A&&(b=unescape(b),y===0&&(b=c(b))),v.push(b)}return v.join("")}function l(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const g=d[f].indexOf('"');g!==-1&&(d[f]=d[f].slice(0,g),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),g=h.slice(d+1).replace(/^[^']*'/,"");return i(f,g)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,g,v){if(g==="q"||g==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,A){return String.fromCharCode(parseInt(A,16))}),i(f,v);try{v=atob(v)}catch{}return i(f,v)})}return""}function Hk(e,t){const s=new Headers;if(!e||!t||typeof t!="object")return s;for(const a in t){const i=t[a];i!==void 0&&s.append(a,i)}return s}function Hp(e){try{return new URL(e).origin}catch{}return null}function Vk({responseHeaders:e,isHttp:t,rangeChunkSize:s,disableRange:a}){const i={allowRangeRequests:!1,suggestedLength:void 0},n=parseInt(e.get("Content-Length"),10);return!Number.isInteger(n)||(i.suggestedLength=n,n<=2*s)||a||!t||e.get("Accept-Ranges")!=="bytes"||(e.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function Gk(e){const t=e.get("Content-Disposition");if(t){let s=S2(t);if(s.includes("%"))try{s=decodeURIComponent(s)}catch{}if(Zb(s))return s}return null}function Vp(e,t){return e===404||e===0&&t.startsWith("file:")?new Bu('Missing PDF "'+t+'".'):new Pf(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e)}function qk(e){return e===200||e===206}function Xk(e,t,s){return{method:"GET",headers:e,signal:s.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Yk(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(Z(`getArrayBuffer - unexpected data format: ${e}`),new Uint8Array(e).buffer)}class Jw{constructor(t){X(this,"_responseOrigin",null),this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Hk(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Vt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new E2(this),this._fullRequestReader}getRangeReader(t,s){if(s<=this._progressiveDataLength)return null;const a=new C2(this,t,s);return this._rangeRequestReaders.push(a),a}cancelAllRequests(t){var s;(s=this._fullRequestReader)==null||s.cancel(t);for(const a of this._rangeRequestReaders.slice(0))a.cancel(t)}}class E2{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const s=t.source;this._withCredentials=s.withCredentials||!1,this._contentLength=s.length,this._headersCapability=Promise.withResolvers(),this._disableRange=s.disableRange||!1,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange;const a=new Headers(t.headers),i=s.url;fetch(i,Xk(a,this._withCredentials,this._abortController)).then(n=>{if(t._responseOrigin=Hp(n.url),!qk(n.status))throw Vp(n.status,i);this._reader=n.body.getReader(),this._headersCapability.resolve();const r=n.headers,{allowRangeRequests:l,suggestedLength:c}=Vk({responseHeaders:r,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=c||this._contentLength,this._filename=Gk(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new fn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;await this._headersCapability.promise;const{value:s,done:a}=await this._reader.read();return a?{value:s,done:a}:(this._loaded+=s.byteLength,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Yk(s),done:!1})}cancel(t){var s;(s=this._reader)==null||s.cancel(t),this._abortController.abort()}}class C2{constructor(t,s,a){this._stream=t,this._reader=null,this._loaded=0;const i=t.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const n=new Headers(t.headers);n.append("Range",`bytes=${s}-${a-1}`);const r=i.url;fetch(r,Xk(n,this._withCredentials,this._abortController)).then(l=>{const c=Hp(l.url);if(c!==t._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${t._responseOrigin}".`);if(!qk(l.status))throw Vp(l.status,r);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;await this._readCapability.promise;const{value:s,done:a}=await this._reader.read();return a?{value:s,done:a}:(this._loaded+=s.byteLength,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded}),{value:Yk(s),done:!1})}cancel(t){var s;(s=this._reader)==null||s.cancel(t),this._abortController.abort()}}const Mg=200,Ng=206;function M2(e){const t=e.response;return typeof t!="string"?t:$p(t).buffer}class N2{constructor({url:t,httpHeaders:s,withCredentials:a}){X(this,"_responseOrigin",null),this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Hk(this.isHttp,s),this.withCredentials=a||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const s=new XMLHttpRequest,a=this.currXhrId++,i=this.pendingRequests[a]={xhr:s};s.open("GET",this.url),s.withCredentials=this.withCredentials;for(const[n,r]of this.headers)s.setRequestHeader(n,r);return this.isHttp&&"begin"in t&&"end"in t?(s.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.expectedStatus=Ng):i.expectedStatus=Mg,s.responseType="arraybuffer",Vt(t.onError,"Expected `onError` callback to be provided."),s.onerror=()=>{t.onError(s.status)},s.onreadystatechange=this.onStateChange.bind(this,a),s.onprogress=this.onProgress.bind(this,a),i.onHeadersReceived=t.onHeadersReceived,i.onDone=t.onDone,i.onError=t.onError,i.onProgress=t.onProgress,s.send(null),a}onProgress(t,s){var a;const i=this.pendingRequests[t];i&&((a=i.onProgress)==null||a.call(i,s))}onStateChange(t,s){const a=this.pendingRequests[t];if(!a)return;const i=a.xhr;if(i.readyState>=2&&a.onHeadersReceived&&(a.onHeadersReceived(),delete a.onHeadersReceived),i.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],i.status===0&&this.isHttp){a.onError(i.status);return}const n=i.status||Mg;if(!(n===Mg&&a.expectedStatus===Ng)&&n!==a.expectedStatus){a.onError(i.status);return}const r=M2(i);if(n===Ng){const l=i.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?a.onDone({begin:parseInt(c[1],10),chunk:r}):(Z('Missing or invalid "Content-Range" header.'),a.onError(0))}else r?a.onDone({begin:0,chunk:r}):a.onError(i.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const s=this.pendingRequests[t].xhr;delete this.pendingRequests[t],s.abort()}}class P2{constructor(t){this._source=t,this._manager=new N2(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const s=this._rangeRequestReaders.indexOf(t);s>=0&&this._rangeRequestReaders.splice(s,1)}getFullReader(){return Vt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new T2(this._manager,this._source),this._fullRequestReader}getRangeReader(t,s){const a=new L2(this._manager,t,s);return a.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(a),a}cancelAllRequests(t){var s;(s=this._fullRequestReader)==null||s.cancel(t);for(const a of this._rangeRequestReaders.slice(0))a.cancel(t)}}class T2{constructor(t,s){this._manager=t,this._url=s.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=s.disableRange||!1,this._contentLength=s.length,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,s=this._manager.getRequestXhr(t);this._manager._responseOrigin=Hp(s.responseURL);const a=s.getAllResponseHeaders(),i=new Headers(a?a.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...u]=l.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:n,suggestedLength:r}=Vk({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=Gk(i),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Vp(t,this._url),this._headersCapability.reject(this._storedError);for(const s of this._requests)s.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var s;(s=this.onProgress)==null||s.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L2{constructor(t,s,a){this._manager=t,this._url=t.url,this._requestId=t.request({begin:s,end:a,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const s=Hp((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);s!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${s}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const s=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:s,done:!1}):this._queuedChunk=s,this._done=!0;for(const a of this._requests)a.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=Vp(t,this._url));for(const s of this._requests)s.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var s;this.isStreamingSupported||(s=this.onProgress)==null||s.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const s=this._queuedChunk;return this._queuedChunk=null,{value:s,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const R2=/^[a-z][a-z0-9\-+.]+:/i;function I2(e){if(R2.test(e))return new URL(e);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(e))}class D2{constructor(t){this.source=t,this.url=I2(t.url),Vt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Vt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new j2(this),this._fullRequestReader}getRangeReader(t,s){if(s<=this._progressiveDataLength)return null;const a=new F2(this,t,s);return this._rangeRequestReaders.push(a),a}cancelAllRequests(t){var s;(s=this._fullRequestReader)==null||s.cancel(t);for(const a of this._rangeRequestReaders.slice(0))a.cancel(t)}}class j2{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const s=t.source;this._contentLength=s.length,this._loaded=0,this._filename=null,this._disableRange=s.disableRange||!1,this._rangeChunkSize=s.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!s.disableStream,this._isRangeSupported=!s.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const a=process.getBuiltinModule("fs");a.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(a.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Bu(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const s=this._readableStream.read();return s===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=s.length,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(s).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",s=>{this._error(s)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new fn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class F2{constructor(t,s,a){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=t.source;this._isStreamingSupported=!i.disableStream;const n=process.getBuiltinModule("fs");this._setReadableStream(n.createReadStream(this._url,{start:s,end:a-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var t;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const s=this._readableStream.read();return s===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=s.length,(t=this.onProgress)==null||t.call(this,{loaded:this._loaded}),{value:new Uint8Array(s).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",s=>{this._error(s)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const O2=1e5,Be=30,W2=.8;var Zw,Ln,ss,pd,gd,nr,$i,qf,Xf,Qr,eu,uc,rr,su,Yf,hc,Qo,Kf,Qf,Jr,To,Sh,wn,au,Jo,Kk,t0,gv,Ga,md,Pg,Qk,e0;const Ue=class dc{constructor({textContentSource:t,container:s,viewport:a}){k(this,Jo),k(this,Ln,Promise.withResolvers()),k(this,ss,null),k(this,pd,!1),k(this,gd,!!((Zw=globalThis.FontInspector)!=null&&Zw.enabled)),k(this,nr,null),k(this,$i,null),k(this,qf,0),k(this,Xf,0),k(this,Qr,null),k(this,eu,null),k(this,uc,0),k(this,rr,0),k(this,su,Object.create(null)),k(this,Yf,[]),k(this,hc,null),k(this,Qo,[]),k(this,Kf,new WeakMap),k(this,Qf,null);var i;if(t instanceof ReadableStream)m(this,hc,t);else if(typeof t=="object")m(this,hc,new ReadableStream({start(u){u.enqueue(t),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,ss,m(this,eu,s)),m(this,rr,a.scale*(globalThis.devicePixelRatio||1)),m(this,uc,a.rotation),m(this,$i,{div:null,properties:null,ctx:null});const{pageWidth:n,pageHeight:r,pageX:l,pageY:c}=a.rawDims;m(this,Qf,[1,0,0,-1,-l,c+r]),m(this,Xf,n),m(this,qf,r),_(i=dc,Ga,Qk).call(i),yr(s,a),o(this,Ln).promise.finally(()=>{o(dc,au).delete(this),m(this,$i,null),m(this,su,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:s}=We.platform;return tt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&s?"Calibri, ":""}sans-serif`],["monospace",`${t&&s?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{o(this,Qr).read().then(({value:s,done:a})=>{if(a){o(this,Ln).resolve();return}o(this,nr)??m(this,nr,s.lang),Object.assign(o(this,su),s.styles),_(this,Jo,Kk).call(this,s.items),t()},o(this,Ln).reject)};return m(this,Qr,o(this,hc).getReader()),o(dc,au).add(this),t(),o(this,Ln).promise}update({viewport:t,onBefore:s=null}){var a;const i=t.scale*(globalThis.devicePixelRatio||1),n=t.rotation;if(n!==o(this,uc)&&(s==null||s(),m(this,uc,n),yr(o(this,eu),{rotation:n})),i!==o(this,rr)){s==null||s(),m(this,rr,i);const r={div:null,properties:null,ctx:_(a=dc,Ga,md).call(a,o(this,nr))};for(const l of o(this,Qo))r.properties=o(this,Kf).get(l),r.div=l,_(this,Jo,gv).call(this,r)}}cancel(){var t;const s=new fn("TextLayer task cancelled.");(t=o(this,Qr))==null||t.cancel(s).catch(()=>{}),m(this,Qr,null),o(this,Ln).reject(s)}get textDivs(){return o(this,Qo)}get textContentItemsStr(){return o(this,Yf)}static cleanup(){if(!(o(this,au).size>0)){o(this,Jr).clear();for(const{canvas:t}of o(this,To).values())t.remove();o(this,To).clear()}}};Ln=new WeakMap,ss=new WeakMap,pd=new WeakMap,gd=new WeakMap,nr=new WeakMap,$i=new WeakMap,qf=new WeakMap,Xf=new WeakMap,Qr=new WeakMap,eu=new WeakMap,uc=new WeakMap,rr=new WeakMap,su=new WeakMap,Yf=new WeakMap,hc=new WeakMap,Qo=new WeakMap,Kf=new WeakMap,Qf=new WeakMap,Jr=new WeakMap,To=new WeakMap,Sh=new WeakMap,wn=new WeakMap,au=new WeakMap,Jo=new WeakSet,Kk=function(e){var t,s;if(o(this,pd))return;(s=o(this,$i)).ctx??(s.ctx=_(t=Ue,Ga,md).call(t,o(this,nr)));const a=o(this,Qo),i=o(this,Yf);for(const n of e){if(a.length>O2){Z("Ignoring additional textDivs for performance reasons."),m(this,pd,!0);return}if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const r=o(this,ss);m(this,ss,document.createElement("span")),o(this,ss).classList.add("markedContent"),n.id!==null&&o(this,ss).setAttribute("id",`${n.id}`),r.append(o(this,ss))}else n.type==="endMarkedContent"&&m(this,ss,o(this,ss).parentNode);continue}i.push(n.str),_(this,Jo,t0).call(this,n)}},t0=function(e){var t;const s=document.createElement("span"),a={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};o(this,Qo).push(s);const i=$.transform(o(this,Qf),e.transform);let n=Math.atan2(i[1],i[0]);const r=o(this,su)[e.fontName];r.vertical&&(n+=Math.PI/2);let l=o(this,gd)&&r.fontSubstitution||r.fontFamily;l=Ue.fontFamilyMap.get(l)||l;const c=Math.hypot(i[2],i[3]),u=c*_(t=Ue,Ga,e0).call(t,l,o(this,nr));let h,d;n===0?(h=i[4],d=i[5]-u):(h=i[4]+u*Math.sin(n),d=i[5]-u*Math.cos(n));const f="calc(var(--scale-factor)*",g=s.style;o(this,ss)===o(this,eu)?(g.left=`${(100*h/o(this,Xf)).toFixed(2)}%`,g.top=`${(100*d/o(this,qf)).toFixed(2)}%`):(g.left=`${f}${h.toFixed(2)}px)`,g.top=`${f}${d.toFixed(2)}px)`),g.fontSize=`${f}${(o(Ue,wn)*c).toFixed(2)}px)`,g.fontFamily=l,a.fontSize=c,s.setAttribute("role","presentation"),s.textContent=e.str,s.dir=e.dir,o(this,gd)&&(s.dataset.fontName=r.fontSubstitutionLoadedName||e.fontName),n!==0&&(a.angle=n*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const y=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);y!==A&&Math.max(y,A)/Math.min(y,A)>1.5&&(v=!0)}if(v&&(a.canvasWidth=r.vertical?e.height:e.width),o(this,Kf).set(s,a),o(this,$i).div=s,o(this,$i).properties=a,_(this,Jo,gv).call(this,o(this,$i)),a.hasText&&o(this,ss).append(s),a.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),o(this,ss).append(y)}},gv=function(e){var t;const{div:s,properties:a,ctx:i}=e,{style:n}=s;let r="";if(o(Ue,wn)>1&&(r=`scale(${1/o(Ue,wn)})`),a.canvasWidth!==0&&a.hasText){const{fontFamily:l}=n,{canvasWidth:c,fontSize:u}=a;_(t=Ue,Ga,Pg).call(t,i,u*o(this,rr),l);const{width:h}=i.measureText(s.textContent);h>0&&(r=`scaleX(${c*o(this,rr)/h}) ${r}`)}a.angle!==0&&(r=`rotate(${a.angle}deg) ${r}`),r.length>0&&(n.transform=r)},Ga=new WeakSet,md=function(e=null){let t=o(this,To).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),o(this,To).set(e,t),o(this,Sh).set(t,{size:0,family:""})}return t},Pg=function(e,t,s){const a=o(this,Sh).get(e);t===a.size&&s===a.family||(e.font=`${t}px ${s}`,a.size=t,a.family=s)},Qk=function(){if(o(this,wn)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),m(this,wn,e.getBoundingClientRect().height),e.remove()},e0=function(e,t){const s=o(this,Jr).get(e);if(s)return s;const a=_(this,Ga,md).call(this,t);a.canvas.width=a.canvas.height=Be,_(this,Ga,Pg).call(this,a,Be,e);const i=a.measureText("");let n=i.fontBoundingBoxAscent,r=Math.abs(i.fontBoundingBoxDescent);if(n){const u=n/(n+r);return o(this,Jr).set(e,u),a.canvas.width=a.canvas.height=0,u}a.strokeStyle="red",a.clearRect(0,0,Be,Be),a.strokeText("g",0,0);let l=a.getImageData(0,0,Be,Be).data;r=0;for(let u=l.length-1-3;u>=0;u-=4)if(l[u]>0){r=Math.ceil(u/4/Be);break}a.clearRect(0,0,Be,Be),a.strokeText("A",0,Be),l=a.getImageData(0,0,Be,Be).data,n=0;for(let u=0,h=l.length;u<h;u+=4)if(l[u]>0){n=Be-Math.floor(u/4/Be);break}a.canvas.width=a.canvas.height=0;const c=n?n/(n+r):W2;return o(this,Jr).set(e,c),c},k(Ue,Ga),k(Ue,Jr,new Map),k(Ue,To,new Map),k(Ue,Sh,new WeakMap),k(Ue,wn,null),k(Ue,au,new Set);let mv=Ue;class Hu{static textContent(t){const s=[],a={items:s,styles:Object.create(null)};function i(n){var r;if(!n)return;let l=null;const c=n.name;if(c==="#text")l=n.value;else if(Hu.shouldBuildText(c))(r=n==null?void 0:n.attributes)!=null&&r.textContent?l=n.attributes.textContent:n.value&&(l=n.value);else return;if(l!==null&&s.push({str:l}),!!n.children)for(const u of n.children)i(u)}return i(t),a}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const z2=65536,$2=100,B2=5e3,U2=Ne?e2:JM,H2=Ne?s2:Dk,V2=Ne?t2:ZM,G2=Ne?a2:Wk;function q2(e={}){typeof e=="string"||e instanceof URL?e={url:e}:(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t=new K2,{docId:s}=t,a=e.url?X2(e.url):null,i=e.data?Y2(e.data):null,n=e.httpHeaders||null,r=e.withCredentials===!0,l=e.password??null,c=e.range instanceof t_?e.range:null,u=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:z2;let h=e.worker instanceof yd?e.worker:null;const d=e.verbosity,f=typeof e.docBaseUrl=="string"&&!Up(e.docBaseUrl)?e.docBaseUrl:null,g=typeof e.cMapUrl=="string"?e.cMapUrl:null,v=e.cMapPacked!==!1,y=e.CMapReaderFactory||H2,A=typeof e.standardFontDataUrl=="string"?e.standardFontDataUrl:null,b=e.StandardFontDataFactory||G2,x=e.stopAtErrors!==!0,w=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,S=e.isEvalSupported!==!1,E=typeof e.isOffscreenCanvasSupported=="boolean"?e.isOffscreenCanvasSupported:!Ne,M=typeof e.isImageDecoderSupported=="boolean"?e.isImageDecoderSupported:!Ne&&(We.platform.isFirefox||!globalThis.chrome),N=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,P=typeof e.disableFontFace=="boolean"?e.disableFontFace:Ne,T=e.fontExtraProperties===!0,I=e.enableXfa===!0,V=e.ownerDocument||globalThis.document,rt=e.disableRange===!0,ut=e.disableStream===!0,ht=e.disableAutoFetch===!0,G=e.pdfBug===!0,F=e.CanvasFactory||U2,B=e.FilterFactory||V2,L=e.enableHWA===!0,j=c?c.length:e.length??NaN,D=typeof e.useSystemFonts=="boolean"?e.useSystemFonts:!Ne&&!P,Y=typeof e.useWorkerFetch=="boolean"?e.useWorkerFetch:y===Dk&&b===Wk&&g&&A&&$l(g,document.baseURI)&&$l(A,document.baseURI),Q=null;CM(d);const ft={canvasFactory:new F({ownerDocument:V,enableHWA:L}),filterFactory:new B({docId:s,ownerDocument:V}),cMapReaderFactory:Y?null:new y({baseUrl:g,isCompressed:v}),standardFontDataFactory:Y?null:new b({baseUrl:A})};if(!h){const dt={verbosity:d,port:pn.workerPort};h=dt.port?yd.fromPort(dt):new yd(dt),t._worker=h}const wt={docId:s,apiVersion:"4.10.38",data:i,password:l,disableAutoFetch:ht,rangeChunkSize:u,length:j,docBaseUrl:f,enableXfa:I,evaluatorOptions:{maxImageSize:w,disableFontFace:P,ignoreErrors:x,isEvalSupported:S,isOffscreenCanvasSupported:E,isImageDecoderSupported:M,canvasMaxAreaInBytes:N,fontExtraProperties:T,useSystemFonts:D,cMapUrl:Y?g:null,standardFontDataUrl:Y?A:null}},ae={disableFontFace:P,fontExtraProperties:T,ownerDocument:V,pdfBug:G,styleElement:Q,loadingParams:{disableAutoFetch:ht,enableXfa:I}};return h.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const dt=h.messageHandler.sendWithPromise("GetDocRequest",wt,i?[i.buffer]:null);let at;if(c)at=new k2(c,{disableRange:rt,disableStream:ut});else if(!i){if(!a)throw new Error("getDocument - no `url` parameter provided.");let Te;if(Ne)if($l(a)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Te=Jw}else Te=D2;else Te=$l(a)?Jw:P2;at=new Te({url:a,length:j,httpHeaders:n,withCredentials:r,rangeChunkSize:u,disableRange:rt,disableStream:ut})}return dt.then(Te=>{if(t.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const me=new ac(s,Te,h.port),gs=new tN(me,t,at,ae,ft);t._transport=gs,me.send("Ready",null)})}).catch(t._capability.reject),t}function X2(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(Ne&&typeof e=="string")return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Y2(e){if(Ne&&typeof Buffer<"u"&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if(typeof e=="string")return $p(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||typeof e=="object"&&!isNaN(e==null?void 0:e.length))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function s0(e){return typeof e=="object"&&Number.isInteger(e==null?void 0:e.num)&&e.num>=0&&Number.isInteger(e==null?void 0:e.gen)&&e.gen>=0}var vv;const Jk=class Zk{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Je(Zk,vv)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,s,a,i;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((s=this._transport)==null?void 0:s.destroy())}catch(n){throw(a=this._worker)!=null&&a.port&&delete this._worker._pendingDestroy,n}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};vv=new WeakMap,k(Jk,vv,0);let K2=Jk;class t_{constructor(t,s,a=!1,i=null){this.length=t,this.initialData=s,this.progressiveDone=a,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,s){for(const a of this._rangeListeners)a(t,s)}onDataProgress(t,s){this._readyCapability.promise.then(()=>{for(const a of this._progressListeners)a(t,s)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const s of this._progressiveReadListeners)s(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,s){yt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Q2{constructor(t,s){this._pdfInfo=t,this._transport=s}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return tt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:s}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(s)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Rn,Bi,ma,Lo,Jf;class J2{constructor(t,s,a,i=!1){k(this,ma),k(this,Rn,null),k(this,Bi,!1),this._pageIndex=t,this._pageInfo=s,this._transport=a,this._stats=i?new Nw:null,this._pdfBug=i,this.commonObjs=a.commonObjs,this.objs=new e_,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:s=this.rotate,offsetX:a=0,offsetY:i=0,dontFlip:n=!1}={}){return new Qu({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:s,offsetX:a,offsetY:i,dontFlip:n})}getAnnotations({intent:t="display"}={}){const{renderingIntent:s}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,s)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return tt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:s,intent:a="display",annotationMode:i=Wi.ENABLE,transform:n=null,background:r=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:d=!1}){var f,g;(f=this._stats)==null||f.time("Overall");const v=this._transport.getRenderingIntent(a,i,h,d),{renderingIntent:y,cacheKey:A}=v;m(this,Bi,!1),_(this,ma,Jf).call(this),l||(l=this._transport.getOptionalContentConfig(y));let b=this._intentStates.get(A);b||(b=Object.create(null),this._intentStates.set(A,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const x=!!(y&ns.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(g=this._stats)==null||g.time("Page Request"),this._pumpOperatorList(v));const w=M=>{var N;b.renderTasks.delete(S),(this._maybeCleanupAfterRender||x)&&m(this,Bi,!0),_(this,ma,Lo).call(this,!x),M?(S.capability.reject(M),this._abortOperatorList({intentState:b,reason:M instanceof Error?M:new Error(M)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(N=globalThis.Stats)!=null&&N.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new sN({callback:w,params:{canvasContext:t,viewport:s,transform:n,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:u});(b.renderTasks||(b.renderTasks=new Set)).add(S);const E=S.task;return Promise.all([b.displayReadyCapability.promise,l]).then(([M,N])=>{var P;if(this.destroyed){w();return}if((P=this._stats)==null||P.time("Rendering"),!(N.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:M,optionalContentConfig:N}),S.operatorListChanged()}).catch(w),E}getOperatorList({intent:t="display",annotationMode:s=Wi.ENABLE,printAnnotationStorage:a=null,isEditing:i=!1}={}){var n;function r(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(u))}const l=this._transport.getRenderingIntent(t,s,a,i,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let u;return c.opListReadCapability||(u=Object.create(null),u.operatorListChanged=r,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(u),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(n=this._stats)==null||n.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:s=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:s===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(a=>Hu.textContent(a));const s=this.streamTextContent(t);return new Promise(function(a,i){function n(){r.read().then(function({value:c,done:u}){if(u){a(l);return}l.lang??(l.lang=c.lang),Object.assign(l.styles,c.styles),l.items.push(...c.items),n()},i)}const r=s.getReader(),l={items:[],styles:Object.create(null),lang:null};n()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const s of this._intentStates.values())if(this._abortOperatorList({intentState:s,reason:new Error("Page was destroyed."),force:!0}),!s.opListReadCapability)for(const a of s.renderTasks)t.push(a.completed),a.cancel();return this.objs.clear(),m(this,Bi,!1),_(this,ma,Jf).call(this),Promise.all(t)}cleanup(t=!1){m(this,Bi,!0);const s=_(this,ma,Lo).call(this,!1);return t&&s&&this._stats&&(this._stats=new Nw),s}_startRenderPage(t,s){var a,i;const n=this._intentStates.get(s);n&&((a=this._stats)==null||a.timeEnd("Page Request"),(i=n.displayReadyCapability)==null||i.resolve(t))}_renderPageChunk(t,s){for(let a=0,i=t.length;a<i;a++)s.operatorList.fnArray.push(t.fnArray[a]),s.operatorList.argsArray.push(t.argsArray[a]);s.operatorList.lastChunk=t.lastChunk,s.operatorList.separateAnnots=t.separateAnnots;for(const a of s.renderTasks)a.operatorListChanged();t.lastChunk&&_(this,ma,Lo).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:s,annotationStorageSerializable:a,modifiedIds:i}){const{map:n,transfer:r}=a,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:s,annotationStorage:n,modifiedIds:i},r).getReader(),c=this._intentStates.get(s);c.streamReader=l;const u=()=>{l.read().then(({value:h,done:d})=>{if(d){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,c),u())},h=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const d of c.renderTasks)d.operatorListChanged();_(this,ma,Lo).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(h);else if(c.opListReadCapability)c.opListReadCapability.reject(h);else throw h}})};u()}_abortOperatorList({intentState:t,reason:s,force:a=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!a){if(t.renderTasks.size>0)return;if(s instanceof Jb){let i=$2;s.extraDelay>0&&s.extraDelay<1e3&&(i+=s.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:s,force:!0})},i);return}}if(t.streamReader.cancel(new fn(s.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[i,n]of this._intentStates)if(n===t){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}Rn=new WeakMap,Bi=new WeakMap,ma=new WeakSet,Lo=function(e=!1){if(_(this,ma,Jf).call(this),!o(this,Bi)||this.destroyed)return!1;if(e)return m(this,Rn,setTimeout(()=>{m(this,Rn,null),_(this,ma,Lo).call(this,!1)},B2)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,Bi,!1),!0},Jf=function(){o(this,Rn)&&(clearTimeout(o(this,Rn)),m(this,Rn,null))};var xi,bv;class Z2{constructor(){k(this,xi,new Map),k(this,bv,Promise.resolve())}postMessage(t,s){const a={data:structuredClone(t,s?{transfer:s}:null)};o(this,bv).then(()=>{for(const[i]of o(this,xi))i.call(this,a)})}addEventListener(t,s,a=null){let i=null;if((a==null?void 0:a.signal)instanceof AbortSignal){const{signal:n}=a;if(n.aborted){Z("LoopbackPort - cannot use an `aborted` signal.");return}const r=()=>this.removeEventListener(t,s);i=()=>n.removeEventListener("abort",r),n.addEventListener("abort",r)}o(this,xi).set(s,i)}removeEventListener(t,s){const a=o(this,xi).get(s);a==null||a(),o(this,xi).delete(s)}terminate(){for(const[,t]of o(this,xi))t==null||t();o(this,xi).clear()}}xi=new WeakMap,bv=new WeakMap;var yv,Zo,Jn,fc,vd,iu,bd;const ki=class Le{constructor({name:t=null,port:s=null,verbosity:a=MM()}={}){k(this,fc);var i;if(this.name=t,this.destroyed=!1,this.verbosity=a,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,s){if((i=o(Le,Jn))!=null&&i.has(s))throw new Error("Cannot use more than one PDFWorker per port.");(o(Le,Jn)||m(Le,Jn,new WeakMap)).set(s,this),this._initializeFromPort(s);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new ac("main","worker",t),this._messageHandler.on("ready",function(){}),_(this,fc,vd).call(this)}_initialize(){if(o(Le,Zo)||o(Le,iu,bd)){this._setupFakeWorker();return}let{workerSrc:t}=Le;try{Le._isSameOrigin(window.location.href,t)||(t=Le._createCDNWrapper(new URL(t,window.location).href));const s=new Worker(t,{type:"module"}),a=new ac("main","worker",s),i=()=>{n.abort(),a.destroy(),s.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},n=new AbortController;s.addEventListener("error",()=>{this._webWorker||i()},{signal:n.signal}),a.on("test",l=>{if(n.abort(),this.destroyed||!l){i();return}this._messageHandler=a,this._port=s,this._webWorker=s,_(this,fc,vd).call(this)}),a.on("ready",l=>{if(n.abort(),this.destroyed){i();return}try{r()}catch{this._setupFakeWorker()}});const r=()=>{const l=new Uint8Array;a.send("test",l,[l.buffer])};r();return}catch{zp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){o(Le,Zo)||(Z("Setting up fake worker."),m(Le,Zo,!0)),Le._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const s=new Z2;this._port=s;const a=`fake${Je(Le,yv)._++}`,i=new ac(a+"_worker",a,s);t.setup(i,s),this._messageHandler=new ac(a,a+"_worker",s),_(this,fc,vd).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,s,a;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(s=o(Le,Jn))==null||s.delete(this._port),this._port=null,(a=this._messageHandler)==null||a.destroy(),this._messageHandler=null}static fromPort(t){var s;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const a=(s=o(this,Jn))==null?void 0:s.get(t.port);if(a){if(a._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return a}return new Le(t)}static get workerSrc(){if(pn.workerSrc)return pn.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return tt(this,"_setupFakeWorkerGlobal",(async()=>o(this,iu,bd)?o(this,iu,bd):(await import(this.workerSrc)).WorkerMessageHandler)())}};yv=new WeakMap,Zo=new WeakMap,Jn=new WeakMap,fc=new WeakSet,vd=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},iu=new WeakSet,bd=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},k(ki,iu),k(ki,yv,0),k(ki,Zo,!1),k(ki,Jn),Ne&&(m(ki,Zo,!0),pn.workerSrc||(pn.workerSrc="./pdf.worker.mjs")),ki._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const a=new URL(t,s);return s.origin===a.origin},ki._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let yd=ki;var Ui,Da,pc,gc,_i,Zr,mc;class tN{constructor(t,s,a,i,n){k(this,Zr),k(this,Ui,new Map),k(this,Da,new Map),k(this,pc,new Map),k(this,gc,new Map),k(this,_i,null),this.messageHandler=t,this.loadingTask=s,this.commonObjs=new e_,this.fontLoader=new KM({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=n.canvasFactory,this.filterFactory=n.filterFactory,this.cMapReaderFactory=n.cMapReaderFactory,this.standardFontDataFactory=n.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=a,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return tt(this,"annotationStorage",new ay)}getRenderingIntent(t,s=Wi.ENABLE,a=null,i=!1,n=!1){let r=ns.DISPLAY,l=rv;switch(t){case"any":r=ns.ANY;break;case"display":break;case"print":r=ns.PRINT;break;default:Z(`getRenderingIntent - invalid intent: ${t}`)}const c=r&ns.PRINT&&a instanceof Tk?a:this.annotationStorage;switch(s){case Wi.DISABLE:r+=ns.ANNOTATIONS_DISABLE;break;case Wi.ENABLE:break;case Wi.ENABLE_FORMS:r+=ns.ANNOTATIONS_FORMS;break;case Wi.ENABLE_STORAGE:r+=ns.ANNOTATIONS_STORAGE,l=c.serializable;break;default:Z(`getRenderingIntent - invalid annotationMode: ${s}`)}i&&(r+=ns.IS_EDITING),n&&(r+=ns.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[r,l.hash,h];return{renderingIntent:r,cacheKey:d.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){var t;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(t=o(this,_i))==null||t.reject(new Error("Worker was destroyed during onPassword callback"));const s=[];for(const i of o(this,Da).values())s.push(i._destroy());o(this,Da).clear(),o(this,pc).clear(),o(this,gc).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const a=this.messageHandler.sendWithPromise("Terminate",null);return s.push(a),Promise.all(s).then(()=>{var i,n;this.commonObjs.clear(),this.fontLoader.clear(),o(this,Ui).clear(),this.filterFactory.destroy(),mv.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new fn("Worker was terminated.")),(n=this.messageHandler)==null||n.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:s}=this;t.on("GetReader",(a,i)=>{Vt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=n=>{this._lastProgress={loaded:n.loaded,total:n.total}},i.onPull=()=>{this._fullReader.read().then(function({value:n,done:r}){if(r){i.close();return}Vt(n instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(n),1,[n])}).catch(n=>{i.error(n)})},i.onCancel=n=>{this._fullReader.cancel(n),i.ready.catch(r=>{if(!this.destroyed)throw r})}}),t.on("ReaderHeadersReady",async a=>{var i;await this._fullReader.headersReady;const{isStreamingSupported:n,isRangeSupported:r,contentLength:l}=this._fullReader;return(!n||!r)&&(this._lastProgress&&((i=s.onProgress)==null||i.call(s,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=s.onProgress)==null||u.call(s,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:n,isRangeSupported:r,contentLength:l}}),t.on("GetRangeReader",(a,i)=>{Vt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(a.begin,a.end);if(!n){i.close();return}i.onPull=()=>{n.read().then(function({value:r,done:l}){if(l){i.close();return}Vt(r instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{n.cancel(r),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("GetDoc",({pdfInfo:a})=>{this._numPages=a.numPages,this._htmlForXfa=a.htmlForXfa,delete a.htmlForXfa,s._capability.resolve(new Q2(a,this))}),t.on("DocException",a=>{s._capability.reject(qe(a))}),t.on("PasswordRequest",a=>{m(this,_i,Promise.withResolvers());try{if(!s.onPassword)throw qe(a);const i=n=>{n instanceof Error?o(this,_i).reject(n):o(this,_i).resolve({password:n})};s.onPassword(i,a.code)}catch(i){o(this,_i).reject(i)}return o(this,_i).promise}),t.on("DataLoaded",a=>{var i;(i=s.onProgress)==null||i.call(s,{loaded:a.length,total:a.length}),this.downloadInfoCapability.resolve(a)}),t.on("StartRenderPage",a=>{this.destroyed||o(this,Da).get(a.pageIndex)._startRenderPage(a.transparency,a.cacheKey)}),t.on("commonobj",([a,i,n])=>{var r;if(this.destroyed||this.commonObjs.has(a))return null;switch(i){case"Font":const{disableFontFace:l,fontExtraProperties:c,pdfBug:u}=this._params;if("error"in n){const g=n.error;Z(`Error during font loading: ${g}`),this.commonObjs.resolve(a,g);break}const h=u&&(r=globalThis.FontInspector)!=null&&r.enabled?(g,v)=>globalThis.FontInspector.fontAdded(g,v):null,d=new QM(n,{disableFontFace:l,fontExtraProperties:c,inspectFont:h});this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:a})).finally(()=>{!c&&d.data&&(d.data=null),this.commonObjs.resolve(a,d)});break;case"CopyLocalImage":const{imageRef:f}=n;Vt(f,"The imageRef must be defined.");for(const g of o(this,Da).values())for(const[,v]of g.objs)if((v==null?void 0:v.ref)===f)return v.dataLen?(this.commonObjs.resolve(a,structuredClone(v)),v.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(a,n);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),t.on("obj",([a,i,n,r])=>{var l;if(this.destroyed)return;const c=o(this,Da).get(i);if(!c.objs.has(a)){if(c._intentStates.size===0){(l=r==null?void 0:r.bitmap)==null||l.close();return}switch(n){case"Image":c.objs.resolve(a,r),(r==null?void 0:r.dataLen)>_M&&(c._maybeCleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(a,r);break;default:throw new Error(`Got unknown object type ${n}`)}}}),t.on("DocProgress",a=>{var i;this.destroyed||(i=s.onProgress)==null||i.call(s,{loaded:a.loaded,total:a.total})}),t.on("FetchBuiltInCMap",async a=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(a)}),t.on("FetchStandardFontData",async a=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(a)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var t;this.annotationStorage.size<=0&&Z("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:s,transfer:a}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:s,filename:((t=this._fullReader)==null?void 0:t.filename)??null},a).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const s=t-1,a=o(this,pc).get(s);if(a)return a;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:s}).then(n=>{if(this.destroyed)throw new Error("Transport destroyed");n.refStr&&o(this,gc).set(n.refStr,t);const r=new J2(s,n,this,this._params.pdfBug);return o(this,Da).set(s,r),r});return o(this,pc).set(s,i),i}getPageIndex(t){return s0(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,s){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:s})}getFieldObjects(){return _(this,Zr,mc).call(this,"GetFieldObjects")}hasJSActions(){return _(this,Zr,mc).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return _(this,Zr,mc).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return _(this,Zr,mc).call(this,"GetOptionalContentConfig").then(s=>new x2(s,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",s=o(this,Ui).get(t);if(s)return s;const a=this.messageHandler.sendWithPromise(t,null).then(i=>{var n,r;return{info:i[0],metadata:i[1]?new y2(i[1]):null,contentDispositionFilename:((n=this._fullReader)==null?void 0:n.filename)??null,contentLength:((r=this._fullReader)==null?void 0:r.contentLength)??null}});return o(this,Ui).set(t,a),a}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const s of o(this,Da).values())if(!s.cleanup())throw new Error(`startCleanup: Page ${s.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),o(this,Ui).clear(),this.filterFactory.destroy(!0),mv.cleanup()}}cachedPageNumber(t){if(!s0(t))return null;const s=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return o(this,gc).get(s)??null}}Ui=new WeakMap,Da=new WeakMap,pc=new WeakMap,gc=new WeakMap,_i=new WeakMap,Zr=new WeakSet,mc=function(e,t=null){const s=o(this,Ui).get(e);if(s)return s;const a=this.messageHandler.sendWithPromise(e,t);return o(this,Ui).set(e,a),a};const vc=Symbol("INITIAL_DATA");var xs,wd,wv;class e_{constructor(){k(this,wd),k(this,xs,Object.create(null))}get(t,s=null){if(s){const i=_(this,wd,wv).call(this,t);return i.promise.then(()=>s(i.data)),null}const a=o(this,xs)[t];if(!a||a.data===vc)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return a.data}has(t){const s=o(this,xs)[t];return!!s&&s.data!==vc}delete(t){const s=o(this,xs)[t];return!s||s.data===vc?!1:(delete o(this,xs)[t],!0)}resolve(t,s=null){const a=_(this,wd,wv).call(this,t);a.data=s,a.resolve()}clear(){var t;for(const s in o(this,xs)){const{data:a}=o(this,xs)[s];(t=a==null?void 0:a.bitmap)==null||t.close()}m(this,xs,Object.create(null))}*[Symbol.iterator](){for(const t in o(this,xs)){const{data:s}=o(this,xs)[t];s!==vc&&(yield[t,s])}}}xs=new WeakMap,wd=new WeakSet,wv=function(e){var t;return(t=o(this,xs))[e]||(t[e]={...Promise.withResolvers(),data:vc})};var In;class eN{constructor(t){k(this,In,null),m(this,In,t),this.onContinue=null}get promise(){return o(this,In).capability.promise}cancel(t=0){o(this,In).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=o(this,In).operatorList;if(!t)return!1;const{annotationCanvasMap:s}=o(this,In);return t.form||t.canvas&&(s==null?void 0:s.size)>0}}In=new WeakMap;var Dn,Ro;const s_=class bc{constructor({callback:t,params:s,objs:a,commonObjs:i,annotationCanvasMap:n,operatorList:r,pageIndex:l,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null}){k(this,Dn,null),this.callback=t,this.params=s,this.objs=a,this.commonObjs=i,this.annotationCanvasMap=n,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new eN(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=s.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:s}){var a,i;if(this.cancelled)return;if(this._canvas){if(o(bc,Ro).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");o(bc,Ro).add(this._canvas)}this._pdfBug&&(a=globalThis.StepperManager)!=null&&a.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:r,transform:l,background:c}=this.params;this.gfx=new cd(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:s},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:r,transparency:t,background:c}),this.operatorListIdx=0,this.graphicsReady=!0,(i=this.graphicsReadyCallback)==null||i.call(this)}cancel(t=null,s=0){var a;this.running=!1,this.cancelled=!0,(a=this.gfx)==null||a.endDrawing(),o(this,Dn)&&(window.cancelAnimationFrame(o(this,Dn)),m(this,Dn,null)),o(bc,Ro).delete(this._canvas),this.callback(t||new Jb(`Rendering cancelled, page ${this._pageIndex+1}`,s))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,Dn,window.requestAnimationFrame(()=>{m(this,Dn,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),o(bc,Ro).delete(this._canvas),this.callback())))}};Dn=new WeakMap,Ro=new WeakMap,k(s_,Ro,new WeakSet);let sN=s_;const aN="4.10.38",iN="f9bea397f";function a0(e){return Math.floor(Math.max(0,Math.min(1,e))*255).toString(16).padStart(2,"0")}function Tl(e){return Math.max(0,Math.min(255,255*e))}class i0{static CMYK_G([t,s,a,i]){return["G",1-Math.min(1,.3*t+.59*a+.11*s+i)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Tl(t),[t,t,t]}static G_HTML([t]){const s=a0(t);return`#${s}${s}${s}`}static RGB_G([t,s,a]){return["G",.3*t+.59*s+.11*a]}static RGB_rgb(t){return t.map(Tl)}static RGB_HTML(t){return`#${t.map(a0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,s,a,i]){return["RGB",1-Math.min(1,t+i),1-Math.min(1,a+i),1-Math.min(1,s+i)]}static CMYK_rgb([t,s,a,i]){return[Tl(1-Math.min(1,t+i)),Tl(1-Math.min(1,a+i)),Tl(1-Math.min(1,s+i))]}static CMYK_HTML(t){const s=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(s)}static RGB_CMYK([t,s,a]){const i=1-t,n=1-s,r=1-a,l=Math.min(i,n,r);return["CMYK",i,n,r,l]}}class nN{create(t,s,a=!1){if(t<=0||s<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),a||(i.setAttribute("width",`${t}px`),i.setAttribute("height",`${s}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${t} ${s}`),i}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){yt("Abstract method `_createSVG` called.")}}class ny extends nN{_createSVG(t){return document.createElementNS(Na,t)}}class a_{static setupStorage(t,s,a,i,n){const r=i.getValue(s,{value:null});switch(a.name){case"textarea":if(r.value!==null&&(t.textContent=r.value),n==="print")break;t.addEventListener("input",l=>{i.setValue(s,{value:l.target.value})});break;case"input":if(a.attributes.type==="radio"||a.attributes.type==="checkbox"){if(r.value===a.attributes.xfaOn?t.setAttribute("checked",!0):r.value===a.attributes.xfaOff&&t.removeAttribute("checked"),n==="print")break;t.addEventListener("change",l=>{i.setValue(s,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(r.value!==null&&t.setAttribute("value",r.value),n==="print")break;t.addEventListener("input",l=>{i.setValue(s,{value:l.target.value})})}break;case"select":if(r.value!==null){t.setAttribute("value",r.value);for(const l of a.children)l.attributes.value===r.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}t.addEventListener("input",l=>{const c=l.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(s,{value:u})});break}}static setAttributes({html:t,element:s,storage:a=null,intent:i,linkService:n}){const{attributes:r}=s,l=t instanceof HTMLAnchorElement;r.type==="radio"&&(r.name=`${r.name}-${i}`);for(const[c,u]of Object.entries(r))if(u!=null)switch(c){case"class":u.length&&t.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",u);break;case"style":Object.assign(t.style,u);break;case"textContent":t.textContent=u;break;default:(!l||c!=="href"&&c!=="newWindow")&&t.setAttribute(c,u)}l&&n.addLinkAttributes(t,r.href,r.newWindow),a&&r.dataId&&this.setupStorage(t,r.dataId,s,a)}static render(t){var s,a;const i=t.annotationStorage,n=t.linkService,r=t.xfaHtml,l=t.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:n});const u=l!=="richText",h=t.div;if(h.append(c),t.viewport){const g=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=g}u&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(r.children.length===0){if(r.value){const g=document.createTextNode(r.value);c.append(g),u&&Hu.shouldBuildText(r.name)&&d.push(g)}return{textDivs:d}}const f=[[r,-1,c]];for(;f.length>0;){const[g,v,y]=f.at(-1);if(v+1===g.children.length){f.pop();continue}const A=g.children[++f.at(-1)[1]];if(A===null)continue;const{name:b}=A;if(b==="#text"){const w=document.createTextNode(A.value);d.push(w),y.append(w);continue}const x=(s=A==null?void 0:A.attributes)!=null&&s.xmlns?document.createElementNS(A.attributes.xmlns,b):document.createElement(b);if(y.append(x),A.attributes&&this.setAttributes({html:x,element:A,storage:i,intent:l,linkService:n}),((a=A.children)==null?void 0:a.length)>0)f.push([A,-1,x]);else if(A.value){const w=document.createTextNode(A.value);u&&Hu.shouldBuildText(b)&&d.push(w),x.append(w)}}for(const g of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const s=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=s,t.div.hidden=!1}}const Zu=1e3,rN=9,wr=new WeakSet;function gn(e){return{width:e[2]-e[0],height:e[3]-e[1]}}class oN{static create(t){switch(t.data.annotationType){case Gt.LINK:return new o_(t);case Gt.TEXT:return new cN(t);case Gt.WIDGET:switch(t.data.fieldType){case"Tx":return new uN(t);case"Btn":return t.data.radioButton?new l_(t):t.data.checkBox?new dN(t):new fN(t);case"Ch":return new pN(t);case"Sig":return new hN(t)}return new Er(t);case Gt.POPUP:return new kv(t);case Gt.FREETEXT:return new h_(t);case Gt.LINE:return new mN(t);case Gt.SQUARE:return new vN(t);case Gt.CIRCLE:return new bN(t);case Gt.POLYLINE:return new d_(t);case Gt.CARET:return new wN(t);case Gt.INK:return new ry(t);case Gt.POLYGON:return new yN(t);case Gt.HIGHLIGHT:return new f_(t);case Gt.UNDERLINE:return new xN(t);case Gt.SQUIGGLY:return new kN(t);case Gt.STRIKEOUT:return new _N(t);case Gt.STAMP:return new p_(t);case Gt.FILEATTACHMENT:return new AN(t);default:return new Jt(t)}}}var jn,yc,wc,xd,xv;const lN=class i_{constructor(t,{isRenderable:s=!1,ignoreBorder:a=!1,createQuadrilaterals:i=!1}={}){k(this,xd),k(this,jn,null),k(this,yc,!1),k(this,wc,null),this.isRenderable=s,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,s&&(this.container=this._createContainer(a)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:s,richText:a}){return!!(t!=null&&t.str||s!=null&&s.str||a!=null&&a.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return i_._hasPopupData(this.data)}updateEdited(t){var s;if(!this.container)return;o(this,jn)||m(this,jn,{rect:this.data.rect.slice(0)});const{rect:a}=t;a&&_(this,xd,xv).call(this,a),(s=o(this,wc))==null||s.popup.updateEdited(t)}resetEdited(){var t;o(this,jn)&&(_(this,xd,xv).call(this,o(this,jn).rect),(t=o(this,wc))==null||t.popup.resetEdited(),m(this,jn,null))}_createContainer(t){const{data:s,parent:{page:a,viewport:i}}=this,n=document.createElement("section");n.setAttribute("data-annotation-id",s.id),this instanceof Er||(n.tabIndex=Zu);const{style:r}=n;if(r.zIndex=this.parent.zIndex++,s.alternativeText&&(n.title=s.alternativeText),s.noRotate&&n.classList.add("norotate"),!s.rect||this instanceof kv){const{rotation:y}=s;return!s.hasOwnCanvas&&y!==0&&this.setRotation(y,n),n}const{width:l,height:c}=gn(s.rect);if(!t&&s.borderStyle.width>0){r.borderWidth=`${s.borderStyle.width}px`;const y=s.borderStyle.horizontalCornerRadius,A=s.borderStyle.verticalCornerRadius;if(y>0||A>0){const x=`calc(${y}px * var(--scale-factor)) / calc(${A}px * var(--scale-factor))`;r.borderRadius=x}else if(this instanceof l_){const x=`calc(${l}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;r.borderRadius=x}switch(s.borderStyle.style){case Ml.SOLID:r.borderStyle="solid";break;case Ml.DASHED:r.borderStyle="dashed";break;case Ml.BEVELED:Z("Unimplemented border style: beveled");break;case Ml.INSET:Z("Unimplemented border style: inset");break;case Ml.UNDERLINE:r.borderBottomStyle="solid";break}const b=s.borderColor||null;b?(m(this,yc,!0),r.borderColor=$.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):r.borderWidth=0}const u=$.normalizeRect([s.rect[0],a.view[3]-s.rect[1]+a.view[1],s.rect[2],a.view[3]-s.rect[3]+a.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:g}=i.rawDims;r.left=`${100*(u[0]-f)/h}%`,r.top=`${100*(u[1]-g)/d}%`;const{rotation:v}=s;return s.hasOwnCanvas||v===0?(r.width=`${100*l/h}%`,r.height=`${100*c/d}%`):this.setRotation(v,n),n}setRotation(t,s=this.container){if(!this.data.rect)return;const{pageWidth:a,pageHeight:i}=this.parent.viewport.rawDims,{width:n,height:r}=gn(this.data.rect);let l,c;t%180===0?(l=100*n/a,c=100*r/i):(l=100*r/a,c=100*n/i),s.style.width=`${l}%`,s.style.height=`${c}%`,s.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(s,a,i)=>{const n=i.detail[s],r=n[0],l=n.slice(1);i.target.style[a]=i0[`${r}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[a]:i0[`${r}_rgb`](l)})};return tt(this,"_commonActions",{display:s=>{const{display:a}=s.detail,i=a%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:a===1||a===2})},print:s=>{this.annotationStorage.setValue(this.data.id,{noPrint:!s.detail.print})},hidden:s=>{const{hidden:a}=s.detail;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:a,noView:a})},focus:s=>{setTimeout(()=>s.target.focus({preventScroll:!1}),0)},userName:s=>{s.target.title=s.detail.userName},readonly:s=>{s.target.disabled=s.detail.readonly},required:s=>{this._setRequired(s.target,s.detail.required)},bgColor:s=>{t("bgColor","backgroundColor",s)},fillColor:s=>{t("fillColor","backgroundColor",s)},fgColor:s=>{t("fgColor","color",s)},textColor:s=>{t("textColor","color",s)},borderColor:s=>{t("borderColor","borderColor",s)},strokeColor:s=>{t("strokeColor","borderColor",s)},rotation:s=>{const a=s.detail.rotation;this.setRotation(a),this.annotationStorage.setValue(this.data.id,{rotation:a})}})}_dispatchEventFromSandbox(t,s){const a=this._commonActions;for(const i of Object.keys(s.detail)){const n=t[i]||a[i];n==null||n(s)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const s=this.annotationStorage.getRawValue(this.data.id);if(!s)return;const a=this._commonActions;for(const[i,n]of Object.entries(s)){const r=a[i];if(r){const l={detail:{[i]:n},target:t};r(l),delete s[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[s,a,i,n]=this.data.rect.map(y=>Math.fround(y));if(t.length===8){const[y,A,b,x]=t.subarray(2,6);if(i===y&&n===A&&s===b&&a===x)return}const{style:r}=this.container;let l;if(o(this,yc)){const{borderColor:y,borderWidth:A}=r;r.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const c=i-s,u=n-a,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=h.createElement("defs");d.append(f);const g=h.createElement("clipPath"),v=`clippath_${this.data.id}`;g.setAttribute("id",v),g.setAttribute("clipPathUnits","objectBoundingBox"),f.append(g);for(let y=2,A=t.length;y<A;y+=8){const b=t[y],x=t[y+1],w=t[y+2],S=t[y+3],E=h.createElement("rect"),M=(w-s)/c,N=(n-x)/u,P=(b-w)/c,T=(x-S)/u;E.setAttribute("x",M),E.setAttribute("y",N),E.setAttribute("width",P),E.setAttribute("height",T),g.append(E),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${M}" y="${N}" width="${P}" height="${T}"/>`)}o(this,yc)&&(l.push("</g></svg>')"),r.backgroundImage=l.join("")),this.container.append(d),this.container.style.clipPath=`url(#${v})`}_createPopup(){const{data:t}=this,s=m(this,wc,new kv({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(s.render())}render(){yt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,s=null){const a=[];if(this._fieldObjects){const i=this._fieldObjects[t];if(i)for(const{page:n,id:r,exportValues:l}of i){if(n===-1||r===s)continue;const c=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${r}"]`);if(u&&!wr.has(u)){Z(`_getElementsByName - element not allowed: ${r}`);continue}a.push({id:r,exportValue:c,domElement:u})}return a}for(const i of document.getElementsByName(t)){const{exportValue:n}=i,r=i.getAttribute("data-element-id");r!==s&&wr.has(i)&&a.push({id:r,exportValue:n,domElement:i})}return a}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const s of t)s.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:s}}=this;this.container.addEventListener("dblclick",()=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("switchannotationeditormode",{source:this,mode:t,editId:s})})}};jn=new WeakMap,yc=new WeakMap,wc=new WeakMap,xd=new WeakSet,xv=function(e){const{container:{style:t},data:{rect:s,rotation:a},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:n,pageX:r,pageY:l}}}}=this;s==null||s.splice(0,4,...e);const{width:c,height:u}=gn(e);t.left=`${100*(e[0]-r)/i}%`,t.top=`${100*(n-e[3]+l)/n}%`,a===0?(t.width=`${100*c/i}%`,t.height=`${100*u/n}%`):this.setRotation(a)};let Jt=lN;var va,or,n_,r_;class o_ extends Jt{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0}),k(this,va),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,a=document.createElement("a");a.setAttribute("data-element-id",t.id);let i=!1;return t.url?(s.addLinkAttributes(a,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(a,t.action),i=!0):t.attachment?(_(this,va,n_).call(this,a,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(_(this,va,r_).call(this,a,t.setOCGState),i=!0):t.dest?(this._bindLink(a,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(a,t),i=!0),t.resetForm?(this._bindResetFormAction(a,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(a,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(a),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&_(this,va,or).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),_(this,va,or).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const a=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(s.actions)){const n=a.get(i);n&&(t[n]=()=>{var r;return(r=this.linkService.eventBus)==null||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:i}}),!1})}t.onclick||(t.onclick=()=>!1),_(this,va,or).call(this)}_bindResetFormAction(t,s){const a=t.onclick;if(a||(t.href=this.linkService.getAnchorUrl("")),_(this,va,or).call(this),!this._fieldObjects){Z('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),a||(t.onclick=()=>!1);return}t.onclick=()=>{var i;a==null||a();const{fields:n,refs:r,include:l}=s,c=[];if(n.length!==0||r.length!==0){const d=new Set(r);for(const f of n){const g=this._fieldObjects[f]||[];for(const{id:v}of g)d.add(v)}for(const f of Object.values(this._fieldObjects))for(const g of f)d.has(g.id)===l&&c.push(g)}else for(const d of Object.values(this._fieldObjects))c.push(...d);const u=this.annotationStorage,h=[];for(const d of c){const{id:f}=d;switch(h.push(f),d.type){case"text":{const v=d.defaultValue||"";u.setValue(f,{value:v});break}case"checkbox":case"radiobutton":{const v=d.defaultValue===d.exportValues;u.setValue(f,{value:v});break}case"combobox":case"listbox":{const v=d.defaultValue||"";u.setValue(f,{value:v});break}default:continue}const g=document.querySelector(`[data-element-id="${f}"]`);if(g){if(!wr.has(g)){Z(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((i=this.linkService.eventBus)==null||i.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}va=new WeakSet,or=function(){this.container.setAttribute("data-internal-link","")},n_=function(e,t,s=null){e.href=this.linkService.getAnchorUrl(""),t.description&&(e.title=t.description),e.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(t.content,t.filename,s),!1},_(this,va,or).call(this)},r_=function(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),_(this,va,or).call(this)};class cN extends Jt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Er extends Jt{render(){return this.container}showElementAndHideCanvas(t){var s;this.data.hasOwnCanvas&&(((s=t.previousSibling)==null?void 0:s.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return We.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,s,a,i,n){a.includes("mouse")?t.addEventListener(a,r=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:n(r),shift:r.shiftKey,modifier:this._getKeyModifier(r)}})}):t.addEventListener(a,r=>{var l;if(a==="blur"){if(!s.focused||!r.relatedTarget)return;s.focused=!1}else if(a==="focus"){if(s.focused)return;s.focused=!0}n&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:n(r)}}))})}_setEventListeners(t,s,a,i){var n,r,l;for(const[c,u]of a)(u==="Action"||(n=this.data.actions)!=null&&n[u])&&((u==="Focus"||u==="Blur")&&(s||(s={focused:!1})),this._setEventListener(t,s,c,u,i),u==="Focus"&&!((r=this.data.actions)!=null&&r.Blur)?this._setEventListener(t,s,"blur","Blur",null):u==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(t,s,"focus","Focus",null))}_setBackgroundColor(t){const s=this.data.backgroundColor||null;t.style.backgroundColor=s===null?"transparent":$.makeHexColor(s[0],s[1],s[2])}_setTextStyle(t){const s=["left","center","right"],{fontColor:a}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||rN,n=t.style;let r;const l=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),h=Math.round(u/(xg*i))||1,d=u/h;r=Math.min(i,c(d/xg))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);r=Math.min(i,c(u/xg))}n.fontSize=`calc(${r}px * var(--scale-factor))`,n.color=$.makeHexColor(a[0],a[1],a[2]),this.data.textAlignment!==null&&(n.textAlign=s[this.data.textAlignment])}_setRequired(t,s){s?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",s)}}class uN extends Er{constructor(t){const s=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:s})}setPropertyOnSiblings(t,s,a,i){const n=this.annotationStorage;for(const r of this._getElementsByName(t.name,t.id))r.domElement&&(r.domElement[s]=a),n.setValue(r.id,{[i]:a})}render(){var t,s;const a=this.annotationStorage,i=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const r=a.getValue(i,{value:this.data.fieldValue});let l=r.value||"";const c=a.getValue(i,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=r.formattedValue||((t=this.data.textContent)==null?void 0:t.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=u??l,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",u??l),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),wr.add(n),n.setAttribute("data-element-id",i),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=Zu,this._setRequired(n,this.data.required),c&&(n.maxLength=c),n.addEventListener("input",f=>{a.setValue(i,{value:f.target.value}),this.setPropertyOnSiblings(n,"value",f.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue??"";n.value=h.userValue=g,h.formattedValue=null});let d=f=>{const{formattedValue:g}=h;g!=null&&(f.target.value=g),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",g=>{var v;if(h.focused)return;const{target:y}=g;h.userValue&&(y.value=h.userValue),h.lastCommittedValue=y.value,h.commitKey=1,(v=this.data.actions)!=null&&v.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const v={value(y){h.userValue=y.detail.value??"",a.setValue(i,{value:h.userValue.toString()}),y.target.value=h.userValue},formattedValue(y){const{formattedValue:A}=y.detail;h.formattedValue=A,A!=null&&y.target!==document.activeElement&&(y.target.value=A),a.setValue(i,{formattedValue:A})},selRange(y){y.target.setSelectionRange(...y.detail.selRange)},charLimit:y=>{var A;const{charLimit:b}=y.detail,{target:x}=y;if(b===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",b);let w=h.userValue;!w||w.length<=b||(w=w.slice(0,b),x.value=h.userValue=w,a.setValue(i,{value:w}),(A=this.linkService.eventBus)==null||A.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(v,g)}),n.addEventListener("keydown",g=>{var v;h.commitKey=1;let y=-1;if(g.key==="Escape"?y=0:g.key==="Enter"&&!this.data.multiLine?y=2:g.key==="Tab"&&(h.commitKey=3),y===-1)return;const{value:A}=g.target;h.lastCommittedValue!==A&&(h.lastCommittedValue=A,h.userValue=A,(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:A,willCommit:!0,commitKey:y,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const f=d;d=null,n.addEventListener("blur",g=>{var v,y;if(!h.focused||!g.relatedTarget)return;(v=this.data.actions)!=null&&v.Blur||(h.focused=!1);const{value:A}=g.target;h.userValue=A,h.lastCommittedValue!==A&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:A,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),f(g)}),(s=this.data.actions)!=null&&s.Keystroke&&n.addEventListener("beforeinput",g=>{var v;h.lastCommittedValue=null;const{data:y,target:A}=g,{value:b,selectionStart:x,selectionEnd:w}=A;let S=x,E=w;switch(g.inputType){case"deleteWordBackward":{const M=b.substring(0,x).match(/\w*[^\w]*$/);M&&(S-=M[0].length);break}case"deleteWordForward":{const M=b.substring(x).match(/^[^\w]*\w*/);M&&(E+=M[0].length);break}case"deleteContentBackward":x===w&&(S-=1);break;case"deleteContentForward":x===w&&(E+=1);break}g.preventDefault(),(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:b,change:y||"",willCommit:!1,selStart:S,selEnd:E}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(d&&n.addEventListener("blur",d),this.data.comb){const f=(this.data.rect[2]-this.data.rect[0])/c;n.classList.add("comb"),n.style.letterSpacing=`calc(${f}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class hN extends Er{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class dN extends Er{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,s=this.data,a=s.id;let i=t.getValue(a,{value:s.exportValue===s.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",t.setValue(a,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const n=document.createElement("input");return wr.add(n),n.setAttribute("data-element-id",a),n.disabled=s.readOnly,this._setRequired(n,this.data.required),n.type="checkbox",n.name=s.fieldName,i&&n.setAttribute("checked",!0),n.setAttribute("exportValue",s.exportValue),n.tabIndex=Zu,n.addEventListener("change",r=>{const{name:l,checked:c}=r.target;for(const u of this._getElementsByName(l,a)){const h=c&&u.exportValue===s.exportValue;u.domElement&&(u.domElement.checked=h),t.setValue(u.id,{value:h})}t.setValue(a,{value:c})}),n.addEventListener("resetform",r=>{const l=s.defaultFieldValue||"Off";r.target.checked=l===s.exportValue}),this.enableScripting&&this.hasJSActions&&(n.addEventListener("updatefromsandbox",r=>{const l={value(c){c.target.checked=c.detail.value!=="Off",t.setValue(a,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,r)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],r=>r.target.checked)),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class l_ extends Er{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,s=this.data,a=s.id;let i=t.getValue(a,{value:s.fieldValue===s.buttonValue}).value;if(typeof i=="string"&&(i=i!==s.buttonValue,t.setValue(a,{value:i})),i)for(const r of this._getElementsByName(s.fieldName,a))t.setValue(r.id,{value:!1});const n=document.createElement("input");if(wr.add(n),n.setAttribute("data-element-id",a),n.disabled=s.readOnly,this._setRequired(n,this.data.required),n.type="radio",n.name=s.fieldName,i&&n.setAttribute("checked",!0),n.tabIndex=Zu,n.addEventListener("change",r=>{const{name:l,checked:c}=r.target;for(const u of this._getElementsByName(l,a))t.setValue(u.id,{value:!1});t.setValue(a,{value:c})}),n.addEventListener("resetform",r=>{const l=s.defaultFieldValue;r.target.checked=l!=null&&l===s.buttonValue}),this.enableScripting&&this.hasJSActions){const r=s.buttonValue;n.addEventListener("updatefromsandbox",l=>{const c={value:u=>{const h=r===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===a;d.domElement&&(d.domElement.checked=f),t.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(n,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class fN extends o_{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const s=t.lastChild;return this.enableScripting&&this.hasJSActions&&s&&(this._setDefaultPropertiesFromJS(s),s.addEventListener("updatefromsandbox",a=>{this._dispatchEventFromSandbox({},a)})),t}}class pN extends Er{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,s=this.data.id,a=t.getValue(s,{value:this.data.fieldValue}),i=document.createElement("select");wr.add(i),i.setAttribute("data-element-id",s),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=Zu;let n=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,a.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),n=!1),i.append(d)}let r=null;if(n){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),i.prepend(h),r=()=>{h.remove(),i.removeEventListener("input",r),r=null},i.addEventListener("input",r)}const l=h=>{const d=h?"value":"textContent",{options:f,multiple:g}=i;return g?Array.prototype.filter.call(f,v=>v.selected).map(v=>v[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=l(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",h=>{const d={value(f){r==null||r();const g=f.detail.value,v=new Set(Array.isArray(g)?g:[g]);for(const y of i.options)y.selected=v.has(y.value);t.setValue(s,{value:l(!0)}),c=l(!1)},multipleSelection(f){i.multiple=!0},remove(f){const g=i.options,v=f.detail.remove;g[v].selected=!1,i.remove(v),g.length>0&&Array.prototype.findIndex.call(g,y=>y.selected)===-1&&(g[0].selected=!0),t.setValue(s,{value:l(!0),items:u(f)}),c=l(!1)},clear(f){for(;i.length!==0;)i.remove(0);t.setValue(s,{value:null,items:[]}),c=l(!1)},insert(f){const{index:g,displayValue:v,exportValue:y}=f.detail.insert,A=i.children[g],b=document.createElement("option");b.textContent=v,b.value=y,A?A.before(b):i.append(b),t.setValue(s,{value:l(!0),items:u(f)}),c=l(!1)},items(f){const{items:g}=f.detail;for(;i.length!==0;)i.remove(0);for(const v of g){const{displayValue:y,exportValue:A}=v,b=document.createElement("option");b.textContent=y,b.value=A,i.append(b)}i.options.length>0&&(i.options[0].selected=!0),t.setValue(s,{value:l(!0),items:u(f)}),c=l(!1)},indices(f){const g=new Set(f.detail.indices);for(const v of f.target.options)v.selected=g.has(v.index);t.setValue(s,{value:l(!0)}),c=l(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),i.addEventListener("input",h=>{var d;const f=l(!0),g=l(!1);t.setValue(s,{value:f}),h.preventDefault(),(d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s,name:"Keystroke",value:c,change:g,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):i.addEventListener("input",function(h){t.setValue(s,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class kv extends Jt{constructor(t){const{data:s,elements:a}=t;super(t,{isRenderable:Jt._hasPopupData(s)}),this.elements=a,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new gN({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),s=[];for(const a of this.elements)a.popup=t,a.container.ariaHasPopup="dialog",s.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(a=>`${Qb}${a}`).join(",")),this.container}}var nu,_v,Av,ru,to,Ot,Li,xc,Zf,tp,ou,Ai,ua,Hi,ep,Vi,kd,Fn,eo,Yt,_d,Tg,n0,c_,u_,r0,sp,ap,Sv;class gN{constructor({container:t,color:s,elements:a,titleObj:i,modificationDate:n,contentsObj:r,richText:l,parent:c,rect:u,parentRect:h,open:d}){k(this,Yt),k(this,nu,_(this,Yt,u_).bind(this)),k(this,_v,_(this,Yt,Sv).bind(this)),k(this,Av,_(this,Yt,ap).bind(this)),k(this,ru,_(this,Yt,sp).bind(this)),k(this,to,null),k(this,Ot,null),k(this,Li,null),k(this,xc,null),k(this,Zf,null),k(this,tp,null),k(this,ou,null),k(this,Ai,!1),k(this,ua,null),k(this,Hi,null),k(this,ep,null),k(this,Vi,null),k(this,kd,null),k(this,Fn,null),k(this,eo,!1);var f;m(this,Ot,t),m(this,kd,i),m(this,Li,r),m(this,Vi,l),m(this,tp,c),m(this,to,s),m(this,ep,u),m(this,ou,h),m(this,Zf,a),m(this,xc,ty.toDateObject(n)),this.trigger=a.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",o(this,ru)),g.addEventListener("mouseenter",o(this,Av)),g.addEventListener("mouseleave",o(this,_v)),g.classList.add("popupTriggerArea");for(const g of a)(f=g.container)==null||f.addEventListener("keydown",o(this,nu));o(this,Ot).hidden=!0,d&&_(this,Yt,sp).call(this)}render(){if(o(this,ua))return;const t=m(this,ua,document.createElement("div"));if(t.className="popup",o(this,to)){const n=t.style.outlineColor=$.makeHexColor(...o(this,to));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`:t.style.backgroundColor=$.makeHexColor(...o(this,to).map(r=>Math.floor(.7*(255-r)+r)))}const s=document.createElement("span");s.className="header";const a=document.createElement("h1");if(s.append(a),{dir:a.dir,str:a.textContent}=o(this,kd),t.append(s),o(this,xc)){const n=document.createElement("span");n.classList.add("popupDate"),n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:o(this,xc).valueOf()})),s.append(n)}const i=o(this,Yt,_d);if(i)a_.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const n=this._formatContents(o(this,Li));t.append(n)}o(this,Ot).append(t)}_formatContents({str:t,dir:s}){const a=document.createElement("p");a.classList.add("popupContent"),a.dir=s;const i=t.split(/(?:\r\n?|\n)/);for(let n=0,r=i.length;n<r;++n){const l=i[n];a.append(document.createTextNode(l)),n<r-1&&a.append(document.createElement("br"))}return a}updateEdited({rect:t,popupContent:s}){var a;o(this,Fn)||m(this,Fn,{contentsObj:o(this,Li),richText:o(this,Vi)}),t&&m(this,Hi,null),s&&(m(this,Vi,_(this,Yt,c_).call(this,s)),m(this,Li,null)),(a=o(this,ua))==null||a.remove(),m(this,ua,null)}resetEdited(){var t;o(this,Fn)&&({contentsObj:Je(this,Li)._,richText:Je(this,Vi)._}=o(this,Fn),m(this,Fn,null),(t=o(this,ua))==null||t.remove(),m(this,ua,null),m(this,Hi,null))}forceHide(){m(this,eo,this.isVisible),o(this,eo)&&(o(this,Ot).hidden=!0)}maybeShow(){o(this,eo)&&(o(this,ua)||_(this,Yt,ap).call(this),m(this,eo,!1),o(this,Ot).hidden=!1)}get isVisible(){return o(this,Ot).hidden===!1}}nu=new WeakMap,_v=new WeakMap,Av=new WeakMap,ru=new WeakMap,to=new WeakMap,Ot=new WeakMap,Li=new WeakMap,xc=new WeakMap,Zf=new WeakMap,tp=new WeakMap,ou=new WeakMap,Ai=new WeakMap,ua=new WeakMap,Hi=new WeakMap,ep=new WeakMap,Vi=new WeakMap,kd=new WeakMap,Fn=new WeakMap,eo=new WeakMap,Yt=new WeakSet,_d=function(){const e=o(this,Vi),t=o(this,Li);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&o(this,Vi).html||null},Tg=function(){var e,t,s;return((s=(t=(e=o(this,Yt,_d))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},n0=function(){var e,t,s;return((s=(t=(e=o(this,Yt,_d))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},c_=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},a={style:{color:o(this,Yt,n0),fontSize:o(this,Yt,Tg)?`calc(${o(this,Yt,Tg)}px * var(--scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:a});return s},u_=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&o(this,Ai))&&_(this,Yt,sp).call(this)},r0=function(){if(o(this,Hi)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:a,pageY:i}}}=o(this,tp);let n=!!o(this,ou),r=n?o(this,ou):o(this,ep);for(const f of o(this,Zf))if(!r||$.intersect(f.data.rect,r)!==null){r=f.data.rect,n=!0;break}const l=$.normalizeRect([r[0],e[3]-r[1]+e[1],r[2],e[3]-r[3]+e[1]]),c=n?r[2]-r[0]+5:0,u=l[0]+c,h=l[1];m(this,Hi,[100*(u-a)/t,100*(h-i)/s]);const{style:d}=o(this,Ot);d.left=`${o(this,Hi)[0]}%`,d.top=`${o(this,Hi)[1]}%`},sp=function(){m(this,Ai,!o(this,Ai)),o(this,Ai)?(_(this,Yt,ap).call(this),o(this,Ot).addEventListener("click",o(this,ru)),o(this,Ot).addEventListener("keydown",o(this,nu))):(_(this,Yt,Sv).call(this),o(this,Ot).removeEventListener("click",o(this,ru)),o(this,Ot).removeEventListener("keydown",o(this,nu)))},ap=function(){o(this,ua)||this.render(),this.isVisible?o(this,Ai)&&o(this,Ot).classList.add("focused"):(_(this,Yt,r0).call(this),o(this,Ot).hidden=!1,o(this,Ot).style.zIndex=parseInt(o(this,Ot).style.zIndex)+1e3)},Sv=function(){o(this,Ot).classList.remove("focused"),!(o(this,Ai)||!this.isVisible)&&(o(this,Ot).hidden=!0,o(this,Ot).style.zIndex=parseInt(o(this,Ot).style.zIndex)-1e3)};class h_ extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=J.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const s of this.textContent){const a=document.createElement("span");a.textContent=s,t.append(a)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Ad;class mN extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),k(this,Ad,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:a}=gn(t.rect),i=this.svgFactory.create(s,a,!0),n=m(this,Ad,this.svgFactory.createElement("svg:line"));return n.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),n.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),n.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),n.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),n.setAttribute("stroke-width",t.borderStyle.width||1),n.setAttribute("stroke","transparent"),n.setAttribute("fill","transparent"),i.append(n),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,Ad)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ad=new WeakMap;var Sd;class vN extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),k(this,Sd,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:a}=gn(t.rect),i=this.svgFactory.create(s,a,!0),n=t.borderStyle.width,r=m(this,Sd,this.svgFactory.createElement("svg:rect"));return r.setAttribute("x",n/2),r.setAttribute("y",n/2),r.setAttribute("width",s-n),r.setAttribute("height",a-n),r.setAttribute("stroke-width",n||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,Sd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sd=new WeakMap;var Ed;class bN extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),k(this,Ed,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:a}=gn(t.rect),i=this.svgFactory.create(s,a,!0),n=t.borderStyle.width,r=m(this,Ed,this.svgFactory.createElement("svg:ellipse"));return r.setAttribute("cx",s/2),r.setAttribute("cy",a/2),r.setAttribute("rx",s/2-n/2),r.setAttribute("ry",a/2-n/2),r.setAttribute("stroke-width",n||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,Ed)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ed=new WeakMap;var Cd;class d_ extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),k(this,Cd,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:a,popupRef:i}}=this;if(!s)return this.container;const{width:n,height:r}=gn(t),l=this.svgFactory.create(n,r,!0);let c=[];for(let h=0,d=s.length;h<d;h+=2){const f=s[h]-t[0],g=t[3]-s[h+1];c.push(`${f},${g}`)}c=c.join(" ");const u=m(this,Cd,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",a.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,Cd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Cd=new WeakMap;class yN extends d_{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class wN extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Md,so,Nd,Ev;class ry extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),k(this,Nd),k(this,Md,null),k(this,so,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?J.HIGHLIGHT:J.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:a,borderStyle:i,popupRef:n}}=this,{transform:r,width:l,height:c}=_(this,Nd,Ev).call(this,s,t),u=this.svgFactory.create(l,c,!0),h=m(this,Md,this.svgFactory.createElement("svg:g"));u.append(h),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",r);for(let d=0,f=a.length;d<f;d++){const g=this.svgFactory.createElement(this.svgElementName);o(this,so).push(g),g.setAttribute("points",a[d].join(",")),h.append(g)}return!n&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:a,rect:i}=t,n=o(this,Md);if(s>=0&&n.setAttribute("stroke-width",s||1),a)for(let r=0,l=o(this,so).length;r<l;r++)o(this,so)[r].setAttribute("points",a[r].join(","));if(i){const{transform:r,width:l,height:c}=_(this,Nd,Ev).call(this,this.data.rotation,i);n.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),n.setAttribute("transform",r)}}getElementsToTriggerPopup(){return o(this,so)}addHighlightArea(){this.container.classList.add("highlightArea")}}Md=new WeakMap,so=new WeakMap,Nd=new WeakSet,Ev=function(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}};class f_ extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=J.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class xN extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class kN extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class _N extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class p_ extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=J.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Pd,Td,Cv;class AN extends Jt{constructor(t){var s;super(t,{isRenderable:!0}),k(this,Td),k(this,Pd,null);const{file:a}=this.data;this.filename=a.filename,this.content=a.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...a})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let a;s.hasAppearance||s.fillAlpha===0?a=document.createElement("div"):(a=document.createElement("img"),a.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(a.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),a.addEventListener("dblclick",_(this,Td,Cv).bind(this)),m(this,Pd,a);const{isMac:i}=We.platform;return t.addEventListener("keydown",n=>{n.key==="Enter"&&(i?n.metaKey:n.ctrlKey)&&_(this,Td,Cv).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():a.classList.add("popupTriggerArea"),t.append(a),t}getElementsToTriggerPopup(){return o(this,Pd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Pd=new WeakMap,Td=new WeakSet,Cv=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var ip,Io,ao,np,kc,g_,Mv;class SN{constructor({div:t,accessibilityManager:s,annotationCanvasMap:a,annotationEditorUIManager:i,page:n,viewport:r,structTreeLayer:l}){k(this,kc),k(this,ip,null),k(this,Io,null),k(this,ao,new Map),k(this,np,null),this.div=t,m(this,ip,s),m(this,Io,a),m(this,np,l||null),this.page=n,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return o(this,ao).size>0}async render(t){var s;const{annotations:a}=t,i=this.div;yr(i,this.viewport);const n=new Map,r={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ny,annotationStorage:t.annotationStorage||new ay,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of a){if(l.noHTML)continue;const c=l.annotationType===Gt.POPUP;if(c){const d=n.get(l.id);if(!d)continue;r.elements=d}else{const{width:d,height:f}=gn(l.rect);if(d<=0||f<=0)continue}r.data=l;const u=oN.create(r);if(!u.isRenderable)continue;if(!c&&l.popupRef){const d=n.get(l.popupRef);d?d.push(u):n.set(l.popupRef,[u])}const h=u.render();l.hidden&&(h.style.visibility="hidden"),await _(this,kc,g_).call(this,h,l.id),u._isEditable&&(o(this,ao).set(u.data.id,u),(s=this._annotationEditorUIManager)==null||s.renderAnnotationElement(u))}_(this,kc,Mv).call(this)}update({viewport:t}){const s=this.div;this.viewport=t,yr(s,{rotation:t.rotation}),_(this,kc,Mv).call(this),s.hidden=!1}getEditableAnnotations(){return Array.from(o(this,ao).values())}getEditableAnnotation(t){return o(this,ao).get(t)}}ip=new WeakMap,Io=new WeakMap,ao=new WeakMap,np=new WeakMap,kc=new WeakSet,g_=async function(e,t){var s,a;const i=e.firstChild||e,n=i.id=`${Qb}${t}`,r=await((s=o(this,np))==null?void 0:s.getAriaAttributes(n));if(r)for(const[l,c]of r)i.setAttribute(l,c);this.div.append(e),(a=o(this,ip))==null||a.moveElementInDOM(this.div,e,i,!1)},Mv=function(){if(!o(this,Io))return;const e=this.div;for(const[t,s]of o(this,Io)){const a=e.querySelector(`[data-annotation-id="${t}"]`);if(!a)continue;s.className="annotationContent";const{firstChild:i}=a;i?i.nodeName==="CANVAS"?i.replaceWith(s):i.classList.contains("annotationContent")?i.after(s):i.before(s):a.append(s)}o(this,Io).clear()};const Ld=/\r\n?|\n/g;var ba,Es,Rd,io,Cs,as,m_,v_,b_,rp,lr,op,Id,y_,Nv,w_;const ja=class re extends zt{constructor(t){super({...t,name:"freeTextEditor"}),k(this,as),k(this,ba),k(this,Es,""),k(this,Rd,`${this.id}-editor`),k(this,io,null),k(this,Cs),m(this,ba,t.color||re._defaultColor||zt._defaultLineColor),m(this,Cs,t.fontSize||re._defaultFontSize)}static get _keyboardManager(){const t=re.prototype,s=n=>n.isEmpty(),a=Uu.TRANSLATE_SMALL,i=Uu.TRANSLATE_BIG;return tt(this,"_keyboardManager",new Ju([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[a,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,a],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}]]))}static initialize(t,s){zt.initialize(t,s);const a=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(a.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case it.FREETEXT_SIZE:re._defaultFontSize=s;break;case it.FREETEXT_COLOR:re._defaultColor=s;break}}updateParams(t,s){switch(t){case it.FREETEXT_SIZE:_(this,as,m_).call(this,s);break;case it.FREETEXT_COLOR:_(this,as,v_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[it.FREETEXT_SIZE,re._defaultFontSize],[it.FREETEXT_COLOR,re._defaultColor||zt._defaultLineColor]]}get propertiesToUpdate(){return[[it.FREETEXT_SIZE,o(this,Cs)],[it.FREETEXT_COLOR,o(this,ba)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-re._internalPadding*t,-(re._internalPadding+o(this,Cs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(J.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,io,new AbortController);const t=this._uiManager.combinedSignal(o(this,io));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",o(this,Rd)),this._isDraggable=!0,(t=o(this,io))==null||t.abort(),m(this,io,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=o(this,Es),s=m(this,Es,_(this,as,b_).call(this).trimEnd());if(t===s)return;const a=i=>{if(m(this,Es,i),!i){this.remove();return}_(this,as,Id).call(this),this._uiManager.rebuild(this),_(this,as,rp).call(this)};this.addCommands({cmd:()=>{a(s)},undo:()=>{a(t)},mustExec:!1}),_(this,as,rp).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){re._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",o(this,Rd)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:a}=this.editorDiv;if(a.fontSize=`calc(${o(this,Cs)}px * var(--scale-factor))`,a.color=o(this,ba),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Lf(this,this.div,["dblclick","keydown"]),this.width){const[i,n]=this.parentDimensions;if(this.annotationElementId){const{position:r}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,h]=this.pageDimensions,[d,f]=this.pageTranslation;let g,v;switch(this.rotation){case 0:g=t+(r[0]-d)/u,v=s+this.height-(r[1]-f)/h;break;case 90:g=t+(r[0]-d)/u,v=s-(r[1]-f)/h,[l,c]=[c,-l];break;case 180:g=t-this.width+(r[0]-d)/u,v=s-(r[1]-f)/h,[l,c]=[-l,-c];break;case 270:g=t+(r[0]-d-this.height*h)/u,v=s+(r[1]-f-this.width*u)/h,[l,c]=[-c,l];break}this.setAt(g*i,v*n,l,c)}else this.setAt(t*i,s*n,this.width*i,this.height*n);_(this,as,Id).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var s,a,i;const n=t.clipboardData||window.clipboardData,{types:r}=n;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const l=_(s=re,lr,Nv).call(s,n.getData("text")||"").replaceAll(Ld,`
`);if(!l)return;const c=window.getSelection();if(!c.rangeCount)return;this.editorDiv.normalize(),c.deleteFromDocument();const u=c.getRangeAt(0);if(!l.includes(`
`)){u.insertNode(document.createTextNode(l)),this.editorDiv.normalize(),c.collapseToStart();return}const{startContainer:h,startOffset:d}=u,f=[],g=[];if(h.nodeType===Node.TEXT_NODE){const A=h.parentElement;if(g.push(h.nodeValue.slice(d).replaceAll(Ld,"")),A!==this.editorDiv){let b=f;for(const x of this.editorDiv.childNodes){if(x===A){b=g;continue}b.push(_(a=re,lr,op).call(a,x))}}f.push(h.nodeValue.slice(0,d).replaceAll(Ld,""))}else if(h===this.editorDiv){let A=f,b=0;for(const x of this.editorDiv.childNodes)b++===d&&(A=g),A.push(_(i=re,lr,op).call(i,x))}m(this,Es,`${f.join(`
`)}${l}${g.join(`
`)}`),_(this,as,Id).call(this);const v=new Range;let y=f.reduce((A,b)=>A+b.length,0);for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const b=A.nodeValue.length;if(y<=b){v.setStart(A,y),v.setEnd(A,y);break}y-=b}c.removeAllRanges(),c.addRange(v)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,a){var i;let n=null;if(t instanceof h_){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:u,rotation:h,id:d,popupRef:f},textContent:g,textPosition:v,parent:{page:{pageNumber:y}}}=t;if(!g||g.length===0)return null;n=t={annotationType:J.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:v,pageIndex:y-1,rect:u.slice(0),rotation:h,id:d,deleted:!1,popupRef:f}}const r=await super.deserialize(t,s,a);return m(r,Cs,t.fontSize),m(r,ba,$.makeHexColor(...t.color)),m(r,Es,_(i=re,lr,Nv).call(i,t.value)),r.annotationElementId=t.id||null,r._initialData=n,r}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=re._internalPadding*this.parentScale,a=this.getRect(s,s),i=zt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:o(this,ba)),n={annotationType:J.FREETEXT,color:i,fontSize:o(this,Cs),value:_(this,as,y_).call(this),pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?n:this.annotationElementId&&!_(this,as,w_).call(this,n)?null:(n.id=this.annotationElementId,n)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:a}=s;a.fontSize=`calc(${o(this,Cs)}px * var(--scale-factor))`,a.color=o(this,ba),s.replaceChildren();for(const n of o(this,Es).split(`
`)){const r=document.createElement("div");r.append(n?document.createTextNode(n):document.createElement("br")),s.append(r)}const i=re._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:o(this,Es)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ba=new WeakMap,Es=new WeakMap,Rd=new WeakMap,io=new WeakMap,Cs=new WeakMap,as=new WeakSet,m_=function(e){const t=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--scale-factor))`,this.translate(0,-(a-o(this,Cs))*this.parentScale),m(this,Cs,a),_(this,as,rp).call(this)},s=o(this,Cs);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:it.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},v_=function(e){const t=a=>{m(this,ba,this.editorDiv.style.color=a)},s=o(this,ba);this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:it.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},b_=function(){var e;const t=[];this.editorDiv.normalize();let s=null;for(const a of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&a.nodeName==="BR"||(t.push(_(e=ja,lr,op).call(e,a)),s=a);return t.join(`
`)},rp=function(){const[e,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:a,div:i}=this,n=i.style.display,r=i.classList.contains("hidden");i.classList.remove("hidden"),i.style.display="hidden",a.div.append(this.div),s=i.getBoundingClientRect(),i.remove(),i.style.display=n,i.classList.toggle("hidden",r)}this.rotation%180===this.parentRotation%180?(this.width=s.width/e,this.height=s.height/t):(this.width=s.height/e,this.height=s.width/t),this.fixAndSetPosition()},lr=new WeakSet,op=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(Ld,"")},Id=function(){if(this.editorDiv.replaceChildren(),!!o(this,Es))for(const e of o(this,Es).split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}},y_=function(){return o(this,Es).replaceAll(""," ")},Nv=function(e){return e.replaceAll(" ","")},w_=function(e){const{value:t,fontSize:s,color:a,pageIndex:i}=this._initialData;return this._hasBeenMoved||e.value!==t||e.fontSize!==s||e.color.some((n,r)=>n!==a[r])||e.pageIndex!==i},k(ja,lr),X(ja,"_freeTextDefaultContent",""),X(ja,"_internalPadding",0),X(ja,"_defaultColor",null),X(ja,"_defaultFontSize",10),X(ja,"_type","freetext"),X(ja,"_editorType",J.FREETEXT);let EN=ja;class O{toSVGPath(){yt("Abstract method `toSVGPath` must be implemented.")}get box(){yt("Abstract getter `box` must be implemented.")}serialize(t,s){yt("Abstract method `serialize` must be implemented.")}static _rescale(t,s,a,i,n,r){r||(r=new Float32Array(t.length));for(let l=0,c=t.length;l<c;l+=2)r[l]=s+t[l]*i,r[l+1]=a+t[l+1]*n;return r}static _rescaleAndSwap(t,s,a,i,n,r){r||(r=new Float32Array(t.length));for(let l=0,c=t.length;l<c;l+=2)r[l]=s+t[l+1]*i,r[l+1]=a+t[l]*n;return r}static _translate(t,s,a,i){i||(i=new Float32Array(t.length));for(let n=0,r=t.length;n<r;n+=2)i[n]=s+t[n],i[n+1]=a+t[n+1];return i}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,s,a,i,n){switch(n){case 90:return[1-s/a,t/i];case 180:return[1-t/a,1-s/i];case 270:return[s/a,1-t/i];default:return[t/a,s/i]}}static _normalizePagePoint(t,s,a){switch(a){case 90:return[1-s,t];case 180:return[1-t,1-s];case 270:return[s,1-t];default:return[t,s]}}static createBezierPoints(t,s,a,i,n,r){return[(t+5*a)/6,(s+5*i)/6,(5*a+n)/6,(5*i+r)/6,(a+n)/2,(i+r)/2]}}X(O,"PRECISION",1e-4);var Ms,ya,lu,cu,Fa,et,tl,el,Dd,jd,uu,_c,On,Fd,Lg,Pv,Ns,Ll,x_,k_,__,A_,S_,E_;const no=class Tv{constructor({x:t,y:s},a,i,n,r,l=0){k(this,Ns),k(this,Ms),k(this,ya,[]),k(this,lu),k(this,cu),k(this,Fa,[]),k(this,et,new Float32Array(18)),k(this,tl),k(this,el),k(this,Dd),k(this,jd),k(this,uu),k(this,_c),k(this,On,[]),m(this,Ms,a),m(this,_c,n*i),m(this,cu,r),o(this,et).set([NaN,NaN,NaN,NaN,t,s],6),m(this,lu,l),m(this,jd,o(Tv,Fd)*i),m(this,Dd,o(Tv,Pv)*i),m(this,uu,i),o(this,On).push(t,s)}isEmpty(){return isNaN(o(this,et)[8])}add({x:t,y:s}){var a;m(this,tl,t),m(this,el,s);const[i,n,r,l]=o(this,Ms);let[c,u,h,d]=o(this,et).subarray(8,12);const f=t-h,g=s-d,v=Math.hypot(f,g);if(v<o(this,Dd))return!1;const y=v-o(this,jd),A=y/v,b=A*f,x=A*g;let w=c,S=u;c=h,u=d,h+=b,d+=x,(a=o(this,On))==null||a.push(t,s);const E=-x/y,M=b/y,N=E*o(this,_c),P=M*o(this,_c);return o(this,et).set(o(this,et).subarray(2,8),0),o(this,et).set([h+N,d+P],4),o(this,et).set(o(this,et).subarray(14,18),12),o(this,et).set([h-N,d-P],16),isNaN(o(this,et)[6])?(o(this,Fa).length===0&&(o(this,et).set([c+N,u+P],2),o(this,Fa).push(NaN,NaN,NaN,NaN,(c+N-i)/r,(u+P-n)/l),o(this,et).set([c-N,u-P],14),o(this,ya).push(NaN,NaN,NaN,NaN,(c-N-i)/r,(u-P-n)/l)),o(this,et).set([w,S,c,u,h,d],6),!this.isEmpty()):(o(this,et).set([w,S,c,u,h,d],6),Math.abs(Math.atan2(S-u,w-c)-Math.atan2(x,b))<Math.PI/2?([c,u,h,d]=o(this,et).subarray(2,6),o(this,Fa).push(NaN,NaN,NaN,NaN,((c+h)/2-i)/r,((u+d)/2-n)/l),[c,u,w,S]=o(this,et).subarray(14,18),o(this,ya).push(NaN,NaN,NaN,NaN,((w+c)/2-i)/r,((S+u)/2-n)/l),!0):([w,S,c,u,h,d]=o(this,et).subarray(0,6),o(this,Fa).push(((w+5*c)/6-i)/r,((S+5*u)/6-n)/l,((5*c+h)/6-i)/r,((5*u+d)/6-n)/l,((c+h)/2-i)/r,((u+d)/2-n)/l),[h,d,c,u,w,S]=o(this,et).subarray(12,18),o(this,ya).push(((w+5*c)/6-i)/r,((S+5*u)/6-n)/l,((5*c+h)/6-i)/r,((5*u+d)/6-n)/l,((c+h)/2-i)/r,((u+d)/2-n)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=o(this,Fa),s=o(this,ya);if(isNaN(o(this,et)[6])&&!this.isEmpty())return _(this,Ns,x_).call(this);const a=[];a.push(`M${t[4]} ${t[5]}`);for(let i=6;i<t.length;i+=6)isNaN(t[i])?a.push(`L${t[i+4]} ${t[i+5]}`):a.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);_(this,Ns,__).call(this,a);for(let i=s.length-6;i>=6;i-=6)isNaN(s[i])?a.push(`L${s[i+4]} ${s[i+5]}`):a.push(`C${s[i]} ${s[i+1]} ${s[i+2]} ${s[i+3]} ${s[i+4]} ${s[i+5]}`);return _(this,Ns,k_).call(this,a),a.join(" ")}newFreeDrawOutline(t,s,a,i,n,r){return new N_(t,s,a,i,n,r)}getOutlines(){var t;const s=o(this,Fa),a=o(this,ya),i=o(this,et),[n,r,l,c]=o(this,Ms),u=new Float32Array((((t=o(this,On))==null?void 0:t.length)??0)+2);for(let f=0,g=u.length-2;f<g;f+=2)u[f]=(o(this,On)[f]-n)/l,u[f+1]=(o(this,On)[f+1]-r)/c;if(u[u.length-2]=(o(this,tl)-n)/l,u[u.length-1]=(o(this,el)-r)/c,isNaN(i[6])&&!this.isEmpty())return _(this,Ns,A_).call(this,u);const h=new Float32Array(o(this,Fa).length+24+o(this,ya).length);let d=s.length;for(let f=0;f<d;f+=2){if(isNaN(s[f])){h[f]=h[f+1]=NaN;continue}h[f]=s[f],h[f+1]=s[f+1]}d=_(this,Ns,E_).call(this,h,d);for(let f=a.length-6;f>=6;f-=6)for(let g=0;g<6;g+=2){if(isNaN(a[f+g])){h[d]=h[d+1]=NaN,d+=2;continue}h[d]=a[f+g],h[d+1]=a[f+g+1],d+=2}return _(this,Ns,S_).call(this,h,d),this.newFreeDrawOutline(h,u,o(this,Ms),o(this,uu),o(this,lu),o(this,cu))}};Ms=new WeakMap,ya=new WeakMap,lu=new WeakMap,cu=new WeakMap,Fa=new WeakMap,et=new WeakMap,tl=new WeakMap,el=new WeakMap,Dd=new WeakMap,jd=new WeakMap,uu=new WeakMap,_c=new WeakMap,On=new WeakMap,Fd=new WeakMap,Lg=new WeakMap,Pv=new WeakMap,Ns=new WeakSet,Ll=function(){const e=o(this,et).subarray(4,6),t=o(this,et).subarray(16,18),[s,a,i,n]=o(this,Ms);return[(o(this,tl)+(e[0]-t[0])/2-s)/i,(o(this,el)+(e[1]-t[1])/2-a)/n,(o(this,tl)+(t[0]-e[0])/2-s)/i,(o(this,el)+(t[1]-e[1])/2-a)/n]},x_=function(){const[e,t,s,a]=o(this,Ms),[i,n,r,l]=_(this,Ns,Ll).call(this);return`M${(o(this,et)[2]-e)/s} ${(o(this,et)[3]-t)/a} L${(o(this,et)[4]-e)/s} ${(o(this,et)[5]-t)/a} L${i} ${n} L${r} ${l} L${(o(this,et)[16]-e)/s} ${(o(this,et)[17]-t)/a} L${(o(this,et)[14]-e)/s} ${(o(this,et)[15]-t)/a} Z`},k_=function(e){const t=o(this,ya);e.push(`L${t[4]} ${t[5]} Z`)},__=function(e){const[t,s,a,i]=o(this,Ms),n=o(this,et).subarray(4,6),r=o(this,et).subarray(16,18),[l,c,u,h]=_(this,Ns,Ll).call(this);e.push(`L${(n[0]-t)/a} ${(n[1]-s)/i} L${l} ${c} L${u} ${h} L${(r[0]-t)/a} ${(r[1]-s)/i}`)},A_=function(e){const t=o(this,et),[s,a,i,n]=o(this,Ms),[r,l,c,u]=_(this,Ns,Ll).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(t[2]-s)/i,(t[3]-a)/n,NaN,NaN,NaN,NaN,(t[4]-s)/i,(t[5]-a)/n,NaN,NaN,NaN,NaN,r,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(t[16]-s)/i,(t[17]-a)/n,NaN,NaN,NaN,NaN,(t[14]-s)/i,(t[15]-a)/n],0),this.newFreeDrawOutline(h,e,o(this,Ms),o(this,uu),o(this,lu),o(this,cu))},S_=function(e,t){const s=o(this,ya);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},E_=function(e,t){const s=o(this,et).subarray(4,6),a=o(this,et).subarray(16,18),[i,n,r,l]=o(this,Ms),[c,u,h,d]=_(this,Ns,Ll).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-i)/r,(s[1]-n)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(a[0]-i)/r,(a[1]-n)/l],t),t+=24},k(no,Fd,8),k(no,Lg,2),k(no,Pv,o(no,Fd)+o(no,Lg));let C_=no;var Ac,Do,Gi,Od,ys,Wd,Ut,Lv,M_;class N_ extends O{constructor(t,s,a,i,n,r){super(),k(this,Lv),k(this,Ac),k(this,Do,new Float32Array(4)),k(this,Gi),k(this,Od),k(this,ys),k(this,Wd),k(this,Ut),m(this,Ut,t),m(this,ys,s),m(this,Ac,a),m(this,Wd,i),m(this,Gi,n),m(this,Od,r),this.lastPoint=[NaN,NaN],_(this,Lv,M_).call(this,r);const[l,c,u,h]=o(this,Do);for(let d=0,f=t.length;d<f;d+=2)t[d]=(t[d]-l)/u,t[d+1]=(t[d+1]-c)/h;for(let d=0,f=s.length;d<f;d+=2)s[d]=(s[d]-l)/u,s[d+1]=(s[d+1]-c)/h}toSVGPath(){const t=[`M${o(this,Ut)[4]} ${o(this,Ut)[5]}`];for(let s=6,a=o(this,Ut).length;s<a;s+=6){if(isNaN(o(this,Ut)[s])){t.push(`L${o(this,Ut)[s+4]} ${o(this,Ut)[s+5]}`);continue}t.push(`C${o(this,Ut)[s]} ${o(this,Ut)[s+1]} ${o(this,Ut)[s+2]} ${o(this,Ut)[s+3]} ${o(this,Ut)[s+4]} ${o(this,Ut)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,a,i],n){const r=a-t,l=i-s;let c,u;switch(n){case 0:c=O._rescale(o(this,Ut),t,i,r,-l),u=O._rescale(o(this,ys),t,i,r,-l);break;case 90:c=O._rescaleAndSwap(o(this,Ut),t,s,r,l),u=O._rescaleAndSwap(o(this,ys),t,s,r,l);break;case 180:c=O._rescale(o(this,Ut),a,s,-r,l),u=O._rescale(o(this,ys),a,s,-r,l);break;case 270:c=O._rescaleAndSwap(o(this,Ut),a,i,-r,-l),u=O._rescaleAndSwap(o(this,ys),a,i,-r,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return o(this,Do)}newOutliner(t,s,a,i,n,r=0){return new C_(t,s,a,i,n,r)}getNewOutline(t,s){const[a,i,n,r]=o(this,Do),[l,c,u,h]=o(this,Ac),d=n*u,f=r*h,g=a*u+l,v=i*h+c,y=this.newOutliner({x:o(this,ys)[0]*d+g,y:o(this,ys)[1]*f+v},o(this,Ac),o(this,Wd),t,o(this,Od),s??o(this,Gi));for(let A=2;A<o(this,ys).length;A+=2)y.add({x:o(this,ys)[A]*d+g,y:o(this,ys)[A+1]*f+v});return y.getOutlines()}}Ac=new WeakMap,Do=new WeakMap,Gi=new WeakMap,Od=new WeakMap,ys=new WeakMap,Wd=new WeakMap,Ut=new WeakMap,Lv=new WeakSet,M_=function(e){const t=o(this,Ut);let s=t[4],a=t[5],i=s,n=a,r=s,l=a,c=s,u=a;const h=e?Math.max:Math.min;for(let f=6,g=t.length;f<g;f+=6){if(isNaN(t[f]))i=Math.min(i,t[f+4]),n=Math.min(n,t[f+5]),r=Math.max(r,t[f+4]),l=Math.max(l,t[f+5]),u<t[f+5]?(c=t[f+4],u=t[f+5]):u===t[f+5]&&(c=h(c,t[f+4]));else{const v=$.bezierBoundingBox(s,a,...t.slice(f,f+6));i=Math.min(i,v[0]),n=Math.min(n,v[1]),r=Math.max(r,v[2]),l=Math.max(l,v[3]),u<v[3]?(c=v[2],u=v[3]):u===v[3]&&(c=h(c,v[2]))}s=t[f+4],a=t[f+5]}const d=o(this,Do);d[0]=i-o(this,Gi),d[1]=n-o(this,Gi),d[2]=r-i+2*o(this,Gi),d[3]=l-n+2*o(this,Gi),this.lastPoint=[c,u]};var lp,cp,Wn,ra,xa,P_,Eh,T_,L_,Rv;class Iv{constructor(t,s=0,a=0,i=!0){k(this,xa),k(this,lp),k(this,cp),k(this,Wn,[]),k(this,ra,[]);let n=1/0,r=-1/0,l=1/0,c=-1/0;const u=10**-4;for(const{x:A,y:b,width:x,height:w}of t){const S=Math.floor((A-s)/u)*u,E=Math.ceil((A+x+s)/u)*u,M=Math.floor((b-s)/u)*u,N=Math.ceil((b+w+s)/u)*u,P=[S,M,N,!0],T=[E,M,N,!1];o(this,Wn).push(P,T),n=Math.min(n,S),r=Math.max(r,E),l=Math.min(l,M),c=Math.max(c,N)}const h=r-n+2*a,d=c-l+2*a,f=n-a,g=l-a,v=o(this,Wn).at(i?-1:-2),y=[v[0],v[2]];for(const A of o(this,Wn)){const[b,x,w]=A;A[0]=(b-f)/h,A[1]=(x-g)/d,A[2]=(w-g)/d}m(this,lp,new Float32Array([f,g,h,d])),m(this,cp,y)}getOutlines(){o(this,Wn).sort((s,a)=>s[0]-a[0]||s[1]-a[1]||s[2]-a[2]);const t=[];for(const s of o(this,Wn))s[3]?(t.push(..._(this,xa,Rv).call(this,s)),_(this,xa,T_).call(this,s)):(_(this,xa,L_).call(this,s),t.push(..._(this,xa,Rv).call(this,s)));return _(this,xa,P_).call(this,t)}}lp=new WeakMap,cp=new WeakMap,Wn=new WeakMap,ra=new WeakMap,xa=new WeakSet,P_=function(e){const t=[],s=new Set;for(const n of e){const[r,l,c]=n;t.push([r,l,n],[r,c,n])}t.sort((n,r)=>n[1]-r[1]||n[0]-r[0]);for(let n=0,r=t.length;n<r;n+=2){const l=t[n][2],c=t[n+1][2];l.push(c),c.push(l),s.add(l),s.add(c)}const a=[];let i;for(;s.size>0;){const n=s.values().next().value;let[r,l,c,u,h]=n;s.delete(n);let d=r,f=l;for(i=[r,c],a.push(i);;){let g;if(s.has(u))g=u;else if(s.has(h))g=h;else break;s.delete(g),[r,l,c,u,h]=g,d!==r&&(i.push(d,f,r,f===l?l:c),d=r),f=f===l?c:l}i.push(d,f)}return new CN(a,o(this,lp),o(this,cp))},Eh=function(e){const t=o(this,ra);let s=0,a=t.length-1;for(;s<=a;){const i=s+a>>1,n=t[i][0];if(n===e)return i;n<e?s=i+1:a=i-1}return a+1},T_=function([,e,t]){const s=_(this,xa,Eh).call(this,e);o(this,ra).splice(s,0,[e,t])},L_=function([,e,t]){const s=_(this,xa,Eh).call(this,e);for(let a=s;a<o(this,ra).length;a++){const[i,n]=o(this,ra)[a];if(i!==e)break;if(i===e&&n===t){o(this,ra).splice(a,1);return}}for(let a=s-1;a>=0;a--){const[i,n]=o(this,ra)[a];if(i!==e)break;if(i===e&&n===t){o(this,ra).splice(a,1);return}}},Rv=function(e){const[t,s,a]=e,i=[[t,s,a]],n=_(this,xa,Eh).call(this,a);for(let r=0;r<n;r++){const[l,c]=o(this,ra)[r];for(let u=0,h=i.length;u<h;u++){const[,d,f]=i[u];if(!(c<=d||f<=l)){if(d>=l){if(f>c)i[u][1]=c;else{if(h===1)return[];i.splice(u,1),u--,h--}continue}i[u][2]=l,f>c&&i.push([t,c,f])}}}return i};var zd,Sc;class CN extends O{constructor(t,s,a){super(),k(this,zd),k(this,Sc),m(this,Sc,t),m(this,zd,s),this.lastPoint=a}toSVGPath(){const t=[];for(const s of o(this,Sc)){let[a,i]=s;t.push(`M${a} ${i}`);for(let n=2;n<s.length;n+=2){const r=s[n],l=s[n+1];r===a?(t.push(`V${l}`),i=l):l===i&&(t.push(`H${r}`),a=r)}t.push("Z")}return t.join(" ")}serialize([t,s,a,i],n){const r=[],l=a-t,c=i-s;for(const u of o(this,Sc)){const h=new Array(u.length);for(let d=0;d<u.length;d+=2)h[d]=t+u[d]*l,h[d+1]=i-u[d+1]*c;r.push(h)}return r}get box(){return o(this,zd)}get classNamesForOutlining(){return["highlightOutline"]}}zd=new WeakMap,Sc=new WeakMap;class Dv extends C_{newFreeDrawOutline(t,s,a,i,n,r){return new MN(t,s,a,i,n,r)}}class MN extends N_{newOutliner(t,s,a,i,n,r=0){return new Dv(t,s,a,i,n,r)}}var ha,ro,hu,te,up,Ec,$d,hp,cr,ka,du,fu,It,jv,Fv,Ov,zn,o0,Ri;const Bd=class Oa{constructor({editor:t=null,uiManager:s=null}){k(this,It),k(this,ha,null),k(this,ro,null),k(this,hu),k(this,te,null),k(this,up,!1),k(this,Ec,!1),k(this,$d,null),k(this,hp),k(this,cr,null),k(this,ka,null),k(this,du);var a;t?(m(this,Ec,!1),m(this,du,it.HIGHLIGHT_COLOR),m(this,$d,t)):(m(this,Ec,!0),m(this,du,it.HIGHLIGHT_DEFAULT_COLOR)),m(this,ka,(t==null?void 0:t._uiManager)||s),m(this,hp,o(this,ka)._eventBus),m(this,hu,(t==null?void 0:t.color)||((a=o(this,ka))==null?void 0:a.highlightColors.values().next().value)||"#FFFF98"),o(Oa,fu)||m(Oa,fu,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return tt(this,"_keyboardManager",new Ju([[["Escape","mac+Escape"],Oa.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Oa.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Oa.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Oa.prototype._moveToPrevious],[["Home","mac+Home"],Oa.prototype._moveToBeginning],[["End","mac+End"],Oa.prototype._moveToEnd]]))}renderButton(){const t=m(this,ha,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const s=o(this,ka)._signal;t.addEventListener("click",_(this,It,zn).bind(this),{signal:s}),t.addEventListener("keydown",_(this,It,Ov).bind(this),{signal:s});const a=m(this,ro,document.createElement("span"));return a.className="swatch",a.setAttribute("aria-hidden",!0),a.style.backgroundColor=o(this,hu),t.append(a),t}renderMainDropdown(){const t=m(this,te,_(this,It,jv).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===o(this,ha)){_(this,It,zn).call(this,t);return}const s=t.target.getAttribute("data-color");s&&_(this,It,Fv).call(this,s,t)}_moveToNext(t){var s,a;if(!o(this,It,Ri)){_(this,It,zn).call(this,t);return}if(t.target===o(this,ha)){(s=o(this,te).firstChild)==null||s.focus();return}(a=t.target.nextSibling)==null||a.focus()}_moveToPrevious(t){var s,a;if(t.target===((s=o(this,te))==null?void 0:s.firstChild)||t.target===o(this,ha)){o(this,It,Ri)&&this._hideDropdownFromKeyboard();return}o(this,It,Ri)||_(this,It,zn).call(this,t),(a=t.target.previousSibling)==null||a.focus()}_moveToBeginning(t){var s;if(!o(this,It,Ri)){_(this,It,zn).call(this,t);return}(s=o(this,te).firstChild)==null||s.focus()}_moveToEnd(t){var s;if(!o(this,It,Ri)){_(this,It,zn).call(this,t);return}(s=o(this,te).lastChild)==null||s.focus()}hideDropdown(){var t,s;(t=o(this,te))==null||t.classList.add("hidden"),(s=o(this,cr))==null||s.abort(),m(this,cr,null)}_hideDropdownFromKeyboard(){var t;if(!o(this,Ec)){if(!o(this,It,Ri)){(t=o(this,$d))==null||t.unselect();return}this.hideDropdown(),o(this,ha).focus({preventScroll:!0,focusVisible:o(this,up)})}}updateColor(t){if(o(this,ro)&&(o(this,ro).style.backgroundColor=t),!o(this,te))return;const s=o(this,ka).highlightColors.values();for(const a of o(this,te).children)a.setAttribute("aria-selected",s.next().value===t)}destroy(){var t,s;(t=o(this,ha))==null||t.remove(),m(this,ha,null),m(this,ro,null),(s=o(this,te))==null||s.remove(),m(this,te,null)}};ha=new WeakMap,ro=new WeakMap,hu=new WeakMap,te=new WeakMap,up=new WeakMap,Ec=new WeakMap,$d=new WeakMap,hp=new WeakMap,cr=new WeakMap,ka=new WeakMap,du=new WeakMap,fu=new WeakMap,It=new WeakSet,jv=function(){const e=document.createElement("div"),t=o(this,ka)._signal;e.addEventListener("contextmenu",ta,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,a]of o(this,ka).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",a),i.title=s,i.setAttribute("data-l10n-id",o(Bd,fu)[s]);const n=document.createElement("span");i.append(n),n.className="swatch",n.style.backgroundColor=a,i.setAttribute("aria-selected",a===o(this,hu)),i.addEventListener("click",_(this,It,Fv).bind(this,a),{signal:t}),e.append(i)}return e.addEventListener("keydown",_(this,It,Ov).bind(this),{signal:t}),e},Fv=function(e,t){t.stopPropagation(),o(this,hp).dispatch("switchannotationeditorparams",{source:this,type:o(this,du),value:e})},Ov=function(e){Bd._keyboardManager.exec(this,e)},zn=function(e){if(o(this,It,Ri)){this.hideDropdown();return}if(m(this,up,e.detail===0),o(this,cr)||(m(this,cr,new AbortController),window.addEventListener("pointerdown",_(this,It,o0).bind(this),{signal:o(this,ka).combinedSignal(o(this,cr))})),o(this,te)){o(this,te).classList.remove("hidden");return}const t=m(this,te,_(this,It,jv).call(this));o(this,ha).append(t)},o0=function(e){var t;(t=o(this,te))!=null&&t.contains(e.target)||this.hideDropdown()},Ri=function(){return o(this,te)&&!o(this,te).classList.contains("hidden")},k(Bd,fu,null);let R_=Bd;var pu,dp,Ji,jo,gu,is,fp,pp,sl,Hs,_s,Ee,mu,Zi,je,Cc,Ys,Ud,pt,Wv,gp,I_,D_,l0,zv,$n,Ja,al,j_,Hd,vu,F_,O_,W_,z_,$_;const He=class xe extends zt{constructor(t){super({...t,name:"highlightEditor"}),k(this,pt),k(this,pu,null),k(this,dp,0),k(this,Ji),k(this,jo,null),k(this,gu,null),k(this,is,null),k(this,fp,null),k(this,pp,0),k(this,sl,null),k(this,Hs,null),k(this,_s,null),k(this,Ee,!1),k(this,mu,null),k(this,Zi),k(this,je,null),k(this,Cc,""),k(this,Ys),k(this,Ud,""),this.color=t.color||xe._defaultColor,m(this,Ys,t.thickness||xe._defaultThickness),m(this,Zi,t.opacity||xe._defaultOpacity),m(this,Ji,t.boxes||null),m(this,Ud,t.methodOfCreation||""),m(this,Cc,t.text||""),this._isDraggable=!1,t.highlightId>-1?(m(this,Ee,!0),_(this,pt,gp).call(this,t),_(this,pt,$n).call(this)):o(this,Ji)&&(m(this,pu,t.anchorNode),m(this,dp,t.anchorOffset),m(this,fp,t.focusNode),m(this,pp,t.focusOffset),_(this,pt,Wv).call(this),_(this,pt,$n).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=xe.prototype;return tt(this,"_keyboardManager",new Ju([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:o(this,Ee)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:o(this,Ys),methodOfCreation:o(this,Ud)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var a;zt.initialize(t,s),xe._defaultColor||(xe._defaultColor=((a=s.highlightColors)==null?void 0:a.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case it.HIGHLIGHT_DEFAULT_COLOR:xe._defaultColor=s;break;case it.HIGHLIGHT_THICKNESS:xe._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return o(this,mu)}updateParams(t,s){switch(t){case it.HIGHLIGHT_COLOR:_(this,pt,I_).call(this,s);break;case it.HIGHLIGHT_THICKNESS:_(this,pt,D_).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[it.HIGHLIGHT_DEFAULT_COLOR,xe._defaultColor],[it.HIGHLIGHT_THICKNESS,xe._defaultThickness]]}get propertiesToUpdate(){return[[it.HIGHLIGHT_COLOR,this.color||xe._defaultColor],[it.HIGHLIGHT_THICKNESS,o(this,Ys)||xe._defaultThickness],[it.HIGHLIGHT_FREE,o(this,Ee)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(m(this,gu,new R_({editor:this})),t.addColorPicker(o(this,gu))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(_(this,pt,vu).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,_(this,pt,vu).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){_(this,pt,zv).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,pt,$n).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let a=!1;this.parent&&!t?_(this,pt,zv).call(this):t&&(_(this,pt,$n).call(this,t),a=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),a&&this.select()}rotate(t){var s,a,i;const{drawLayer:n}=this.parent;let r;o(this,Ee)?(t=(t-this.rotation+360)%360,r=_(s=xe,Ja,al).call(s,o(this,Hs).box,t)):r=_(a=xe,Ja,al).call(a,[this.x,this.y,this.width,this.height],t),n.updateProperties(o(this,_s),{bbox:r,root:{"data-main-rotation":t}}),n.updateProperties(o(this,je),{bbox:_(i=xe,Ja,al).call(i,o(this,is).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();o(this,Cc)&&(t.setAttribute("aria-label",o(this,Cc)),t.setAttribute("role","mark")),o(this,Ee)?t.classList.add("free"):this.div.addEventListener("keydown",_(this,pt,j_).bind(this),{signal:this._uiManager._signal});const s=m(this,sl,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=o(this,jo);const[a,i]=this.parentDimensions;return this.setDims(this.width*a,this.height*i),Lf(this,o(this,sl),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(o(this,je),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(o(this,je),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:_(this,pt,Hd).call(this,!0);break;case 1:case 3:_(this,pt,Hd).call(this,!1);break}}select(){var t;super.select(),o(this,je)&&((t=this.parent)==null||t.drawLayer.updateProperties(o(this,je),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),o(this,je)&&((t=this.parent)==null||t.drawLayer.updateProperties(o(this,je),{rootClass:{selected:!1}}),o(this,Ee)||_(this,pt,Hd).call(this,!1))}get _mustFixPosition(){return!o(this,Ee)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(o(this,_s),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(o(this,je),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:a,x:i,y:n}){const{x:r,y:l,width:c,height:u}=a.getBoundingClientRect(),h=new AbortController,d=t.combinedSignal(h),f=g=>{h.abort(),_(this,Ja,z_).call(this,t,g)};window.addEventListener("blur",f,{signal:d}),window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("pointerdown",cs,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",ta,{signal:d}),a.addEventListener("pointermove",_(this,Ja,W_).bind(this,t),{signal:d}),this._freeHighlight=new Dv({x:i,y:n},[r,l,c,u],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,a){var i,n,r,l;let c=null;if(t instanceof f_){const{data:{quadPoints:x,rect:w,rotation:S,id:E,color:M,opacity:N,popupRef:P},parent:{page:{pageNumber:T}}}=t;c=t={annotationType:J.HIGHLIGHT,color:Array.from(M),opacity:N,quadPoints:x,boxes:null,pageIndex:T-1,rect:w.slice(0),rotation:S,id:E,deleted:!1,popupRef:P}}else if(t instanceof ry){const{data:{inkLists:x,rect:w,rotation:S,id:E,color:M,borderStyle:{rawWidth:N},popupRef:P},parent:{page:{pageNumber:T}}}=t;c=t={annotationType:J.HIGHLIGHT,color:Array.from(M),thickness:N,inkLists:x,boxes:null,pageIndex:T-1,rect:w.slice(0),rotation:S,id:E,deleted:!1,popupRef:P}}const{color:u,quadPoints:h,inkLists:d,opacity:f}=t,g=await super.deserialize(t,s,a);g.color=$.makeHexColor(...u),m(g,Zi,f||1),d&&m(g,Ys,t.thickness),g.annotationElementId=t.id||null,g._initialData=c;const[v,y]=g.pageDimensions,[A,b]=g.pageTranslation;if(h){const x=m(g,Ji,[]);for(let w=0;w<h.length;w+=8)x.push({x:(h[w]-A)/v,y:1-(h[w+1]-b)/y,width:(h[w+2]-h[w])/v,height:(h[w+1]-h[w+5])/y});_(i=g,pt,Wv).call(i),_(n=g,pt,$n).call(n),g.rotate(g.rotation)}else if(d){m(g,Ee,!0);const x=d[0],w={x:x[0]-A,y:y-(x[1]-b)},S=new Dv(w,[0,0,v,y],1,o(g,Ys)/2,!0,.001);for(let N=0,P=x.length;N<P;N+=2)w.x=x[N]-A,w.y=y-(x[N+1]-b),S.add(w);const{id:E,clipPathId:M}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:g.color,"fill-opacity":g._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:S.toSVGPath()}},!0,!0);_(r=g,pt,gp).call(r,{highlightOutlines:S.getOutlines(),highlightId:E,clipPathId:M}),_(l=g,pt,$n).call(l)}return g}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),a=zt._colorManager.convert(this.color),i={annotationType:J.HIGHLIGHT,color:a,opacity:o(this,Zi),thickness:o(this,Ys),quadPoints:_(this,pt,F_).call(this),outlines:_(this,pt,O_).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:_(this,pt,vu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!_(this,pt,$_).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};pu=new WeakMap,dp=new WeakMap,Ji=new WeakMap,jo=new WeakMap,gu=new WeakMap,is=new WeakMap,fp=new WeakMap,pp=new WeakMap,sl=new WeakMap,Hs=new WeakMap,_s=new WeakMap,Ee=new WeakMap,mu=new WeakMap,Zi=new WeakMap,je=new WeakMap,Cc=new WeakMap,Ys=new WeakMap,Ud=new WeakMap,pt=new WeakSet,Wv=function(){const e=new Iv(o(this,Ji),.001);m(this,Hs,e.getOutlines()),[this.x,this.y,this.width,this.height]=o(this,Hs).box;const t=new Iv(o(this,Ji),.0025,.001,this._uiManager.direction==="ltr");m(this,is,t.getOutlines());const{lastPoint:s}=o(this,is);m(this,mu,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},gp=function({highlightOutlines:e,highlightId:t,clipPathId:s}){var a,i;if(m(this,Hs,e),m(this,is,e.getNewOutline(o(this,Ys)/2+1.5,.0025)),t>=0)m(this,_s,t),m(this,jo,s),this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),m(this,je,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:o(this,is).box,path:{d:o(this,is).toSVGPath()}},!0));else if(this.parent){const h=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(o(this,_s),{bbox:_(a=He,Ja,al).call(a,o(this,Hs).box,(h-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(o(this,je),{bbox:_(i=He,Ja,al).call(i,o(this,is).box,h),path:{d:o(this,is).toSVGPath()}})}const[n,r,l,c]=e.box;switch(this.rotation){case 0:this.x=n,this.y=r,this.width=l,this.height=c;break;case 90:{const[h,d]=this.parentDimensions;this.x=r,this.y=1-n,this.width=l*d/h,this.height=c*h/d;break}case 180:this.x=1-n,this.y=1-r,this.width=l,this.height=c;break;case 270:{const[h,d]=this.parentDimensions;this.x=1-r,this.y=n,this.width=l*d/h,this.height=c*h/d;break}}const{lastPoint:u}=o(this,is);m(this,mu,[(u[0]-n)/l,(u[1]-r)/c])},I_=function(e){const t=(i,n)=>{var r,l;this.color=i,m(this,Zi,n),(r=this.parent)==null||r.drawLayer.updateProperties(o(this,_s),{root:{fill:i,"fill-opacity":n}}),(l=o(this,gu))==null||l.updateColor(i)},s=this.color,a=o(this,Zi);this.addCommands({cmd:t.bind(this,e,He._defaultOpacity),undo:t.bind(this,s,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:it.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},D_=function(e){const t=o(this,Ys),s=a=>{m(this,Ys,a),_(this,pt,l0).call(this,a)};this.addCommands({cmd:s.bind(this,e),undo:s.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:it.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},l0=function(e){if(!o(this,Ee))return;_(this,pt,gp).call(this,{highlightOutlines:o(this,Hs).getNewOutline(e/2)}),this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)},zv=function(){o(this,_s)===null||!this.parent||(this.parent.drawLayer.remove(o(this,_s)),m(this,_s,null),this.parent.drawLayer.remove(o(this,je)),m(this,je,null))},$n=function(e=this.parent){o(this,_s)===null&&({id:Je(this,_s)._,clipPathId:Je(this,jo)._}=e.drawLayer.draw({bbox:o(this,Hs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":o(this,Zi)},rootClass:{highlight:!0,free:o(this,Ee)},path:{d:o(this,Hs).toSVGPath()}},!1,!0),m(this,je,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:o(this,Ee)},bbox:o(this,is).box,path:{d:o(this,is).toSVGPath()}},o(this,Ee))),o(this,sl)&&(o(this,sl).style.clipPath=o(this,jo)))},Ja=new WeakSet,al=function([e,t,s,a],i){switch(i){case 90:return[1-t-a,e,a,s];case 180:return[1-e-s,1-t-a,s,a];case 270:return[t,1-e-s,a,s]}return[e,t,s,a]},j_=function(e){He._keyboardManager.exec(this,e)},Hd=function(e){if(!o(this,pu))return;const t=window.getSelection();e?t.setPosition(o(this,pu),o(this,dp)):t.setPosition(o(this,fp),o(this,pp))},vu=function(){return o(this,Ee)?this.rotation:0},F_=function(){if(o(this,Ee))return null;const[e,t]=this.pageDimensions,[s,a]=this.pageTranslation,i=o(this,Ji),n=new Float32Array(i.length*8);let r=0;for(const{x:l,y:c,width:u,height:h}of i){const d=l*e+s,f=(1-c)*t+a;n[r]=n[r+4]=d,n[r+1]=n[r+3]=f,n[r+2]=n[r+6]=d+u*e,n[r+5]=n[r+7]=f-h*t,r+=8}return n},O_=function(e){return o(this,Hs).serialize(e,_(this,pt,vu).call(this))},W_=function(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},z_=function(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},$_=function(e){const{color:t}=this._initialData;return e.color.some((s,a)=>s!==t[a])},k(He,Ja),X(He,"_defaultColor",null),X(He,"_defaultOpacity",1),X(He,"_defaultThickness",12),X(He,"_type","highlight"),X(He,"_editorType",J.HIGHLIGHT),X(He,"_freeHighlightId",-1),X(He,"_freeHighlight",null),X(He,"_freeHighlightClipId","");let c0=He;var oo;class NN{constructor(){k(this,oo,Object.create(null))}updateProperty(t,s){this[t]=s,this.updateSVGProperty(t,s)}updateProperties(t){if(t)for(const[s,a]of Object.entries(t))this.updateProperty(s,a)}updateSVGProperty(t,s){o(this,oo)[t]=s}toSVGProperties(){const t=o(this,oo);return m(this,oo,Object.create(null)),{root:t}}reset(){m(this,oo,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){yt("Not implemented")}}oo=new WeakMap;var As,Mc,ue,Fo,Oo,Ii,Di,ji,Wo,_t,$v,Rg,Bv,Nc,u0,Vd,bu,lo;const ws=class q extends zt{constructor(t){super(t),k(this,_t),k(this,As,null),k(this,Mc),X(this,"_drawId",null),m(this,Mc,t.mustBeCommitted||!1),t.drawOutlines&&(_(this,_t,$v).call(this,t),_(this,_t,Nc).call(this))}static _mergeSVGProperties(t,s){const a=new Set(Object.keys(t));for(const[i,n]of Object.entries(s))a.has(i)?Object.assign(t[i],n):t[i]=n;return t}static getDefaultDrawingOptions(t){yt("Not implemented")}static get typesMap(){yt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const a=this.typesMap.get(t);a&&this._defaultDrawingOptions.updateProperty(a,s),this._currentParent&&(o(q,ue).updateProperty(a,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const a=this.constructor.typesMap.get(t);a&&this._updateProperty(t,a,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[a,i]of this.typesMap)t.push([a,s[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[a,i]of this.constructor.typesMap)t.push([a,s[i]]);return t}_updateProperty(t,s,a){const i=this._drawingOptions,n=i[s],r=l=>{var c;i.updateProperty(s,l);const u=o(this,As).updateProperty(s,l);u&&_(this,_t,bu).call(this,u),(c=this.parent)==null||c.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:r.bind(this,a),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(o(this,As).getPathResizingSVGProperties(_(this,_t,Vd).call(this)),{bbox:_(this,_t,lo).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(o(this,As).getPathResizedSVGProperties(_(this,_t,Vd).call(this)),{bbox:_(this,_t,lo).call(this)}))}_onTranslating(t,s){var a;(a=this.parent)==null||a.drawLayer.updateProperties(this._drawId,{bbox:_(this,_t,lo).call(this,t,s)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(o(this,As).getPathTranslatedSVGProperties(_(this,_t,Vd).call(this),this.parentDimensions),{bbox:_(this,_t,lo).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,o(this,Mc)&&(m(this,Mc,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){_(this,_t,Bv).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(_(this,_t,Nc).call(this),_(this,_t,bu).call(this,o(this,As).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let a=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),_(this,_t,Bv).call(this)):t&&(this._uiManager.addShouldRescale(this),_(this,_t,Nc).call(this,t),a=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),a&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties({bbox:_(this,_t,lo).call(this)},o(this,As).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&_(this,_t,bu).call(this,o(this,As).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[a,i]=this.parentDimensions;return this.setDims(this.width*a,this.height*i),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,a,i,n){yt("Not implemented")}static startDrawing(t,s,a,i){var n;const{target:r,offsetX:l,offsetY:c,pointerId:u,pointerType:h}=i;if(o(q,Di)&&o(q,Di)!==h)return;const{viewport:{rotation:d}}=t,{width:f,height:g}=r.getBoundingClientRect(),v=m(q,Fo,new AbortController),y=t.combinedSignal(v);if(o(q,Ii)||m(q,Ii,u),o(q,Di)??m(q,Di,h),window.addEventListener("pointerup",A=>{var b;o(q,Ii)===A.pointerId?this._endDraw(A):(b=o(q,ji))==null||b.delete(A.pointerId)},{signal:y}),window.addEventListener("pointercancel",A=>{var b;o(q,Ii)===A.pointerId?this._currentParent.endDrawingSession():(b=o(q,ji))==null||b.delete(A.pointerId)},{signal:y}),window.addEventListener("pointerdown",A=>{o(q,Di)===A.pointerType&&((o(q,ji)||m(q,ji,new Set)).add(A.pointerId),o(q,ue).isCancellable()&&(o(q,ue).removeLastElement(),o(q,ue).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",ta,{signal:y}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),r.addEventListener("touchmove",A=>{A.timeStamp===o(q,Wo)&&cs(A)},{signal:y}),t.toggleDrawing(),(n=s._editorUndoBar)==null||n.hide(),o(q,ue)){t.drawLayer.updateProperties(this._currentDrawId,o(q,ue).startNew(l,c,f,g,d));return}s.updateUIForDefaultProperties(this),m(q,ue,this.createDrawerInstance(l,c,f,g,d)),m(q,Oo,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(o(q,Oo).toSVGProperties(),o(q,ue).defaultSVGProperties),!0,!1)}static _drawMove(t){var s;if(m(q,Wo,-1),!o(q,ue))return;const{offsetX:a,offsetY:i,pointerId:n}=t;if(o(q,Ii)===n){if(((s=o(q,ji))==null?void 0:s.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,o(q,ue).add(a,i)),m(q,Wo,t.timeStamp),cs(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,m(q,ue,null),m(q,Oo,null),m(q,Di,null),m(q,Wo,NaN)),o(q,Fo)&&(o(q,Fo).abort(),m(q,Fo,null),m(q,Ii,NaN),m(q,ji,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),t&&s.drawLayer.updateProperties(this._currentDrawId,o(q,ue).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const a=o(q,ue),i=this._currentDrawId,n=a.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(i,a.setLastElement(n))},undo:()=>{s.drawLayer.updateProperties(i,a.removeLastElement())},mustExec:!1,type:it.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(it.DRAW_STEP),!o(q,ue).isEmpty()){const{pageDimensions:[a,i],scale:n}=s,r=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:o(q,ue).getOutlines(a*n,i*n,n,this._INNER_MARGIN),drawingOptions:o(q,Oo),mustBeCommitted:!t});return this._cleanup(!0),r}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,a,i,n,r){yt("Not implemented")}static async deserialize(t,s,a){var i,n;const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:u}}=s.viewport,h=this.deserializeDraw(c,u,r,l,this._INNER_MARGIN,t),d=await super.deserialize(t,s,a);return d.createDrawingOptions(t),_(i=d,_t,$v).call(i,{drawOutlines:h}),_(n=d,_t,Nc).call(n),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[s,a]=this.pageTranslation,[i,n]=this.pageDimensions;return o(this,As).serialize([s,a,i,n],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};As=new WeakMap,Mc=new WeakMap,ue=new WeakMap,Fo=new WeakMap,Oo=new WeakMap,Ii=new WeakMap,Di=new WeakMap,ji=new WeakMap,Wo=new WeakMap,_t=new WeakSet,$v=function({drawOutlines:e,drawId:t,drawingOptions:s}){m(this,As,e),this._drawingOptions||(this._drawingOptions=s),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=_(this,_t,Rg).call(this,e,this.parent),_(this,_t,bu).call(this,e.box)},Rg=function(e,t){const{id:s}=t.drawLayer.draw(ws._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return s},Bv=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Nc=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=_(this,_t,Rg).call(this,o(this,As),e)}},u0=function([e,t,s,a]){const{parentDimensions:[i,n],rotation:r}=this;switch(r){case 90:return[t,1-e,s*(n/i),a*(i/n)];case 180:return[1-e,1-t,s,a];case 270:return[1-t,e,s*(n/i),a*(i/n)];default:return[e,t,s,a]}},Vd=function(){const{x:e,y:t,width:s,height:a,parentDimensions:[i,n],rotation:r}=this;switch(r){case 90:return[1-t,e,s*(i/n),a*(n/i)];case 180:return[1-e,1-t,s,a];case 270:return[t,1-e,s*(i/n),a*(n/i)];default:return[e,t,s,a]}},bu=function(e){if([this.x,this.y,this.width,this.height]=_(this,_t,u0).call(this,e),this.div){this.fixAndSetPosition();const[t,s]=this.parentDimensions;this.setDims(this.width*t,this.height*s)}this._onResized()},lo=function(){const{x:e,y:t,width:s,height:a,rotation:i,parentRotation:n,parentDimensions:[r,l]}=this;switch((i*4+n)/90){case 1:return[1-t-a,e,a,s];case 2:return[1-e-s,1-t-a,s,a];case 3:return[t,1-e-s,a,s];case 4:return[e,t-s*(r/l),a*(l/r),s*(r/l)];case 5:return[1-t,e,s*(r/l),a*(l/r)];case 6:return[1-e-a*(l/r),1-t,a*(l/r),s*(r/l)];case 7:return[t-s*(r/l),1-e-a*(l/r),s*(r/l),a*(l/r)];case 8:return[e-s,t-a,s,a];case 9:return[1-t,e-s,a,s];case 10:return[1-e,1-t,s,a];case 11:return[t-a,1-e,a,s];case 12:return[e-a*(l/r),t,a*(l/r),s*(r/l)];case 13:return[1-t-s*(r/l),e-a*(l/r),s*(r/l),a*(l/r)];case 14:return[1-e,1-t-s*(r/l),a*(l/r),s*(r/l)];case 15:return[t,1-e,s*(r/l),a*(l/r)];default:return[e,t,s,a]}},X(ws,"_currentDrawId",-1),X(ws,"_currentParent",null),k(ws,ue,null),k(ws,Fo,null),k(ws,Oo,null),k(ws,Ii,NaN),k(ws,Di,null),k(ws,ji,null),k(ws,Wo,NaN),X(ws,"_INNER_MARGIN",3);let PN=ws;var Wa,oe,le,zo,Pc,Ve,ce,Bs,co,$o,Bo,Tc,Gd;class TN{constructor(t,s,a,i,n,r){k(this,Tc),k(this,Wa,new Float64Array(6)),k(this,oe),k(this,le),k(this,zo),k(this,Pc),k(this,Ve),k(this,ce,""),k(this,Bs,0),k(this,co,new G_),k(this,$o),k(this,Bo),m(this,$o,a),m(this,Bo,i),m(this,zo,n),m(this,Pc,r),[t,s]=_(this,Tc,Gd).call(this,t,s);const l=m(this,oe,[NaN,NaN,NaN,NaN,t,s]);m(this,Ve,[t,s]),m(this,le,[{line:l,points:o(this,Ve)}]),o(this,Wa).set(l,0)}updateProperty(t,s){t==="stroke-width"&&m(this,Pc,s)}isEmpty(){return!o(this,le)||o(this,le).length===0}isCancellable(){return o(this,Ve).length<=10}add(t,s){[t,s]=_(this,Tc,Gd).call(this,t,s);const[a,i,n,r]=o(this,Wa).subarray(2,6),l=t-n,c=s-r;return Math.hypot(o(this,$o)*l,o(this,Bo)*c)<=2?null:(o(this,Ve).push(t,s),isNaN(a)?(o(this,Wa).set([n,r,t,s],2),o(this,oe).push(NaN,NaN,NaN,NaN,t,s),{path:{d:this.toSVGPath()}}):(isNaN(o(this,Wa)[0])&&o(this,oe).splice(6,6),o(this,Wa).set([a,i,n,r,t,s],0),o(this,oe).push(...O.createBezierPoints(a,i,n,r,t,s)),{path:{d:this.toSVGPath()}}))}end(t,s){return this.add(t,s)||(o(this,Ve).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,s,a,i,n){m(this,$o,a),m(this,Bo,i),m(this,zo,n),[t,s]=_(this,Tc,Gd).call(this,t,s);const r=m(this,oe,[NaN,NaN,NaN,NaN,t,s]);m(this,Ve,[t,s]);const l=o(this,le).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),o(this,le).push({line:r,points:o(this,Ve)}),o(this,Wa).set(r,0),m(this,Bs,0),this.toSVGPath(),null}getLastElement(){return o(this,le).at(-1)}setLastElement(t){return o(this,le)?(o(this,le).push(t),m(this,oe,t.line),m(this,Ve,t.points),m(this,Bs,0),{path:{d:this.toSVGPath()}}):o(this,co).setLastElement(t)}removeLastElement(){if(!o(this,le))return o(this,co).removeLastElement();o(this,le).pop(),m(this,ce,"");for(let t=0,s=o(this,le).length;t<s;t++){const{line:a,points:i}=o(this,le)[t];m(this,oe,a),m(this,Ve,i),m(this,Bs,0),this.toSVGPath()}return{path:{d:o(this,ce)}}}toSVGPath(){const t=O.svgRound(o(this,oe)[4]),s=O.svgRound(o(this,oe)[5]);if(o(this,Ve).length===2)return m(this,ce,`${o(this,ce)} M ${t} ${s} Z`),o(this,ce);if(o(this,Ve).length<=6){const i=o(this,ce).lastIndexOf("M");m(this,ce,`${o(this,ce).slice(0,i)} M ${t} ${s}`),m(this,Bs,6)}if(o(this,Ve).length===4){const i=O.svgRound(o(this,oe)[10]),n=O.svgRound(o(this,oe)[11]);return m(this,ce,`${o(this,ce)} L ${i} ${n}`),m(this,Bs,12),o(this,ce)}const a=[];o(this,Bs)===0&&(a.push(`M ${t} ${s}`),m(this,Bs,6));for(let i=o(this,Bs),n=o(this,oe).length;i<n;i+=6){const[r,l,c,u,h,d]=o(this,oe).slice(i,i+6).map(O.svgRound);a.push(`C${r} ${l} ${c} ${u} ${h} ${d}`)}return m(this,ce,o(this,ce)+a.join(" ")),m(this,Bs,o(this,oe).length),o(this,ce)}getOutlines(t,s,a,i){const n=o(this,le).at(-1);return n.line=new Float32Array(n.line),n.points=new Float32Array(n.points),o(this,co).build(o(this,le),t,s,a,o(this,zo),o(this,Pc),i),m(this,Wa,null),m(this,oe,null),m(this,le,null),m(this,ce,null),o(this,co)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Wa=new WeakMap,oe=new WeakMap,le=new WeakMap,zo=new WeakMap,Pc=new WeakMap,Ve=new WeakMap,ce=new WeakMap,Bs=new WeakMap,co=new WeakMap,$o=new WeakMap,Bo=new WeakMap,Tc=new WeakSet,Gd=function(e,t){return O._normalizePoint(e,t,o(this,$o),o(this,Bo),o(this,zo))};var Xe,qd,mp,ks,Ka,Qa,yu,wu,xu,ls,Za,B_,U_,H_;const LN=class V_ extends O{constructor(){super(...arguments),k(this,ls),k(this,Xe),k(this,qd,0),k(this,mp),k(this,ks),k(this,Ka),k(this,Qa),k(this,yu),k(this,wu),k(this,xu)}build(t,s,a,i,n,r,l){m(this,Ka,s),m(this,Qa,a),m(this,yu,i),m(this,wu,n),m(this,xu,r),m(this,mp,l??0),m(this,ks,t),_(this,ls,U_).call(this)}setLastElement(t){return o(this,ks).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return o(this,ks).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of o(this,ks)){if(t.push(`M${O.svgRound(s[4])} ${O.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${O.svgRound(s[10])} ${O.svgRound(s[11])}`);continue}for(let a=6,i=s.length;a<i;a+=6){const[n,r,l,c,u,h]=s.subarray(a,a+6).map(O.svgRound);t.push(`C${n} ${r} ${l} ${c} ${u} ${h}`)}}return t.join("")}serialize([t,s,a,i],n){const r=[],l=[],[c,u,h,d]=_(this,ls,B_).call(this);let f,g,v,y,A,b,x,w,S;switch(o(this,wu)){case 0:S=O._rescale,f=t,g=s+i,v=a,y=-i,A=t+c*a,b=s+(1-u-d)*i,x=t+(c+h)*a,w=s+(1-u)*i;break;case 90:S=O._rescaleAndSwap,f=t,g=s,v=a,y=i,A=t+u*a,b=s+c*i,x=t+(u+d)*a,w=s+(c+h)*i;break;case 180:S=O._rescale,f=t+a,g=s,v=-a,y=i,A=t+(1-c-h)*a,b=s+u*i,x=t+(1-c)*a,w=s+(u+d)*i;break;case 270:S=O._rescaleAndSwap,f=t+a,g=s+i,v=-a,y=-i,A=t+(1-u-d)*a,b=s+(1-c-h)*i,x=t+(1-u)*a,w=s+(1-c)*i;break}for(const{line:E,points:M}of o(this,ks))r.push(S(E,f,g,v,y,n?new Array(E.length):null)),l.push(S(M,f,g,v,y,n?new Array(M.length):null));return{lines:r,points:l,rect:[A,b,x,w]}}static deserialize(t,s,a,i,n,{paths:{lines:r,points:l},rotation:c,thickness:u}){const h=[];let d,f,g,v,y;switch(c){case 0:y=O._rescale,d=-t/a,f=s/i+1,g=1/a,v=-1/i;break;case 90:y=O._rescaleAndSwap,d=-s/i,f=-t/a,g=1/i,v=1/a;break;case 180:y=O._rescale,d=t/a+1,f=-s/i,g=-1/a,v=1/i;break;case 270:y=O._rescaleAndSwap,d=s/i+1,f=t/a+1,g=-1/i,v=-1/a;break}if(!r){r=[];for(const b of l){const x=b.length;if(x===2){r.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(x===4){r.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const w=new Float32Array(3*(x-2));r.push(w);let[S,E,M,N]=b.subarray(0,4);w.set([NaN,NaN,NaN,NaN,S,E],0);for(let P=4;P<x;P+=2){const T=b[P],I=b[P+1];w.set(O.createBezierPoints(S,E,M,N,T,I),(P-2)*3),[S,E,M,N]=[M,N,T,I]}}}for(let b=0,x=r.length;b<x;b++)h.push({line:y(r[b].map(w=>w??NaN),d,f,g,v),points:y(l[b].map(w=>w??NaN),d,f,g,v)});const A=new V_;return A.build(h,a,i,1,c,u,n),A}get box(){return o(this,Xe)}updateProperty(t,s){return t==="stroke-width"?_(this,ls,H_).call(this,s):null}updateParentDimensions([t,s],a){const[i,n]=_(this,ls,Za).call(this);m(this,Ka,t),m(this,Qa,s),m(this,yu,a);const[r,l]=_(this,ls,Za).call(this),c=r-i,u=l-n,h=o(this,Xe);return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateRotation(t){return m(this,qd,t),{path:{transform:this.rotationTransform}}}get viewBox(){return o(this,Xe).map(O.svgRound).join(" ")}get defaultProperties(){const[t,s]=o(this,Xe);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(t)} ${O.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=o(this,Xe);let a=0,i=0,n=0,r=0,l=0,c=0;switch(o(this,qd)){case 90:i=s/t,n=-t/s,l=t;break;case 180:a=-1,r=-1,l=t,c=s;break;case 270:i=-s/t,n=t/s,c=s;break;default:return""}return`matrix(${a} ${i} ${n} ${r} ${O.svgRound(l)} ${O.svgRound(c)})`}getPathResizingSVGProperties([t,s,a,i]){const[n,r]=_(this,ls,Za).call(this),[l,c,u,h]=o(this,Xe);if(Math.abs(u-n)<=O.PRECISION||Math.abs(h-r)<=O.PRECISION){const y=t+a/2-(l+u/2),A=s+i/2-(c+h/2);return{path:{"transform-origin":`${O.svgRound(t)} ${O.svgRound(s)}`,transform:`${this.rotationTransform} translate(${y} ${A})`}}}const d=(a-2*n)/(u-2*n),f=(i-2*r)/(h-2*r),g=u/a,v=h/i;return{path:{"transform-origin":`${O.svgRound(l)} ${O.svgRound(c)}`,transform:`${this.rotationTransform} scale(${g} ${v}) translate(${O.svgRound(n)} ${O.svgRound(r)}) scale(${d} ${f}) translate(${O.svgRound(-n)} ${O.svgRound(-r)})`}}}getPathResizedSVGProperties([t,s,a,i]){const[n,r]=_(this,ls,Za).call(this),l=o(this,Xe),[c,u,h,d]=l;if(l[0]=t,l[1]=s,l[2]=a,l[3]=i,Math.abs(h-n)<=O.PRECISION||Math.abs(d-r)<=O.PRECISION){const A=t+a/2-(c+h/2),b=s+i/2-(u+d/2);for(const{line:x,points:w}of o(this,ks))O._translate(x,A,b,x),O._translate(w,A,b,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(t)} ${O.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(a-2*n)/(h-2*n),g=(i-2*r)/(d-2*r),v=-f*(c+n)+t+n,y=-g*(u+r)+s+r;if(f!==1||g!==1||v!==0||y!==0)for(const{line:A,points:b}of o(this,ks))O._rescale(A,v,y,f,g,A),O._rescale(b,v,y,f,g,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(t)} ${O.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],a){const[i,n]=a,r=o(this,Xe),l=t-r[0],c=s-r[1];if(o(this,Ka)===i&&o(this,Qa)===n)for(const{line:u,points:h}of o(this,ks))O._translate(u,l,c,u),O._translate(h,l,c,h);else{const u=o(this,Ka)/i,h=o(this,Qa)/n;m(this,Ka,i),m(this,Qa,n);for(const{line:d,points:f}of o(this,ks))O._rescale(d,l,c,u,h,d),O._rescale(f,l,c,u,h,f);r[2]*=u,r[3]*=h}return r[0]=t,r[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${O.svgRound(t)} ${O.svgRound(s)}`}}}get defaultSVGProperties(){const t=o(this,Xe);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${O.svgRound(t[0])} ${O.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Xe=new WeakMap,qd=new WeakMap,mp=new WeakMap,ks=new WeakMap,Ka=new WeakMap,Qa=new WeakMap,yu=new WeakMap,wu=new WeakMap,xu=new WeakMap,ls=new WeakSet,Za=function(e=o(this,xu)){const t=o(this,mp)+e/2*o(this,yu);return o(this,wu)%180===0?[t/o(this,Ka),t/o(this,Qa)]:[t/o(this,Qa),t/o(this,Ka)]},B_=function(){const[e,t,s,a]=o(this,Xe),[i,n]=_(this,ls,Za).call(this,0);return[e+i,t+n,s-2*i,a-2*n]},U_=function(){const e=m(this,Xe,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:a}of o(this,ks)){if(a.length<=12){for(let r=4,l=a.length;r<l;r+=6){const[c,u]=a.subarray(r,r+2);e[0]=Math.min(e[0],c),e[1]=Math.min(e[1],u),e[2]=Math.max(e[2],c),e[3]=Math.max(e[3],u)}continue}let i=a[4],n=a[5];for(let r=6,l=a.length;r<l;r+=6){const[c,u,h,d,f,g]=a.subarray(r,r+6);$.bezierBoundingBox(i,n,c,u,h,d,f,g,e),i=f,n=g}}const[t,s]=_(this,ls,Za).call(this);e[0]=Math.min(1,Math.max(0,e[0]-t)),e[1]=Math.min(1,Math.max(0,e[1]-s)),e[2]=Math.min(1,Math.max(0,e[2]+t)),e[3]=Math.min(1,Math.max(0,e[3]+s)),e[2]-=e[0],e[3]-=e[1]},H_=function(e){const[t,s]=_(this,ls,Za).call(this);m(this,xu,e);const[a,i]=_(this,ls,Za).call(this),[n,r]=[a-t,i-s],l=o(this,Xe);return l[0]-=n,l[1]-=r,l[2]+=2*n,l[3]+=2*r,l};let G_=LN;var Lc;const RN=class q_ extends NN{constructor(t){super(),k(this,Lc),m(this,Lc,t),super.updateProperties({fill:"none",stroke:zt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??(s=this["stroke-width"]),s*=o(this,Lc).realScale),super.updateSVGProperty(t,s)}clone(){const t=new q_(o(this,Lc));return t.updateAll(this),t}};Lc=new WeakMap;let IN=RN;var Uv,X_;const Xd=class Y_ extends PN{constructor(t){super({...t,name:"inkEditor"}),k(this,Uv),this._willKeepAspectRatio=!0}static initialize(t,s){zt.initialize(t,s),this._defaultDrawingOptions=new IN(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return tt(this,"typesMap",new Map([[it.INK_THICKNESS,"stroke-width"],[it.INK_COLOR,"stroke"],[it.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,a,i,n){return new TN(t,s,a,i,n,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,a,i,n,r){return G_.deserialize(t,s,a,i,n,r)}static async deserialize(t,s,a){let i=null;if(t instanceof ry){const{data:{inkLists:r,rect:l,rotation:c,id:u,color:h,opacity:d,borderStyle:{rawWidth:f},popupRef:g},parent:{page:{pageNumber:v}}}=t;i=t={annotationType:J.INK,color:Array.from(h),thickness:f,opacity:d,paths:{points:r},boxes:null,pageIndex:v-1,rect:l.slice(0),rotation:c,id:u,deleted:!1,popupRef:g}}const n=await super.deserialize(t,s,a);return n.annotationElementId=t.id||null,n._initialData=i,n}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:a}=this;s.updateSVGProperty("stroke-width"),a.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:a}){this._drawingOptions=Y_.getDefaultDrawingOptions({stroke:$.makeHexColor(...t),"stroke-width":s,"stroke-opacity":a})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:a,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:n,"stroke-opacity":r,"stroke-width":l}}=this,c={annotationType:J.INK,color:zt._colorManager.convert(n),opacity:r,thickness:l,paths:{lines:s,points:a},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?c:this.annotationElementId&&!_(this,Uv,X_).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:s,rect:a}=this.serializeDraw(!1);return t.updateEdited({rect:a,thickness:this._drawingOptions["stroke-width"],points:s}),null}};Uv=new WeakSet,X_=function(e){const{color:t,thickness:s,opacity:a,pageIndex:i}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((n,r)=>n!==t[r])||e.thickness!==s||e.opacity!==a||e.pageIndex!==i},X(Xd,"_type","ink"),X(Xd,"_editorType",J.INK),X(Xd,"_defaultDrawingOptions",null);let DN=Xd;var Dt,Ae,Zn,tn,ur,Rc,ti,za,Ps,ku,Mt,Rl,Il,Yd,Hv,vp,Vv,Kd,K_;const Qd=class extends zt{constructor(t){super({...t,name:"stampEditor"}),k(this,Mt),k(this,Dt,null),k(this,Ae,null),k(this,Zn,null),k(this,tn,null),k(this,ur,null),k(this,Rc,""),k(this,ti,null),k(this,za,null),k(this,Ps,!1),k(this,ku,!1),m(this,tn,t.bitmapUrl),m(this,ur,t.bitmapFile)}static initialize(t,s){zt.initialize(t,s)}static get supportedTypes(){return tt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return tt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(J.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:a}=this._uiManager;if(!a)throw new Error("No ML.");if(!await a.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:n,height:r}=t||this.copyCanvas(null,null,!0).imageData,l=await a.guess({name:"altText",request:{data:i,width:n,height:r,channels:i.length/(n*r)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),s&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;o(this,Ae)&&(m(this,Dt,null),this._uiManager.imageManager.deleteId(o(this,Ae)),(t=o(this,ti))==null||t.remove(),m(this,ti,null),o(this,za)&&(clearTimeout(o(this,za)),m(this,za,null))),super.remove()}rebuild(){if(!this.parent){o(this,Ae)&&_(this,Mt,Yd).call(this);return}super.rebuild(),this.div!==null&&(o(this,Ae)&&o(this,ti)===null&&_(this,Mt,Yd).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(o(this,Zn)||o(this,Dt)||o(this,tn)||o(this,ur)||o(this,Ae))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),o(this,Dt)?_(this,Mt,Hv).call(this):_(this,Mt,Yd).call(this),this.width&&!this.annotationElementId){const[a,i]=this.parentDimensions;this.setAt(t*a,s*i,this.width*a,this.height*i)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){this.parent&&(o(this,za)!==null&&clearTimeout(o(this,za)),m(this,za,setTimeout(()=>{m(this,za,null),_(this,Mt,Vv).call(this)},200)))}copyCanvas(t,s,a=!1){var i;t||(t=224);const{width:n,height:r}=o(this,Dt),l=new sy;let c=o(this,Dt),u=n,h=r,d=null;if(s){if(n>s||r>s){const N=Math.min(s/n,s/r);u=Math.floor(n*N),h=Math.floor(r*N)}d=document.createElement("canvas");const g=d.width=Math.ceil(u*l.sx),v=d.height=Math.ceil(h*l.sy);o(this,Ps)||(c=_(this,Mt,vp).call(this,g,v));const y=d.getContext("2d");y.filter=this._uiManager.hcmFilter;let A="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":(i=window.matchMedia)!=null&&i.call(window,"(prefers-color-scheme: dark)").matches&&(A="#8f8f9d",b="#42414d");const x=15,w=x*l.sx,S=x*l.sy,E=new OffscreenCanvas(w*2,S*2),M=E.getContext("2d");M.fillStyle=A,M.fillRect(0,0,w*2,S*2),M.fillStyle=b,M.fillRect(0,0,w,S),M.fillRect(w,S,w,S),y.fillStyle=y.createPattern(E,"repeat"),y.fillRect(0,0,g,v),y.drawImage(c,0,0,c.width,c.height,0,0,g,v)}let f=null;if(a){let g,v;if(l.symmetric&&c.width<t&&c.height<t)g=c.width,v=c.height;else if(c=o(this,Dt),n>t||r>t){const A=Math.min(t/n,t/r);g=Math.floor(n*A),v=Math.floor(r*A),o(this,Ps)||(c=_(this,Mt,vp).call(this,g,v))}const y=new OffscreenCanvas(g,v).getContext("2d",{willReadFrequently:!0});y.drawImage(c,0,0,c.width,c.height,0,0,g,v),f={width:g,height:v,data:y.getImageData(0,0,g,v).data}}return{canvas:d,width:u,height:h,imageData:f}}getImageForAltText(){return o(this,ti)}static async deserialize(t,s,a){var i;let n=null;if(t instanceof p_){const{data:{rect:y,rotation:A,id:b,structParent:x,popupRef:w},container:S,parent:{page:{pageNumber:E}}}=t,M=S.querySelector("canvas"),N=a.imageManager.getFromCanvas(S.id,M);M.remove();const P=((i=await s._structTree.getAriaAttributes(`${Qb}${b}`))==null?void 0:i.get("aria-label"))||"";n=t={annotationType:J.STAMP,bitmapId:N.id,bitmap:N.bitmap,pageIndex:E-1,rect:y.slice(0),rotation:A,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:P},isSvg:!1,structParent:x,popupRef:w}}const r=await super.deserialize(t,s,a),{rect:l,bitmap:c,bitmapUrl:u,bitmapId:h,isSvg:d,accessibilityData:f}=t;h&&a.imageManager.isValidId(h)?(m(r,Ae,h),c&&m(r,Dt,c)):m(r,tn,u),m(r,Ps,d);const[g,v]=r.pageDimensions;return r.width=(l[2]-l[0])/g,r.height=(l[3]-l[1])/v,r.annotationElementId=t.id||null,f&&(r.altTextData=f),r._initialData=n,m(r,ku,!!n),r}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const a={annotationType:J.STAMP,bitmapId:o(this,Ae),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:o(this,Ps),structTreeParentId:this._structTreeParentId};if(t)return a.bitmapUrl=_(this,Mt,Kd).call(this,!0),a.accessibilityData=this.serializeAltText(!0),a;const{decorative:i,altText:n}=this.serializeAltText(!1);if(!i&&n&&(a.accessibilityData={type:"Figure",alt:n}),this.annotationElementId){const l=_(this,Mt,K_).call(this,a);if(l.isSame)return null;l.isSameAltText?delete a.accessibilityData:a.accessibilityData.structParent=this._initialData.structParent??-1}if(a.id=this.annotationElementId,s===null)return a;s.stamps||(s.stamps=new Map);const r=o(this,Ps)?(a.rect[2]-a.rect[0])*(a.rect[3]-a.rect[1]):null;if(!s.stamps.has(o(this,Ae)))s.stamps.set(o(this,Ae),{area:r,serialized:a}),a.bitmap=_(this,Mt,Kd).call(this,!1);else if(o(this,Ps)){const l=s.stamps.get(o(this,Ae));r>l.area&&(l.area=r,l.serialized.bitmap.close(),l.serialized.bitmap=_(this,Mt,Kd).call(this,!1))}return a}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Dt=new WeakMap,Ae=new WeakMap,Zn=new WeakMap,tn=new WeakMap,ur=new WeakMap,Rc=new WeakMap,ti=new WeakMap,za=new WeakMap,Ps=new WeakMap,ku=new WeakMap,Mt=new WeakSet,Rl=function(e,t=!1){if(!e){this.remove();return}m(this,Dt,e.bitmap),t||(m(this,Ae,e.id),m(this,Ps,e.isSvg)),e.file&&m(this,Rc,e.file.name),_(this,Mt,Hv).call(this)},Il=function(){if(m(this,Zn,null),this._uiManager.enableWaiting(!1),!!o(this,ti)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,Dt)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,Dt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Yd=function(){if(o(this,Ae)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(o(this,Ae)).then(s=>_(this,Mt,Rl).call(this,s,!0)).finally(()=>_(this,Mt,Il).call(this));return}if(o(this,tn)){const s=o(this,tn);m(this,tn,null),this._uiManager.enableWaiting(!0),m(this,Zn,this._uiManager.imageManager.getFromUrl(s).then(a=>_(this,Mt,Rl).call(this,a)).finally(()=>_(this,Mt,Il).call(this)));return}if(o(this,ur)){const s=o(this,ur);m(this,ur,null),this._uiManager.enableWaiting(!0),m(this,Zn,this._uiManager.imageManager.getFromFile(s).then(a=>_(this,Mt,Rl).call(this,a)).finally(()=>_(this,Mt,Il).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=Qd.supportedTypesStr;const t=this._uiManager._signal;m(this,Zn,new Promise(s=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),_(this,Mt,Rl).call(this,a)}s()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),s()},{signal:t})}).finally(()=>_(this,Mt,Il).call(this))),e.click()},Hv=function(){var e;const{div:t}=this;let{width:s,height:a}=o(this,Dt);const[i,n]=this.pageDimensions,r=.75;if(this.width)s=this.width*i,a=this.height*n;else if(s>r*i||a>r*n){const h=Math.min(r*i/s,r*n/a);s*=h,a*=h}const[l,c]=this.parentDimensions;this.setDims(s*l/i,a*c/n),this._uiManager.enableWaiting(!1);const u=m(this,ti,document.createElement("canvas"));u.setAttribute("role","img"),this.addContainer(u),this.width=s/i,this.height=a/n,(e=this._initialOptions)!=null&&e.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),_(this,Mt,Vv).call(this),o(this,ku)||(this.parent.addUndoableEditor(this),m(this,ku,!0)),this._reportTelemetry({action:"inserted_image"}),o(this,Rc)&&u.setAttribute("aria-label",o(this,Rc))},vp=function(e,t){const{width:s,height:a}=o(this,Dt);let i=s,n=a,r=o(this,Dt);for(;i>2*e||n>2*t;){const l=i,c=n;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),n>2*t&&(n=n>=16384?Math.floor(n/2)-1:Math.ceil(n/2));const u=new OffscreenCanvas(i,n);u.getContext("2d").drawImage(r,0,0,l,c,0,0,i,n),r=u.transferToImageBitmap()}return r},Vv=function(){const[e,t]=this.parentDimensions,{width:s,height:a}=this,i=new sy,n=Math.ceil(s*e*i.sx),r=Math.ceil(a*t*i.sy),l=o(this,ti);if(!l||l.width===n&&l.height===r)return;l.width=n,l.height=r;const c=o(this,Ps)?o(this,Dt):_(this,Mt,vp).call(this,n,r),u=l.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(c,0,0,c.width,c.height,0,0,n,r)},Kd=function(e){if(e){if(o(this,Ps)){const s=this._uiManager.imageManager.getSvgUrl(o(this,Ae));if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=o(this,Dt),t.getContext("2d").drawImage(o(this,Dt),0,0),t.toDataURL()}if(o(this,Ps)){const[t,s]=this.pageDimensions,a=Math.round(this.width*t*fl.PDF_TO_CSS_UNITS),i=Math.round(this.height*s*fl.PDF_TO_CSS_UNITS),n=new OffscreenCanvas(a,i);return n.getContext("2d").drawImage(o(this,Dt),0,0,o(this,Dt).width,o(this,Dt).height,0,0,a,i),n.transferToImageBitmap()}return structuredClone(o(this,Dt))},K_=function(e){var t;const{pageIndex:s,accessibilityData:{altText:a}}=this._initialData,i=e.pageIndex===s,n=(((t=e.accessibilityData)==null?void 0:t.alt)||"")===a;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&n,isSameAltText:n}},X(Qd,"_type","stamp"),X(Qd,"_editorType",J.STAMP);let jN=Qd;var uo,Ic,$a,Bn,Si,Vs,Un,Dc,ho,oa,Ei,Fe,Ci,z,hr,qt,Q_,da,Gv,qv,Jd;const Zd=class Hn{constructor({uiManager:t,pageIndex:s,div:a,structTreeLayer:i,accessibilityManager:n,annotationLayer:r,drawLayer:l,textLayer:c,viewport:u,l10n:h}){k(this,qt),k(this,uo),k(this,Ic,!1),k(this,$a,null),k(this,Bn,null),k(this,Si,null),k(this,Vs,new Map),k(this,Un,!1),k(this,Dc,!1),k(this,ho,!1),k(this,oa,null),k(this,Ei,null),k(this,Fe,null),k(this,Ci,null),k(this,z);const d=[...o(Hn,hr).values()];if(!Hn._initialized){Hn._initialized=!0;for(const f of d)f.initialize(h,t)}t.registerEditorTypes(d),m(this,z,t),this.pageIndex=s,this.div=a,m(this,uo,n),m(this,$a,r),this.viewport=u,m(this,Fe,c),this.drawLayer=l,this._structTree=i,o(this,z).addLayer(this)}get isEmpty(){return o(this,Vs).size===0}get isInvisible(){return this.isEmpty&&o(this,z).getMode()===J.NONE}updateToolbar(t){o(this,z).updateToolbar(t)}updateMode(t=o(this,z).getMode()){switch(_(this,qt,Jd).call(this),t){case J.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case J.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case J.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:s}=this.div;for(const a of o(Hn,hr).values())s.toggle(`${a._type}Editing`,t===a._editorType);this.div.hidden=!1}hasTextLayer(t){var s;return t===((s=o(this,Fe))==null?void 0:s.div)}setEditingState(t){o(this,z).setEditingState(t)}addCommands(t){o(this,z).addCommands(t)}cleanUndoStack(t){o(this,z).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var s;(s=o(this,$a))==null||s.div.classList.toggle("disabled",!t)}async enable(){m(this,ho,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const a of o(this,Vs).values())a.enableEditing(),a.show(!0),a.annotationElementId&&(o(this,z).removeChangedExistingAnnotation(a),t.add(a.annotationElementId));if(!o(this,$a)){m(this,ho,!1);return}const s=o(this,$a).getEditableAnnotations();for(const a of s){if(a.hide(),o(this,z).isDeletedAnnotationElement(a.data.id)||t.has(a.data.id))continue;const i=await this.deserialize(a);i&&(this.addOrRebuild(i),i.enableEditing())}m(this,ho,!1)}disable(){var t;m(this,Dc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const s=new Map,a=new Map;for(const n of o(this,Vs).values())if(n.disableEditing(),!!n.annotationElementId){if(n.serialize()!==null){s.set(n.annotationElementId,n);continue}else a.set(n.annotationElementId,n);(t=this.getEditableAnnotation(n.annotationElementId))==null||t.show(),n.remove()}if(o(this,$a)){const n=o(this,$a).getEditableAnnotations();for(const r of n){const{id:l}=r.data;if(o(this,z).isDeletedAnnotationElement(l))continue;let c=a.get(l);if(c){c.resetAnnotationElement(r),c.show(!1),r.show();continue}c=s.get(l),c&&(o(this,z).addChangedExistingAnnotation(c),c.renderAnnotationElement(r)&&c.show(!1)),r.show()}}_(this,qt,Jd).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const n of o(Hn,hr).values())i.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,Dc,!1)}getEditableAnnotation(t){var s;return((s=o(this,$a))==null?void 0:s.getEditableAnnotation(t))||null}setActiveEditor(t){o(this,z).getActive()!==t&&o(this,z).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=o(this,Fe))!=null&&t.div&&!o(this,Ci)){m(this,Ci,new AbortController);const s=o(this,z).combinedSignal(o(this,Ci));o(this,Fe).div.addEventListener("pointerdown",_(this,qt,Q_).bind(this),{signal:s}),o(this,Fe).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=o(this,Fe))!=null&&t.div&&o(this,Ci)&&(o(this,Ci).abort(),m(this,Ci,null),o(this,Fe).div.classList.remove("highlighting"))}enableClick(){if(o(this,Bn))return;m(this,Bn,new AbortController);const t=o(this,z).combinedSignal(o(this,Bn));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const s=this.pointerup.bind(this);this.div.addEventListener("pointerup",s,{signal:t}),this.div.addEventListener("pointercancel",s,{signal:t})}disableClick(){var t;(t=o(this,Bn))==null||t.abort(),m(this,Bn,null)}attach(t){o(this,Vs).set(t.id,t);const{annotationElementId:s}=t;s&&o(this,z).isDeletedAnnotationElement(s)&&o(this,z).removeDeletedAnnotationElement(t)}detach(t){var s;o(this,Vs).delete(t.id),(s=o(this,uo))==null||s.removePointerInTextLayer(t.contentDiv),!o(this,Dc)&&t.annotationElementId&&o(this,z).addDeletedAnnotationElement(t)}remove(t){this.detach(t),o(this,z).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var s;t.parent!==this&&(t.parent&&t.annotationElementId&&(o(this,z).addDeletedAnnotationElement(t.annotationElementId),zt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(s=t.parent)==null||s.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),o(this,z).addEditor(t),this.attach(t),!t.isAttachedToDOM){const s=t.render();this.div.append(s),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!o(this,ho)),o(this,z).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var s;if(!t.isAttachedToDOM)return;const{activeElement:a}=document;t.div.contains(a)&&!o(this,Si)&&(t._focusEventsAllowed=!1,m(this,Si,setTimeout(()=>{m(this,Si,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:o(this,z)._signal}),a.focus())},0))),t._structTreeParentId=(s=o(this,uo))==null?void 0:s.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const s=()=>t._uiManager.rebuild(t),a=()=>{t.remove()};this.addCommands({cmd:s,undo:a,mustExec:!1})}getNextId(){return o(this,z).getId()}combinedSignal(t){return o(this,z).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=o(this,qt,da))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,s){o(this,z).updateToolbar(t),o(this,z).updateMode(t);const{offsetX:a,offsetY:i}=_(this,qt,qv).call(this),n=this.getNextId(),r=_(this,qt,Gv).call(this,{parent:this,id:n,x:a,y:i,uiManager:o(this,z),isCentered:!0,...s});r&&this.add(r)}async deserialize(t){var s;return await((s=o(Hn,hr).get(t.annotationType??t.annotationEditorType))==null?void 0:s.deserialize(t,this,o(this,z)))||null}createAndAddNewEditor(t,s,a={}){const i=this.getNextId(),n=_(this,qt,Gv).call(this,{parent:this,id:i,x:t.offsetX,y:t.offsetY,uiManager:o(this,z),isCentered:s,...a});return n&&this.add(n),n}addNewEditor(){this.createAndAddNewEditor(_(this,qt,qv).call(this),!0)}setSelected(t){o(this,z).setSelected(t)}toggleSelected(t){o(this,z).toggleSelected(t)}unselect(t){o(this,z).unselect(t)}pointerup(t){var s;const{isMac:a}=We.platform;if(!(t.button!==0||t.ctrlKey&&a)&&t.target===this.div&&o(this,Un)&&(m(this,Un,!1),!((s=o(this,qt,da))!=null&&s.isDrawer&&o(this,qt,da).supportMultipleDrawings))){if(!o(this,Ic)){m(this,Ic,!0);return}if(o(this,z).getMode()===J.STAMP){o(this,z).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){var s;if(o(this,z).getMode()===J.HIGHLIGHT&&this.enableTextSelection(),o(this,Un)){m(this,Un,!1);return}const{isMac:a}=We.platform;if(t.button!==0||t.ctrlKey&&a||t.target!==this.div)return;if(m(this,Un,!0),(s=o(this,qt,da))!=null&&s.isDrawer){this.startDrawingSession(t);return}const i=o(this,z).getActive();m(this,Ic,!i||i.isEmpty())}startDrawingSession(t){if(this.div.focus(),o(this,oa)){o(this,qt,da).startDrawing(this,o(this,z),!1,t);return}o(this,z).setCurrentDrawingSession(this),m(this,oa,new AbortController);const s=o(this,z).combinedSignal(o(this,oa));this.div.addEventListener("blur",({relatedTarget:a})=>{a&&!this.div.contains(a)&&(m(this,Ei,null),this.commitOrRemove())},{signal:s}),o(this,qt,da).startDrawing(this,o(this,z),!1,t)}pause(t){if(t){const{activeElement:s}=document;this.div.contains(s)&&m(this,Ei,s);return}o(this,Ei)&&setTimeout(()=>{var s;(s=o(this,Ei))==null||s.focus(),m(this,Ei,null)},0)}endDrawingSession(t=!1){return o(this,oa)?(o(this,z).setCurrentDrawingSession(null),o(this,oa).abort(),m(this,oa,null),m(this,Ei,null),o(this,qt,da).endDrawing(t)):null}findNewParent(t,s,a){const i=o(this,z).findParent(s,a);return i===null||i===this?!1:(i.changeParent(t),!0)}commitOrRemove(){return o(this,oa)?(this.endDrawingSession(),!0):!1}onScaleChanging(){o(this,oa)&&o(this,qt,da).onScaleChangingWhenDrawing(this)}destroy(){var t,s;this.commitOrRemove(),((t=o(this,z).getActive())==null?void 0:t.parent)===this&&(o(this,z).commitOrRemove(),o(this,z).setActiveEditor(null)),o(this,Si)&&(clearTimeout(o(this,Si)),m(this,Si,null));for(const a of o(this,Vs).values())(s=o(this,uo))==null||s.removePointerInTextLayer(a.contentDiv),a.setParent(null),a.isAttachedToDOM=!1,a.div.remove();this.div=null,o(this,Vs).clear(),o(this,z).removeLayer(this)}render({viewport:t}){this.viewport=t,yr(this.div,t);for(const s of o(this,z).getEditors(this.pageIndex))this.add(s),s.rebuild();this.updateMode()}update({viewport:t}){o(this,z).commitOrRemove(),_(this,qt,Jd).call(this);const s=this.viewport.rotation,a=t.rotation;if(this.viewport=t,yr(this.div,{rotation:a}),s!==a)for(const i of o(this,Vs).values())i.rotate(a)}get pageDimensions(){const{pageWidth:t,pageHeight:s}=this.viewport.rawDims;return[t,s]}get scale(){return o(this,z).viewParameters.realScale}};uo=new WeakMap,Ic=new WeakMap,$a=new WeakMap,Bn=new WeakMap,Si=new WeakMap,Vs=new WeakMap,Un=new WeakMap,Dc=new WeakMap,ho=new WeakMap,oa=new WeakMap,Ei=new WeakMap,Fe=new WeakMap,Ci=new WeakMap,z=new WeakMap,hr=new WeakMap,qt=new WeakSet,Q_=function(e){o(this,z).unselectAll();const{target:t}=e;if(t===o(this,Fe).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&o(this,Fe).div.contains(t)){const{isMac:s}=We.platform;if(e.button!==0||e.ctrlKey&&s)return;o(this,z).showAllEditors("highlight",!0,!0),o(this,Fe).div.classList.add("free"),this.toggleDrawing(),c0.startHighlighting(this,o(this,z).direction==="ltr",{target:o(this,Fe).div,x:e.x,y:e.y}),o(this,Fe).div.addEventListener("pointerup",()=>{o(this,Fe).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:o(this,z)._signal}),e.preventDefault()}},da=function(){return o(Zd,hr).get(o(this,z).getMode())},Gv=function(e){const t=o(this,qt,da);return t?new t.prototype.constructor(e):null},qv=function(){const{x:e,y:t,width:s,height:a}=this.div.getBoundingClientRect(),i=Math.max(0,e),n=Math.max(0,t),r=Math.min(window.innerWidth,e+s),l=Math.min(window.innerHeight,t+a),c=(i+r)/2-e,u=(n+l)/2-t,[h,d]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:h,offsetY:d}},Jd=function(){for(const e of o(this,Vs).values())e.isEmpty()&&e.remove()},X(Zd,"_initialized",!1),k(Zd,hr,new Map([EN,DN,jN,c0].map(e=>[e._editorType,e])));let FN=Zd;var fa,tf,Ge,fo,Xv,J_,Vn,Yv,Z_,Kv;const jc=class Us{constructor({pageIndex:t}){k(this,Vn),k(this,fa,null),k(this,tf,0),k(this,Ge,new Map),k(this,fo,new Map),this.pageIndex=t}setParent(t){if(!o(this,fa)){m(this,fa,t);return}if(o(this,fa)!==t){if(o(this,Ge).size>0)for(const s of o(this,Ge).values())s.remove(),t.append(s);m(this,fa,t)}}static get _svgFactory(){return tt(this,"_svgFactory",new ny)}draw(t,s=!1,a=!1){const i=Je(this,tf)._++,n=_(this,Vn,Yv).call(this),r=Us._svgFactory.createElement("defs");n.append(r);const l=Us._svgFactory.createElement("path");r.append(l);const c=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),s&&o(this,fo).set(i,l);const u=a?_(this,Vn,Z_).call(this,r,c):null,h=Us._svgFactory.createElement("use");return n.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(n,t),o(this,Ge).set(i,n),{id:i,clipPathId:`url(#${u})`}}drawOutline(t,s){const a=Je(this,tf)._++,i=_(this,Vn,Yv).call(this),n=Us._svgFactory.createElement("defs");i.append(n);const r=Us._svgFactory.createElement("path");n.append(r);const l=`path_p${this.pageIndex}_${a}`;r.setAttribute("id",l),r.setAttribute("vector-effect","non-scaling-stroke");let c;if(s){const d=Us._svgFactory.createElement("mask");n.append(d),c=`mask_p${this.pageIndex}_${a}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=Us._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const g=Us._svgFactory.createElement("use");d.append(g),g.setAttribute("href",`#${l}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const u=Us._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${l}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return i.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(i,t),o(this,Ge).set(a,i),a}finalizeDraw(t,s){o(this,fo).delete(t),this.updateProperties(t,s)}updateProperties(t,s){var a;if(!s)return;const{root:i,bbox:n,rootClass:r,path:l}=s,c=typeof t=="number"?o(this,Ge).get(t):t;if(c){if(i&&_(this,Vn,Kv).call(this,c,i),n&&_(a=Us,Xv,J_).call(a,c,n),r){const{classList:u}=c;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(l){const u=c.firstChild.firstChild;_(this,Vn,Kv).call(this,u,l)}}}updateParent(t,s){if(s===this)return;const a=o(this,Ge).get(t);a&&(o(s,fa).append(a),o(this,Ge).delete(t),o(s,Ge).set(t,a))}remove(t){o(this,fo).delete(t),o(this,fa)!==null&&(o(this,Ge).get(t).remove(),o(this,Ge).delete(t))}destroy(){m(this,fa,null);for(const t of o(this,Ge).values())t.remove();o(this,Ge).clear(),o(this,fo).clear()}};fa=new WeakMap,tf=new WeakMap,Ge=new WeakMap,fo=new WeakMap,Xv=new WeakSet,J_=function(e,[t,s,a,i]){const{style:n}=e;n.top=`${100*s}%`,n.left=`${100*t}%`,n.width=`${100*a}%`,n.height=`${100*i}%`},Vn=new WeakSet,Yv=function(){const e=jc._svgFactory.create(1,1,!0);return o(this,fa).append(e),e.setAttribute("aria-hidden",!0),e},Z_=function(e,t){const s=jc._svgFactory.createElement("clipPath");e.append(s);const a=`clip_${t}`;s.setAttribute("id",a),s.setAttribute("clipPathUnits","objectBoundingBox");const i=jc._svgFactory.createElement("use");return s.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),a},Kv=function(e,t){for(const[s,a]of Object.entries(t))a===null?e.removeAttribute(s):e.setAttribute(s,a)},k(jc,Xv);let ON=jc;globalThis.pdfjsTestingUtils={HighlightOutliner:Iv};K.AbortException;K.AnnotationEditorLayer;K.AnnotationEditorParamsType;K.AnnotationEditorType;K.AnnotationEditorUIManager;K.AnnotationLayer;K.AnnotationMode;K.ColorPicker;K.DOMSVGFactory;K.DrawLayer;K.FeatureTest;var WN=K.GlobalWorkerOptions;K.ImageKind;K.InvalidPDFException;K.MissingPDFException;K.OPS;K.OutputScale;K.PDFDataRangeTransport;K.PDFDateString;K.PDFWorker;K.PasswordResponses;K.PermissionFlag;K.PixelsPerInch;K.RenderingCancelledException;K.TextLayer;K.TouchManager;K.UnexpectedResponseException;K.Util;K.VerbosityLevel;K.XfaLayer;K.build;K.createValidAbsoluteUrl;K.fetchData;var zN=K.getDocument;K.getFilenameFromUrl;K.getPdfFilenameFromUrl;K.getXfaPageViewport;K.isDataScheme;K.isPdfFile;K.noContextMenu;K.normalizeUnicode;K.setLayerDimensions;K.shadow;K.stopEvent;K.version;const $N="/assets/pdf.worker.min-yatZIOMy.mjs";WN.workerSrc=$N;function BN(){const{id:e}=hC(),{user:t}=Fs(),s=Sr(),a=C.useRef(null),i=C.useRef(null),n=C.useRef(null),[r,l]=C.useState(null),[c,u]=C.useState(1),[h,d]=C.useState(0),[f,g]=C.useState(1.2),[v,y]=C.useState(!0),[A,b]=C.useState(""),[x,w]=C.useState(null),[S,E]=C.useState([]),[M,N]=C.useState(!1),[P,T]=C.useState(20),[I,V]=C.useState(!1);C.useEffect(()=>{rt();const B=j=>j.preventDefault();document.addEventListener("contextmenu",B);const L=j=>{j.key==="ArrowLeft"?u(D=>Math.max(1,D-1)):j.key==="ArrowRight"?u(D=>Math.min(h||1,D+1)):j.key==="-"||j.key==="_"?g(D=>Math.max(.5,D-.2)):(j.key==="+"||j.key==="=")&&g(D=>Math.min(3,D+.2))};return document.addEventListener("keydown",L),ct.logEvent("document_view","document",e),()=>{document.removeEventListener("contextmenu",B),document.removeEventListener("keydown",L),x&&ct.post(`/documents/view/${x}/end`,{pages_viewed:S})}},[e,h]),C.useEffect(()=>{r&&I&&ut()},[r,c,f,I]);const rt=async()=>{var B;try{try{const wt={Authorization:`Bearer ${localStorage.getItem("access_token")}`},ae=localStorage.getItem("desktop_session");ae&&(wt["X-Desktop-Session"]=ae);const dt=await fetch("/api/v1/system/logo",{headers:wt});if(dt.ok){const at=await dt.blob(),Te=URL.createObjectURL(at),me=document.createElement("img");me.src=Te,await new Promise((gs,ui)=>{me.onload=gs,me.onerror=ui}),n.current=me,N(!0),console.log("Custom logo loaded successfully")}}catch(wt){console.log("No custom logo found, using default text",wt)}try{const wt={Authorization:`Bearer ${localStorage.getItem("access_token")}`},ae=localStorage.getItem("desktop_session");ae&&(wt["X-Desktop-Session"]=ae);const dt=await fetch("/api/v1/system/config",{headers:wt});if(dt.ok){const at=await dt.json(),Te=parseInt(((B=at.config)==null?void 0:B.watermark_opacity)||"20",10);T(Te),console.log("Watermark opacity loaded:",Te)}}catch(wt){console.log("Failed to load opacity setting, using default",wt)}V(!0);const L={Authorization:`Bearer ${localStorage.getItem("access_token")}`,"X-Device-ID":localStorage.getItem("device_id")||""},j=localStorage.getItem("desktop_session");j&&(L["X-Desktop-Session"]=j);const D=await fetch(`/api/v1/documents/${e}/view`,{headers:L,credentials:"include"});if(!D.ok)throw new Error("Failed to load document");const Y=D.headers.get("X-View-ID");Y&&w(Y);const Q=await(await D.blob()).arrayBuffer(),ft=await zN({data:Q}).promise;l(ft),d(ft.numPages),y(!1)}catch(L){b(L instanceof Error?L.message:"Failed to load document"),y(!1)}},ut=async()=>{if(!r||!a.current)return;const B=await r.getPage(c),L=window.devicePixelRatio||1,j=B.getViewport({scale:f*L}),D=a.current,Y=D.getContext("2d");D.height=j.height,D.width=j.width,D.style.width=`${j.width/L}px`,D.style.height=`${j.height/L}px`,Y.save(),Y.setTransform(1,0,0,1,0,0),Y.globalCompositeOperation="source-over",Y.globalAlpha=1,Y.clearRect(0,0,D.width,D.height),Y.restore(),await B.render({canvasContext:Y,viewport:j}).promise,ht(Y,D.width,D.height,L),S.includes(c)||(E(Q=>[...Q,c]),x&&ct.post(`/documents/view/${x}/page/${c}`,{}))},ht=(B,L,j,D=1)=>{const Y=localStorage.getItem("client_ip")||"Local",Q=new Date,ft=Q.toLocaleDateString()+" "+Q.toLocaleTimeString();B.save(),B.globalCompositeOperation="multiply",B.globalAlpha=P/100,B.textAlign="center";const wt=-35*Math.PI/180;B.rotate(wt);const ae=450*D,dt=300*D,at=120*D,Te=50*D;for(let me=-L;me<L*2;me+=ae)for(let gs=-j;gs<j*2;gs+=dt){let ui=0;n.current?(B.drawImage(n.current,me-at/2,gs-Te/2,at,Te),ui=Te/2+15*D):(B.fillStyle="#0066CC",B.font=`bold ${28*D}px Arial, sans-serif`,B.fillText(" SRAMS",me,gs),ui=30*D),B.fillStyle="#333333",B.font=`bold ${16*D}px Arial, sans-serif`,B.fillText((t==null?void 0:t.full_name)||"User",me,gs+ui),B.fillStyle="#666666",B.font=`${14*D}px Arial, sans-serif`,B.fillText(`IP: ${Y}`,me,gs+ui+20*D),B.fillText(ft,me,gs+ui+40*D),B.fillStyle="#CC0000",B.font=`bold ${12*D}px Arial, sans-serif`,B.fillText(" CONFIDENTIAL - DO NOT COPY",me,gs+ui+65*D)}B.restore()},G=B=>{B>=1&&B<=h&&u(B)},F=B=>{g(L=>Math.max(.5,Math.min(3,L+B)))};return v?p.jsxs("div",{className:"viewer-loading",children:[p.jsx("div",{className:"loading-spinner"}),p.jsx("p",{children:"Loading document..."})]}):A?p.jsxs("div",{className:"viewer-error",children:[p.jsx("p",{children:A}),p.jsx("button",{className:"btn btn-primary",onClick:()=>s("/documents"),children:"Back to Documents"})]}):p.jsxs("div",{className:"document-viewer",ref:i,children:[p.jsxs("div",{className:"viewer-toolbar glass",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>s("/documents"),children:p.jsx(ZC,{size:20})}),p.jsx("div",{className:"toolbar-separator"}),p.jsxs("div",{className:"page-controls",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>G(c-1),disabled:c<=1,children:p.jsx(eM,{size:20})}),p.jsxs("span",{className:"page-indicator",children:[c," / ",h]}),p.jsx("button",{className:"toolbar-btn",onClick:()=>G(c+1),disabled:c>=h,children:p.jsx(sM,{size:20})})]}),p.jsx("div",{className:"toolbar-separator"}),p.jsxs("div",{className:"zoom-controls",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>F(-.2),children:p.jsx(fM,{size:20})}),p.jsxs("span",{className:"zoom-indicator",children:[Math.round(f*100),"%"]}),p.jsx("button",{className:"toolbar-btn",onClick:()=>F(.2),children:p.jsx(dM,{size:20})})]})]}),p.jsx("div",{className:"canvas-container",children:p.jsx("canvas",{ref:a,className:"pdf-canvas"})}),p.jsx("div",{className:"security-overlay"})]})}function UN(){const{user:e}=Fs(),[t,s]=C.useState([]),[a,i]=C.useState(!0),[n,r]=C.useState(""),[l,c]=C.useState(""),[u,h]=C.useState(!1),[d,f]=C.useState(null),g=(e==null?void 0:e.role)==="super_admin",v=(e==null?void 0:e.role)==="admin";C.useEffect(()=>{y()},[l]);const y=async()=>{try{const S=l?`?role=${l}`:"",E=await ct.get(`/users${S}`);s(E.data.users||[])}catch(S){console.error("Failed to load users:",S)}finally{i(!1)}},A=async S=>{if(confirm(`Are you sure you want to delete ${S.full_name}?`))try{await ct.delete(`/users/${S.id}`),y()}catch(E){alert(E instanceof Error?E.message:"Failed to delete user")}},b=t.filter(S=>!(!g&&S.role==="super_admin")).filter(S=>S.full_name.toLowerCase().includes(n.toLowerCase())||S.email.toLowerCase().includes(n.toLowerCase())),x=S=>!(S.id===(e==null?void 0:e.id)||!g&&S.role==="super_admin"),w=S=>!(S.id===(e==null?void 0:e.id)||S.role==="super_admin"||v&&!g&&S.role==="admin");return a?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"users-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Users"}),p.jsx("p",{children:"Manage system users and their roles"})]}),p.jsxs("button",{className:"btn btn-primary",onClick:()=>{f(null),h(!0)},children:[p.jsx(Q1,{size:18}),"Add User"]})]}),p.jsxs("div",{className:"filters glass-card",children:[p.jsxs("div",{className:"search-input",children:[p.jsx(J1,{size:20}),p.jsx("input",{type:"text",placeholder:"Search users...",value:n,onChange:S=>r(S.target.value)})]}),p.jsxs("select",{className:"input",value:l,onChange:S=>c(S.target.value),children:[p.jsx("option",{value:"",children:"All Roles"}),p.jsx("option",{value:"user",children:"Users"}),p.jsx("option",{value:"admin",children:"Admins"}),g&&p.jsx("option",{value:"super_admin",children:"Super Admins"})]})]}),p.jsxs("div",{className:"table-container glass-card",children:[p.jsxs("table",{className:"table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Name"}),p.jsx("th",{children:"Email"}),p.jsx("th",{children:"Role"}),p.jsx("th",{children:"Status"}),p.jsx("th",{children:"Last Login"}),p.jsx("th",{children:"Actions"})]})}),p.jsx("tbody",{children:b.map(S=>p.jsxs("tr",{children:[p.jsx("td",{children:p.jsxs("div",{className:"user-cell",children:[p.jsx("div",{className:"user-avatar",children:S.full_name.charAt(0).toUpperCase()}),p.jsx("span",{children:S.full_name})]})}),p.jsx("td",{children:S.email}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${GN(S.role)}`,children:VN(S.role)})}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${S.is_active?"success":"error"}`,children:S.is_active?"Active":"Inactive"})}),p.jsx("td",{children:S.last_login?new Date(S.last_login).toLocaleDateString():"Never"}),p.jsx("td",{children:p.jsxs("div",{className:"action-buttons",children:[x(S)&&p.jsx("button",{className:"action-btn",onClick:()=>{f(S),h(!0)},children:p.jsx(oM,{size:16})}),w(S)&&p.jsx("button",{className:"action-btn danger",onClick:()=>A(S),children:p.jsx(Yb,{size:16})})]})})]},S.id))})]}),b.length===0&&p.jsxs("div",{className:"empty-state",children:[p.jsx(dl,{size:48}),p.jsx("p",{children:"No users found"})]})]}),u&&p.jsx(HN,{user:d,isSuperAdmin:g,onClose:()=>h(!1),onSuccess:()=>{h(!1),y()}})]})}function HN({user:e,isSuperAdmin:t,onClose:s,onSuccess:a}){const[i,n]=C.useState({email:(e==null?void 0:e.email)||"",password:"",full_name:(e==null?void 0:e.full_name)||"",mobile:(e==null?void 0:e.mobile)||"",role:(e==null?void 0:e.role)||"user",is_active:(e==null?void 0:e.is_active)??!0}),[r,l]=C.useState(!1),[c,u]=C.useState(""),h=async d=>{d.preventDefault(),l(!0),u("");try{e?await ct.put(`/users/${e.id}`,{full_name:i.full_name,mobile:i.mobile,role:t?i.role:void 0,is_active:i.is_active}):await ct.post("/users",i),a()}catch(f){u(f instanceof Error?f.message:"Failed to save user")}finally{l(!1)}};return p.jsx("div",{className:"modal-overlay",onClick:s,children:p.jsxs("div",{className:"modal glass-card",onClick:d=>d.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:e?"Edit User":"Add User"}),p.jsx("button",{className:"close-btn",onClick:s,children:p.jsx(yl,{size:24})})]}),p.jsxs("form",{onSubmit:h,className:"modal-body",children:[c&&p.jsx("div",{className:"error-message",children:c}),!e&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Email"}),p.jsx("input",{type:"email",className:"input",value:i.email,onChange:d=>n({...i,email:d.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Password"}),p.jsx("input",{type:"password",className:"input",value:i.password,onChange:d=>n({...i,password:d.target.value}),required:!0,minLength:8})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Full Name"}),p.jsx("input",{type:"text",className:"input",value:i.full_name,onChange:d=>n({...i,full_name:d.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Mobile"}),p.jsx("input",{type:"tel",className:"input",value:i.mobile,onChange:d=>n({...i,mobile:d.target.value})})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Role"}),p.jsxs("select",{className:"input",value:i.role,onChange:d=>n({...i,role:d.target.value}),disabled:!t||(e==null?void 0:e.role)==="super_admin",children:[p.jsx("option",{value:"user",children:"User"}),p.jsx("option",{value:"admin",children:"Admin"})]})]}),e&&p.jsx("div",{className:"input-group",children:p.jsxs("label",{className:"checkbox-label",children:[p.jsx("input",{type:"checkbox",checked:i.is_active,onChange:d=>n({...i,is_active:d.target.checked})}),p.jsx("span",{children:"Active"})]})}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:s,children:"Cancel"}),p.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?"Saving...":"Save"})]})]})]})})}function VN(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function GN(e){switch(e){case"super_admin":return"error";case"admin":return"warning";default:return"info"}}function ea(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function xr(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const tA=6048e5,qN=864e5;let XN={};function Gp(){return XN}function Vu(e,t){var s,a,i,n;const r=Gp(),l=(t==null?void 0:t.weekStartsOn)??((a=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:a.weekStartsOn)??r.weekStartsOn??((n=(i=r.locale)==null?void 0:i.options)==null?void 0:n.weekStartsOn)??0,c=ea(e),u=c.getDay(),h=(u<l?7:0)+u-l;return c.setDate(c.getDate()-h),c.setHours(0,0,0,0),c}function bp(e){return Vu(e,{weekStartsOn:1})}function eA(e){const t=ea(e),s=t.getFullYear(),a=xr(e,0);a.setFullYear(s+1,0,4),a.setHours(0,0,0,0);const i=bp(a),n=xr(e,0);n.setFullYear(s,0,4),n.setHours(0,0,0,0);const r=bp(n);return t.getTime()>=i.getTime()?s+1:t.getTime()>=r.getTime()?s:s-1}function h0(e){const t=ea(e);return t.setHours(0,0,0,0),t}function d0(e){const t=ea(e),s=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return s.setUTCFullYear(t.getFullYear()),+e-+s}function YN(e,t){const s=h0(e),a=h0(t),i=+s-d0(s),n=+a-d0(a);return Math.round((i-n)/qN)}function KN(e){const t=eA(e),s=xr(e,0);return s.setFullYear(t,0,4),s.setHours(0,0,0,0),bp(s)}function QN(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function JN(e){if(!QN(e)&&typeof e!="number")return!1;const t=ea(e);return!isNaN(Number(t))}function ZN(e){const t=ea(e),s=xr(e,0);return s.setFullYear(t.getFullYear(),0,1),s.setHours(0,0,0,0),s}const tP={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},eP=(e,t,s)=>{let a;const i=tP[e];return typeof i=="string"?a=i:t===1?a=i.one:a=i.other.replace("{{count}}",t.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};function Ig(e){return(t={})=>{const s=t.width?String(t.width):e.defaultWidth;return e.formats[s]||e.formats[e.defaultWidth]}}const sP={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},aP={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},iP={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},nP={date:Ig({formats:sP,defaultWidth:"full"}),time:Ig({formats:aP,defaultWidth:"full"}),dateTime:Ig({formats:iP,defaultWidth:"full"})},rP={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},oP=(e,t,s,a)=>rP[e];function Dl(e){return(t,s)=>{const a=s!=null&&s.context?String(s.context):"standalone";let i;if(a==="formatting"&&e.formattingValues){const r=e.defaultFormattingWidth||e.defaultWidth,l=s!=null&&s.width?String(s.width):r;i=e.formattingValues[l]||e.formattingValues[r]}else{const r=e.defaultWidth,l=s!=null&&s.width?String(s.width):e.defaultWidth;i=e.values[l]||e.values[r]}const n=e.argumentCallback?e.argumentCallback(t):t;return i[n]}}const lP={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cP={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},uP={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},hP={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},fP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},pP=(e,t)=>{const s=Number(e),a=s%100;if(a>20||a<10)switch(a%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},gP={ordinalNumber:pP,era:Dl({values:lP,defaultWidth:"wide"}),quarter:Dl({values:cP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Dl({values:uP,defaultWidth:"wide"}),day:Dl({values:hP,defaultWidth:"wide"}),dayPeriod:Dl({values:dP,defaultWidth:"wide",formattingValues:fP,defaultFormattingWidth:"wide"})};function jl(e){return(t,s={})=>{const a=s.width,i=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],n=t.match(i);if(!n)return null;const r=n[0],l=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?vP(l,d=>d.test(r)):mP(l,d=>d.test(r));let u;u=e.valueCallback?e.valueCallback(c):c,u=s.valueCallback?s.valueCallback(u):u;const h=t.slice(r.length);return{value:u,rest:h}}}function mP(e,t){for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&t(e[s]))return s}function vP(e,t){for(let s=0;s<e.length;s++)if(t(e[s]))return s}function bP(e){return(t,s={})=>{const a=t.match(e.matchPattern);if(!a)return null;const i=a[0],n=t.match(e.parsePattern);if(!n)return null;let r=e.valueCallback?e.valueCallback(n[0]):n[0];r=s.valueCallback?s.valueCallback(r):r;const l=t.slice(i.length);return{value:r,rest:l}}}const yP=/^(\d+)(th|st|nd|rd)?/i,wP=/\d+/i,xP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},kP={any:[/^b/i,/^(a|c)/i]},_P={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},AP={any:[/1/i,/2/i,/3/i,/4/i]},SP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},EP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},CP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},MP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},NP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},PP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},TP={ordinalNumber:bP({matchPattern:yP,parsePattern:wP,valueCallback:e=>parseInt(e,10)}),era:jl({matchPatterns:xP,defaultMatchWidth:"wide",parsePatterns:kP,defaultParseWidth:"any"}),quarter:jl({matchPatterns:_P,defaultMatchWidth:"wide",parsePatterns:AP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:jl({matchPatterns:SP,defaultMatchWidth:"wide",parsePatterns:EP,defaultParseWidth:"any"}),day:jl({matchPatterns:CP,defaultMatchWidth:"wide",parsePatterns:MP,defaultParseWidth:"any"}),dayPeriod:jl({matchPatterns:NP,defaultMatchWidth:"any",parsePatterns:PP,defaultParseWidth:"any"})},LP={code:"en-US",formatDistance:eP,formatLong:nP,formatRelative:oP,localize:gP,match:TP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function RP(e){const t=ea(e);return YN(t,ZN(t))+1}function IP(e){const t=ea(e),s=+bp(t)-+KN(t);return Math.round(s/tA)+1}function sA(e,t){var s,a,i,n;const r=ea(e),l=r.getFullYear(),c=Gp(),u=(t==null?void 0:t.firstWeekContainsDate)??((a=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:a.firstWeekContainsDate)??c.firstWeekContainsDate??((n=(i=c.locale)==null?void 0:i.options)==null?void 0:n.firstWeekContainsDate)??1,h=xr(e,0);h.setFullYear(l+1,0,u),h.setHours(0,0,0,0);const d=Vu(h,t),f=xr(e,0);f.setFullYear(l,0,u),f.setHours(0,0,0,0);const g=Vu(f,t);return r.getTime()>=d.getTime()?l+1:r.getTime()>=g.getTime()?l:l-1}function DP(e,t){var s,a,i,n;const r=Gp(),l=(t==null?void 0:t.firstWeekContainsDate)??((a=(s=t==null?void 0:t.locale)==null?void 0:s.options)==null?void 0:a.firstWeekContainsDate)??r.firstWeekContainsDate??((n=(i=r.locale)==null?void 0:i.options)==null?void 0:n.firstWeekContainsDate)??1,c=sA(e,t),u=xr(e,0);return u.setFullYear(c,0,l),u.setHours(0,0,0,0),Vu(u,t)}function jP(e,t){const s=ea(e),a=+Vu(s,t)-+DP(s,t);return Math.round(a/tA)+1}function gt(e,t){const s=e<0?"-":"",a=Math.abs(e).toString().padStart(t,"0");return s+a}const di={y(e,t){const s=e.getFullYear(),a=s>0?s:1-s;return gt(t==="yy"?a%100:a,t.length)},M(e,t){const s=e.getMonth();return t==="M"?String(s+1):gt(s+1,2)},d(e,t){return gt(e.getDate(),t.length)},a(e,t){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h(e,t){return gt(e.getHours()%12||12,t.length)},H(e,t){return gt(e.getHours(),t.length)},m(e,t){return gt(e.getMinutes(),t.length)},s(e,t){return gt(e.getSeconds(),t.length)},S(e,t){const s=t.length,a=e.getMilliseconds(),i=Math.trunc(a*Math.pow(10,s-3));return gt(i,t.length)}},Mr={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},f0={G:function(e,t,s){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return s.era(a,{width:"abbreviated"});case"GGGGG":return s.era(a,{width:"narrow"});case"GGGG":default:return s.era(a,{width:"wide"})}},y:function(e,t,s){if(t==="yo"){const a=e.getFullYear(),i=a>0?a:1-a;return s.ordinalNumber(i,{unit:"year"})}return di.y(e,t)},Y:function(e,t,s,a){const i=sA(e,a),n=i>0?i:1-i;if(t==="YY"){const r=n%100;return gt(r,2)}return t==="Yo"?s.ordinalNumber(n,{unit:"year"}):gt(n,t.length)},R:function(e,t){const s=eA(e);return gt(s,t.length)},u:function(e,t){const s=e.getFullYear();return gt(s,t.length)},Q:function(e,t,s){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return gt(a,2);case"Qo":return s.ordinalNumber(a,{unit:"quarter"});case"QQQ":return s.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,s){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return gt(a,2);case"qo":return s.ordinalNumber(a,{unit:"quarter"});case"qqq":return s.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,s){const a=e.getMonth();switch(t){case"M":case"MM":return di.M(e,t);case"Mo":return s.ordinalNumber(a+1,{unit:"month"});case"MMM":return s.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,s){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return gt(a+1,2);case"Lo":return s.ordinalNumber(a+1,{unit:"month"});case"LLL":return s.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,s,a){const i=jP(e,a);return t==="wo"?s.ordinalNumber(i,{unit:"week"}):gt(i,t.length)},I:function(e,t,s){const a=IP(e);return t==="Io"?s.ordinalNumber(a,{unit:"week"}):gt(a,t.length)},d:function(e,t,s){return t==="do"?s.ordinalNumber(e.getDate(),{unit:"date"}):di.d(e,t)},D:function(e,t,s){const a=RP(e);return t==="Do"?s.ordinalNumber(a,{unit:"dayOfYear"}):gt(a,t.length)},E:function(e,t,s){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return s.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(a,{width:"short",context:"formatting"});case"EEEE":default:return s.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,s,a){const i=e.getDay(),n=(i-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(n);case"ee":return gt(n,2);case"eo":return s.ordinalNumber(n,{unit:"day"});case"eee":return s.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(i,{width:"short",context:"formatting"});case"eeee":default:return s.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,s,a){const i=e.getDay(),n=(i-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(n);case"cc":return gt(n,t.length);case"co":return s.ordinalNumber(n,{unit:"day"});case"ccc":return s.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(i,{width:"narrow",context:"standalone"});case"cccccc":return s.day(i,{width:"short",context:"standalone"});case"cccc":default:return s.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,s){const a=e.getDay(),i=a===0?7:a;switch(t){case"i":return String(i);case"ii":return gt(i,t.length);case"io":return s.ordinalNumber(i,{unit:"day"});case"iii":return s.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(a,{width:"short",context:"formatting"});case"iiii":default:return s.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,s){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,s){const a=e.getHours();let i;switch(a===12?i=Mr.noon:a===0?i=Mr.midnight:i=a/12>=1?"pm":"am",t){case"b":case"bb":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,s){const a=e.getHours();let i;switch(a>=17?i=Mr.evening:a>=12?i=Mr.afternoon:a>=4?i=Mr.morning:i=Mr.night,t){case"B":case"BB":case"BBB":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,s){if(t==="ho"){let a=e.getHours()%12;return a===0&&(a=12),s.ordinalNumber(a,{unit:"hour"})}return di.h(e,t)},H:function(e,t,s){return t==="Ho"?s.ordinalNumber(e.getHours(),{unit:"hour"}):di.H(e,t)},K:function(e,t,s){const a=e.getHours()%12;return t==="Ko"?s.ordinalNumber(a,{unit:"hour"}):gt(a,t.length)},k:function(e,t,s){let a=e.getHours();return a===0&&(a=24),t==="ko"?s.ordinalNumber(a,{unit:"hour"}):gt(a,t.length)},m:function(e,t,s){return t==="mo"?s.ordinalNumber(e.getMinutes(),{unit:"minute"}):di.m(e,t)},s:function(e,t,s){return t==="so"?s.ordinalNumber(e.getSeconds(),{unit:"second"}):di.s(e,t)},S:function(e,t){return di.S(e,t)},X:function(e,t,s){const a=e.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return g0(a);case"XXXX":case"XX":return Gn(a);case"XXXXX":case"XXX":default:return Gn(a,":")}},x:function(e,t,s){const a=e.getTimezoneOffset();switch(t){case"x":return g0(a);case"xxxx":case"xx":return Gn(a);case"xxxxx":case"xxx":default:return Gn(a,":")}},O:function(e,t,s){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+p0(a,":");case"OOOO":default:return"GMT"+Gn(a,":")}},z:function(e,t,s){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+p0(a,":");case"zzzz":default:return"GMT"+Gn(a,":")}},t:function(e,t,s){const a=Math.trunc(e.getTime()/1e3);return gt(a,t.length)},T:function(e,t,s){const a=e.getTime();return gt(a,t.length)}};function p0(e,t=""){const s=e>0?"-":"+",a=Math.abs(e),i=Math.trunc(a/60),n=a%60;return n===0?s+String(i):s+String(i)+t+gt(n,2)}function g0(e,t){return e%60===0?(e>0?"-":"+")+gt(Math.abs(e)/60,2):Gn(e,t)}function Gn(e,t=""){const s=e>0?"-":"+",a=Math.abs(e),i=gt(Math.trunc(a/60),2),n=gt(a%60,2);return s+i+t+n}const m0=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},aA=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},FP=(e,t)=>{const s=e.match(/(P+)(p+)?/)||[],a=s[1],i=s[2];if(!i)return m0(e,t);let n;switch(a){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;case"PPPP":default:n=t.dateTime({width:"full"});break}return n.replace("{{date}}",m0(a,t)).replace("{{time}}",aA(i,t))},OP={p:aA,P:FP},WP=/^D+$/,zP=/^Y+$/,$P=["D","DD","YY","YYYY"];function BP(e){return WP.test(e)}function UP(e){return zP.test(e)}function HP(e,t,s){const a=VP(e,t,s);if(console.warn(a),$P.includes(e))throw new RangeError(a)}function VP(e,t,s){const a=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${s}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const GP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,qP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,XP=/^'([^]*?)'?$/,YP=/''/g,KP=/[a-zA-Z]/;function QP(e,t,s){var a,i,n,r;const l=Gp(),c=l.locale??LP,u=l.firstWeekContainsDate??((i=(a=l.locale)==null?void 0:a.options)==null?void 0:i.firstWeekContainsDate)??1,h=l.weekStartsOn??((r=(n=l.locale)==null?void 0:n.options)==null?void 0:r.weekStartsOn)??0,d=ea(e);if(!JN(d))throw new RangeError("Invalid time value");let f=t.match(qP).map(v=>{const y=v[0];if(y==="p"||y==="P"){const A=OP[y];return A(v,c.formatLong)}return v}).join("").match(GP).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const y=v[0];if(y==="'")return{isToken:!1,value:JP(v)};if(f0[y])return{isToken:!0,value:v};if(y.match(KP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:v}});c.localize.preprocessor&&(f=c.localize.preprocessor(d,f));const g={firstWeekContainsDate:u,weekStartsOn:h,locale:c};return f.map(v=>{if(!v.isToken)return v.value;const y=v.value;(UP(y)||BP(y))&&HP(y,t,String(e));const A=f0[y[0]];return A(d,y,c.localize,g)}).join("")}function JP(e){const t=e.match(XP);return t?t[1].replace(YP,"'"):e}function ZP(){const{user:e}=Fs(),[t,s]=C.useState([]),[a,i]=C.useState(!0),[n,r]=C.useState(0),[l,c]=C.useState(0),[u,h]=C.useState([]),[d,f]=C.useState({action_type:"",start_date:"",end_date:""}),[g,v]=C.useState(!1),[y,A]=C.useState([]),b=(e==null?void 0:e.role)==="super_admin",x=50;C.useEffect(()=>{w(),S()},[l,d]);const w=async()=>{i(!0);try{const P=new URLSearchParams;P.append("offset",String(l*x)),P.append("limit",String(x)),d.action_type&&P.append("action_type",d.action_type),d.start_date&&P.append("start_date",d.start_date),d.end_date&&P.append("end_date",d.end_date);const T=await ct.get(`/audit?${P}`);s(T.data.logs||[]),r(T.data.total)}catch(P){console.error("Failed to load logs:",P)}finally{i(!1)}},S=async()=>{try{const P=await ct.get("/audit/types");h(P.data.action_types||[])}catch{}},E=async P=>{if(!(!y.length||!P))try{await ct.post("/audit/bulk-delete",{log_ids:y,reason:P}),A([]),v(!1),w()}catch(T){alert(T instanceof Error?T.message:"Failed to delete logs")}},M=P=>{A(T=>T.includes(P)?T.filter(I=>I!==P):[...T,P])},N=Math.ceil(n/x);return p.jsxs("div",{className:"audit-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Audit Logs"}),p.jsx("p",{children:"View system activity and security events"})]}),b&&y.length>0&&p.jsxs("button",{className:"btn btn-danger",onClick:()=>v(!0),children:[p.jsx(Yb,{size:18}),"Delete Selected (",y.length,")"]})]}),p.jsxs("div",{className:"filters glass-card",children:[p.jsxs("div",{className:"filter-group",children:[p.jsx(aM,{size:20}),p.jsx("span",{children:"Filters:"})]}),p.jsxs("select",{className:"input",value:d.action_type,onChange:P=>f({...d,action_type:P.target.value}),children:[p.jsx("option",{value:"",children:"All Actions"}),u.map(P=>p.jsx("option",{value:P,children:v0(P)},P))]}),p.jsx("input",{type:"date",className:"input",value:d.start_date,onChange:P=>f({...d,start_date:P.target.value}),placeholder:"Start Date"}),p.jsx("input",{type:"date",className:"input",value:d.end_date,onChange:P=>f({...d,end_date:P.target.value}),placeholder:"End Date"}),(d.action_type||d.start_date||d.end_date)&&p.jsx("button",{className:"btn btn-secondary",onClick:()=>f({action_type:"",start_date:"",end_date:""}),children:"Clear"})]}),p.jsxs("div",{className:"table-container glass-card",children:[a?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("table",{className:"table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[b&&p.jsx("th",{className:"checkbox-col"}),p.jsx("th",{children:"Timestamp"}),p.jsx("th",{children:"Action"}),p.jsx("th",{children:"Actor"}),p.jsx("th",{children:"Target"}),p.jsx("th",{children:"IP Address"}),p.jsx("th",{children:"Details"})]})}),p.jsx("tbody",{children:t.map(P=>p.jsxs("tr",{className:P.deleted_at?"deleted":"",children:[b&&p.jsx("td",{className:"checkbox-col",children:!P.deleted_at&&p.jsx("input",{type:"checkbox",checked:y.includes(P.id),onChange:()=>M(P.id)})}),p.jsx("td",{className:"timestamp",children:QP(new Date(P.created_at),"MMM d, yyyy HH:mm:ss")}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${eT(P.action_type)}`,children:v0(P.action_type)})}),p.jsx("td",{children:p.jsx("span",{className:"actor-role",children:P.actor_role||"System"})}),p.jsx("td",{children:P.target_type||"-"}),p.jsx("td",{className:"ip-cell",children:P.ip_address||"-"}),p.jsx("td",{children:Object.keys(P.metadata||{}).length>0&&p.jsxs("code",{className:"metadata",children:[JSON.stringify(P.metadata).slice(0,50),"..."]})})]},P.id))})]}),t.length===0&&!a&&p.jsxs("div",{className:"empty-state",children:[p.jsx(X1,{size:48}),p.jsx("p",{children:"No audit logs found"})]}),N>1&&p.jsxs("div",{className:"pagination",children:[p.jsx("button",{className:"btn btn-secondary",disabled:l===0,onClick:()=>c(P=>P-1),children:"Previous"}),p.jsxs("span",{children:["Page ",l+1," of ",N]}),p.jsx("button",{className:"btn btn-secondary",disabled:l>=N-1,onClick:()=>c(P=>P+1),children:"Next"})]})]}),g&&p.jsx(tT,{count:y.length,onClose:()=>v(!1),onConfirm:E})]})}function tT({count:e,onClose:t,onConfirm:s}){const[a,i]=C.useState("");return p.jsx("div",{className:"modal-overlay",onClick:t,children:p.jsxs("div",{className:"modal glass-card",onClick:n=>n.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Delete Audit Logs"}),p.jsx("button",{className:"close-btn",onClick:t,children:p.jsx(yl,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[p.jsxs("p",{className:"warning-text",children:["You are about to delete ",e," audit log(s). This action is logged and cannot be undone."]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Deletion Reason (required)"}),p.jsx("textarea",{className:"input",value:a,onChange:n=>i(n.target.value),placeholder:"Explain why these logs are being deleted...",rows:3,required:!0})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Cancel"}),p.jsx("button",{className:"btn btn-danger",onClick:()=>s(a),disabled:!a.trim(),children:"Delete Logs"})]})]})})}function v0(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function eT(e){return e.includes("login")||e.includes("logout")?"info":e.includes("failed")||e.includes("delete")?"error":e.includes("create")||e.includes("approve")?"success":"warning"}function sT(){const{user:e,refreshUser:t}=Fs(),{theme:s,toggleTheme:a}=V1(),i=(e==null?void 0:e.role)==="super_admin";return p.jsxs("div",{className:"settings-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsx("h1",{children:"Settings"}),p.jsx("p",{children:"Manage your account and preferences"})]}),p.jsxs("div",{className:"settings-grid",children:[p.jsx(aT,{user:e,onUpdate:t}),p.jsx(iT,{user:e,onUpdate:t}),p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(Mf,{size:24}),p.jsx("h2",{children:"Preferences"})]}),p.jsxs("div",{className:"preference-item",children:[p.jsxs("div",{className:"preference-info",children:[p.jsx("h3",{children:"Theme"}),p.jsx("p",{children:"Choose your preferred color scheme"})]}),p.jsxs("button",{className:"theme-toggle",onClick:a,children:[s==="dark"?p.jsx(jm,{size:20}):p.jsx(Mf,{size:20}),p.jsx("span",{children:s==="dark"?"Light Mode":"Dark Mode"})]})]})]}),i&&p.jsx(rT,{}),p.jsx(nT,{})]})]})}function aT({user:e,onUpdate:t}){var s;const[a,i]=C.useState(!1),[n,r]=C.useState((e==null?void 0:e.full_name)||""),[l,c]=C.useState((e==null?void 0:e.mobile)||""),[u,h]=C.useState(!1),d=async()=>{h(!0);try{await ct.put(`/users/${e.id}`,{full_name:n,mobile:l}),await t(),i(!1)}catch{alert("Failed to update profile")}finally{h(!1)}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(uM,{size:24}),p.jsx("h2",{children:"Profile"})]}),p.jsxs("div",{className:"profile-content",children:[p.jsx("div",{className:"profile-avatar",children:(s=e==null?void 0:e.full_name)==null?void 0:s.charAt(0).toUpperCase()}),a?p.jsxs("div",{className:"profile-form",children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Full Name"}),p.jsx("input",{type:"text",className:"input",value:n,onChange:f=>r(f.target.value)})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Mobile"}),p.jsx("input",{type:"tel",className:"input",value:l,onChange:f=>c(f.target.value)})]}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>i(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:d,disabled:u,children:u?"Saving...":"Save"})]})]}):p.jsxs("div",{className:"profile-info",children:[p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Name"}),p.jsx("span",{className:"value",children:e==null?void 0:e.full_name})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Email"}),p.jsx("span",{className:"value",children:e==null?void 0:e.email})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Mobile"}),p.jsx("span",{className:"value",children:(e==null?void 0:e.mobile)||"Not set"})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Role"}),p.jsx("span",{className:"value badge badge-info",children:e==null?void 0:e.role})]}),p.jsx("button",{className:"btn btn-secondary",onClick:()=>i(!0),children:"Edit Profile"})]})]})]})}function iT({user:e,onUpdate:t}){const[s,a]=C.useState(!1),[i,n]=C.useState(""),[r,l]=C.useState(""),[c,u]=C.useState(!1),[h,d]=C.useState(!1),[f,g]=C.useState(""),[v,y]=C.useState(""),A=async()=>{u(!0);try{await ct.post("/auth/change-password",{current_password:i,new_password:r}),alert("Password changed successfully"),a(!1),n(""),l("")}catch(S){alert(S instanceof Error?S.message:"Failed to change password")}finally{u(!1)}},b=async()=>{try{const S=await ct.get("/auth/totp/setup");g(S.data.secret),d(!0)}catch{alert("Failed to setup 2FA")}},x=async()=>{try{await ct.post("/auth/totp/enable",{secret:f,code:v}),await t(),d(!1),y(""),alert("2FA enabled successfully")}catch{alert("Invalid code")}},w=async()=>{if(confirm("Are you sure you want to disable 2FA?"))try{await ct.post("/auth/totp/disable",{}),await t()}catch{alert("Failed to disable 2FA")}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(Nf,{size:24}),p.jsx("h2",{children:"Security"})]}),p.jsxs("div",{className:"security-item",children:[p.jsxs("div",{className:"security-info",children:[p.jsx(Y1,{size:20}),p.jsxs("div",{children:[p.jsx("h3",{children:"Password"}),p.jsx("p",{children:"Change your account password"})]})]}),s?p.jsxs("div",{className:"password-form",children:[p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"password",className:"input",placeholder:"Current password",value:i,onChange:S=>n(S.target.value)})}),p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"password",className:"input",placeholder:"New password (min 8 characters)",value:r,onChange:S=>l(S.target.value),minLength:8})}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>a(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:A,disabled:c||r.length<8,children:c?"Changing...":"Change Password"})]})]}):p.jsx("button",{className:"btn btn-secondary",onClick:()=>a(!0),children:"Change"})]}),p.jsxs("div",{className:"security-item",children:[p.jsxs("div",{className:"security-info",children:[p.jsx(cM,{size:20}),p.jsxs("div",{children:[p.jsx("h3",{children:"Two-Factor Authentication"}),p.jsx("p",{children:e!=null&&e.totp_enabled?"Enabled":"Add extra security to your account"})]})]}),h?p.jsxs("div",{className:"totp-form",children:[p.jsxs("p",{className:"totp-instructions",children:["Add this secret to your authenticator app: ",p.jsx("code",{children:f})]}),p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"text",className:"input",placeholder:"Enter 6-digit code",value:v,onChange:S=>y(S.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6})}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>d(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:x,disabled:v.length!==6,children:"Enable 2FA"})]})]}):e!=null&&e.totp_enabled?p.jsx("button",{className:"btn btn-danger",onClick:w,children:"Disable"}):p.jsx("button",{className:"btn btn-secondary",onClick:b,children:"Setup"})]})]})}function nT(){const[e,t]=C.useState([]),[s,a]=C.useState(!1),i=async()=>{a(!0);try{const n=await ct.get("/auth/sessions");t(n.data.sessions||[])}catch(n){console.error("Failed to load sessions:",n)}finally{a(!1)}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(K1,{size:24}),p.jsx("h2",{children:"Active Sessions"}),p.jsx("button",{className:"btn btn-secondary",onClick:i,disabled:s,children:s?"Loading...":"View Sessions"})]}),e.length>0&&p.jsx("div",{className:"sessions-list",children:e.map((n,r)=>{var l;return p.jsx("div",{className:"session-item",children:p.jsxs("div",{className:"session-info",children:[p.jsx("span",{className:"session-ip",children:n.ip_address}),p.jsxs("span",{className:"session-agent",children:[(l=n.user_agent)==null?void 0:l.slice(0,50),"..."]}),p.jsxs("span",{className:"session-time",children:["Last active: ",new Date(n.last_activity).toLocaleString()]})]})},n.id||r)})})]})}function rT(){const[e,t]=C.useState(null),[s,a]=C.useState(!0),[i,n]=C.useState(!1),[r,l]=C.useState(""),[c,u]=C.useState(""),[h,d]=C.useState(20),[f,g]=C.useState(20),[v,y]=C.useState(!1);C.useEffect(()=>{x(),A()},[]);const A=async()=>{var E;try{const M=localStorage.getItem("access_token"),N=localStorage.getItem("desktop_session"),P={Authorization:`Bearer ${M}`};N&&(P["X-Desktop-Session"]=N);const T=await fetch("/api/v1/system/config",{headers:P});if(T.ok){const I=await T.json(),V=parseInt(((E=I.config)==null?void 0:E.watermark_opacity)||"20",10);d(V),g(V)}}catch(M){console.log("Failed to load opacity setting:",M)}},b=async()=>{y(!0),l(""),u("");try{const E=localStorage.getItem("access_token"),M=localStorage.getItem("desktop_session"),N={"Content-Type":"application/json",Authorization:`Bearer ${E||""}`};M&&(N["X-Desktop-Session"]=M);const P=await fetch("/api/v1/system/config",{method:"PUT",headers:N,body:JSON.stringify({key:"watermark_opacity",value:String(h)})});if(P.ok)g(h),u(`Watermark opacity set to ${h}%`);else{const T=await P.json();l(T.error||"Failed to save opacity")}}catch{l("Failed to save opacity setting")}finally{y(!1)}},x=async()=>{try{const E=localStorage.getItem("access_token"),M=localStorage.getItem("desktop_session"),N={Authorization:`Bearer ${E}`};M&&(N["X-Desktop-Session"]=M);const P=await fetch("/api/v1/system/logo",{headers:N});if(P.ok){const T=await P.blob();t(URL.createObjectURL(T)),console.log("Logo loaded successfully")}else t(null),console.log("No logo found:",P.status)}catch(E){t(null),console.log("Failed to load logo:",E)}finally{a(!1)}},w=async E=>{var M;const N=(M=E.target.files)==null?void 0:M[0];if(N){if(!["image/png","image/jpeg","image/gif"].includes(N.type)){l("Only PNG, JPG, or GIF files allowed");return}if(N.size>500*1024){l("Logo file too large (max 500KB)");return}l(""),u(""),n(!0);try{const P=localStorage.getItem("access_token"),T=localStorage.getItem("desktop_session"),I=new FormData;I.append("logo",N);const V={Authorization:`Bearer ${P||""}`};T&&(V["X-Desktop-Session"]=T);const rt=await fetch("/api/v1/system/logo",{method:"POST",headers:V,body:I});if(rt.ok)u("Logo uploaded successfully"),x();else{const ut=await rt.json();l(ut.error||"Failed to upload logo")}}catch{l("Failed to upload logo")}finally{n(!1)}}},S=async()=>{if(confirm("Are you sure you want to delete the company logo?")){l(""),u("");try{const E=localStorage.getItem("access_token"),M=localStorage.getItem("desktop_session"),N={Authorization:`Bearer ${E||""}`};M&&(N["X-Desktop-Session"]=M);const P=await fetch("/api/v1/system/logo",{method:"DELETE",headers:N});if(P.ok)u("Logo deleted"),t(null);else{const T=await P.json();l(T.error||"Failed to delete logo")}}catch{l("Failed to delete logo")}}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(Ew,{size:24}),p.jsx("h2",{children:"Company Logo"})]}),p.jsx("p",{className:"section-description",children:"Upload a company logo to display in document watermarks. The logo will be visible on all documents viewed by users."}),r&&p.jsx("div",{className:"error-message",children:r}),c&&p.jsx("div",{className:"success-message",children:c}),p.jsx("div",{className:"logo-preview-container",children:s?p.jsx("div",{className:"loading-spinner"}):e?p.jsx("img",{src:e,alt:"Company Logo",className:"logo-preview"}):p.jsxs("div",{className:"logo-placeholder",children:[p.jsx(Ew,{size:48}),p.jsx("span",{children:"No logo uploaded"})]})}),p.jsxs("div",{className:"logo-actions",children:[p.jsxs("label",{className:"btn btn-primary upload-btn",children:[p.jsx(Z1,{size:16}),i?"Uploading...":"Upload Logo",p.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/gif",onChange:w,disabled:i,style:{display:"none"}})]}),e&&p.jsxs("button",{className:"btn btn-danger",onClick:S,children:[p.jsx(Yb,{size:16}),"Delete Logo"]})]}),p.jsx("p",{className:"help-text",children:"Supported formats: PNG, JPG, GIF  Max size: 500KB"}),p.jsxs("div",{className:"opacity-control",children:[p.jsx("h3",{children:"Watermark Opacity"}),p.jsx("p",{className:"section-description",children:"Adjust how visible the watermark appears on documents (1% = very faint, 100% = solid)"}),p.jsxs("div",{className:"opacity-slider-container",children:[p.jsx("input",{type:"range",min:"1",max:"100",value:h,onChange:E=>d(parseInt(E.target.value,10)),className:"opacity-slider"}),p.jsxs("span",{className:"opacity-value",children:[h,"%"]})]}),p.jsxs("div",{className:"opacity-actions",children:[p.jsx("button",{className:"btn btn-primary",onClick:b,disabled:v||h===f,children:v?"Applying...":"Apply Opacity"}),h!==f&&p.jsx("span",{className:"unsaved-indicator",children:"Unsaved changes"})]})]})]})}const Dg={CONFIG_UPDATE:"CONFIG_UPDATE",FORCE_LOGOUT:"FORCE_LOGOUT",SESSION_REVOKED:"SESSION_REVOKED"};function oT(e={}){const{user:t,logout:s}=Fs(),a=C.useRef(null),i=C.useRef(null),n=C.useRef(0),r=5,l=C.useCallback(()=>{if(!t)return;a.current&&a.current.close();const c=localStorage.getItem("access_token");if(!c)return;const u=`/api/v1/realtime/subscribe?token=${encodeURIComponent(c)}`,h=new EventSource(u,{withCredentials:!0});a.current=h,h.addEventListener("connected",d=>{var f;n.current=0;try{const g=JSON.parse(d.data);(f=e.onConnected)==null||f.call(e,g.client_id)}catch{}}),h.addEventListener(Dg.CONFIG_UPDATE,d=>{var f;try{const g=JSON.parse(d.data);g.payload&&((f=e.onConfigUpdate)==null||f.call(e,g.payload.key,g.payload.value))}catch{console.error("Failed to parse CONFIG_UPDATE event")}}),h.addEventListener(Dg.FORCE_LOGOUT,d=>{var f,g;try{const v=((f=JSON.parse(d.data).payload)==null?void 0:f.reason)||"Your session has been terminated";(g=e.onForceLogout)==null||g.call(e,v),s(),alert(v)}catch{s()}}),h.addEventListener(Dg.SESSION_REVOKED,d=>{var f,g;try{const v=((f=JSON.parse(d.data).payload)==null?void 0:f.reason)||"Session revoked by administrator";(g=e.onForceLogout)==null||g.call(e,v),s(),alert(v)}catch{s()}}),h.onerror=d=>{var f;if((f=e.onError)==null||f.call(e,d),h.close(),n.current<r){const g=Math.min(1e3*Math.pow(2,n.current),3e4);n.current++,i.current=window.setTimeout(l,g)}}},[t,s,e]);return C.useEffect(()=>(l(),()=>{a.current&&a.current.close(),i.current&&window.clearTimeout(i.current)}),[l]),{reconnect:C.useCallback(()=>{n.current=0,l()},[l])}}function lT(){var e;const{user:t,logout:s}=Fs(),{theme:a,toggleTheme:i}=V1(),n=Sr(),[r,l]=C.useState(!1),c=C.useCallback((v,y)=>{console.log(`[SSE] Config updated: ${v} =`,y),window.dispatchEvent(new CustomEvent("srams:config-update",{detail:{key:v,value:y}}))},[]),u=C.useCallback(v=>{console.log("[SSE] Force logout:",v)},[]);oT({onConfigUpdate:c,onForceLogout:u,onConnected:v=>console.log(`[SSE] Connected: ${v}`),onError:()=>console.warn("[SSE] Connection error, will retry...")});const h=async()=>{await s(),n("/login")},d=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin",f=(t==null?void 0:t.role)==="super_admin",g=[{to:"/dashboard",icon:iM,label:"Dashboard"},{to:"/documents",icon:Aa,label:"Documents"},...d?[{to:"/users",icon:dl,label:"Users"},{to:"/audit",icon:X1,label:"Audit Logs"}]:[],{to:"/settings",icon:lM,label:"Settings"}];return p.jsxs("div",{className:"layout",children:[p.jsxs("header",{className:"mobile-header",children:[p.jsx("button",{className:"menu-btn",onClick:()=>l(!0),children:p.jsx(rM,{size:24})}),p.jsxs("div",{className:"logo",children:[p.jsx(Nf,{size:24}),p.jsx("span",{children:"SRAMS"})]}),p.jsx("button",{className:"theme-btn",onClick:i,children:a==="twilight"?p.jsx(jm,{size:20}):p.jsx(Mf,{size:20})})]}),r&&p.jsx("div",{className:"sidebar-overlay",onClick:()=>l(!1)}),p.jsxs("aside",{className:`sidebar ${r?"open":""}`,children:[p.jsxs("div",{className:"sidebar-header",children:[p.jsxs("div",{className:"logo",children:[p.jsx(Nf,{size:28}),p.jsx("span",{children:"SRAMS"})]}),p.jsx("button",{className:"close-btn",onClick:()=>l(!1),children:p.jsx(yl,{size:24})})]}),p.jsx("nav",{className:"sidebar-nav",children:g.map(v=>p.jsxs($C,{to:v.to,className:({isActive:y})=>`nav-item ${y?"active":""}`,onClick:()=>l(!1),children:[p.jsx(v.icon,{size:20}),p.jsx("span",{children:v.label})]},v.to))}),p.jsxs("div",{className:"sidebar-footer",children:[p.jsxs("div",{className:"user-info",children:[p.jsx("div",{className:"user-avatar",children:(e=t==null?void 0:t.full_name)==null?void 0:e.charAt(0).toUpperCase()}),p.jsxs("div",{className:"user-details",children:[p.jsx("span",{className:"user-name",children:t==null?void 0:t.full_name}),p.jsx("span",{className:"user-role",children:f?"Super Admin":d?"Admin":"User"})]})]}),p.jsxs("div",{className:"sidebar-actions",children:[p.jsx("button",{className:"action-btn",onClick:i,title:"Toggle theme",children:a==="twilight"?p.jsx(jm,{size:18}):p.jsx(Mf,{size:18})}),p.jsx("button",{className:"action-btn logout",onClick:h,title:"Logout",children:p.jsx(K1,{size:18})})]})]})]}),p.jsx("main",{className:"main-content",children:p.jsx(EC,{})})]})}function jg({children:e,roles:t}){const{user:s,loading:a}=Fs();return a?p.jsx("div",{className:"flex items-center justify-center",style:{height:"100vh"},children:p.jsx("div",{className:"animate-spin",style:{width:40,height:40,border:"3px solid var(--color-border)",borderTopColor:"var(--color-accent-primary)",borderRadius:"50%"}})}):s?t&&!t.includes(s.role)?p.jsx(Tm,{to:"/dashboard",replace:!0}):p.jsx(p.Fragment,{children:e}):p.jsx(Tm,{to:"/login",replace:!0})}function cT(){return p.jsx(qC,{children:p.jsx(KC,{children:p.jsx(FC,{children:p.jsxs(MC,{children:[p.jsx(Ws,{path:"/login",element:p.jsx(pM,{})}),p.jsx(Ws,{path:"/force-change-password",element:p.jsx(gM,{})}),p.jsxs(Ws,{path:"/",element:p.jsx(jg,{children:p.jsx(lT,{})}),children:[p.jsx(Ws,{index:!0,element:p.jsx(Tm,{to:"/dashboard",replace:!0})}),p.jsx(Ws,{path:"dashboard",element:p.jsx(mM,{})}),p.jsx(Ws,{path:"documents",element:p.jsx(yM,{})}),p.jsx(Ws,{path:"documents/:id",element:p.jsx(BN,{})}),p.jsx(Ws,{path:"users",element:p.jsx(jg,{roles:["admin","super_admin"],children:p.jsx(UN,{})})}),p.jsx(Ws,{path:"audit",element:p.jsx(jg,{roles:["admin","super_admin"],children:p.jsx(ZP,{})})}),p.jsx(Ws,{path:"settings",element:p.jsx(sT,{})})]})]})})})})}Fg.createRoot(document.getElementById("root")).render(p.jsx(N0.StrictMode,{children:p.jsx(cT,{})}));
