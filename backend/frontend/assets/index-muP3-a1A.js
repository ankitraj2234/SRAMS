var t_=Object.defineProperty;var A0=n=>{throw TypeError(n)};var n_=(n,e,t)=>e in n?t_(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var X=(n,e,t)=>n_(n,typeof e!="symbol"?e+"":e,t),cg=(n,e,t)=>e.has(n)||A0("Cannot "+t);var l=(n,e,t)=>(cg(n,e,"read from private field"),t?t.call(n):e.get(n)),b=(n,e,t)=>e.has(n)?A0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),y=(n,e,t,s)=>(cg(n,e,"write to private field"),s?s.call(n,t):e.set(n,t),t),A=(n,e,t)=>(cg(n,e,"access private method"),t);var zt=(n,e,t,s)=>({set _(i){y(n,e,i,t)},get _(){return l(n,e,s)}});function s_(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const i in s)if(i!=="default"&&!(i in n)){const r=Object.getOwnPropertyDescriptor(s,i);r&&Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:()=>s[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function i_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var y1={exports:{}},Dp={},v1={exports:{}},re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dd=Symbol.for("react.element"),r_=Symbol.for("react.portal"),a_=Symbol.for("react.fragment"),o_=Symbol.for("react.strict_mode"),l_=Symbol.for("react.profiler"),c_=Symbol.for("react.provider"),u_=Symbol.for("react.context"),h_=Symbol.for("react.forward_ref"),d_=Symbol.for("react.suspense"),f_=Symbol.for("react.memo"),p_=Symbol.for("react.lazy"),_0=Symbol.iterator;function g_(n){return n===null||typeof n!="object"?null:(n=_0&&n[_0]||n["@@iterator"],typeof n=="function"?n:null)}var w1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x1=Object.assign,S1={};function Sc(n,e,t){this.props=n,this.context=e,this.refs=S1,this.updater=t||w1}Sc.prototype.isReactComponent={};Sc.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Sc.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function b1(){}b1.prototype=Sc.prototype;function cv(n,e,t){this.props=n,this.context=e,this.refs=S1,this.updater=t||w1}var uv=cv.prototype=new b1;uv.constructor=cv;x1(uv,Sc.prototype);uv.isPureReactComponent=!0;var E0=Array.isArray,A1=Object.prototype.hasOwnProperty,hv={current:null},_1={key:!0,ref:!0,__self:!0,__source:!0};function E1(n,e,t){var s,i={},r=null,a=null;if(e!=null)for(s in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(r=""+e.key),e)A1.call(e,s)&&!_1.hasOwnProperty(s)&&(i[s]=e[s]);var o=arguments.length-2;if(o===1)i.children=t;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];i.children=c}if(n&&n.defaultProps)for(s in o=n.defaultProps,o)i[s]===void 0&&(i[s]=o[s]);return{$$typeof:dd,type:n,key:r,ref:a,props:i,_owner:hv.current}}function m_(n,e){return{$$typeof:dd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function dv(n){return typeof n=="object"&&n!==null&&n.$$typeof===dd}function y_(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var C0=/\/+/g;function ug(n,e){return typeof n=="object"&&n!==null&&n.key!=null?y_(""+n.key):e.toString(36)}function Hd(n,e,t,s,i){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case dd:case r_:a=!0}}if(a)return a=n,i=i(a),n=s===""?"."+ug(a,0):s,E0(i)?(t="",n!=null&&(t=n.replace(C0,"$&/")+"/"),Hd(i,e,t,"",function(u){return u})):i!=null&&(dv(i)&&(i=m_(i,t+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(C0,"$&/")+"/")+n)),e.push(i)),1;if(a=0,s=s===""?".":s+":",E0(n))for(var o=0;o<n.length;o++){r=n[o];var c=s+ug(r,o);a+=Hd(r,e,t,c,i)}else if(c=g_(n),typeof c=="function")for(n=c.call(n),o=0;!(r=n.next()).done;)r=r.value,c=s+ug(r,o++),a+=Hd(r,e,t,c,i);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function xd(n,e,t){if(n==null)return n;var s=[],i=0;return Hd(n,s,"","",function(r){return e.call(t,r,i++)}),s}function v_(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Kt={current:null},$d={transition:null},w_={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:$d,ReactCurrentOwner:hv};function C1(){throw Error("act(...) is not supported in production builds of React.")}re.Children={map:xd,forEach:function(n,e,t){xd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return xd(n,function(){e++}),e},toArray:function(n){return xd(n,function(e){return e})||[]},only:function(n){if(!dv(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};re.Component=Sc;re.Fragment=a_;re.Profiler=l_;re.PureComponent=cv;re.StrictMode=o_;re.Suspense=d_;re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w_;re.act=C1;re.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=x1({},n.props),i=n.key,r=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,a=hv.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(c in e)A1.call(e,c)&&!_1.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&o!==void 0?o[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];s.children=o}return{$$typeof:dd,type:n.type,key:i,ref:r,props:s,_owner:a}};re.createContext=function(n){return n={$$typeof:u_,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:c_,_context:n},n.Consumer=n};re.createElement=E1;re.createFactory=function(n){var e=E1.bind(null,n);return e.type=n,e};re.createRef=function(){return{current:null}};re.forwardRef=function(n){return{$$typeof:h_,render:n}};re.isValidElement=dv;re.lazy=function(n){return{$$typeof:p_,_payload:{_status:-1,_result:n},_init:v_}};re.memo=function(n,e){return{$$typeof:f_,type:n,compare:e===void 0?null:e}};re.startTransition=function(n){var e=$d.transition;$d.transition={};try{n()}finally{$d.transition=e}};re.unstable_act=C1;re.useCallback=function(n,e){return Kt.current.useCallback(n,e)};re.useContext=function(n){return Kt.current.useContext(n)};re.useDebugValue=function(){};re.useDeferredValue=function(n){return Kt.current.useDeferredValue(n)};re.useEffect=function(n,e){return Kt.current.useEffect(n,e)};re.useId=function(){return Kt.current.useId()};re.useImperativeHandle=function(n,e,t){return Kt.current.useImperativeHandle(n,e,t)};re.useInsertionEffect=function(n,e){return Kt.current.useInsertionEffect(n,e)};re.useLayoutEffect=function(n,e){return Kt.current.useLayoutEffect(n,e)};re.useMemo=function(n,e){return Kt.current.useMemo(n,e)};re.useReducer=function(n,e,t){return Kt.current.useReducer(n,e,t)};re.useRef=function(n){return Kt.current.useRef(n)};re.useState=function(n){return Kt.current.useState(n)};re.useSyncExternalStore=function(n,e,t){return Kt.current.useSyncExternalStore(n,e,t)};re.useTransition=function(){return Kt.current.useTransition()};re.version="18.3.1";v1.exports=re;var T=v1.exports;const k1=i_(T),x_=s_({__proto__:null,default:k1},[T]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S_=T,b_=Symbol.for("react.element"),A_=Symbol.for("react.fragment"),__=Object.prototype.hasOwnProperty,E_=S_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,C_={key:!0,ref:!0,__self:!0,__source:!0};function T1(n,e,t){var s,i={},r=null,a=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(s in e)__.call(e,s)&&!C_.hasOwnProperty(s)&&(i[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:b_,type:n,key:r,ref:a,props:i,_owner:E_.current}}Dp.Fragment=A_;Dp.jsx=T1;Dp.jsxs=T1;y1.exports=Dp;var p=y1.exports,qg={},P1={exports:{}},Mn={},N1={exports:{}},R1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(M,O){var j=M.length;M.push(O);e:for(;0<j;){var Y=j-1>>>1,J=M[Y];if(0<i(J,O))M[Y]=O,M[j]=J,j=Y;else break e}}function t(M){return M.length===0?null:M[0]}function s(M){if(M.length===0)return null;var O=M[0],j=M.pop();if(j!==O){M[0]=j;e:for(var Y=0,J=M.length,Se=J>>>1;Y<Se;){var ft=2*(Y+1)-1,Jt=M[ft],ue=ft+1,ne=M[ue];if(0>i(Jt,j))ue<J&&0>i(ne,Jt)?(M[Y]=ne,M[ue]=j,Y=ue):(M[Y]=Jt,M[ft]=j,Y=ft);else if(ue<J&&0>i(ne,j))M[Y]=ne,M[ue]=j,Y=ue;else break e}}return O}function i(M,O){var j=M.sortIndex-O.sortIndex;return j!==0?j:M.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var c=[],u=[],h=1,d=null,f=3,g=!1,m=!1,w=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(M){for(var O=t(u);O!==null;){if(O.callback===null)s(u);else if(O.startTime<=M)s(u),O.sortIndex=O.expirationTime,e(c,O);else break;O=t(u)}}function E(M){if(w=!1,S(M),!m)if(t(c)!==null)m=!0,z(C);else{var O=t(u);O!==null&&I(E,O.startTime-M)}}function C(M,O){m=!1,w&&(w=!1,v(N),N=-1),g=!0;var j=f;try{for(S(O),d=t(c);d!==null&&(!(d.expirationTime>O)||M&&!B());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,f=d.priorityLevel;var J=Y(d.expirationTime<=O);O=n.unstable_now(),typeof J=="function"?d.callback=J:d===t(c)&&s(c),S(O)}else s(c);d=t(c)}if(d!==null)var Se=!0;else{var ft=t(u);ft!==null&&I(E,ft.startTime-O),Se=!1}return Se}finally{d=null,f=j,g=!1}}var k=!1,P=null,N=-1,R=5,D=-1;function B(){return!(n.unstable_now()-D<R)}function ae(){if(P!==null){var M=n.unstable_now();D=M;var O=!0;try{O=P(!0,M)}finally{O?ge():(k=!1,P=null)}}else k=!1}var ge;if(typeof x=="function")ge=function(){x(ae)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,Xe=oe.port2;oe.port1.onmessage=ae,ge=function(){Xe.postMessage(null)}}else ge=function(){_(ae,0)};function z(M){P=M,k||(k=!0,ge())}function I(M,O){N=_(function(){M(n.unstable_now())},O)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(M){M.callback=null},n.unstable_continueExecution=function(){m||g||(m=!0,z(C))},n.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<M?Math.floor(1e3/M):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(M){switch(f){case 1:case 2:case 3:var O=3;break;default:O=f}var j=f;f=O;try{return M()}finally{f=j}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(M,O){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var j=f;f=M;try{return O()}finally{f=j}},n.unstable_scheduleCallback=function(M,O,j){var Y=n.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?Y+j:Y):j=Y,M){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=j+J,M={id:h++,callback:O,priorityLevel:M,startTime:j,expirationTime:J,sortIndex:-1},j>Y?(M.sortIndex=j,e(u,M),t(c)===null&&M===t(u)&&(w?(v(N),N=-1):w=!0,I(E,j-Y))):(M.sortIndex=J,e(c,M),m||g||(m=!0,z(C))),M},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(M){var O=f;return function(){var j=f;f=O;try{return M.apply(this,arguments)}finally{f=j}}}})(R1);N1.exports=R1;var k_=N1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T_=T,Rn=k_;function L(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M1=new Set,vu={};function Eo(n,e){dc(n,e),dc(n+"Capture",e)}function dc(n,e){for(vu[n]=e,n=0;n<e.length;n++)M1.add(e[n])}var Fi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yg=Object.prototype.hasOwnProperty,P_=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,k0={},T0={};function N_(n){return Yg.call(T0,n)?!0:Yg.call(k0,n)?!1:P_.test(n)?T0[n]=!0:(k0[n]=!0,!1)}function R_(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function M_(n,e,t,s){if(e===null||typeof e>"u"||R_(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Qt(n,e,t,s,i,r,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=a}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){bt[n]=new Qt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];bt[e]=new Qt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){bt[n]=new Qt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){bt[n]=new Qt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){bt[n]=new Qt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){bt[n]=new Qt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){bt[n]=new Qt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){bt[n]=new Qt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){bt[n]=new Qt(n,5,!1,n.toLowerCase(),null,!1,!1)});var fv=/[\-:]([a-z])/g;function pv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(fv,pv);bt[e]=new Qt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(fv,pv);bt[e]=new Qt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(fv,pv);bt[e]=new Qt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){bt[n]=new Qt(n,1,!1,n.toLowerCase(),null,!1,!1)});bt.xlinkHref=new Qt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){bt[n]=new Qt(n,1,!1,n.toLowerCase(),null,!0,!0)});function gv(n,e,t,s){var i=bt.hasOwnProperty(e)?bt[e]:null;(i!==null?i.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(M_(e,t,i,s)&&(t=null),s||i===null?N_(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,s=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var $i=T_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sd=Symbol.for("react.element"),zo=Symbol.for("react.portal"),Bo=Symbol.for("react.fragment"),mv=Symbol.for("react.strict_mode"),Kg=Symbol.for("react.profiler"),L1=Symbol.for("react.provider"),I1=Symbol.for("react.context"),yv=Symbol.for("react.forward_ref"),Qg=Symbol.for("react.suspense"),Jg=Symbol.for("react.suspense_list"),vv=Symbol.for("react.memo"),qi=Symbol.for("react.lazy"),D1=Symbol.for("react.offscreen"),P0=Symbol.iterator;function kc(n){return n===null||typeof n!="object"?null:(n=P0&&n[P0]||n["@@iterator"],typeof n=="function"?n:null)}var Be=Object.assign,hg;function Uc(n){if(hg===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);hg=e&&e[1]||""}return`
`+hg+n}var dg=!1;function fg(n,e){if(!n||dg)return"";dg=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){s=u}n.call(e.prototype)}else{try{throw Error()}catch(u){s=u}n()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),r=s.stack.split(`
`),a=i.length-1,o=r.length-1;1<=a&&0<=o&&i[a]!==r[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==r[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==r[o]){var c=`
`+i[a].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=a&&0<=o);break}}}finally{dg=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Uc(n):""}function L_(n){switch(n.tag){case 5:return Uc(n.type);case 16:return Uc("Lazy");case 13:return Uc("Suspense");case 19:return Uc("SuspenseList");case 0:case 2:case 15:return n=fg(n.type,!1),n;case 11:return n=fg(n.type.render,!1),n;case 1:return n=fg(n.type,!0),n;default:return""}}function Zg(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Bo:return"Fragment";case zo:return"Portal";case Kg:return"Profiler";case mv:return"StrictMode";case Qg:return"Suspense";case Jg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case I1:return(n.displayName||"Context")+".Consumer";case L1:return(n._context.displayName||"Context")+".Provider";case yv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case vv:return e=n.displayName||null,e!==null?e:Zg(n.type)||"Memo";case qi:e=n._payload,n=n._init;try{return Zg(n(e))}catch{}}return null}function I_(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zg(e);case 8:return e===mv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function j1(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function D_(n){var e=j1(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){s=""+a,r.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(a){s=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function bd(n){n._valueTracker||(n._valueTracker=D_(n))}function F1(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=j1(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function Lf(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function em(n,e){var t=e.checked;return Be({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function N0(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Hr(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function O1(n,e){e=e.checked,e!=null&&gv(n,"checked",e,!1)}function tm(n,e){O1(n,e);var t=Hr(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?nm(n,e.type,t):e.hasOwnProperty("defaultValue")&&nm(n,e.type,Hr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function R0(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function nm(n,e,t){(e!=="number"||Lf(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Hc=Array.isArray;function Zo(n,e,t,s){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Hr(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,s&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function sm(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Be({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function M0(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(L(92));if(Hc(t)){if(1<t.length)throw Error(L(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Hr(t)}}function z1(n,e){var t=Hr(e.value),s=Hr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function L0(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function B1(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function im(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?B1(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ad,U1=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Ad=Ad||document.createElement("div"),Ad.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ad.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function wu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var ou={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},j_=["Webkit","ms","Moz","O"];Object.keys(ou).forEach(function(n){j_.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),ou[e]=ou[n]})});function H1(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||ou.hasOwnProperty(n)&&ou[n]?(""+e).trim():e+"px"}function $1(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,i=H1(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,i):n[t]=i}}var F_=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rm(n,e){if(e){if(F_[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function am(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var om=null;function wv(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var lm=null,el=null,tl=null;function I0(n){if(n=gd(n)){if(typeof lm!="function")throw Error(L(280));var e=n.stateNode;e&&(e=Bp(e),lm(n.stateNode,n.type,e))}}function W1(n){el?tl?tl.push(n):tl=[n]:el=n}function V1(){if(el){var n=el,e=tl;if(tl=el=null,I0(n),e)for(n=0;n<e.length;n++)I0(e[n])}}function G1(n,e){return n(e)}function X1(){}var pg=!1;function q1(n,e,t){if(pg)return n(e,t);pg=!0;try{return G1(n,e,t)}finally{pg=!1,(el!==null||tl!==null)&&(X1(),V1())}}function xu(n,e){var t=n.stateNode;if(t===null)return null;var s=Bp(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(L(231,e,typeof t));return t}var cm=!1;if(Fi)try{var Tc={};Object.defineProperty(Tc,"passive",{get:function(){cm=!0}}),window.addEventListener("test",Tc,Tc),window.removeEventListener("test",Tc,Tc)}catch{cm=!1}function O_(n,e,t,s,i,r,a,o,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var lu=!1,If=null,Df=!1,um=null,z_={onError:function(n){lu=!0,If=n}};function B_(n,e,t,s,i,r,a,o,c){lu=!1,If=null,O_.apply(z_,arguments)}function U_(n,e,t,s,i,r,a,o,c){if(B_.apply(this,arguments),lu){if(lu){var u=If;lu=!1,If=null}else throw Error(L(198));Df||(Df=!0,um=u)}}function Co(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Y1(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function D0(n){if(Co(n)!==n)throw Error(L(188))}function H_(n){var e=n.alternate;if(!e){if(e=Co(n),e===null)throw Error(L(188));return e!==n?null:n}for(var t=n,s=e;;){var i=t.return;if(i===null)break;var r=i.alternate;if(r===null){if(s=i.return,s!==null){t=s;continue}break}if(i.child===r.child){for(r=i.child;r;){if(r===t)return D0(i),n;if(r===s)return D0(i),e;r=r.sibling}throw Error(L(188))}if(t.return!==s.return)t=i,s=r;else{for(var a=!1,o=i.child;o;){if(o===t){a=!0,t=i,s=r;break}if(o===s){a=!0,s=i,t=r;break}o=o.sibling}if(!a){for(o=r.child;o;){if(o===t){a=!0,t=r,s=i;break}if(o===s){a=!0,s=r,t=i;break}o=o.sibling}if(!a)throw Error(L(189))}}if(t.alternate!==s)throw Error(L(190))}if(t.tag!==3)throw Error(L(188));return t.stateNode.current===t?n:e}function K1(n){return n=H_(n),n!==null?Q1(n):null}function Q1(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Q1(n);if(e!==null)return e;n=n.sibling}return null}var J1=Rn.unstable_scheduleCallback,j0=Rn.unstable_cancelCallback,$_=Rn.unstable_shouldYield,W_=Rn.unstable_requestPaint,Ve=Rn.unstable_now,V_=Rn.unstable_getCurrentPriorityLevel,xv=Rn.unstable_ImmediatePriority,Z1=Rn.unstable_UserBlockingPriority,jf=Rn.unstable_NormalPriority,G_=Rn.unstable_LowPriority,ex=Rn.unstable_IdlePriority,jp=null,Ys=null;function X_(n){if(Ys&&typeof Ys.onCommitFiberRoot=="function")try{Ys.onCommitFiberRoot(jp,n,void 0,(n.current.flags&128)===128)}catch{}}var ws=Math.clz32?Math.clz32:K_,q_=Math.log,Y_=Math.LN2;function K_(n){return n>>>=0,n===0?32:31-(q_(n)/Y_|0)|0}var _d=64,Ed=4194304;function $c(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ff(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,i=n.suspendedLanes,r=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~i;o!==0?s=$c(o):(r&=a,r!==0&&(s=$c(r)))}else a=t&~i,a!==0?s=$c(a):r!==0&&(s=$c(r));if(s===0)return 0;if(e!==0&&e!==s&&!(e&i)&&(i=s&-s,r=e&-e,i>=r||i===16&&(r&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-ws(e),i=1<<t,s|=n[t],e&=~i;return s}function Q_(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function J_(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,i=n.expirationTimes,r=n.pendingLanes;0<r;){var a=31-ws(r),o=1<<a,c=i[a];c===-1?(!(o&t)||o&s)&&(i[a]=Q_(o,e)):c<=e&&(n.expiredLanes|=o),r&=~o}}function hm(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function tx(){var n=_d;return _d<<=1,!(_d&4194240)&&(_d=64),n}function gg(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function fd(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-ws(e),n[e]=t}function Z_(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-ws(t),r=1<<i;e[i]=0,s[i]=-1,n[i]=-1,t&=~r}}function Sv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-ws(t),i=1<<s;i&e|n[s]&e&&(n[s]|=e),t&=~i}}var xe=0;function nx(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var sx,bv,ix,rx,ax,dm=!1,Cd=[],Mr=null,Lr=null,Ir=null,Su=new Map,bu=new Map,Ki=[],eE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function F0(n,e){switch(n){case"focusin":case"focusout":Mr=null;break;case"dragenter":case"dragleave":Lr=null;break;case"mouseover":case"mouseout":Ir=null;break;case"pointerover":case"pointerout":Su.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bu.delete(e.pointerId)}}function Pc(n,e,t,s,i,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:r,targetContainers:[i]},e!==null&&(e=gd(e),e!==null&&bv(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function tE(n,e,t,s,i){switch(e){case"focusin":return Mr=Pc(Mr,n,e,t,s,i),!0;case"dragenter":return Lr=Pc(Lr,n,e,t,s,i),!0;case"mouseover":return Ir=Pc(Ir,n,e,t,s,i),!0;case"pointerover":var r=i.pointerId;return Su.set(r,Pc(Su.get(r)||null,n,e,t,s,i)),!0;case"gotpointercapture":return r=i.pointerId,bu.set(r,Pc(bu.get(r)||null,n,e,t,s,i)),!0}return!1}function ox(n){var e=ra(n.target);if(e!==null){var t=Co(e);if(t!==null){if(e=t.tag,e===13){if(e=Y1(t),e!==null){n.blockedOn=e,ax(n.priority,function(){ix(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Wd(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=fm(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);om=s,t.target.dispatchEvent(s),om=null}else return e=gd(t),e!==null&&bv(e),n.blockedOn=t,!1;e.shift()}return!0}function O0(n,e,t){Wd(n)&&t.delete(e)}function nE(){dm=!1,Mr!==null&&Wd(Mr)&&(Mr=null),Lr!==null&&Wd(Lr)&&(Lr=null),Ir!==null&&Wd(Ir)&&(Ir=null),Su.forEach(O0),bu.forEach(O0)}function Nc(n,e){n.blockedOn===e&&(n.blockedOn=null,dm||(dm=!0,Rn.unstable_scheduleCallback(Rn.unstable_NormalPriority,nE)))}function Au(n){function e(i){return Nc(i,n)}if(0<Cd.length){Nc(Cd[0],n);for(var t=1;t<Cd.length;t++){var s=Cd[t];s.blockedOn===n&&(s.blockedOn=null)}}for(Mr!==null&&Nc(Mr,n),Lr!==null&&Nc(Lr,n),Ir!==null&&Nc(Ir,n),Su.forEach(e),bu.forEach(e),t=0;t<Ki.length;t++)s=Ki[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<Ki.length&&(t=Ki[0],t.blockedOn===null);)ox(t),t.blockedOn===null&&Ki.shift()}var nl=$i.ReactCurrentBatchConfig,Of=!0;function sE(n,e,t,s){var i=xe,r=nl.transition;nl.transition=null;try{xe=1,Av(n,e,t,s)}finally{xe=i,nl.transition=r}}function iE(n,e,t,s){var i=xe,r=nl.transition;nl.transition=null;try{xe=4,Av(n,e,t,s)}finally{xe=i,nl.transition=r}}function Av(n,e,t,s){if(Of){var i=fm(n,e,t,s);if(i===null)Eg(n,e,s,zf,t),F0(n,s);else if(tE(i,n,e,t,s))s.stopPropagation();else if(F0(n,s),e&4&&-1<eE.indexOf(n)){for(;i!==null;){var r=gd(i);if(r!==null&&sx(r),r=fm(n,e,t,s),r===null&&Eg(n,e,s,zf,t),r===i)break;i=r}i!==null&&s.stopPropagation()}else Eg(n,e,s,null,t)}}var zf=null;function fm(n,e,t,s){if(zf=null,n=wv(s),n=ra(n),n!==null)if(e=Co(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Y1(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return zf=n,null}function lx(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(V_()){case xv:return 1;case Z1:return 4;case jf:case G_:return 16;case ex:return 536870912;default:return 16}default:return 16}}var Pr=null,_v=null,Vd=null;function cx(){if(Vd)return Vd;var n,e=_v,t=e.length,s,i="value"in Pr?Pr.value:Pr.textContent,r=i.length;for(n=0;n<t&&e[n]===i[n];n++);var a=t-n;for(s=1;s<=a&&e[t-s]===i[r-s];s++);return Vd=i.slice(n,1<s?1-s:void 0)}function Gd(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function kd(){return!0}function z0(){return!1}function Ln(n){function e(t,s,i,r,a){this._reactName=t,this._targetInst=i,this.type=s,this.nativeEvent=r,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(r):r[o]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?kd:z0,this.isPropagationStopped=z0,this}return Be(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=kd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=kd)},persist:function(){},isPersistent:kd}),e}var bc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ev=Ln(bc),pd=Be({},bc,{view:0,detail:0}),rE=Ln(pd),mg,yg,Rc,Fp=Be({},pd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Rc&&(Rc&&n.type==="mousemove"?(mg=n.screenX-Rc.screenX,yg=n.screenY-Rc.screenY):yg=mg=0,Rc=n),mg)},movementY:function(n){return"movementY"in n?n.movementY:yg}}),B0=Ln(Fp),aE=Be({},Fp,{dataTransfer:0}),oE=Ln(aE),lE=Be({},pd,{relatedTarget:0}),vg=Ln(lE),cE=Be({},bc,{animationName:0,elapsedTime:0,pseudoElement:0}),uE=Ln(cE),hE=Be({},bc,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),dE=Ln(hE),fE=Be({},bc,{data:0}),U0=Ln(fE),pE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yE(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=mE[n])?!!e[n]:!1}function Cv(){return yE}var vE=Be({},pd,{key:function(n){if(n.key){var e=pE[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Gd(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?gE[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cv,charCode:function(n){return n.type==="keypress"?Gd(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Gd(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),wE=Ln(vE),xE=Be({},Fp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),H0=Ln(xE),SE=Be({},pd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cv}),bE=Ln(SE),AE=Be({},bc,{propertyName:0,elapsedTime:0,pseudoElement:0}),_E=Ln(AE),EE=Be({},Fp,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),CE=Ln(EE),kE=[9,13,27,32],kv=Fi&&"CompositionEvent"in window,cu=null;Fi&&"documentMode"in document&&(cu=document.documentMode);var TE=Fi&&"TextEvent"in window&&!cu,ux=Fi&&(!kv||cu&&8<cu&&11>=cu),$0=" ",W0=!1;function hx(n,e){switch(n){case"keyup":return kE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dx(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Uo=!1;function PE(n,e){switch(n){case"compositionend":return dx(e);case"keypress":return e.which!==32?null:(W0=!0,$0);case"textInput":return n=e.data,n===$0&&W0?null:n;default:return null}}function NE(n,e){if(Uo)return n==="compositionend"||!kv&&hx(n,e)?(n=cx(),Vd=_v=Pr=null,Uo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ux&&e.locale!=="ko"?null:e.data;default:return null}}var RE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function V0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!RE[n.type]:e==="textarea"}function fx(n,e,t,s){W1(s),e=Bf(e,"onChange"),0<e.length&&(t=new Ev("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var uu=null,_u=null;function ME(n){_x(n,0)}function Op(n){var e=Wo(n);if(F1(e))return n}function LE(n,e){if(n==="change")return e}var px=!1;if(Fi){var wg;if(Fi){var xg="oninput"in document;if(!xg){var G0=document.createElement("div");G0.setAttribute("oninput","return;"),xg=typeof G0.oninput=="function"}wg=xg}else wg=!1;px=wg&&(!document.documentMode||9<document.documentMode)}function X0(){uu&&(uu.detachEvent("onpropertychange",gx),_u=uu=null)}function gx(n){if(n.propertyName==="value"&&Op(_u)){var e=[];fx(e,_u,n,wv(n)),q1(ME,e)}}function IE(n,e,t){n==="focusin"?(X0(),uu=e,_u=t,uu.attachEvent("onpropertychange",gx)):n==="focusout"&&X0()}function DE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Op(_u)}function jE(n,e){if(n==="click")return Op(e)}function FE(n,e){if(n==="input"||n==="change")return Op(e)}function OE(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Ss=typeof Object.is=="function"?Object.is:OE;function Eu(n,e){if(Ss(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var i=t[s];if(!Yg.call(e,i)||!Ss(n[i],e[i]))return!1}return!0}function q0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Y0(n,e){var t=q0(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=q0(t)}}function mx(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?mx(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function yx(){for(var n=window,e=Lf();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Lf(n.document)}return e}function Tv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function zE(n){var e=yx(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&mx(t.ownerDocument.documentElement,t)){if(s!==null&&Tv(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,r=Math.min(s.start,i);s=s.end===void 0?r:Math.min(s.end,i),!n.extend&&r>s&&(i=s,s=r,r=i),i=Y0(t,r);var a=Y0(t,s);i&&a&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),r>s?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var BE=Fi&&"documentMode"in document&&11>=document.documentMode,Ho=null,pm=null,hu=null,gm=!1;function K0(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;gm||Ho==null||Ho!==Lf(s)||(s=Ho,"selectionStart"in s&&Tv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),hu&&Eu(hu,s)||(hu=s,s=Bf(pm,"onSelect"),0<s.length&&(e=new Ev("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=Ho)))}function Td(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var $o={animationend:Td("Animation","AnimationEnd"),animationiteration:Td("Animation","AnimationIteration"),animationstart:Td("Animation","AnimationStart"),transitionend:Td("Transition","TransitionEnd")},Sg={},vx={};Fi&&(vx=document.createElement("div").style,"AnimationEvent"in window||(delete $o.animationend.animation,delete $o.animationiteration.animation,delete $o.animationstart.animation),"TransitionEvent"in window||delete $o.transitionend.transition);function zp(n){if(Sg[n])return Sg[n];if(!$o[n])return n;var e=$o[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in vx)return Sg[n]=e[t];return n}var wx=zp("animationend"),xx=zp("animationiteration"),Sx=zp("animationstart"),bx=zp("transitionend"),Ax=new Map,Q0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xr(n,e){Ax.set(n,e),Eo(e,[n])}for(var bg=0;bg<Q0.length;bg++){var Ag=Q0[bg],UE=Ag.toLowerCase(),HE=Ag[0].toUpperCase()+Ag.slice(1);Xr(UE,"on"+HE)}Xr(wx,"onAnimationEnd");Xr(xx,"onAnimationIteration");Xr(Sx,"onAnimationStart");Xr("dblclick","onDoubleClick");Xr("focusin","onFocus");Xr("focusout","onBlur");Xr(bx,"onTransitionEnd");dc("onMouseEnter",["mouseout","mouseover"]);dc("onMouseLeave",["mouseout","mouseover"]);dc("onPointerEnter",["pointerout","pointerover"]);dc("onPointerLeave",["pointerout","pointerover"]);Eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$E=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wc));function J0(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,U_(s,e,void 0,n),n.currentTarget=null}function _x(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],i=s.event;s=s.listeners;e:{var r=void 0;if(e)for(var a=s.length-1;0<=a;a--){var o=s[a],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==r&&i.isPropagationStopped())break e;J0(i,o,u),r=c}else for(a=0;a<s.length;a++){if(o=s[a],c=o.instance,u=o.currentTarget,o=o.listener,c!==r&&i.isPropagationStopped())break e;J0(i,o,u),r=c}}}if(Df)throw n=um,Df=!1,um=null,n}function ke(n,e){var t=e[xm];t===void 0&&(t=e[xm]=new Set);var s=n+"__bubble";t.has(s)||(Ex(e,n,2,!1),t.add(s))}function _g(n,e,t){var s=0;e&&(s|=4),Ex(t,n,s,e)}var Pd="_reactListening"+Math.random().toString(36).slice(2);function Cu(n){if(!n[Pd]){n[Pd]=!0,M1.forEach(function(t){t!=="selectionchange"&&($E.has(t)||_g(t,!1,n),_g(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Pd]||(e[Pd]=!0,_g("selectionchange",!1,e))}}function Ex(n,e,t,s){switch(lx(e)){case 1:var i=sE;break;case 4:i=iE;break;default:i=Av}t=i.bind(null,e,t,n),i=void 0,!cm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),s?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Eg(n,e,t,s,i){var r=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var a=s.tag;if(a===3||a===4){var o=s.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=s.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;a=a.return}for(;o!==null;){if(a=ra(o),a===null)return;if(c=a.tag,c===5||c===6){s=r=a;continue e}o=o.parentNode}}s=s.return}q1(function(){var u=r,h=wv(t),d=[];e:{var f=Ax.get(n);if(f!==void 0){var g=Ev,m=n;switch(n){case"keypress":if(Gd(t)===0)break e;case"keydown":case"keyup":g=wE;break;case"focusin":m="focus",g=vg;break;case"focusout":m="blur",g=vg;break;case"beforeblur":case"afterblur":g=vg;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=B0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=oE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=bE;break;case wx:case xx:case Sx:g=uE;break;case bx:g=_E;break;case"scroll":g=rE;break;case"wheel":g=CE;break;case"copy":case"cut":case"paste":g=dE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=H0}var w=(e&4)!==0,_=!w&&n==="scroll",v=w?f!==null?f+"Capture":null:f;w=[];for(var x=u,S;x!==null;){S=x;var E=S.stateNode;if(S.tag===5&&E!==null&&(S=E,v!==null&&(E=xu(x,v),E!=null&&w.push(ku(x,E,S)))),_)break;x=x.return}0<w.length&&(f=new g(f,m,null,t,h),d.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",f&&t!==om&&(m=t.relatedTarget||t.fromElement)&&(ra(m)||m[Oi]))break e;if((g||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,g?(m=t.relatedTarget||t.toElement,g=u,m=m?ra(m):null,m!==null&&(_=Co(m),m!==_||m.tag!==5&&m.tag!==6)&&(m=null)):(g=null,m=u),g!==m)){if(w=B0,E="onMouseLeave",v="onMouseEnter",x="mouse",(n==="pointerout"||n==="pointerover")&&(w=H0,E="onPointerLeave",v="onPointerEnter",x="pointer"),_=g==null?f:Wo(g),S=m==null?f:Wo(m),f=new w(E,x+"leave",g,t,h),f.target=_,f.relatedTarget=S,E=null,ra(h)===u&&(w=new w(v,x+"enter",m,t,h),w.target=S,w.relatedTarget=_,E=w),_=E,g&&m)t:{for(w=g,v=m,x=0,S=w;S;S=No(S))x++;for(S=0,E=v;E;E=No(E))S++;for(;0<x-S;)w=No(w),x--;for(;0<S-x;)v=No(v),S--;for(;x--;){if(w===v||v!==null&&w===v.alternate)break t;w=No(w),v=No(v)}w=null}else w=null;g!==null&&Z0(d,f,g,w,!1),m!==null&&_!==null&&Z0(d,_,m,w,!0)}}e:{if(f=u?Wo(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var C=LE;else if(V0(f))if(px)C=FE;else{C=DE;var k=IE}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(C=jE);if(C&&(C=C(n,u))){fx(d,C,t,h);break e}k&&k(n,f,u),n==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&nm(f,"number",f.value)}switch(k=u?Wo(u):window,n){case"focusin":(V0(k)||k.contentEditable==="true")&&(Ho=k,pm=u,hu=null);break;case"focusout":hu=pm=Ho=null;break;case"mousedown":gm=!0;break;case"contextmenu":case"mouseup":case"dragend":gm=!1,K0(d,t,h);break;case"selectionchange":if(BE)break;case"keydown":case"keyup":K0(d,t,h)}var P;if(kv)e:{switch(n){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Uo?hx(n,t)&&(N="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(N="onCompositionStart");N&&(ux&&t.locale!=="ko"&&(Uo||N!=="onCompositionStart"?N==="onCompositionEnd"&&Uo&&(P=cx()):(Pr=h,_v="value"in Pr?Pr.value:Pr.textContent,Uo=!0)),k=Bf(u,N),0<k.length&&(N=new U0(N,n,null,t,h),d.push({event:N,listeners:k}),P?N.data=P:(P=dx(t),P!==null&&(N.data=P)))),(P=TE?PE(n,t):NE(n,t))&&(u=Bf(u,"onBeforeInput"),0<u.length&&(h=new U0("onBeforeInput","beforeinput",null,t,h),d.push({event:h,listeners:u}),h.data=P))}_x(d,e)})}function ku(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Bf(n,e){for(var t=e+"Capture",s=[];n!==null;){var i=n,r=i.stateNode;i.tag===5&&r!==null&&(i=r,r=xu(n,t),r!=null&&s.unshift(ku(n,r,i)),r=xu(n,e),r!=null&&s.push(ku(n,r,i))),n=n.return}return s}function No(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Z0(n,e,t,s,i){for(var r=e._reactName,a=[];t!==null&&t!==s;){var o=t,c=o.alternate,u=o.stateNode;if(c!==null&&c===s)break;o.tag===5&&u!==null&&(o=u,i?(c=xu(t,r),c!=null&&a.unshift(ku(t,c,o))):i||(c=xu(t,r),c!=null&&a.push(ku(t,c,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var WE=/\r\n?/g,VE=/\u0000|\uFFFD/g;function ew(n){return(typeof n=="string"?n:""+n).replace(WE,`
`).replace(VE,"")}function Nd(n,e,t){if(e=ew(e),ew(n)!==e&&t)throw Error(L(425))}function Uf(){}var mm=null,ym=null;function vm(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var wm=typeof setTimeout=="function"?setTimeout:void 0,GE=typeof clearTimeout=="function"?clearTimeout:void 0,tw=typeof Promise=="function"?Promise:void 0,XE=typeof queueMicrotask=="function"?queueMicrotask:typeof tw<"u"?function(n){return tw.resolve(null).then(n).catch(qE)}:wm;function qE(n){setTimeout(function(){throw n})}function Cg(n,e){var t=e,s=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(s===0){n.removeChild(i),Au(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=i}while(t);Au(e)}function Dr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function nw(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Ac=Math.random().toString(36).slice(2),Xs="__reactFiber$"+Ac,Tu="__reactProps$"+Ac,Oi="__reactContainer$"+Ac,xm="__reactEvents$"+Ac,YE="__reactListeners$"+Ac,KE="__reactHandles$"+Ac;function ra(n){var e=n[Xs];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Oi]||t[Xs]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=nw(n);n!==null;){if(t=n[Xs])return t;n=nw(n)}return e}n=t,t=n.parentNode}return null}function gd(n){return n=n[Xs]||n[Oi],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Wo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(L(33))}function Bp(n){return n[Tu]||null}var Sm=[],Vo=-1;function qr(n){return{current:n}}function Pe(n){0>Vo||(n.current=Sm[Vo],Sm[Vo]=null,Vo--)}function Ce(n,e){Vo++,Sm[Vo]=n.current,n.current=e}var $r={},jt=qr($r),cn=qr(!1),go=$r;function fc(n,e){var t=n.type.contextTypes;if(!t)return $r;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var i={},r;for(r in t)i[r]=e[r];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function un(n){return n=n.childContextTypes,n!=null}function Hf(){Pe(cn),Pe(jt)}function sw(n,e,t){if(jt.current!==$r)throw Error(L(168));Ce(jt,e),Ce(cn,t)}function Cx(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var i in s)if(!(i in e))throw Error(L(108,I_(n)||"Unknown",i));return Be({},t,s)}function $f(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||$r,go=jt.current,Ce(jt,n),Ce(cn,cn.current),!0}function iw(n,e,t){var s=n.stateNode;if(!s)throw Error(L(169));t?(n=Cx(n,e,go),s.__reactInternalMemoizedMergedChildContext=n,Pe(cn),Pe(jt),Ce(jt,n)):Pe(cn),Ce(cn,t)}var ri=null,Up=!1,kg=!1;function kx(n){ri===null?ri=[n]:ri.push(n)}function QE(n){Up=!0,kx(n)}function Yr(){if(!kg&&ri!==null){kg=!0;var n=0,e=xe;try{var t=ri;for(xe=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}ri=null,Up=!1}catch(i){throw ri!==null&&(ri=ri.slice(n+1)),J1(xv,Yr),i}finally{xe=e,kg=!1}}return null}var Go=[],Xo=0,Wf=null,Vf=0,Hn=[],$n=0,mo=null,Mi=1,Li="";function Qr(n,e){Go[Xo++]=Vf,Go[Xo++]=Wf,Wf=n,Vf=e}function Tx(n,e,t){Hn[$n++]=Mi,Hn[$n++]=Li,Hn[$n++]=mo,mo=n;var s=Mi;n=Li;var i=32-ws(s)-1;s&=~(1<<i),t+=1;var r=32-ws(e)+i;if(30<r){var a=i-i%5;r=(s&(1<<a)-1).toString(32),s>>=a,i-=a,Mi=1<<32-ws(e)+i|t<<i|s,Li=r+n}else Mi=1<<r|t<<i|s,Li=n}function Pv(n){n.return!==null&&(Qr(n,1),Tx(n,1,0))}function Nv(n){for(;n===Wf;)Wf=Go[--Xo],Go[Xo]=null,Vf=Go[--Xo],Go[Xo]=null;for(;n===mo;)mo=Hn[--$n],Hn[$n]=null,Li=Hn[--$n],Hn[$n]=null,Mi=Hn[--$n],Hn[$n]=null}var Pn=null,Tn=null,Le=!1,ys=null;function Px(n,e){var t=Gn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function rw(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Pn=n,Tn=Dr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Pn=n,Tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=mo!==null?{id:Mi,overflow:Li}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Gn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Pn=n,Tn=null,!0):!1;default:return!1}}function bm(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Am(n){if(Le){var e=Tn;if(e){var t=e;if(!rw(n,e)){if(bm(n))throw Error(L(418));e=Dr(t.nextSibling);var s=Pn;e&&rw(n,e)?Px(s,t):(n.flags=n.flags&-4097|2,Le=!1,Pn=n)}}else{if(bm(n))throw Error(L(418));n.flags=n.flags&-4097|2,Le=!1,Pn=n}}}function aw(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Pn=n}function Rd(n){if(n!==Pn)return!1;if(!Le)return aw(n),Le=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!vm(n.type,n.memoizedProps)),e&&(e=Tn)){if(bm(n))throw Nx(),Error(L(418));for(;e;)Px(n,e),e=Dr(e.nextSibling)}if(aw(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(L(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Tn=Dr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Tn=null}}else Tn=Pn?Dr(n.stateNode.nextSibling):null;return!0}function Nx(){for(var n=Tn;n;)n=Dr(n.nextSibling)}function pc(){Tn=Pn=null,Le=!1}function Rv(n){ys===null?ys=[n]:ys.push(n)}var JE=$i.ReactCurrentBatchConfig;function Mc(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(L(309));var s=t.stateNode}if(!s)throw Error(L(147,n));var i=s,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(a){var o=i.refs;a===null?delete o[r]:o[r]=a},e._stringRef=r,e)}if(typeof n!="string")throw Error(L(284));if(!t._owner)throw Error(L(290,n))}return n}function Md(n,e){throw n=Object.prototype.toString.call(e),Error(L(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ow(n){var e=n._init;return e(n._payload)}function Rx(n){function e(v,x){if(n){var S=v.deletions;S===null?(v.deletions=[x],v.flags|=16):S.push(x)}}function t(v,x){if(!n)return null;for(;x!==null;)e(v,x),x=x.sibling;return null}function s(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function i(v,x){return v=zr(v,x),v.index=0,v.sibling=null,v}function r(v,x,S){return v.index=S,n?(S=v.alternate,S!==null?(S=S.index,S<x?(v.flags|=2,x):S):(v.flags|=2,x)):(v.flags|=1048576,x)}function a(v){return n&&v.alternate===null&&(v.flags|=2),v}function o(v,x,S,E){return x===null||x.tag!==6?(x=Ig(S,v.mode,E),x.return=v,x):(x=i(x,S),x.return=v,x)}function c(v,x,S,E){var C=S.type;return C===Bo?h(v,x,S.props.children,E,S.key):x!==null&&(x.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===qi&&ow(C)===x.type)?(E=i(x,S.props),E.ref=Mc(v,x,S),E.return=v,E):(E=Zd(S.type,S.key,S.props,null,v.mode,E),E.ref=Mc(v,x,S),E.return=v,E)}function u(v,x,S,E){return x===null||x.tag!==4||x.stateNode.containerInfo!==S.containerInfo||x.stateNode.implementation!==S.implementation?(x=Dg(S,v.mode,E),x.return=v,x):(x=i(x,S.children||[]),x.return=v,x)}function h(v,x,S,E,C){return x===null||x.tag!==7?(x=po(S,v.mode,E,C),x.return=v,x):(x=i(x,S),x.return=v,x)}function d(v,x,S){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ig(""+x,v.mode,S),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Sd:return S=Zd(x.type,x.key,x.props,null,v.mode,S),S.ref=Mc(v,null,x),S.return=v,S;case zo:return x=Dg(x,v.mode,S),x.return=v,x;case qi:var E=x._init;return d(v,E(x._payload),S)}if(Hc(x)||kc(x))return x=po(x,v.mode,S,null),x.return=v,x;Md(v,x)}return null}function f(v,x,S,E){var C=x!==null?x.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return C!==null?null:o(v,x,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Sd:return S.key===C?c(v,x,S,E):null;case zo:return S.key===C?u(v,x,S,E):null;case qi:return C=S._init,f(v,x,C(S._payload),E)}if(Hc(S)||kc(S))return C!==null?null:h(v,x,S,E,null);Md(v,S)}return null}function g(v,x,S,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return v=v.get(S)||null,o(x,v,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Sd:return v=v.get(E.key===null?S:E.key)||null,c(x,v,E,C);case zo:return v=v.get(E.key===null?S:E.key)||null,u(x,v,E,C);case qi:var k=E._init;return g(v,x,S,k(E._payload),C)}if(Hc(E)||kc(E))return v=v.get(S)||null,h(x,v,E,C,null);Md(x,E)}return null}function m(v,x,S,E){for(var C=null,k=null,P=x,N=x=0,R=null;P!==null&&N<S.length;N++){P.index>N?(R=P,P=null):R=P.sibling;var D=f(v,P,S[N],E);if(D===null){P===null&&(P=R);break}n&&P&&D.alternate===null&&e(v,P),x=r(D,x,N),k===null?C=D:k.sibling=D,k=D,P=R}if(N===S.length)return t(v,P),Le&&Qr(v,N),C;if(P===null){for(;N<S.length;N++)P=d(v,S[N],E),P!==null&&(x=r(P,x,N),k===null?C=P:k.sibling=P,k=P);return Le&&Qr(v,N),C}for(P=s(v,P);N<S.length;N++)R=g(P,v,N,S[N],E),R!==null&&(n&&R.alternate!==null&&P.delete(R.key===null?N:R.key),x=r(R,x,N),k===null?C=R:k.sibling=R,k=R);return n&&P.forEach(function(B){return e(v,B)}),Le&&Qr(v,N),C}function w(v,x,S,E){var C=kc(S);if(typeof C!="function")throw Error(L(150));if(S=C.call(S),S==null)throw Error(L(151));for(var k=C=null,P=x,N=x=0,R=null,D=S.next();P!==null&&!D.done;N++,D=S.next()){P.index>N?(R=P,P=null):R=P.sibling;var B=f(v,P,D.value,E);if(B===null){P===null&&(P=R);break}n&&P&&B.alternate===null&&e(v,P),x=r(B,x,N),k===null?C=B:k.sibling=B,k=B,P=R}if(D.done)return t(v,P),Le&&Qr(v,N),C;if(P===null){for(;!D.done;N++,D=S.next())D=d(v,D.value,E),D!==null&&(x=r(D,x,N),k===null?C=D:k.sibling=D,k=D);return Le&&Qr(v,N),C}for(P=s(v,P);!D.done;N++,D=S.next())D=g(P,v,N,D.value,E),D!==null&&(n&&D.alternate!==null&&P.delete(D.key===null?N:D.key),x=r(D,x,N),k===null?C=D:k.sibling=D,k=D);return n&&P.forEach(function(ae){return e(v,ae)}),Le&&Qr(v,N),C}function _(v,x,S,E){if(typeof S=="object"&&S!==null&&S.type===Bo&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Sd:e:{for(var C=S.key,k=x;k!==null;){if(k.key===C){if(C=S.type,C===Bo){if(k.tag===7){t(v,k.sibling),x=i(k,S.props.children),x.return=v,v=x;break e}}else if(k.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===qi&&ow(C)===k.type){t(v,k.sibling),x=i(k,S.props),x.ref=Mc(v,k,S),x.return=v,v=x;break e}t(v,k);break}else e(v,k);k=k.sibling}S.type===Bo?(x=po(S.props.children,v.mode,E,S.key),x.return=v,v=x):(E=Zd(S.type,S.key,S.props,null,v.mode,E),E.ref=Mc(v,x,S),E.return=v,v=E)}return a(v);case zo:e:{for(k=S.key;x!==null;){if(x.key===k)if(x.tag===4&&x.stateNode.containerInfo===S.containerInfo&&x.stateNode.implementation===S.implementation){t(v,x.sibling),x=i(x,S.children||[]),x.return=v,v=x;break e}else{t(v,x);break}else e(v,x);x=x.sibling}x=Dg(S,v.mode,E),x.return=v,v=x}return a(v);case qi:return k=S._init,_(v,x,k(S._payload),E)}if(Hc(S))return m(v,x,S,E);if(kc(S))return w(v,x,S,E);Md(v,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,x!==null&&x.tag===6?(t(v,x.sibling),x=i(x,S),x.return=v,v=x):(t(v,x),x=Ig(S,v.mode,E),x.return=v,v=x),a(v)):t(v,x)}return _}var gc=Rx(!0),Mx=Rx(!1),Gf=qr(null),Xf=null,qo=null,Mv=null;function Lv(){Mv=qo=Xf=null}function Iv(n){var e=Gf.current;Pe(Gf),n._currentValue=e}function _m(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function sl(n,e){Xf=n,Mv=qo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(ln=!0),n.firstContext=null)}function Yn(n){var e=n._currentValue;if(Mv!==n)if(n={context:n,memoizedValue:e,next:null},qo===null){if(Xf===null)throw Error(L(308));qo=n,Xf.dependencies={lanes:0,firstContext:n}}else qo=qo.next=n;return e}var aa=null;function Dv(n){aa===null?aa=[n]:aa.push(n)}function Lx(n,e,t,s){var i=e.interleaved;return i===null?(t.next=t,Dv(e)):(t.next=i.next,i.next=t),e.interleaved=t,zi(n,s)}function zi(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Yi=!1;function jv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ix(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ii(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function jr(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,he&2){var i=s.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),s.pending=e,zi(n,t)}return i=s.interleaved,i===null?(e.next=e,Dv(s)):(e.next=i.next,i.next=e),s.interleaved=e,zi(n,t)}function Xd(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,Sv(n,t)}}function lw(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var i=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?i=r=a:r=r.next=a,t=t.next}while(t!==null);r===null?i=r=e:r=r.next=e}else i=r=e;t={baseState:s.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function qf(n,e,t,s){var i=n.updateQueue;Yi=!1;var r=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var c=o,u=c.next;c.next=null,a===null?r=u:a.next=u,a=c;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=c))}if(r!==null){var d=i.baseState;a=0,h=u=c=null,o=r;do{var f=o.lane,g=o.eventTime;if((s&f)===f){h!==null&&(h=h.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=n,w=o;switch(f=e,g=t,w.tag){case 1:if(m=w.payload,typeof m=="function"){d=m.call(g,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=w.payload,f=typeof m=="function"?m.call(g,d,f):m,f==null)break e;d=Be({},d,f);break e;case 2:Yi=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,f=i.effects,f===null?i.effects=[o]:f.push(o))}else g={eventTime:g,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(u=h=g,c=d):h=h.next=g,a|=f;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;f=o,o=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(h===null&&(c=d),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else r===null&&(i.shared.lanes=0);vo|=a,n.lanes=a,n.memoizedState=d}}function cw(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],i=s.callback;if(i!==null){if(s.callback=null,s=t,typeof i!="function")throw Error(L(191,i));i.call(s)}}}var md={},Ks=qr(md),Pu=qr(md),Nu=qr(md);function oa(n){if(n===md)throw Error(L(174));return n}function Fv(n,e){switch(Ce(Nu,e),Ce(Pu,n),Ce(Ks,md),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:im(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=im(e,n)}Pe(Ks),Ce(Ks,e)}function mc(){Pe(Ks),Pe(Pu),Pe(Nu)}function Dx(n){oa(Nu.current);var e=oa(Ks.current),t=im(e,n.type);e!==t&&(Ce(Pu,n),Ce(Ks,t))}function Ov(n){Pu.current===n&&(Pe(Ks),Pe(Pu))}var je=qr(0);function Yf(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Tg=[];function zv(){for(var n=0;n<Tg.length;n++)Tg[n]._workInProgressVersionPrimary=null;Tg.length=0}var qd=$i.ReactCurrentDispatcher,Pg=$i.ReactCurrentBatchConfig,yo=0,Oe=null,nt=null,ht=null,Kf=!1,du=!1,Ru=0,ZE=0;function _t(){throw Error(L(321))}function Bv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Ss(n[t],e[t]))return!1;return!0}function Uv(n,e,t,s,i,r){if(yo=r,Oe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,qd.current=n===null||n.memoizedState===null?sC:iC,n=t(s,i),du){r=0;do{if(du=!1,Ru=0,25<=r)throw Error(L(301));r+=1,ht=nt=null,e.updateQueue=null,qd.current=rC,n=t(s,i)}while(du)}if(qd.current=Qf,e=nt!==null&&nt.next!==null,yo=0,ht=nt=Oe=null,Kf=!1,e)throw Error(L(300));return n}function Hv(){var n=Ru!==0;return Ru=0,n}function Ps(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Oe.memoizedState=ht=n:ht=ht.next=n,ht}function Kn(){if(nt===null){var n=Oe.alternate;n=n!==null?n.memoizedState:null}else n=nt.next;var e=ht===null?Oe.memoizedState:ht.next;if(e!==null)ht=e,nt=n;else{if(n===null)throw Error(L(310));nt=n,n={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},ht===null?Oe.memoizedState=ht=n:ht=ht.next=n}return ht}function Mu(n,e){return typeof e=="function"?e(n):e}function Ng(n){var e=Kn(),t=e.queue;if(t===null)throw Error(L(311));t.lastRenderedReducer=n;var s=nt,i=s.baseQueue,r=t.pending;if(r!==null){if(i!==null){var a=i.next;i.next=r.next,r.next=a}s.baseQueue=i=r,t.pending=null}if(i!==null){r=i.next,s=s.baseState;var o=a=null,c=null,u=r;do{var h=u.lane;if((yo&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:n(s,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,a=s):c=c.next=d,Oe.lanes|=h,vo|=h}u=u.next}while(u!==null&&u!==r);c===null?a=s:c.next=o,Ss(s,e.memoizedState)||(ln=!0),e.memoizedState=s,e.baseState=a,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){i=n;do r=i.lane,Oe.lanes|=r,vo|=r,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Rg(n){var e=Kn(),t=e.queue;if(t===null)throw Error(L(311));t.lastRenderedReducer=n;var s=t.dispatch,i=t.pending,r=e.memoizedState;if(i!==null){t.pending=null;var a=i=i.next;do r=n(r,a.action),a=a.next;while(a!==i);Ss(r,e.memoizedState)||(ln=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,s]}function jx(){}function Fx(n,e){var t=Oe,s=Kn(),i=e(),r=!Ss(s.memoizedState,i);if(r&&(s.memoizedState=i,ln=!0),s=s.queue,$v(Bx.bind(null,t,s,n),[n]),s.getSnapshot!==e||r||ht!==null&&ht.memoizedState.tag&1){if(t.flags|=2048,Lu(9,zx.bind(null,t,s,i,e),void 0,null),dt===null)throw Error(L(349));yo&30||Ox(t,e,i)}return i}function Ox(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Oe.updateQueue,e===null?(e={lastEffect:null,stores:null},Oe.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function zx(n,e,t,s){e.value=t,e.getSnapshot=s,Ux(e)&&Hx(n)}function Bx(n,e,t){return t(function(){Ux(e)&&Hx(n)})}function Ux(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Ss(n,t)}catch{return!0}}function Hx(n){var e=zi(n,1);e!==null&&xs(e,n,1,-1)}function uw(n){var e=Ps();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mu,lastRenderedState:n},e.queue=n,n=n.dispatch=nC.bind(null,Oe,n),[e.memoizedState,n]}function Lu(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=Oe.updateQueue,e===null?(e={lastEffect:null,stores:null},Oe.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function $x(){return Kn().memoizedState}function Yd(n,e,t,s){var i=Ps();Oe.flags|=n,i.memoizedState=Lu(1|e,t,void 0,s===void 0?null:s)}function Hp(n,e,t,s){var i=Kn();s=s===void 0?null:s;var r=void 0;if(nt!==null){var a=nt.memoizedState;if(r=a.destroy,s!==null&&Bv(s,a.deps)){i.memoizedState=Lu(e,t,r,s);return}}Oe.flags|=n,i.memoizedState=Lu(1|e,t,r,s)}function hw(n,e){return Yd(8390656,8,n,e)}function $v(n,e){return Hp(2048,8,n,e)}function Wx(n,e){return Hp(4,2,n,e)}function Vx(n,e){return Hp(4,4,n,e)}function Gx(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Xx(n,e,t){return t=t!=null?t.concat([n]):null,Hp(4,4,Gx.bind(null,e,n),t)}function Wv(){}function qx(n,e){var t=Kn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Bv(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function Yx(n,e){var t=Kn();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Bv(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function Kx(n,e,t){return yo&21?(Ss(t,e)||(t=tx(),Oe.lanes|=t,vo|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,ln=!0),n.memoizedState=t)}function eC(n,e){var t=xe;xe=t!==0&&4>t?t:4,n(!0);var s=Pg.transition;Pg.transition={};try{n(!1),e()}finally{xe=t,Pg.transition=s}}function Qx(){return Kn().memoizedState}function tC(n,e,t){var s=Or(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},Jx(n))Zx(e,t);else if(t=Lx(n,e,t,s),t!==null){var i=Gt();xs(t,n,s,i),eS(t,e,s)}}function nC(n,e,t){var s=Or(n),i={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(Jx(n))Zx(e,i);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var a=e.lastRenderedState,o=r(a,t);if(i.hasEagerState=!0,i.eagerState=o,Ss(o,a)){var c=e.interleaved;c===null?(i.next=i,Dv(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}t=Lx(n,e,i,s),t!==null&&(i=Gt(),xs(t,n,s,i),eS(t,e,s))}}function Jx(n){var e=n.alternate;return n===Oe||e!==null&&e===Oe}function Zx(n,e){du=Kf=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function eS(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,Sv(n,t)}}var Qf={readContext:Yn,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useInsertionEffect:_t,useLayoutEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useMutableSource:_t,useSyncExternalStore:_t,useId:_t,unstable_isNewReconciler:!1},sC={readContext:Yn,useCallback:function(n,e){return Ps().memoizedState=[n,e===void 0?null:e],n},useContext:Yn,useEffect:hw,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Yd(4194308,4,Gx.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Yd(4194308,4,n,e)},useInsertionEffect:function(n,e){return Yd(4,2,n,e)},useMemo:function(n,e){var t=Ps();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=Ps();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=tC.bind(null,Oe,n),[s.memoizedState,n]},useRef:function(n){var e=Ps();return n={current:n},e.memoizedState=n},useState:uw,useDebugValue:Wv,useDeferredValue:function(n){return Ps().memoizedState=n},useTransition:function(){var n=uw(!1),e=n[0];return n=eC.bind(null,n[1]),Ps().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=Oe,i=Ps();if(Le){if(t===void 0)throw Error(L(407));t=t()}else{if(t=e(),dt===null)throw Error(L(349));yo&30||Ox(s,e,t)}i.memoizedState=t;var r={value:t,getSnapshot:e};return i.queue=r,hw(Bx.bind(null,s,r,n),[n]),s.flags|=2048,Lu(9,zx.bind(null,s,r,t,e),void 0,null),t},useId:function(){var n=Ps(),e=dt.identifierPrefix;if(Le){var t=Li,s=Mi;t=(s&~(1<<32-ws(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ru++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=ZE++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},iC={readContext:Yn,useCallback:qx,useContext:Yn,useEffect:$v,useImperativeHandle:Xx,useInsertionEffect:Wx,useLayoutEffect:Vx,useMemo:Yx,useReducer:Ng,useRef:$x,useState:function(){return Ng(Mu)},useDebugValue:Wv,useDeferredValue:function(n){var e=Kn();return Kx(e,nt.memoizedState,n)},useTransition:function(){var n=Ng(Mu)[0],e=Kn().memoizedState;return[n,e]},useMutableSource:jx,useSyncExternalStore:Fx,useId:Qx,unstable_isNewReconciler:!1},rC={readContext:Yn,useCallback:qx,useContext:Yn,useEffect:$v,useImperativeHandle:Xx,useInsertionEffect:Wx,useLayoutEffect:Vx,useMemo:Yx,useReducer:Rg,useRef:$x,useState:function(){return Rg(Mu)},useDebugValue:Wv,useDeferredValue:function(n){var e=Kn();return nt===null?e.memoizedState=n:Kx(e,nt.memoizedState,n)},useTransition:function(){var n=Rg(Mu)[0],e=Kn().memoizedState;return[n,e]},useMutableSource:jx,useSyncExternalStore:Fx,useId:Qx,unstable_isNewReconciler:!1};function ns(n,e){if(n&&n.defaultProps){e=Be({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Em(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:Be({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var $p={isMounted:function(n){return(n=n._reactInternals)?Co(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=Gt(),i=Or(n),r=Ii(s,i);r.payload=e,t!=null&&(r.callback=t),e=jr(n,r,i),e!==null&&(xs(e,n,i,s),Xd(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=Gt(),i=Or(n),r=Ii(s,i);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=jr(n,r,i),e!==null&&(xs(e,n,i,s),Xd(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Gt(),s=Or(n),i=Ii(t,s);i.tag=2,e!=null&&(i.callback=e),e=jr(n,i,s),e!==null&&(xs(e,n,s,t),Xd(e,n,s))}};function dw(n,e,t,s,i,r,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,r,a):e.prototype&&e.prototype.isPureReactComponent?!Eu(t,s)||!Eu(i,r):!0}function tS(n,e,t){var s=!1,i=$r,r=e.contextType;return typeof r=="object"&&r!==null?r=Yn(r):(i=un(e)?go:jt.current,s=e.contextTypes,r=(s=s!=null)?fc(n,i):$r),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=$p,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=r),e}function fw(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&$p.enqueueReplaceState(e,e.state,null)}function Cm(n,e,t,s){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},jv(n);var r=e.contextType;typeof r=="object"&&r!==null?i.context=Yn(r):(r=un(e)?go:jt.current,i.context=fc(n,r)),i.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(Em(n,e,r,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&$p.enqueueReplaceState(i,i.state,null),qf(n,t,i,s),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function yc(n,e){try{var t="",s=e;do t+=L_(s),s=s.return;while(s);var i=t}catch(r){i=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:i,digest:null}}function Mg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function km(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var aC=typeof WeakMap=="function"?WeakMap:Map;function nS(n,e,t){t=Ii(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){Zf||(Zf=!0,Fm=s),km(n,e)},t}function sS(n,e,t){t=Ii(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var i=e.value;t.payload=function(){return s(i)},t.callback=function(){km(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){km(n,e),typeof s!="function"&&(Fr===null?Fr=new Set([this]):Fr.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function pw(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new aC;var i=new Set;s.set(e,i)}else i=s.get(e),i===void 0&&(i=new Set,s.set(e,i));i.has(t)||(i.add(t),n=xC.bind(null,n,e,t),e.then(n,n))}function gw(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function mw(n,e,t,s,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ii(-1,1),e.tag=2,jr(t,e,1))),t.lanes|=1),n)}var oC=$i.ReactCurrentOwner,ln=!1;function Vt(n,e,t,s){e.child=n===null?Mx(e,null,t,s):gc(e,n.child,t,s)}function yw(n,e,t,s,i){t=t.render;var r=e.ref;return sl(e,i),s=Uv(n,e,t,s,r,i),t=Hv(),n!==null&&!ln?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Bi(n,e,i)):(Le&&t&&Pv(e),e.flags|=1,Vt(n,e,s,i),e.child)}function vw(n,e,t,s,i){if(n===null){var r=t.type;return typeof r=="function"&&!Jv(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,iS(n,e,r,s,i)):(n=Zd(t.type,null,s,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&i)){var a=r.memoizedProps;if(t=t.compare,t=t!==null?t:Eu,t(a,s)&&n.ref===e.ref)return Bi(n,e,i)}return e.flags|=1,n=zr(r,s),n.ref=e.ref,n.return=e,e.child=n}function iS(n,e,t,s,i){if(n!==null){var r=n.memoizedProps;if(Eu(r,s)&&n.ref===e.ref)if(ln=!1,e.pendingProps=s=r,(n.lanes&i)!==0)n.flags&131072&&(ln=!0);else return e.lanes=n.lanes,Bi(n,e,i)}return Tm(n,e,t,s,i)}function rS(n,e,t){var s=e.pendingProps,i=s.children,r=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(Ko,En),En|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ce(Ko,En),En|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=r!==null?r.baseLanes:t,Ce(Ko,En),En|=s}else r!==null?(s=r.baseLanes|t,e.memoizedState=null):s=t,Ce(Ko,En),En|=s;return Vt(n,e,i,t),e.child}function aS(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Tm(n,e,t,s,i){var r=un(t)?go:jt.current;return r=fc(e,r),sl(e,i),t=Uv(n,e,t,s,r,i),s=Hv(),n!==null&&!ln?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Bi(n,e,i)):(Le&&s&&Pv(e),e.flags|=1,Vt(n,e,t,i),e.child)}function ww(n,e,t,s,i){if(un(t)){var r=!0;$f(e)}else r=!1;if(sl(e,i),e.stateNode===null)Kd(n,e),tS(e,t,s),Cm(e,t,s,i),s=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var c=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=Yn(u):(u=un(t)?go:jt.current,u=fc(e,u));var h=t.getDerivedStateFromProps,d=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==s||c!==u)&&fw(e,a,s,u),Yi=!1;var f=e.memoizedState;a.state=f,qf(e,s,a,i),c=e.memoizedState,o!==s||f!==c||cn.current||Yi?(typeof h=="function"&&(Em(e,t,h,s),c=e.memoizedState),(o=Yi||dw(e,t,o,s,f,c,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),a.props=s,a.state=c,a.context=u,s=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{a=e.stateNode,Ix(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:ns(e.type,o),a.props=u,d=e.pendingProps,f=a.context,c=t.contextType,typeof c=="object"&&c!==null?c=Yn(c):(c=un(t)?go:jt.current,c=fc(e,c));var g=t.getDerivedStateFromProps;(h=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==c)&&fw(e,a,s,c),Yi=!1,f=e.memoizedState,a.state=f,qf(e,s,a,i);var m=e.memoizedState;o!==d||f!==m||cn.current||Yi?(typeof g=="function"&&(Em(e,t,g,s),m=e.memoizedState),(u=Yi||dw(e,t,u,s,f,m,c)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(s,m,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(s,m,c)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=m),a.props=s,a.state=m,a.context=c,s=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&f===n.memoizedState||(e.flags|=1024),s=!1)}return Pm(n,e,t,s,r,i)}function Pm(n,e,t,s,i,r){aS(n,e);var a=(e.flags&128)!==0;if(!s&&!a)return i&&iw(e,t,!1),Bi(n,e,r);s=e.stateNode,oC.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&a?(e.child=gc(e,n.child,null,r),e.child=gc(e,null,o,r)):Vt(n,e,o,r),e.memoizedState=s.state,i&&iw(e,t,!0),e.child}function oS(n){var e=n.stateNode;e.pendingContext?sw(n,e.pendingContext,e.pendingContext!==e.context):e.context&&sw(n,e.context,!1),Fv(n,e.containerInfo)}function xw(n,e,t,s,i){return pc(),Rv(i),e.flags|=256,Vt(n,e,t,s),e.child}var Nm={dehydrated:null,treeContext:null,retryLane:0};function Rm(n){return{baseLanes:n,cachePool:null,transitions:null}}function lS(n,e,t){var s=e.pendingProps,i=je.current,r=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(i&2)!==0),o?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Ce(je,i&1),n===null)return Am(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=s.children,n=s.fallback,r?(s=e.mode,r=e.child,a={mode:"hidden",children:a},!(s&1)&&r!==null?(r.childLanes=0,r.pendingProps=a):r=Gp(a,s,0,null),n=po(n,s,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=Rm(t),e.memoizedState=Nm,n):Vv(e,a));if(i=n.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return lC(n,e,a,s,o,i,t);if(r){r=s.fallback,a=e.mode,i=n.child,o=i.sibling;var c={mode:"hidden",children:s.children};return!(a&1)&&e.child!==i?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=zr(i,c),s.subtreeFlags=i.subtreeFlags&14680064),o!==null?r=zr(o,r):(r=po(r,a,t,null),r.flags|=2),r.return=e,s.return=e,s.sibling=r,e.child=s,s=r,r=e.child,a=n.child.memoizedState,a=a===null?Rm(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},r.memoizedState=a,r.childLanes=n.childLanes&~t,e.memoizedState=Nm,s}return r=n.child,n=r.sibling,s=zr(r,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function Vv(n,e){return e=Gp({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ld(n,e,t,s){return s!==null&&Rv(s),gc(e,n.child,null,t),n=Vv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function lC(n,e,t,s,i,r,a){if(t)return e.flags&256?(e.flags&=-257,s=Mg(Error(L(422))),Ld(n,e,a,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=s.fallback,i=e.mode,s=Gp({mode:"visible",children:s.children},i,0,null),r=po(r,i,a,null),r.flags|=2,s.return=e,r.return=e,s.sibling=r,e.child=s,e.mode&1&&gc(e,n.child,null,a),e.child.memoizedState=Rm(a),e.memoizedState=Nm,r);if(!(e.mode&1))return Ld(n,e,a,null);if(i.data==="$!"){if(s=i.nextSibling&&i.nextSibling.dataset,s)var o=s.dgst;return s=o,r=Error(L(419)),s=Mg(r,s,void 0),Ld(n,e,a,s)}if(o=(a&n.childLanes)!==0,ln||o){if(s=dt,s!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(s.suspendedLanes|a)?0:i,i!==0&&i!==r.retryLane&&(r.retryLane=i,zi(n,i),xs(s,n,i,-1))}return Qv(),s=Mg(Error(L(421))),Ld(n,e,a,s)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=SC.bind(null,n),i._reactRetry=e,null):(n=r.treeContext,Tn=Dr(i.nextSibling),Pn=e,Le=!0,ys=null,n!==null&&(Hn[$n++]=Mi,Hn[$n++]=Li,Hn[$n++]=mo,Mi=n.id,Li=n.overflow,mo=e),e=Vv(e,s.children),e.flags|=4096,e)}function Sw(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),_m(n.return,e,t)}function Lg(n,e,t,s,i){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:i}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=s,r.tail=t,r.tailMode=i)}function cS(n,e,t){var s=e.pendingProps,i=s.revealOrder,r=s.tail;if(Vt(n,e,s.children,t),s=je.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Sw(n,t,e);else if(n.tag===19)Sw(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Ce(je,s),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Yf(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Lg(e,!1,i,t,r);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Yf(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Lg(e,!0,t,null,r);break;case"together":Lg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Kd(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Bi(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),vo|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(L(153));if(e.child!==null){for(n=e.child,t=zr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=zr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function cC(n,e,t){switch(e.tag){case 3:oS(e),pc();break;case 5:Dx(e);break;case 1:un(e.type)&&$f(e);break;case 4:Fv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,i=e.memoizedProps.value;Ce(Gf,s._currentValue),s._currentValue=i;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Ce(je,je.current&1),e.flags|=128,null):t&e.child.childLanes?lS(n,e,t):(Ce(je,je.current&1),n=Bi(n,e,t),n!==null?n.sibling:null);Ce(je,je.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return cS(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ce(je,je.current),s)break;return null;case 22:case 23:return e.lanes=0,rS(n,e,t)}return Bi(n,e,t)}var uS,Mm,hS,dS;uS=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Mm=function(){};hS=function(n,e,t,s){var i=n.memoizedProps;if(i!==s){n=e.stateNode,oa(Ks.current);var r=null;switch(t){case"input":i=em(n,i),s=em(n,s),r=[];break;case"select":i=Be({},i,{value:void 0}),s=Be({},s,{value:void 0}),r=[];break;case"textarea":i=sm(n,i),s=sm(n,s),r=[];break;default:typeof i.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Uf)}rm(t,s);var a;t=null;for(u in i)if(!s.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(vu.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in s){var c=s[u];if(o=i!=null?i[u]:void 0,s.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(t||(t={}),t[a]=c[a])}else t||(r||(r=[]),r.push(u,t)),t=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(r=r||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(vu.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ke("scroll",n),r||o===c||(r=[])):(r=r||[]).push(u,c))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};dS=function(n,e,t,s){t!==s&&(e.flags|=4)};function Lc(n,e){if(!Le)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function Et(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags&14680064,s|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,s|=i.subtreeFlags,s|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function uC(n,e,t){var s=e.pendingProps;switch(Nv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(e),null;case 1:return un(e.type)&&Hf(),Et(e),null;case 3:return s=e.stateNode,mc(),Pe(cn),Pe(jt),zv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(Rd(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ys!==null&&(Bm(ys),ys=null))),Mm(n,e),Et(e),null;case 5:Ov(e);var i=oa(Nu.current);if(t=e.type,n!==null&&e.stateNode!=null)hS(n,e,t,s,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(L(166));return Et(e),null}if(n=oa(Ks.current),Rd(e)){s=e.stateNode,t=e.type;var r=e.memoizedProps;switch(s[Xs]=e,s[Tu]=r,n=(e.mode&1)!==0,t){case"dialog":ke("cancel",s),ke("close",s);break;case"iframe":case"object":case"embed":ke("load",s);break;case"video":case"audio":for(i=0;i<Wc.length;i++)ke(Wc[i],s);break;case"source":ke("error",s);break;case"img":case"image":case"link":ke("error",s),ke("load",s);break;case"details":ke("toggle",s);break;case"input":N0(s,r),ke("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!r.multiple},ke("invalid",s);break;case"textarea":M0(s,r),ke("invalid",s)}rm(t,r),i=null;for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];a==="children"?typeof o=="string"?s.textContent!==o&&(r.suppressHydrationWarning!==!0&&Nd(s.textContent,o,n),i=["children",o]):typeof o=="number"&&s.textContent!==""+o&&(r.suppressHydrationWarning!==!0&&Nd(s.textContent,o,n),i=["children",""+o]):vu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&ke("scroll",s)}switch(t){case"input":bd(s),R0(s,r,!0);break;case"textarea":bd(s),L0(s);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(s.onclick=Uf)}s=i,e.updateQueue=s,s!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=B1(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=a.createElement(t,{is:s.is}):(n=a.createElement(t),t==="select"&&(a=n,s.multiple?a.multiple=!0:s.size&&(a.size=s.size))):n=a.createElementNS(n,t),n[Xs]=e,n[Tu]=s,uS(n,e,!1,!1),e.stateNode=n;e:{switch(a=am(t,s),t){case"dialog":ke("cancel",n),ke("close",n),i=s;break;case"iframe":case"object":case"embed":ke("load",n),i=s;break;case"video":case"audio":for(i=0;i<Wc.length;i++)ke(Wc[i],n);i=s;break;case"source":ke("error",n),i=s;break;case"img":case"image":case"link":ke("error",n),ke("load",n),i=s;break;case"details":ke("toggle",n),i=s;break;case"input":N0(n,s),i=em(n,s),ke("invalid",n);break;case"option":i=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},i=Be({},s,{value:void 0}),ke("invalid",n);break;case"textarea":M0(n,s),i=sm(n,s),ke("invalid",n);break;default:i=s}rm(t,i),o=i;for(r in o)if(o.hasOwnProperty(r)){var c=o[r];r==="style"?$1(n,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&U1(n,c)):r==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&wu(n,c):typeof c=="number"&&wu(n,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(vu.hasOwnProperty(r)?c!=null&&r==="onScroll"&&ke("scroll",n):c!=null&&gv(n,r,c,a))}switch(t){case"input":bd(n),R0(n,s,!1);break;case"textarea":bd(n),L0(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Hr(s.value));break;case"select":n.multiple=!!s.multiple,r=s.value,r!=null?Zo(n,!!s.multiple,r,!1):s.defaultValue!=null&&Zo(n,!!s.multiple,s.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Uf)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Et(e),null;case 6:if(n&&e.stateNode!=null)dS(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(L(166));if(t=oa(Nu.current),oa(Ks.current),Rd(e)){if(s=e.stateNode,t=e.memoizedProps,s[Xs]=e,(r=s.nodeValue!==t)&&(n=Pn,n!==null))switch(n.tag){case 3:Nd(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Nd(s.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[Xs]=e,e.stateNode=s}return Et(e),null;case 13:if(Pe(je),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Le&&Tn!==null&&e.mode&1&&!(e.flags&128))Nx(),pc(),e.flags|=98560,r=!1;else if(r=Rd(e),s!==null&&s.dehydrated!==null){if(n===null){if(!r)throw Error(L(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(L(317));r[Xs]=e}else pc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Et(e),r=!1}else ys!==null&&(Bm(ys),ys=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||je.current&1?st===0&&(st=3):Qv())),e.updateQueue!==null&&(e.flags|=4),Et(e),null);case 4:return mc(),Mm(n,e),n===null&&Cu(e.stateNode.containerInfo),Et(e),null;case 10:return Iv(e.type._context),Et(e),null;case 17:return un(e.type)&&Hf(),Et(e),null;case 19:if(Pe(je),r=e.memoizedState,r===null)return Et(e),null;if(s=(e.flags&128)!==0,a=r.rendering,a===null)if(s)Lc(r,!1);else{if(st!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=Yf(n),a!==null){for(e.flags|=128,Lc(r,!1),s=a.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)r=t,n=s,r.flags&=14680066,a=r.alternate,a===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=a.childLanes,r.lanes=a.lanes,r.child=a.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=a.memoizedProps,r.memoizedState=a.memoizedState,r.updateQueue=a.updateQueue,r.type=a.type,n=a.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ce(je,je.current&1|2),e.child}n=n.sibling}r.tail!==null&&Ve()>vc&&(e.flags|=128,s=!0,Lc(r,!1),e.lanes=4194304)}else{if(!s)if(n=Yf(a),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Lc(r,!0),r.tail===null&&r.tailMode==="hidden"&&!a.alternate&&!Le)return Et(e),null}else 2*Ve()-r.renderingStartTime>vc&&t!==1073741824&&(e.flags|=128,s=!0,Lc(r,!1),e.lanes=4194304);r.isBackwards?(a.sibling=e.child,e.child=a):(t=r.last,t!==null?t.sibling=a:e.child=a,r.last=a)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Ve(),e.sibling=null,t=je.current,Ce(je,s?t&1|2:t&1),e):(Et(e),null);case 22:case 23:return Kv(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?En&1073741824&&(Et(e),e.subtreeFlags&6&&(e.flags|=8192)):Et(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function hC(n,e){switch(Nv(e),e.tag){case 1:return un(e.type)&&Hf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return mc(),Pe(cn),Pe(jt),zv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Ov(e),null;case 13:if(Pe(je),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(L(340));pc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Pe(je),null;case 4:return mc(),null;case 10:return Iv(e.type._context),null;case 22:case 23:return Kv(),null;case 24:return null;default:return null}}var Id=!1,It=!1,dC=typeof WeakSet=="function"?WeakSet:Set,$=null;function Yo(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){He(n,e,s)}else t.current=null}function Lm(n,e,t){try{t()}catch(s){He(n,e,s)}}var bw=!1;function fC(n,e){if(mm=Of,n=yx(),Tv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var i=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var a=0,o=-1,c=-1,u=0,h=0,d=n,f=null;t:for(;;){for(var g;d!==t||i!==0&&d.nodeType!==3||(o=a+i),d!==r||s!==0&&d.nodeType!==3||(c=a+s),d.nodeType===3&&(a+=d.nodeValue.length),(g=d.firstChild)!==null;)f=d,d=g;for(;;){if(d===n)break t;if(f===t&&++u===i&&(o=a),f===r&&++h===s&&(c=a),(g=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=g}t=o===-1||c===-1?null:{start:o,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(ym={focusedElem:n,selectionRange:t},Of=!1,$=e;$!==null;)if(e=$,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,$=n;else for(;$!==null;){e=$;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var w=m.memoizedProps,_=m.memoizedState,v=e.stateNode,x=v.getSnapshotBeforeUpdate(e.elementType===e.type?w:ns(e.type,w),_);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(E){He(e,e.return,E)}if(n=e.sibling,n!==null){n.return=e.return,$=n;break}$=e.return}return m=bw,bw=!1,m}function fu(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var i=s=s.next;do{if((i.tag&n)===n){var r=i.destroy;i.destroy=void 0,r!==void 0&&Lm(e,t,r)}i=i.next}while(i!==s)}}function Wp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function Im(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function fS(n){var e=n.alternate;e!==null&&(n.alternate=null,fS(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Xs],delete e[Tu],delete e[xm],delete e[YE],delete e[KE])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function pS(n){return n.tag===5||n.tag===3||n.tag===4}function Aw(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||pS(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Dm(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Uf));else if(s!==4&&(n=n.child,n!==null))for(Dm(n,e,t),n=n.sibling;n!==null;)Dm(n,e,t),n=n.sibling}function jm(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for(jm(n,e,t),n=n.sibling;n!==null;)jm(n,e,t),n=n.sibling}var wt=null,ms=!1;function Vi(n,e,t){for(t=t.child;t!==null;)gS(n,e,t),t=t.sibling}function gS(n,e,t){if(Ys&&typeof Ys.onCommitFiberUnmount=="function")try{Ys.onCommitFiberUnmount(jp,t)}catch{}switch(t.tag){case 5:It||Yo(t,e);case 6:var s=wt,i=ms;wt=null,Vi(n,e,t),wt=s,ms=i,wt!==null&&(ms?(n=wt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):wt.removeChild(t.stateNode));break;case 18:wt!==null&&(ms?(n=wt,t=t.stateNode,n.nodeType===8?Cg(n.parentNode,t):n.nodeType===1&&Cg(n,t),Au(n)):Cg(wt,t.stateNode));break;case 4:s=wt,i=ms,wt=t.stateNode.containerInfo,ms=!0,Vi(n,e,t),wt=s,ms=i;break;case 0:case 11:case 14:case 15:if(!It&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){i=s=s.next;do{var r=i,a=r.destroy;r=r.tag,a!==void 0&&(r&2||r&4)&&Lm(t,e,a),i=i.next}while(i!==s)}Vi(n,e,t);break;case 1:if(!It&&(Yo(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(o){He(t,e,o)}Vi(n,e,t);break;case 21:Vi(n,e,t);break;case 22:t.mode&1?(It=(s=It)||t.memoizedState!==null,Vi(n,e,t),It=s):Vi(n,e,t);break;default:Vi(n,e,t)}}function _w(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new dC),e.forEach(function(s){var i=bC.bind(null,n,s);t.has(s)||(t.add(s),s.then(i,i))})}}function Zn(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];try{var r=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:wt=o.stateNode,ms=!1;break e;case 3:wt=o.stateNode.containerInfo,ms=!0;break e;case 4:wt=o.stateNode.containerInfo,ms=!0;break e}o=o.return}if(wt===null)throw Error(L(160));gS(r,a,i),wt=null,ms=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){He(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mS(e,n),e=e.sibling}function mS(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Zn(e,n),Es(n),s&4){try{fu(3,n,n.return),Wp(3,n)}catch(w){He(n,n.return,w)}try{fu(5,n,n.return)}catch(w){He(n,n.return,w)}}break;case 1:Zn(e,n),Es(n),s&512&&t!==null&&Yo(t,t.return);break;case 5:if(Zn(e,n),Es(n),s&512&&t!==null&&Yo(t,t.return),n.flags&32){var i=n.stateNode;try{wu(i,"")}catch(w){He(n,n.return,w)}}if(s&4&&(i=n.stateNode,i!=null)){var r=n.memoizedProps,a=t!==null?t.memoizedProps:r,o=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{o==="input"&&r.type==="radio"&&r.name!=null&&O1(i,r),am(o,a);var u=am(o,r);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];h==="style"?$1(i,d):h==="dangerouslySetInnerHTML"?U1(i,d):h==="children"?wu(i,d):gv(i,h,d,u)}switch(o){case"input":tm(i,r);break;case"textarea":z1(i,r);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!r.multiple;var g=r.value;g!=null?Zo(i,!!r.multiple,g,!1):f!==!!r.multiple&&(r.defaultValue!=null?Zo(i,!!r.multiple,r.defaultValue,!0):Zo(i,!!r.multiple,r.multiple?[]:"",!1))}i[Tu]=r}catch(w){He(n,n.return,w)}}break;case 6:if(Zn(e,n),Es(n),s&4){if(n.stateNode===null)throw Error(L(162));i=n.stateNode,r=n.memoizedProps;try{i.nodeValue=r}catch(w){He(n,n.return,w)}}break;case 3:if(Zn(e,n),Es(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Au(e.containerInfo)}catch(w){He(n,n.return,w)}break;case 4:Zn(e,n),Es(n);break;case 13:Zn(e,n),Es(n),i=n.child,i.flags&8192&&(r=i.memoizedState!==null,i.stateNode.isHidden=r,!r||i.alternate!==null&&i.alternate.memoizedState!==null||(qv=Ve())),s&4&&_w(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(It=(u=It)||h,Zn(e,n),It=u):Zn(e,n),Es(n),s&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for($=n,h=n.child;h!==null;){for(d=$=h;$!==null;){switch(f=$,g=f.child,f.tag){case 0:case 11:case 14:case 15:fu(4,f,f.return);break;case 1:Yo(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){s=f,t=f.return;try{e=s,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(w){He(s,t,w)}}break;case 5:Yo(f,f.return);break;case 22:if(f.memoizedState!==null){Cw(d);continue}}g!==null?(g.return=f,$=g):Cw(d)}h=h.sibling}e:for(h=null,d=n;;){if(d.tag===5){if(h===null){h=d;try{i=d.stateNode,u?(r=i.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(o=d.stateNode,c=d.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=H1("display",a))}catch(w){He(n,n.return,w)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(w){He(n,n.return,w)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Zn(e,n),Es(n),s&4&&_w(n);break;case 21:break;default:Zn(e,n),Es(n)}}function Es(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(pS(t)){var s=t;break e}t=t.return}throw Error(L(160))}switch(s.tag){case 5:var i=s.stateNode;s.flags&32&&(wu(i,""),s.flags&=-33);var r=Aw(n);jm(n,r,i);break;case 3:case 4:var a=s.stateNode.containerInfo,o=Aw(n);Dm(n,o,a);break;default:throw Error(L(161))}}catch(c){He(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function pC(n,e,t){$=n,yS(n)}function yS(n,e,t){for(var s=(n.mode&1)!==0;$!==null;){var i=$,r=i.child;if(i.tag===22&&s){var a=i.memoizedState!==null||Id;if(!a){var o=i.alternate,c=o!==null&&o.memoizedState!==null||It;o=Id;var u=It;if(Id=a,(It=c)&&!u)for($=i;$!==null;)a=$,c=a.child,a.tag===22&&a.memoizedState!==null?kw(i):c!==null?(c.return=a,$=c):kw(i);for(;r!==null;)$=r,yS(r),r=r.sibling;$=i,Id=o,It=u}Ew(n)}else i.subtreeFlags&8772&&r!==null?(r.return=i,$=r):Ew(n)}}function Ew(n){for(;$!==null;){var e=$;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:It||Wp(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!It)if(t===null)s.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:ns(e.type,t.memoizedProps);s.componentDidUpdate(i,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&cw(e,r,s);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}cw(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Au(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}It||e.flags&512&&Im(e)}catch(f){He(e,e.return,f)}}if(e===n){$=null;break}if(t=e.sibling,t!==null){t.return=e.return,$=t;break}$=e.return}}function Cw(n){for(;$!==null;){var e=$;if(e===n){$=null;break}var t=e.sibling;if(t!==null){t.return=e.return,$=t;break}$=e.return}}function kw(n){for(;$!==null;){var e=$;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Wp(4,e)}catch(c){He(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var i=e.return;try{s.componentDidMount()}catch(c){He(e,i,c)}}var r=e.return;try{Im(e)}catch(c){He(e,r,c)}break;case 5:var a=e.return;try{Im(e)}catch(c){He(e,a,c)}}}catch(c){He(e,e.return,c)}if(e===n){$=null;break}var o=e.sibling;if(o!==null){o.return=e.return,$=o;break}$=e.return}}var gC=Math.ceil,Jf=$i.ReactCurrentDispatcher,Gv=$i.ReactCurrentOwner,Xn=$i.ReactCurrentBatchConfig,he=0,dt=null,Ye=null,St=0,En=0,Ko=qr(0),st=0,Iu=null,vo=0,Vp=0,Xv=0,pu=null,on=null,qv=0,vc=1/0,ni=null,Zf=!1,Fm=null,Fr=null,Dd=!1,Nr=null,ep=0,gu=0,Om=null,Qd=-1,Jd=0;function Gt(){return he&6?Ve():Qd!==-1?Qd:Qd=Ve()}function Or(n){return n.mode&1?he&2&&St!==0?St&-St:JE.transition!==null?(Jd===0&&(Jd=tx()),Jd):(n=xe,n!==0||(n=window.event,n=n===void 0?16:lx(n.type)),n):1}function xs(n,e,t,s){if(50<gu)throw gu=0,Om=null,Error(L(185));fd(n,t,s),(!(he&2)||n!==dt)&&(n===dt&&(!(he&2)&&(Vp|=t),st===4&&Qi(n,St)),hn(n,s),t===1&&he===0&&!(e.mode&1)&&(vc=Ve()+500,Up&&Yr()))}function hn(n,e){var t=n.callbackNode;J_(n,e);var s=Ff(n,n===dt?St:0);if(s===0)t!==null&&j0(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&j0(t),e===1)n.tag===0?QE(Tw.bind(null,n)):kx(Tw.bind(null,n)),XE(function(){!(he&6)&&Yr()}),t=null;else{switch(nx(s)){case 1:t=xv;break;case 4:t=Z1;break;case 16:t=jf;break;case 536870912:t=ex;break;default:t=jf}t=ES(t,vS.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function vS(n,e){if(Qd=-1,Jd=0,he&6)throw Error(L(327));var t=n.callbackNode;if(il()&&n.callbackNode!==t)return null;var s=Ff(n,n===dt?St:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=tp(n,s);else{e=s;var i=he;he|=2;var r=xS();(dt!==n||St!==e)&&(ni=null,vc=Ve()+500,fo(n,e));do try{vC();break}catch(o){wS(n,o)}while(!0);Lv(),Jf.current=r,he=i,Ye!==null?e=0:(dt=null,St=0,e=st)}if(e!==0){if(e===2&&(i=hm(n),i!==0&&(s=i,e=zm(n,i))),e===1)throw t=Iu,fo(n,0),Qi(n,s),hn(n,Ve()),t;if(e===6)Qi(n,s);else{if(i=n.current.alternate,!(s&30)&&!mC(i)&&(e=tp(n,s),e===2&&(r=hm(n),r!==0&&(s=r,e=zm(n,r))),e===1))throw t=Iu,fo(n,0),Qi(n,s),hn(n,Ve()),t;switch(n.finishedWork=i,n.finishedLanes=s,e){case 0:case 1:throw Error(L(345));case 2:Jr(n,on,ni);break;case 3:if(Qi(n,s),(s&130023424)===s&&(e=qv+500-Ve(),10<e)){if(Ff(n,0)!==0)break;if(i=n.suspendedLanes,(i&s)!==s){Gt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=wm(Jr.bind(null,n,on,ni),e);break}Jr(n,on,ni);break;case 4:if(Qi(n,s),(s&4194240)===s)break;for(e=n.eventTimes,i=-1;0<s;){var a=31-ws(s);r=1<<a,a=e[a],a>i&&(i=a),s&=~r}if(s=i,s=Ve()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*gC(s/1960))-s,10<s){n.timeoutHandle=wm(Jr.bind(null,n,on,ni),s);break}Jr(n,on,ni);break;case 5:Jr(n,on,ni);break;default:throw Error(L(329))}}}return hn(n,Ve()),n.callbackNode===t?vS.bind(null,n):null}function zm(n,e){var t=pu;return n.current.memoizedState.isDehydrated&&(fo(n,e).flags|=256),n=tp(n,e),n!==2&&(e=on,on=t,e!==null&&Bm(e)),n}function Bm(n){on===null?on=n:on.push.apply(on,n)}function mC(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var i=t[s],r=i.getSnapshot;i=i.value;try{if(!Ss(r(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qi(n,e){for(e&=~Xv,e&=~Vp,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-ws(e),s=1<<t;n[t]=-1,e&=~s}}function Tw(n){if(he&6)throw Error(L(327));il();var e=Ff(n,0);if(!(e&1))return hn(n,Ve()),null;var t=tp(n,e);if(n.tag!==0&&t===2){var s=hm(n);s!==0&&(e=s,t=zm(n,s))}if(t===1)throw t=Iu,fo(n,0),Qi(n,e),hn(n,Ve()),t;if(t===6)throw Error(L(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Jr(n,on,ni),hn(n,Ve()),null}function Yv(n,e){var t=he;he|=1;try{return n(e)}finally{he=t,he===0&&(vc=Ve()+500,Up&&Yr())}}function wo(n){Nr!==null&&Nr.tag===0&&!(he&6)&&il();var e=he;he|=1;var t=Xn.transition,s=xe;try{if(Xn.transition=null,xe=1,n)return n()}finally{xe=s,Xn.transition=t,he=e,!(he&6)&&Yr()}}function Kv(){En=Ko.current,Pe(Ko)}function fo(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,GE(t)),Ye!==null)for(t=Ye.return;t!==null;){var s=t;switch(Nv(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Hf();break;case 3:mc(),Pe(cn),Pe(jt),zv();break;case 5:Ov(s);break;case 4:mc();break;case 13:Pe(je);break;case 19:Pe(je);break;case 10:Iv(s.type._context);break;case 22:case 23:Kv()}t=t.return}if(dt=n,Ye=n=zr(n.current,null),St=En=e,st=0,Iu=null,Xv=Vp=vo=0,on=pu=null,aa!==null){for(e=0;e<aa.length;e++)if(t=aa[e],s=t.interleaved,s!==null){t.interleaved=null;var i=s.next,r=t.pending;if(r!==null){var a=r.next;r.next=i,s.next=a}t.pending=s}aa=null}return n}function wS(n,e){do{var t=Ye;try{if(Lv(),qd.current=Qf,Kf){for(var s=Oe.memoizedState;s!==null;){var i=s.queue;i!==null&&(i.pending=null),s=s.next}Kf=!1}if(yo=0,ht=nt=Oe=null,du=!1,Ru=0,Gv.current=null,t===null||t.return===null){st=1,Iu=e,Ye=null;break}e:{var r=n,a=t.return,o=t,c=e;if(e=St,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=o,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=gw(a);if(g!==null){g.flags&=-257,mw(g,a,o,r,e),g.mode&1&&pw(r,u,e),e=g,c=u;var m=e.updateQueue;if(m===null){var w=new Set;w.add(c),e.updateQueue=w}else m.add(c);break e}else{if(!(e&1)){pw(r,u,e),Qv();break e}c=Error(L(426))}}else if(Le&&o.mode&1){var _=gw(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),mw(_,a,o,r,e),Rv(yc(c,o));break e}}r=c=yc(c,o),st!==4&&(st=2),pu===null?pu=[r]:pu.push(r),r=a;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var v=nS(r,c,e);lw(r,v);break e;case 1:o=c;var x=r.type,S=r.stateNode;if(!(r.flags&128)&&(typeof x.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Fr===null||!Fr.has(S)))){r.flags|=65536,e&=-e,r.lanes|=e;var E=sS(r,o,e);lw(r,E);break e}}r=r.return}while(r!==null)}bS(t)}catch(C){e=C,Ye===t&&t!==null&&(Ye=t=t.return);continue}break}while(!0)}function xS(){var n=Jf.current;return Jf.current=Qf,n===null?Qf:n}function Qv(){(st===0||st===3||st===2)&&(st=4),dt===null||!(vo&268435455)&&!(Vp&268435455)||Qi(dt,St)}function tp(n,e){var t=he;he|=2;var s=xS();(dt!==n||St!==e)&&(ni=null,fo(n,e));do try{yC();break}catch(i){wS(n,i)}while(!0);if(Lv(),he=t,Jf.current=s,Ye!==null)throw Error(L(261));return dt=null,St=0,st}function yC(){for(;Ye!==null;)SS(Ye)}function vC(){for(;Ye!==null&&!$_();)SS(Ye)}function SS(n){var e=_S(n.alternate,n,En);n.memoizedProps=n.pendingProps,e===null?bS(n):Ye=e,Gv.current=null}function bS(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=hC(t,e),t!==null){t.flags&=32767,Ye=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{st=6,Ye=null;return}}else if(t=uC(t,e,En),t!==null){Ye=t;return}if(e=e.sibling,e!==null){Ye=e;return}Ye=e=n}while(e!==null);st===0&&(st=5)}function Jr(n,e,t){var s=xe,i=Xn.transition;try{Xn.transition=null,xe=1,wC(n,e,t,s)}finally{Xn.transition=i,xe=s}return null}function wC(n,e,t,s){do il();while(Nr!==null);if(he&6)throw Error(L(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(L(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(Z_(n,r),n===dt&&(Ye=dt=null,St=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Dd||(Dd=!0,ES(jf,function(){return il(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Xn.transition,Xn.transition=null;var a=xe;xe=1;var o=he;he|=4,Gv.current=null,fC(n,t),mS(t,n),zE(ym),Of=!!mm,ym=mm=null,n.current=t,pC(t),W_(),he=o,xe=a,Xn.transition=r}else n.current=t;if(Dd&&(Dd=!1,Nr=n,ep=i),r=n.pendingLanes,r===0&&(Fr=null),X_(t.stateNode),hn(n,Ve()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],s(i.value,{componentStack:i.stack,digest:i.digest});if(Zf)throw Zf=!1,n=Fm,Fm=null,n;return ep&1&&n.tag!==0&&il(),r=n.pendingLanes,r&1?n===Om?gu++:(gu=0,Om=n):gu=0,Yr(),null}function il(){if(Nr!==null){var n=nx(ep),e=Xn.transition,t=xe;try{if(Xn.transition=null,xe=16>n?16:n,Nr===null)var s=!1;else{if(n=Nr,Nr=null,ep=0,he&6)throw Error(L(331));var i=he;for(he|=4,$=n.current;$!==null;){var r=$,a=r.child;if($.flags&16){var o=r.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for($=u;$!==null;){var h=$;switch(h.tag){case 0:case 11:case 15:fu(8,h,r)}var d=h.child;if(d!==null)d.return=h,$=d;else for(;$!==null;){h=$;var f=h.sibling,g=h.return;if(fS(h),h===u){$=null;break}if(f!==null){f.return=g,$=f;break}$=g}}}var m=r.alternate;if(m!==null){var w=m.child;if(w!==null){m.child=null;do{var _=w.sibling;w.sibling=null,w=_}while(w!==null)}}$=r}}if(r.subtreeFlags&2064&&a!==null)a.return=r,$=a;else e:for(;$!==null;){if(r=$,r.flags&2048)switch(r.tag){case 0:case 11:case 15:fu(9,r,r.return)}var v=r.sibling;if(v!==null){v.return=r.return,$=v;break e}$=r.return}}var x=n.current;for($=x;$!==null;){a=$;var S=a.child;if(a.subtreeFlags&2064&&S!==null)S.return=a,$=S;else e:for(a=x;$!==null;){if(o=$,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Wp(9,o)}}catch(C){He(o,o.return,C)}if(o===a){$=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,$=E;break e}$=o.return}}if(he=i,Yr(),Ys&&typeof Ys.onPostCommitFiberRoot=="function")try{Ys.onPostCommitFiberRoot(jp,n)}catch{}s=!0}return s}finally{xe=t,Xn.transition=e}}return!1}function Pw(n,e,t){e=yc(t,e),e=nS(n,e,1),n=jr(n,e,1),e=Gt(),n!==null&&(fd(n,1,e),hn(n,e))}function He(n,e,t){if(n.tag===3)Pw(n,n,t);else for(;e!==null;){if(e.tag===3){Pw(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Fr===null||!Fr.has(s))){n=yc(t,n),n=sS(e,n,1),e=jr(e,n,1),n=Gt(),e!==null&&(fd(e,1,n),hn(e,n));break}}e=e.return}}function xC(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=Gt(),n.pingedLanes|=n.suspendedLanes&t,dt===n&&(St&t)===t&&(st===4||st===3&&(St&130023424)===St&&500>Ve()-qv?fo(n,0):Xv|=t),hn(n,e)}function AS(n,e){e===0&&(n.mode&1?(e=Ed,Ed<<=1,!(Ed&130023424)&&(Ed=4194304)):e=1);var t=Gt();n=zi(n,e),n!==null&&(fd(n,e,t),hn(n,t))}function SC(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),AS(n,t)}function bC(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(L(314))}s!==null&&s.delete(e),AS(n,t)}var _S;_S=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||cn.current)ln=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return ln=!1,cC(n,e,t);ln=!!(n.flags&131072)}else ln=!1,Le&&e.flags&1048576&&Tx(e,Vf,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Kd(n,e),n=e.pendingProps;var i=fc(e,jt.current);sl(e,t),i=Uv(null,e,s,n,i,t);var r=Hv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(s)?(r=!0,$f(e)):r=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,jv(e),i.updater=$p,e.stateNode=i,i._reactInternals=e,Cm(e,s,n,t),e=Pm(null,e,s,!0,r,t)):(e.tag=0,Le&&r&&Pv(e),Vt(null,e,i,t),e=e.child),e;case 16:s=e.elementType;e:{switch(Kd(n,e),n=e.pendingProps,i=s._init,s=i(s._payload),e.type=s,i=e.tag=_C(s),n=ns(s,n),i){case 0:e=Tm(null,e,s,n,t);break e;case 1:e=ww(null,e,s,n,t);break e;case 11:e=yw(null,e,s,n,t);break e;case 14:e=vw(null,e,s,ns(s.type,n),t);break e}throw Error(L(306,s,""))}return e;case 0:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ns(s,i),Tm(n,e,s,i,t);case 1:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ns(s,i),ww(n,e,s,i,t);case 3:e:{if(oS(e),n===null)throw Error(L(387));s=e.pendingProps,r=e.memoizedState,i=r.element,Ix(n,e),qf(e,s,null,t);var a=e.memoizedState;if(s=a.element,r.isDehydrated)if(r={element:s,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){i=yc(Error(L(423)),e),e=xw(n,e,s,t,i);break e}else if(s!==i){i=yc(Error(L(424)),e),e=xw(n,e,s,t,i);break e}else for(Tn=Dr(e.stateNode.containerInfo.firstChild),Pn=e,Le=!0,ys=null,t=Mx(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(pc(),s===i){e=Bi(n,e,t);break e}Vt(n,e,s,t)}e=e.child}return e;case 5:return Dx(e),n===null&&Am(e),s=e.type,i=e.pendingProps,r=n!==null?n.memoizedProps:null,a=i.children,vm(s,i)?a=null:r!==null&&vm(s,r)&&(e.flags|=32),aS(n,e),Vt(n,e,a,t),e.child;case 6:return n===null&&Am(e),null;case 13:return lS(n,e,t);case 4:return Fv(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=gc(e,null,s,t):Vt(n,e,s,t),e.child;case 11:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ns(s,i),yw(n,e,s,i,t);case 7:return Vt(n,e,e.pendingProps,t),e.child;case 8:return Vt(n,e,e.pendingProps.children,t),e.child;case 12:return Vt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,i=e.pendingProps,r=e.memoizedProps,a=i.value,Ce(Gf,s._currentValue),s._currentValue=a,r!==null)if(Ss(r.value,a)){if(r.children===i.children&&!cn.current){e=Bi(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var o=r.dependencies;if(o!==null){a=r.child;for(var c=o.firstContext;c!==null;){if(c.context===s){if(r.tag===1){c=Ii(-1,t&-t),c.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}r.lanes|=t,c=r.alternate,c!==null&&(c.lanes|=t),_m(r.return,t,e),o.lanes|=t;break}c=c.next}}else if(r.tag===10)a=r.type===e.type?null:r.child;else if(r.tag===18){if(a=r.return,a===null)throw Error(L(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),_m(a,t,e),a=r.sibling}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===e){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}Vt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,s=e.pendingProps.children,sl(e,t),i=Yn(i),s=s(i),e.flags|=1,Vt(n,e,s,t),e.child;case 14:return s=e.type,i=ns(s,e.pendingProps),i=ns(s.type,i),vw(n,e,s,i,t);case 15:return iS(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,i=e.pendingProps,i=e.elementType===s?i:ns(s,i),Kd(n,e),e.tag=1,un(s)?(n=!0,$f(e)):n=!1,sl(e,t),tS(e,s,i),Cm(e,s,i,t),Pm(null,e,s,!0,n,t);case 19:return cS(n,e,t);case 22:return rS(n,e,t)}throw Error(L(156,e.tag))};function ES(n,e){return J1(n,e)}function AC(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(n,e,t,s){return new AC(n,e,t,s)}function Jv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function _C(n){if(typeof n=="function")return Jv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===yv)return 11;if(n===vv)return 14}return 2}function zr(n,e){var t=n.alternate;return t===null?(t=Gn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Zd(n,e,t,s,i,r){var a=2;if(s=n,typeof n=="function")Jv(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case Bo:return po(t.children,i,r,e);case mv:a=8,i|=8;break;case Kg:return n=Gn(12,t,e,i|2),n.elementType=Kg,n.lanes=r,n;case Qg:return n=Gn(13,t,e,i),n.elementType=Qg,n.lanes=r,n;case Jg:return n=Gn(19,t,e,i),n.elementType=Jg,n.lanes=r,n;case D1:return Gp(t,i,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case L1:a=10;break e;case I1:a=9;break e;case yv:a=11;break e;case vv:a=14;break e;case qi:a=16,s=null;break e}throw Error(L(130,n==null?n:typeof n,""))}return e=Gn(a,t,e,i),e.elementType=n,e.type=s,e.lanes=r,e}function po(n,e,t,s){return n=Gn(7,n,s,e),n.lanes=t,n}function Gp(n,e,t,s){return n=Gn(22,n,s,e),n.elementType=D1,n.lanes=t,n.stateNode={isHidden:!1},n}function Ig(n,e,t){return n=Gn(6,n,null,e),n.lanes=t,n}function Dg(n,e,t){return e=Gn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function EC(n,e,t,s,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gg(0),this.expirationTimes=gg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gg(0),this.identifierPrefix=s,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Zv(n,e,t,s,i,r,a,o,c){return n=new EC(n,e,t,o,c),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Gn(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},jv(r),n}function CC(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zo,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function CS(n){if(!n)return $r;n=n._reactInternals;e:{if(Co(n)!==n||n.tag!==1)throw Error(L(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(n.tag===1){var t=n.type;if(un(t))return Cx(n,t,e)}return e}function kS(n,e,t,s,i,r,a,o,c){return n=Zv(t,s,!0,n,i,r,a,o,c),n.context=CS(null),t=n.current,s=Gt(),i=Or(t),r=Ii(s,i),r.callback=e??null,jr(t,r,i),n.current.lanes=i,fd(n,i,s),hn(n,s),n}function Xp(n,e,t,s){var i=e.current,r=Gt(),a=Or(i);return t=CS(t),e.context===null?e.context=t:e.pendingContext=t,e=Ii(r,a),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=jr(i,e,a),n!==null&&(xs(n,i,a,r),Xd(n,i,a)),a}function np(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Nw(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function e0(n,e){Nw(n,e),(n=n.alternate)&&Nw(n,e)}function kC(){return null}var TS=typeof reportError=="function"?reportError:function(n){console.error(n)};function t0(n){this._internalRoot=n}qp.prototype.render=t0.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(L(409));Xp(n,e,null,null)};qp.prototype.unmount=t0.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;wo(function(){Xp(null,n,null,null)}),e[Oi]=null}};function qp(n){this._internalRoot=n}qp.prototype.unstable_scheduleHydration=function(n){if(n){var e=rx();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ki.length&&e!==0&&e<Ki[t].priority;t++);Ki.splice(t,0,n),t===0&&ox(n)}};function n0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Yp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Rw(){}function TC(n,e,t,s,i){if(i){if(typeof s=="function"){var r=s;s=function(){var u=np(a);r.call(u)}}var a=kS(e,s,n,0,null,!1,!1,"",Rw);return n._reactRootContainer=a,n[Oi]=a.current,Cu(n.nodeType===8?n.parentNode:n),wo(),a}for(;i=n.lastChild;)n.removeChild(i);if(typeof s=="function"){var o=s;s=function(){var u=np(c);o.call(u)}}var c=Zv(n,0,!1,null,null,!1,!1,"",Rw);return n._reactRootContainer=c,n[Oi]=c.current,Cu(n.nodeType===8?n.parentNode:n),wo(function(){Xp(e,c,t,s)}),c}function Kp(n,e,t,s,i){var r=t._reactRootContainer;if(r){var a=r;if(typeof i=="function"){var o=i;i=function(){var c=np(a);o.call(c)}}Xp(e,a,n,i)}else a=TC(t,e,n,i,s);return np(a)}sx=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=$c(e.pendingLanes);t!==0&&(Sv(e,t|1),hn(e,Ve()),!(he&6)&&(vc=Ve()+500,Yr()))}break;case 13:wo(function(){var s=zi(n,1);if(s!==null){var i=Gt();xs(s,n,1,i)}}),e0(n,1)}};bv=function(n){if(n.tag===13){var e=zi(n,134217728);if(e!==null){var t=Gt();xs(e,n,134217728,t)}e0(n,134217728)}};ix=function(n){if(n.tag===13){var e=Or(n),t=zi(n,e);if(t!==null){var s=Gt();xs(t,n,e,s)}e0(n,e)}};rx=function(){return xe};ax=function(n,e){var t=xe;try{return xe=n,e()}finally{xe=t}};lm=function(n,e,t){switch(e){case"input":if(tm(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var i=Bp(s);if(!i)throw Error(L(90));F1(s),tm(s,i)}}}break;case"textarea":z1(n,t);break;case"select":e=t.value,e!=null&&Zo(n,!!t.multiple,e,!1)}};G1=Yv;X1=wo;var PC={usingClientEntryPoint:!1,Events:[gd,Wo,Bp,W1,V1,Yv]},Ic={findFiberByHostInstance:ra,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NC={bundleType:Ic.bundleType,version:Ic.version,rendererPackageName:Ic.rendererPackageName,rendererConfig:Ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$i.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=K1(n),n===null?null:n.stateNode},findFiberByHostInstance:Ic.findFiberByHostInstance||kC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jd.isDisabled&&jd.supportsFiber)try{jp=jd.inject(NC),Ys=jd}catch{}}Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PC;Mn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!n0(e))throw Error(L(200));return CC(n,e,null,t)};Mn.createRoot=function(n,e){if(!n0(n))throw Error(L(299));var t=!1,s="",i=TS;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Zv(n,1,!1,null,null,t,!1,s,i),n[Oi]=e.current,Cu(n.nodeType===8?n.parentNode:n),new t0(e)};Mn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(L(188)):(n=Object.keys(n).join(","),Error(L(268,n)));return n=K1(e),n=n===null?null:n.stateNode,n};Mn.flushSync=function(n){return wo(n)};Mn.hydrate=function(n,e,t){if(!Yp(e))throw Error(L(200));return Kp(null,n,e,!0,t)};Mn.hydrateRoot=function(n,e,t){if(!n0(n))throw Error(L(405));var s=t!=null&&t.hydratedSources||null,i=!1,r="",a=TS;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=kS(e,null,n,1,t??null,i,!1,r,a),n[Oi]=e.current,Cu(n),s)for(n=0;n<s.length;n++)t=s[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new qp(e)};Mn.render=function(n,e,t){if(!Yp(e))throw Error(L(200));return Kp(null,n,e,!1,t)};Mn.unmountComponentAtNode=function(n){if(!Yp(n))throw Error(L(40));return n._reactRootContainer?(wo(function(){Kp(null,null,n,!1,function(){n._reactRootContainer=null,n[Oi]=null})}),!0):!1};Mn.unstable_batchedUpdates=Yv;Mn.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!Yp(t))throw Error(L(200));if(n==null||n._reactInternals===void 0)throw Error(L(38));return Kp(n,e,t,!1,s)};Mn.version="18.3.1-next-f1338f8080-20240426";function PS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(PS)}catch(n){console.error(n)}}PS(),P1.exports=Mn;var RC=P1.exports,Mw=RC;qg.createRoot=Mw.createRoot,qg.hydrateRoot=Mw.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Du(){return Du=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Du.apply(this,arguments)}var Rr;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Rr||(Rr={}));const Lw="popstate";function MC(n){n===void 0&&(n={});function e(s,i){let{pathname:r,search:a,hash:o}=s.location;return Um("",{pathname:r,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(s,i){return typeof i=="string"?i:sp(i)}return IC(e,t,null,n)}function ze(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function s0(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LC(){return Math.random().toString(36).substr(2,8)}function Iw(n,e){return{usr:n.state,key:n.key,idx:e}}function Um(n,e,t,s){return t===void 0&&(t=null),Du({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?_c(e):e,{state:t,key:e&&e.key||s||LC()})}function sp(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function _c(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function IC(n,e,t,s){s===void 0&&(s={});let{window:i=document.defaultView,v5Compat:r=!1}=s,a=i.history,o=Rr.Pop,c=null,u=h();u==null&&(u=0,a.replaceState(Du({},a.state,{idx:u}),""));function h(){return(a.state||{idx:null}).idx}function d(){o=Rr.Pop;let _=h(),v=_==null?null:_-u;u=_,c&&c({action:o,location:w.location,delta:v})}function f(_,v){o=Rr.Push;let x=Um(w.location,_,v);u=h()+1;let S=Iw(x,u),E=w.createHref(x);try{a.pushState(S,"",E)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;i.location.assign(E)}r&&c&&c({action:o,location:w.location,delta:1})}function g(_,v){o=Rr.Replace;let x=Um(w.location,_,v);u=h();let S=Iw(x,u),E=w.createHref(x);a.replaceState(S,"",E),r&&c&&c({action:o,location:w.location,delta:0})}function m(_){let v=i.location.origin!=="null"?i.location.origin:i.location.href,x=typeof _=="string"?_:sp(_);return x=x.replace(/ $/,"%20"),ze(v,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,v)}let w={get action(){return o},get location(){return n(i,a)},listen(_){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Lw,d),c=_,()=>{i.removeEventListener(Lw,d),c=null}},createHref(_){return e(i,_)},createURL:m,encodeLocation(_){let v=m(_);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:g,go(_){return a.go(_)}};return w}var Dw;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Dw||(Dw={}));function DC(n,e,t){return t===void 0&&(t="/"),jC(n,e,t)}function jC(n,e,t,s){let i=typeof e=="string"?_c(e):e,r=wc(i.pathname||"/",t);if(r==null)return null;let a=NS(n);FC(a);let o=null;for(let c=0;o==null&&c<a.length;++c){let u=qC(r);o=GC(a[c],u)}return o}function NS(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let i=(r,a,o)=>{let c={relativePath:o===void 0?r.path||"":o,caseSensitive:r.caseSensitive===!0,childrenIndex:a,route:r};c.relativePath.startsWith("/")&&(ze(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=Br([s,c.relativePath]),h=t.concat(c);r.children&&r.children.length>0&&(ze(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),NS(r.children,e,h,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:WC(u,r.index),routesMeta:h})};return n.forEach((r,a)=>{var o;if(r.path===""||!((o=r.path)!=null&&o.includes("?")))i(r,a);else for(let c of RS(r.path))i(r,a,c)}),e}function RS(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,i=t.endsWith("?"),r=t.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let a=RS(s.join("/")),o=[];return o.push(...a.map(c=>c===""?r:[r,c].join("/"))),i&&o.push(...a),o.map(c=>n.startsWith("/")&&c===""?"/":c)}function FC(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:VC(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const OC=/^:[\w-]+$/,zC=3,BC=2,UC=1,HC=10,$C=-2,jw=n=>n==="*";function WC(n,e){let t=n.split("/"),s=t.length;return t.some(jw)&&(s+=$C),e&&(s+=BC),t.filter(i=>!jw(i)).reduce((i,r)=>i+(OC.test(r)?zC:r===""?UC:HC),s)}function VC(n,e){return n.length===e.length&&n.slice(0,-1).every((s,i)=>s===e[i])?n[n.length-1]-e[e.length-1]:0}function GC(n,e,t){let{routesMeta:s}=n,i={},r="/",a=[];for(let o=0;o<s.length;++o){let c=s[o],u=o===s.length-1,h=r==="/"?e:e.slice(r.length)||"/",d=Hm({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:Br([r,d.pathname]),pathnameBase:ZC(Br([r,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(r=Br([r,d.pathnameBase]))}return a}function Hm(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=XC(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let r=i[0],a=r.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:s.reduce((u,h,d)=>{let{paramName:f,isOptional:g}=h;if(f==="*"){let w=o[d]||"";a=r.slice(0,r.length-w.length).replace(/(.)\/+$/,"$1")}const m=o[d];return g&&!m?u[f]=void 0:u[f]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:a,pattern:n}}function XC(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),s0(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,c)=>(s.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function qC(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return s0(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function wc(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const YC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KC=n=>YC.test(n);function QC(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:i=""}=typeof n=="string"?_c(n):n,r;if(t)if(KC(t))r=t;else{if(t.includes("//")){let a=t;t=t.replace(/\/\/+/g,"/"),s0(!1,"Pathnames cannot have embedded double slashes - normalizing "+(a+" -> "+t))}t.startsWith("/")?r=Fw(t.substring(1),"/"):r=Fw(t,e)}else r=e;return{pathname:r,search:ek(s),hash:tk(i)}}function Fw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function jg(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function JC(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function i0(n,e){let t=JC(n);return e?t.map((s,i)=>i===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function r0(n,e,t,s){s===void 0&&(s=!1);let i;typeof n=="string"?i=_c(n):(i=Du({},n),ze(!i.pathname||!i.pathname.includes("?"),jg("?","pathname","search",i)),ze(!i.pathname||!i.pathname.includes("#"),jg("#","pathname","hash",i)),ze(!i.search||!i.search.includes("#"),jg("#","search","hash",i)));let r=n===""||i.pathname==="",a=r?"/":i.pathname,o;if(a==null)o=t;else{let d=e.length-1;if(!s&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;i.pathname=f.join("/")}o=d>=0?e[d]:"/"}let c=QC(i,o),u=a&&a!=="/"&&a.endsWith("/"),h=(r||a===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const Br=n=>n.join("/").replace(/\/\/+/g,"/"),ZC=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),ek=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,tk=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function nk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const MS=["post","put","patch","delete"];new Set(MS);const sk=["get",...MS];new Set(sk);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ju(){return ju=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},ju.apply(this,arguments)}const Qp=T.createContext(null),LS=T.createContext(null),Wi=T.createContext(null),Jp=T.createContext(null),Js=T.createContext({outlet:null,matches:[],isDataRoute:!1}),IS=T.createContext(null);function ik(n,e){let{relative:t}=e===void 0?{}:e;Ec()||ze(!1);let{basename:s,navigator:i}=T.useContext(Wi),{hash:r,pathname:a,search:o}=Zp(n,{relative:t}),c=a;return s!=="/"&&(c=a==="/"?s:Br([s,a])),i.createHref({pathname:c,search:o,hash:r})}function Ec(){return T.useContext(Jp)!=null}function ko(){return Ec()||ze(!1),T.useContext(Jp).location}function DS(n){T.useContext(Wi).static||T.useLayoutEffect(n)}function To(){let{isDataRoute:n}=T.useContext(Js);return n?xk():rk()}function rk(){Ec()||ze(!1);let n=T.useContext(Qp),{basename:e,future:t,navigator:s}=T.useContext(Wi),{matches:i}=T.useContext(Js),{pathname:r}=ko(),a=JSON.stringify(i0(i,t.v7_relativeSplatPath)),o=T.useRef(!1);return DS(()=>{o.current=!0}),T.useCallback(function(u,h){if(h===void 0&&(h={}),!o.current)return;if(typeof u=="number"){s.go(u);return}let d=r0(u,JSON.parse(a),r,h.relative==="path");n==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:Br([e,d.pathname])),(h.replace?s.replace:s.push)(d,h.state,h)},[e,s,a,r,n])}const ak=T.createContext(null);function ok(n){let e=T.useContext(Js).outlet;return e&&T.createElement(ak.Provider,{value:n},e)}function lk(){let{matches:n}=T.useContext(Js),e=n[n.length-1];return e?e.params:{}}function Zp(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=T.useContext(Wi),{matches:i}=T.useContext(Js),{pathname:r}=ko(),a=JSON.stringify(i0(i,s.v7_relativeSplatPath));return T.useMemo(()=>r0(n,JSON.parse(a),r,t==="path"),[n,a,r,t])}function ck(n,e){return uk(n,e)}function uk(n,e,t,s){Ec()||ze(!1);let{navigator:i}=T.useContext(Wi),{matches:r}=T.useContext(Js),a=r[r.length-1],o=a?a.params:{};a&&a.pathname;let c=a?a.pathnameBase:"/";a&&a.route;let u=ko(),h;if(e){var d;let _=typeof e=="string"?_c(e):e;c==="/"||(d=_.pathname)!=null&&d.startsWith(c)||ze(!1),h=_}else h=u;let f=h.pathname||"/",g=f;if(c!=="/"){let _=c.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(_.length).join("/")}let m=DC(n,{pathname:g}),w=gk(m&&m.map(_=>Object.assign({},_,{params:Object.assign({},o,_.params),pathname:Br([c,i.encodeLocation?i.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?c:Br([c,i.encodeLocation?i.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),r,t,s);return e&&w?T.createElement(Jp.Provider,{value:{location:ju({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Rr.Pop}},w):w}function hk(){let n=wk(),e=nk(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},e),t?T.createElement("pre",{style:i},t):null,null)}const dk=T.createElement(hk,null);class fk extends T.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?T.createElement(Js.Provider,{value:this.props.routeContext},T.createElement(IS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pk(n){let{routeContext:e,match:t,children:s}=n,i=T.useContext(Qp);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),T.createElement(Js.Provider,{value:e},s)}function gk(n,e,t,s){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var r;if(!t)return null;if(t.errors)n=t.matches;else if((r=s)!=null&&r.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,o=(i=t)==null?void 0:i.errors;if(o!=null){let h=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);h>=0||ze(!1),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(t&&s&&s.v7_partialHydration)for(let h=0;h<a.length;h++){let d=a[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:g}=t,m=d.route.loader&&f[d.route.id]===void 0&&(!g||g[d.route.id]===void 0);if(d.route.lazy||m){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,d,f)=>{let g,m=!1,w=null,_=null;t&&(g=o&&d.route.id?o[d.route.id]:void 0,w=d.route.errorElement||dk,c&&(u<0&&f===0?(Sk("route-fallback"),m=!0,_=null):u===f&&(m=!0,_=d.route.hydrateFallbackElement||null)));let v=e.concat(a.slice(0,f+1)),x=()=>{let S;return g?S=w:m?S=_:d.route.Component?S=T.createElement(d.route.Component,null):d.route.element?S=d.route.element:S=h,T.createElement(pk,{match:d,routeContext:{outlet:h,matches:v,isDataRoute:t!=null},children:S})};return t&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?T.createElement(fk,{location:t.location,revalidation:t.revalidation,component:w,error:g,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}var jS=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(jS||{}),FS=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(FS||{});function mk(n){let e=T.useContext(Qp);return e||ze(!1),e}function yk(n){let e=T.useContext(LS);return e||ze(!1),e}function vk(n){let e=T.useContext(Js);return e||ze(!1),e}function OS(n){let e=vk(),t=e.matches[e.matches.length-1];return t.route.id||ze(!1),t.route.id}function wk(){var n;let e=T.useContext(IS),t=yk(),s=OS();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function xk(){let{router:n}=mk(jS.UseNavigateStable),e=OS(FS.UseNavigateStable),t=T.useRef(!1);return DS(()=>{t.current=!0}),T.useCallback(function(i,r){r===void 0&&(r={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,ju({fromRouteId:e},r)))},[n,e])}const Ow={};function Sk(n,e,t){Ow[n]||(Ow[n]=!0)}function bk(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function $m(n){let{to:e,replace:t,state:s,relative:i}=n;Ec()||ze(!1);let{future:r,static:a}=T.useContext(Wi),{matches:o}=T.useContext(Js),{pathname:c}=ko(),u=To(),h=r0(e,i0(o,r.v7_relativeSplatPath),c,i==="path"),d=JSON.stringify(h);return T.useEffect(()=>u(JSON.parse(d),{replace:t,state:s,relative:i}),[u,d,i,t,s]),null}function Ak(n){return ok(n.context)}function es(n){ze(!1)}function _k(n){let{basename:e="/",children:t=null,location:s,navigationType:i=Rr.Pop,navigator:r,static:a=!1,future:o}=n;Ec()&&ze(!1);let c=e.replace(/^\/*/,"/"),u=T.useMemo(()=>({basename:c,navigator:r,static:a,future:ju({v7_relativeSplatPath:!1},o)}),[c,o,r,a]);typeof s=="string"&&(s=_c(s));let{pathname:h="/",search:d="",hash:f="",state:g=null,key:m="default"}=s,w=T.useMemo(()=>{let _=wc(h,c);return _==null?null:{location:{pathname:_,search:d,hash:f,state:g,key:m},navigationType:i}},[c,h,d,f,g,m,i]);return w==null?null:T.createElement(Wi.Provider,{value:u},T.createElement(Jp.Provider,{children:t,value:w}))}function Ek(n){let{children:e,location:t}=n;return ck(Wm(e),t)}new Promise(()=>{});function Wm(n,e){e===void 0&&(e=[]);let t=[];return T.Children.forEach(n,(s,i)=>{if(!T.isValidElement(s))return;let r=[...e,i];if(s.type===T.Fragment){t.push.apply(t,Wm(s.props.children,r));return}s.type!==es&&ze(!1),!s.props.index||!s.props.children||ze(!1);let a={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(a.children=Wm(s.props.children,r)),t.push(a)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ip(){return ip=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},ip.apply(this,arguments)}function zS(n,e){if(n==null)return{};var t={},s=Object.keys(n),i,r;for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function Ck(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function kk(n,e){return n.button===0&&(!e||e==="_self")&&!Ck(n)}function Vm(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(i=>[t,i]):[[t,s]])},[]))}function Tk(n,e){let t=Vm(n);return e&&e.forEach((s,i)=>{t.has(i)||e.getAll(i).forEach(r=>{t.append(i,r)})}),t}const Pk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Nk=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Rk="6";try{window.__reactRouterVersion=Rk}catch{}const Mk=T.createContext({isTransitioning:!1}),Lk="startTransition",zw=x_[Lk];function Ik(n){let{basename:e,children:t,future:s,window:i}=n,r=T.useRef();r.current==null&&(r.current=MC({window:i,v5Compat:!0}));let a=r.current,[o,c]=T.useState({action:a.action,location:a.location}),{v7_startTransition:u}=s||{},h=T.useCallback(d=>{u&&zw?zw(()=>c(d)):c(d)},[c,u]);return T.useLayoutEffect(()=>a.listen(h),[a,h]),T.useEffect(()=>bk(s),[s]),T.createElement(_k,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:a,future:s})}const Dk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",jk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fk=T.forwardRef(function(e,t){let{onClick:s,relative:i,reloadDocument:r,replace:a,state:o,target:c,to:u,preventScrollReset:h,viewTransition:d}=e,f=zS(e,Pk),{basename:g}=T.useContext(Wi),m,w=!1;if(typeof u=="string"&&jk.test(u)&&(m=u,Dk))try{let S=new URL(window.location.href),E=u.startsWith("//")?new URL(S.protocol+u):new URL(u),C=wc(E.pathname,g);E.origin===S.origin&&C!=null?u=C+E.search+E.hash:w=!0}catch{}let _=ik(u,{relative:i}),v=Bk(u,{replace:a,state:o,target:c,preventScrollReset:h,relative:i,viewTransition:d});function x(S){s&&s(S),S.defaultPrevented||v(S)}return T.createElement("a",ip({},f,{href:m||_,onClick:w||r?s:x,ref:t,target:c}))}),Ok=T.forwardRef(function(e,t){let{"aria-current":s="page",caseSensitive:i=!1,className:r="",end:a=!1,style:o,to:c,viewTransition:u,children:h}=e,d=zS(e,Nk),f=Zp(c,{relative:d.relative}),g=ko(),m=T.useContext(LS),{navigator:w,basename:_}=T.useContext(Wi),v=m!=null&&Hk(f)&&u===!0,x=w.encodeLocation?w.encodeLocation(f).pathname:f.pathname,S=g.pathname,E=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;i||(S=S.toLowerCase(),E=E?E.toLowerCase():null,x=x.toLowerCase()),E&&_&&(E=wc(E,_)||E);const C=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let k=S===x||!a&&S.startsWith(x)&&S.charAt(C)==="/",P=E!=null&&(E===x||!a&&E.startsWith(x)&&E.charAt(x.length)==="/"),N={isActive:k,isPending:P,isTransitioning:v},R=k?s:void 0,D;typeof r=="function"?D=r(N):D=[r,k?"active":null,P?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let B=typeof o=="function"?o(N):o;return T.createElement(Fk,ip({},d,{"aria-current":R,className:D,ref:t,style:B,to:c,viewTransition:u}),typeof h=="function"?h(N):h)});var Gm;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Gm||(Gm={}));var Bw;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Bw||(Bw={}));function zk(n){let e=T.useContext(Qp);return e||ze(!1),e}function Bk(n,e){let{target:t,replace:s,state:i,preventScrollReset:r,relative:a,viewTransition:o}=e===void 0?{}:e,c=To(),u=ko(),h=Zp(n,{relative:a});return T.useCallback(d=>{if(kk(d,t)){d.preventDefault();let f=s!==void 0?s:sp(u)===sp(h);c(n,{replace:f,state:i,preventScrollReset:r,relative:a,viewTransition:o})}},[u,c,h,s,i,t,n,r,a,o])}function Uk(n){let e=T.useRef(Vm(n)),t=T.useRef(!1),s=ko(),i=T.useMemo(()=>Tk(s.search,t.current?null:e.current),[s.search]),r=To(),a=T.useCallback((o,c)=>{const u=Vm(typeof o=="function"?o(i):o);t.current=!0,r("?"+u,c)},[r,i]);return[i,a]}function Hk(n,e){e===void 0&&(e={});let t=T.useContext(Mk);t==null&&ze(!1);let{basename:s}=zk(Gm.useViewTransitionState),i=Zp(n,{relative:e.relative});if(!t.isTransitioning)return!1;let r=wc(t.currentLocation.pathname,s)||t.currentLocation.pathname,a=wc(t.nextLocation.pathname,s)||t.nextLocation.pathname;return Hm(i.pathname,a)!=null||Hm(i.pathname,r)!=null}const Fg="/api/v1";function Uw(){const n=document.cookie.split(";");for(const e of n){const[t,s]=e.trim().split("=");if(t==="csrf_token")return decodeURIComponent(s)}return null}class $k{async request(e,t={}){const{method:s="GET",body:i,headers:r={}}=t,a=localStorage.getItem("access_token"),o=localStorage.getItem("device_id"),c=Uw(),u={"Content-Type":"application/json",...r};a&&(u.Authorization=`Bearer ${a}`),o&&(u["X-Device-ID"]=o),c&&s!=="GET"&&(u["X-CSRF-Token"]=c);const h=localStorage.getItem("desktop_session");h&&(u["X-Desktop-Session"]=h);const d=await fetch(`${Fg}${e}`,{method:s,headers:u,body:i?JSON.stringify(i):void 0,credentials:"include"});if(d.status===401){const g=await d.json();if(g.code==="TOKEN_EXPIRED"&&await this.refreshToken())return this.request(e,t);throw new Error(g.error||"Unauthorized")}if(!d.ok){const g=await d.json().catch(()=>({}));throw new Error(g.error||`Request failed: ${d.status}`)}return{data:await d.json()}}async refreshToken(){const e=localStorage.getItem("refresh_token");if(!e)return!1;try{const t=await fetch(`${Fg}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});if(!t.ok)return!1;const s=await t.json();return localStorage.setItem("access_token",s.access_token),localStorage.setItem("refresh_token",s.refresh_token),!0}catch{return!1}}async get(e){return this.request(e)}async post(e,t){return this.request(e,{method:"POST",body:t})}async put(e,t){return this.request(e,{method:"PUT",body:t})}async delete(e){return this.request(e,{method:"DELETE"})}async upload(e,t,s){const i=localStorage.getItem("access_token"),r=localStorage.getItem("device_id"),a=Uw(),o=localStorage.getItem("desktop_session"),c=new FormData;c.append("file",t),s&&c.append("title",s);const u={};i&&(u.Authorization=`Bearer ${i}`),r&&(u["X-Device-ID"]=r),a&&(u["X-CSRF-Token"]=a),o&&(u["X-Desktop-Session"]=o);const h=await fetch(`${Fg}${e}`,{method:"POST",headers:u,body:c,credentials:"include"});if(!h.ok){const f=await h.json().catch(()=>({}));throw new Error(f.error||"Upload failed")}return{data:await h.json()}}async logEvent(e,t,s,i){try{await this.post("/audit/log",{action_type:e,target_type:t,target_id:s,metadata:i})}catch{}}async getDocumentAccess(e){return this.get(`/documents/${e}/access`)}async grantAccess(e,t){return this.post(`/documents/${e}/access`,{user_id:t})}async revokeAccess(e,t){return this.delete(`/documents/${e}/access/${t}`)}}const fe=new $k,BS=T.createContext(null);function Wk({children:n}){const[e,t]=T.useState(null),[s,i]=T.useState(!0);T.useEffect(()=>{r()},[]);const r=async()=>{if(!localStorage.getItem("access_token")){i(!1);return}try{const h=await fe.get("/auth/profile");t(h.data)}catch{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}finally{i(!1)}},a=async(u,h,d)=>{const f=Vk(),g=await fe.post("/auth/login",{email:u,password:h,totp_code:d,device_id:f});return g.data.requires_totp?{requiresTOTP:!0}:(localStorage.setItem("access_token",g.data.access_token),localStorage.setItem("refresh_token",g.data.refresh_token),g.data.client_ip&&localStorage.setItem("client_ip",g.data.client_ip),t(g.data.user),{requiresPasswordChange:g.data.requires_password_change||!1,requiresMFAEnrollment:g.data.requires_mfa_enrollment||!1})},o=async()=>{try{await fe.post("/auth/logout")}catch{}localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),t(null)},c=async()=>{const u=await fe.get("/auth/profile");t(u.data)};return p.jsx(BS.Provider,{value:{user:e,loading:s,login:a,logout:o,refreshUser:c},children:n})}function Qn(){const n=T.useContext(BS);if(!n)throw new Error("useAuth must be used within AuthProvider");return n}function Vk(){let n=localStorage.getItem("device_id");return n||(n="web-"+Gk(),localStorage.setItem("device_id",n)),n}function Gk(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)})}const US=T.createContext(null);function Xk({children:n}){const{user:e}=Qn(),[t,s]=T.useState(()=>{const r=localStorage.getItem("theme");return r==="twilight"||r==="glacium"?r:"twilight"});T.useEffect(()=>{e?e.role==="super_admin"||e.role==="admin"?s("twilight"):s("glacium"):s("twilight")},[e]),T.useEffect(()=>{document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t)},[t]);const i=()=>{s(r=>r==="twilight"?"glacium":"twilight")};return p.jsx(US.Provider,{value:{theme:t,toggleTheme:i},children:n})}function HS(){const n=T.useContext(US);if(!n)throw new Error("useTheme must be used within ThemeProvider");return n}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qk={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yk=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ce=(n,e)=>{const t=T.forwardRef(({color:s="currentColor",size:i=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:o="",children:c,...u},h)=>T.createElement("svg",{ref:h,...qk,width:i,height:i,stroke:s,strokeWidth:a?Number(r)*24/Number(i):r,className:["lucide",`lucide-${Yk(n)}`,o].join(" "),...u},[...e.map(([d,f])=>T.createElement(d,f)),...Array.isArray(c)?c:[c]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=ce("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=ce("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kk=ce("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=ce("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qk=ce("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jk=ce("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zk=ce("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=ce("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=ce("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ef=ce("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tf=ce("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=ce("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eT=ce("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=ce("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tT=ce("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nT=ce("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=ce("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=ce("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sT=ce("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=ce("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iT=ce("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=ce("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=ce("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rT=ce("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=ce("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aT=ce("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=ce("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=ce("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=ce("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oT=ce("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xc=ce("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lT=ce("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=ce("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cT=ce("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uT=ce("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function hT(){const[n,e]=T.useState(""),[t,s]=T.useState(""),[i,r]=T.useState(""),[a,o]=T.useState(!1),[c,u]=T.useState(!1),[h,d]=T.useState(!1),[f,g]=T.useState(""),{login:m,user:w}=Qn(),_=To(),[v]=Uk();T.useEffect(()=>{const S=v.get("auto"),E=v.get("token"),C=v.get("desktop_session"),k=v.get("refresh");if(S==="1"&&E&&C){localStorage.setItem("access_token",E),localStorage.setItem("desktop_session",C),k&&localStorage.setItem("refresh_token",k),window.history.replaceState({},document.title,"/login"),window.location.href="/dashboard";return}C&&!E&&(localStorage.setItem("desktop_session",C),window.history.replaceState({},document.title,"/login")),w&&_("/dashboard")},[v,w,_]);const x=async S=>{S.preventDefault(),g(""),d(!0);try{const E=await m(n,t,c?i:void 0);if(E.requiresTOTP){u(!0),d(!1);return}if(E.requiresPasswordChange){_("/force-change-password");return}if(E.requiresMFAEnrollment){_("/force-enroll-mfa");return}_("/dashboard")}catch(E){g(E instanceof Error?E.message:"Login failed"),d(!1)}};return p.jsxs("div",{className:"login-page",children:[p.jsxs("div",{className:"login-bg",children:[p.jsx("div",{className:"bg-gradient"}),p.jsx("div",{className:"bg-pattern"})]}),p.jsx("div",{className:"login-container animate-slideUp",children:p.jsxs("div",{className:"login-card glass-card",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("div",{className:"logo-icon",children:p.jsx(ap,{size:40})}),p.jsx("h1",{children:"SRAMS"}),p.jsx("p",{children:"Secure Role-Based Audit Management System"})]}),p.jsxs("form",{onSubmit:x,className:"login-form",children:[f&&p.jsx("div",{className:"error-message",children:f}),c?p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Two-Factor Authentication Code"}),p.jsx("input",{type:"text",className:"input totp-input",value:i,onChange:S=>r(S.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",required:!0,autoComplete:"one-time-code",maxLength:6}),p.jsx("p",{className:"totp-hint",children:"Enter the 6-digit code from your authenticator app"})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Email"}),p.jsx("input",{type:"email",className:"input",value:n,onChange:S=>e(S.target.value),placeholder:"admin@example.com",required:!0,autoComplete:"email"})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Password"}),p.jsxs("div",{className:"password-input",children:[p.jsx("input",{type:a?"text":"password",className:"input",value:t,onChange:S=>s(S.target.value),placeholder:"",required:!0,autoComplete:"current-password"}),p.jsx("button",{type:"button",className:"toggle-password",onClick:()=>o(!a),children:a?p.jsx(ef,{size:18}):p.jsx(tf,{size:18})})]})]})]}),p.jsx("button",{type:"submit",className:"btn btn-primary login-btn",disabled:h,children:h?p.jsxs(p.Fragment,{children:[p.jsx(nT,{size:18,className:"animate-spin"}),p.jsx("span",{children:"Signing in..."})]}):p.jsx("span",{children:c?"Verify":"Sign In"})}),c&&p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{u(!1),r("")},children:"Back to Login"})]}),p.jsx("div",{className:"login-footer",children:p.jsx("p",{children:"Secure  Audited  Compliant"})})]})})]})}function dT(){const n=To(),{refreshUser:e}=Qn(),[t,s]=T.useState(""),[i,r]=T.useState(""),[a,o]=T.useState(""),[c,u]=T.useState(!1),[h,d]=T.useState(!1),[f,g]=T.useState(!1),[m,w]=T.useState(""),[_,v]=T.useState(!1),x=async S=>{var E,C;if(S.preventDefault(),w(""),i!==a){w("New passwords do not match");return}if(i.length<8){w("Password must be at least 8 characters");return}if(i===t){w("New password must be different from current password");return}v(!0);try{await fe.post("/auth/change-password",{current_password:t,new_password:i}),await e(),n("/dashboard")}catch(k){const P=k;w(((C=(E=P==null?void 0:P.response)==null?void 0:E.data)==null?void 0:C.error)||"Failed to change password")}finally{v(!1)}};return p.jsx("div",{className:"login-page",children:p.jsx("div",{className:"login-container",children:p.jsxs("div",{className:"login-card glass-card",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("div",{className:"login-icon",children:p.jsx(GS,{size:32})}),p.jsx("h1",{children:"Password Change Required"}),p.jsx("p",{children:"For security reasons, you must change your password before continuing."})]}),p.jsxs("form",{onSubmit:x,className:"login-form",children:[m&&p.jsxs("div",{className:"error-message",children:[p.jsx($S,{size:16}),p.jsx("span",{children:m})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Current Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:c?"text":"password",className:"input",placeholder:"Enter your current password",value:t,onChange:S=>s(S.target.value),required:!0,autoComplete:"current-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>u(!c),tabIndex:-1,children:c?p.jsx(ef,{size:18}):p.jsx(tf,{size:18})})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"New Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:h?"text":"password",className:"input",placeholder:"Enter your new password",value:i,onChange:S=>r(S.target.value),required:!0,minLength:8,autoComplete:"new-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>d(!h),tabIndex:-1,children:h?p.jsx(ef,{size:18}):p.jsx(tf,{size:18})})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Confirm New Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:f?"text":"password",className:"input",placeholder:"Confirm your new password",value:a,onChange:S=>o(S.target.value),required:!0,minLength:8,autoComplete:"new-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>g(!f),tabIndex:-1,children:f?p.jsx(ef,{size:18}):p.jsx(tf,{size:18})})]})]}),i.length>=8&&i===a&&p.jsxs("div",{className:"success-hint",children:[p.jsx(WS,{size:16}),p.jsx("span",{children:"Passwords match!"})]}),p.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:_||!t||!i||!a,children:_?"Changing Password...":"Change Password & Continue"})]})]})})})}function fT(){const{user:n}=Qn(),[e,t]=T.useState(null),[s,i]=T.useState([]),[r,a]=T.useState([]),[o,c]=T.useState(!0),u=(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="super_admin";T.useEffect(()=>{h(),fe.logEvent("page_view","dashboard")},[]);const h=async()=>{try{if(u){const g=await fe.get("/dashboard/stats");t(g.data)}const d=await fe.get("/documents/my?limit=5");i(d.data.documents||[]);const f=await fe.get("/requests/my?limit=5");a(f.data.requests||[])}catch(d){console.error("Failed to load dashboard:",d)}finally{c(!1)}};return o?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"dashboard animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("h1",{children:["Welcome back, ",n==null?void 0:n.full_name]}),p.jsx("p",{children:u?"Here's an overview of your system":"Access your documents and manage requests"})]}),u&&e&&p.jsxs("div",{className:"stats-grid",children:[p.jsx(Fd,{icon:p.jsx(xc,{}),label:"Total Users",value:e.total_users,subtext:`${e.active_users} active`,color:"blue"}),p.jsx(Fd,{icon:p.jsx(qs,{}),label:"Documents",value:e.total_documents,color:"purple"}),p.jsx(Fd,{icon:p.jsx($S,{}),label:"Pending Requests",value:e.pending_requests,color:"yellow"}),p.jsx(Fd,{icon:p.jsx(Hw,{}),label:"Active Sessions",value:e.active_sessions,subtext:`${e.today_logins} logins today`,color:"green"})]}),p.jsxs("div",{className:"dashboard-grid",children:[p.jsxs("div",{className:"dashboard-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsxs("h2",{children:[p.jsx(qs,{size:20})," My Documents"]}),p.jsx("a",{href:"/documents",className:"view-all",children:"View All "})]}),s.length>0?p.jsx("div",{className:"document-list",children:s.map(d=>p.jsxs("a",{href:`/documents/${d.id}`,className:"document-item",children:[p.jsx(qs,{size:18}),p.jsxs("div",{className:"document-info",children:[p.jsx("span",{className:"document-title",children:d.title}),p.jsx("span",{className:"document-date",children:new Date(d.created_at).toLocaleDateString()})]})]},d.id))}):p.jsxs("div",{className:"empty-state",children:[p.jsx(qs,{size:40}),p.jsx("p",{children:"No documents assigned yet"})]})]}),p.jsxs("div",{className:"dashboard-section glass-card",children:[p.jsx("div",{className:"section-header",children:p.jsxs("h2",{children:[p.jsx(Xm,{size:20})," My Requests"]})}),r.length>0?p.jsx("div",{className:"request-list",children:r.map(d=>p.jsxs("div",{className:"request-item",children:[p.jsx(pT,{status:d.status}),p.jsxs("div",{className:"request-info",children:[p.jsx("span",{className:"request-reason",children:d.reason||"Document access request"}),p.jsx("span",{className:"request-date",children:new Date(d.created_at).toLocaleDateString()})]}),p.jsx("span",{className:`badge badge-${gT(d.status)}`,children:d.status})]},d.id))}):p.jsxs("div",{className:"empty-state",children:[p.jsx(Xm,{size:40}),p.jsx("p",{children:"No requests yet"})]})]})]}),p.jsxs("div",{className:"quick-actions glass-card",children:[p.jsx("h2",{children:"Quick Actions"}),p.jsxs("div",{className:"action-buttons",children:[p.jsxs("a",{href:"/documents",className:"btn btn-primary",children:[p.jsx(qs,{size:18}),"Browse Documents"]}),u&&p.jsxs(p.Fragment,{children:[p.jsxs("a",{href:"/users",className:"btn btn-secondary",children:[p.jsx(xc,{size:18}),"Manage Users"]}),p.jsxs("a",{href:"/audit",className:"btn btn-secondary",children:[p.jsx(Hw,{size:18}),"View Audit Logs"]})]})]})]})]})}function Fd({icon:n,label:e,value:t,subtext:s,color:i}){return p.jsxs("div",{className:`stat-card glass-card stat-${i}`,children:[p.jsx("div",{className:"stat-icon",children:n}),p.jsxs("div",{className:"stat-content",children:[p.jsx("span",{className:"stat-value",children:t.toLocaleString()}),p.jsx("span",{className:"stat-label",children:e}),s&&p.jsx("span",{className:"stat-subtext",children:s})]})]})}function pT({status:n}){switch(n){case"approved":return p.jsx(WS,{size:18,className:"status-approved"});case"rejected":return p.jsx(lT,{size:18,className:"status-rejected"});default:return p.jsx(Xm,{size:18,className:"status-pending"})}}function gT(n){switch(n){case"approved":return"success";case"rejected":return"error";default:return"warning"}}function mT(){const{user:n}=Qn(),[e,t]=T.useState([]),[s,i]=T.useState([]),[r,a]=T.useState(!0),[o,c]=T.useState(""),[u,h]=T.useState(!1),[d,f]=T.useState(!1),[g,m]=T.useState(!1),[w,_]=T.useState(null),v=(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="super_admin";T.useEffect(()=>{x()},[]);const x=async()=>{try{const k=await fe.get("/documents/my");if(t(k.data.documents||[]),v){const P=await fe.get("/documents");i(P.data.documents||[])}}catch(k){console.error("Failed to load documents:",k)}finally{a(!1)}},S=k=>k<1024?k+" B":k<1024*1024?(k/1024).toFixed(1)+" KB":(k/(1024*1024)).toFixed(1)+" MB",E=e.filter(k=>k.title.toLowerCase().includes(o.toLowerCase())||k.filename.toLowerCase().includes(o.toLowerCase())),C=s.filter(k=>k.title.toLowerCase().includes(o.toLowerCase())||k.filename.toLowerCase().includes(o.toLowerCase()));return r?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"documents-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Documents"}),p.jsx("p",{children:"View and manage your documents"})]}),p.jsxs("div",{className:"header-actions",children:[v&&p.jsxs("button",{className:"btn btn-primary",onClick:()=>h(!0),children:[p.jsx(KS,{size:18}),"Upload"]}),!v&&p.jsxs("button",{className:"btn btn-secondary",onClick:()=>f(!0),children:[p.jsx(qS,{size:18}),"Request Access"]})]})]}),p.jsxs("div",{className:"search-bar glass-card",children:[p.jsx(YS,{size:20}),p.jsx("input",{type:"text",placeholder:"Search documents...",value:o,onChange:k=>c(k.target.value)})]}),p.jsxs("section",{className:"document-section",children:[p.jsx("h2",{children:"My Documents"}),E.length>0?p.jsx("div",{className:"document-grid",children:E.map(k=>p.jsxs("a",{href:`/documents/${k.id}`,className:"document-card glass-card",children:[p.jsx("div",{className:"doc-icon",children:p.jsx(qs,{size:32})}),p.jsxs("div",{className:"doc-details",children:[p.jsx("h3",{children:k.title}),p.jsx("p",{children:k.filename}),p.jsxs("span",{className:"doc-meta",children:[S(k.file_size),"  ",new Date(k.created_at).toLocaleDateString()]})]})]},k.id))}):p.jsxs("div",{className:"empty-state glass-card",children:[p.jsx(qs,{size:48}),p.jsx("h3",{children:"No documents"}),p.jsx("p",{children:"You don't have any assigned documents yet"})]})]}),v&&p.jsxs("section",{className:"document-section",children:[p.jsx("h2",{children:"All Documents"}),C.length>0?p.jsx("div",{className:"document-grid",children:C.map(k=>p.jsxs("div",{className:"document-card glass-card",children:[p.jsxs("a",{href:`/documents/${k.id}`,className:"doc-link",children:[p.jsx("div",{className:"doc-icon",children:p.jsx(qs,{size:32})}),p.jsxs("div",{className:"doc-details",children:[p.jsx("h3",{children:k.title}),p.jsx("p",{children:k.filename}),p.jsxs("span",{className:"doc-meta",children:[S(k.file_size),"  ",new Date(k.created_at).toLocaleDateString()]})]})]}),p.jsxs("button",{className:"btn btn-small btn-secondary assign-btn",onClick:P=>{P.preventDefault(),P.stopPropagation(),_(k),m(!0)},children:[p.jsx(xc,{size:14}),"Assign Users"]})]},k.id))}):p.jsxs("div",{className:"empty-state glass-card",children:[p.jsx(qs,{size:48}),p.jsx("h3",{children:"No documents uploaded"}),p.jsx("p",{children:"Upload your first document to get started"})]})]}),u&&p.jsx(yT,{onClose:()=>h(!1),onSuccess:x}),d&&p.jsx(vT,{documents:s,onClose:()=>f(!1),onSuccess:x}),g&&w&&p.jsx(wT,{document:w,onClose:()=>{m(!1),_(null)},onSuccess:x})]})}function yT({onClose:n,onSuccess:e}){const[t,s]=T.useState(null),[i,r]=T.useState(""),[a,o]=T.useState(!1),[c,u]=T.useState(""),h=async()=>{if(t){o(!0),u("");try{await fe.upload("/documents",t,i||t.name),e(),n()}catch(d){u(d instanceof Error?d.message:"Upload failed")}finally{o(!1)}}};return p.jsx("div",{className:"modal-overlay",onClick:n,children:p.jsxs("div",{className:"modal glass-card",onClick:d=>d.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Upload Document"}),p.jsx("button",{className:"close-btn",onClick:n,children:p.jsx(Cc,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[c&&p.jsx("div",{className:"error-message",children:c}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Title"}),p.jsx("input",{type:"text",className:"input",value:i,onChange:d=>r(d.target.value),placeholder:"Document title"})]}),p.jsxs("div",{className:"file-input",children:[p.jsx("input",{type:"file",accept:".pdf",onChange:d=>{var f;return s(((f=d.target.files)==null?void 0:f[0])||null)}}),t&&p.jsx("span",{className:"file-name",children:t.name})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:h,disabled:!t||a,children:a?"Uploading...":"Upload"})]})]})})}function vT({documents:n,onClose:e,onSuccess:t}){const[s,i]=T.useState(""),[r,a]=T.useState(""),[o,c]=T.useState(!1),[u,h]=T.useState(""),d=async()=>{if(s){c(!0),h("");try{await fe.post("/requests",{document_id:s,reason:r}),t(),e()}catch(f){h(f instanceof Error?f.message:"Request failed")}finally{c(!1)}}};return p.jsx("div",{className:"modal-overlay",onClick:e,children:p.jsxs("div",{className:"modal glass-card",onClick:f=>f.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Request Document Access"}),p.jsx("button",{className:"close-btn",onClick:e,children:p.jsx(Cc,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[u&&p.jsx("div",{className:"error-message",children:u}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Select Document"}),p.jsxs("select",{className:"input",value:s,onChange:f=>i(f.target.value),children:[p.jsx("option",{value:"",children:"Choose a document..."}),n.map(f=>p.jsx("option",{value:f.id,children:f.title},f.id))]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Reason (optional)"}),p.jsx("textarea",{className:"input",value:r,onChange:f=>a(f.target.value),placeholder:"Why do you need access to this document?",rows:3})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:d,disabled:!s||o,children:o?"Submitting...":"Submit Request"})]})]})})}function wT({document:n,onClose:e,onSuccess:t}){const[s,i]=T.useState([]),[r,a]=T.useState(new Set),[o,c]=T.useState(new Set),[u,h]=T.useState(!0),[d,f]=T.useState(!1),[g,m]=T.useState("");T.useEffect(()=>{w()},[]);const w=async()=>{try{const E=((await fe.get("/users")).data.users||[]).filter(P=>!["admin","super_admin"].includes(P.role||""));i(E);const C=await fe.getDocumentAccess(n.id),k=new Set((C.data.users||[]).map(P=>P.id));a(k),c(new Set(k))}catch(S){console.error("Failed to load data:",S),m("Failed to load users")}finally{h(!1)}},_=S=>{a(E=>{const C=new Set(E);return C.has(S)?C.delete(S):C.add(S),C})},v=async()=>{f(!0),m("");try{const S=[...r].filter(C=>!o.has(C)),E=[...o].filter(C=>!r.has(C));for(const C of S)await fe.grantAccess(n.id,C);for(const C of E)await fe.revokeAccess(n.id,C);t(),e()}catch(S){m(S instanceof Error?S.message:"Failed to save changes")}finally{f(!1)}},x=()=>{if(r.size!==o.size)return!0;for(const S of r)if(!o.has(S))return!0;return!1};return p.jsx("div",{className:"modal-overlay",onClick:e,children:p.jsxs("div",{className:"modal glass-card modal-large",onClick:S=>S.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsxs("h2",{children:["Assign Users to: ",n.title]}),p.jsx("button",{className:"close-btn",onClick:e,children:p.jsx(Cc,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[g&&p.jsx("div",{className:"error-message",children:g}),u?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):s.length===0?p.jsxs("div",{className:"empty-state",children:[p.jsx(xc,{size:32}),p.jsx("p",{children:"No users available to assign"})]}):p.jsx("div",{className:"user-list",children:s.map(S=>p.jsxs("div",{className:`user-item ${r.has(S.id)?"selected":""}`,onClick:()=>_(S.id),children:[p.jsx("div",{className:"user-checkbox",children:r.has(S.id)&&p.jsx(Qk,{size:16})}),p.jsxs("div",{className:"user-info",children:[p.jsx("span",{className:"user-name",children:S.full_name}),p.jsx("span",{className:"user-email",children:S.email})]})]},S.id))})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsxs("span",{className:"selection-count",children:[r.size," user",r.size!==1?"s":""," selected"]}),p.jsxs("div",{className:"footer-actions",children:[p.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:v,disabled:!x()||d,children:d?"Saving...":"Save Changes"})]})]})]})})}var mu={};mu.d=(n,e)=>{for(var t in e)mu.o(e,t)&&!mu.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};mu.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var K=globalThis.pdfjsLib={};mu.d(K,{AbortException:()=>Wr,AnnotationEditorLayer:()=>sv,AnnotationEditorParamsType:()=>le,AnnotationEditorType:()=>Z,AnnotationEditorUIManager:()=>So,AnnotationLayer:()=>pN,AnnotationMode:()=>Ji,ColorPicker:()=>dp,DOMSVGFactory:()=>g0,DrawLayer:()=>av,FeatureTest:()=>Xt,GlobalWorkerOptions:()=>Ri,ImageKind:()=>nf,InvalidPDFException:()=>Km,MissingPDFException:()=>Fu,OPS:()=>ss,OutputScale:()=>Jm,PDFDataRangeTransport:()=>Jb,PDFDateString:()=>h0,PDFWorker:()=>al,PasswordResponses:()=>AT,PermissionFlag:()=>bT,PixelsPerInch:()=>Vr,RenderingCancelledException:()=>c0,TextLayer:()=>Ou,TouchManager:()=>up,UnexpectedResponseException:()=>op,Util:()=>G,VerbosityLevel:()=>eg,XfaLayer:()=>eA,build:()=>qP,createValidAbsoluteUrl:()=>kT,fetchData:()=>ig,getDocument:()=>zP,getFilenameFromUrl:()=>jT,getPdfFilenameFromUrl:()=>FT,getXfaPageViewport:()=>OT,isDataScheme:()=>rg,isPdfFile:()=>u0,noContextMenu:()=>bs,normalizeUnicode:()=>LT,setLayerDimensions:()=>xo,shadow:()=>ie,stopEvent:()=>kn,version:()=>XP});const Dt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),QS=[1,0,0,1,0,0],Ym=[.001,0,0,.001,0,0],xT=1e7,Og=1.35,_n={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Ji={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},ST="pdfjs_internal_editor_",Z={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},le={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},bT={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Ct={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},nf={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Je={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Dc={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},eg={ERRORS:0,WARNINGS:1,INFOS:5},ss={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},AT={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let tg=eg.WARNINGS;function _T(n){Number.isInteger(n)&&(tg=n)}function ET(){return tg}function ng(n){tg>=eg.INFOS&&console.log(`Info: ${n}`)}function ee(n){tg>=eg.WARNINGS&&console.log(`Warning: ${n}`)}function _e(n){throw new Error(n)}function Ke(n,e){n||_e(e)}function CT(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function kT(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const i=n.match(/\./g);(i==null?void 0:i.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=MT(n)}catch{}}const s=e?new URL(n,e):new URL(n);if(CT(s))return s}catch{}return null}function ie(n,e,t,s=!1){return Object.defineProperty(n,e,{value:t,enumerable:!s,configurable:!0,writable:!1}),t}const Kr=function(){function e(t,s){this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e}();class Ww extends Kr{constructor(e,t){super(e,"PasswordException"),this.code=t}}class zg extends Kr{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Km extends Kr{constructor(e){super(e,"InvalidPDFException")}}class Fu extends Kr{constructor(e){super(e,"MissingPDFException")}}class op extends Kr{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class TT extends Kr{constructor(e){super(e,"FormatError")}}class Wr extends Kr{constructor(e){super(e,"AbortException")}}function JS(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&_e("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const s=[];for(let i=0;i<e;i+=t){const r=Math.min(i+t,e),a=n.subarray(i,r);s.push(String.fromCharCode.apply(null,a))}return s.join("")}function sg(n){typeof n!="string"&&_e("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let s=0;s<e;++s)t[s]=n.charCodeAt(s)&255;return t}function PT(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function o0(n){const e=Object.create(null);for(const[t,s]of n)e[t]=s;return e}function NT(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function RT(){try{return new Function(""),!0}catch{return!1}}class Xt{static get isLittleEndian(){return ie(this,"isLittleEndian",NT())}static get isEvalSupported(){return ie(this,"isEvalSupported",RT())}static get isOffscreenCanvasSupported(){return ie(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ie(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ie(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ie(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return ie(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Bg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Di,sf,Qm;class G{static makeHexColor(e,t,s){return`#${Bg[e]}${Bg[t]}${Bg[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[1],t[1]=s,s=t[2],t[2]=t[3],t[3]=s,e[1]<0&&(s=t[1],t[1]=t[3],t[3]=s),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[2],t[2]=s),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const s=e[0]*t[0]+e[1]*t[2]+t[4],i=e[0]*t[1]+e[1]*t[3]+t[5];return[s,i]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2],i=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s;return[i,r]}static getAxialAlignedBoundingBox(e,t){const s=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],r[0],a[0]),Math.min(s[1],i[1],r[1],a[1]),Math.max(s[0],i[0],r[0],a[0]),Math.max(s[1],i[1],r[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(s+a)/2,c=Math.sqrt((s+a)**2-4*(s*a-r*i))/2,u=o+c||1,h=o-c||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>a?null:[s,r,i,a]}static bezierBoundingBox(e,t,s,i,r,a,o,c,u){return u?(u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,c),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,c)):u=[Math.min(e,o),Math.min(t,c),Math.max(e,o),Math.max(t,c)],A(this,Di,Qm).call(this,e,s,r,o,t,i,a,c,3*(-e+3*(s-r)+o),6*(e-2*s+r),3*(s-e),u),A(this,Di,Qm).call(this,e,s,r,o,t,i,a,c,3*(-t+3*(i-a)+c),6*(t-2*i+a),3*(i-t),u),u}}Di=new WeakSet,sf=function(e,t,s,i,r,a,o,c,u,h){if(u<=0||u>=1)return;const d=1-u,f=u*u,g=f*u,m=d*(d*(d*e+3*u*t)+3*f*s)+g*i,w=d*(d*(d*r+3*u*a)+3*f*o)+g*c;h[0]=Math.min(h[0],m),h[1]=Math.min(h[1],w),h[2]=Math.max(h[2],m),h[3]=Math.max(h[3],w)},Qm=function(e,t,s,i,r,a,o,c,u,h,d,f){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&A(this,Di,sf).call(this,e,t,s,i,r,a,o,c,-d/h,f);return}const g=h**2-4*d*u;if(g<0)return;const m=Math.sqrt(g),w=2*u;A(this,Di,sf).call(this,e,t,s,i,r,a,o,c,(-h+m)/w,f),A(this,Di,sf).call(this,e,t,s,i,r,a,o,c,(-h-m)/w,f)},b(G,Di);function MT(n){return decodeURIComponent(escape(n))}let Ug=null,Vw=null;function LT(n){return Ug||(Ug=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Vw=new Map([["","t"]])),n.replaceAll(Ug,(e,t,s)=>t?t.normalize("NFKC"):Vw.get(s))}function IT(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),JS(n)}const l0="pdfjs_internal_id_";function DT(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(JS(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const Zs="http://www.w3.org/2000/svg",sa=class sa{};X(sa,"CSS",96),X(sa,"PDF",72),X(sa,"PDF_TO_CSS_UNITS",sa.CSS/sa.PDF);let Vr=sa;async function ig(n,e="text"){if(Vc(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,s)=>{const i=new XMLHttpRequest;i.open("GET",n,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}s(new Error(i.statusText))}},i.send(null)})}class yd{constructor({viewBox:e,userUnit:t,scale:s,rotation:i,offsetX:r=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=s,this.rotation=i,this.offsetX=r,this.offsetY=a,s*=t;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,d,f,g;switch(i%=360,i<0&&(i+=360),i){case 180:h=-1,d=0,f=0,g=1;break;case 90:h=0,d=1,f=1,g=0;break;case 270:h=0,d=-1,f=-1,g=0;break;case 0:h=1,d=0,f=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(f=-f,g=-g);let m,w,_,v;h===0?(m=Math.abs(u-e[1])*s+r,w=Math.abs(c-e[0])*s+a,_=(e[3]-e[1])*s,v=(e[2]-e[0])*s):(m=Math.abs(c-e[0])*s+r,w=Math.abs(u-e[1])*s+a,_=(e[2]-e[0])*s,v=(e[3]-e[1])*s),this.transform=[h*s,d*s,f*s,g*s,m-h*s*c-f*s*u,w-d*s*c-g*s*u],this.width=_,this.height=v}get rawDims(){const{userUnit:e,viewBox:t}=this,s=t.map(i=>i*e);return ie(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new yd({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return G.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=G.applyTransform([e[0],e[1]],this.transform),s=G.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return G.applyInverseTransform([e,t],this.transform)}}class c0 extends Kr{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function rg(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function u0(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function jT(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function FT(n,e="document.pdf"){if(typeof n!="string")return e;if(rg(n))return ee('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=t.exec(n);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch{}return r||e}class Gw{constructor(){X(this,"started",Object.create(null));X(this,"times",[])}time(e){e in this.started&&ee(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||ee(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:s}of this.times)t=Math.max(s.length,t);for(const{name:s,start:i,end:r}of this.times)e.push(`${s.padEnd(t)} ${r-i}ms
`);return e.join("")}}function Vc(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function bs(n){n.preventDefault()}function kn(n){n.preventDefault(),n.stopPropagation()}var Uu;class h0{static toDateObject(e){if(!e||typeof e!="string")return null;l(this,Uu)||y(this,Uu,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=l(this,Uu).exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(a+=h,o+=d):u==="+"&&(a-=h,o-=d),new Date(Date.UTC(s,i,r,a,o,c))}}Uu=new WeakMap,b(h0,Uu);function OT(n,{scale:e=1,rotation:t=0}){const{width:s,height:i}=n.attributes.style,r=[0,0,parseInt(s),parseInt(i)];return new yd({viewBox:r,userUnit:1,scale:e,rotation:t})}function d0(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(ee(`Not a valid color format: "${n}"`),[0,0,0])}function zT(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const s=window.getComputedStyle(e).color;n.set(t,d0(s))}e.remove()}function Re(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform();return[e,t,s,i,r,a]}function Cs(n){const{a:e,b:t,c:s,d:i,e:r,f:a}=n.getTransform().invertSelf();return[e,t,s,i,r,a]}function xo(n,e,t=!1,s=!0){if(e instanceof yd){const{pageWidth:i,pageHeight:r}=e.rawDims,{style:a}=n,o=Xt.isCSSRoundSupported,c=`var(--scale-factor) * ${i}px`,u=`var(--scale-factor) * ${r}px`,h=o?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,d=o?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=h,a.height=d):(a.width=d,a.height=h)}s&&n.setAttribute("data-main-rotation",e.rotation)}class Jm{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Zi,la,is,ca,Hu,$u,mp,ZS,qt,eb,tb,rf,nb,ey;const si=class si{constructor(e){b(this,qt);b(this,Zi,null);b(this,la,null);b(this,is);b(this,ca,null);b(this,Hu,null);y(this,is,e),l(si,$u)||y(si,$u,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=y(this,Zi,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=l(this,is)._uiManager._signal;e.addEventListener("contextmenu",bs,{signal:t}),e.addEventListener("pointerdown",A(si,mp,ZS),{signal:t});const s=y(this,ca,document.createElement("div"));s.className="buttons",e.append(s);const i=l(this,is).toolbarPosition;if(i){const{style:r}=e,a=l(this,is)._uiManager.direction==="ltr"?1-i[0]:i[0];r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return A(this,qt,nb).call(this),e}get div(){return l(this,Zi)}hide(){var e;l(this,Zi).classList.add("hidden"),(e=l(this,la))==null||e.hideDropdown()}show(){var e;l(this,Zi).classList.remove("hidden"),(e=l(this,Hu))==null||e.shown()}async addAltText(e){const t=await e.render();A(this,qt,rf).call(this,t),l(this,ca).prepend(t,l(this,qt,ey)),y(this,Hu,e)}addColorPicker(e){y(this,la,e);const t=e.renderButton();A(this,qt,rf).call(this,t),l(this,ca).prepend(t,l(this,qt,ey))}remove(){var e;l(this,Zi).remove(),(e=l(this,la))==null||e.destroy(),y(this,la,null)}};Zi=new WeakMap,la=new WeakMap,is=new WeakMap,ca=new WeakMap,Hu=new WeakMap,$u=new WeakMap,mp=new WeakSet,ZS=function(e){e.stopPropagation()},qt=new WeakSet,eb=function(e){l(this,is)._focusEventsAllowed=!1,kn(e)},tb=function(e){l(this,is)._focusEventsAllowed=!0,kn(e)},rf=function(e){const t=l(this,is)._uiManager._signal;e.addEventListener("focusin",A(this,qt,eb).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",A(this,qt,tb).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",bs,{signal:t})},nb=function(){const{editorType:e,_uiManager:t}=l(this,is),s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",l(si,$u)[e]),A(this,qt,rf).call(this,s),s.addEventListener("click",i=>{t.delete()},{signal:t._signal}),l(this,ca).append(s)},ey=function(){const e=document.createElement("div");return e.className="divider",e},b(si,mp),b(si,$u,null);let Zm=si;var Wu,ua,ha,Gr,sb,ib,rb;class BT{constructor(e){b(this,Gr);b(this,Wu,null);b(this,ua,null);b(this,ha);y(this,ha,e)}show(e,t,s){const[i,r]=A(this,Gr,ib).call(this,t,s),{style:a}=l(this,ua)||y(this,ua,A(this,Gr,sb).call(this));e.append(l(this,ua)),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){l(this,ua).remove()}}Wu=new WeakMap,ua=new WeakMap,ha=new WeakMap,Gr=new WeakSet,sb=function(){const e=y(this,ua,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",bs,{signal:l(this,ha)._signal});const t=y(this,Wu,document.createElement("div"));return t.className="buttons",e.append(t),A(this,Gr,rb).call(this),e},ib=function(e,t){let s=0,i=0;for(const r of e){const a=r.y+r.height;if(a<s)continue;const o=r.x+(t?r.width:0);if(a>s){i=o,s=a;continue}t?o>i&&(i=o):o<i&&(i=o)}return[t?1-i:i,s]},rb=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=l(this,ha)._signal;e.addEventListener("contextmenu",bs,{signal:s}),e.addEventListener("click",()=>{l(this,ha).highlightSelection("floating_button")},{signal:s}),l(this,Wu).append(e)};function lp(n,e,t){for(const s of t)e.addEventListener(s,n[s].bind(n))}var yp;class UT{constructor(){b(this,yp,0)}get id(){return`${ST}${zt(this,yp)._++}`}}yp=new WeakMap;var ol,Vu,Pt,ll,af;const y0=class y0{constructor(){b(this,ll);b(this,ol,IT());b(this,Vu,0);b(this,Pt,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const r=i.decode().then(()=>(s.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return ie(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:s,size:i,type:r}=e;return A(this,ll,af).call(this,`${t}_${s}_${i}_${r}`,e)}async getFromUrl(e){return A(this,ll,af).call(this,e,e)}async getFromBlob(e,t){const s=await t;return A(this,ll,af).call(this,e,s)}async getFromId(e){l(this,Pt)||y(this,Pt,new Map);const t=l(this,Pt).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:s}=t;return delete t.blobPromise,this.getFromBlob(t.id,s)}return this.getFromUrl(t.url)}getFromCanvas(e,t){l(this,Pt)||y(this,Pt,new Map);let s=l(this,Pt).get(e);if(s!=null&&s.bitmap)return s.refCounter+=1,s;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),s={bitmap:i.transferToImageBitmap(),id:`image_${l(this,ol)}_${zt(this,Vu)._++}`,refCounter:1,isSvg:!1},l(this,Pt).set(e,s),l(this,Pt).set(s.id,s),s}getSvgUrl(e){const t=l(this,Pt).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var i;l(this,Pt)||y(this,Pt,new Map);const t=l(this,Pt).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:s}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),t.blobPromise=r.convertToBlob()}(i=s.close)==null||i.call(s),t.bitmap=null}isValidId(e){return e.startsWith(`image_${l(this,ol)}_`)}};ol=new WeakMap,Vu=new WeakMap,Pt=new WeakMap,ll=new WeakSet,af=async function(e,t){l(this,Pt)||y(this,Pt,new Map);let s=l(this,Pt).get(e);if(s===null)return null;if(s!=null&&s.bitmap)return s.refCounter+=1,s;try{s||(s={bitmap:null,id:`image_${l(this,ol)}_${zt(this,Vu)._++}`,refCounter:0,isSvg:!1});let i;if(typeof t=="string"?(s.url=t,i=await ig(t,"blob")):t instanceof File?i=s.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const r=y0._isSVGFittingCanvas,a=new FileReader,o=new Image,c=new Promise((u,h)=>{o.onload=()=>{s.bitmap=o,s.isSvg=!0,u()},a.onload=async()=>{const d=s.svgUrl=a.result;o.src=await r?`${d}#svgView(preserveAspectRatio(none))`:d},o.onerror=a.onerror=h});a.readAsDataURL(i),await c}else s.bitmap=await createImageBitmap(i);s.refCounter=1}catch(i){ee(i),s=null}return l(this,Pt).set(e,s),s&&l(this,Pt).set(s.id,s),s};let ty=y0;var $e,er,Gu,Ie;class HT{constructor(e=128){b(this,$e,[]);b(this,er,!1);b(this,Gu);b(this,Ie,-1);y(this,Gu,e)}add({cmd:e,undo:t,post:s,mustExec:i,type:r=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(i&&e(),l(this,er))return;const c={cmd:e,undo:t,post:s,type:r};if(l(this,Ie)===-1){l(this,$e).length>0&&(l(this,$e).length=0),y(this,Ie,0),l(this,$e).push(c);return}if(a&&l(this,$e)[l(this,Ie)].type===r){o&&(c.undo=l(this,$e)[l(this,Ie)].undo),l(this,$e)[l(this,Ie)]=c;return}const u=l(this,Ie)+1;u===l(this,Gu)?l(this,$e).splice(0,1):(y(this,Ie,u),u<l(this,$e).length&&l(this,$e).splice(u)),l(this,$e).push(c)}undo(){if(l(this,Ie)===-1)return;y(this,er,!0);const{undo:e,post:t}=l(this,$e)[l(this,Ie)];e(),t==null||t(),y(this,er,!1),y(this,Ie,l(this,Ie)-1)}redo(){if(l(this,Ie)<l(this,$e).length-1){y(this,Ie,l(this,Ie)+1),y(this,er,!0);const{cmd:e,post:t}=l(this,$e)[l(this,Ie)];e(),t==null||t(),y(this,er,!1)}}hasSomethingToUndo(){return l(this,Ie)!==-1}hasSomethingToRedo(){return l(this,Ie)<l(this,$e).length-1}cleanType(e){if(l(this,Ie)!==-1){for(let t=l(this,Ie);t>=0;t--)if(l(this,$e)[t].type!==e){l(this,$e).splice(t+1,l(this,Ie)-t),y(this,Ie,t);return}l(this,$e).length=0,y(this,Ie,-1)}}destroy(){y(this,$e,null)}}$e=new WeakMap,er=new WeakMap,Gu=new WeakMap,Ie=new WeakMap;var vp,ab;class vd{constructor(e){b(this,vp);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Xt.platform;for(const[s,i,r={}]of e)for(const a of s){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:i,options:r}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(A(this,vp,ab).call(this,t));if(!s)return;const{callback:i,options:{bubbles:r=!1,args:a=[],checker:o=null}}=s;o&&!o(e,t)||(i.bind(e,...a,t)(),r||kn(t))}}vp=new WeakSet,ab=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const wp=class wp{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return zT(e),ie(this,"_colors",e)}convert(e){const t=d0(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[s,i]of this._colors)if(i.every((r,a)=>r===t[a]))return wp._colorsMapping.get(s);return t}getHexCode(e){const t=this._colors.get(e);return t?G.makeHexColor(...t):e}};X(wp,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let ny=wp;var cl,dn,et,pt,ul,ai,hl,Dn,tr,da,dl,fa,Ns,rs,pa,Xu,qu,fl,Yu,Rs,nr,pl,sr,Ms,xp,ir,Ku,rr,ga,Qu,Ju,rt,ye,oi,ma,Zu,eh,ar,Ls,li,th,jn,F,of,sy,ob,lb,lf,cb,ub,hb,iy,db,ry,ay,fb,Bt,ei,pb,gb,oy,mb,Gc,ly;const Qo=class Qo{constructor(e,t,s,i,r,a,o,c,u,h,d,f,g){b(this,F);b(this,cl,new AbortController);b(this,dn,null);b(this,et,new Map);b(this,pt,new Map);b(this,ul,null);b(this,ai,null);b(this,hl,null);b(this,Dn,new HT);b(this,tr,null);b(this,da,null);b(this,dl,0);b(this,fa,new Set);b(this,Ns,null);b(this,rs,null);b(this,pa,new Set);X(this,"_editorUndoBar",null);b(this,Xu,!1);b(this,qu,!1);b(this,fl,!1);b(this,Yu,null);b(this,Rs,null);b(this,nr,null);b(this,pl,null);b(this,sr,!1);b(this,Ms,null);b(this,xp,new UT);b(this,ir,!1);b(this,Ku,!1);b(this,rr,null);b(this,ga,null);b(this,Qu,null);b(this,Ju,null);b(this,rt,Z.NONE);b(this,ye,new Set);b(this,oi,null);b(this,ma,null);b(this,Zu,null);b(this,eh,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});b(this,ar,[0,0]);b(this,Ls,null);b(this,li,null);b(this,th,null);b(this,jn,null);const m=this._signal=l(this,cl).signal;y(this,li,e),y(this,th,t),y(this,ul,s),this._eventBus=i,i._on("editingaction",this.onEditingAction.bind(this),{signal:m}),i._on("pagechanging",this.onPageChanging.bind(this),{signal:m}),i._on("scalechanging",this.onScaleChanging.bind(this),{signal:m}),i._on("rotationchanging",this.onRotationChanging.bind(this),{signal:m}),i._on("setpreference",this.onSetPreference.bind(this),{signal:m}),i._on("switchannotationeditorparams",w=>this.updateParams(w.type,w.value),{signal:m}),A(this,F,cb).call(this),A(this,F,fb).call(this),A(this,F,iy).call(this),y(this,ai,r.annotationStorage),y(this,Yu,r.filterFactory),y(this,ma,a),y(this,pl,o||null),y(this,Xu,c),y(this,qu,u),y(this,fl,h),y(this,Ju,d||null),this.viewParameters={realScale:Vr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=g!==!1}static get _keyboardManager(){const e=Qo.prototype,t=a=>l(a,li).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),s=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:c}=o;return c!=="text"&&c!=="number"}return!0},i=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return ie(this,"_keyboardManager",new vd([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,li).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&l(a,li).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,s,i,r;(e=l(this,jn))==null||e.resolve(),y(this,jn,null),(t=l(this,cl))==null||t.abort(),y(this,cl,null),this._signal=null;for(const a of l(this,pt).values())a.destroy();l(this,pt).clear(),l(this,et).clear(),l(this,pa).clear(),y(this,dn,null),l(this,ye).clear(),l(this,Dn).destroy(),(s=l(this,ul))==null||s.destroy(),(i=l(this,Ms))==null||i.hide(),y(this,Ms,null),l(this,Rs)&&(clearTimeout(l(this,Rs)),y(this,Rs,null)),l(this,Ls)&&(clearTimeout(l(this,Ls)),y(this,Ls,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return l(this,Ju)}get useNewAltTextFlow(){return l(this,qu)}get useNewAltTextWhenAddingImage(){return l(this,fl)}get hcmFilter(){return ie(this,"hcmFilter",l(this,ma)?l(this,Yu).addHCMFilter(l(this,ma).foreground,l(this,ma).background):"none")}get direction(){return ie(this,"direction",getComputedStyle(l(this,li)).direction)}get highlightColors(){return ie(this,"highlightColors",l(this,pl)?new Map(l(this,pl).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return ie(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),y(this,da,e)}setMainHighlightColorPicker(e){y(this,Qu,e)}editAltText(e,t=!1){var s;(s=l(this,ul))==null||s.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":y(this,fl,t);break}}onPageChanging({pageNumber:e}){y(this,dl,e-1)}focusMainContainer(){l(this,li).focus()}findParent(e,t){for(const s of l(this,pt).values()){const{x:i,y:r,width:a,height:o}=s.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=r&&t<=r+o)return s}return null}disableUserSelect(e=!1){l(this,th).classList.toggle("noUserSelect",e)}addShouldRescale(e){l(this,pa).add(e)}removeShouldRescale(e){l(this,pa).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Vr.PDF_TO_CSS_UNITS;for(const s of l(this,pa))s.onScaleChanging();(t=l(this,da))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a}=t,o=t.toString(),u=A(this,F,of).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;t.empty();const d=A(this,F,sy).call(this,u),f=l(this,rt)===Z.NONE,g=()=>{d==null||d.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:s,anchorOffset:i,focusNode:r,focusOffset:a,text:o}),f&&this.showAllEditors("highlight",!0,!0)};if(f){this.switchToMode(Z.HIGHLIGHT,g);return}g()}addToAnnotationStorage(e){!e.isEmpty()&&l(this,ai)&&!l(this,ai).has(e.id)&&l(this,ai).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,l(this,sr)&&(y(this,sr,!1),A(this,F,lf).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of l(this,ye))if(t.div.contains(e)){y(this,ga,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!l(this,ga))return;const[e,t]=l(this,ga);y(this,ga,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){A(this,F,iy).call(this),A(this,F,ry).call(this)}removeEditListeners(){A(this,F,db).call(this),A(this,F,ay).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const s of l(this,rs))if(s.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const s of l(this,rs))if(s.isHandlingMimeForPasting(t.type)){s.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var s;if(e.preventDefault(),(s=l(this,dn))==null||s.commitOrRemove(),!this.hasSelection)return;const t=[];for(const i of l(this,ye)){const r=i.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const a of l(this,rs))if(a.isHandlingMimeForPasting(r.type)){a.paste(r,this.currentLayer);return}let s=t.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(r){ee(`paste: "${r.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const i=this.currentLayer;try{const r=[];for(const c of s){const u=await i.deserialize(c);if(!u)return;r.push(u)}const a=()=>{for(const c of r)A(this,F,oy).call(this,c);A(this,F,ly).call(this,r)},o=()=>{for(const c of r)c.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(r){ee(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),l(this,rt)!==Z.NONE&&!this.isEditorHandlingKeyboard&&Qo._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,l(this,sr)&&(y(this,sr,!1),A(this,F,lf).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(A(this,F,ub).call(this),A(this,F,ry).call(this),A(this,F,Bt).call(this,{isEditing:l(this,rt)!==Z.NONE,isEmpty:A(this,F,Gc).call(this),hasSomethingToUndo:l(this,Dn).hasSomethingToUndo(),hasSomethingToRedo:l(this,Dn).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,F,hb).call(this),A(this,F,ay).call(this),A(this,F,Bt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!l(this,rs)){y(this,rs,e);for(const t of l(this,rs))A(this,F,ei).call(this,t.defaultPropertiesToUpdate)}}getId(){return l(this,xp).id}get currentLayer(){return l(this,pt).get(l(this,dl))}getLayer(e){return l(this,pt).get(e)}get currentPageIndex(){return l(this,dl)}addLayer(e){l(this,pt).set(e.pageIndex,e),l(this,ir)?e.enable():e.disable()}removeLayer(e){l(this,pt).delete(e.pageIndex)}async updateMode(e,t=null,s=!1){var i;if(l(this,rt)!==e&&!(l(this,jn)&&(await l(this,jn).promise,!l(this,jn)))){if(y(this,jn,Promise.withResolvers()),y(this,rt,e),e===Z.NONE){this.setEditingState(!1),A(this,F,gb).call(this),(i=this._editorUndoBar)==null||i.hide(),l(this,jn).resolve();return}this.setEditingState(!0),await A(this,F,pb).call(this),this.unselectAll();for(const r of l(this,pt).values())r.updateMode(e);if(!t){s&&this.addNewEditorFromKeyboard(),l(this,jn).resolve();return}for(const r of l(this,et).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();l(this,jn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==l(this,rt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var s;if(l(this,rs)){switch(e){case le.CREATE:this.currentLayer.addNewEditor();return;case le.HIGHLIGHT_DEFAULT_COLOR:(s=l(this,Qu))==null||s.updateColor(t);break;case le.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(l(this,Zu)||y(this,Zu,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const i of l(this,ye))i.updateParams(e,t);for(const i of l(this,rs))i.updateDefaultParams(e,t)}}showAllEditors(e,t,s=!1){var r;for(const a of l(this,et).values())a.editorType===e&&a.show(t);(((r=l(this,Zu))==null?void 0:r.get(le.HIGHLIGHT_SHOW_ALL))??!0)!==t&&A(this,F,ei).call(this,[[le.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(l(this,Ku)!==e){y(this,Ku,e);for(const t of l(this,pt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const s of l(this,et).values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return l(this,et).get(e)}addEditor(e){l(this,et).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(l(this,Rs)&&clearTimeout(l(this,Rs)),y(this,Rs,setTimeout(()=>{this.focusMainContainer(),y(this,Rs,null)},0))),l(this,et).delete(e.id),this.unselect(e),(!e.annotationElementId||!l(this,fa).has(e.annotationElementId))&&((t=l(this,ai))==null||t.remove(e.id))}addDeletedAnnotationElement(e){l(this,fa).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return l(this,fa).has(e)}removeDeletedAnnotationElement(e){l(this,fa).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){l(this,dn)!==e&&(y(this,dn,e),e&&A(this,F,ei).call(this,e.propertiesToUpdate))}updateUI(e){l(this,F,mb)===e&&A(this,F,ei).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){A(this,F,ei).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(l(this,ye).has(e)){l(this,ye).delete(e),e.unselect(),A(this,F,Bt).call(this,{hasSelectedEditor:this.hasSelection});return}l(this,ye).add(e),e.select(),A(this,F,ei).call(this,e.propertiesToUpdate),A(this,F,Bt).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=l(this,da))==null||t.commitOrRemove();for(const s of l(this,ye))s!==e&&s.unselect();l(this,ye).clear(),l(this,ye).add(e),e.select(),A(this,F,ei).call(this,e.propertiesToUpdate),A(this,F,Bt).call(this,{hasSelectedEditor:!0})}isSelected(e){return l(this,ye).has(e)}get firstSelectedEditor(){return l(this,ye).values().next().value}unselect(e){e.unselect(),l(this,ye).delete(e),A(this,F,Bt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return l(this,ye).size!==0}get isEnterHandled(){return l(this,ye).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;l(this,Dn).undo(),A(this,F,Bt).call(this,{hasSomethingToUndo:l(this,Dn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,F,Gc).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){l(this,Dn).redo(),A(this,F,Bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:l(this,Dn).hasSomethingToRedo(),isEmpty:A(this,F,Gc).call(this)})}addCommands(e){l(this,Dn).add(e),A(this,F,Bt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,F,Gc).call(this)})}cleanUndoStack(e){l(this,Dn).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...l(this,ye)],s=()=>{var a;(a=this._editorUndoBar)==null||a.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const a of t)A(this,F,oy).call(this,a)};this.addCommands({cmd:s,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=l(this,dn))==null||e.commitOrRemove()}hasSomethingToControl(){return l(this,dn)||this.hasSelection}selectAll(){for(const e of l(this,ye))e.commit();A(this,F,ly).call(this,l(this,et).values())}unselectAll(){var e;if(!(l(this,dn)&&(l(this,dn).commitOrRemove(),l(this,rt)!==Z.NONE))&&!((e=l(this,da))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of l(this,ye))t.unselect();l(this,ye).clear(),A(this,F,Bt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;l(this,ar)[0]+=e,l(this,ar)[1]+=t;const[i,r]=l(this,ar),a=[...l(this,ye)],o=1e3;l(this,Ls)&&clearTimeout(l(this,Ls)),y(this,Ls,setTimeout(()=>{y(this,Ls,null),l(this,ar)[0]=l(this,ar)[1]=0,this.addCommands({cmd:()=>{for(const c of a)l(this,et).has(c.id)&&c.translateInPage(i,r)},undo:()=>{for(const c of a)l(this,et).has(c.id)&&c.translateInPage(-i,-r)},mustExec:!1})},o));for(const c of a)c.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),y(this,Ns,new Map);for(const e of l(this,ye))l(this,Ns).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!l(this,Ns))return!1;this.disableUserSelect(!1);const e=l(this,Ns);y(this,Ns,null);let t=!1;for(const[{x:i,y:r,pageIndex:a},o]of e)o.newX=i,o.newY=r,o.newPageIndex=a,t||(t=i!==o.savedX||r!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const s=(i,r,a,o)=>{if(l(this,et).has(i.id)){const c=l(this,pt).get(o);c?i._setParentAndPosition(c,r,a):(i.pageIndex=o,i.x=r,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:r,newY:a,newPageIndex:o}]of e)s(i,r,a,o)},undo:()=>{for(const[i,{savedX:r,savedY:a,savedPageIndex:o}]of e)s(i,r,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(l(this,Ns))for(const s of l(this,Ns).keys())s.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||l(this,ye).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return l(this,dn)===e}getActive(){return l(this,dn)}getMode(){return l(this,rt)}get imageManager(){return ie(this,"imageManager",new ty)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:i,width:r,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,h,d,f)=>({x:(h-i)/a,y:1-(u+d-s)/r,width:f/a,height:d/r});break;case"180":o=(u,h,d,f)=>({x:1-(u+d-s)/r,y:1-(h+f-i)/a,width:d/r,height:f/a});break;case"270":o=(u,h,d,f)=>({x:1-(h+f-i)/a,y:(u-s)/r,width:f/a,height:d/r});break;default:o=(u,h,d,f)=>({x:(u-s)/r,y:(h-i)/a,width:d/r,height:f/a});break}const c=[];for(let u=0,h=t.rangeCount;u<h;u++){const d=t.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:g,width:m,height:w}of d.getClientRects())m===0||w===0||c.push(o(f,g,m,w))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:t}){(l(this,hl)||y(this,hl,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=l(this,hl))==null||t.delete(e)}renderAnnotationElement(e){var i;const t=(i=l(this,hl))==null?void 0:i.get(e.data.id);if(!t)return;const s=l(this,ai).getRawValue(t);s&&(l(this,rt)===Z.NONE&&!s.hasBeenModified||s.renderAnnotationElement(e))}};cl=new WeakMap,dn=new WeakMap,et=new WeakMap,pt=new WeakMap,ul=new WeakMap,ai=new WeakMap,hl=new WeakMap,Dn=new WeakMap,tr=new WeakMap,da=new WeakMap,dl=new WeakMap,fa=new WeakMap,Ns=new WeakMap,rs=new WeakMap,pa=new WeakMap,Xu=new WeakMap,qu=new WeakMap,fl=new WeakMap,Yu=new WeakMap,Rs=new WeakMap,nr=new WeakMap,pl=new WeakMap,sr=new WeakMap,Ms=new WeakMap,xp=new WeakMap,ir=new WeakMap,Ku=new WeakMap,rr=new WeakMap,ga=new WeakMap,Qu=new WeakMap,Ju=new WeakMap,rt=new WeakMap,ye=new WeakMap,oi=new WeakMap,ma=new WeakMap,Zu=new WeakMap,eh=new WeakMap,ar=new WeakMap,Ls=new WeakMap,li=new WeakMap,th=new WeakMap,jn=new WeakMap,F=new WeakSet,of=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},sy=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const s of l(this,pt).values())if(s.hasTextLayer(e))return s;return null},ob=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const s=A(this,F,of).call(this,e).closest(".textLayer"),i=this.getSelectionBoxes(s);i&&(l(this,Ms)||y(this,Ms,new BT(this)),l(this,Ms).show(s,i,this.direction==="ltr"))},lb=function(){var r,a,o;const e=document.getSelection();if(!e||e.isCollapsed){l(this,oi)&&((r=l(this,Ms))==null||r.hide(),y(this,oi,null),A(this,F,Bt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===l(this,oi))return;const i=A(this,F,of).call(this,e).closest(".textLayer");if(!i){l(this,oi)&&((a=l(this,Ms))==null||a.hide(),y(this,oi,null),A(this,F,Bt).call(this,{hasSelectedText:!1}));return}if((o=l(this,Ms))==null||o.hide(),y(this,oi,t),A(this,F,Bt).call(this,{hasSelectedText:!0}),!(l(this,rt)!==Z.HIGHLIGHT&&l(this,rt)!==Z.NONE)&&(l(this,rt)===Z.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),y(this,sr,this.isShiftKeyDown),!this.isShiftKeyDown)){const c=l(this,rt)===Z.HIGHLIGHT?A(this,F,sy).call(this,i):null;c==null||c.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),d=f=>{f.type==="pointerup"&&f.button!==0||(u.abort(),c==null||c.toggleDrawing(!0),f.type==="pointerup"&&A(this,F,lf).call(this,"main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}},lf=function(e=""){l(this,rt)===Z.HIGHLIGHT?this.highlightSelection(e):l(this,Xu)&&A(this,F,ob).call(this)},cb=function(){document.addEventListener("selectionchange",A(this,F,lb).bind(this),{signal:this._signal})},ub=function(){if(l(this,nr))return;y(this,nr,new AbortController);const e=this.combinedSignal(l(this,nr));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},hb=function(){var e;(e=l(this,nr))==null||e.abort(),y(this,nr,null)},iy=function(){if(l(this,rr))return;y(this,rr,new AbortController);const e=this.combinedSignal(l(this,rr));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},db=function(){var e;(e=l(this,rr))==null||e.abort(),y(this,rr,null)},ry=function(){if(l(this,tr))return;y(this,tr,new AbortController);const e=this.combinedSignal(l(this,tr));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},ay=function(){var e;(e=l(this,tr))==null||e.abort(),y(this,tr,null)},fb=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Bt=function(e){Object.entries(e).some(([s,i])=>l(this,eh)[s]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(l(this,eh),e)}),l(this,rt)===Z.HIGHLIGHT&&e.hasSelectedEditor===!1&&A(this,F,ei).call(this,[[le.HIGHLIGHT_FREE,!0]]))},ei=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},pb=async function(){if(!l(this,ir)){y(this,ir,!0);const e=[];for(const t of l(this,pt).values())e.push(t.enable());await Promise.all(e);for(const t of l(this,et).values())t.enable()}},gb=function(){if(this.unselectAll(),l(this,ir)){y(this,ir,!1);for(const e of l(this,pt).values())e.disable();for(const e of l(this,et).values())e.disable()}},oy=function(e){const t=l(this,pt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},mb=function(){let e=null;for(e of l(this,ye));return e},Gc=function(){if(l(this,et).size===0)return!0;if(l(this,et).size===1)for(const e of l(this,et).values())return e.isEmpty();return!1},ly=function(e){for(const t of l(this,ye))t.unselect();l(this,ye).clear();for(const t of e)t.isEmpty()||(l(this,ye).add(t),t.select());A(this,F,Bt).call(this,{hasSelectedEditor:this.hasSelection})},X(Qo,"TRANSLATE_SMALL",1),X(Qo,"TRANSLATE_BIG",10);let So=Qo;var at,Is,as,gl,Ds,fn,ml,js,nn,ci,ya,Fs,or,vs,Xc,cf;const Ut=class Ut{constructor(e){b(this,vs);b(this,at,null);b(this,Is,!1);b(this,as,null);b(this,gl,null);b(this,Ds,null);b(this,fn,null);b(this,ml,!1);b(this,js,null);b(this,nn,null);b(this,ci,null);b(this,ya,null);b(this,Fs,!1);y(this,nn,e),y(this,Fs,e._uiManager.useNewAltTextFlow),l(Ut,or)||y(Ut,or,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Ut._l10n??(Ut._l10n=e)}async render(){const e=y(this,as,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=y(this,gl,document.createElement("span"));e.append(t),l(this,Fs)?(e.classList.add("new"),e.setAttribute("data-l10n-id",l(Ut,or).missing),t.setAttribute("data-l10n-id",l(Ut,or)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=l(this,nn)._uiManager._signal;e.addEventListener("contextmenu",bs,{signal:s}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:s});const i=r=>{r.preventDefault(),l(this,nn)._uiManager.editAltText(l(this,nn)),l(this,Fs)&&l(this,nn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:l(this,vs,Xc)}})};return e.addEventListener("click",i,{capture:!0,signal:s}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(y(this,ml,!0),i(r))},{signal:s}),await A(this,vs,cf).call(this),e}finish(){l(this,as)&&(l(this,as).focus({focusVisible:l(this,ml)}),y(this,ml,!1))}isEmpty(){return l(this,Fs)?l(this,at)===null:!l(this,at)&&!l(this,Is)}hasData(){return l(this,Fs)?l(this,at)!==null||!!l(this,ci):this.isEmpty()}get guessedText(){return l(this,ci)}async setGuessedText(e){l(this,at)===null&&(y(this,ci,e),y(this,ya,await Ut._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),A(this,vs,cf).call(this))}toggleAltTextBadge(e=!1){var t;if(!l(this,Fs)||l(this,at)){(t=l(this,js))==null||t.remove(),y(this,js,null);return}if(!l(this,js)){const s=y(this,js,document.createElement("div"));s.className="noAltTextBadge",l(this,nn).div.append(s)}l(this,js).classList.toggle("hidden",!e)}serialize(e){let t=l(this,at);return!e&&l(this,ci)===t&&(t=l(this,ya)),{altText:t,decorative:l(this,Is),guessedText:l(this,ci),textWithDisclaimer:l(this,ya)}}get data(){return{altText:l(this,at),decorative:l(this,Is)}}set data({altText:e,decorative:t,guessedText:s,textWithDisclaimer:i,cancel:r=!1}){s&&(y(this,ci,s),y(this,ya,i)),!(l(this,at)===e&&l(this,Is)===t)&&(r||(y(this,at,e),y(this,Is,t)),A(this,vs,cf).call(this))}toggle(e=!1){l(this,as)&&(!e&&l(this,fn)&&(clearTimeout(l(this,fn)),y(this,fn,null)),l(this,as).disabled=!e)}shown(){l(this,nn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:l(this,vs,Xc)}})}destroy(){var e,t;(e=l(this,as))==null||e.remove(),y(this,as,null),y(this,gl,null),y(this,Ds,null),(t=l(this,js))==null||t.remove(),y(this,js,null)}};at=new WeakMap,Is=new WeakMap,as=new WeakMap,gl=new WeakMap,Ds=new WeakMap,fn=new WeakMap,ml=new WeakMap,js=new WeakMap,nn=new WeakMap,ci=new WeakMap,ya=new WeakMap,Fs=new WeakMap,or=new WeakMap,vs=new WeakSet,Xc=function(){return l(this,at)&&"added"||l(this,at)===null&&this.guessedText&&"review"||"missing"},cf=async function(){var i,r,a;const e=l(this,as);if(!e)return;if(l(this,Fs)){if(e.classList.toggle("done",!!l(this,at)),e.setAttribute("data-l10n-id",l(Ut,or)[l(this,vs,Xc)]),(i=l(this,gl))==null||i.setAttribute("data-l10n-id",l(Ut,or)[`${l(this,vs,Xc)}-label`]),!l(this,at)){(r=l(this,Ds))==null||r.remove();return}}else{if(!l(this,at)&&!l(this,Is)){e.classList.remove("done"),(a=l(this,Ds))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=l(this,Ds);if(!t){y(this,Ds,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${l(this,nn).id}`;const o=100,c=l(this,nn)._uiManager._signal;c.addEventListener("abort",()=>{clearTimeout(l(this,fn)),y(this,fn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{y(this,fn,setTimeout(()=>{y(this,fn,null),l(this,Ds).classList.add("show"),l(this,nn)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:c}),e.addEventListener("mouseleave",()=>{var u;l(this,fn)&&(clearTimeout(l(this,fn)),y(this,fn,null)),(u=l(this,Ds))==null||u.classList.remove("show")},{signal:c})}l(this,Is)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=l(this,at)),t.parentNode||e.append(t);const s=l(this,nn).getImageForAltText();s==null||s.setAttribute("aria-describedby",t.id)},b(Ut,or,null),X(Ut,"_l10n",null);let cp=Ut;var nh,va,sh,ih,rh,ah,oh,yl,ui,wa,lr,Ui,yb,vb,cy;const v0=class v0{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:s=null,onPinchStart:i=null,onPinching:r=null,onPinchEnd:a=null,signal:o}){b(this,Ui);b(this,nh);b(this,va,!1);b(this,sh,null);b(this,ih);b(this,rh);b(this,ah);b(this,oh);b(this,yl);b(this,ui,null);b(this,wa);b(this,lr,null);y(this,nh,e),y(this,sh,s),y(this,ih,t),y(this,rh,i),y(this,ah,r),y(this,oh,a),y(this,wa,new AbortController),y(this,yl,AbortSignal.any([o,l(this,wa).signal])),e.addEventListener("touchstart",A(this,Ui,yb).bind(this),{passive:!1,signal:l(this,yl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ie(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=l(this,wa))==null||e.abort(),y(this,wa,null)}};nh=new WeakMap,va=new WeakMap,sh=new WeakMap,ih=new WeakMap,rh=new WeakMap,ah=new WeakMap,oh=new WeakMap,yl=new WeakMap,ui=new WeakMap,wa=new WeakMap,lr=new WeakMap,Ui=new WeakSet,yb=function(e){var i,r,a;if((i=l(this,ih))!=null&&i.call(this)||e.touches.length<2)return;if(!l(this,lr)){y(this,lr,new AbortController);const o=AbortSignal.any([l(this,yl),l(this,lr).signal]),c=l(this,nh),u={signal:o,passive:!1};c.addEventListener("touchmove",A(this,Ui,vb).bind(this),u),c.addEventListener("touchend",A(this,Ui,cy).bind(this),u),c.addEventListener("touchcancel",A(this,Ui,cy).bind(this),u),(r=l(this,rh))==null||r.call(this)}if(kn(e),e.touches.length!==2||(a=l(this,sh))!=null&&a.call(this)){y(this,ui,null);return}let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]),y(this,ui,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:s.screenX,touch1Y:s.screenY})},vb=function(e){var E;if(!l(this,ui)||e.touches.length!==2)return;let[t,s]=e.touches;t.identifier>s.identifier&&([t,s]=[s,t]);const{screenX:i,screenY:r}=t,{screenX:a,screenY:o}=s,c=l(this,ui),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,g=d-u,m=f-h,w=a-i,_=o-r,v=Math.hypot(w,_)||1,x=Math.hypot(g,m)||1;if(!l(this,va)&&Math.abs(x-v)<=v0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=r,c.touch1X=a,c.touch1Y=o,e.preventDefault(),!l(this,va)){y(this,va,!0);return}const S=[(i+a)/2,(r+o)/2];(E=l(this,ah))==null||E.call(this,S,x,v)},cy=function(e){var t;l(this,lr).abort(),y(this,lr,null),(t=l(this,oh))==null||t.call(this),l(this,ui)&&(e.preventDefault(),y(this,ui,null),y(this,va,!1))};let up=v0;var xa,os,Te,vl,cr,lh,Sa,gt,ba,hi,ur,ch,Aa,pn,uh,_a,di,Os,wl,xl,Fn,Ea,hh,Sp,q,uy,dh,hy,uf,wb,xb,dy,hf,fy,Sb,bb,Ab,py,_b,gy,Eb,Cb,kb,my,qc;const te=class te{constructor(e){b(this,q);b(this,xa,null);b(this,os,null);b(this,Te,null);b(this,vl,!1);b(this,cr,null);b(this,lh,"");b(this,Sa,!1);b(this,gt,null);b(this,ba,null);b(this,hi,null);b(this,ur,null);b(this,ch,"");b(this,Aa,!1);b(this,pn,null);b(this,uh,!1);b(this,_a,!1);b(this,di,!1);b(this,Os,null);b(this,wl,0);b(this,xl,0);b(this,Fn,null);b(this,Ea,null);X(this,"_editToolbar",null);X(this,"_initialOptions",Object.create(null));X(this,"_initialData",null);X(this,"_isVisible",!0);X(this,"_uiManager",null);X(this,"_focusEventsAllowed",!0);b(this,hh,!1);b(this,Sp,te._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:i,pageX:r,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,i],this.pageTranslation=[r,a];const[o,c]=this.parentDimensions;this.x=e.x/o,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=te.prototype._resizeWithKeyboard,t=So.TRANSLATE_SMALL,s=So.TRANSLATE_BIG;return ie(this,"_resizerKeyboardManager",new vd([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],te.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ie(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new $T({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(te._l10n??(te._l10n=e),te._l10nResizer||(te._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),te._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);te._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){_e("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return l(this,hh)}set _isDraggable(e){var t;y(this,hh,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=l(this,Sp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):A(this,q,qc).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(l(this,Aa)?y(this,Aa,!1):this.parent.setSelected(this))}focusout(e){var s;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(s=this.parent)!=null&&s.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,s,i){const[r,a]=this.parentDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/r,this.y=(t+i)/a,this.fixAndSetPosition()}translate(e,t){A(this,q,uy).call(this,this.parentDimensions,e,t)}translateInPage(e,t){l(this,pn)||y(this,pn,[this.x,this.y,this.width,this.height]),A(this,q,uy).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){l(this,pn)||y(this,pn,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[i,r]}=this;if(this.x+=e/i,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[c,u]=this.getBaseTranslation();a+=c,o+=u;const{style:h}=s;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),s.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!l(this,pn)&&(l(this,pn)[0]!==this.x||l(this,pn)[1]!==this.y)}get _hasBeenResized(){return!!l(this,pn)&&(l(this,pn)[2]!==this.width||l(this,pn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:s}=te,i=s/e,r=s/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[s,i]}=this;let{x:r,y:a,width:o,height:c}=this;if(o*=s,c*=i,r*=s,a*=i,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(s-o,r)),a=Math.max(0,Math.min(i-c,a));break;case 90:r=Math.max(0,Math.min(s-c,r)),a=Math.min(i,Math.max(o,a));break;case 180:r=Math.min(s,Math.max(o,r)),a=Math.min(i,Math.max(c,a));break;case 270:r=Math.min(s,Math.max(c,r)),a=Math.max(0,Math.min(i-o,a));break}this.x=r/=s,this.y=a/=i;const[u,h]=this.getBaseTranslation();r+=u,a+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var s;return A(s=te,dh,hy).call(s,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var s;return A(s=te,dh,hy).call(s,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,s]}=this;return[t*e,s*e]}setDims(e,t){const[s,i]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/s).toFixed(2)}%`,l(this,Sa)||(r.height=`${(100*t/i).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:s}=e,i=s.endsWith("%"),r=!l(this,Sa)&&t.endsWith("%");if(i&&r)return;const[a,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(s)/a).toFixed(2)}%`),!l(this,Sa)&&!r&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=l(this,Te))==null||e.finish()}async addEditToolbar(){return this._editToolbar||l(this,_a)?this._editToolbar:(this._editToolbar=new Zm(this),this.div.append(this._editToolbar.render()),l(this,Te)&&await this._editToolbar.addAltText(l(this,Te)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=l(this,Te))==null||e.destroy())}addContainer(e){var s;const t=(s=this._editToolbar)==null?void 0:s.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){l(this,Te)||(cp.initialize(te._l10n),y(this,Te,new cp(this)),l(this,xa)&&(l(this,Te).data=l(this,xa),y(this,xa,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=l(this,Te))==null?void 0:e.data}set altTextData(e){l(this,Te)&&(l(this,Te).data=e)}get guessedAltText(){var e;return(e=l(this,Te))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=l(this,Te))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=l(this,Te))==null?void 0:t.serialize(e)}hasAltText(){return!!l(this,Te)&&!l(this,Te).isEmpty()}hasAltTextData(){var e;return((e=l(this,Te))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=l(this,vl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),A(this,q,gy).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),lp(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(l(this,Ea)||y(this,Ea,new up({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,q,Sb).bind(this),onPinching:A(this,q,bb).bind(this),onPinchEnd:A(this,q,Ab).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Xt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(y(this,Aa,!0),this._isDraggable){A(this,q,_b).call(this,e);return}A(this,q,py).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){l(this,Os)&&clearTimeout(l(this,Os)),y(this,Os,setTimeout(()=>{var e;y(this,Os,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,s){e.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,s=this.rotation){const i=this.parentScale,[r,a]=this.pageDimensions,[o,c]=this.pageTranslation,u=e/i,h=t/i,d=this.x*r,f=this.y*a,g=this.width*r,m=this.height*a;switch(s){case 0:return[d+u+o,a-f-h-m+c,d+u+g+o,a-f-h+c];case 90:return[d+h+o,a-f+u+c,d+h+m+o,a-f+u+g+c];case 180:return[d-u-g+o,a-f+h+c,d-u+o,a-f+h+m+c];case 270:return[d-h-m+o,a-f-u-g+c,d-h+o,a-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,r,a]=e,o=r-s,c=a-i;switch(this.rotation){case 0:return[s,t-a,o,c];case 90:return[s,t-i,c,o];case 180:return[r,t-i,o,c];case 270:return[r,t-a,c,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){y(this,_a,!0)}disableEditMode(){y(this,_a,!1)}isInEditMode(){return l(this,_a)}shouldGetKeyboardEvents(){return l(this,di)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:s,right:i}=this.getClientDimensions(),{innerHeight:r,innerWidth:a}=window;return t<a&&i>0&&e<r&&s>0}rebuild(){A(this,q,gy).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){_e("An editor must be serializable")}static async deserialize(e,t,s){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});i.rotation=e.rotation,y(i,xa,e.accessibilityData);const[r,a]=i.pageDimensions,[o,c,u,h]=i.getRectInCurrentCoords(e.rect,a);return i.x=o/r,i.y=c/a,i.width=u/r,i.height=h/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=l(this,ur))==null||e.abort(),y(this,ur,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),l(this,Os)&&(clearTimeout(l(this,Os)),y(this,Os,null)),A(this,q,qc).call(this),this.removeEditToolbar(),l(this,Fn)){for(const s of l(this,Fn).values())clearTimeout(s);y(this,Fn,null)}this.parent=null,(t=l(this,Ea))==null||t.destroy(),y(this,Ea,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,q,wb).call(this),l(this,gt).classList.remove("hidden"),lp(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),y(this,hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=l(this,gt).children;if(!l(this,os)){y(this,os,Array.from(t));const a=A(this,q,Eb).bind(this),o=A(this,q,Cb).bind(this),c=this._uiManager._signal;for(const u of l(this,os)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:c}),u.addEventListener("blur",o,{signal:c}),u.addEventListener("focus",A(this,q,kb).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",te._l10nResizer[h])}}const s=l(this,os)[0];let i=0;for(const a of t){if(a===s)break;i++}const r=(360-this.rotation+this.parentRotation)%360/90*(l(this,os).length/4);if(r!==i){if(r<i)for(let o=0;o<i-r;o++)l(this,gt).append(l(this,gt).firstChild);else if(r>i)for(let o=0;o<r-i;o++)l(this,gt).firstChild.before(l(this,gt).lastChild);let a=0;for(const o of t){const u=l(this,os)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",te._l10nResizer[u])}}A(this,q,my).call(this,0),y(this,di,!0),l(this,gt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){l(this,di)&&A(this,q,fy).call(this,l(this,ch),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,q,qc).call(this),this.div.focus()}select(){var e,t,s;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var i,r;(i=this.div)!=null&&i.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(s=l(this,Te))==null||s.toggleAltTextBadge(!1)}unselect(){var e,t,s,i,r;(e=l(this,gt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(i=this._editToolbar)==null||i.hide(),(r=l(this,Te))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return l(this,uh)}set isEditing(e){y(this,uh,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){y(this,Sa,!0);const s=e/t,{style:i}=this.div;i.aspectRatio=s,i.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){l(this,Fn)||y(this,Fn,new Map);const{action:s}=e;let i=l(this,Fn).get(s);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),l(this,Fn).delete(s),l(this,Fn).size===0&&y(this,Fn,null)},te._telemetryTimeout),l(this,Fn).set(s,i);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),y(this,vl,!1)}disable(){this.div&&(this.div.tabIndex=-1),y(this,vl,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const s=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),s.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};xa=new WeakMap,os=new WeakMap,Te=new WeakMap,vl=new WeakMap,cr=new WeakMap,lh=new WeakMap,Sa=new WeakMap,gt=new WeakMap,ba=new WeakMap,hi=new WeakMap,ur=new WeakMap,ch=new WeakMap,Aa=new WeakMap,pn=new WeakMap,uh=new WeakMap,_a=new WeakMap,di=new WeakMap,Os=new WeakMap,wl=new WeakMap,xl=new WeakMap,Fn=new WeakMap,Ea=new WeakMap,hh=new WeakMap,Sp=new WeakMap,q=new WeakSet,uy=function([e,t],s,i){[s,i]=this.screenToPageTranslation(s,i),this.x+=s/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},dh=new WeakSet,hy=function(e,t,s){switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},uf=function(e){switch(e){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}},wb=function(){if(l(this,gt))return;y(this,gt,document.createElement("div")),l(this,gt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const s of e){const i=document.createElement("div");l(this,gt).append(i),i.classList.add("resizer",s),i.setAttribute("data-resizer-name",s),i.addEventListener("pointerdown",A(this,q,xb).bind(this,s),{signal:t}),i.addEventListener("contextmenu",bs,{signal:t}),i.tabIndex=-1}this.div.prepend(l(this,gt))},xb=function(e,t){var h;t.preventDefault();const{isMac:s}=Xt.platform;if(t.button!==0||t.ctrlKey&&s)return;(h=l(this,Te))==null||h.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,y(this,ba,[t.screenX,t.screenY]);const r=new AbortController,a=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,q,fy).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",kn,{passive:!1,signal:a}),window.addEventListener("contextmenu",bs,{signal:a}),y(this,hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var d;r.abort(),this.parent.togglePointerEvents(!0),(d=l(this,Te))==null||d.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=o,this.div.style.cursor=c,A(this,q,hf).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},dy=function(e,t,s,i){this.width=s,this.height=i,this.x=e,this.y=t;const[r,a]=this.parentDimensions;this.setDims(r*s,a*i),this.fixAndSetPosition(),this._onResized()},hf=function(){if(!l(this,hi))return;const{savedX:e,savedY:t,savedWidth:s,savedHeight:i}=l(this,hi);y(this,hi,null);const r=this.x,a=this.y,o=this.width,c=this.height;r===e&&a===t&&o===s&&c===i||this.addCommands({cmd:A(this,q,dy).bind(this,r,a,o,c),undo:A(this,q,dy).bind(this,e,t,s,i),mustExec:!0})},fy=function(e,t){const[s,i]=this.parentDimensions,r=this.x,a=this.y,o=this.width,c=this.height,u=te.MIN_SIZE/s,h=te.MIN_SIZE/i,d=A(this,q,uf).call(this,this.rotation),f=(z,I)=>[d[0]*z+d[2]*I,d[1]*z+d[3]*I],g=A(this,q,uf).call(this,360-this.rotation),m=(z,I)=>[g[0]*z+g[2]*I,g[1]*z+g[3]*I];let w,_,v=!1,x=!1;switch(e){case"topLeft":v=!0,w=(z,I)=>[0,0],_=(z,I)=>[z,I];break;case"topMiddle":w=(z,I)=>[z/2,0],_=(z,I)=>[z/2,I];break;case"topRight":v=!0,w=(z,I)=>[z,0],_=(z,I)=>[0,I];break;case"middleRight":x=!0,w=(z,I)=>[z,I/2],_=(z,I)=>[0,I/2];break;case"bottomRight":v=!0,w=(z,I)=>[z,I],_=(z,I)=>[0,0];break;case"bottomMiddle":w=(z,I)=>[z/2,I],_=(z,I)=>[z/2,0];break;case"bottomLeft":v=!0,w=(z,I)=>[0,I],_=(z,I)=>[z,0];break;case"middleLeft":x=!0,w=(z,I)=>[0,I/2],_=(z,I)=>[z,I/2];break}const S=w(o,c),E=_(o,c);let C=f(...E);const k=te._round(r+C[0]),P=te._round(a+C[1]);let N=1,R=1,D,B;if(t.fromKeyboard)({deltaX:D,deltaY:B}=t);else{const{screenX:z,screenY:I}=t,[M,O]=l(this,ba);[D,B]=this.screenToPageTranslation(z-M,I-O),l(this,ba)[0]=z,l(this,ba)[1]=I}if([D,B]=m(D/s,B/i),v){const z=Math.hypot(o,c);N=R=Math.max(Math.min(Math.hypot(E[0]-S[0]-D,E[1]-S[1]-B)/z,1/o,1/c),u/o,h/c)}else x?N=Math.max(u,Math.min(1,Math.abs(E[0]-S[0]-D)))/o:R=Math.max(h,Math.min(1,Math.abs(E[1]-S[1]-B)))/c;const ae=te._round(o*N),ge=te._round(c*R);C=f(..._(ae,ge));const oe=k-C[0],Xe=P-C[1];l(this,pn)||y(this,pn,[this.x,this.y,this.width,this.height]),this.width=ae,this.height=ge,this.x=oe,this.y=Xe,this.setDims(s*ae,i*ge),this.fixAndSetPosition(),this._onResizing()},Sb=function(){var e;y(this,hi,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=l(this,Te))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},bb=function(e,t,s){let r=.7*(s/t)+1-.7;if(r===1)return;const a=A(this,q,uf).call(this,this.rotation),o=(k,P)=>[a[0]*k+a[2]*P,a[1]*k+a[3]*P],[c,u]=this.parentDimensions,h=this.x,d=this.y,f=this.width,g=this.height,m=te.MIN_SIZE/c,w=te.MIN_SIZE/u;r=Math.max(Math.min(r,1/f,1/g),m/f,w/g);const _=te._round(f*r),v=te._round(g*r);if(_===f&&v===g)return;l(this,pn)||y(this,pn,[h,d,f,g]);const x=o(f/2,g/2),S=te._round(h+x[0]),E=te._round(d+x[1]),C=o(_/2,v/2);this.x=S-C[0],this.y=E-C[1],this.width=_,this.height=v,this.setDims(c*_,u*v),this.fixAndSetPosition(),this._onResizing()},Ab=function(){var e;(e=l(this,Te))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),A(this,q,hf).call(this)},py=function(e){const{isMac:t}=Xt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},_b=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let s=!1;const i=new AbortController,r=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:r},o=u=>{i.abort(),y(this,cr,null),y(this,Aa,!1),this._uiManager.endDragSession()||A(this,q,py).call(this,u),s&&this._onStopDragging()};t&&(y(this,wl,e.clientX),y(this,xl,e.clientY),y(this,cr,e.pointerId),y(this,lh,e.pointerType),window.addEventListener("pointermove",u=>{s||(s=!0,this._onStartDragging());const{clientX:h,clientY:d,pointerId:f}=u;if(f!==l(this,cr)){kn(u);return}const[g,m]=this.screenToPageTranslation(h-l(this,wl),d-l(this,xl));y(this,wl,h),y(this,xl,d),this._uiManager.dragSelectedEditors(g,m)},a),window.addEventListener("touchmove",kn,a),window.addEventListener("pointerdown",u=>{u.pointerType===l(this,lh)&&(l(this,Ea)||u.isPrimary)&&o(u),kn(u)},a));const c=u=>{if(!l(this,cr)||l(this,cr)===u.pointerId){o(u);return}kn(u)};window.addEventListener("pointerup",c,{signal:r}),window.addEventListener("blur",c,{signal:r})},gy=function(){if(l(this,ur)||!this.div)return;y(this,ur,new AbortController);const e=this._uiManager.combinedSignal(l(this,ur));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},Eb=function(e){te._resizerKeyboardManager.exec(this,e)},Cb=function(e){var t;l(this,di)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==l(this,gt)&&A(this,q,qc).call(this)},kb=function(e){y(this,ch,l(this,di)?e:"")},my=function(e){if(l(this,os))for(const t of l(this,os))t.tabIndex=e},qc=function(){y(this,di,!1),A(this,q,my).call(this,-1),A(this,q,hf).call(this)},b(te,dh),X(te,"_l10n",null),X(te,"_l10nResizer",null),X(te,"_borderLineWidth",-1),X(te,"_colorManager",new ny),X(te,"_zIndex",1),X(te,"_telemetryTimeout",1e3);let Fe=te;class $T extends Fe{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Xw=3285377520,In=4294901760,ks=65535;class Tb{constructor(e){this.h1=e?e&4294967295:Xw,this.h2=e?e&4294967295:Xw}update(e){let t,s;if(typeof e=="string"){t=new Uint8Array(e.length*2),s=0;for(let w=0,_=e.length;w<_;w++){const v=e.charCodeAt(w);v<=255?t[s++]=v:(t[s++]=v>>>8,t[s++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),s=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=s>>2,r=s-i*4,a=new Uint32Array(t.buffer,0,i);let o=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,g=d&ks,m=f&ks;for(let w=0;w<i;w++)w&1?(o=a[w],o=o*d&In|o*g&ks,o=o<<15|o>>>17,o=o*f&In|o*m&ks,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(c=a[w],c=c*d&In|c*g&ks,c=c<<15|c>>>17,c=c*f&In|c*m&ks,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,r){case 3:o^=t[i*4+2]<<16;case 2:o^=t[i*4+1]<<8;case 1:o^=t[i*4],o=o*d&In|o*g&ks,o=o<<15|o>>>17,o=o*f&In|o*m&ks,i&1?u^=o:h^=o}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&In|e*36045&ks,t=t*4283543511&In|((t<<16|e>>>16)*2950163797&In)>>>16,e^=t>>>1,e=e*444984403&In|e*60499&ks,t=t*3301882366&In|((t<<16|e>>>16)*3120437893&In)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const yy=Object.freeze({map:null,hash:"",transfer:void 0});var Ca,ka,ot,bp,Pb;class f0{constructor(){b(this,bp);b(this,Ca,!1);b(this,ka,null);b(this,ot,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=l(this,ot).get(e);return s===void 0?t:Object.assign(t,s)}getRawValue(e){return l(this,ot).get(e)}remove(e){if(l(this,ot).delete(e),l(this,ot).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of l(this,ot).values())if(t instanceof Fe)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=l(this,ot).get(e);let i=!1;if(s!==void 0)for(const[r,a]of Object.entries(t))s[r]!==a&&(i=!0,s[r]=a);else i=!0,l(this,ot).set(e,t);i&&A(this,bp,Pb).call(this),t instanceof Fe&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return l(this,ot).has(e)}getAll(){return l(this,ot).size>0?o0(l(this,ot)):null}setAll(e){for(const[t,s]of Object.entries(e))this.setValue(t,s)}get size(){return l(this,ot).size}resetModified(){l(this,Ca)&&(y(this,Ca,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Nb(this)}get serializable(){if(l(this,ot).size===0)return yy;const e=new Map,t=new Tb,s=[],i=Object.create(null);let r=!1;for(const[a,o]of l(this,ot)){const c=o instanceof Fe?o.serialize(!1,i):o;c&&(e.set(a,c),t.update(`${a}:${JSON.stringify(c)}`),r||(r=!!c.bitmap))}if(r)for(const a of e.values())a.bitmap&&s.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:s}:yy}get editorStats(){let e=null;const t=new Map;for(const s of l(this,ot).values()){if(!(s instanceof Fe))continue;const i=s.telemetryFinalData;if(!i)continue;const{type:r}=i;t.has(r)||t.set(r,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const a=e[r]||(e[r]=new Map);for(const[o,c]of Object.entries(i)){if(o==="type")continue;let u=a.get(o);u||(u=new Map,a.set(o,u));const h=u.get(c)??0;u.set(c,h+1)}}for(const[s,i]of t)e[s]=i.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){y(this,ka,null)}get modifiedIds(){if(l(this,ka))return l(this,ka);const e=[];for(const t of l(this,ot).values())!(t instanceof Fe)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return y(this,ka,{ids:new Set(e),hash:e.join(",")})}}Ca=new WeakMap,ka=new WeakMap,ot=new WeakMap,bp=new WeakSet,Pb=function(){l(this,Ca)||(y(this,Ca,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var fh;class Nb extends f0{constructor(t){super();b(this,fh);const{map:s,hash:i,transfer:r}=t.serializable,a=structuredClone(s,r?{transfer:r}:null);y(this,fh,{map:a,hash:i,transfer:r})}get print(){_e("Should not call PrintAnnotationStorage.print")}get serializable(){return l(this,fh)}get modifiedIds(){return ie(this,"modifiedIds",{ids:new Set,hash:""})}}fh=new WeakMap;var Sl;class WT{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){b(this,Sl,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),l(this,Sl).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||l(this,Sl).has(e.loadedName))){if(Ke(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:r}=e,a=new FontFace(s,i,r);this.addNativeFontFace(a);try{await a.load(),l(this,Sl).add(s),t==null||t(e)}catch{ee(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}_e("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(i){throw ee(`Failed to load font '${s.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return ie(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Dt||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),ie(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Ke(!i.done,"completeRequest() cannot be called twice."),i.done=!0;s.length>0&&s[0].done;){const r=s.shift();setTimeout(r.callback,0)}}const{loadingRequests:s}=this,i={done:!1,complete:t,callback:e};return s.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ie(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function s(E,C){return E.charCodeAt(C)<<24|E.charCodeAt(C+1)<<16|E.charCodeAt(C+2)<<8|E.charCodeAt(C+3)&255}function i(E,C,k,P){const N=E.substring(0,C),R=E.substring(C+k);return N+P+R}let r,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const c=o.getContext("2d");let u=0;function h(E,C){if(++u>30){ee("Load test font never loaded."),C();return}if(c.font="30px "+E,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){C();return}setTimeout(h.bind(null,E,C))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=i(f,976,d.length,d);const m=16,w=1482184792;let _=s(f,m);for(r=0,a=d.length-3;r<a;r+=4)_=_-w+s(d,r)|0;r<d.length&&(_=_-w+s(d+"XXX",r)|0),f=i(f,m,4,PT(_));const v=`url(data:font/opentype;base64,${btoa(f)});`,x=`@font-face {font-family:"${d}";src:${v}}`;this.insertRule(x);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const E of[e.loadedName,d]){const C=this._document.createElement("span");C.textContent="Hi",C.style.fontFamily=E,S.append(C)}this._document.body.append(S),h(d,()=>{S.remove(),t.complete()})}}Sl=new WeakMap;class VT{constructor(e,{disableFontFace:t=!1,fontExtraProperties:s=!1,inspectFont:i=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=s===!0,this._inspectFont=i}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var s;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${DT(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${e}}`}return(s=this._inspectFont)==null||s.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const s=this.loadedName+"_path_"+t;let i;try{i=e.get(s)}catch(a){ee(`getPathGenerator - ignoring character: "${a}".`)}const r=new Path2D(i||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[t]=r}}const Od={DATA:1,ERROR:2},qe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function qw(){}function en(n){if(n instanceof Wr||n instanceof Km||n instanceof Fu||n instanceof Ww||n instanceof op||n instanceof zg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||_e('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Wr(n.message);case"InvalidPDFException":return new Km(n.message);case"MissingPDFException":return new Fu(n.message);case"PasswordException":return new Ww(n.message,n.code);case"UnexpectedResponseException":return new op(n.message,n.status);case"UnknownErrorException":return new zg(n.message,n.details)}return new zg(n.message,n.toString())}var bl,qn,Rb,Mb,Lb,df;class Yc{constructor(e,t,s){b(this,qn);b(this,bl,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",A(this,qn,Rb).bind(this),{signal:l(this,bl).signal})}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const i=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[i]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},s)}catch(a){r.reject(a)}return r.promise}sendWithStream(e,t,s,i){const r=this.streamId++,a=this.sourceName,o=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:o,action:e,streamId:r,data:t,desiredSize:u.desiredSize},i),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,c.postMessage({sourceName:a,targetName:o,stream:qe.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Ke(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:a,targetName:o,stream:qe.CANCEL,streamId:r,reason:en(u)}),h.promise}},s)}destroy(){var e;(e=l(this,bl))==null||e.abort(),y(this,bl,null)}}bl=new WeakMap,qn=new WeakSet,Rb=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){A(this,qn,Lb).call(this,e);return}if(e.callback){const s=e.callbackId,i=this.callbackCapabilities[s];if(!i)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],e.callback===Od.DATA)i.resolve(e.data);else if(e.callback===Od.ERROR)i.reject(en(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const s=this.sourceName,i=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(a){r.postMessage({sourceName:s,targetName:i,callback:Od.DATA,callbackId:e.callbackId,data:a})},function(a){r.postMessage({sourceName:s,targetName:i,callback:Od.ERROR,callbackId:e.callbackId,reason:en(a)})});return}if(e.streamId){A(this,qn,Mb).call(this,e);return}t(e.data)},Mb=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this,o=this.actionHandler[e.action],c={enqueue(u,h=1,d){if(this.isCancelled)return;const f=this.desiredSize;this.desiredSize-=h,f>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:i,stream:qe.ENQUEUE,streamId:t,chunk:u},d)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:qe.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Ke(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:i,stream:qe.ERROR,streamId:t,reason:en(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[t]=c,Promise.try(o,e.data,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:qe.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:qe.START_COMPLETE,streamId:t,reason:en(u)})})},Lb=function(e){const t=e.streamId,s=this.sourceName,i=e.sourceName,r=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case qe.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(en(e.reason));break;case qe.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(en(e.reason));break;case qe.PULL:if(!o){r.postMessage({sourceName:s,targetName:i,stream:qe.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||qw).then(function(){r.postMessage({sourceName:s,targetName:i,stream:qe.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:qe.PULL_COMPLETE,streamId:t,reason:en(u)})});break;case qe.ENQUEUE:if(Ke(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case qe.CLOSE:if(Ke(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),A(this,qn,df).call(this,a,t);break;case qe.ERROR:Ke(a,"error should have stream controller"),a.controller.error(en(e.reason)),A(this,qn,df).call(this,a,t);break;case qe.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(en(e.reason)),A(this,qn,df).call(this,a,t);break;case qe.CANCEL:if(!o)break;const c=en(e.reason);Promise.try(o.onCancel||qw,c).then(function(){r.postMessage({sourceName:s,targetName:i,stream:qe.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:s,targetName:i,stream:qe.CANCEL_COMPLETE,streamId:t,reason:en(u)})}),o.sinkCapability.reject(c),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},df=async function(e,t){var s,i,r;await Promise.allSettled([(s=e.startCall)==null?void 0:s.promise,(i=e.pullCall)==null?void 0:i.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var ph;class Ib{constructor({enableHWA:e=!1}){b(this,ph,!1);y(this,ph,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!l(this,ph)})}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){_e("Abstract method `_createCanvas` called.")}}ph=new WeakMap;class GT extends Ib{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}class Db{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class jb extends Db{async _fetch(e){const t=await ig(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):sg(t)}}class Fb{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,s,i,r){return"none"}destroy(e=!1){}}var Ta,Al,fi,pi,Nt,Pa,Na,U,kt,Kc,Mo,ff,Lo,Ob,vy,Io,Qc,Jc,wy,Zc;class XT extends Fb{constructor({docId:t,ownerDocument:s=globalThis.document}){super();b(this,U);b(this,Ta);b(this,Al);b(this,fi);b(this,pi);b(this,Nt);b(this,Pa);b(this,Na,0);y(this,pi,t),y(this,Nt,s)}addFilter(t){if(!t)return"none";let s=l(this,U,kt).get(t);if(s)return s;const[i,r,a]=A(this,U,ff).call(this,t),o=t.length===1?i:`${i}${r}${a}`;if(s=l(this,U,kt).get(o),s)return l(this,U,kt).set(t,s),s;const c=`g_${l(this,pi)}_transfer_map_${zt(this,Na)._++}`,u=A(this,U,Lo).call(this,c);l(this,U,kt).set(t,u),l(this,U,kt).set(o,u);const h=A(this,U,Io).call(this,c);return A(this,U,Jc).call(this,i,r,a,h),u}addHCMFilter(t,s){var m;const i=`${t}-${s}`,r="base";let a=l(this,U,Kc).get(r);if((a==null?void 0:a.key)===i||(a?((m=a.filter)==null||m.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},l(this,U,Kc).set(r,a)),!t||!s))return a.url;const o=A(this,U,Zc).call(this,t);t=G.makeHexColor(...o);const c=A(this,U,Zc).call(this,s);if(s=G.makeHexColor(...c),l(this,U,Mo).style.color="",t==="#000000"&&s==="#ffffff"||t===s)return a.url;const u=new Array(256);for(let w=0;w<=255;w++){const _=w/255;u[w]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=u.join(","),d=`g_${l(this,pi)}_hcm_filter`,f=a.filter=A(this,U,Io).call(this,d);A(this,U,Jc).call(this,h,h,h,f),A(this,U,vy).call(this,f);const g=(w,_)=>{const v=o[w]/255,x=c[w]/255,S=new Array(_+1);for(let E=0;E<=_;E++)S[E]=v+E/_*(x-v);return S.join(",")};return A(this,U,Jc).call(this,g(0,5),g(1,5),g(2,5),f),a.url=A(this,U,Lo).call(this,d),a.url}addAlphaFilter(t){let s=l(this,U,kt).get(t);if(s)return s;const[i]=A(this,U,ff).call(this,[t]),r=`alpha_${i}`;if(s=l(this,U,kt).get(r),s)return l(this,U,kt).set(t,s),s;const a=`g_${l(this,pi)}_alpha_map_${zt(this,Na)._++}`,o=A(this,U,Lo).call(this,a);l(this,U,kt).set(t,o),l(this,U,kt).set(r,o);const c=A(this,U,Io).call(this,a);return A(this,U,wy).call(this,i,c),o}addLuminosityFilter(t){let s=l(this,U,kt).get(t||"luminosity");if(s)return s;let i,r;if(t?([i]=A(this,U,ff).call(this,[t]),r=`luminosity_${i}`):r="luminosity",s=l(this,U,kt).get(r),s)return l(this,U,kt).set(t,s),s;const a=`g_${l(this,pi)}_luminosity_map_${zt(this,Na)._++}`,o=A(this,U,Lo).call(this,a);l(this,U,kt).set(t,o),l(this,U,kt).set(r,o);const c=A(this,U,Io).call(this,a);return A(this,U,Ob).call(this,c),t&&A(this,U,wy).call(this,i,c),o}addHighlightHCMFilter(t,s,i,r,a){var x;const o=`${s}-${i}-${r}-${a}`;let c=l(this,U,Kc).get(t);if((c==null?void 0:c.key)===o||(c?((x=c.filter)==null||x.remove(),c.key=o,c.url="none",c.filter=null):(c={key:o,url:"none",filter:null},l(this,U,Kc).set(t,c)),!s||!i))return c.url;const[u,h]=[s,i].map(A(this,U,Zc).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,m]=[r,a].map(A(this,U,Zc).bind(this));f<d&&([d,f,g,m]=[f,d,m,g]),l(this,U,Mo).style.color="";const w=(S,E,C)=>{const k=new Array(256),P=(f-d)/C,N=S/255,R=(E-S)/(255*C);let D=0;for(let B=0;B<=C;B++){const ae=Math.round(d+B*P),ge=N+B*R;for(let oe=D;oe<=ae;oe++)k[oe]=ge;D=ae+1}for(let B=D;B<256;B++)k[B]=k[D-1];return k.join(",")},_=`g_${l(this,pi)}_hcm_${t}_filter`,v=c.filter=A(this,U,Io).call(this,_);return A(this,U,vy).call(this,v),A(this,U,Jc).call(this,w(g[0],m[0],5),w(g[1],m[1],5),w(g[2],m[2],5),v),c.url=A(this,U,Lo).call(this,_),c.url}destroy(t=!1){var s,i,r,a;t&&((s=l(this,Pa))!=null&&s.size)||((i=l(this,fi))==null||i.parentNode.parentNode.remove(),y(this,fi,null),(r=l(this,Al))==null||r.clear(),y(this,Al,null),(a=l(this,Pa))==null||a.clear(),y(this,Pa,null),y(this,Na,0))}}Ta=new WeakMap,Al=new WeakMap,fi=new WeakMap,pi=new WeakMap,Nt=new WeakMap,Pa=new WeakMap,Na=new WeakMap,U=new WeakSet,kt=function(){return l(this,Al)||y(this,Al,new Map)},Kc=function(){return l(this,Pa)||y(this,Pa,new Map)},Mo=function(){if(!l(this,fi)){const t=l(this,Nt).createElement("div"),{style:s}=t;s.visibility="hidden",s.contain="strict",s.width=s.height=0,s.position="absolute",s.top=s.left=0,s.zIndex=-1;const i=l(this,Nt).createElementNS(Zs,"svg");i.setAttribute("width",0),i.setAttribute("height",0),y(this,fi,l(this,Nt).createElementNS(Zs,"defs")),t.append(i),i.append(l(this,fi)),l(this,Nt).body.append(t)}return l(this,fi)},ff=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let f=0;f<256;f++)h[f]=u[f]/255;const d=h.join(",");return[d,d,d]}const[s,i,r]=t,a=new Array(256),o=new Array(256),c=new Array(256);for(let u=0;u<256;u++)a[u]=s[u]/255,o[u]=i[u]/255,c[u]=r[u]/255;return[a.join(","),o.join(","),c.join(",")]},Lo=function(t){if(l(this,Ta)===void 0){y(this,Ta,"");const s=l(this,Nt).URL;s!==l(this,Nt).baseURI&&(rg(s)?ee('#createUrl: ignore "data:"-URL for performance reasons.'):y(this,Ta,s.split("#",1)[0]))}return`url(${l(this,Ta)}#${t})`},Ob=function(t){const s=l(this,Nt).createElementNS(Zs,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(s)},vy=function(t){const s=l(this,Nt).createElementNS(Zs,"feColorMatrix");s.setAttribute("type","matrix"),s.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(s)},Io=function(t){const s=l(this,Nt).createElementNS(Zs,"filter");return s.setAttribute("color-interpolation-filters","sRGB"),s.setAttribute("id",t),l(this,U,Mo).append(s),s},Qc=function(t,s,i){const r=l(this,Nt).createElementNS(Zs,s);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)},Jc=function(t,s,i,r){const a=l(this,Nt).createElementNS(Zs,"feComponentTransfer");r.append(a),A(this,U,Qc).call(this,a,"feFuncR",t),A(this,U,Qc).call(this,a,"feFuncG",s),A(this,U,Qc).call(this,a,"feFuncB",i)},wy=function(t,s){const i=l(this,Nt).createElementNS(Zs,"feComponentTransfer");s.append(i),A(this,U,Qc).call(this,i,"feFuncA",t)},Zc=function(t){return l(this,U,Mo).style.color=t,d0(getComputedStyle(l(this,U,Mo)).getPropertyValue("color"))};class zb{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(s=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){_e("Abstract method `_fetch` called.")}}class Bb extends zb{async _fetch(e){const t=await ig(e,"arraybuffer");return new Uint8Array(t)}}Dt&&ee("Please use the `legacy` build in Node.js environments.");async function Ub(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class qT extends Fb{}class YT extends Ib{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class KT extends Db{async _fetch(e){return Ub(e)}}class QT extends zb{async _fetch(e){return Ub(e)}}const Lt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function xy(n,e){if(!e)return;const t=e[2]-e[0],s=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,s),n.clip(i)}class p0{getPattern(){_e("Abstract method `getPattern` called.")}}class JT extends p0{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)t.addColorStop(s[0],s[1]);return t}getPattern(e,t,s,i){let r;if(i===Lt.STROKE||i===Lt.FILL){const a=t.current.getClippedPathBoundingBox(i,Re(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,c=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),s=G.transform(s,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),xy(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(s);r.setTransform(d)}else xy(e,this._bbox),r=this._createGradient(e);return r}}function Hg(n,e,t,s,i,r,a,o){const c=e.coords,u=e.colors,h=n.data,d=n.width*4;let f;c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f),c[s+1]>c[i+1]&&(f=s,s=i,i=f,f=a,a=o,o=f),c[t+1]>c[s+1]&&(f=t,t=s,s=f,f=r,r=a,a=f);const g=(c[t]+e.offsetX)*e.scaleX,m=(c[t+1]+e.offsetY)*e.scaleY,w=(c[s]+e.offsetX)*e.scaleX,_=(c[s+1]+e.offsetY)*e.scaleY,v=(c[i]+e.offsetX)*e.scaleX,x=(c[i+1]+e.offsetY)*e.scaleY;if(m>=x)return;const S=u[r],E=u[r+1],C=u[r+2],k=u[a],P=u[a+1],N=u[a+2],R=u[o],D=u[o+1],B=u[o+2],ae=Math.round(m),ge=Math.round(x);let oe,Xe,z,I,M,O,j,Y;for(let J=ae;J<=ge;J++){if(J<_){const ne=J<m?0:(m-J)/(m-_);oe=g-(g-w)*ne,Xe=S-(S-k)*ne,z=E-(E-P)*ne,I=C-(C-N)*ne}else{let ne;J>x?ne=1:_===x?ne=0:ne=(_-J)/(_-x),oe=w-(w-v)*ne,Xe=k-(k-R)*ne,z=P-(P-D)*ne,I=N-(N-B)*ne}let Se;J<m?Se=0:J>x?Se=1:Se=(m-J)/(m-x),M=g-(g-v)*Se,O=S-(S-R)*Se,j=E-(E-D)*Se,Y=C-(C-B)*Se;const ft=Math.round(Math.min(oe,M)),Jt=Math.round(Math.max(oe,M));let ue=d*J+ft*4;for(let ne=ft;ne<=Jt;ne++)Se=(oe-ne)/(oe-M),Se<0?Se=0:Se>1&&(Se=1),h[ue++]=Xe-(Xe-O)*Se|0,h[ue++]=z-(z-j)*Se|0,h[ue++]=I-(I-Y)*Se|0,h[ue++]=255}}function ZT(n,e,t){const s=e.coords,i=e.colors;let r,a;switch(e.type){case"lattice":const o=e.verticesPerRow,c=Math.floor(s.length/o)-1,u=o-1;for(r=0;r<c;r++){let h=r*o;for(let d=0;d<u;d++,h++)Hg(n,t,s[h],s[h+1],s[h+o],i[h],i[h+1],i[h+o]),Hg(n,t,s[h+o+1],s[h+1],s[h+o],i[h+o+1],i[h+1],i[h+o])}break;case"triangles":for(r=0,a=s.length;r<a;r+=3)Hg(n,t,s[r],s[r+1],s[r+2],i[r],i[r+1],i[r+2]);break;default:throw new Error("illegal figure")}}class eP extends p0{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const o=Math.floor(this._bounds[0]),c=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-c,d=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),f=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),g=u/d,m=h/f,w={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-c,scaleX:1/g,scaleY:1/m},_=d+2*2,v=f+2*2,x=s.getCanvas("mesh",_,v),S=x.context,E=S.createImageData(d,f);if(t){const k=E.data;for(let P=0,N=k.length;P<N;P+=4)k[P]=t[0],k[P+1]=t[1],k[P+2]=t[2],k[P+3]=255}for(const k of this._figures)ZT(E,k,w);return S.putImageData(E,2,2),{canvas:x.canvas,offsetX:o-2*g,offsetY:c-2*m,scaleX:g,scaleY:m}}getPattern(e,t,s,i){xy(e,this._bbox);let r;if(i===Lt.SHADING)r=G.singularValueDecompose2dScale(Re(e));else if(r=G.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=G.singularValueDecompose2dScale(this.matrix);r=[r[0]*o[0],r[1]*o[1]]}const a=this._createMeshCanvas(r,i===Lt.SHADING?null:this._background,t.cachedCanvases);return i!==Lt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class tP extends p0{getPattern(){return"hotpink"}}function nP(n){switch(n[0]){case"RadialAxial":return new JT(n);case"Mesh":return new eP(n);case"Dummy":return new tP}throw new Error(`Unknown IR type: ${n[0]}`)}const Yw={COLORED:1,UNCOLORED:2},Ap=class Ap{constructor(e,t,s,i,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:s,paintType:i,tilingType:r,color:a,canvasGraphicsFactory:o}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),ng("TilingType: "+r);const h=t[0],d=t[1],f=t[2],g=t[3],m=f-h,w=g-d,_=G.singularValueDecompose2dScale(this.matrix),v=G.singularValueDecompose2dScale(this.baseTransform),x=_[0]*v[0],S=_[1]*v[1];let E=m,C=w,k=!1,P=!1;const N=Math.ceil(c*x),R=Math.ceil(u*S),D=Math.ceil(m*x),B=Math.ceil(w*S);N>=D?E=c:k=!0,R>=B?C=u:P=!0;const ae=this.getSizeAndScale(E,this.ctx.canvas.width,x),ge=this.getSizeAndScale(C,this.ctx.canvas.height,S),oe=e.cachedCanvases.getCanvas("pattern",ae.size,ge.size),Xe=oe.context,z=o.createCanvasGraphics(Xe);if(z.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(z,i,a),Xe.translate(-ae.scale*h,-ge.scale*d),z.transform(ae.scale,0,0,ge.scale,0,0),Xe.save(),this.clipBbox(z,h,d,f,g),z.baseTransform=Re(z.ctx),z.executeOperatorList(s),z.endDrawing(),Xe.restore(),k||P){const I=oe.canvas;k&&(E=c),P&&(C=u);const M=this.getSizeAndScale(E,this.ctx.canvas.width,x),O=this.getSizeAndScale(C,this.ctx.canvas.height,S),j=M.size,Y=O.size,J=e.cachedCanvases.getCanvas("pattern-workaround",j,Y),Se=J.context,ft=k?Math.floor(m/c):0,Jt=P?Math.floor(w/u):0;for(let ue=0;ue<=ft;ue++)for(let ne=0;ne<=Jt;ne++)Se.drawImage(I,j*ue,Y*ne,j,Y,0,0,j,Y);return{canvas:J.canvas,scaleX:M.scale,scaleY:O.scale,offsetX:h,offsetY:d}}return{canvas:oe.canvas,scaleX:ae.scale,scaleY:ge.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,t,s){const i=Math.max(Ap.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*s);return r>=i?r=i:s=r/e,{scale:s,size:r}}clipBbox(e,t,s,i,r){const a=i-t,o=r-s;e.ctx.rect(t,s,a,o),e.current.updateRectMinMax(Re(e.ctx),[t,s,i,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const i=e.ctx,r=e.current;switch(t){case Yw.COLORED:const a=this.ctx;i.fillStyle=a.fillStyle,i.strokeStyle=a.strokeStyle,r.fillColor=a.fillStyle,r.strokeColor=a.strokeStyle;break;case Yw.UNCOLORED:const o=G.makeHexColor(s[0],s[1],s[2]);i.fillStyle=o,i.strokeStyle=o,r.fillColor=o,r.strokeColor=o;break;default:throw new TT(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,i){let r=s;i!==Lt.SHADING&&(r=G.transform(r,t.baseTransform),this.matrix&&(r=G.transform(r,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(r);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(o),c}};X(Ap,"MAX_PATTERN_SIZE",3e3);let Sy=Ap;function sP({src:n,srcPos:e=0,dest:t,width:s,height:i,nonBlackColor:r=4294967295,inverseDecode:a=!1}){const o=Xt.isLittleEndian?4278190080:255,[c,u]=a?[r,o]:[o,r],h=s>>3,d=s&7,f=n.length;t=new Uint32Array(t.buffer);let g=0;for(let m=0;m<i;m++){for(const _=e+h;e<_;e++){const v=e<f?n[e]:255;t[g++]=v&128?u:c,t[g++]=v&64?u:c,t[g++]=v&32?u:c,t[g++]=v&16?u:c,t[g++]=v&8?u:c,t[g++]=v&4?u:c,t[g++]=v&2?u:c,t[g++]=v&1?u:c}if(d===0)continue;const w=e<f?n[e++]:255;for(let _=0;_<d;_++)t[g++]=w&1<<7-_?u:c}return{srcPos:e,destPos:g}}const Kw=16,Qw=100,iP=15,Jw=10,Zw=1e3,an=16;function rP(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(s,i){e.translate(s,i),this.__originalTranslate(s,i)},n.scale=function(s,i){e.scale(s,i),this.__originalScale(s,i)},n.transform=function(s,i,r,a,o,c){e.transform(s,i,r,a,o,c),this.__originalTransform(s,i,r,a,o,c)},n.setTransform=function(s,i,r,a,o,c){e.setTransform(s,i,r,a,o,c),this.__originalSetTransform(s,i,r,a,o,c)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(s){e.rotate(s),this.__originalRotate(s)},n.clip=function(s){e.clip(s),this.__originalClip(s)},n.moveTo=function(t,s){e.moveTo(t,s),this.__originalMoveTo(t,s)},n.lineTo=function(t,s){e.lineTo(t,s),this.__originalLineTo(t,s)},n.bezierCurveTo=function(t,s,i,r,a,o){e.bezierCurveTo(t,s,i,r,a,o),this.__originalBezierCurveTo(t,s,i,r,a,o)},n.rect=function(t,s,i,r){e.rect(t,s,i,r),this.__originalRect(t,s,i,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class aP{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function zd(n,e,t,s,i,r,a,o,c,u){const[h,d,f,g,m,w]=Re(n);if(d===0&&f===0){const x=a*h+m,S=Math.round(x),E=o*g+w,C=Math.round(E),k=(a+c)*h+m,P=Math.abs(Math.round(k)-S)||1,N=(o+u)*g+w,R=Math.abs(Math.round(N)-C)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(g),S,C),n.drawImage(e,t,s,i,r,0,0,P,R),n.setTransform(h,d,f,g,m,w),[P,R]}if(h===0&&g===0){const x=o*f+m,S=Math.round(x),E=a*d+w,C=Math.round(E),k=(o+u)*f+m,P=Math.abs(Math.round(k)-S)||1,N=(a+c)*d+w,R=Math.abs(Math.round(N)-C)||1;return n.setTransform(0,Math.sign(d),Math.sign(f),0,S,C),n.drawImage(e,t,s,i,r,0,0,R,P),n.setTransform(h,d,f,g,m,w),[R,P]}n.drawImage(e,t,s,i,r,a,o,c,u);const _=Math.hypot(h,d),v=Math.hypot(f,g);return[_*c,v*u]}function oP(n){const{width:e,height:t}=n;if(e>Zw||t>Zw)return null;const s=1e3,i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let a=new Uint8Array(r*(t+1)),o,c,u;const h=e+7&-8;let d=new Uint8Array(h*t),f=0;for(const v of n.data){let x=128;for(;x>0;)d[f++]=v&x?0:255,x>>=1}let g=0;for(f=0,d[f]!==0&&(a[0]=1,++g),c=1;c<e;c++)d[f]!==d[f+1]&&(a[c]=d[f]?2:1,++g),f++;for(d[f]!==0&&(a[c]=2,++g),o=1;o<t;o++){f=o*h,u=o*r,d[f-h]!==d[f]&&(a[u]=d[f]?1:8,++g);let v=(d[f]?4:0)+(d[f-h]?8:0);for(c=1;c<e;c++)v=(v>>2)+(d[f+1]?4:0)+(d[f-h+1]?8:0),i[v]&&(a[u+c]=i[v],++g),f++;if(d[f-h]!==d[f]&&(a[u+c]=d[f]?2:4,++g),g>s)return null}for(f=h*(t-1),u=o*r,d[f]!==0&&(a[u]=8,++g),c=1;c<e;c++)d[f]!==d[f+1]&&(a[u+c]=d[f]?4:8,++g),f++;if(d[f]!==0&&(a[u+c]=4,++g),g>s)return null;const m=new Int32Array([0,r,-1,0,-r,0,0,0,1]),w=new Path2D;for(o=0;g&&o<=t;o++){let v=o*r;const x=v+e;for(;v<x&&!a[v];)v++;if(v===x)continue;w.moveTo(v%r,o);const S=v;let E=a[v];do{const C=m[E];do v+=C;while(!a[v]);const k=a[v];k!==5&&k!==10?(E=k,a[v]=0):(E=k&51*E>>4,a[v]&=E>>2|E<<2),w.lineTo(v%r,v/r|0),a[v]||--g}while(S!==v);--o}return d=null,a=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(w),v.beginPath(),v.restore()}}class e1{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=QS,this.textMatrixScale=1,this.fontMatrix=Ym,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=Ct.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=G.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=G.applyTransform(t,e),i=G.applyTransform(t.slice(2),e),r=G.applyTransform([t[0],t[3]],e),a=G.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,s[0],i[0],r[0],a[0]),this.minY=Math.min(this.minY,s[1],i[1],r[1],a[1]),this.maxX=Math.max(this.maxX,s[0],i[0],r[0],a[0]),this.maxY=Math.max(this.maxY,s[1],i[1],r[1],a[1])}updateScalingPathMinMax(e,t){G.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,r,a,o,c,u,h){const d=G.bezierBoundingBox(t,s,i,r,a,o,c,u,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=Lt.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Lt.STROKE){t||_e("Stroke bounding box must include transform.");const i=G.singularValueDecompose2dScale(t),r=i[0]*this.lineWidth/2,a=i[1]*this.lineWidth/2;s[0]-=r,s[1]-=a,s[2]+=r,s[3]+=a}return s}updateClipFromPath(){const e=G.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Lt.FILL,t=null){return G.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function t1(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,s=e.width,i=t%an,r=(t-i)/an,a=i===0?r:r+1,o=n.createImageData(s,an);let c=0,u;const h=e.data,d=o.data;let f,g,m,w;if(e.kind===nf.GRAYSCALE_1BPP){const _=h.byteLength,v=new Uint32Array(d.buffer,0,d.byteLength>>2),x=v.length,S=s+7>>3,E=4294967295,C=Xt.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(m=f<r?an:i,u=0,g=0;g<m;g++){const k=_-c;let P=0;const N=k>S?s:k*8-7,R=N&-8;let D=0,B=0;for(;P<R;P+=8)B=h[c++],v[u++]=B&128?E:C,v[u++]=B&64?E:C,v[u++]=B&32?E:C,v[u++]=B&16?E:C,v[u++]=B&8?E:C,v[u++]=B&4?E:C,v[u++]=B&2?E:C,v[u++]=B&1?E:C;for(;P<N;P++)D===0&&(B=h[c++],D=128),v[u++]=B&D?E:C,D>>=1}for(;u<x;)v[u++]=0;n.putImageData(o,0,f*an)}}else if(e.kind===nf.RGBA_32BPP){for(g=0,w=s*an*4,f=0;f<r;f++)d.set(h.subarray(c,c+w)),c+=w,n.putImageData(o,0,g),g+=an;f<a&&(w=s*i*4,d.set(h.subarray(c,c+w)),n.putImageData(o,0,g))}else if(e.kind===nf.RGB_24BPP)for(m=an,w=s*m,f=0;f<a;f++){for(f>=r&&(m=i,w=s*m),u=0,g=w;g--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;n.putImageData(o,0,f*an)}else throw new Error(`bad image kind: ${e.kind}`)}function n1(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,s=e.width,i=t%an,r=(t-i)/an,a=i===0?r:r+1,o=n.createImageData(s,an);let c=0;const u=e.data,h=o.data;for(let d=0;d<a;d++){const f=d<r?an:i;({srcPos:c}=sP({src:u,srcPos:c,dest:h,width:s,height:f,nonBlackColor:0})),n.putImageData(o,0,d*an)}}function jc(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of t)n[s]!==void 0&&(e[s]=n[s]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function Bd(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Dt){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function s1(n,e){if(e)return!0;const t=G.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*Vr.PDF_TO_CSS_UNITS);return t[0]<=s&&t[1]<=s}const lP=["butt","round","square"],cP=["miter","round","bevel"],uP={},i1={};var As,by,Ay,_y;const w0=class w0{constructor(e,t,s,i,r,{optionalContentConfig:a,markedContentStack:o=null},c,u){b(this,As);this.ctx=e,this.current=new e1(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new aP(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:i=null}){const r=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,r,a),this.ctx.fillStyle=o,s){const c=this.cachedCanvases.getCanvas("transparent",r,a);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Re(this.compositeCtx))}this.ctx.save(),Bd(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Re(this.ctx)}executeOperatorList(e,t,s,i){const r=e.argsArray,a=e.fnArray;let o=t||0;const c=r.length;if(c===o)return o;const u=c-o>Jw&&typeof s=="function",h=u?Date.now()+iP:0;let d=0;const f=this.commonObjs,g=this.objs;let m;for(;;){if(i!==void 0&&o===i.nextBreakPoint)return i.breakIt(o,s),o;if(m=a[o],m!==ss.dependency)this[m].apply(this,r[o]);else for(const w of r[o]){const _=w.startsWith("g_")?f:g;if(!_.has(w))return _.get(w,s),o}if(o++,o===c)return o;if(u&&++d>Jw){if(Date.now()>h)return s(),o;d=0}}}endDrawing(){A(this,As,by).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),A(this,As,Ay).call(this)}_scaleImage(e,t){const s=e.width??e.displayWidth,i=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=s,c=i,u="prescale1",h,d;for(;r>2&&o>1||a>2&&c>1;){let f=o,g=c;r>2&&o>1&&(f=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),r/=o/f),a>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/g),h=this.cachedCanvases.getCanvas(u,f,g),d=h.context,d.clearRect(0,0,f,g),d.drawImage(e,0,0,o,c,0,0,f,g),e=h.canvas,o=f,c=g,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:i}=e,r=this.current.fillColor,a=this.current.patternFill,o=Re(t);let c,u,h,d;if((e.bitmap||e.data)&&e.count>1){const N=e.bitmap||e.data.buffer;u=JSON.stringify(a?o:[o.slice(0,4),r]),c=this._cachedBitmapsMap.get(N),c||(c=new Map,this._cachedBitmapsMap.set(N,c));const R=c.get(u);if(R&&!a){const D=Math.round(Math.min(o[0],o[2])+o[4]),B=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:R,offsetX:D,offsetY:B}}h=R}h||(d=this.cachedCanvases.getCanvas("maskCanvas",s,i),n1(d.context,e));let f=G.transform(o,[1/s,0,0,-1/i,0,0]);f=G.transform(f,[1,0,0,1,0,-i]);const[g,m,w,_]=G.getAxialAlignedBoundingBox([0,0,s,i],f),v=Math.round(w-g)||1,x=Math.round(_-m)||1,S=this.cachedCanvases.getCanvas("fillCanvas",v,x),E=S.context,C=g,k=m;E.translate(-C,-k),E.transform(...f),h||(h=this._scaleImage(d.canvas,Cs(E)),h=h.img,c&&a&&c.set(u,h)),E.imageSmoothingEnabled=s1(Re(E),e.interpolate),zd(E,h,0,0,h.width,h.height,0,0,s,i),E.globalCompositeOperation="source-in";const P=G.transform(Cs(E),[1,0,0,1,-C,-k]);return E.fillStyle=a?r.getPattern(t,this,P,Lt.FILL):r,E.fillRect(0,0,s,i),c&&!a&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,S.canvas)),{canvas:S.canvas,offsetX:Math.round(C),offsetY:Math.round(k)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=lP[e]}setLineJoin(e){this.ctx.lineJoin=cP[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const r=this.ctx;r.setTransform(...Re(this.suspendedCtx)),jc(this.suspendedCtx,r),rP(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),jc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,s,i){const r=i[0],a=i[1],o=i[2]-r,c=i[3]-a;o===0||c===0||(this.genericComposeSMask(t.context,s,o,c,t.subtype,t.backdrop,t.transferMap,r,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,t,s,i,r,a,o,c,u,h,d){let f=e.canvas,g=c-h,m=u-d;if(a){const _=G.makeHexColor(...a);if(g<0||m<0||g+s>f.width||m+i>f.height){const v=this.cachedCanvases.getCanvas("maskExtension",s,i),x=v.context;x.drawImage(f,-g,-m),x.globalCompositeOperation="destination-atop",x.fillStyle=_,x.fillRect(0,0,s,i),x.globalCompositeOperation="source-over",f=v.canvas,g=m=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(g,m,s,i),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=_,e.fillRect(g,m,s,i),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const w=new Path2D;w.rect(c,u,s,i),t.clip(w),t.globalCompositeOperation="destination-in",t.drawImage(f,g,m,s,i,c,u,s,i),t.restore()}save(){this.inSMaskMode?(jc(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),jc(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,r,a){this.ctx.transform(e,t,s,i,r,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const i=this.ctx,r=this.current;let a=r.x,o=r.y,c,u;const h=Re(i),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,f=d?s.slice(0):null;for(let g=0,m=0,w=e.length;g<w;g++)switch(e[g]|0){case ss.rectangle:a=t[m++],o=t[m++];const _=t[m++],v=t[m++],x=a+_,S=o+v;i.moveTo(a,o),_===0||v===0?i.lineTo(x,S):(i.lineTo(x,o),i.lineTo(x,S),i.lineTo(a,S)),d||r.updateRectMinMax(h,[a,o,x,S]),i.closePath();break;case ss.moveTo:a=t[m++],o=t[m++],i.moveTo(a,o),d||r.updatePathMinMax(h,a,o);break;case ss.lineTo:a=t[m++],o=t[m++],i.lineTo(a,o),d||r.updatePathMinMax(h,a,o);break;case ss.curveTo:c=a,u=o,a=t[m+4],o=t[m+5],i.bezierCurveTo(t[m],t[m+1],t[m+2],t[m+3],a,o),r.updateCurvePathMinMax(h,c,u,t[m],t[m+1],t[m+2],t[m+3],a,o,f),m+=6;break;case ss.curveTo2:c=a,u=o,i.bezierCurveTo(a,o,t[m],t[m+1],t[m+2],t[m+3]),r.updateCurvePathMinMax(h,c,u,a,o,t[m],t[m+1],t[m+2],t[m+3],f),a=t[m+2],o=t[m+3],m+=4;break;case ss.curveTo3:c=a,u=o,a=t[m+2],o=t[m+3],i.bezierCurveTo(t[m],t[m+1],a,o,a,o),r.updateCurvePathMinMax(h,c,u,t[m],t[m+1],a,o,a,o,f),m+=4;break;case ss.closePath:i.closePath();break}d&&r.updateScalingPathMinMax(h,f),r.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&(s!=null&&s.getPattern)?(t.save(),t.strokeStyle=s.getPattern(t,this,Cs(t),Lt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;let r=!1;i&&(t.save(),t.fillStyle=s.getPattern(t,this,Cs(t),Lt.FILL),r=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=uP}eoClip(){this.pendingClip=i1}beginText(){this.current.textMatrix=QS,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const s=new Path2D,i=t.getTransform().invertSelf();for(const{transform:r,x:a,y:o,fontSize:c,path:u}of e)s.addPath(u,new DOMMatrix(r).preMultiplySelf(i).translate(a,o).scale(c,-c));t.clip(s),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||Ym,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&ee("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif",a=((h=s.systemFontInfo)==null?void 0:h.css)||`"${r}", ${s.fallbackName}`;let o="normal";s.black?o="900":s.bold&&(o="bold");const c=s.italic?"italic":"normal";let u=t;t<Kw?u=Kw:t>Qw&&(u=Qw),this.current.fontSizeScale=t/u,this.ctx.font=`${c} ${o} ${u}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,r,a){this.current.textMatrix=[e,t,s,i,r,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,i,r){const a=this.ctx,o=this.current,c=o.font,u=o.textRenderingMode,h=o.fontSize/o.fontSizeScale,d=u&Ct.FILL_STROKE_MASK,f=!!(u&Ct.ADD_TO_PATH_FLAG),g=o.patternFill&&!c.missingFile,m=o.patternStroke&&!c.missingFile;let w;if((c.disableFontFace||f||g||m)&&(w=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||g||m){if(a.save(),a.translate(t,s),a.scale(h,-h),d===Ct.FILL||d===Ct.FILL_STROKE)if(i){const _=a.getTransform();a.setTransform(...i),a.fill(A(this,As,_y).call(this,w,_,i))}else a.fill(w);if(d===Ct.STROKE||d===Ct.FILL_STROKE)if(r){const _=a.getTransform();a.setTransform(...r),a.stroke(A(this,As,_y).call(this,w,_,r))}else a.lineWidth/=h,a.stroke(w);a.restore()}else(d===Ct.FILL||d===Ct.FILL_STROKE)&&a.fillText(e,t,s),(d===Ct.STROKE||d===Ct.FILL_STROKE)&&a.strokeText(e,t,s);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Re(a),x:t,y:s,fontSize:h,path:w})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){s=!0;break}return ie(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const i=t.fontSize;if(i===0)return;const r=this.ctx,a=t.fontSizeScale,o=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,d=e.length,f=s.vertical,g=f?1:-1,m=s.defaultVMetrics,w=i*t.fontMatrix[0],_=t.textRenderingMode===Ct.FILL&&!s.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(h,-1):r.scale(h,1);let v,x;if(t.patternFill){r.save();const P=t.fillColor.getPattern(r,this,Cs(r),Lt.FILL);v=Re(r),r.restore(),r.fillStyle=P}if(t.patternStroke){r.save();const P=t.strokeColor.getPattern(r,this,Cs(r),Lt.STROKE);x=Re(r),r.restore(),r.strokeStyle=P}let S=t.lineWidth;const E=t.textMatrixScale;if(E===0||S===0){const P=t.textRenderingMode&Ct.FILL_STROKE_MASK;(P===Ct.STROKE||P===Ct.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=E;if(a!==1&&(r.scale(a,a),S/=a),r.lineWidth=S,s.isInvalidPDFjsFont){const P=[];let N=0;for(const R of e)P.push(R.unicode),N+=R.width;r.fillText(P.join(""),0,0),t.x+=N*w*h,r.restore(),this.compose();return}let C=0,k;for(k=0;k<d;++k){const P=e[k];if(typeof P=="number"){C+=g*P*i/1e3;continue}let N=!1;const R=(P.isSpace?c:0)+o,D=P.fontChar,B=P.accent;let ae,ge,oe=P.width;if(f){const z=P.vmetric||m,I=-(P.vmetric?z[1]:oe*.5)*w,M=z[2]*w;oe=z?-z[0]:oe,ae=I/a,ge=(C+M)/a}else ae=C/a,ge=0;if(s.remeasure&&oe>0){const z=r.measureText(D).width*1e3/i*a;if(oe<z&&this.isFontSubpixelAAEnabled){const I=oe/z;N=!0,r.save(),r.scale(I,1),ae/=I}else oe!==z&&(ae+=(oe-z)/2e3*i/a)}if(this.contentVisible&&(P.isInFont||s.missingFile)){if(_&&!B)r.fillText(D,ae,ge);else if(this.paintChar(D,ae,ge,v,x),B){const z=ae+i*B.offset.x/a,I=ge-i*B.offset.y/a;this.paintChar(B.fontChar,z,I,v,x)}}const Xe=f?oe*w-R*u:oe*w+R*u;C+=Xe,N&&r.restore()}f?t.y-=C:t.x+=C*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,a=s.fontDirection,o=i.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,h=s.textHScale*a,d=s.fontMatrix||Ym,f=e.length,g=s.textRenderingMode===Ct.INVISIBLE;let m,w,_,v;if(!(g||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(h,a),m=0;m<f;++m){if(w=e[m],typeof w=="number"){v=o*w*r/1e3,this.ctx.translate(v,0),s.x+=v*h;continue}const x=(w.isSpace?u:0)+c,S=i.charProcOperatorList[w.operatorListId];if(!S){ee(`Type3 character "${w.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=w,this.save(),t.scale(r,r),t.transform(...d),this.executeOperatorList(S),this.restore()),_=G.applyTransform([w.width,0],d)[0]*r+x,t.translate(_,0),s.x+=_*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,r,a){this.ctx.rect(s,i,r-s,a-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const s=e[1],i=this.baseTransform||Re(this.ctx),r={createCanvasGraphics:a=>new w0(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new Sy(e,s,this.ctx,r,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){this.ctx.strokeStyle=this.current.strokeColor=G.makeHexColor(e,t,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,s){this.ctx.fillStyle=this.current.fillColor=G.makeHexColor(e,t,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=nP(this.getObject(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,Cs(t),Lt.SHADING);const i=Cs(t);if(i){const{width:r,height:a}=t.canvas,[o,c,u,h]=G.getAxialAlignedBoundingBox([0,0,r,a],i);this.ctx.fillRect(o,c,u-o,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){_e("Should not call beginInlineImage")}beginImageData(){_e("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Re(this.ctx),t)){const s=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],s,i),this.current.updateRectMinMax(Re(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||ng("TODO: Support non-isolated groups."),e.knockout&&ee("Knockout groups not supported.");const s=Re(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let i=G.getAxialAlignedBoundingBox(e.bbox,Re(t));const r=[0,0,t.canvas.width,t.canvas.height];i=G.intersect(i,r)||[0,0,0,0];const a=Math.floor(i[0]),o=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-a,1),u=Math.max(Math.ceil(i[3])-o,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,c,u),f=d.context;f.translate(-a,-o),f.transform(...s),e.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),jc(t,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const i=Re(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...i);const r=G.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],i);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,s,i,r){if(A(this,As,by).call(this),Bd(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(r&&this.annotationCanvasMap){s=s.slice(),s[4]-=t[0],s[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[c,u]=G.singularValueDecompose2dScale(Re(this.ctx)),{viewportScale:h}=this,d=Math.ceil(a*this.outputScaleX*h),f=Math.ceil(o*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:g,context:m}=this.annotationCanvas;this.annotationCanvasMap.set(e,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=m,this.ctx.save(),this.ctx.setTransform(c,0,0,-u,0,o*u),Bd(this.ctx)}else Bd(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new e1(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...i)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),A(this,As,Ay).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const s=this.ctx,i=this.processingType3;if(i&&(i.compiled===void 0&&(i.compiled=oP(e)),i.compiled)){i.compiled(s);return}const r=this._createMaskCanvas(e),a=r.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,r.offsetX,r.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,i=0,r,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const c=Re(o);o.transform(t,s,i,r,0,0);const u=this._createMaskCanvas(e);o.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let h=0,d=a.length;h<d;h+=2){const f=G.transform(c,[t,s,i,r,a[h],a[h+1]]),[g,m]=G.applyTransform([0,0],f);o.drawImage(u.canvas,g,m)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,i=this.current.patternFill;for(const r of e){const{data:a,width:o,height:c,transform:u}=r,h=this.cachedCanvases.getCanvas("maskCanvas",o,c),d=h.context;d.save();const f=this.getObject(a,r);n1(d,f),d.globalCompositeOperation="source-in",d.fillStyle=i?s.getPattern(d,this,Cs(t),Lt.FILL):s,d.fillRect(0,0,o,c),d.restore(),t.save(),t.transform(...u),t.scale(1,-1),zd(t,h.canvas,0,0,o,c,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){ee("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){ee("Dependent image isn't ready yet");return}const a=r.width,o=r.height,c=[];for(let u=0,h=i.length;u<h;u+=2)c.push({transform:[t,0,0,s,i[u],i[u+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(r,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:s,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",s,i),a=r.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,i=this.ctx;if(this.save(),!Dt){const{filter:o}=i;o!=="none"&&o!==""&&(i.filter="none")}i.scale(1/t,-1/s);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const c=this.cachedCanvases.getCanvas("inlineImage",t,s).context;t1(c,e),r=this.applyTransferMapsToCanvas(c)}const a=this._scaleImage(r,Cs(i));i.imageSmoothingEnabled=s1(Re(i),e.interpolate),zd(i,a.img,0,0,a.paintWidth,a.paintHeight,0,-s,t,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const r=e.width,a=e.height,c=this.cachedCanvases.getCanvas("inlineImage",r,a).context;t1(c,e),i=this.applyTransferMapsToCanvas(c)}for(const r of t)s.save(),s.transform(...r.transform),s.scale(1,-1),zd(s,i,r.x,r.y,r.w,r.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===i1?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Re(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:s,c:i,d:r}=this.ctx.getTransform();let a,o;if(s===0&&i===0){const c=Math.abs(t),u=Math.abs(r);if(c===u)if(e===0)a=o=1/c;else{const h=c*e;a=o=h<1?1/h:1}else if(e===0)a=1/c,o=1/u;else{const h=c*e,d=u*e;a=h<1?1/h:1,o=d<1?1/d:1}}else{const c=Math.abs(t*r-s*i),u=Math.hypot(t,s),h=Math.hypot(i,r);if(e===0)a=h/c,o=u/c;else{const d=e*c;a=h>d?h/d:1,o=u>d?u/d:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[i,r]=this.getScaleForStroking();if(t.lineWidth=s||1,i===1&&r===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(i,r),a.length>0){const o=Math.max(i,r);t.setLineDash(a.map(c=>c/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};As=new WeakSet,by=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Ay=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},_y=function(e,t,s){const i=new Path2D;return i.addPath(e,new DOMMatrix(s).invertSelf().multiplySelf(t)),i};let rl=w0;for(const n in ss)rl.prototype[n]!==void 0&&(rl.prototype[ss[n]]=rl.prototype[n]);var gh,mh;class Ri{static get workerPort(){return l(this,gh)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");y(this,gh,e)}static get workerSrc(){return l(this,mh)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");y(this,mh,e)}}gh=new WeakMap,mh=new WeakMap,b(Ri,gh,null),b(Ri,mh,"");var Ra,yh;class hP{constructor({parsedData:e,rawData:t}){b(this,Ra);b(this,yh);y(this,Ra,e),y(this,yh,t)}getRaw(){return l(this,yh)}get(e){return l(this,Ra).get(e)??null}getAll(){return o0(l(this,Ra))}has(e){return l(this,Ra).has(e)}}Ra=new WeakMap,yh=new WeakMap;const Do=Symbol("INTERNAL");var vh,wh,xh,_l;class dP{constructor(e,{name:t,intent:s,usage:i,rbGroups:r}){b(this,vh,!1);b(this,wh,!1);b(this,xh,!1);b(this,_l,!0);y(this,vh,!!(e&_n.DISPLAY)),y(this,wh,!!(e&_n.PRINT)),this.name=t,this.intent=s,this.usage=i,this.rbGroups=r}get visible(){if(l(this,xh))return l(this,_l);if(!l(this,_l))return!1;const{print:e,view:t}=this.usage;return l(this,vh)?(t==null?void 0:t.viewState)!=="OFF":l(this,wh)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,s=!1){e!==Do&&_e("Internal method `_setVisible` called."),y(this,xh,s),y(this,_l,t)}}vh=new WeakMap,wh=new WeakMap,xh=new WeakMap,_l=new WeakMap;var hr,ve,El,Cl,Sh,Ey;class fP{constructor(e,t=_n.DISPLAY){b(this,Sh);b(this,hr,null);b(this,ve,new Map);b(this,El,null);b(this,Cl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,y(this,Cl,e.order);for(const s of e.groups)l(this,ve).set(s.id,new dP(t,s));if(e.baseState==="OFF")for(const s of l(this,ve).values())s._setVisible(Do,!1);for(const s of e.on)l(this,ve).get(s)._setVisible(Do,!0);for(const s of e.off)l(this,ve).get(s)._setVisible(Do,!1);y(this,El,this.getHash())}}isVisible(e){if(l(this,ve).size===0)return!0;if(!e)return ng("Optional content group not defined."),!0;if(e.type==="OCG")return l(this,ve).has(e.id)?l(this,ve).get(e.id).visible:(ee(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return A(this,Sh,Ey).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!l(this,ve).has(t))return ee(`Optional content group not found: ${t}`),!0;if(l(this,ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!l(this,ve).has(t))return ee(`Optional content group not found: ${t}`),!0;if(!l(this,ve).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!l(this,ve).has(t))return ee(`Optional content group not found: ${t}`),!0;if(!l(this,ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!l(this,ve).has(t))return ee(`Optional content group not found: ${t}`),!0;if(l(this,ve).get(t).visible)return!1}return!0}return ee(`Unknown optional content policy ${e.policy}.`),!0}return ee(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,s=!0){var r;const i=l(this,ve).get(e);if(!i){ee(`Optional content group not found: ${e}`);return}if(s&&t&&i.rbGroups.length)for(const a of i.rbGroups)for(const o of a)o!==e&&((r=l(this,ve).get(o))==null||r._setVisible(Do,!1,!0));i._setVisible(Do,!!t,!0),y(this,hr,null)}setOCGState({state:e,preserveRB:t}){let s;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":s=i;continue}const r=l(this,ve).get(i);if(r)switch(s){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!r.visible,t);break}}y(this,hr,null)}get hasInitialVisibility(){return l(this,El)===null||this.getHash()===l(this,El)}getOrder(){return l(this,ve).size?l(this,Cl)?l(this,Cl).slice():[...l(this,ve).keys()]:null}getGroups(){return l(this,ve).size>0?o0(l(this,ve)):null}getGroup(e){return l(this,ve).get(e)||null}getHash(){if(l(this,hr)!==null)return l(this,hr);const e=new Tb;for(const[t,s]of l(this,ve))e.update(`${t}:${s.visible}`);return y(this,hr,e.hexdigest())}}hr=new WeakMap,ve=new WeakMap,El=new WeakMap,Cl=new WeakMap,Sh=new WeakSet,Ey=function(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let i=1;i<t;i++){const r=e[i];let a;if(Array.isArray(r))a=A(this,Sh,Ey).call(this,r);else if(l(this,ve).has(r))a=l(this,ve).get(r).visible;else return ee(`Optional content group not found: ${r}`),!0;switch(s){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return s==="And"};class pP{constructor(e,{disableRange:t=!1,disableStream:s=!1}){Ke(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:r,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(r==null?void 0:r.length)>0){const c=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const i=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(s),!0)});Ke(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,s,i,r;e.total===void 0?(s=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||s.call(t,{loaded:e.loaded}):(r=(i=this._fullRequestReader)==null?void 0:i.onProgress)==null||r.call(i,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ke(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new gP(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new mP(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class gP{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=u0(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class mP{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function yP(n){let e=!0,t=s("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=c(h),h=u(h),r(h)}if(t=a(n),t){const h=u(t);return r(h)}if(t=s("filename","i").exec(n),t){t=t[1];let h=o(t);return h=u(h),r(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function i(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),g=sg(d);d=f.decode(g),e=!1}catch{}}return d}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),e&&(h=i("iso-8859-1",h))),h}function a(h){const d=[];let f;const g=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=g.exec(h))!==null;){let[,w,_,v]=f;if(w=parseInt(w,10),w in d){if(w===0)break;continue}d[w]=[_,v]}const m=[];for(let w=0;w<d.length&&w in d;++w){let[_,v]=d[w];v=o(v),_&&(v=unescape(v),w===0&&(v=c(v))),m.push(v)}return m.join("")}function o(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const g=d[f].indexOf('"');g!==-1&&(d[f]=d[f].slice(0,g),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),m=h.slice(d+1).replace(/^[^']*'/,"");return i(f,m)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,g,m){if(g==="q"||g==="Q")return m=m.replaceAll("_"," "),m=m.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,_){return String.fromCharCode(parseInt(_,16))}),i(f,m);try{m=atob(m)}catch{}return i(f,m)})}return""}function Hb(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const s in e){const i=e[s];i!==void 0&&t.append(s,i)}return t}function ag(n){try{return new URL(n).origin}catch{}return null}function $b({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:s}){const i={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(i.suggestedLength=r,r<=2*t)||s||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function Wb(n){const e=n.get("Content-Disposition");if(e){let t=yP(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(u0(t))return t}return null}function og(n,e){return n===404||n===0&&e.startsWith("file:")?new Fu('Missing PDF "'+e+'".'):new op(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function Vb(n){return n===200||n===206}function Gb(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Xb(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(ee(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class r1{constructor(e){X(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Hb(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ke(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new vP(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new wP(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class vP{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const s=new Headers(e.headers),i=t.url;fetch(i,Gb(s,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=ag(r.url),!Vb(r.status))throw og(r.status,i);this._reader=r.body.getReader(),this._headersCapability.resolve();const a=r.headers,{allowRangeRequests:o,suggestedLength:c}=$b({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=c||this._contentLength,this._filename=Wb(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Wr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Xb(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class wP{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${s-1}`);const a=i.url;fetch(a,Gb(r,this._withCredentials,this._abortController)).then(o=>{const c=ag(o.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!Vb(o.status))throw og(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:Xb(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const $g=200,Wg=206;function xP(n){const e=n.response;return typeof e!="string"?e:sg(e).buffer}class SP{constructor({url:e,httpHeaders:t,withCredentials:s}){X(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Hb(this.isHttp,t),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,a]of this.headers)t.setRequestHeader(r,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=Wg):i.expectedStatus=$g,t.responseType="arraybuffer",Ke(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){var i;const s=this.pendingRequests[e];s&&((i=s.onProgress)==null||i.call(s,t))}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){s.onError(i.status);return}const r=i.status||$g;if(!(r===$g&&s.expectedStatus===Wg)&&r!==s.expectedStatus){s.onError(i.status);return}const o=xP(i);if(r===Wg){const c=i.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(c);u?s.onDone({begin:parseInt(u[1],10),chunk:o}):(ee('Missing or invalid "Content-Range" header.'),s.onError(0))}else o?s.onDone({begin:0,chunk:o}):s.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class bP{constructor(e){this._source=e,this._manager=new SP(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ke(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new AP(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new _P(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class AP{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=ag(t.responseURL);const s=t.getAllResponseHeaders(),i=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[c,...u]=o.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:a}=$b({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=Wb(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=og(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class _P{constructor(e,t,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=ag((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=og(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const EP=/^[a-z][a-z0-9\-+.]+:/i;function CP(n){if(EP.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class kP{constructor(e){this.source=e,this.url=CP(e.url),Ke(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ke(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new TP(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new PP(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class TP{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=new Fu(`Missing PDF "${this._url}".`)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Wr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class PP{constructor(e,t,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const NP=1e5,Zt=30,RP=.8;var m1,dr,sn,bh,Ah,Ma,gi,_h,Eh,La,kl,Tl,fr,Pl,Ch,Nl,Ia,kh,Th,Da,ja,Ph,pr,Rl,Hi,qb,Yb,Cy,Nn,pf,ky,Kb,Qb;const Ze=class Ze{constructor({textContentSource:e,container:t,viewport:s}){b(this,Hi);b(this,dr,Promise.withResolvers());b(this,sn,null);b(this,bh,!1);b(this,Ah,!!((m1=globalThis.FontInspector)!=null&&m1.enabled));b(this,Ma,null);b(this,gi,null);b(this,_h,0);b(this,Eh,0);b(this,La,null);b(this,kl,null);b(this,Tl,0);b(this,fr,0);b(this,Pl,Object.create(null));b(this,Ch,[]);b(this,Nl,null);b(this,Ia,[]);b(this,kh,new WeakMap);b(this,Th,null);var c;if(e instanceof ReadableStream)y(this,Nl,e);else if(typeof e=="object")y(this,Nl,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');y(this,sn,y(this,kl,t)),y(this,fr,s.scale*(globalThis.devicePixelRatio||1)),y(this,Tl,s.rotation),y(this,gi,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:a,pageY:o}=s.rawDims;y(this,Th,[1,0,0,-1,-a,o+r]),y(this,Eh,i),y(this,_h,r),A(c=Ze,Nn,Kb).call(c),xo(t,s),l(this,dr).promise.finally(()=>{l(Ze,Rl).delete(this),y(this,gi,null),y(this,Pl,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Xt.platform;return ie(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{l(this,La).read().then(({value:t,done:s})=>{if(s){l(this,dr).resolve();return}l(this,Ma)??y(this,Ma,t.lang),Object.assign(l(this,Pl),t.styles),A(this,Hi,qb).call(this,t.items),e()},l(this,dr).reject)};return y(this,La,l(this,Nl).getReader()),l(Ze,Rl).add(this),e(),l(this,dr).promise}update({viewport:e,onBefore:t=null}){var r;const s=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==l(this,Tl)&&(t==null||t(),y(this,Tl,i),xo(l(this,kl),{rotation:i})),s!==l(this,fr)){t==null||t(),y(this,fr,s);const a={div:null,properties:null,ctx:A(r=Ze,Nn,pf).call(r,l(this,Ma))};for(const o of l(this,Ia))a.properties=l(this,kh).get(o),a.div=o,A(this,Hi,Cy).call(this,a)}}cancel(){var t;const e=new Wr("TextLayer task cancelled.");(t=l(this,La))==null||t.cancel(e).catch(()=>{}),y(this,La,null),l(this,dr).reject(e)}get textDivs(){return l(this,Ia)}get textContentItemsStr(){return l(this,Ch)}static cleanup(){if(!(l(this,Rl).size>0)){l(this,Da).clear();for(const{canvas:e}of l(this,ja).values())e.remove();l(this,ja).clear()}}};dr=new WeakMap,sn=new WeakMap,bh=new WeakMap,Ah=new WeakMap,Ma=new WeakMap,gi=new WeakMap,_h=new WeakMap,Eh=new WeakMap,La=new WeakMap,kl=new WeakMap,Tl=new WeakMap,fr=new WeakMap,Pl=new WeakMap,Ch=new WeakMap,Nl=new WeakMap,Ia=new WeakMap,kh=new WeakMap,Th=new WeakMap,Da=new WeakMap,ja=new WeakMap,Ph=new WeakMap,pr=new WeakMap,Rl=new WeakMap,Hi=new WeakSet,qb=function(e){var i,r;if(l(this,bh))return;(r=l(this,gi)).ctx??(r.ctx=A(i=Ze,Nn,pf).call(i,l(this,Ma)));const t=l(this,Ia),s=l(this,Ch);for(const a of e){if(t.length>NP){ee("Ignoring additional textDivs for performance reasons."),y(this,bh,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=l(this,sn);y(this,sn,document.createElement("span")),l(this,sn).classList.add("markedContent"),a.id!==null&&l(this,sn).setAttribute("id",`${a.id}`),o.append(l(this,sn))}else a.type==="endMarkedContent"&&y(this,sn,l(this,sn).parentNode);continue}s.push(a.str),A(this,Hi,Yb).call(this,a)}},Yb=function(e){var w;const t=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};l(this,Ia).push(t);const i=G.transform(l(this,Th),e.transform);let r=Math.atan2(i[1],i[0]);const a=l(this,Pl)[e.fontName];a.vertical&&(r+=Math.PI/2);let o=l(this,Ah)&&a.fontSubstitution||a.fontFamily;o=Ze.fontFamilyMap.get(o)||o;const c=Math.hypot(i[2],i[3]),u=c*A(w=Ze,Nn,Qb).call(w,o,l(this,Ma));let h,d;r===0?(h=i[4],d=i[5]-u):(h=i[4]+u*Math.sin(r),d=i[5]-u*Math.cos(r));const f="calc(var(--scale-factor)*",g=t.style;l(this,sn)===l(this,kl)?(g.left=`${(100*h/l(this,Eh)).toFixed(2)}%`,g.top=`${(100*d/l(this,_h)).toFixed(2)}%`):(g.left=`${f}${h.toFixed(2)}px)`,g.top=`${f}${d.toFixed(2)}px)`),g.fontSize=`${f}${(l(Ze,pr)*c).toFixed(2)}px)`,g.fontFamily=o,s.fontSize=c,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,l(this,Ah)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),r!==0&&(s.angle=r*(180/Math.PI));let m=!1;if(e.str.length>1)m=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);_!==v&&Math.max(_,v)/Math.min(_,v)>1.5&&(m=!0)}if(m&&(s.canvasWidth=a.vertical?e.height:e.width),l(this,kh).set(t,s),l(this,gi).div=t,l(this,gi).properties=s,A(this,Hi,Cy).call(this,l(this,gi)),s.hasText&&l(this,sn).append(t),s.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),l(this,sn).append(_)}},Cy=function(e){var o;const{div:t,properties:s,ctx:i}=e,{style:r}=t;let a="";if(l(Ze,pr)>1&&(a=`scale(${1/l(Ze,pr)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:c}=r,{canvasWidth:u,fontSize:h}=s;A(o=Ze,Nn,ky).call(o,i,h*l(this,fr),c);const{width:d}=i.measureText(t.textContent);d>0&&(a=`scaleX(${u*l(this,fr)/d}) ${a}`)}s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(r.transform=a)},Nn=new WeakSet,pf=function(e=null){let t=l(this,ja).get(e||(e=""));if(!t){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=e,document.body.append(s),t=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),l(this,ja).set(e,t),l(this,Ph).set(t,{size:0,family:""})}return t},ky=function(e,t,s){const i=l(this,Ph).get(e);t===i.size&&s===i.family||(e.font=`${t}px ${s}`,i.size=t,i.family=s)},Kb=function(){if(l(this,pr)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),y(this,pr,e.getBoundingClientRect().height),e.remove()},Qb=function(e,t){const s=l(this,Da).get(e);if(s)return s;const i=A(this,Nn,pf).call(this,t);i.canvas.width=i.canvas.height=Zt,A(this,Nn,ky).call(this,i,Zt,e);const r=i.measureText("");let a=r.fontBoundingBoxAscent,o=Math.abs(r.fontBoundingBoxDescent);if(a){const h=a/(a+o);return l(this,Da).set(e,h),i.canvas.width=i.canvas.height=0,h}i.strokeStyle="red",i.clearRect(0,0,Zt,Zt),i.strokeText("g",0,0);let c=i.getImageData(0,0,Zt,Zt).data;o=0;for(let h=c.length-1-3;h>=0;h-=4)if(c[h]>0){o=Math.ceil(h/4/Zt);break}i.clearRect(0,0,Zt,Zt),i.strokeText("A",0,Zt),c=i.getImageData(0,0,Zt,Zt).data,a=0;for(let h=0,d=c.length;h<d;h+=4)if(c[h]>0){a=Zt-Math.floor(h/4/Zt);break}i.canvas.width=i.canvas.height=0;const u=a?a/(a+o):RP;return l(this,Da).set(e,u),u},b(Ze,Nn),b(Ze,Da,new Map),b(Ze,ja,new Map),b(Ze,Ph,new WeakMap),b(Ze,pr,null),b(Ze,Rl,new Set);let Ou=Ze;class zu{static textContent(e){const t=[],s={items:t,styles:Object.create(null)};function i(r){var c;if(!r)return;let a=null;const o=r.name;if(o==="#text")a=r.value;else if(zu.shouldBuildText(o))(c=r==null?void 0:r.attributes)!=null&&c.textContent?a=r.attributes.textContent:r.value&&(a=r.value);else return;if(a!==null&&t.push({str:a}),!!r.children)for(const u of r.children)i(u)}return i(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const MP=65536,LP=100,IP=5e3,DP=Dt?YT:GT,jP=Dt?KT:jb,FP=Dt?qT:XT,OP=Dt?QT:Bb;function zP(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new Ty,{docId:t}=e,s=n.url?BP(n.url):null,i=n.data?UP(n.data):null,r=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,c=n.range instanceof Jb?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:MP;let h=n.worker instanceof al?n.worker:null;const d=n.verbosity,f=typeof n.docBaseUrl=="string"&&!rg(n.docBaseUrl)?n.docBaseUrl:null,g=typeof n.cMapUrl=="string"?n.cMapUrl:null,m=n.cMapPacked!==!1,w=n.CMapReaderFactory||jP,_=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||OP,x=n.stopAtErrors!==!0,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,E=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Dt,k=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Dt&&(Xt.platform.isFirefox||!globalThis.chrome),P=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,N=typeof n.disableFontFace=="boolean"?n.disableFontFace:Dt,R=n.fontExtraProperties===!0,D=n.enableXfa===!0,B=n.ownerDocument||globalThis.document,ae=n.disableRange===!0,ge=n.disableStream===!0,oe=n.disableAutoFetch===!0,Xe=n.pdfBug===!0,z=n.CanvasFactory||DP,I=n.FilterFactory||FP,M=n.enableHWA===!0,O=c?c.length:n.length??NaN,j=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Dt&&!N,Y=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:w===jb&&v===Bb&&g&&_&&Vc(g,document.baseURI)&&Vc(_,document.baseURI),J=null;_T(d);const Se={canvasFactory:new z({ownerDocument:B,enableHWA:M}),filterFactory:new I({docId:t,ownerDocument:B}),cMapReaderFactory:Y?null:new w({baseUrl:g,isCompressed:m}),standardFontDataFactory:Y?null:new v({baseUrl:_})};if(!h){const ue={verbosity:d,port:Ri.workerPort};h=ue.port?al.fromPort(ue):new al(ue),e._worker=h}const ft={docId:t,apiVersion:"4.10.38",data:i,password:o,disableAutoFetch:oe,rangeChunkSize:u,length:O,docBaseUrl:f,enableXfa:D,evaluatorOptions:{maxImageSize:S,disableFontFace:N,ignoreErrors:x,isEvalSupported:E,isOffscreenCanvasSupported:C,isImageDecoderSupported:k,canvasMaxAreaInBytes:P,fontExtraProperties:R,useSystemFonts:j,cMapUrl:Y?g:null,standardFontDataUrl:Y?_:null}},Jt={disableFontFace:N,fontExtraProperties:R,ownerDocument:B,pdfBug:Xe,styleElement:J,loadingParams:{disableAutoFetch:oe,enableXfa:D}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const ue=h.messageHandler.sendWithPromise("GetDocRequest",ft,i?[i.buffer]:null);let ne;if(c)ne=new pP(c,{disableRange:ae,disableStream:ge});else if(!i){if(!s)throw new Error("getDocument - no `url` parameter provided.");let At;if(Dt)if(Vc(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");At=r1}else At=kP;else At=Vc(s)?r1:bP;ne=new At({url:s,length:O,httpHeaders:r,withCredentials:a,rangeChunkSize:u,disableRange:ae,disableStream:ge})}return ue.then(At=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ft=new Yc(t,At,h.port),Ot=new VP(Ft,e,ne,Jt,Se);e._transport=Ot,Ft.send("Ready",null)})}).catch(e._capability.reject),e}function BP(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Dt&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function UP(n){if(Dt&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return sg(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function a1(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var _p;const Ep=class Ep{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${zt(Ep,_p)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,s,i;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,r}this._transport=null,(i=this._worker)==null||i.destroy(),this._worker=null}};_p=new WeakMap,b(Ep,_p,0);let Ty=Ep;class Jb{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){_e("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class HP{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var gr,mi,Wn,jo,gf;class $P{constructor(e,t,s,i=!1){b(this,Wn);b(this,gr,null);b(this,mi,!1);this._pageIndex=e,this._pageInfo=t,this._transport=s,this._stats=i?new Gw:null,this._pdfBug=i,this.commonObjs=s.commonObjs,this.objs=new Zb,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:r=!1}={}){return new yd({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=Ji.ENABLE,transform:r=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:d=!1}){var E,C;(E=this._stats)==null||E.time("Overall");const f=this._transport.getRenderingIntent(s,i,h,d),{renderingIntent:g,cacheKey:m}=f;y(this,mi,!1),A(this,Wn,gf).call(this),o||(o=this._transport.getOptionalContentConfig(g));let w=this._intentStates.get(m);w||(w=Object.create(null),this._intentStates.set(m,w)),w.streamReaderCancelTimeout&&(clearTimeout(w.streamReaderCancelTimeout),w.streamReaderCancelTimeout=null);const _=!!(g&_n.PRINT);w.displayReadyCapability||(w.displayReadyCapability=Promise.withResolvers(),w.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(C=this._stats)==null||C.time("Page Request"),this._pumpOperatorList(f));const v=k=>{var P;w.renderTasks.delete(x),(this._maybeCleanupAfterRender||_)&&y(this,mi,!0),A(this,Wn,jo).call(this,!_),k?(x.capability.reject(k),this._abortOperatorList({intentState:w,reason:k instanceof Error?k:new Error(k)})):x.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(P=globalThis.Stats)!=null&&P.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},x=new Ny({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:w.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!_,pdfBug:this._pdfBug,pageColors:u});(w.renderTasks||(w.renderTasks=new Set)).add(x);const S=x.task;return Promise.all([w.displayReadyCapability.promise,o]).then(([k,P])=>{var N;if(this.destroyed){v();return}if((N=this._stats)==null||N.time("Rendering"),!(P.renderingIntent&g))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");x.initializeGraphics({transparency:k,optionalContentConfig:P}),x.operatorListChanged()}).catch(v),S}getOperatorList({intent:e="display",annotationMode:t=Ji.ENABLE,printAnnotationStorage:s=null,isEditing:i=!1}={}){var u;function r(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(c))}const a=this._transport.getRenderingIntent(e,t,s,i,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let c;return o.opListReadCapability||(c=Object.create(null),c.operatorListChanged=r,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(c),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>zu.textContent(s));const t=this.streamTextContent(e);return new Promise(function(s,i){function r(){a.read().then(function({value:c,done:u}){if(u){s(o);return}o.lang??(o.lang=c.lang),Object.assign(o.styles,c.styles),o.items.push(...c.items),r()},i)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),y(this,mi,!1),A(this,Wn,gf).call(this),Promise.all(e)}cleanup(e=!1){y(this,mi,!0);const t=A(this,Wn,jo).call(this,!1);return e&&t&&this._stats&&(this._stats=new Gw),t}_startRenderPage(e,t){var i,r;const s=this._intentStates.get(t);s&&((i=this._stats)==null||i.timeEnd("Page Request"),(r=s.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const s of t.renderTasks)s.operatorListChanged();e.lastChunk&&A(this,Wn,jo).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:s,modifiedIds:i}){const{map:r,transfer:a}=s,c=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:i},a).getReader(),u=this._intentStates.get(t);u.streamReader=c;const h=()=>{c.read().then(({value:d,done:f})=>{if(f){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(d,u),h())},d=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const f of u.renderTasks)f.operatorListChanged();A(this,Wn,jo).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(d);else if(u.opListReadCapability)u.opListReadCapability.reject(d);else throw d}})};h()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(t instanceof c0){let i=LP;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Wr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,r]of this._intentStates)if(r===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}gr=new WeakMap,mi=new WeakMap,Wn=new WeakSet,jo=function(e=!1){if(A(this,Wn,gf).call(this),!l(this,mi)||this.destroyed)return!1;if(e)return y(this,gr,setTimeout(()=>{y(this,gr,null),A(this,Wn,jo).call(this,!1)},IP)),!1;for(const{renderTasks:t,operatorList:s}of this._intentStates.values())if(t.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),y(this,mi,!1),!0},gf=function(){l(this,gr)&&(clearTimeout(l(this,gr)),y(this,gr,null))};var yi,Cp;class WP{constructor(){b(this,yi,new Map);b(this,Cp,Promise.resolve())}postMessage(e,t){const s={data:structuredClone(e,t?{transfer:t}:null)};l(this,Cp).then(()=>{for(const[i]of l(this,yi))i.call(this,s)})}addEventListener(e,t,s=null){let i=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:r}=s;if(r.aborted){ee("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>r.removeEventListener("abort",a),r.addEventListener("abort",a)}l(this,yi).set(t,i)}removeEventListener(e,t){const s=l(this,yi).get(t);s==null||s(),l(this,yi).delete(t)}terminate(){for(const[,e]of l(this,yi))e==null||e();l(this,yi).clear()}}yi=new WeakMap,Cp=new WeakMap;var kp,Fa,Oa,Ml,mf,Ll,yf;const Ne=class Ne{constructor({name:e=null,port:t=null,verbosity:s=ET()}={}){b(this,Ml);var i;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((i=l(Ne,Oa))!=null&&i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(l(Ne,Oa)||y(Ne,Oa,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new Yc("main","worker",e),this._messageHandler.on("ready",function(){}),A(this,Ml,mf).call(this)}_initialize(){if(l(Ne,Fa)||l(Ne,Ll,yf)){this._setupFakeWorker();return}let{workerSrc:e}=Ne;try{Ne._isSameOrigin(window.location.href,e)||(e=Ne._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),s=new Yc("main","worker",t),i=()=>{r.abort(),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||i()},{signal:r.signal}),s.on("test",o=>{if(r.abort(),this.destroyed||!o){i();return}this._messageHandler=s,this._port=t,this._webWorker=t,A(this,Ml,mf).call(this)}),s.on("ready",o=>{if(r.abort(),this.destroyed){i();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;s.send("test",o,[o.buffer])};a();return}catch{ng("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){l(Ne,Fa)||(ee("Setting up fake worker."),y(Ne,Fa,!0)),Ne._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new WP;this._port=t;const s=`fake${zt(Ne,kp)._++}`,i=new Yc(s+"_worker",s,t);e.setup(i,t),this._messageHandler=new Yc(s,s+"_worker",t),A(this,Ml,mf).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,s;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=l(Ne,Oa))==null||t.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(e){var s;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(s=l(this,Oa))==null?void 0:s.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Ne(e)}static get workerSrc(){if(Ri.workerSrc)return Ri.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ie(this,"_setupFakeWorkerGlobal",(async()=>l(this,Ll,yf)?l(this,Ll,yf):(await import(this.workerSrc)).WorkerMessageHandler)())}};kp=new WeakMap,Fa=new WeakMap,Oa=new WeakMap,Ml=new WeakSet,mf=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Ll=new WeakSet,yf=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},b(Ne,Ll),b(Ne,kp,0),b(Ne,Fa,!1),b(Ne,Oa),Dt&&(y(Ne,Fa,!0),Ri.workerSrc||(Ri.workerSrc="./pdf.worker.mjs")),Ne._isSameOrigin=(e,t)=>{let s;try{if(s=new URL(e),!s.origin||s.origin==="null")return!1}catch{return!1}const i=new URL(t,s);return s.origin===i.origin},Ne._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let al=Ne;var vi,zs,Il,Dl,wi,za,eu;class VP{constructor(e,t,s,i,r){b(this,za);b(this,vi,new Map);b(this,zs,new Map);b(this,Il,new Map);b(this,Dl,new Map);b(this,wi,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Zb,this.fontLoader=new WT({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ie(this,"annotationStorage",new f0)}getRenderingIntent(e,t=Ji.ENABLE,s=null,i=!1,r=!1){let a=_n.DISPLAY,o=yy;switch(e){case"any":a=_n.ANY;break;case"display":break;case"print":a=_n.PRINT;break;default:ee(`getRenderingIntent - invalid intent: ${e}`)}const c=a&_n.PRINT&&s instanceof Nb?s:this.annotationStorage;switch(t){case Ji.DISABLE:a+=_n.ANNOTATIONS_DISABLE;break;case Ji.ENABLE:break;case Ji.ENABLE_FORMS:a+=_n.ANNOTATIONS_FORMS;break;case Ji.ENABLE_STORAGE:a+=_n.ANNOTATIONS_STORAGE,o=c.serializable;break;default:ee(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=_n.IS_EDITING),r&&(a+=_n.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[a,o.hash,h];return{renderingIntent:a,cacheKey:d.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var s;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(s=l(this,wi))==null||s.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const i of l(this,zs).values())e.push(i._destroy());l(this,zs).clear(),l(this,Il).clear(),l(this,Dl).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var i,r;this.commonObjs.clear(),this.fontLoader.clear(),l(this,vi).clear(),this.filterFactory.destroy(),Ou.cleanup(),(i=this._networkStream)==null||i.cancelAllRequests(new Wr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(s,i)=>{Ke(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},i.onPull=()=>{this._fullReader.read().then(function({value:r,done:a}){if(a){i.close();return}Ke(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{i.error(r)})},i.onCancel=r=>{this._fullReader.cancel(r),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async s=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:a}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:a}}),e.on("GetRangeReader",(s,i)=>{Ke(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(s.begin,s.end);if(!r){i.close();return}i.onPull=()=>{r.read().then(function({value:a,done:o}){if(o){i.close();return}Ke(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{r.cancel(a),i.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,t._capability.resolve(new HP(s,this))}),e.on("DocException",s=>{t._capability.reject(en(s))}),e.on("PasswordRequest",s=>{y(this,wi,Promise.withResolvers());try{if(!t.onPassword)throw en(s);const i=r=>{r instanceof Error?l(this,wi).reject(r):l(this,wi).resolve({password:r})};t.onPassword(i,s.code)}catch(i){l(this,wi).reject(i)}return l(this,wi).promise}),e.on("DataLoaded",s=>{var i;(i=t.onProgress)==null||i.call(t,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{if(this.destroyed)return;l(this,zs).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,i,r])=>{var a;if(this.destroyed||this.commonObjs.has(s))return null;switch(i){case"Font":const{disableFontFace:o,fontExtraProperties:c,pdfBug:u}=this._params;if("error"in r){const g=r.error;ee(`Error during font loading: ${g}`),this.commonObjs.resolve(s,g);break}const h=u&&((a=globalThis.FontInspector)!=null&&a.enabled)?(g,m)=>globalThis.FontInspector.fontAdded(g,m):null,d=new VT(r,{disableFontFace:o,fontExtraProperties:c,inspectFont:h});this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c&&d.data&&(d.data=null),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=r;Ke(f,"The imageRef must be defined.");for(const g of l(this,zs).values())for(const[,m]of g.objs)if((m==null?void 0:m.ref)===f)return m.dataLen?(this.commonObjs.resolve(s,structuredClone(m)),m.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,r);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([s,i,r,a])=>{var c;if(this.destroyed)return;const o=l(this,zs).get(i);if(!o.objs.has(s)){if(o._intentStates.size===0){(c=a==null?void 0:a.bitmap)==null||c.close();return}switch(r){case"Image":o.objs.resolve(s,a),(a==null?void 0:a.dataLen)>xT&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(s,a);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",s=>{var i;this.destroyed||(i=t.onProgress)==null||i.call(t,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var s;this.annotationStorage.size<=0&&ee("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((s=this._fullReader)==null?void 0:s.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=l(this,Il).get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&l(this,Dl).set(r.refStr,e);const a=new $P(t,r,this,this._params.pdfBug);return l(this,zs).set(t,a),a});return l(this,Il).set(t,i),i}getPageIndex(e){return a1(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return A(this,za,eu).call(this,"GetFieldObjects")}hasJSActions(){return A(this,za,eu).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return A(this,za,eu).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return A(this,za,eu).call(this,"GetOptionalContentConfig").then(t=>new fP(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=l(this,vi).get(e);if(t)return t;const s=this.messageHandler.sendWithPromise(e,null).then(i=>{var r,a;return{info:i[0],metadata:i[1]?new hP(i[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return l(this,vi).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of l(this,zs).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),l(this,vi).clear(),this.filterFactory.destroy(!0),Ou.cleanup()}}cachedPageNumber(e){if(!a1(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return l(this,Dl).get(t)??null}}vi=new WeakMap,zs=new WeakMap,Il=new WeakMap,Dl=new WeakMap,wi=new WeakMap,za=new WeakSet,eu=function(e,t=null){const s=l(this,vi).get(e);if(s)return s;const i=this.messageHandler.sendWithPromise(e,t);return l(this,vi).set(e,i),i};const Fc=Symbol("INITIAL_DATA");var gn,Nh,Py;class Zb{constructor(){b(this,Nh);b(this,gn,Object.create(null))}get(e,t=null){if(t){const i=A(this,Nh,Py).call(this,e);return i.promise.then(()=>t(i.data)),null}const s=l(this,gn)[e];if(!s||s.data===Fc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=l(this,gn)[e];return!!t&&t.data!==Fc}delete(e){const t=l(this,gn)[e];return!t||t.data===Fc?!1:(delete l(this,gn)[e],!0)}resolve(e,t=null){const s=A(this,Nh,Py).call(this,e);s.data=t,s.resolve()}clear(){var e;for(const t in l(this,gn)){const{data:s}=l(this,gn)[t];(e=s==null?void 0:s.bitmap)==null||e.close()}y(this,gn,Object.create(null))}*[Symbol.iterator](){for(const e in l(this,gn)){const{data:t}=l(this,gn)[e];t!==Fc&&(yield[e,t])}}}gn=new WeakMap,Nh=new WeakSet,Py=function(e){var t;return(t=l(this,gn))[e]||(t[e]={...Promise.withResolvers(),data:Fc})};var mr;class GP{constructor(e){b(this,mr,null);y(this,mr,e),this.onContinue=null}get promise(){return l(this,mr).capability.promise}cancel(e=0){l(this,mr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=l(this,mr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=l(this,mr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}mr=new WeakMap;var yr,Ba;const ia=class ia{constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:r,operatorList:a,pageIndex:o,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null}){b(this,yr,null);this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new GP(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,c;if(this.cancelled)return;if(this._canvas){if(l(ia,Ba).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");l(ia,Ba).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:r,background:a}=this.params;this.gfx=new rl(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(c=this.graphicsReadyCallback)==null||c.call(this)}cancel(e=null,t=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),l(this,yr)&&(window.cancelAnimationFrame(l(this,yr)),y(this,yr,null)),l(ia,Ba).delete(this._canvas),this.callback(e||new c0(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?y(this,yr,window.requestAnimationFrame(()=>{y(this,yr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),l(ia,Ba).delete(this._canvas),this.callback())))}};yr=new WeakMap,Ba=new WeakMap,b(ia,Ba,new WeakSet);let Ny=ia;const XP="4.10.38",qP="f9bea397f";function o1(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Oc(n){return Math.max(0,Math.min(255,255*n))}class l1{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Oc(e),[e,e,e]}static G_HTML([e]){const t=o1(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_rgb(e){return e.map(Oc)}static RGB_HTML(e){return`#${e.map(o1).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,s,i]){return[Oc(1-Math.min(1,e+i)),Oc(1-Math.min(1,s+i)),Oc(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,r=1-t,a=1-s,o=Math.min(i,r,a);return["CMYK",i,r,a,o]}}class YP{create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){_e("Abstract method `_createSVG` called.")}}class g0 extends YP{_createSVG(e){return document.createElementNS(Zs,e)}}class eA{static setupStorage(e,t,s,i,r){const a=i.getValue(t,{value:null});switch(s.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(a.value===s.attributes.xfaOn?e.setAttribute("checked",!0):a.value===s.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",o=>{i.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),r==="print")break;e.addEventListener("input",o=>{i.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of s.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const c=o.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;i.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:r}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[c,u]of Object.entries(a))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}o&&r.addLinkAttributes(e,a.href,a.newWindow),s&&a.dataId&&this.setupStorage(e,a.dataId,t,s)}static render(e){var d,f;const t=e.annotationStorage,s=e.linkService,i=e.xfaHtml,r=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:r,linkService:s});const o=r!=="richText",c=e.div;if(c.append(a),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;c.style.transform=g}o&&c.setAttribute("class","xfaLayer xfaFont");const u=[];if(i.children.length===0){if(i.value){const g=document.createTextNode(i.value);a.append(g),o&&zu.shouldBuildText(i.name)&&u.push(g)}return{textDivs:u}}const h=[[i,-1,a]];for(;h.length>0;){const[g,m,w]=h.at(-1);if(m+1===g.children.length){h.pop();continue}const _=g.children[++h.at(-1)[1]];if(_===null)continue;const{name:v}=_;if(v==="#text"){const S=document.createTextNode(_.value);u.push(S),w.append(S);continue}const x=(d=_==null?void 0:_.attributes)!=null&&d.xmlns?document.createElementNS(_.attributes.xmlns,v):document.createElement(v);if(w.append(x),_.attributes&&this.setAttributes({html:x,element:_,storage:t,intent:r,linkService:s}),((f=_.children)==null?void 0:f.length)>0)h.push([_,-1,x]);else if(_.value){const S=document.createTextNode(_.value);o&&zu.shouldBuildText(v)&&u.push(S),x.append(S)}}for(const g of c.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const wd=1e3,KP=9,bo=new WeakSet;function Ur(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class QP{static create(e){switch(e.data.annotationType){case Je.LINK:return new tA(e);case Je.TEXT:return new JP(e);case Je.WIDGET:switch(e.data.fieldType){case"Tx":return new ZP(e);case"Btn":return e.data.radioButton?new iA(e):e.data.checkBox?new tN(e):new nN(e);case"Ch":return new sN(e);case"Sig":return new eN(e)}return new Po(e);case Je.POPUP:return new My(e);case Je.FREETEXT:return new cA(e);case Je.LINE:return new rN(e);case Je.SQUARE:return new aN(e);case Je.CIRCLE:return new oN(e);case Je.POLYLINE:return new uA(e);case Je.CARET:return new cN(e);case Je.INK:return new m0(e);case Je.POLYGON:return new lN(e);case Je.HIGHLIGHT:return new hA(e);case Je.UNDERLINE:return new uN(e);case Je.SQUIGGLY:return new hN(e);case Je.STRIKEOUT:return new dN(e);case Je.STAMP:return new dA(e);case Je.FILEATTACHMENT:return new fN(e);default:return new Ge(e)}}}var Ua,jl,Fl,Rh,Ry;const x0=class x0{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){b(this,Rh);b(this,Ua,null);b(this,jl,!1);b(this,Fl,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(s)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:s}){return!!(e!=null&&e.str||t!=null&&t.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return x0._hasPopupData(this.data)}updateEdited(e){var s;if(!this.container)return;l(this,Ua)||y(this,Ua,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&A(this,Rh,Ry).call(this,t),(s=l(this,Fl))==null||s.popup.updateEdited(e)}resetEdited(){var e;l(this,Ua)&&(A(this,Rh,Ry).call(this,l(this,Ua).rect),(e=l(this,Fl))==null||e.popup.resetEdited(),y(this,Ua,null))}_createContainer(e){const{data:t,parent:{page:s,viewport:i}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Po||(r.tabIndex=wd);const{style:a}=r;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof My){const{rotation:w}=t;return!t.hasOwnCanvas&&w!==0&&this.setRotation(w,r),r}const{width:o,height:c}=Ur(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const w=t.borderStyle.horizontalCornerRadius,_=t.borderStyle.verticalCornerRadius;if(w>0||_>0){const x=`calc(${w}px * var(--scale-factor)) / calc(${_}px * var(--scale-factor))`;a.borderRadius=x}else if(this instanceof iA){const x=`calc(${o}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;a.borderRadius=x}switch(t.borderStyle.style){case Dc.SOLID:a.borderStyle="solid";break;case Dc.DASHED:a.borderStyle="dashed";break;case Dc.BEVELED:ee("Unimplemented border style: beveled");break;case Dc.INSET:ee("Unimplemented border style: inset");break;case Dc.UNDERLINE:a.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(y(this,jl,!0),a.borderColor=G.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):a.borderWidth=0}const u=G.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:g}=i.rawDims;a.left=`${100*(u[0]-f)/h}%`,a.top=`${100*(u[1]-g)/d}%`;const{rotation:m}=t;return t.hasOwnCanvas||m===0?(a.width=`${100*o/h}%`,a.height=`${100*c/d}%`):this.setRotation(m,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:a}=Ur(this.data.rect);let o,c;e%180===0?(o=100*r/s,c=100*a/i):(o=100*a/s,c=100*r/i),t.style.width=`${o}%`,t.style.height=`${c}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,s,i)=>{const r=i.detail[t],a=r[0],o=r.slice(1);i.target.style[s]=l1[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[s]:l1[`${a}_rgb`](o)})};return ie(this,"_commonActions",{display:t=>{const{display:s}=t.detail,i=s%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:s===1||s===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:s}=t.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const s=t.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||s[i];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,r]of Object.entries(t)){const a=s[i];if(a){const o={detail:{[i]:r},target:e};a(o),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,s,i,r]=this.data.rect.map(w=>Math.fround(w));if(e.length===8){const[w,_,v,x]=e.subarray(2,6);if(i===w&&r===_&&t===v&&s===x)return}const{style:a}=this.container;let o;if(l(this,jl)){const{borderColor:w,borderWidth:_}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const c=i-t,u=r-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=h.createElement("defs");d.append(f);const g=h.createElement("clipPath"),m=`clippath_${this.data.id}`;g.setAttribute("id",m),g.setAttribute("clipPathUnits","objectBoundingBox"),f.append(g);for(let w=2,_=e.length;w<_;w+=8){const v=e[w],x=e[w+1],S=e[w+2],E=e[w+3],C=h.createElement("rect"),k=(S-t)/c,P=(r-x)/u,N=(v-S)/c,R=(x-E)/u;C.setAttribute("x",k),C.setAttribute("y",P),C.setAttribute("width",N),C.setAttribute("height",R),g.append(C),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${P}" width="${N}" height="${R}"/>`)}l(this,jl)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(d),this.container.style.clipPath=`url(#${m})`}_createPopup(){const{data:e}=this,t=y(this,Fl,new My({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){_e("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:r,id:a,exportValues:o}of i){if(r===-1||a===t)continue;const c=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!bo.has(u)){ee(`_getElementsByName - element not allowed: ${a}`);continue}s.push({id:a,exportValue:c,domElement:u})}return s}for(const i of document.getElementsByName(e)){const{exportValue:r}=i,a=i.getAttribute("data-element-id");a!==t&&bo.has(i)&&s.push({id:a,exportValue:r,domElement:i})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Ua=new WeakMap,jl=new WeakMap,Fl=new WeakMap,Rh=new WeakSet,Ry=function(e){const{container:{style:t},data:{rect:s,rotation:i},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}}}=this;s==null||s.splice(0,4,...e);const{width:u,height:h}=Ur(e);t.left=`${100*(e[0]-o)/r}%`,t.top=`${100*(a-e[3]+c)/a}%`,i===0?(t.width=`${100*u/r}%`,t.height=`${100*h/a}%`):this.setRotation(i)};let Ge=x0;var Cn,Zr,nA,sA;class tA extends Ge{constructor(t,s=null){super(t,{isRenderable:!0,ignoreBorder:!!(s!=null&&s.ignoreBorder),createQuadrilaterals:!0});b(this,Cn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:s}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(s.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action),r=!0):t.attachment?(A(this,Cn,nA).call(this,i,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(A(this,Cn,sA).call(this,i,t.setOCGState),r=!0):t.dest?(this._bindLink(i,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}_bindLink(t,s){t.href=this.linkService.getDestinationHash(s),t.onclick=()=>(s&&this.linkService.goToDestination(s),!1),(s||s==="")&&A(this,Cn,Zr).call(this)}_bindNamedAction(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(s),!1),A(this,Cn,Zr).call(this)}_bindJSAction(t,s){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(s.actions)){const a=i.get(r);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:s.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),A(this,Cn,Zr).call(this)}_bindResetFormAction(t,s){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),A(this,Cn,Zr).call(this),!this._fieldObjects){ee('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{var d;i==null||i();const{fields:r,refs:a,include:o}=s,c=[];if(r.length!==0||a.length!==0){const f=new Set(a);for(const g of r){const m=this._fieldObjects[g]||[];for(const{id:w}of m)f.add(w)}for(const g of Object.values(this._fieldObjects))for(const m of g)f.has(m.id)===o&&c.push(m)}else for(const f of Object.values(this._fieldObjects))c.push(...f);const u=this.annotationStorage,h=[];for(const f of c){const{id:g}=f;switch(h.push(g),f.type){case"text":{const w=f.defaultValue||"";u.setValue(g,{value:w});break}case"checkbox":case"radiobutton":{const w=f.defaultValue===f.exportValues;u.setValue(g,{value:w});break}case"combobox":case"listbox":{const w=f.defaultValue||"";u.setValue(g,{value:w});break}default:continue}const m=document.querySelector(`[data-element-id="${g}"]`);if(m){if(!bo.has(m)){ee(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}Cn=new WeakSet,Zr=function(){this.container.setAttribute("data-internal-link","")},nA=function(t,s,i=null){t.href=this.linkService.getAnchorUrl(""),s.description&&(t.title=s.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(s.content,s.filename,i),!1},A(this,Cn,Zr).call(this)},sA=function(t,s){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(s),!1),A(this,Cn,Zr).call(this)};class JP extends Ge{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Po extends Ge{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Xt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,s,i,r){s.includes("mouse")?e.addEventListener(s,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(s,a=>{var o;if(s==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(s==="focus"){if(t.focused)return;t.focused=!0}r&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(a)}}))})}_setEventListeners(e,t,s,i){var r,a,o;for(const[c,u]of s)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,c,u,i),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":G.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||KP,r=e.style;let a;const o=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(u/(Og*i))||1,d=u/h;a=Math.min(i,c(d/Og))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(i,c(u/Og))}r.fontSize=`calc(${a}px * var(--scale-factor))`,r.color=G.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class ZP extends Po{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,s,i){const r=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=s),r.setValue(a.id,{[i]:s})}render(){var i,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const c=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let u=a.formattedValue||((i=this.data.textContent)==null?void 0:i.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),bo.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=wd,this._setRequired(s,this.data.required),c&&(s.maxLength=c),s.addEventListener("input",f=>{e.setValue(t,{value:f.target.value}),this.setPropertyOnSiblings(s,"value",f.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue??"";s.value=h.userValue=g,h.formattedValue=null});let d=f=>{const{formattedValue:g}=h;g!=null&&(f.target.value=g),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",g=>{var w;if(h.focused)return;const{target:m}=g;h.userValue&&(m.value=h.userValue),h.lastCommittedValue=m.value,h.commitKey=1,(w=this.data.actions)!=null&&w.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const m={value(w){h.userValue=w.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:_}=w.detail;h.formattedValue=_,_!=null&&w.target!==document.activeElement&&(w.target.value=_),e.setValue(t,{formattedValue:_})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{var S;const{charLimit:_}=w.detail,{target:v}=w;if(_===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",_);let x=h.userValue;!x||x.length<=_||(x=x.slice(0,_),v.value=h.userValue=x,e.setValue(t,{value:x}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(m,g)}),s.addEventListener("keydown",g=>{var _;h.commitKey=1;let m=-1;if(g.key==="Escape"?m=0:g.key==="Enter"&&!this.data.multiLine?m=2:g.key==="Tab"&&(h.commitKey=3),m===-1)return;const{value:w}=g.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:w,willCommit:!0,commitKey:m,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const f=d;d=null,s.addEventListener("blur",g=>{var w,_;if(!h.focused||!g.relatedTarget)return;(w=this.data.actions)!=null&&w.Blur||(h.focused=!1);const{value:m}=g.target;h.userValue=m,h.lastCommittedValue!==m&&((_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:m,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),f(g)}),(r=this.data.actions)!=null&&r.Keystroke&&s.addEventListener("beforeinput",g=>{var C;h.lastCommittedValue=null;const{data:m,target:w}=g,{value:_,selectionStart:v,selectionEnd:x}=w;let S=v,E=x;switch(g.inputType){case"deleteWordBackward":{const k=_.substring(0,v).match(/\w*[^\w]*$/);k&&(S-=k[0].length);break}case"deleteWordForward":{const k=_.substring(v).match(/^[^\w]*\w*/);k&&(E+=k[0].length);break}case"deleteContentBackward":v===x&&(S-=1);break;case"deleteContentForward":v===x&&(E+=1);break}g.preventDefault(),(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,change:m||"",willCommit:!1,selStart:S,selEnd:E}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(d&&s.addEventListener("blur",d),this.data.comb){const g=(this.data.rect[2]-this.data.rect[0])/c;s.classList.add("comb"),s.style.letterSpacing=`calc(${g}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class eN extends Po{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class tN extends Po{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(s,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return bo.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=wd,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,s)){const h=c&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",a=>{const o={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class iA extends Po{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(s,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,s))e.setValue(a.id,{value:!1});const r=document.createElement("input");if(bo.add(r),r.setAttribute("data-element-id",s),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=wd,r.addEventListener("change",a=>{const{name:o,checked:c}=a.target;for(const u of this._getElementsByName(o,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),r.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;r.addEventListener("updatefromsandbox",o=>{const c={value:u=>{const h=a===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===s;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class nN extends tA{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class sN extends Po{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");bo.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=wd;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of i.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),r=!1),i.append(d)}let a=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),i.prepend(h),a=()=>{h.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const o=h=>{const d=h?"value":"textContent",{options:f,multiple:g}=i;return g?Array.prototype.filter.call(f,m=>m.selected).map(m=>m[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=o(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",h=>{const d={value(f){a==null||a();const g=f.detail.value,m=new Set(Array.isArray(g)?g:[g]);for(const w of i.options)w.selected=m.has(w.value);e.setValue(t,{value:o(!0)}),c=o(!1)},multipleSelection(f){i.multiple=!0},remove(f){const g=i.options,m=f.detail.remove;g[m].selected=!1,i.remove(m),g.length>0&&Array.prototype.findIndex.call(g,_=>_.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},clear(f){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),c=o(!1)},insert(f){const{index:g,displayValue:m,exportValue:w}=f.detail.insert,_=i.children[g],v=document.createElement("option");v.textContent=m,v.value=w,_?_.before(v):i.append(v),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},items(f){const{items:g}=f.detail;for(;i.length!==0;)i.remove(0);for(const m of g){const{displayValue:w,exportValue:_}=m,v=document.createElement("option");v.textContent=w,v.value=_,i.append(v)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(f)}),c=o(!1)},indices(f){const g=new Set(f.detail.indices);for(const m of f.target.options)m.selected=g.has(m.index);e.setValue(t,{value:o(!0)}),c=o(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),i.addEventListener("input",h=>{var g;const d=o(!0),f=o(!1);e.setValue(t,{value:d}),h.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:c,change:f,changeEx:d,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):i.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class My extends Ge{constructor(e){const{data:t,elements:s}=e;super(e,{isRenderable:Ge._hasPopupData(t)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new iN({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",t.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(s=>`${l0}${s}`).join(",")),this.container}}var Ol,Tp,Pp,zl,Ha,Ue,xi,Bl,Mh,Lh,Ul,Si,ls,bi,Ih,Ai,Dh,$a,Wa,Ae,vf,Ly,rA,aA,oA,lA,wf,xf,Iy;class iN{constructor({container:e,color:t,elements:s,titleObj:i,modificationDate:r,contentsObj:a,richText:o,parent:c,rect:u,parentRect:h,open:d}){b(this,Ae);b(this,Ol,A(this,Ae,oA).bind(this));b(this,Tp,A(this,Ae,Iy).bind(this));b(this,Pp,A(this,Ae,xf).bind(this));b(this,zl,A(this,Ae,wf).bind(this));b(this,Ha,null);b(this,Ue,null);b(this,xi,null);b(this,Bl,null);b(this,Mh,null);b(this,Lh,null);b(this,Ul,null);b(this,Si,!1);b(this,ls,null);b(this,bi,null);b(this,Ih,null);b(this,Ai,null);b(this,Dh,null);b(this,$a,null);b(this,Wa,!1);var f;y(this,Ue,e),y(this,Dh,i),y(this,xi,a),y(this,Ai,o),y(this,Lh,c),y(this,Ha,t),y(this,Ih,u),y(this,Ul,h),y(this,Mh,s),y(this,Bl,h0.toDateObject(r)),this.trigger=s.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",l(this,zl)),g.addEventListener("mouseenter",l(this,Pp)),g.addEventListener("mouseleave",l(this,Tp)),g.classList.add("popupTriggerArea");for(const g of s)(f=g.container)==null||f.addEventListener("keydown",l(this,Ol));l(this,Ue).hidden=!0,d&&A(this,Ae,wf).call(this)}render(){if(l(this,ls))return;const e=y(this,ls,document.createElement("div"));if(e.className="popup",l(this,Ha)){const r=e.style.outlineColor=G.makeHexColor(...l(this,Ha));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=G.makeHexColor(...l(this,Ha).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const s=document.createElement("h1");if(t.append(s),{dir:s.dir,str:s.textContent}=l(this,Dh),e.append(t),l(this,Bl)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:l(this,Bl).valueOf()})),t.append(r)}const i=l(this,Ae,vf);if(i)eA.render({xfaHtml:i,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(l(this,xi));e.append(r)}l(this,Ue).append(e)}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let r=0,a=i.length;r<a;++r){const o=i[r];s.append(document.createTextNode(o)),r<a-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:t}){var s;l(this,$a)||y(this,$a,{contentsObj:l(this,xi),richText:l(this,Ai)}),e&&y(this,bi,null),t&&(y(this,Ai,A(this,Ae,aA).call(this,t)),y(this,xi,null)),(s=l(this,ls))==null||s.remove(),y(this,ls,null)}resetEdited(){var e;l(this,$a)&&({contentsObj:zt(this,xi)._,richText:zt(this,Ai)._}=l(this,$a),y(this,$a,null),(e=l(this,ls))==null||e.remove(),y(this,ls,null),y(this,bi,null))}forceHide(){y(this,Wa,this.isVisible),l(this,Wa)&&(l(this,Ue).hidden=!0)}maybeShow(){l(this,Wa)&&(l(this,ls)||A(this,Ae,xf).call(this),y(this,Wa,!1),l(this,Ue).hidden=!1)}get isVisible(){return l(this,Ue).hidden===!1}}Ol=new WeakMap,Tp=new WeakMap,Pp=new WeakMap,zl=new WeakMap,Ha=new WeakMap,Ue=new WeakMap,xi=new WeakMap,Bl=new WeakMap,Mh=new WeakMap,Lh=new WeakMap,Ul=new WeakMap,Si=new WeakMap,ls=new WeakMap,bi=new WeakMap,Ih=new WeakMap,Ai=new WeakMap,Dh=new WeakMap,$a=new WeakMap,Wa=new WeakMap,Ae=new WeakSet,vf=function(){const e=l(this,Ai),t=l(this,xi);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&l(this,Ai).html||null},Ly=function(){var e,t,s;return((s=(t=(e=l(this,Ae,vf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.fontSize)||0},rA=function(){var e,t,s;return((s=(t=(e=l(this,Ae,vf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:s.color)||null},aA=function(e){const t=[],s={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:l(this,Ae,rA),fontSize:l(this,Ae,Ly)?`calc(${l(this,Ae,Ly)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:i});return s},oA=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&l(this,Si))&&A(this,Ae,wf).call(this)},lA=function(){if(l(this,bi)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:s,pageX:i,pageY:r}}}=l(this,Lh);let a=!!l(this,Ul),o=a?l(this,Ul):l(this,Ih);for(const m of l(this,Mh))if(!o||G.intersect(m.data.rect,o)!==null){o=m.data.rect,a=!0;break}const c=G.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),h=a?o[2]-o[0]+5:0,d=c[0]+h,f=c[1];y(this,bi,[100*(d-i)/t,100*(f-r)/s]);const{style:g}=l(this,Ue);g.left=`${l(this,bi)[0]}%`,g.top=`${l(this,bi)[1]}%`},wf=function(){y(this,Si,!l(this,Si)),l(this,Si)?(A(this,Ae,xf).call(this),l(this,Ue).addEventListener("click",l(this,zl)),l(this,Ue).addEventListener("keydown",l(this,Ol))):(A(this,Ae,Iy).call(this),l(this,Ue).removeEventListener("click",l(this,zl)),l(this,Ue).removeEventListener("keydown",l(this,Ol)))},xf=function(){l(this,ls)||this.render(),this.isVisible?l(this,Si)&&l(this,Ue).classList.add("focused"):(A(this,Ae,lA).call(this),l(this,Ue).hidden=!1,l(this,Ue).style.zIndex=parseInt(l(this,Ue).style.zIndex)+1e3)},Iy=function(){l(this,Ue).classList.remove("focused"),!(l(this,Si)||!this.isVisible)&&(l(this,Ue).hidden=!0,l(this,Ue).style.zIndex=parseInt(l(this,Ue).style.zIndex)-1e3)};class cA extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Z.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var jh;class rN extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,jh,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:s,height:i}=Ur(t.rect),r=this.svgFactory.create(s,i,!0),a=y(this,jh,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,jh)}addHighlightArea(){this.container.classList.add("highlightArea")}}jh=new WeakMap;var Fh;class aN extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Fh,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:s,height:i}=Ur(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=y(this,Fh,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",s-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Fh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Fh=new WeakMap;var Oh;class oN extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Oh,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:s,height:i}=Ur(t.rect),r=this.svgFactory.create(s,i,!0),a=t.borderStyle.width,o=y(this,Oh,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",s/2),o.setAttribute("cy",i/2),o.setAttribute("rx",s/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,Oh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Oh=new WeakMap;var zh;class uA extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,zh,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:s,borderStyle:i,popupRef:r}}=this;if(!s)return this.container;const{width:a,height:o}=Ur(t),c=this.svgFactory.create(a,o,!0);let u=[];for(let d=0,f=s.length;d<f;d+=2){const g=s[d]-t[0],m=t[3]-s[d+1];u.push(`${g},${m}`)}u=u.join(" ");const h=y(this,zh,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",i.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),c.append(h),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return l(this,zh)}addHighlightArea(){this.container.classList.add("highlightArea")}}zh=new WeakMap;class lN extends uA{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class cN extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Bh,Va,Uh,Dy;class m0 extends Ge{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});b(this,Uh);b(this,Bh,null);b(this,Va,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Z.HIGHLIGHT:Z.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:s,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:o,width:c,height:u}=A(this,Uh,Dy).call(this,s,t),h=this.svgFactory.create(c,u,!0),d=y(this,Bh,this.svgFactory.createElement("svg:g"));h.append(d),d.setAttribute("stroke-width",r.width||1),d.setAttribute("stroke-linecap","round"),d.setAttribute("stroke-linejoin","round"),d.setAttribute("stroke-miterlimit",10),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),d.setAttribute("transform",o);for(let f=0,g=i.length;f<g;f++){const m=this.svgFactory.createElement(this.svgElementName);l(this,Va).push(m),m.setAttribute("points",i[f].join(",")),d.append(m)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:s,points:i,rect:r}=t,a=l(this,Bh);if(s>=0&&a.setAttribute("stroke-width",s||1),i)for(let o=0,c=l(this,Va).length;o<c;o++)l(this,Va)[o].setAttribute("points",i[o].join(","));if(r){const{transform:o,width:c,height:u}=A(this,Uh,Dy).call(this,this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return l(this,Va)}addHighlightArea(){this.container.classList.add("highlightArea")}}Bh=new WeakMap,Va=new WeakMap,Uh=new WeakSet,Dy=function(t,s){switch(t){case 90:return{transform:`rotate(90) translate(${-s[0]},${s[1]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};case 180:return{transform:`rotate(180) translate(${-s[2]},${s[1]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]};case 270:return{transform:`rotate(270) translate(${-s[2]},${s[3]}) scale(1,-1)`,width:s[3]-s[1],height:s[2]-s[0]};default:return{transform:`translate(${-s[0]},${s[3]}) scale(1,-1)`,width:s[2]-s[0],height:s[3]-s[1]}}};class hA extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Z.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class uN extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class hN extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class dN extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class dA extends Ge{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Z.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Hh,$h,jy;class fN extends Ge{constructor(t){var i;super(t,{isRenderable:!0});b(this,$h);b(this,Hh,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(i=this.linkService.eventBus)==null||i.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:s}=this;let i;s.hasAppearance||s.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(s.name)?"paperclip":"pushpin"}.svg`,s.fillAlpha&&s.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(s.fillAlpha*100)}%);`)),i.addEventListener("dblclick",A(this,$h,jy).bind(this)),y(this,Hh,i);const{isMac:r}=Xt.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&A(this,$h,jy).call(this)}),!s.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return l(this,Hh)}addHighlightArea(){this.container.classList.add("highlightArea")}}Hh=new WeakMap,$h=new WeakSet,jy=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Wh,Ga,Xa,Vh,_o,fA,Fy;class pN{constructor({div:e,accessibilityManager:t,annotationCanvasMap:s,annotationEditorUIManager:i,page:r,viewport:a,structTreeLayer:o}){b(this,_o);b(this,Wh,null);b(this,Ga,null);b(this,Xa,new Map);b(this,Vh,null);this.div=e,y(this,Wh,t),y(this,Ga,s),y(this,Vh,o||null),this.page=r,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i}hasEditableAnnotations(){return l(this,Xa).size>0}async render(e){var a;const{annotations:t}=e,s=this.div;xo(s,this.viewport);const i=new Map,r={data:null,layer:s,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new g0,annotationStorage:e.annotationStorage||new f0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const c=o.annotationType===Je.POPUP;if(c){const d=i.get(o.id);if(!d)continue;r.elements=d}else{const{width:d,height:f}=Ur(o.rect);if(d<=0||f<=0)continue}r.data=o;const u=QP.create(r);if(!u.isRenderable)continue;if(!c&&o.popupRef){const d=i.get(o.popupRef);d?d.push(u):i.set(o.popupRef,[u])}const h=u.render();o.hidden&&(h.style.visibility="hidden"),await A(this,_o,fA).call(this,h,o.id),u._isEditable&&(l(this,Xa).set(u.data.id,u),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(u))}A(this,_o,Fy).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,xo(t,{rotation:e.rotation}),A(this,_o,Fy).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(l(this,Xa).values())}getEditableAnnotation(e){return l(this,Xa).get(e)}}Wh=new WeakMap,Ga=new WeakMap,Xa=new WeakMap,Vh=new WeakMap,_o=new WeakSet,fA=async function(e,t){var a,o;const s=e.firstChild||e,i=s.id=`${l0}${t}`,r=await((a=l(this,Vh))==null?void 0:a.getAriaAttributes(i));if(r)for(const[c,u]of r)s.setAttribute(c,u);this.div.append(e),(o=l(this,Wh))==null||o.moveElementInDOM(this.div,e,s,!1)},Fy=function(){if(!l(this,Ga))return;const e=this.div;for(const[t,s]of l(this,Ga)){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:r}=i;r?r.nodeName==="CANVAS"?r.replaceWith(s):r.classList.contains("annotationContent")?r.after(s):r.before(s):i.append(s)}l(this,Ga).clear()};const Ud=/\r\n?|\n/g;var cs,mn,Gh,qa,yn,Qe,pA,gA,mA,Sf,ji,bf,Af,yA,zy,vA;const Ee=class Ee extends Fe{constructor(t){super({...t,name:"freeTextEditor"});b(this,Qe);b(this,cs);b(this,mn,"");b(this,Gh,`${this.id}-editor`);b(this,qa,null);b(this,yn);y(this,cs,t.color||Ee._defaultColor||Fe._defaultLineColor),y(this,yn,t.fontSize||Ee._defaultFontSize)}static get _keyboardManager(){const t=Ee.prototype,s=a=>a.isEmpty(),i=So.TRANSLATE_SMALL,r=So.TRANSLATE_BIG;return ie(this,"_keyboardManager",new vd([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:s}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:s}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:s}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:s}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:s}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:s}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:s}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:s}]]))}static initialize(t,s){Fe.initialize(t,s);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,s){switch(t){case le.FREETEXT_SIZE:Ee._defaultFontSize=s;break;case le.FREETEXT_COLOR:Ee._defaultColor=s;break}}updateParams(t,s){switch(t){case le.FREETEXT_SIZE:A(this,Qe,pA).call(this,s);break;case le.FREETEXT_COLOR:A(this,Qe,gA).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[le.FREETEXT_SIZE,Ee._defaultFontSize],[le.FREETEXT_COLOR,Ee._defaultColor||Fe._defaultLineColor]]}get propertiesToUpdate(){return[[le.FREETEXT_SIZE,l(this,yn)],[le.FREETEXT_COLOR,l(this,cs)]]}_translateEmpty(t,s){this._uiManager.translateSelectedEditors(t,s,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ee._internalPadding*t,-(Ee._internalPadding+l(this,yn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Z.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),y(this,qa,new AbortController);const t=this._uiManager.combinedSignal(l(this,qa));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",l(this,Gh)),this._isDraggable=!0,(t=l(this,qa))==null||t.abort(),y(this,qa,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var s;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(s=this._initialOptions)!=null&&s.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=l(this,mn),s=y(this,mn,A(this,Qe,mA).call(this).trimEnd());if(t===s)return;const i=r=>{if(y(this,mn,r),!r){this.remove();return}A(this,Qe,Af).call(this),this._uiManager.rebuild(this),A(this,Qe,Sf).call(this)};this.addCommands({cmd:()=>{i(s)},undo:()=>{i(t)},mustExec:!1}),A(this,Qe,Sf).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ee._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",l(this,Gh)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${l(this,yn)}px * var(--scale-factor))`,i.color=l(this,cs),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),lp(this,this.div,["dblclick","keydown"]),this.width){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[c,u]=this.getInitialTranslation();[c,u]=this.pageTranslationToScreen(c,u);const[h,d]=this.pageDimensions,[f,g]=this.pageTranslation;let m,w;switch(this.rotation){case 0:m=t+(o[0]-f)/h,w=s+this.height-(o[1]-g)/d;break;case 90:m=t+(o[0]-f)/h,w=s-(o[1]-g)/d,[c,u]=[u,-c];break;case 180:m=t-this.width+(o[0]-f)/h,w=s-(o[1]-g)/d,[c,u]=[-c,-u];break;case 270:m=t+(o[0]-f-this.height*d)/h,w=s+(o[1]-g-this.width*h)/d,[c,u]=[-u,c];break}this.setAt(m*r,w*a,c,u)}else this.setAt(t*r,s*a,this.width*r,this.height*a);A(this,Qe,Af).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var m,w,_;const s=t.clipboardData||window.clipboardData,{types:i}=s;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=A(m=Ee,ji,zy).call(m,s.getData("text")||"").replaceAll(Ud,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!r.includes(`
`)){o.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:u}=o,h=[],d=[];if(c.nodeType===Node.TEXT_NODE){const v=c.parentElement;if(d.push(c.nodeValue.slice(u).replaceAll(Ud,"")),v!==this.editorDiv){let x=h;for(const S of this.editorDiv.childNodes){if(S===v){x=d;continue}x.push(A(w=Ee,ji,bf).call(w,S))}}h.push(c.nodeValue.slice(0,u).replaceAll(Ud,""))}else if(c===this.editorDiv){let v=h,x=0;for(const S of this.editorDiv.childNodes)x++===u&&(v=d),v.push(A(_=Ee,ji,bf).call(_,S))}y(this,mn,`${h.join(`
`)}${r}${d.join(`
`)}`),A(this,Qe,Af).call(this);const f=new Range;let g=h.reduce((v,x)=>v+x.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const x=v.nodeValue.length;if(g<=x){f.setStart(v,g),f.setEnd(v,g);break}g-=x}a.removeAllRanges(),a.addRange(f)}get contentDiv(){return this.editorDiv}static async deserialize(t,s,i){var o;let r=null;if(t instanceof cA){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:h,rotation:d,id:f,popupRef:g},textContent:m,textPosition:w,parent:{page:{pageNumber:_}}}=t;if(!m||m.length===0)return null;r=t={annotationType:Z.FREETEXT,color:Array.from(u),fontSize:c,value:m.join(`
`),position:w,pageIndex:_-1,rect:h.slice(0),rotation:d,id:f,deleted:!1,popupRef:g}}const a=await super.deserialize(t,s,i);return y(a,yn,t.fontSize),y(a,cs,G.makeHexColor(...t.color)),y(a,mn,A(o=Ee,ji,zy).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=r,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Ee._internalPadding*this.parentScale,i=this.getRect(s,s),r=Fe._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:l(this,cs)),a={annotationType:Z.FREETEXT,color:r,fontSize:l(this,yn),value:A(this,Qe,yA).call(this),pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!A(this,Qe,vA).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const s=super.renderAnnotationElement(t);if(this.deleted)return s;const{style:i}=s;i.fontSize=`calc(${l(this,yn)}px * var(--scale-factor))`,i.color=l(this,cs),s.replaceChildren();for(const a of l(this,mn).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),s.append(o)}const r=Ee._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:l(this,mn)}),s}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};cs=new WeakMap,mn=new WeakMap,Gh=new WeakMap,qa=new WeakMap,yn=new WeakMap,Qe=new WeakSet,pA=function(t){const s=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-l(this,yn))*this.parentScale),y(this,yn,r),A(this,Qe,Sf).call(this)},i=l(this,yn);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:le.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},gA=function(t){const s=r=>{y(this,cs,this.editorDiv.style.color=r)},i=l(this,cs);this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:le.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},mA=function(){var i;const t=[];this.editorDiv.normalize();let s=null;for(const r of this.editorDiv.childNodes)(s==null?void 0:s.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(A(i=Ee,ji,bf).call(i,r)),s=r);return t.join(`
`)},Sf=function(){const[t,s]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,o=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/s):(this.width=i.height/t,this.height=i.width/s),this.fixAndSetPosition()},ji=new WeakSet,bf=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Ud,"")},Af=function(){if(this.editorDiv.replaceChildren(),!!l(this,mn))for(const t of l(this,mn).split(`
`)){const s=document.createElement("div");s.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(s)}},yA=function(){return l(this,mn).replaceAll(""," ")},zy=function(t){return t.replaceAll(" ","")},vA=function(t){const{value:s,fontSize:i,color:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==s||t.fontSize!==i||t.color.some((o,c)=>o!==r[c])||t.pageIndex!==a},b(Ee,ji),X(Ee,"_freeTextDefaultContent",""),X(Ee,"_internalPadding",0),X(Ee,"_defaultColor",null),X(Ee,"_defaultFontSize",10),X(Ee,"_type","freetext"),X(Ee,"_editorType",Z.FREETEXT);let Oy=Ee;class H{toSVGPath(){_e("Abstract method `toSVGPath` must be implemented.")}get box(){_e("Abstract getter `box` must be implemented.")}serialize(e,t){_e("Abstract method `serialize` must be implemented.")}static _rescale(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o]*i,a[o+1]=s+e[o+1]*r;return a}static _rescaleAndSwap(e,t,s,i,r,a){a||(a=new Float32Array(e.length));for(let o=0,c=e.length;o<c;o+=2)a[o]=t+e[o+1]*i,a[o+1]=s+e[o]*r;return a}static _translate(e,t,s,i){i||(i=new Float32Array(e.length));for(let r=0,a=e.length;r<a;r+=2)i[r]=t+e[r],i[r+1]=s+e[r+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,s,i,r){switch(r){case 90:return[1-t/s,e/i];case 180:return[1-e/s,1-t/i];case 270:return[t/s,1-e/i];default:return[e/s,t/i]}}static _normalizePagePoint(e,t,s){switch(s){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,s,i,r,a){return[(e+5*s)/6,(t+5*i)/6,(5*s+r)/6,(5*i+a)/6,(s+r)/2,(i+a)/2]}}X(H,"PRECISION",1e-4);var vn,us,Hl,$l,Bs,se,Ya,Ka,Xh,qh,Wl,Vl,vr,Yh,Np,Rp,it,tu,wA,xA,SA,bA,AA,_A;const ii=class ii{constructor({x:e,y:t},s,i,r,a,o=0){b(this,it);b(this,vn);b(this,us,[]);b(this,Hl);b(this,$l);b(this,Bs,[]);b(this,se,new Float32Array(18));b(this,Ya);b(this,Ka);b(this,Xh);b(this,qh);b(this,Wl);b(this,Vl);b(this,vr,[]);y(this,vn,s),y(this,Vl,r*i),y(this,$l,a),l(this,se).set([NaN,NaN,NaN,NaN,e,t],6),y(this,Hl,o),y(this,qh,l(ii,Yh)*i),y(this,Xh,l(ii,Rp)*i),y(this,Wl,i),l(this,vr).push(e,t)}isEmpty(){return isNaN(l(this,se)[8])}add({x:e,y:t}){var R;y(this,Ya,e),y(this,Ka,t);const[s,i,r,a]=l(this,vn);let[o,c,u,h]=l(this,se).subarray(8,12);const d=e-u,f=t-h,g=Math.hypot(d,f);if(g<l(this,Xh))return!1;const m=g-l(this,qh),w=m/g,_=w*d,v=w*f;let x=o,S=c;o=u,c=h,u+=_,h+=v,(R=l(this,vr))==null||R.push(e,t);const E=-v/m,C=_/m,k=E*l(this,Vl),P=C*l(this,Vl);return l(this,se).set(l(this,se).subarray(2,8),0),l(this,se).set([u+k,h+P],4),l(this,se).set(l(this,se).subarray(14,18),12),l(this,se).set([u-k,h-P],16),isNaN(l(this,se)[6])?(l(this,Bs).length===0&&(l(this,se).set([o+k,c+P],2),l(this,Bs).push(NaN,NaN,NaN,NaN,(o+k-s)/r,(c+P-i)/a),l(this,se).set([o-k,c-P],14),l(this,us).push(NaN,NaN,NaN,NaN,(o-k-s)/r,(c-P-i)/a)),l(this,se).set([x,S,o,c,u,h],6),!this.isEmpty()):(l(this,se).set([x,S,o,c,u,h],6),Math.abs(Math.atan2(S-c,x-o)-Math.atan2(v,_))<Math.PI/2?([o,c,u,h]=l(this,se).subarray(2,6),l(this,Bs).push(NaN,NaN,NaN,NaN,((o+u)/2-s)/r,((c+h)/2-i)/a),[o,c,x,S]=l(this,se).subarray(14,18),l(this,us).push(NaN,NaN,NaN,NaN,((x+o)/2-s)/r,((S+c)/2-i)/a),!0):([x,S,o,c,u,h]=l(this,se).subarray(0,6),l(this,Bs).push(((x+5*o)/6-s)/r,((S+5*c)/6-i)/a,((5*o+u)/6-s)/r,((5*c+h)/6-i)/a,((o+u)/2-s)/r,((c+h)/2-i)/a),[u,h,o,c,x,S]=l(this,se).subarray(12,18),l(this,us).push(((x+5*o)/6-s)/r,((S+5*c)/6-i)/a,((5*o+u)/6-s)/r,((5*c+h)/6-i)/a,((o+u)/2-s)/r,((c+h)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=l(this,Bs),t=l(this,us);if(isNaN(l(this,se)[6])&&!this.isEmpty())return A(this,it,wA).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?s.push(`L${e[i+4]} ${e[i+5]}`):s.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);A(this,it,SA).call(this,s);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?s.push(`L${t[i+4]} ${t[i+5]}`):s.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return A(this,it,xA).call(this,s),s.join(" ")}newFreeDrawOutline(e,t,s,i,r,a){return new EA(e,t,s,i,r,a)}getOutlines(){var d;const e=l(this,Bs),t=l(this,us),s=l(this,se),[i,r,a,o]=l(this,vn),c=new Float32Array((((d=l(this,vr))==null?void 0:d.length)??0)+2);for(let f=0,g=c.length-2;f<g;f+=2)c[f]=(l(this,vr)[f]-i)/a,c[f+1]=(l(this,vr)[f+1]-r)/o;if(c[c.length-2]=(l(this,Ya)-i)/a,c[c.length-1]=(l(this,Ka)-r)/o,isNaN(s[6])&&!this.isEmpty())return A(this,it,bA).call(this,c);const u=new Float32Array(l(this,Bs).length+24+l(this,us).length);let h=e.length;for(let f=0;f<h;f+=2){if(isNaN(e[f])){u[f]=u[f+1]=NaN;continue}u[f]=e[f],u[f+1]=e[f+1]}h=A(this,it,_A).call(this,u,h);for(let f=t.length-6;f>=6;f-=6)for(let g=0;g<6;g+=2){if(isNaN(t[f+g])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[f+g],u[h+1]=t[f+g+1],h+=2}return A(this,it,AA).call(this,u,h),this.newFreeDrawOutline(u,c,l(this,vn),l(this,Wl),l(this,Hl),l(this,$l))}};vn=new WeakMap,us=new WeakMap,Hl=new WeakMap,$l=new WeakMap,Bs=new WeakMap,se=new WeakMap,Ya=new WeakMap,Ka=new WeakMap,Xh=new WeakMap,qh=new WeakMap,Wl=new WeakMap,Vl=new WeakMap,vr=new WeakMap,Yh=new WeakMap,Np=new WeakMap,Rp=new WeakMap,it=new WeakSet,tu=function(){const e=l(this,se).subarray(4,6),t=l(this,se).subarray(16,18),[s,i,r,a]=l(this,vn);return[(l(this,Ya)+(e[0]-t[0])/2-s)/r,(l(this,Ka)+(e[1]-t[1])/2-i)/a,(l(this,Ya)+(t[0]-e[0])/2-s)/r,(l(this,Ka)+(t[1]-e[1])/2-i)/a]},wA=function(){const[e,t,s,i]=l(this,vn),[r,a,o,c]=A(this,it,tu).call(this);return`M${(l(this,se)[2]-e)/s} ${(l(this,se)[3]-t)/i} L${(l(this,se)[4]-e)/s} ${(l(this,se)[5]-t)/i} L${r} ${a} L${o} ${c} L${(l(this,se)[16]-e)/s} ${(l(this,se)[17]-t)/i} L${(l(this,se)[14]-e)/s} ${(l(this,se)[15]-t)/i} Z`},xA=function(e){const t=l(this,us);e.push(`L${t[4]} ${t[5]} Z`)},SA=function(e){const[t,s,i,r]=l(this,vn),a=l(this,se).subarray(4,6),o=l(this,se).subarray(16,18),[c,u,h,d]=A(this,it,tu).call(this);e.push(`L${(a[0]-t)/i} ${(a[1]-s)/r} L${c} ${u} L${h} ${d} L${(o[0]-t)/i} ${(o[1]-s)/r}`)},bA=function(e){const t=l(this,se),[s,i,r,a]=l(this,vn),[o,c,u,h]=A(this,it,tu).call(this),d=new Float32Array(36);return d.set([NaN,NaN,NaN,NaN,(t[2]-s)/r,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-s)/r,(t[5]-i)/a,NaN,NaN,NaN,NaN,o,c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-s)/r,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-s)/r,(t[15]-i)/a],0),this.newFreeDrawOutline(d,e,l(this,vn),l(this,Wl),l(this,Hl),l(this,$l))},AA=function(e,t){const s=l(this,us);return e.set([NaN,NaN,NaN,NaN,s[4],s[5]],t),t+=6},_A=function(e,t){const s=l(this,se).subarray(4,6),i=l(this,se).subarray(16,18),[r,a,o,c]=l(this,vn),[u,h,d,f]=A(this,it,tu).call(this);return e.set([NaN,NaN,NaN,NaN,(s[0]-r)/o,(s[1]-a)/c,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(i[0]-r)/o,(i[1]-a)/c],t),t+=24},b(ii,Yh,8),b(ii,Np,2),b(ii,Rp,l(ii,Yh)+l(ii,Np));let hp=ii;var Gl,Qa,_i,Kh,wn,Qh,We,Mp,CA;class EA extends H{constructor(t,s,i,r,a,o){super();b(this,Mp);b(this,Gl);b(this,Qa,new Float32Array(4));b(this,_i);b(this,Kh);b(this,wn);b(this,Qh);b(this,We);y(this,We,t),y(this,wn,s),y(this,Gl,i),y(this,Qh,r),y(this,_i,a),y(this,Kh,o),this.lastPoint=[NaN,NaN],A(this,Mp,CA).call(this,o);const[c,u,h,d]=l(this,Qa);for(let f=0,g=t.length;f<g;f+=2)t[f]=(t[f]-c)/h,t[f+1]=(t[f+1]-u)/d;for(let f=0,g=s.length;f<g;f+=2)s[f]=(s[f]-c)/h,s[f+1]=(s[f+1]-u)/d}toSVGPath(){const t=[`M${l(this,We)[4]} ${l(this,We)[5]}`];for(let s=6,i=l(this,We).length;s<i;s+=6){if(isNaN(l(this,We)[s])){t.push(`L${l(this,We)[s+4]} ${l(this,We)[s+5]}`);continue}t.push(`C${l(this,We)[s]} ${l(this,We)[s+1]} ${l(this,We)[s+2]} ${l(this,We)[s+3]} ${l(this,We)[s+4]} ${l(this,We)[s+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,s,i,r],a){const o=i-t,c=r-s;let u,h;switch(a){case 0:u=H._rescale(l(this,We),t,r,o,-c),h=H._rescale(l(this,wn),t,r,o,-c);break;case 90:u=H._rescaleAndSwap(l(this,We),t,s,o,c),h=H._rescaleAndSwap(l(this,wn),t,s,o,c);break;case 180:u=H._rescale(l(this,We),i,s,-o,c),h=H._rescale(l(this,wn),i,s,-o,c);break;case 270:u=H._rescaleAndSwap(l(this,We),i,r,-o,-c),h=H._rescaleAndSwap(l(this,wn),i,r,-o,-c);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return l(this,Qa)}newOutliner(t,s,i,r,a,o=0){return new hp(t,s,i,r,a,o)}getNewOutline(t,s){const[i,r,a,o]=l(this,Qa),[c,u,h,d]=l(this,Gl),f=a*h,g=o*d,m=i*h+c,w=r*d+u,_=this.newOutliner({x:l(this,wn)[0]*f+m,y:l(this,wn)[1]*g+w},l(this,Gl),l(this,Qh),t,l(this,Kh),s??l(this,_i));for(let v=2;v<l(this,wn).length;v+=2)_.add({x:l(this,wn)[v]*f+m,y:l(this,wn)[v+1]*g+w});return _.getOutlines()}}Gl=new WeakMap,Qa=new WeakMap,_i=new WeakMap,Kh=new WeakMap,wn=new WeakMap,Qh=new WeakMap,We=new WeakMap,Mp=new WeakSet,CA=function(t){const s=l(this,We);let i=s[4],r=s[5],a=i,o=r,c=i,u=r,h=i,d=r;const f=t?Math.max:Math.min;for(let m=6,w=s.length;m<w;m+=6){if(isNaN(s[m]))a=Math.min(a,s[m+4]),o=Math.min(o,s[m+5]),c=Math.max(c,s[m+4]),u=Math.max(u,s[m+5]),d<s[m+5]?(h=s[m+4],d=s[m+5]):d===s[m+5]&&(h=f(h,s[m+4]));else{const _=G.bezierBoundingBox(i,r,...s.slice(m,m+6));a=Math.min(a,_[0]),o=Math.min(o,_[1]),c=Math.max(c,_[2]),u=Math.max(u,_[3]),d<_[3]?(h=_[2],d=_[3]):d===_[3]&&(h=f(h,_[2]))}i=s[m+4],r=s[m+5]}const g=l(this,Qa);g[0]=a-l(this,_i),g[1]=o-l(this,_i),g[2]=c-a+2*l(this,_i),g[3]=u-o+2*l(this,_i),this.lastPoint=[h,d]};var Jh,Zh,wr,hs,Yt,kA,_f,TA,PA,Uy;class By{constructor(e,t=0,s=0,i=!0){b(this,Yt);b(this,Jh);b(this,Zh);b(this,wr,[]);b(this,hs,[]);let r=1/0,a=-1/0,o=1/0,c=-1/0;const u=10**-4;for(const{x:_,y:v,width:x,height:S}of e){const E=Math.floor((_-t)/u)*u,C=Math.ceil((_+x+t)/u)*u,k=Math.floor((v-t)/u)*u,P=Math.ceil((v+S+t)/u)*u,N=[E,k,P,!0],R=[C,k,P,!1];l(this,wr).push(N,R),r=Math.min(r,E),a=Math.max(a,C),o=Math.min(o,k),c=Math.max(c,P)}const h=a-r+2*s,d=c-o+2*s,f=r-s,g=o-s,m=l(this,wr).at(i?-1:-2),w=[m[0],m[2]];for(const _ of l(this,wr)){const[v,x,S]=_;_[0]=(v-f)/h,_[1]=(x-g)/d,_[2]=(S-g)/d}y(this,Jh,new Float32Array([f,g,h,d])),y(this,Zh,w)}getOutlines(){l(this,wr).sort((t,s)=>t[0]-s[0]||t[1]-s[1]||t[2]-s[2]);const e=[];for(const t of l(this,wr))t[3]?(e.push(...A(this,Yt,Uy).call(this,t)),A(this,Yt,TA).call(this,t)):(A(this,Yt,PA).call(this,t),e.push(...A(this,Yt,Uy).call(this,t)));return A(this,Yt,kA).call(this,e)}}Jh=new WeakMap,Zh=new WeakMap,wr=new WeakMap,hs=new WeakMap,Yt=new WeakSet,kA=function(e){const t=[],s=new Set;for(const a of e){const[o,c,u]=a;t.push([o,c,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const c=t[a][2],u=t[a+1][2];c.push(u),u.push(c),s.add(c),s.add(u)}const i=[];let r;for(;s.size>0;){const a=s.values().next().value;let[o,c,u,h,d]=a;s.delete(a);let f=o,g=c;for(r=[o,u],i.push(r);;){let m;if(s.has(h))m=h;else if(s.has(d))m=d;else break;s.delete(m),[o,c,u,h,d]=m,f!==o&&(r.push(f,g,o,g===c?c:u),f=o),g=g===c?u:c}r.push(f,g)}return new gN(i,l(this,Jh),l(this,Zh))},_f=function(e){const t=l(this,hs);let s=0,i=t.length-1;for(;s<=i;){const r=s+i>>1,a=t[r][0];if(a===e)return r;a<e?s=r+1:i=r-1}return i+1},TA=function([,e,t]){const s=A(this,Yt,_f).call(this,e);l(this,hs).splice(s,0,[e,t])},PA=function([,e,t]){const s=A(this,Yt,_f).call(this,e);for(let i=s;i<l(this,hs).length;i++){const[r,a]=l(this,hs)[i];if(r!==e)break;if(r===e&&a===t){l(this,hs).splice(i,1);return}}for(let i=s-1;i>=0;i--){const[r,a]=l(this,hs)[i];if(r!==e)break;if(r===e&&a===t){l(this,hs).splice(i,1);return}}},Uy=function(e){const[t,s,i]=e,r=[[t,s,i]],a=A(this,Yt,_f).call(this,i);for(let o=0;o<a;o++){const[c,u]=l(this,hs)[o];for(let h=0,d=r.length;h<d;h++){const[,f,g]=r[h];if(!(u<=f||g<=c)){if(f>=c){if(g>u)r[h][1]=u;else{if(d===1)return[];r.splice(h,1),h--,d--}continue}r[h][2]=c,g>u&&r.push([t,u,g])}}}return r};var ed,Xl;class gN extends H{constructor(t,s,i){super();b(this,ed);b(this,Xl);y(this,Xl,t),y(this,ed,s),this.lastPoint=i}toSVGPath(){const t=[];for(const s of l(this,Xl)){let[i,r]=s;t.push(`M${i} ${r}`);for(let a=2;a<s.length;a+=2){const o=s[a],c=s[a+1];o===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,s,i,r],a){const o=[],c=i-t,u=r-s;for(const h of l(this,Xl)){const d=new Array(h.length);for(let f=0;f<h.length;f+=2)d[f]=t+h[f]*c,d[f+1]=r-h[f+1]*u;o.push(d)}return o}get box(){return l(this,ed)}get classNamesForOutlining(){return["highlightOutline"]}}ed=new WeakMap,Xl=new WeakMap;class Hy extends hp{newFreeDrawOutline(e,t,s,i,r,a){return new mN(e,t,s,i,r,a)}}class mN extends EA{newOutliner(e,t,s,i,r,a=0){return new Hy(e,t,s,i,r,a)}}var ds,Ja,ql,tt,td,Yl,nd,sd,xr,fs,Kl,id,be,$y,Wy,Vy,ea,NA,Xi;const tn=class tn{constructor({editor:e=null,uiManager:t=null}){b(this,be);b(this,ds,null);b(this,Ja,null);b(this,ql);b(this,tt,null);b(this,td,!1);b(this,Yl,!1);b(this,nd,null);b(this,sd);b(this,xr,null);b(this,fs,null);b(this,Kl);var s;e?(y(this,Yl,!1),y(this,Kl,le.HIGHLIGHT_COLOR),y(this,nd,e)):(y(this,Yl,!0),y(this,Kl,le.HIGHLIGHT_DEFAULT_COLOR)),y(this,fs,(e==null?void 0:e._uiManager)||t),y(this,sd,l(this,fs)._eventBus),y(this,ql,(e==null?void 0:e.color)||((s=l(this,fs))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),l(tn,id)||y(tn,id,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ie(this,"_keyboardManager",new vd([[["Escape","mac+Escape"],tn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],tn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],tn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],tn.prototype._moveToPrevious],[["Home","mac+Home"],tn.prototype._moveToBeginning],[["End","mac+End"],tn.prototype._moveToEnd]]))}renderButton(){const e=y(this,ds,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=l(this,fs)._signal;e.addEventListener("click",A(this,be,ea).bind(this),{signal:t}),e.addEventListener("keydown",A(this,be,Vy).bind(this),{signal:t});const s=y(this,Ja,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=l(this,ql),e.append(s),e}renderMainDropdown(){const e=y(this,tt,A(this,be,$y).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===l(this,ds)){A(this,be,ea).call(this,e);return}const t=e.target.getAttribute("data-color");t&&A(this,be,Wy).call(this,t,e)}_moveToNext(e){var t,s;if(!l(this,be,Xi)){A(this,be,ea).call(this,e);return}if(e.target===l(this,ds)){(t=l(this,tt).firstChild)==null||t.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var t,s;if(e.target===((t=l(this,tt))==null?void 0:t.firstChild)||e.target===l(this,ds)){l(this,be,Xi)&&this._hideDropdownFromKeyboard();return}l(this,be,Xi)||A(this,be,ea).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var t;if(!l(this,be,Xi)){A(this,be,ea).call(this,e);return}(t=l(this,tt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!l(this,be,Xi)){A(this,be,ea).call(this,e);return}(t=l(this,tt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=l(this,tt))==null||e.classList.add("hidden"),(t=l(this,xr))==null||t.abort(),y(this,xr,null)}_hideDropdownFromKeyboard(){var e;if(!l(this,Yl)){if(!l(this,be,Xi)){(e=l(this,nd))==null||e.unselect();return}this.hideDropdown(),l(this,ds).focus({preventScroll:!0,focusVisible:l(this,td)})}}updateColor(e){if(l(this,Ja)&&(l(this,Ja).style.backgroundColor=e),!l(this,tt))return;const t=l(this,fs).highlightColors.values();for(const s of l(this,tt).children)s.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=l(this,ds))==null||e.remove(),y(this,ds,null),y(this,Ja,null),(t=l(this,tt))==null||t.remove(),y(this,tt,null)}};ds=new WeakMap,Ja=new WeakMap,ql=new WeakMap,tt=new WeakMap,td=new WeakMap,Yl=new WeakMap,nd=new WeakMap,sd=new WeakMap,xr=new WeakMap,fs=new WeakMap,Kl=new WeakMap,id=new WeakMap,be=new WeakSet,$y=function(){const e=document.createElement("div"),t=l(this,fs)._signal;e.addEventListener("contextmenu",bs,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,i]of l(this,fs).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",i),r.title=s,r.setAttribute("data-l10n-id",l(tn,id)[s]);const a=document.createElement("span");r.append(a),a.className="swatch",a.style.backgroundColor=i,r.setAttribute("aria-selected",i===l(this,ql)),r.addEventListener("click",A(this,be,Wy).bind(this,i),{signal:t}),e.append(r)}return e.addEventListener("keydown",A(this,be,Vy).bind(this),{signal:t}),e},Wy=function(e,t){t.stopPropagation(),l(this,sd).dispatch("switchannotationeditorparams",{source:this,type:l(this,Kl),value:e})},Vy=function(e){tn._keyboardManager.exec(this,e)},ea=function(e){if(l(this,be,Xi)){this.hideDropdown();return}if(y(this,td,e.detail===0),l(this,xr)||(y(this,xr,new AbortController),window.addEventListener("pointerdown",A(this,be,NA).bind(this),{signal:l(this,fs).combinedSignal(l(this,xr))})),l(this,tt)){l(this,tt).classList.remove("hidden");return}const t=y(this,tt,A(this,be,$y).call(this));l(this,ds).append(t)},NA=function(e){var t;(t=l(this,tt))!=null&&t.contains(e.target)||this.hideDropdown()},Xi=function(){return l(this,tt)&&!l(this,tt).classList.contains("hidden")},b(tn,id,null);let dp=tn;var Ql,rd,Ei,Za,Jl,rn,ad,od,eo,On,xn,mt,Zl,Ci,Rt,ec,zn,ld,Q,Gy,Ef,RA,MA,LA,Xy,ta,Vn,Fo,IA,Cf,nu,DA,jA,FA,OA,zA;const me=class me extends Fe{constructor(t){super({...t,name:"highlightEditor"});b(this,Q);b(this,Ql,null);b(this,rd,0);b(this,Ei);b(this,Za,null);b(this,Jl,null);b(this,rn,null);b(this,ad,null);b(this,od,0);b(this,eo,null);b(this,On,null);b(this,xn,null);b(this,mt,!1);b(this,Zl,null);b(this,Ci);b(this,Rt,null);b(this,ec,"");b(this,zn);b(this,ld,"");this.color=t.color||me._defaultColor,y(this,zn,t.thickness||me._defaultThickness),y(this,Ci,t.opacity||me._defaultOpacity),y(this,Ei,t.boxes||null),y(this,ld,t.methodOfCreation||""),y(this,ec,t.text||""),this._isDraggable=!1,t.highlightId>-1?(y(this,mt,!0),A(this,Q,Ef).call(this,t),A(this,Q,ta).call(this)):l(this,Ei)&&(y(this,Ql,t.anchorNode),y(this,rd,t.anchorOffset),y(this,ad,t.focusNode),y(this,od,t.focusOffset),A(this,Q,Gy).call(this),A(this,Q,ta).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=me.prototype;return ie(this,"_keyboardManager",new vd([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:l(this,mt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:l(this,zn),methodOfCreation:l(this,ld)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,s){var i;Fe.initialize(t,s),me._defaultColor||(me._defaultColor=((i=s.highlightColors)==null?void 0:i.values().next().value)||"#fff066")}static updateDefaultParams(t,s){switch(t){case le.HIGHLIGHT_DEFAULT_COLOR:me._defaultColor=s;break;case le.HIGHLIGHT_THICKNESS:me._defaultThickness=s;break}}translateInPage(t,s){}get toolbarPosition(){return l(this,Zl)}updateParams(t,s){switch(t){case le.HIGHLIGHT_COLOR:A(this,Q,RA).call(this,s);break;case le.HIGHLIGHT_THICKNESS:A(this,Q,MA).call(this,s);break}}static get defaultPropertiesToUpdate(){return[[le.HIGHLIGHT_DEFAULT_COLOR,me._defaultColor],[le.HIGHLIGHT_THICKNESS,me._defaultThickness]]}get propertiesToUpdate(){return[[le.HIGHLIGHT_COLOR,this.color||me._defaultColor],[le.HIGHLIGHT_THICKNESS,l(this,zn)||me._defaultThickness],[le.HIGHLIGHT_FREE,l(this,mt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(y(this,Jl,new dp({editor:this})),t.addColorPicker(l(this,Jl))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,Q,nu).call(this))}getBaseTranslation(){return[0,0]}getRect(t,s){return super.getRect(t,s,A(this,Q,nu).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){A(this,Q,Xy).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,Q,ta).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?A(this,Q,Xy).call(this):t&&(A(this,Q,ta).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),s&&this.select()}rotate(t){var r,a,o;const{drawLayer:s}=this.parent;let i;l(this,mt)?(t=(t-this.rotation+360)%360,i=A(r=me,Vn,Fo).call(r,l(this,On).box,t)):i=A(a=me,Vn,Fo).call(a,[this.x,this.y,this.width,this.height],t),s.updateProperties(l(this,xn),{bbox:i,root:{"data-main-rotation":t}}),s.updateProperties(l(this,Rt),{bbox:A(o=me,Vn,Fo).call(o,l(this,rn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();l(this,ec)&&(t.setAttribute("aria-label",l(this,ec)),t.setAttribute("role","mark")),l(this,mt)?t.classList.add("free"):this.div.addEventListener("keydown",A(this,Q,IA).bind(this),{signal:this._uiManager._signal});const s=y(this,eo,document.createElement("div"));t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",s.style.clipPath=l(this,Za);const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),lp(this,l(this,eo),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Rt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(l(this,Rt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:A(this,Q,Cf).call(this,!0);break;case 1:case 3:A(this,Q,Cf).call(this,!1);break}}select(){var t;super.select(),l(this,Rt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Rt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),l(this,Rt)&&((t=this.parent)==null||t.drawLayer.updateProperties(l(this,Rt),{rootClass:{selected:!1}}),l(this,mt)||A(this,Q,Cf).call(this,!1))}get _mustFixPosition(){return!l(this,mt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(l(this,xn),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(l(this,Rt),{rootClass:{hidden:!t}}))}static startHighlighting(t,s,{target:i,x:r,y:a}){const{x:o,y:c,width:u,height:h}=i.getBoundingClientRect(),d=new AbortController,f=t.combinedSignal(d),g=m=>{d.abort(),A(this,Vn,OA).call(this,t,m)};window.addEventListener("blur",g,{signal:f}),window.addEventListener("pointerup",g,{signal:f}),window.addEventListener("pointerdown",kn,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",bs,{signal:f}),i.addEventListener("pointermove",A(this,Vn,FA).bind(this,t),{signal:f}),this._freeHighlight=new Hy({x:r,y:a},[o,c,u,h],t.scale,this._defaultThickness/2,s,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,s,i){var w,_,v,x;let r=null;if(t instanceof hA){const{data:{quadPoints:S,rect:E,rotation:C,id:k,color:P,opacity:N,popupRef:R},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:Z.HIGHLIGHT,color:Array.from(P),opacity:N,quadPoints:S,boxes:null,pageIndex:D-1,rect:E.slice(0),rotation:C,id:k,deleted:!1,popupRef:R}}else if(t instanceof m0){const{data:{inkLists:S,rect:E,rotation:C,id:k,color:P,borderStyle:{rawWidth:N},popupRef:R},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:Z.HIGHLIGHT,color:Array.from(P),thickness:N,inkLists:S,boxes:null,pageIndex:D-1,rect:E.slice(0),rotation:C,id:k,deleted:!1,popupRef:R}}const{color:a,quadPoints:o,inkLists:c,opacity:u}=t,h=await super.deserialize(t,s,i);h.color=G.makeHexColor(...a),y(h,Ci,u||1),c&&y(h,zn,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[d,f]=h.pageDimensions,[g,m]=h.pageTranslation;if(o){const S=y(h,Ei,[]);for(let E=0;E<o.length;E+=8)S.push({x:(o[E]-g)/d,y:1-(o[E+1]-m)/f,width:(o[E+2]-o[E])/d,height:(o[E+1]-o[E+5])/f});A(w=h,Q,Gy).call(w),A(_=h,Q,ta).call(_),h.rotate(h.rotation)}else if(c){y(h,mt,!0);const S=c[0],E={x:S[0]-g,y:f-(S[1]-m)},C=new Hy(E,[0,0,d,f],1,l(h,zn)/2,!0,.001);for(let N=0,R=S.length;N<R;N+=2)E.x=S[N]-g,E.y=f-(S[N+1]-m),C.add(E);const{id:k,clipPathId:P}=s.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);A(v=h,Q,Ef).call(v,{highlightOutlines:C.getOutlines(),highlightId:k,clipPathId:P}),A(x=h,Q,ta).call(x)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const s=this.getRect(0,0),i=Fe._colorManager.convert(this.color),r={annotationType:Z.HIGHLIGHT,color:i,opacity:l(this,Ci),thickness:l(this,zn),quadPoints:A(this,Q,DA).call(this),outlines:A(this,Q,jA).call(this,s),pageIndex:this.pageIndex,rect:s,rotation:A(this,Q,nu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!A(this,Q,zA).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Ql=new WeakMap,rd=new WeakMap,Ei=new WeakMap,Za=new WeakMap,Jl=new WeakMap,rn=new WeakMap,ad=new WeakMap,od=new WeakMap,eo=new WeakMap,On=new WeakMap,xn=new WeakMap,mt=new WeakMap,Zl=new WeakMap,Ci=new WeakMap,Rt=new WeakMap,ec=new WeakMap,zn=new WeakMap,ld=new WeakMap,Q=new WeakSet,Gy=function(){const t=new By(l(this,Ei),.001);y(this,On,t.getOutlines()),[this.x,this.y,this.width,this.height]=l(this,On).box;const s=new By(l(this,Ei),.0025,.001,this._uiManager.direction==="ltr");y(this,rn,s.getOutlines());const{lastPoint:i}=l(this,rn);y(this,Zl,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Ef=function({highlightOutlines:t,highlightId:s,clipPathId:i}){var d,f;if(y(this,On,t),y(this,rn,t.getNewOutline(l(this,zn)/2+1.5,.0025)),s>=0)y(this,xn,s),y(this,Za,i),this.parent.drawLayer.finalizeDraw(s,{bbox:t.box,path:{d:t.toSVGPath()}}),y(this,Rt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:l(this,rn).box,path:{d:l(this,rn).toSVGPath()}},!0));else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(l(this,xn),{bbox:A(d=me,Vn,Fo).call(d,l(this,On).box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(l(this,Rt),{bbox:A(f=me,Vn,Fo).call(f,l(this,rn).box,g),path:{d:l(this,rn).toSVGPath()}})}const[a,o,c,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=c,this.height=u;break;case 90:{const[g,m]=this.parentDimensions;this.x=o,this.y=1-a,this.width=c*m/g,this.height=u*g/m;break}case 180:this.x=1-a,this.y=1-o,this.width=c,this.height=u;break;case 270:{const[g,m]=this.parentDimensions;this.x=1-o,this.y=a,this.width=c*m/g,this.height=u*g/m;break}}const{lastPoint:h}=l(this,rn);y(this,Zl,[(h[0]-a)/c,(h[1]-o)/u])},RA=function(t){const s=(a,o)=>{var c,u;this.color=a,y(this,Ci,o),(c=this.parent)==null||c.drawLayer.updateProperties(l(this,xn),{root:{fill:a,"fill-opacity":o}}),(u=l(this,Jl))==null||u.updateColor(a)},i=this.color,r=l(this,Ci);this.addCommands({cmd:s.bind(this,t,me._defaultOpacity),undo:s.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:le.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},MA=function(t){const s=l(this,zn),i=r=>{y(this,zn,r),A(this,Q,LA).call(this,r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:le.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},LA=function(t){if(!l(this,mt))return;A(this,Q,Ef).call(this,{highlightOutlines:l(this,On).getNewOutline(t/2)}),this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)},Xy=function(){l(this,xn)===null||!this.parent||(this.parent.drawLayer.remove(l(this,xn)),y(this,xn,null),this.parent.drawLayer.remove(l(this,Rt)),y(this,Rt,null))},ta=function(t=this.parent){l(this,xn)===null&&({id:zt(this,xn)._,clipPathId:zt(this,Za)._}=t.drawLayer.draw({bbox:l(this,On).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":l(this,Ci)},rootClass:{highlight:!0,free:l(this,mt)},path:{d:l(this,On).toSVGPath()}},!1,!0),y(this,Rt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:l(this,mt)},bbox:l(this,rn).box,path:{d:l(this,rn).toSVGPath()}},l(this,mt))),l(this,eo)&&(l(this,eo).style.clipPath=l(this,Za)))},Vn=new WeakSet,Fo=function([t,s,i,r],a){switch(a){case 90:return[1-s-r,t,r,i];case 180:return[1-t-i,1-s-r,i,r];case 270:return[s,1-t-i,r,i]}return[t,s,i,r]},IA=function(t){me._keyboardManager.exec(this,t)},Cf=function(t){if(!l(this,Ql))return;const s=window.getSelection();t?s.setPosition(l(this,Ql),l(this,rd)):s.setPosition(l(this,ad),l(this,od))},nu=function(){return l(this,mt)?this.rotation:0},DA=function(){if(l(this,mt))return null;const[t,s]=this.pageDimensions,[i,r]=this.pageTranslation,a=l(this,Ei),o=new Float32Array(a.length*8);let c=0;for(const{x:u,y:h,width:d,height:f}of a){const g=u*t+i,m=(1-h)*s+r;o[c]=o[c+4]=g,o[c+1]=o[c+3]=m,o[c+2]=o[c+6]=g+d*t,o[c+5]=o[c+7]=m-f*s,c+=8}return o},jA=function(t){return l(this,On).serialize(t,A(this,Q,nu).call(this))},FA=function(t,s){this._freeHighlight.add(s)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},OA=function(t,s){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(s,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},zA=function(t){const{color:s}=this._initialData;return t.color.some((i,r)=>i!==s[r])},b(me,Vn),X(me,"_defaultColor",null),X(me,"_defaultOpacity",1),X(me,"_defaultThickness",12),X(me,"_type","highlight"),X(me,"_editorType",Z.HIGHLIGHT),X(me,"_freeHighlightId",-1),X(me,"_freeHighlight",null),X(me,"_freeHighlightClipId","");let fp=me;var to;class yN{constructor(){b(this,to,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,s]of Object.entries(e))this.updateProperty(t,s)}updateSVGProperty(e,t){l(this,to)[e]=t}toSVGProperties(){const e=l(this,to);return y(this,to,Object.create(null)),{root:e}}reset(){y(this,to,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){_e("Not implemented")}}to=new WeakMap;var Sn,tc,lt,no,so,Sr,br,Ar,io,de,Yy,Ky,Qy,su,BA,kf,iu,Oo;const W=class W extends Fe{constructor(t){super(t);b(this,de);b(this,Sn,null);b(this,tc);X(this,"_drawId",null);y(this,tc,t.mustBeCommitted||!1),t.drawOutlines&&(A(this,de,Yy).call(this,t),A(this,de,su).call(this))}static _mergeSVGProperties(t,s){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(s))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){_e("Not implemented")}static get typesMap(){_e("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,s){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,s),this._currentParent&&(l(W,lt).updateProperty(i,s),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,s){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,s)}static get defaultPropertiesToUpdate(){const t=[],s=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,s[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:s}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,s[r]]);return t}_updateProperty(t,s,i){const r=this._drawingOptions,a=r[s],o=c=>{var h;r.updateProperty(s,c);const u=l(this,Sn).updateProperty(s,c);u&&A(this,de,iu).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,W._mergeSVGProperties(l(this,Sn).getPathResizingSVGProperties(A(this,de,kf).call(this)),{bbox:A(this,de,Oo).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,W._mergeSVGProperties(l(this,Sn).getPathResizedSVGProperties(A(this,de,kf).call(this)),{bbox:A(this,de,Oo).call(this)}))}_onTranslating(t,s){var i;(i=this.parent)==null||i.drawLayer.updateProperties(this._drawId,{bbox:A(this,de,Oo).call(this,t,s)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,W._mergeSVGProperties(l(this,Sn).getPathTranslatedSVGProperties(A(this,de,kf).call(this),this.parentDimensions),{bbox:A(this,de,Oo).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,l(this,tc)&&(y(this,tc,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){A(this,de,Qy).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,de,su).call(this),A(this,de,iu).call(this,l(this,Sn).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var i;let s=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),A(this,de,Qy).call(this)):t&&(this._uiManager.addShouldRescale(this),A(this,de,su).call(this,t),s=!this.parent&&((i=this.div)==null?void 0:i.classList.contains("selectedEditor"))),super.setParent(t),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,W._mergeSVGProperties({bbox:A(this,de,Oo).call(this)},l(this,Sn).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,de,iu).call(this,l(this,Sn).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const s=document.createElement("div");t.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,s,i,r,a){_e("Not implemented")}static startDrawing(t,s,i,r){var _;const{target:a,offsetX:o,offsetY:c,pointerId:u,pointerType:h}=r;if(l(W,br)&&l(W,br)!==h)return;const{viewport:{rotation:d}}=t,{width:f,height:g}=a.getBoundingClientRect(),m=y(W,no,new AbortController),w=t.combinedSignal(m);if(l(W,Sr)||y(W,Sr,u),l(W,br)??y(W,br,h),window.addEventListener("pointerup",v=>{var x;l(W,Sr)===v.pointerId?this._endDraw(v):(x=l(W,Ar))==null||x.delete(v.pointerId)},{signal:w}),window.addEventListener("pointercancel",v=>{var x;l(W,Sr)===v.pointerId?this._currentParent.endDrawingSession():(x=l(W,Ar))==null||x.delete(v.pointerId)},{signal:w}),window.addEventListener("pointerdown",v=>{l(W,br)===v.pointerType&&((l(W,Ar)||y(W,Ar,new Set)).add(v.pointerId),l(W,lt).isCancellable()&&(l(W,lt).removeLastElement(),l(W,lt).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",bs,{signal:w}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),a.addEventListener("touchmove",v=>{v.timeStamp===l(W,io)&&kn(v)},{signal:w}),t.toggleDrawing(),(_=s._editorUndoBar)==null||_.hide(),l(W,lt)){t.drawLayer.updateProperties(this._currentDrawId,l(W,lt).startNew(o,c,f,g,d));return}s.updateUIForDefaultProperties(this),y(W,lt,this.createDrawerInstance(o,c,f,g,d)),y(W,so,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(l(W,so).toSVGProperties(),l(W,lt).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(y(W,io,-1),!l(W,lt))return;const{offsetX:s,offsetY:i,pointerId:r}=t;if(l(W,Sr)===r){if(((a=l(W,Ar))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,l(W,lt).add(s,i)),y(W,io,t.timeStamp),kn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,y(W,lt,null),y(W,so,null),y(W,br,null),y(W,io,NaN)),l(W,no)&&(l(W,no).abort(),y(W,no,null),y(W,Sr,NaN),y(W,Ar,null))}static _endDraw(t){const s=this._currentParent;if(s){if(s.toggleDrawing(!0),this._cleanup(!1),t&&s.drawLayer.updateProperties(this._currentDrawId,l(W,lt).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=l(W,lt),r=this._currentDrawId,a=i.getLastElement();s.addCommands({cmd:()=>{s.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{s.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:le.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const s=this._currentParent;if(!s)return null;if(s.toggleDrawing(!0),s.cleanUndoStack(le.DRAW_STEP),!l(W,lt).isEmpty()){const{pageDimensions:[i,r],scale:a}=s,o=s.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:l(W,lt).getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:l(W,so),mustBeCommitted:!t});return this._cleanup(!0),o}return s.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,s,i,r,a,o){_e("Not implemented")}static async deserialize(t,s,i){var d,f;const{rawDims:{pageWidth:r,pageHeight:a,pageX:o,pageY:c}}=s.viewport,u=this.deserializeDraw(o,c,r,a,this._INNER_MARGIN,t),h=await super.deserialize(t,s,i);return h.createDrawingOptions(t),A(d=h,de,Yy).call(d,{drawOutlines:u}),A(f=h,de,su).call(f),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[s,i]=this.pageTranslation,[r,a]=this.pageDimensions;return l(this,Sn).serialize([s,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Sn=new WeakMap,tc=new WeakMap,lt=new WeakMap,no=new WeakMap,so=new WeakMap,Sr=new WeakMap,br=new WeakMap,Ar=new WeakMap,io=new WeakMap,de=new WeakSet,Yy=function({drawOutlines:t,drawId:s,drawingOptions:i}){y(this,Sn,t),this._drawingOptions||(this._drawingOptions=i),s>=0?(this._drawId=s,this.parent.drawLayer.finalizeDraw(s,t.defaultProperties)):this._drawId=A(this,de,Ky).call(this,t,this.parent),A(this,de,iu).call(this,t.box)},Ky=function(t,s){const{id:i}=s.drawLayer.draw(W._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i},Qy=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},su=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,de,Ky).call(this,l(this,Sn),t)}},BA=function([t,s,i,r]){const{parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[s,1-t,i*(o/a),r*(a/o)];case 180:return[1-t,1-s,i,r];case 270:return[1-s,t,i*(o/a),r*(a/o)];default:return[t,s,i,r]}},kf=function(){const{x:t,y:s,width:i,height:r,parentDimensions:[a,o],rotation:c}=this;switch(c){case 90:return[1-s,t,i*(a/o),r*(o/a)];case 180:return[1-t,1-s,i,r];case 270:return[s,1-t,i*(a/o),r*(o/a)];default:return[t,s,i,r]}},iu=function(t){if([this.x,this.y,this.width,this.height]=A(this,de,BA).call(this,t),this.div){this.fixAndSetPosition();const[s,i]=this.parentDimensions;this.setDims(this.width*s,this.height*i)}this._onResized()},Oo=function(){const{x:t,y:s,width:i,height:r,rotation:a,parentRotation:o,parentDimensions:[c,u]}=this;switch((a*4+o)/90){case 1:return[1-s-r,t,r,i];case 2:return[1-t-i,1-s-r,i,r];case 3:return[s,1-t-i,r,i];case 4:return[t,s-i*(c/u),r*(u/c),i*(c/u)];case 5:return[1-s,t,i*(c/u),r*(u/c)];case 6:return[1-t-r*(u/c),1-s,r*(u/c),i*(c/u)];case 7:return[s-i*(c/u),1-t-r*(u/c),i*(c/u),r*(u/c)];case 8:return[t-i,s-r,i,r];case 9:return[1-s,t-i,r,i];case 10:return[1-t,1-s,i,r];case 11:return[s-r,1-t,r,i];case 12:return[t-r*(u/c),s,r*(u/c),i*(c/u)];case 13:return[1-s-i*(c/u),t-r*(u/c),i*(c/u),r*(u/c)];case 14:return[1-t,1-s-i*(c/u),r*(u/c),i*(c/u)];case 15:return[s,1-t,i*(c/u),r*(u/c)];default:return[t,s,i,r]}},X(W,"_currentDrawId",-1),X(W,"_currentParent",null),b(W,lt,null),b(W,no,null),b(W,so,null),b(W,Sr,NaN),b(W,br,null),b(W,Ar,null),b(W,io,NaN),X(W,"_INNER_MARGIN",3);let qy=W;var Us,ct,ut,ro,nc,Ht,yt,Bn,ao,oo,lo,sc,Tf;class vN{constructor(e,t,s,i,r,a){b(this,sc);b(this,Us,new Float64Array(6));b(this,ct);b(this,ut);b(this,ro);b(this,nc);b(this,Ht);b(this,yt,"");b(this,Bn,0);b(this,ao,new pp);b(this,oo);b(this,lo);y(this,oo,s),y(this,lo,i),y(this,ro,r),y(this,nc,a),[e,t]=A(this,sc,Tf).call(this,e,t);const o=y(this,ct,[NaN,NaN,NaN,NaN,e,t]);y(this,Ht,[e,t]),y(this,ut,[{line:o,points:l(this,Ht)}]),l(this,Us).set(o,0)}updateProperty(e,t){e==="stroke-width"&&y(this,nc,t)}isEmpty(){return!l(this,ut)||l(this,ut).length===0}isCancellable(){return l(this,Ht).length<=10}add(e,t){[e,t]=A(this,sc,Tf).call(this,e,t);const[s,i,r,a]=l(this,Us).subarray(2,6),o=e-r,c=t-a;return Math.hypot(l(this,oo)*o,l(this,lo)*c)<=2?null:(l(this,Ht).push(e,t),isNaN(s)?(l(this,Us).set([r,a,e,t],2),l(this,ct).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(l(this,Us)[0])&&l(this,ct).splice(6,6),l(this,Us).set([s,i,r,a,e,t],0),l(this,ct).push(...H.createBezierPoints(s,i,r,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const s=this.add(e,t);return s||(l(this,Ht).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,s,i,r){y(this,oo,s),y(this,lo,i),y(this,ro,r),[e,t]=A(this,sc,Tf).call(this,e,t);const a=y(this,ct,[NaN,NaN,NaN,NaN,e,t]);y(this,Ht,[e,t]);const o=l(this,ut).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),l(this,ut).push({line:a,points:l(this,Ht)}),l(this,Us).set(a,0),y(this,Bn,0),this.toSVGPath(),null}getLastElement(){return l(this,ut).at(-1)}setLastElement(e){return l(this,ut)?(l(this,ut).push(e),y(this,ct,e.line),y(this,Ht,e.points),y(this,Bn,0),{path:{d:this.toSVGPath()}}):l(this,ao).setLastElement(e)}removeLastElement(){if(!l(this,ut))return l(this,ao).removeLastElement();l(this,ut).pop(),y(this,yt,"");for(let e=0,t=l(this,ut).length;e<t;e++){const{line:s,points:i}=l(this,ut)[e];y(this,ct,s),y(this,Ht,i),y(this,Bn,0),this.toSVGPath()}return{path:{d:l(this,yt)}}}toSVGPath(){const e=H.svgRound(l(this,ct)[4]),t=H.svgRound(l(this,ct)[5]);if(l(this,Ht).length===2)return y(this,yt,`${l(this,yt)} M ${e} ${t} Z`),l(this,yt);if(l(this,Ht).length<=6){const i=l(this,yt).lastIndexOf("M");y(this,yt,`${l(this,yt).slice(0,i)} M ${e} ${t}`),y(this,Bn,6)}if(l(this,Ht).length===4){const i=H.svgRound(l(this,ct)[10]),r=H.svgRound(l(this,ct)[11]);return y(this,yt,`${l(this,yt)} L ${i} ${r}`),y(this,Bn,12),l(this,yt)}const s=[];l(this,Bn)===0&&(s.push(`M ${e} ${t}`),y(this,Bn,6));for(let i=l(this,Bn),r=l(this,ct).length;i<r;i+=6){const[a,o,c,u,h,d]=l(this,ct).slice(i,i+6).map(H.svgRound);s.push(`C${a} ${o} ${c} ${u} ${h} ${d}`)}return y(this,yt,l(this,yt)+s.join(" ")),y(this,Bn,l(this,ct).length),l(this,yt)}getOutlines(e,t,s,i){const r=l(this,ut).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),l(this,ao).build(l(this,ut),e,t,s,l(this,ro),l(this,nc),i),y(this,Us,null),y(this,ct,null),y(this,ut,null),y(this,yt,null),l(this,ao)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Us=new WeakMap,ct=new WeakMap,ut=new WeakMap,ro=new WeakMap,nc=new WeakMap,Ht=new WeakMap,yt=new WeakMap,Bn=new WeakMap,ao=new WeakMap,oo=new WeakMap,lo=new WeakMap,sc=new WeakSet,Tf=function(e,t){return H._normalizePoint(e,t,l(this,oo),l(this,lo),l(this,ro))};var $t,cd,ud,bn,Hs,$s,ic,rc,ac,xt,ti,UA,HA,$A;const S0=class S0 extends H{constructor(){super(...arguments);b(this,xt);b(this,$t);b(this,cd,0);b(this,ud);b(this,bn);b(this,Hs);b(this,$s);b(this,ic);b(this,rc);b(this,ac)}build(t,s,i,r,a,o,c){y(this,Hs,s),y(this,$s,i),y(this,ic,r),y(this,rc,a),y(this,ac,o),y(this,ud,c??0),y(this,bn,t),A(this,xt,HA).call(this)}setLastElement(t){return l(this,bn).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return l(this,bn).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:s}of l(this,bn)){if(t.push(`M${H.svgRound(s[4])} ${H.svgRound(s[5])}`),s.length===6){t.push("Z");continue}if(s.length===12){t.push(`L${H.svgRound(s[10])} ${H.svgRound(s[11])}`);continue}for(let i=6,r=s.length;i<r;i+=6){const[a,o,c,u,h,d]=s.subarray(i,i+6).map(H.svgRound);t.push(`C${a} ${o} ${c} ${u} ${h} ${d}`)}}return t.join("")}serialize([t,s,i,r],a){const o=[],c=[],[u,h,d,f]=A(this,xt,UA).call(this);let g,m,w,_,v,x,S,E,C;switch(l(this,rc)){case 0:C=H._rescale,g=t,m=s+r,w=i,_=-r,v=t+u*i,x=s+(1-h-f)*r,S=t+(u+d)*i,E=s+(1-h)*r;break;case 90:C=H._rescaleAndSwap,g=t,m=s,w=i,_=r,v=t+h*i,x=s+u*r,S=t+(h+f)*i,E=s+(u+d)*r;break;case 180:C=H._rescale,g=t+i,m=s,w=-i,_=r,v=t+(1-u-d)*i,x=s+h*r,S=t+(1-u)*i,E=s+(h+f)*r;break;case 270:C=H._rescaleAndSwap,g=t+i,m=s+r,w=-i,_=-r,v=t+(1-h-f)*i,x=s+(1-u-d)*r,S=t+(1-h)*i,E=s+(1-u)*r;break}for(const{line:k,points:P}of l(this,bn))o.push(C(k,g,m,w,_,a?new Array(k.length):null)),c.push(C(P,g,m,w,_,a?new Array(P.length):null));return{lines:o,points:c,rect:[v,x,S,E]}}static deserialize(t,s,i,r,a,{paths:{lines:o,points:c},rotation:u,thickness:h}){const d=[];let f,g,m,w,_;switch(u){case 0:_=H._rescale,f=-t/i,g=s/r+1,m=1/i,w=-1/r;break;case 90:_=H._rescaleAndSwap,f=-s/r,g=-t/i,m=1/r,w=1/i;break;case 180:_=H._rescale,f=t/i+1,g=-s/r,m=-1/i,w=1/r;break;case 270:_=H._rescaleAndSwap,f=s/r+1,g=t/i+1,m=-1/r,w=-1/i;break}if(!o){o=[];for(const x of c){const S=x.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,x[0],x[1],NaN,NaN,NaN,NaN,x[2],x[3]]));continue}const E=new Float32Array(3*(S-2));o.push(E);let[C,k,P,N]=x.subarray(0,4);E.set([NaN,NaN,NaN,NaN,C,k],0);for(let R=4;R<S;R+=2){const D=x[R],B=x[R+1];E.set(H.createBezierPoints(C,k,P,N,D,B),(R-2)*3),[C,k,P,N]=[P,N,D,B]}}}for(let x=0,S=o.length;x<S;x++)d.push({line:_(o[x].map(E=>E??NaN),f,g,m,w),points:_(c[x].map(E=>E??NaN),f,g,m,w)});const v=new S0;return v.build(d,i,r,1,u,h,a),v}get box(){return l(this,$t)}updateProperty(t,s){return t==="stroke-width"?A(this,xt,$A).call(this,s):null}updateParentDimensions([t,s],i){const[r,a]=A(this,xt,ti).call(this);y(this,Hs,t),y(this,$s,s),y(this,ic,i);const[o,c]=A(this,xt,ti).call(this),u=o-r,h=c-a,d=l(this,$t);return d[0]-=u,d[1]-=h,d[2]+=2*u,d[3]+=2*h,d}updateRotation(t){return y(this,cd,t),{path:{transform:this.rotationTransform}}}get viewBox(){return l(this,$t).map(H.svgRound).join(" ")}get defaultProperties(){const[t,s]=l(this,$t);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get rotationTransform(){const[,,t,s]=l(this,$t);let i=0,r=0,a=0,o=0,c=0,u=0;switch(l(this,cd)){case 90:r=s/t,a=-t/s,c=t;break;case 180:i=-1,o=-1,c=t,u=s;break;case 270:r=-s/t,a=t/s,u=s;break;default:return""}return`matrix(${i} ${r} ${a} ${o} ${H.svgRound(c)} ${H.svgRound(u)})`}getPathResizingSVGProperties([t,s,i,r]){const[a,o]=A(this,xt,ti).call(this),[c,u,h,d]=l(this,$t);if(Math.abs(h-a)<=H.PRECISION||Math.abs(d-o)<=H.PRECISION){const _=t+i/2-(c+h/2),v=s+r/2-(u+d/2);return{path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:`${this.rotationTransform} translate(${_} ${v})`}}}const f=(i-2*a)/(h-2*a),g=(r-2*o)/(d-2*o),m=h/i,w=d/r;return{path:{"transform-origin":`${H.svgRound(c)} ${H.svgRound(u)}`,transform:`${this.rotationTransform} scale(${m} ${w}) translate(${H.svgRound(a)} ${H.svgRound(o)}) scale(${f} ${g}) translate(${H.svgRound(-a)} ${H.svgRound(-o)})`}}}getPathResizedSVGProperties([t,s,i,r]){const[a,o]=A(this,xt,ti).call(this),c=l(this,$t),[u,h,d,f]=c;if(c[0]=t,c[1]=s,c[2]=i,c[3]=r,Math.abs(d-a)<=H.PRECISION||Math.abs(f-o)<=H.PRECISION){const v=t+i/2-(u+d/2),x=s+r/2-(h+f/2);for(const{line:S,points:E}of l(this,bn))H._translate(S,v,x,S),H._translate(E,v,x,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(i-2*a)/(d-2*a),m=(r-2*o)/(f-2*o),w=-g*(u+a)+t+a,_=-m*(h+o)+s+o;if(g!==1||m!==1||w!==0||_!==0)for(const{line:v,points:x}of l(this,bn))H._rescale(v,w,_,g,m,v),H._rescale(x,w,_,g,m,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,s],i){const[r,a]=i,o=l(this,$t),c=t-o[0],u=s-o[1];if(l(this,Hs)===r&&l(this,$s)===a)for(const{line:h,points:d}of l(this,bn))H._translate(h,c,u,h),H._translate(d,c,u,d);else{const h=l(this,Hs)/r,d=l(this,$s)/a;y(this,Hs,r),y(this,$s,a);for(const{line:f,points:g}of l(this,bn))H._rescale(f,c,u,h,d,f),H._rescale(g,c,u,h,d,g);o[2]*=h,o[3]*=d}return o[0]=t,o[1]=s,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t)} ${H.svgRound(s)}`}}}get defaultSVGProperties(){const t=l(this,$t);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${H.svgRound(t[0])} ${H.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};$t=new WeakMap,cd=new WeakMap,ud=new WeakMap,bn=new WeakMap,Hs=new WeakMap,$s=new WeakMap,ic=new WeakMap,rc=new WeakMap,ac=new WeakMap,xt=new WeakSet,ti=function(t=l(this,ac)){const s=l(this,ud)+t/2*l(this,ic);return l(this,rc)%180===0?[s/l(this,Hs),s/l(this,$s)]:[s/l(this,$s),s/l(this,Hs)]},UA=function(){const[t,s,i,r]=l(this,$t),[a,o]=A(this,xt,ti).call(this,0);return[t+a,s+o,i-2*a,r-2*o]},HA=function(){const t=y(this,$t,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of l(this,bn)){if(r.length<=12){for(let c=4,u=r.length;c<u;c+=6){const[h,d]=r.subarray(c,c+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],d),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],d)}continue}let a=r[4],o=r[5];for(let c=6,u=r.length;c<u;c+=6){const[h,d,f,g,m,w]=r.subarray(c,c+6);G.bezierBoundingBox(a,o,h,d,f,g,m,w,t),a=m,o=w}}const[s,i]=A(this,xt,ti).call(this);t[0]=Math.min(1,Math.max(0,t[0]-s)),t[1]=Math.min(1,Math.max(0,t[1]-i)),t[2]=Math.min(1,Math.max(0,t[2]+s)),t[3]=Math.min(1,Math.max(0,t[3]+i)),t[2]-=t[0],t[3]-=t[1]},$A=function(t){const[s,i]=A(this,xt,ti).call(this);y(this,ac,t);const[r,a]=A(this,xt,ti).call(this),[o,c]=[r-s,a-i],u=l(this,$t);return u[0]-=o,u[1]-=c,u[2]+=2*o,u[3]+=2*c,u};let pp=S0;var oc;const b0=class b0 extends yN{constructor(t){super();b(this,oc);y(this,oc,t),super.updateProperties({fill:"none",stroke:Fe._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,s){t==="stroke-width"&&(s??(s=this["stroke-width"]),s*=l(this,oc).realScale),super.updateSVGProperty(t,s)}clone(){const t=new b0(l(this,oc));return t.updateAll(this),t}};oc=new WeakMap;let Jy=b0;var Lp,WA;const Jo=class Jo extends qy{constructor(t){super({...t,name:"inkEditor"});b(this,Lp);this._willKeepAspectRatio=!0}static initialize(t,s){Fe.initialize(t,s),this._defaultDrawingOptions=new Jy(s.viewParameters)}static getDefaultDrawingOptions(t){const s=this._defaultDrawingOptions.clone();return s.updateProperties(t),s}static get supportMultipleDrawings(){return!0}static get typesMap(){return ie(this,"typesMap",new Map([[le.INK_THICKNESS,"stroke-width"],[le.INK_COLOR,"stroke"],[le.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,s,i,r,a){return new vN(t,s,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,s,i,r,a,o){return pp.deserialize(t,s,i,r,a,o)}static async deserialize(t,s,i){let r=null;if(t instanceof m0){const{data:{inkLists:o,rect:c,rotation:u,id:h,color:d,opacity:f,borderStyle:{rawWidth:g},popupRef:m},parent:{page:{pageNumber:w}}}=t;r=t={annotationType:Z.INK,color:Array.from(d),thickness:g,opacity:f,paths:{points:o},boxes:null,pageIndex:w-1,rect:c.slice(0),rotation:u,id:h,deleted:!1,popupRef:m}}const a=await super.deserialize(t,s,i);return a.annotationElementId=t.id||null,a._initialData=r,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:s,parent:i}=this;s.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,s.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:s,opacity:i}){this._drawingOptions=Jo.getDefaultDrawingOptions({stroke:G.makeHexColor(...t),"stroke-width":s,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:s,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":c}}=this,u={annotationType:Z.INK,color:Fe._colorManager.convert(a),opacity:o,thickness:c,paths:{lines:s,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!A(this,Lp,WA).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:s,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:s}),null}};Lp=new WeakSet,WA=function(t){const{color:s,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,c)=>o!==s[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a},X(Jo,"_type","ink"),X(Jo,"_editorType",Z.INK),X(Jo,"_defaultDrawingOptions",null);let Zy=Jo;var De,vt,_r,ki,Er,lc,Ws,Vs,An,cc,pe,ru,au,Pf,tv,Nf,nv,Rf,VA;const yu=class yu extends Fe{constructor(t){super({...t,name:"stampEditor"});b(this,pe);b(this,De,null);b(this,vt,null);b(this,_r,null);b(this,ki,null);b(this,Er,null);b(this,lc,"");b(this,Ws,null);b(this,Vs,null);b(this,An,!1);b(this,cc,!1);y(this,ki,t.bitmapUrl),y(this,Er,t.bitmapFile)}static initialize(t,s){Fe.initialize(t,s)}static get supportedTypes(){return ie(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(s=>`image/${s}`))}static get supportedTypesStr(){return ie(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,s){s.pasteEditor(Z.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const s=t.get("hasAltText");return{hasAltText:s.get(!0)??0,hasNoAltText:s.get(!1)??0}}async mlGuessAltText(t=null,s=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:a,height:o,channels:r.length/(a*o)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const u=c.output;return await this.setGuessedAltText(u),s&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;l(this,vt)&&(y(this,De,null),this._uiManager.imageManager.deleteId(l(this,vt)),(t=l(this,Ws))==null||t.remove(),y(this,Ws,null),l(this,Vs)&&(clearTimeout(l(this,Vs)),y(this,Vs,null))),super.remove()}rebuild(){if(!this.parent){l(this,vt)&&A(this,pe,Pf).call(this);return}super.rebuild(),this.div!==null&&(l(this,vt)&&l(this,Ws)===null&&A(this,pe,Pf).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(l(this,_r)||l(this,De)||l(this,ki)||l(this,Er)||l(this,vt))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,s;if(this.width&&(t=this.x,s=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),l(this,De)?A(this,pe,tv).call(this):A(this,pe,Pf).call(this),this.width&&!this.annotationElementId){const[i,r]=this.parentDimensions;this.setAt(t*i,s*r,this.width*i,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;l(this,Vs)!==null&&clearTimeout(l(this,Vs)),y(this,Vs,setTimeout(()=>{y(this,Vs,null),A(this,pe,nv).call(this)},200))}copyCanvas(t,s,i=!1){var g;t||(t=224);const{width:r,height:a}=l(this,De),o=new Jm;let c=l(this,De),u=r,h=a,d=null;if(s){if(r>s||a>s){const N=Math.min(s/r,s/a);u=Math.floor(r*N),h=Math.floor(a*N)}d=document.createElement("canvas");const m=d.width=Math.ceil(u*o.sx),w=d.height=Math.ceil(h*o.sy);l(this,An)||(c=A(this,pe,Nf).call(this,m,w));const _=d.getContext("2d");_.filter=this._uiManager.hcmFilter;let v="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":(g=window.matchMedia)!=null&&g.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",x="#42414d");const S=15,E=S*o.sx,C=S*o.sy,k=new OffscreenCanvas(E*2,C*2),P=k.getContext("2d");P.fillStyle=v,P.fillRect(0,0,E*2,C*2),P.fillStyle=x,P.fillRect(0,0,E,C),P.fillRect(E,C,E,C),_.fillStyle=_.createPattern(k,"repeat"),_.fillRect(0,0,m,w),_.drawImage(c,0,0,c.width,c.height,0,0,m,w)}let f=null;if(i){let m,w;if(o.symmetric&&c.width<t&&c.height<t)m=c.width,w=c.height;else if(c=l(this,De),r>t||a>t){const x=Math.min(t/r,t/a);m=Math.floor(r*x),w=Math.floor(a*x),l(this,An)||(c=A(this,pe,Nf).call(this,m,w))}const v=new OffscreenCanvas(m,w).getContext("2d",{willReadFrequently:!0});v.drawImage(c,0,0,c.width,c.height,0,0,m,w),f={width:m,height:w,data:v.getImageData(0,0,m,w).data}}return{canvas:d,width:u,height:h,imageData:f}}getImageForAltText(){return l(this,Ws)}static async deserialize(t,s,i){var w;let r=null;if(t instanceof dA){const{data:{rect:_,rotation:v,id:x,structParent:S,popupRef:E},container:C,parent:{page:{pageNumber:k}}}=t,P=C.querySelector("canvas"),N=i.imageManager.getFromCanvas(C.id,P);P.remove();const R=((w=await s._structTree.getAriaAttributes(`${l0}${x}`))==null?void 0:w.get("aria-label"))||"";r=t={annotationType:Z.STAMP,bitmapId:N.id,bitmap:N.bitmap,pageIndex:k-1,rect:_.slice(0),rotation:v,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:R},isSvg:!1,structParent:S,popupRef:E}}const a=await super.deserialize(t,s,i),{rect:o,bitmap:c,bitmapUrl:u,bitmapId:h,isSvg:d,accessibilityData:f}=t;h&&i.imageManager.isValidId(h)?(y(a,vt,h),c&&y(a,De,c)):y(a,ki,u),y(a,An,d);const[g,m]=a.pageDimensions;return a.width=(o[2]-o[0])/g,a.height=(o[3]-o[1])/m,a.annotationElementId=t.id||null,f&&(a.altTextData=f),a._initialData=r,y(a,cc,!!r),a}serialize(t=!1,s=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Z.STAMP,bitmapId:l(this,vt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:l(this,An),structTreeParentId:this._structTreeParentId};if(t)return i.bitmapUrl=A(this,pe,Rf).call(this,!0),i.accessibilityData=this.serializeAltText(!0),i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=A(this,pe,VA).call(this,i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,s===null)return i;s.stamps||(s.stamps=new Map);const o=l(this,An)?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!s.stamps.has(l(this,vt)))s.stamps.set(l(this,vt),{area:o,serialized:i}),i.bitmap=A(this,pe,Rf).call(this,!1);else if(l(this,An)){const c=s.stamps.get(l(this,vt));o>c.area&&(c.area=o,c.serialized.bitmap.close(),c.serialized.bitmap=A(this,pe,Rf).call(this,!1))}return i}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};De=new WeakMap,vt=new WeakMap,_r=new WeakMap,ki=new WeakMap,Er=new WeakMap,lc=new WeakMap,Ws=new WeakMap,Vs=new WeakMap,An=new WeakMap,cc=new WeakMap,pe=new WeakSet,ru=function(t,s=!1){if(!t){this.remove();return}y(this,De,t.bitmap),s||(y(this,vt,t.id),y(this,An,t.isSvg)),t.file&&y(this,lc,t.file.name),A(this,pe,tv).call(this)},au=function(){if(y(this,_r,null),this._uiManager.enableWaiting(!1),!!l(this,Ws)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,De)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&l(this,De)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Pf=function(){if(l(this,vt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(l(this,vt)).then(i=>A(this,pe,ru).call(this,i,!0)).finally(()=>A(this,pe,au).call(this));return}if(l(this,ki)){const i=l(this,ki);y(this,ki,null),this._uiManager.enableWaiting(!0),y(this,_r,this._uiManager.imageManager.getFromUrl(i).then(r=>A(this,pe,ru).call(this,r)).finally(()=>A(this,pe,au).call(this)));return}if(l(this,Er)){const i=l(this,Er);y(this,Er,null),this._uiManager.enableWaiting(!0),y(this,_r,this._uiManager.imageManager.getFromFile(i).then(r=>A(this,pe,ru).call(this,r)).finally(()=>A(this,pe,au).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=yu.supportedTypesStr;const s=this._uiManager._signal;y(this,_r,new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,pe,ru).call(this,r)}i()},{signal:s}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:s})}).finally(()=>A(this,pe,au).call(this))),t.click()},tv=function(){var d;const{div:t}=this;let{width:s,height:i}=l(this,De);const[r,a]=this.pageDimensions,o=.75;if(this.width)s=this.width*r,i=this.height*a;else if(s>o*r||i>o*a){const f=Math.min(o*r/s,o*a/i);s*=f,i*=f}const[c,u]=this.parentDimensions;this.setDims(s*c/r,i*u/a),this._uiManager.enableWaiting(!1);const h=y(this,Ws,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=s/r,this.height=i/a,(d=this._initialOptions)!=null&&d.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),A(this,pe,nv).call(this),l(this,cc)||(this.parent.addUndoableEditor(this),y(this,cc,!0)),this._reportTelemetry({action:"inserted_image"}),l(this,lc)&&h.setAttribute("aria-label",l(this,lc))},Nf=function(t,s){const{width:i,height:r}=l(this,De);let a=i,o=r,c=l(this,De);for(;a>2*t||o>2*s;){const u=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*s&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const d=new OffscreenCanvas(a,o);d.getContext("2d").drawImage(c,0,0,u,h,0,0,a,o),c=d.transferToImageBitmap()}return c},nv=function(){const[t,s]=this.parentDimensions,{width:i,height:r}=this,a=new Jm,o=Math.ceil(i*t*a.sx),c=Math.ceil(r*s*a.sy),u=l(this,Ws);if(!u||u.width===o&&u.height===c)return;u.width=o,u.height=c;const h=l(this,An)?l(this,De):A(this,pe,Nf).call(this,o,c),d=u.getContext("2d");d.filter=this._uiManager.hcmFilter,d.drawImage(h,0,0,h.width,h.height,0,0,o,c)},Rf=function(t){if(t){if(l(this,An)){const r=this._uiManager.imageManager.getSvgUrl(l(this,vt));if(r)return r}const s=document.createElement("canvas");return{width:s.width,height:s.height}=l(this,De),s.getContext("2d").drawImage(l(this,De),0,0),s.toDataURL()}if(l(this,An)){const[s,i]=this.pageDimensions,r=Math.round(this.width*s*Vr.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*Vr.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(r,a);return o.getContext("2d").drawImage(l(this,De),0,0,l(this,De).width,l(this,De).height,0,0,r,a),o.transferToImageBitmap()}return structuredClone(l(this,De))},VA=function(t){var o;const{pageIndex:s,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===s,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===i;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}},X(yu,"_type","stamp"),X(yu,"_editorType",Z.STAMP);let ev=yu;var co,uc,Gs,Cr,Ti,Un,kr,hc,uo,ps,Pi,Mt,Ni,V,Tr,Me,GA,Ts,iv,rv,Mf;const ts=class ts{constructor({uiManager:e,pageIndex:t,div:s,structTreeLayer:i,accessibilityManager:r,annotationLayer:a,drawLayer:o,textLayer:c,viewport:u,l10n:h}){b(this,Me);b(this,co);b(this,uc,!1);b(this,Gs,null);b(this,Cr,null);b(this,Ti,null);b(this,Un,new Map);b(this,kr,!1);b(this,hc,!1);b(this,uo,!1);b(this,ps,null);b(this,Pi,null);b(this,Mt,null);b(this,Ni,null);b(this,V);const d=[...l(ts,Tr).values()];if(!ts._initialized){ts._initialized=!0;for(const f of d)f.initialize(h,e)}e.registerEditorTypes(d),y(this,V,e),this.pageIndex=t,this.div=s,y(this,co,r),y(this,Gs,a),this.viewport=u,y(this,Mt,c),this.drawLayer=o,this._structTree=i,l(this,V).addLayer(this)}get isEmpty(){return l(this,Un).size===0}get isInvisible(){return this.isEmpty&&l(this,V).getMode()===Z.NONE}updateToolbar(e){l(this,V).updateToolbar(e)}updateMode(e=l(this,V).getMode()){switch(A(this,Me,Mf).call(this),e){case Z.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Z.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Z.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const s of l(ts,Tr).values())t.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=l(this,Mt))==null?void 0:t.div)}setEditingState(e){l(this,V).setEditingState(e)}addCommands(e){l(this,V).addCommands(e)}cleanUndoStack(e){l(this,V).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=l(this,Gs))==null||t.div.classList.toggle("disabled",!e)}async enable(){y(this,uo,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of l(this,Un).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(l(this,V).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!l(this,Gs)){y(this,uo,!1);return}const t=l(this,Gs).getEditableAnnotations();for(const s of t){if(s.hide(),l(this,V).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}y(this,uo,!1)}disable(){var i;y(this,hc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of l(this,Un).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(i=this.getEditableAnnotation(r.annotationElementId))==null||i.show(),r.remove()}if(l(this,Gs)){const r=l(this,Gs).getEditableAnnotations();for(const a of r){const{id:o}=a.data;if(l(this,V).isDeletedAnnotationElement(o))continue;let c=t.get(o);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=e.get(o),c&&(l(this,V).addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}A(this,Me,Mf).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of l(ts,Tr).values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),y(this,hc,!1)}getEditableAnnotation(e){var t;return((t=l(this,Gs))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){l(this,V).getActive()!==e&&l(this,V).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=l(this,Mt))!=null&&e.div&&!l(this,Ni)){y(this,Ni,new AbortController);const t=l(this,V).combinedSignal(l(this,Ni));l(this,Mt).div.addEventListener("pointerdown",A(this,Me,GA).bind(this),{signal:t}),l(this,Mt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=l(this,Mt))!=null&&e.div&&l(this,Ni)&&(l(this,Ni).abort(),y(this,Ni,null),l(this,Mt).div.classList.remove("highlighting"))}enableClick(){if(l(this,Cr))return;y(this,Cr,new AbortController);const e=l(this,V).combinedSignal(l(this,Cr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=l(this,Cr))==null||e.abort(),y(this,Cr,null)}attach(e){l(this,Un).set(e.id,e);const{annotationElementId:t}=e;t&&l(this,V).isDeletedAnnotationElement(t)&&l(this,V).removeDeletedAnnotationElement(e)}detach(e){var t;l(this,Un).delete(e.id),(t=l(this,co))==null||t.removePointerInTextLayer(e.contentDiv),!l(this,hc)&&e.annotationElementId&&l(this,V).addDeletedAnnotationElement(e)}remove(e){this.detach(e),l(this,V).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(l(this,V).addDeletedAnnotationElement(e.annotationElementId),Fe.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),l(this,V).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!l(this,uo)),l(this,V).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var s;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!l(this,Ti)&&(e._focusEventsAllowed=!1,y(this,Ti,setTimeout(()=>{y(this,Ti,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:l(this,V)._signal}),t.focus())},0))),e._structTreeParentId=(s=l(this,co))==null?void 0:s.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:t,undo:s,mustExec:!1})}getNextId(){return l(this,V).getId()}combinedSignal(e){return l(this,V).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=l(this,Me,Ts))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){l(this,V).updateToolbar(e),l(this,V).updateMode(e);const{offsetX:s,offsetY:i}=A(this,Me,rv).call(this),r=this.getNextId(),a=A(this,Me,iv).call(this,{parent:this,id:r,x:s,y:i,uiManager:l(this,V),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=l(ts,Tr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,l(this,V)))||null}createAndAddNewEditor(e,t,s={}){const i=this.getNextId(),r=A(this,Me,iv).call(this,{parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:l(this,V),isCentered:t,...s});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(A(this,Me,rv).call(this),!0)}setSelected(e){l(this,V).setSelected(e)}toggleSelected(e){l(this,V).toggleSelected(e)}unselect(e){l(this,V).unselect(e)}pointerup(e){var s;const{isMac:t}=Xt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&l(this,kr)&&(y(this,kr,!1),!((s=l(this,Me,Ts))!=null&&s.isDrawer&&l(this,Me,Ts).supportMultipleDrawings))){if(!l(this,uc)){y(this,uc,!0);return}if(l(this,V).getMode()===Z.STAMP){l(this,V).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var i;if(l(this,V).getMode()===Z.HIGHLIGHT&&this.enableTextSelection(),l(this,kr)){y(this,kr,!1);return}const{isMac:t}=Xt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(y(this,kr,!0),(i=l(this,Me,Ts))!=null&&i.isDrawer){this.startDrawingSession(e);return}const s=l(this,V).getActive();y(this,uc,!s||s.isEmpty())}startDrawingSession(e){if(this.div.focus(),l(this,ps)){l(this,Me,Ts).startDrawing(this,l(this,V),!1,e);return}l(this,V).setCurrentDrawingSession(this),y(this,ps,new AbortController);const t=l(this,V).combinedSignal(l(this,ps));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(y(this,Pi,null),this.commitOrRemove())},{signal:t}),l(this,Me,Ts).startDrawing(this,l(this,V),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&y(this,Pi,t);return}l(this,Pi)&&setTimeout(()=>{var t;(t=l(this,Pi))==null||t.focus(),y(this,Pi,null)},0)}endDrawingSession(e=!1){return l(this,ps)?(l(this,V).setCurrentDrawingSession(null),l(this,ps).abort(),y(this,ps,null),y(this,Pi,null),l(this,Me,Ts).endDrawing(e)):null}findNewParent(e,t,s){const i=l(this,V).findParent(t,s);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return l(this,ps)?(this.endDrawingSession(),!0):!1}onScaleChanging(){l(this,ps)&&l(this,Me,Ts).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=l(this,V).getActive())==null?void 0:e.parent)===this&&(l(this,V).commitOrRemove(),l(this,V).setActiveEditor(null)),l(this,Ti)&&(clearTimeout(l(this,Ti)),y(this,Ti,null));for(const s of l(this,Un).values())(t=l(this,co))==null||t.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,l(this,Un).clear(),l(this,V).removeLayer(this)}render({viewport:e}){this.viewport=e,xo(this.div,e);for(const t of l(this,V).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){l(this,V).commitOrRemove(),A(this,Me,Mf).call(this);const t=this.viewport.rotation,s=e.rotation;if(this.viewport=e,xo(this.div,{rotation:s}),t!==s)for(const i of l(this,Un).values())i.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return l(this,V).viewParameters.realScale}};co=new WeakMap,uc=new WeakMap,Gs=new WeakMap,Cr=new WeakMap,Ti=new WeakMap,Un=new WeakMap,kr=new WeakMap,hc=new WeakMap,uo=new WeakMap,ps=new WeakMap,Pi=new WeakMap,Mt=new WeakMap,Ni=new WeakMap,V=new WeakMap,Tr=new WeakMap,Me=new WeakSet,GA=function(e){l(this,V).unselectAll();const{target:t}=e;if(t===l(this,Mt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&l(this,Mt).div.contains(t)){const{isMac:s}=Xt.platform;if(e.button!==0||e.ctrlKey&&s)return;l(this,V).showAllEditors("highlight",!0,!0),l(this,Mt).div.classList.add("free"),this.toggleDrawing(),fp.startHighlighting(this,l(this,V).direction==="ltr",{target:l(this,Mt).div,x:e.x,y:e.y}),l(this,Mt).div.addEventListener("pointerup",()=>{l(this,Mt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:l(this,V)._signal}),e.preventDefault()}},Ts=function(){return l(ts,Tr).get(l(this,V).getMode())},iv=function(e){const t=l(this,Me,Ts);return t?new t.prototype.constructor(e):null},rv=function(){const{x:e,y:t,width:s,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+s),c=Math.min(window.innerHeight,t+i),u=(r+o)/2-e,h=(a+c)/2-t,[d,f]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:d,offsetY:f}},Mf=function(){for(const e of l(this,Un).values())e.isEmpty()&&e.remove()},X(ts,"_initialized",!1),b(ts,Tr,new Map([Oy,Zy,ev,fp].map(e=>[e._editorType,e])));let sv=ts;var gs,hd,Wt,ho,Ip,XA,Qs,ov,qA,lv;const Tt=class Tt{constructor({pageIndex:e}){b(this,Qs);b(this,gs,null);b(this,hd,0);b(this,Wt,new Map);b(this,ho,new Map);this.pageIndex=e}setParent(e){if(!l(this,gs)){y(this,gs,e);return}if(l(this,gs)!==e){if(l(this,Wt).size>0)for(const t of l(this,Wt).values())t.remove(),e.append(t);y(this,gs,e)}}static get _svgFactory(){return ie(this,"_svgFactory",new g0)}draw(e,t=!1,s=!1){const i=zt(this,hd)._++,r=A(this,Qs,ov).call(this),a=Tt._svgFactory.createElement("defs");r.append(a);const o=Tt._svgFactory.createElement("path");a.append(o);const c=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",c),o.setAttribute("vector-effect","non-scaling-stroke"),t&&l(this,ho).set(i,o);const u=s?A(this,Qs,qA).call(this,a,c):null,h=Tt._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(r,e),l(this,Wt).set(i,r),{id:i,clipPathId:`url(#${u})`}}drawOutline(e,t){const s=zt(this,hd)._++,i=A(this,Qs,ov).call(this),r=Tt._svgFactory.createElement("defs");i.append(r);const a=Tt._svgFactory.createElement("path");r.append(a);const o=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let c;if(t){const d=Tt._svgFactory.createElement("mask");r.append(d),c=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=Tt._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const g=Tt._svgFactory.createElement("use");d.append(g),g.setAttribute("href",`#${o}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const u=Tt._svgFactory.createElement("use");i.append(u),u.setAttribute("href",`#${o}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return i.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(i,e),l(this,Wt).set(s,i),s}finalizeDraw(e,t){l(this,ho).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var c;if(!t)return;const{root:s,bbox:i,rootClass:r,path:a}=t,o=typeof e=="number"?l(this,Wt).get(e):e;if(o){if(s&&A(this,Qs,lv).call(this,o,s),i&&A(c=Tt,Ip,XA).call(c,o,i),r){const{classList:u}=o;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(a){const h=o.firstChild.firstChild;A(this,Qs,lv).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const s=l(this,Wt).get(e);s&&(l(t,gs).append(s),l(this,Wt).delete(e),l(t,Wt).set(e,s))}remove(e){l(this,ho).delete(e),l(this,gs)!==null&&(l(this,Wt).get(e).remove(),l(this,Wt).delete(e))}destroy(){y(this,gs,null);for(const e of l(this,Wt).values())e.remove();l(this,Wt).clear(),l(this,ho).clear()}};gs=new WeakMap,hd=new WeakMap,Wt=new WeakMap,ho=new WeakMap,Ip=new WeakSet,XA=function(e,[t,s,i,r]){const{style:a}=e;a.top=`${100*s}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*r}%`},Qs=new WeakSet,ov=function(){const e=Tt._svgFactory.create(1,1,!0);return l(this,gs).append(e),e.setAttribute("aria-hidden",!0),e},qA=function(e,t){const s=Tt._svgFactory.createElement("clipPath");e.append(s);const i=`clip_${t}`;s.setAttribute("id",i),s.setAttribute("clipPathUnits","objectBoundingBox");const r=Tt._svgFactory.createElement("use");return s.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),i},lv=function(e,t){for(const[s,i]of Object.entries(t))i===null?e.removeAttribute(s):e.setAttribute(s,i)},b(Tt,Ip);let av=Tt;globalThis.pdfjsTestingUtils={HighlightOutliner:By};K.AbortException;K.AnnotationEditorLayer;K.AnnotationEditorParamsType;K.AnnotationEditorType;K.AnnotationEditorUIManager;K.AnnotationLayer;K.AnnotationMode;K.ColorPicker;K.DOMSVGFactory;K.DrawLayer;K.FeatureTest;var wN=K.GlobalWorkerOptions;K.ImageKind;K.InvalidPDFException;K.MissingPDFException;K.OPS;K.OutputScale;K.PDFDataRangeTransport;K.PDFDateString;K.PDFWorker;K.PasswordResponses;K.PermissionFlag;K.PixelsPerInch;K.RenderingCancelledException;K.TextLayer;K.TouchManager;K.UnexpectedResponseException;K.Util;K.VerbosityLevel;K.XfaLayer;K.build;K.createValidAbsoluteUrl;K.fetchData;var xN=K.getDocument;K.getFilenameFromUrl;K.getPdfFilenameFromUrl;K.getXfaPageViewport;K.isDataScheme;K.isPdfFile;K.noContextMenu;K.normalizeUnicode;K.setLayerDimensions;K.shadow;K.stopEvent;K.version;const SN="/assets/pdf.worker.min-yatZIOMy.mjs";wN.workerSrc=SN;function bN(){const{id:n}=lk(),{user:e}=Qn(),t=To(),s=T.useRef(null),i=T.useRef(null),r=T.useRef(null),[a,o]=T.useState(null),[c,u]=T.useState(1),[h,d]=T.useState(0),[f,g]=T.useState(1.2),[m,w]=T.useState(!0),[_,v]=T.useState(""),[x,S]=T.useState(null),[E,C]=T.useState([]),[k,P]=T.useState(!1),[N,R]=T.useState(20),[D,B]=T.useState(!1);T.useEffect(()=>{ae();const I=O=>O.preventDefault();document.addEventListener("contextmenu",I);const M=O=>{O.key==="ArrowLeft"?u(j=>Math.max(1,j-1)):O.key==="ArrowRight"?u(j=>Math.min(h||1,j+1)):O.key==="-"||O.key==="_"?g(j=>Math.max(.5,j-.2)):(O.key==="+"||O.key==="=")&&g(j=>Math.min(3,j+.2))};return document.addEventListener("keydown",M),fe.logEvent("document_view","document",n),()=>{document.removeEventListener("contextmenu",I),document.removeEventListener("keydown",M),x&&fe.post(`/documents/view/${x}/end`,{pages_viewed:E})}},[n,h]),T.useEffect(()=>{a&&D&&ge()},[a,c,f,D]);const ae=async()=>{var I;try{try{const ue={Authorization:`Bearer ${localStorage.getItem("access_token")}`},ne=localStorage.getItem("desktop_session");ne&&(ue["X-Desktop-Session"]=ne);const At=await fetch("/api/v1/system/logo",{headers:ue});if(At.ok){const Ft=await At.blob(),Ot=URL.createObjectURL(Ft),Jn=document.createElement("img");Jn.src=Ot,await new Promise((ZA,e_)=>{Jn.onload=ZA,Jn.onerror=e_}),r.current=Jn,P(!0),console.log("Custom logo loaded successfully")}}catch(ue){console.log("No custom logo found, using default text",ue)}try{const ue={Authorization:`Bearer ${localStorage.getItem("access_token")}`},ne=localStorage.getItem("desktop_session");ne&&(ue["X-Desktop-Session"]=ne);const At=await fetch("/api/v1/system/config",{headers:ue});if(At.ok){const Ft=await At.json(),Ot=parseInt(((I=Ft.config)==null?void 0:I.watermark_opacity)||"20",10);R(Ot),console.log("Watermark opacity loaded:",Ot)}}catch(ue){console.log("Failed to load opacity setting, using default",ue)}B(!0);const M={Authorization:`Bearer ${localStorage.getItem("access_token")}`,"X-Device-ID":localStorage.getItem("device_id")||""},O=localStorage.getItem("desktop_session");O&&(M["X-Desktop-Session"]=O);const j=await fetch(`/api/v1/documents/${n}/view`,{headers:M,credentials:"include"});if(!j.ok)throw new Error("Failed to load document");const Y=j.headers.get("X-View-ID");Y&&S(Y);const Se=await(await j.blob()).arrayBuffer(),Jt=await xN({data:Se}).promise;o(Jt),d(Jt.numPages),w(!1)}catch(M){v(M instanceof Error?M.message:"Failed to load document"),w(!1)}},ge=async()=>{if(!a||!s.current)return;const I=await a.getPage(c),M=window.devicePixelRatio||1,O=I.getViewport({scale:f*M}),j=s.current,Y=j.getContext("2d");j.height=O.height,j.width=O.width,j.style.width=`${O.width/M}px`,j.style.height=`${O.height/M}px`,Y.save(),Y.setTransform(1,0,0,1,0,0),Y.globalCompositeOperation="source-over",Y.globalAlpha=1,Y.clearRect(0,0,j.width,j.height),Y.restore(),await I.render({canvasContext:Y,viewport:O}).promise,oe(Y,j.width,j.height,M),E.includes(c)||(C(J=>[...J,c]),x&&fe.post(`/documents/view/${x}/page/${c}`,{}))},oe=(I,M,O,j=1)=>{const Y=localStorage.getItem("client_ip")||"Local",J=new Date,Se=J.toLocaleDateString()+" "+J.toLocaleTimeString();I.save(),I.globalCompositeOperation="multiply",I.globalAlpha=N/100,I.textAlign="center";const ft=-35*Math.PI/180;I.rotate(ft);const Jt=450*j,ue=300*j,ne=120*j,At=50*j;for(let Ft=-M;Ft<M*2;Ft+=Jt)for(let Ot=-O;Ot<O*2;Ot+=ue){let Jn=0;r.current?(I.drawImage(r.current,Ft-ne/2,Ot-At/2,ne,At),Jn=At/2+15*j):(I.fillStyle="#0066CC",I.font=`bold ${28*j}px Arial, sans-serif`,I.fillText(" SRAMS",Ft,Ot),Jn=30*j),I.fillStyle="#333333",I.font=`bold ${16*j}px Arial, sans-serif`,I.fillText((e==null?void 0:e.full_name)||"User",Ft,Ot+Jn),I.fillStyle="#666666",I.font=`${14*j}px Arial, sans-serif`,I.fillText(`IP: ${Y}`,Ft,Ot+Jn+20*j),I.fillText(Se,Ft,Ot+Jn+40*j),I.fillStyle="#CC0000",I.font=`bold ${12*j}px Arial, sans-serif`,I.fillText(" CONFIDENTIAL - DO NOT COPY",Ft,Ot+Jn+65*j)}I.restore()},Xe=I=>{I>=1&&I<=h&&u(I)},z=I=>{g(M=>Math.max(.5,Math.min(3,M+I)))};return m?p.jsxs("div",{className:"viewer-loading",children:[p.jsx("div",{className:"loading-spinner"}),p.jsx("p",{children:"Loading document..."})]}):_?p.jsxs("div",{className:"viewer-error",children:[p.jsx("p",{children:_}),p.jsx("button",{className:"btn btn-primary",onClick:()=>t("/documents"),children:"Back to Documents"})]}):p.jsxs("div",{className:"document-viewer",ref:i,children:[p.jsxs("div",{className:"viewer-toolbar glass",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>t("/documents"),children:p.jsx(Kk,{size:20})}),p.jsx("div",{className:"toolbar-separator"}),p.jsxs("div",{className:"page-controls",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>Xe(c-1),disabled:c<=1,children:p.jsx(Jk,{size:20})}),p.jsxs("span",{className:"page-indicator",children:[c," / ",h]}),p.jsx("button",{className:"toolbar-btn",onClick:()=>Xe(c+1),disabled:c>=h,children:p.jsx(Zk,{size:20})})]}),p.jsx("div",{className:"toolbar-separator"}),p.jsxs("div",{className:"zoom-controls",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>z(-.2),children:p.jsx(uT,{size:20})}),p.jsxs("span",{className:"zoom-indicator",children:[Math.round(f*100),"%"]}),p.jsx("button",{className:"toolbar-btn",onClick:()=>z(.2),children:p.jsx(cT,{size:20})})]})]}),p.jsx("div",{className:"canvas-container",children:p.jsx("canvas",{ref:s,className:"pdf-canvas"})}),p.jsx("div",{className:"security-overlay"})]})}function AN(){const{user:n}=Qn(),[e,t]=T.useState([]),[s,i]=T.useState(!0),[r,a]=T.useState(""),[o,c]=T.useState(""),[u,h]=T.useState(!1),[d,f]=T.useState(null),g=(n==null?void 0:n.role)==="super_admin",m=(n==null?void 0:n.role)==="admin";T.useEffect(()=>{w()},[o]);const w=async()=>{try{const C=o?`?role=${o}`:"",k=await fe.get(`/users${C}`);t(k.data.users||[])}catch(C){console.error("Failed to load users:",C)}finally{i(!1)}},_=async C=>{if(confirm(`Are you sure you want to delete ${C.full_name}?`))try{await fe.delete(`/users/${C.id}`),w()}catch(k){alert(k instanceof Error?k.message:"Failed to delete user")}},x=e.filter(C=>!(!g&&C.role==="super_admin")).filter(C=>C.full_name.toLowerCase().includes(r.toLowerCase())||C.email.toLowerCase().includes(r.toLowerCase())),S=C=>!(C.id===(n==null?void 0:n.id)||!g&&C.role==="super_admin"),E=C=>!(C.id===(n==null?void 0:n.id)||C.role==="super_admin"||m&&!g&&C.role==="admin");return s?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"users-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Users"}),p.jsx("p",{children:"Manage system users and their roles"})]}),p.jsxs("button",{className:"btn btn-primary",onClick:()=>{f(null),h(!0)},children:[p.jsx(qS,{size:18}),"Add User"]})]}),p.jsxs("div",{className:"filters glass-card",children:[p.jsxs("div",{className:"search-input",children:[p.jsx(YS,{size:20}),p.jsx("input",{type:"text",placeholder:"Search users...",value:r,onChange:C=>a(C.target.value)})]}),p.jsxs("select",{className:"input",value:o,onChange:C=>c(C.target.value),children:[p.jsx("option",{value:"",children:"All Roles"}),p.jsx("option",{value:"user",children:"Users"}),p.jsx("option",{value:"admin",children:"Admins"}),g&&p.jsx("option",{value:"super_admin",children:"Super Admins"})]})]}),p.jsxs("div",{className:"table-container glass-card",children:[p.jsxs("table",{className:"table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Name"}),p.jsx("th",{children:"Email"}),p.jsx("th",{children:"Role"}),p.jsx("th",{children:"Status"}),p.jsx("th",{children:"Last Login"}),p.jsx("th",{children:"Actions"})]})}),p.jsx("tbody",{children:x.map(C=>p.jsxs("tr",{children:[p.jsx("td",{children:p.jsxs("div",{className:"user-cell",children:[p.jsx("div",{className:"user-avatar",children:C.full_name.charAt(0).toUpperCase()}),p.jsx("span",{children:C.full_name})]})}),p.jsx("td",{children:C.email}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${CN(C.role)}`,children:EN(C.role)})}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${C.is_active?"success":"error"}`,children:C.is_active?"Active":"Inactive"})}),p.jsx("td",{children:C.last_login?new Date(C.last_login).toLocaleDateString():"Never"}),p.jsx("td",{children:p.jsxs("div",{className:"action-buttons",children:[S(C)&&p.jsx("button",{className:"action-btn",onClick:()=>{f(C),h(!0)},children:p.jsx(iT,{size:16})}),E(C)&&p.jsx("button",{className:"action-btn danger",onClick:()=>_(C),children:p.jsx(a0,{size:16})})]})})]},C.id))})]}),x.length===0&&p.jsxs("div",{className:"empty-state",children:[p.jsx(xc,{size:48}),p.jsx("p",{children:"No users found"})]})]}),u&&p.jsx(_N,{user:d,isSuperAdmin:g,onClose:()=>h(!1),onSuccess:()=>{h(!1),w()}})]})}function _N({user:n,isSuperAdmin:e,onClose:t,onSuccess:s}){const[i,r]=T.useState({email:(n==null?void 0:n.email)||"",password:"",full_name:(n==null?void 0:n.full_name)||"",mobile:(n==null?void 0:n.mobile)||"",role:(n==null?void 0:n.role)||"user",is_active:(n==null?void 0:n.is_active)??!0}),[a,o]=T.useState(!1),[c,u]=T.useState(""),h=async d=>{d.preventDefault(),o(!0),u("");try{n?await fe.put(`/users/${n.id}`,{full_name:i.full_name,mobile:i.mobile,role:e?i.role:void 0,is_active:i.is_active}):await fe.post("/users",i),s()}catch(f){u(f instanceof Error?f.message:"Failed to save user")}finally{o(!1)}};return p.jsx("div",{className:"modal-overlay",onClick:t,children:p.jsxs("div",{className:"modal glass-card",onClick:d=>d.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:n?"Edit User":"Add User"}),p.jsx("button",{className:"close-btn",onClick:t,children:p.jsx(Cc,{size:24})})]}),p.jsxs("form",{onSubmit:h,className:"modal-body",children:[c&&p.jsx("div",{className:"error-message",children:c}),!n&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Email"}),p.jsx("input",{type:"email",className:"input",value:i.email,onChange:d=>r({...i,email:d.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Password"}),p.jsx("input",{type:"password",className:"input",value:i.password,onChange:d=>r({...i,password:d.target.value}),required:!0,minLength:8})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Full Name"}),p.jsx("input",{type:"text",className:"input",value:i.full_name,onChange:d=>r({...i,full_name:d.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Mobile"}),p.jsx("input",{type:"tel",className:"input",value:i.mobile,onChange:d=>r({...i,mobile:d.target.value})})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Role"}),p.jsxs("select",{className:"input",value:i.role,onChange:d=>r({...i,role:d.target.value}),disabled:!e||(n==null?void 0:n.role)==="super_admin",children:[p.jsx("option",{value:"user",children:"User"}),p.jsx("option",{value:"admin",children:"Admin"})]})]}),n&&p.jsx("div",{className:"input-group",children:p.jsxs("label",{className:"checkbox-label",children:[p.jsx("input",{type:"checkbox",checked:i.is_active,onChange:d=>r({...i,is_active:d.target.checked})}),p.jsx("span",{children:"Active"})]})}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:t,children:"Cancel"}),p.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a,children:a?"Saving...":"Save"})]})]})]})})}function EN(n){return n.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function CN(n){switch(n){case"super_admin":return"error";case"admin":return"warning";default:return"info"}}function _s(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function Ao(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}const YA=6048e5,kN=864e5;let TN={};function lg(){return TN}function Bu(n,e){var o,c,u,h;const t=lg(),s=(e==null?void 0:e.weekStartsOn)??((c=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??0,i=_s(n),r=i.getDay(),a=(r<s?7:0)+r-s;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function gp(n){return Bu(n,{weekStartsOn:1})}function KA(n){const e=_s(n),t=e.getFullYear(),s=Ao(n,0);s.setFullYear(t+1,0,4),s.setHours(0,0,0,0);const i=gp(s),r=Ao(n,0);r.setFullYear(t,0,4),r.setHours(0,0,0,0);const a=gp(r);return e.getTime()>=i.getTime()?t+1:e.getTime()>=a.getTime()?t:t-1}function c1(n){const e=_s(n);return e.setHours(0,0,0,0),e}function u1(n){const e=_s(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function PN(n,e){const t=c1(n),s=c1(e),i=+t-u1(t),r=+s-u1(s);return Math.round((i-r)/kN)}function NN(n){const e=KA(n),t=Ao(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),gp(t)}function RN(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function MN(n){if(!RN(n)&&typeof n!="number")return!1;const e=_s(n);return!isNaN(Number(e))}function LN(n){const e=_s(n),t=Ao(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}const IN={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},DN=(n,e,t)=>{let s;const i=IN[n];return typeof i=="string"?s=i:e===1?s=i.one:s=i.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function Vg(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const jN={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},FN={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ON={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},zN={date:Vg({formats:jN,defaultWidth:"full"}),time:Vg({formats:FN,defaultWidth:"full"}),dateTime:Vg({formats:ON,defaultWidth:"full"})},BN={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},UN=(n,e,t,s)=>BN[n];function zc(n){return(e,t)=>{const s=t!=null&&t.context?String(t.context):"standalone";let i;if(s==="formatting"&&n.formattingValues){const a=n.defaultFormattingWidth||n.defaultWidth,o=t!=null&&t.width?String(t.width):a;i=n.formattingValues[o]||n.formattingValues[a]}else{const a=n.defaultWidth,o=t!=null&&t.width?String(t.width):n.defaultWidth;i=n.values[o]||n.values[a]}const r=n.argumentCallback?n.argumentCallback(e):e;return i[r]}}const HN={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},$N={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},WN={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},VN={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},GN={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},XN={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},qN=(n,e)=>{const t=Number(n),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},YN={ordinalNumber:qN,era:zc({values:HN,defaultWidth:"wide"}),quarter:zc({values:$N,defaultWidth:"wide",argumentCallback:n=>n-1}),month:zc({values:WN,defaultWidth:"wide"}),day:zc({values:VN,defaultWidth:"wide"}),dayPeriod:zc({values:GN,defaultWidth:"wide",formattingValues:XN,defaultFormattingWidth:"wide"})};function Bc(n){return(e,t={})=>{const s=t.width,i=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],r=e.match(i);if(!r)return null;const a=r[0],o=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(o)?QN(o,d=>d.test(a)):KN(o,d=>d.test(a));let u;u=n.valueCallback?n.valueCallback(c):c,u=t.valueCallback?t.valueCallback(u):u;const h=e.slice(a.length);return{value:u,rest:h}}}function KN(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function QN(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function JN(n){return(e,t={})=>{const s=e.match(n.matchPattern);if(!s)return null;const i=s[0],r=e.match(n.parsePattern);if(!r)return null;let a=n.valueCallback?n.valueCallback(r[0]):r[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(i.length);return{value:a,rest:o}}}const ZN=/^(\d+)(th|st|nd|rd)?/i,e2=/\d+/i,t2={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},n2={any:[/^b/i,/^(a|c)/i]},s2={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},i2={any:[/1/i,/2/i,/3/i,/4/i]},r2={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},a2={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},o2={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},l2={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},c2={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},u2={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},h2={ordinalNumber:JN({matchPattern:ZN,parsePattern:e2,valueCallback:n=>parseInt(n,10)}),era:Bc({matchPatterns:t2,defaultMatchWidth:"wide",parsePatterns:n2,defaultParseWidth:"any"}),quarter:Bc({matchPatterns:s2,defaultMatchWidth:"wide",parsePatterns:i2,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Bc({matchPatterns:r2,defaultMatchWidth:"wide",parsePatterns:a2,defaultParseWidth:"any"}),day:Bc({matchPatterns:o2,defaultMatchWidth:"wide",parsePatterns:l2,defaultParseWidth:"any"}),dayPeriod:Bc({matchPatterns:c2,defaultMatchWidth:"any",parsePatterns:u2,defaultParseWidth:"any"})},d2={code:"en-US",formatDistance:DN,formatLong:zN,formatRelative:UN,localize:YN,match:h2,options:{weekStartsOn:0,firstWeekContainsDate:1}};function f2(n){const e=_s(n);return PN(e,LN(e))+1}function p2(n){const e=_s(n),t=+gp(e)-+NN(e);return Math.round(t/YA)+1}function QA(n,e){var h,d,f,g;const t=_s(n),s=t.getFullYear(),i=lg(),r=(e==null?void 0:e.firstWeekContainsDate)??((d=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??i.firstWeekContainsDate??((g=(f=i.locale)==null?void 0:f.options)==null?void 0:g.firstWeekContainsDate)??1,a=Ao(n,0);a.setFullYear(s+1,0,r),a.setHours(0,0,0,0);const o=Bu(a,e),c=Ao(n,0);c.setFullYear(s,0,r),c.setHours(0,0,0,0);const u=Bu(c,e);return t.getTime()>=o.getTime()?s+1:t.getTime()>=u.getTime()?s:s-1}function g2(n,e){var o,c,u,h;const t=lg(),s=(e==null?void 0:e.firstWeekContainsDate)??((c=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(u=t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??1,i=QA(n,e),r=Ao(n,0);return r.setFullYear(i,0,s),r.setHours(0,0,0,0),Bu(r,e)}function m2(n,e){const t=_s(n),s=+Bu(t,e)-+g2(t,e);return Math.round(s/YA)+1}function we(n,e){const t=n<0?"-":"",s=Math.abs(n).toString().padStart(e,"0");return t+s}const Gi={y(n,e){const t=n.getFullYear(),s=t>0?t:1-t;return we(e==="yy"?s%100:s,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):we(t+1,2)},d(n,e){return we(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return we(n.getHours()%12||12,e.length)},H(n,e){return we(n.getHours(),e.length)},m(n,e){return we(n.getMinutes(),e.length)},s(n,e){return we(n.getSeconds(),e.length)},S(n,e){const t=e.length,s=n.getMilliseconds(),i=Math.trunc(s*Math.pow(10,t-3));return we(i,e.length)}},Ro={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},h1={G:function(n,e,t){const s=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const s=n.getFullYear(),i=s>0?s:1-s;return t.ordinalNumber(i,{unit:"year"})}return Gi.y(n,e)},Y:function(n,e,t,s){const i=QA(n,s),r=i>0?i:1-i;if(e==="YY"){const a=r%100;return we(a,2)}return e==="Yo"?t.ordinalNumber(r,{unit:"year"}):we(r,e.length)},R:function(n,e){const t=KA(n);return we(t,e.length)},u:function(n,e){const t=n.getFullYear();return we(t,e.length)},Q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return we(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return we(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(n,e,t){const s=n.getMonth();switch(e){case"M":case"MM":return Gi.M(n,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(n,e,t){const s=n.getMonth();switch(e){case"L":return String(s+1);case"LL":return we(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(n,e,t,s){const i=m2(n,s);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):we(i,e.length)},I:function(n,e,t){const s=p2(n);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):we(s,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Gi.d(n,e)},D:function(n,e,t){const s=f2(n);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):we(s,e.length)},E:function(n,e,t){const s=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(n,e,t,s){const i=n.getDay(),r=(i-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(r);case"ee":return we(r,2);case"eo":return t.ordinalNumber(r,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(n,e,t,s){const i=n.getDay(),r=(i-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(r);case"cc":return we(r,e.length);case"co":return t.ordinalNumber(r,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(n,e,t){const s=n.getDay(),i=s===0?7:s;switch(e){case"i":return String(i);case"ii":return we(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(n,e,t){const i=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(n,e,t){const s=n.getHours();let i;switch(s===12?i=Ro.noon:s===0?i=Ro.midnight:i=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(n,e,t){const s=n.getHours();let i;switch(s>=17?i=Ro.evening:s>=12?i=Ro.afternoon:s>=4?i=Ro.morning:i=Ro.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let s=n.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return Gi.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Gi.H(n,e)},K:function(n,e,t){const s=n.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):we(s,e.length)},k:function(n,e,t){let s=n.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):we(s,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Gi.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Gi.s(n,e)},S:function(n,e){return Gi.S(n,e)},X:function(n,e,t){const s=n.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return f1(s);case"XXXX":case"XX":return na(s);case"XXXXX":case"XXX":default:return na(s,":")}},x:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"x":return f1(s);case"xxxx":case"xx":return na(s);case"xxxxx":case"xxx":default:return na(s,":")}},O:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+d1(s,":");case"OOOO":default:return"GMT"+na(s,":")}},z:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+d1(s,":");case"zzzz":default:return"GMT"+na(s,":")}},t:function(n,e,t){const s=Math.trunc(n.getTime()/1e3);return we(s,e.length)},T:function(n,e,t){const s=n.getTime();return we(s,e.length)}};function d1(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),i=Math.trunc(s/60),r=s%60;return r===0?t+String(i):t+String(i)+e+we(r,2)}function f1(n,e){return n%60===0?(n>0?"-":"+")+we(Math.abs(n)/60,2):na(n,e)}function na(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),i=we(Math.trunc(s/60),2),r=we(s%60,2);return t+i+e+r}const p1=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},JA=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},y2=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],s=t[1],i=t[2];if(!i)return p1(n,e);let r;switch(s){case"P":r=e.dateTime({width:"short"});break;case"PP":r=e.dateTime({width:"medium"});break;case"PPP":r=e.dateTime({width:"long"});break;case"PPPP":default:r=e.dateTime({width:"full"});break}return r.replace("{{date}}",p1(s,e)).replace("{{time}}",JA(i,e))},v2={p:JA,P:y2},w2=/^D+$/,x2=/^Y+$/,S2=["D","DD","YY","YYYY"];function b2(n){return w2.test(n)}function A2(n){return x2.test(n)}function _2(n,e,t){const s=E2(n,e,t);if(console.warn(s),S2.includes(n))throw new RangeError(s)}function E2(n,e,t){const s=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const C2=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,k2=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,T2=/^'([^]*?)'?$/,P2=/''/g,N2=/[a-zA-Z]/;function R2(n,e,t){var h,d,f,g;const s=lg(),i=s.locale??d2,r=s.firstWeekContainsDate??((d=(h=s.locale)==null?void 0:h.options)==null?void 0:d.firstWeekContainsDate)??1,a=s.weekStartsOn??((g=(f=s.locale)==null?void 0:f.options)==null?void 0:g.weekStartsOn)??0,o=_s(n);if(!MN(o))throw new RangeError("Invalid time value");let c=e.match(k2).map(m=>{const w=m[0];if(w==="p"||w==="P"){const _=v2[w];return _(m,i.formatLong)}return m}).join("").match(C2).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const w=m[0];if(w==="'")return{isToken:!1,value:M2(m)};if(h1[w])return{isToken:!0,value:m};if(w.match(N2))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:m}});i.localize.preprocessor&&(c=i.localize.preprocessor(o,c));const u={firstWeekContainsDate:r,weekStartsOn:a,locale:i};return c.map(m=>{if(!m.isToken)return m.value;const w=m.value;(A2(w)||b2(w))&&_2(w,e,String(n));const _=h1[w[0]];return _(o,w,i.localize,u)}).join("")}function M2(n){const e=n.match(T2);return e?e[1].replace(P2,"'"):n}function L2(){const{user:n}=Qn(),[e,t]=T.useState([]),[s,i]=T.useState(!0),[r,a]=T.useState(0),[o,c]=T.useState(0),[u,h]=T.useState([]),[d,f]=T.useState({action_type:"",start_date:"",end_date:""}),[g,m]=T.useState(!1),[w,_]=T.useState([]),v=(n==null?void 0:n.role)==="super_admin",x=50;T.useEffect(()=>{S(),E()},[o,d]);const S=async()=>{i(!0);try{const N=new URLSearchParams;N.append("offset",String(o*x)),N.append("limit",String(x)),d.action_type&&N.append("action_type",d.action_type),d.start_date&&N.append("start_date",d.start_date),d.end_date&&N.append("end_date",d.end_date);const R=await fe.get(`/audit?${N}`);t(R.data.logs||[]),a(R.data.total)}catch(N){console.error("Failed to load logs:",N)}finally{i(!1)}},E=async()=>{try{const N=await fe.get("/audit/types");h(N.data.action_types||[])}catch{}},C=async N=>{if(!(!w.length||!N))try{await fe.post("/audit/bulk-delete",{log_ids:w,reason:N}),_([]),m(!1),S()}catch(R){alert(R instanceof Error?R.message:"Failed to delete logs")}},k=N=>{_(R=>R.includes(N)?R.filter(D=>D!==N):[...R,N])},P=Math.ceil(r/x);return p.jsxs("div",{className:"audit-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Audit Logs"}),p.jsx("p",{children:"View system activity and security events"})]}),v&&w.length>0&&p.jsxs("button",{className:"btn btn-danger",onClick:()=>m(!0),children:[p.jsx(a0,{size:18}),"Delete Selected (",w.length,")"]})]}),p.jsxs("div",{className:"filters glass-card",children:[p.jsxs("div",{className:"filter-group",children:[p.jsx(eT,{size:20}),p.jsx("span",{children:"Filters:"})]}),p.jsxs("select",{className:"input",value:d.action_type,onChange:N=>f({...d,action_type:N.target.value}),children:[p.jsx("option",{value:"",children:"All Actions"}),u.map(N=>p.jsx("option",{value:N,children:g1(N)},N))]}),p.jsx("input",{type:"date",className:"input",value:d.start_date,onChange:N=>f({...d,start_date:N.target.value}),placeholder:"Start Date"}),p.jsx("input",{type:"date",className:"input",value:d.end_date,onChange:N=>f({...d,end_date:N.target.value}),placeholder:"End Date"}),(d.action_type||d.start_date||d.end_date)&&p.jsx("button",{className:"btn btn-secondary",onClick:()=>f({action_type:"",start_date:"",end_date:""}),children:"Clear"})]}),p.jsxs("div",{className:"table-container glass-card",children:[s?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("table",{className:"table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[v&&p.jsx("th",{className:"checkbox-col"}),p.jsx("th",{children:"Timestamp"}),p.jsx("th",{children:"Action"}),p.jsx("th",{children:"Actor"}),p.jsx("th",{children:"Target"}),p.jsx("th",{children:"IP Address"}),p.jsx("th",{children:"Details"})]})}),p.jsx("tbody",{children:e.map(N=>p.jsxs("tr",{className:N.deleted_at?"deleted":"",children:[v&&p.jsx("td",{className:"checkbox-col",children:!N.deleted_at&&p.jsx("input",{type:"checkbox",checked:w.includes(N.id),onChange:()=>k(N.id)})}),p.jsx("td",{className:"timestamp",children:R2(new Date(N.created_at),"MMM d, yyyy HH:mm:ss")}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${D2(N.action_type)}`,children:g1(N.action_type)})}),p.jsx("td",{children:p.jsx("span",{className:"actor-role",children:N.actor_role||"System"})}),p.jsx("td",{children:N.target_type||"-"}),p.jsx("td",{className:"ip-cell",children:N.ip_address||"-"}),p.jsx("td",{children:Object.keys(N.metadata||{}).length>0&&p.jsxs("code",{className:"metadata",children:[JSON.stringify(N.metadata).slice(0,50),"..."]})})]},N.id))})]}),e.length===0&&!s&&p.jsxs("div",{className:"empty-state",children:[p.jsx(VS,{size:48}),p.jsx("p",{children:"No audit logs found"})]}),P>1&&p.jsxs("div",{className:"pagination",children:[p.jsx("button",{className:"btn btn-secondary",disabled:o===0,onClick:()=>c(N=>N-1),children:"Previous"}),p.jsxs("span",{children:["Page ",o+1," of ",P]}),p.jsx("button",{className:"btn btn-secondary",disabled:o>=P-1,onClick:()=>c(N=>N+1),children:"Next"})]})]}),g&&p.jsx(I2,{count:w.length,onClose:()=>m(!1),onConfirm:C})]})}function I2({count:n,onClose:e,onConfirm:t}){const[s,i]=T.useState("");return p.jsx("div",{className:"modal-overlay",onClick:e,children:p.jsxs("div",{className:"modal glass-card",onClick:r=>r.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Delete Audit Logs"}),p.jsx("button",{className:"close-btn",onClick:e,children:p.jsx(Cc,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[p.jsxs("p",{className:"warning-text",children:["You are about to delete ",n," audit log(s). This action is logged and cannot be undone."]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Deletion Reason (required)"}),p.jsx("textarea",{className:"input",value:s,onChange:r=>i(r.target.value),placeholder:"Explain why these logs are being deleted...",rows:3,required:!0})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),p.jsx("button",{className:"btn btn-danger",onClick:()=>t(s),disabled:!s.trim(),children:"Delete Logs"})]})]})})}function g1(n){return n.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function D2(n){return n.includes("login")||n.includes("logout")?"info":n.includes("failed")||n.includes("delete")?"error":n.includes("create")||n.includes("approve")?"success":"warning"}function j2(){const{user:n,refreshUser:e}=Qn(),{theme:t,toggleTheme:s}=HS(),i=(n==null?void 0:n.role)==="super_admin";return p.jsxs("div",{className:"settings-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsx("h1",{children:"Settings"}),p.jsx("p",{children:"Manage your account and preferences"})]}),p.jsxs("div",{className:"settings-grid",children:[p.jsx(F2,{user:n,onUpdate:e}),p.jsx(O2,{user:n,onUpdate:e}),p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(rp,{size:24}),p.jsx("h2",{children:"Preferences"})]}),p.jsxs("div",{className:"preference-item",children:[p.jsxs("div",{className:"preference-info",children:[p.jsx("h3",{children:"Theme"}),p.jsx("p",{children:"Choose your preferred color scheme"})]}),p.jsxs("button",{className:"theme-toggle",onClick:s,children:[t==="dark"?p.jsx(qm,{size:20}):p.jsx(rp,{size:20}),p.jsx("span",{children:t==="dark"?"Light Mode":"Dark Mode"})]})]})]}),i&&p.jsx(B2,{}),p.jsx(z2,{})]})]})}function F2({user:n,onUpdate:e}){var d;const[t,s]=T.useState(!1),[i,r]=T.useState((n==null?void 0:n.full_name)||""),[a,o]=T.useState((n==null?void 0:n.mobile)||""),[c,u]=T.useState(!1),h=async()=>{u(!0);try{await fe.put(`/users/${n.id}`,{full_name:i,mobile:a}),await e(),s(!1)}catch{alert("Failed to update profile")}finally{u(!1)}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(oT,{size:24}),p.jsx("h2",{children:"Profile"})]}),p.jsxs("div",{className:"profile-content",children:[p.jsx("div",{className:"profile-avatar",children:(d=n==null?void 0:n.full_name)==null?void 0:d.charAt(0).toUpperCase()}),t?p.jsxs("div",{className:"profile-form",children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Full Name"}),p.jsx("input",{type:"text",className:"input",value:i,onChange:f=>r(f.target.value)})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Mobile"}),p.jsx("input",{type:"tel",className:"input",value:a,onChange:f=>o(f.target.value)})]}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:h,disabled:c,children:c?"Saving...":"Save"})]})]}):p.jsxs("div",{className:"profile-info",children:[p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Name"}),p.jsx("span",{className:"value",children:n==null?void 0:n.full_name})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Email"}),p.jsx("span",{className:"value",children:n==null?void 0:n.email})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Mobile"}),p.jsx("span",{className:"value",children:(n==null?void 0:n.mobile)||"Not set"})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Role"}),p.jsx("span",{className:"value badge badge-info",children:n==null?void 0:n.role})]}),p.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!0),children:"Edit Profile"})]})]})]})}function O2({user:n,onUpdate:e}){const[t,s]=T.useState(!1),[i,r]=T.useState(""),[a,o]=T.useState(""),[c,u]=T.useState(!1),[h,d]=T.useState(!1),[f,g]=T.useState(""),[m,w]=T.useState(""),_=async()=>{u(!0);try{await fe.post("/auth/change-password",{current_password:i,new_password:a}),alert("Password changed successfully"),s(!1),r(""),o("")}catch(E){alert(E instanceof Error?E.message:"Failed to change password")}finally{u(!1)}},v=async()=>{try{const E=await fe.get("/auth/totp/setup");g(E.data.secret),d(!0)}catch{alert("Failed to setup 2FA")}},x=async()=>{try{await fe.post("/auth/totp/enable",{secret:f,code:m}),await e(),d(!1),w(""),alert("2FA enabled successfully")}catch{alert("Invalid code")}},S=async()=>{if(confirm("Are you sure you want to disable 2FA?"))try{await fe.post("/auth/totp/disable",{}),await e()}catch{alert("Failed to disable 2FA")}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(ap,{size:24}),p.jsx("h2",{children:"Security"})]}),p.jsxs("div",{className:"security-item",children:[p.jsxs("div",{className:"security-info",children:[p.jsx(GS,{size:20}),p.jsxs("div",{children:[p.jsx("h3",{children:"Password"}),p.jsx("p",{children:"Change your account password"})]})]}),t?p.jsxs("div",{className:"password-form",children:[p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"password",className:"input",placeholder:"Current password",value:i,onChange:E=>r(E.target.value)})}),p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"password",className:"input",placeholder:"New password (min 8 characters)",value:a,onChange:E=>o(E.target.value),minLength:8})}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:_,disabled:c||a.length<8,children:c?"Changing...":"Change Password"})]})]}):p.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!0),children:"Change"})]}),p.jsxs("div",{className:"security-item",children:[p.jsxs("div",{className:"security-info",children:[p.jsx(aT,{size:20}),p.jsxs("div",{children:[p.jsx("h3",{children:"Two-Factor Authentication"}),p.jsx("p",{children:n!=null&&n.totp_enabled?"Enabled":"Add extra security to your account"})]})]}),h?p.jsxs("div",{className:"totp-form",children:[p.jsxs("p",{className:"totp-instructions",children:["Add this secret to your authenticator app: ",p.jsx("code",{children:f})]}),p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"text",className:"input",placeholder:"Enter 6-digit code",value:m,onChange:E=>w(E.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6})}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>d(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:x,disabled:m.length!==6,children:"Enable 2FA"})]})]}):n!=null&&n.totp_enabled?p.jsx("button",{className:"btn btn-danger",onClick:S,children:"Disable"}):p.jsx("button",{className:"btn btn-secondary",onClick:v,children:"Setup"})]})]})}function z2(){const[n,e]=T.useState([]),[t,s]=T.useState(!1),i=async()=>{s(!0);try{const r=await fe.get("/auth/sessions");e(r.data.sessions||[])}catch(r){console.error("Failed to load sessions:",r)}finally{s(!1)}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(XS,{size:24}),p.jsx("h2",{children:"Active Sessions"}),p.jsx("button",{className:"btn btn-secondary",onClick:i,disabled:t,children:t?"Loading...":"View Sessions"})]}),n.length>0&&p.jsx("div",{className:"sessions-list",children:n.map((r,a)=>{var o;return p.jsx("div",{className:"session-item",children:p.jsxs("div",{className:"session-info",children:[p.jsx("span",{className:"session-ip",children:r.ip_address}),p.jsxs("span",{className:"session-agent",children:[(o=r.user_agent)==null?void 0:o.slice(0,50),"..."]}),p.jsxs("span",{className:"session-time",children:["Last active: ",new Date(r.last_activity).toLocaleString()]})]})},r.id||a)})})]})}function B2(){const[n,e]=T.useState(null),[t,s]=T.useState(!0),[i,r]=T.useState(!1),[a,o]=T.useState(""),[c,u]=T.useState(""),[h,d]=T.useState(20),[f,g]=T.useState(20),[m,w]=T.useState(!1);T.useEffect(()=>{x(),_()},[]);const _=async()=>{var C;try{const k=localStorage.getItem("access_token"),P=localStorage.getItem("desktop_session"),N={Authorization:`Bearer ${k}`};P&&(N["X-Desktop-Session"]=P);const R=await fetch("/api/v1/system/config",{headers:N});if(R.ok){const D=await R.json(),B=parseInt(((C=D.config)==null?void 0:C.watermark_opacity)||"20",10);d(B),g(B)}}catch(k){console.log("Failed to load opacity setting:",k)}},v=async()=>{w(!0),o(""),u("");try{const C=localStorage.getItem("access_token"),k=localStorage.getItem("desktop_session"),P={"Content-Type":"application/json",Authorization:`Bearer ${C||""}`};k&&(P["X-Desktop-Session"]=k);const N=await fetch("/api/v1/system/config",{method:"PUT",headers:P,body:JSON.stringify({key:"watermark_opacity",value:String(h)})});if(N.ok)g(h),u(`Watermark opacity set to ${h}%`);else{const R=await N.json();o(R.error||"Failed to save opacity")}}catch{o("Failed to save opacity setting")}finally{w(!1)}},x=async()=>{try{const C=localStorage.getItem("access_token"),k=localStorage.getItem("desktop_session"),P={Authorization:`Bearer ${C}`};k&&(P["X-Desktop-Session"]=k);const N=await fetch("/api/v1/system/logo",{headers:P});if(N.ok){const R=await N.blob();e(URL.createObjectURL(R)),console.log("Logo loaded successfully")}else e(null),console.log("No logo found:",N.status)}catch(C){e(null),console.log("Failed to load logo:",C)}finally{s(!1)}},S=async C=>{var P;const k=(P=C.target.files)==null?void 0:P[0];if(k){if(!["image/png","image/jpeg","image/gif"].includes(k.type)){o("Only PNG, JPG, or GIF files allowed");return}if(k.size>500*1024){o("Logo file too large (max 500KB)");return}o(""),u(""),r(!0);try{const N=localStorage.getItem("access_token"),R=localStorage.getItem("desktop_session"),D=new FormData;D.append("logo",k);const B={Authorization:`Bearer ${N||""}`};R&&(B["X-Desktop-Session"]=R);const ae=await fetch("/api/v1/system/logo",{method:"POST",headers:B,body:D});if(ae.ok)u("Logo uploaded successfully"),x();else{const ge=await ae.json();o(ge.error||"Failed to upload logo")}}catch{o("Failed to upload logo")}finally{r(!1)}}},E=async()=>{if(confirm("Are you sure you want to delete the company logo?")){o(""),u("");try{const C=localStorage.getItem("access_token"),k=localStorage.getItem("desktop_session"),P={Authorization:`Bearer ${C||""}`};k&&(P["X-Desktop-Session"]=k);const N=await fetch("/api/v1/system/logo",{method:"DELETE",headers:P});if(N.ok)u("Logo deleted"),e(null);else{const R=await N.json();o(R.error||"Failed to delete logo")}}catch{o("Failed to delete logo")}}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx($w,{size:24}),p.jsx("h2",{children:"Company Logo"})]}),p.jsx("p",{className:"section-description",children:"Upload a company logo to display in document watermarks. The logo will be visible on all documents viewed by users."}),a&&p.jsx("div",{className:"error-message",children:a}),c&&p.jsx("div",{className:"success-message",children:c}),p.jsx("div",{className:"logo-preview-container",children:t?p.jsx("div",{className:"loading-spinner"}):n?p.jsx("img",{src:n,alt:"Company Logo",className:"logo-preview"}):p.jsxs("div",{className:"logo-placeholder",children:[p.jsx($w,{size:48}),p.jsx("span",{children:"No logo uploaded"})]})}),p.jsxs("div",{className:"logo-actions",children:[p.jsxs("label",{className:"btn btn-primary upload-btn",children:[p.jsx(KS,{size:16}),i?"Uploading...":"Upload Logo",p.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/gif",onChange:S,disabled:i,style:{display:"none"}})]}),n&&p.jsxs("button",{className:"btn btn-danger",onClick:E,children:[p.jsx(a0,{size:16}),"Delete Logo"]})]}),p.jsx("p",{className:"help-text",children:"Supported formats: PNG, JPG, GIF  Max size: 500KB"}),p.jsxs("div",{className:"opacity-control",children:[p.jsx("h3",{children:"Watermark Opacity"}),p.jsx("p",{className:"section-description",children:"Adjust how visible the watermark appears on documents (1% = very faint, 100% = solid)"}),p.jsxs("div",{className:"opacity-slider-container",children:[p.jsx("input",{type:"range",min:"1",max:"100",value:h,onChange:C=>d(parseInt(C.target.value,10)),className:"opacity-slider"}),p.jsxs("span",{className:"opacity-value",children:[h,"%"]})]}),p.jsxs("div",{className:"opacity-actions",children:[p.jsx("button",{className:"btn btn-primary",onClick:v,disabled:m||h===f,children:m?"Applying...":"Apply Opacity"}),h!==f&&p.jsx("span",{className:"unsaved-indicator",children:"Unsaved changes"})]})]})]})}const Gg={CONFIG_UPDATE:"CONFIG_UPDATE",FORCE_LOGOUT:"FORCE_LOGOUT",SESSION_REVOKED:"SESSION_REVOKED"};function U2(n={}){const{user:e,logout:t}=Qn(),s=T.useRef(null),i=T.useRef(null),r=T.useRef(0),a=5,o=T.useCallback(()=>{if(!e)return;s.current&&s.current.close();const u=localStorage.getItem("access_token");if(!u)return;const h=`/api/v1/realtime/subscribe?token=${encodeURIComponent(u)}`,d=new EventSource(h,{withCredentials:!0});s.current=d,d.addEventListener("connected",f=>{var g;r.current=0;try{const m=JSON.parse(f.data);(g=n.onConnected)==null||g.call(n,m.client_id)}catch{}}),d.addEventListener(Gg.CONFIG_UPDATE,f=>{var g;try{const m=JSON.parse(f.data);m.payload&&((g=n.onConfigUpdate)==null||g.call(n,m.payload.key,m.payload.value))}catch{console.error("Failed to parse CONFIG_UPDATE event")}}),d.addEventListener(Gg.FORCE_LOGOUT,f=>{var g,m;try{const _=((g=JSON.parse(f.data).payload)==null?void 0:g.reason)||"Your session has been terminated";(m=n.onForceLogout)==null||m.call(n,_),t(),alert(_)}catch{t()}}),d.addEventListener(Gg.SESSION_REVOKED,f=>{var g,m;try{const _=((g=JSON.parse(f.data).payload)==null?void 0:g.reason)||"Session revoked by administrator";(m=n.onForceLogout)==null||m.call(n,_),t(),alert(_)}catch{t()}}),d.onerror=f=>{var g;if((g=n.onError)==null||g.call(n,f),d.close(),r.current<a){const m=Math.min(1e3*Math.pow(2,r.current),3e4);r.current++,i.current=window.setTimeout(o,m)}}},[e,t,n]);return T.useEffect(()=>(o(),()=>{s.current&&s.current.close(),i.current&&window.clearTimeout(i.current)}),[o]),{reconnect:T.useCallback(()=>{r.current=0,o()},[o])}}function H2(){var g;const{user:n,logout:e}=Qn(),{theme:t,toggleTheme:s}=HS(),i=To(),[r,a]=T.useState(!1),o=T.useCallback((m,w)=>{console.log(`[SSE] Config updated: ${m} =`,w),window.dispatchEvent(new CustomEvent("srams:config-update",{detail:{key:m,value:w}}))},[]),c=T.useCallback(m=>{console.log("[SSE] Force logout:",m)},[]);U2({onConfigUpdate:o,onForceLogout:c,onConnected:m=>console.log(`[SSE] Connected: ${m}`),onError:()=>console.warn("[SSE] Connection error, will retry...")});const u=async()=>{await e(),i("/login")},h=(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="super_admin",d=(n==null?void 0:n.role)==="super_admin",f=[{to:"/dashboard",icon:tT,label:"Dashboard"},{to:"/documents",icon:qs,label:"Documents"},...h?[{to:"/users",icon:xc,label:"Users"},{to:"/audit",icon:VS,label:"Audit Logs"}]:[],{to:"/settings",icon:rT,label:"Settings"}];return p.jsxs("div",{className:"layout",children:[p.jsxs("header",{className:"mobile-header",children:[p.jsx("button",{className:"menu-btn",onClick:()=>a(!0),children:p.jsx(sT,{size:24})}),p.jsxs("div",{className:"logo",children:[p.jsx(ap,{size:24}),p.jsx("span",{children:"SRAMS"})]}),p.jsx("button",{className:"theme-btn",onClick:s,children:t==="twilight"?p.jsx(qm,{size:20}):p.jsx(rp,{size:20})})]}),r&&p.jsx("div",{className:"sidebar-overlay",onClick:()=>a(!1)}),p.jsxs("aside",{className:`sidebar ${r?"open":""}`,children:[p.jsxs("div",{className:"sidebar-header",children:[p.jsxs("div",{className:"logo",children:[p.jsx(ap,{size:28}),p.jsx("span",{children:"SRAMS"})]}),p.jsx("button",{className:"close-btn",onClick:()=>a(!1),children:p.jsx(Cc,{size:24})})]}),p.jsx("nav",{className:"sidebar-nav",children:f.map(m=>p.jsxs(Ok,{to:m.to,className:({isActive:w})=>`nav-item ${w?"active":""}`,onClick:()=>a(!1),children:[p.jsx(m.icon,{size:20}),p.jsx("span",{children:m.label})]},m.to))}),p.jsxs("div",{className:"sidebar-footer",children:[p.jsxs("div",{className:"user-info",children:[p.jsx("div",{className:"user-avatar",children:(g=n==null?void 0:n.full_name)==null?void 0:g.charAt(0).toUpperCase()}),p.jsxs("div",{className:"user-details",children:[p.jsx("span",{className:"user-name",children:n==null?void 0:n.full_name}),p.jsx("span",{className:"user-role",children:d?"Super Admin":h?"Admin":"User"})]})]}),p.jsxs("div",{className:"sidebar-actions",children:[p.jsx("button",{className:"action-btn",onClick:s,title:"Toggle theme",children:t==="twilight"?p.jsx(qm,{size:18}):p.jsx(rp,{size:18})}),p.jsx("button",{className:"action-btn logout",onClick:u,title:"Logout",children:p.jsx(XS,{size:18})})]})]})]}),p.jsx("main",{className:"main-content",children:p.jsx(Ak,{})})]})}function Xg({children:n,roles:e}){const{user:t,loading:s}=Qn();return s?p.jsx("div",{className:"flex items-center justify-center",style:{height:"100vh"},children:p.jsx("div",{className:"animate-spin",style:{width:40,height:40,border:"3px solid var(--color-border)",borderTopColor:"var(--color-accent-primary)",borderRadius:"50%"}})}):t?e&&!e.includes(t.role)?p.jsx($m,{to:"/dashboard",replace:!0}):p.jsx(p.Fragment,{children:n}):p.jsx($m,{to:"/login",replace:!0})}function $2(){return p.jsx(Wk,{children:p.jsx(Xk,{children:p.jsx(Ik,{children:p.jsxs(Ek,{children:[p.jsx(es,{path:"/login",element:p.jsx(hT,{})}),p.jsx(es,{path:"/force-change-password",element:p.jsx(dT,{})}),p.jsxs(es,{path:"/",element:p.jsx(Xg,{children:p.jsx(H2,{})}),children:[p.jsx(es,{index:!0,element:p.jsx($m,{to:"/dashboard",replace:!0})}),p.jsx(es,{path:"dashboard",element:p.jsx(fT,{})}),p.jsx(es,{path:"documents",element:p.jsx(mT,{})}),p.jsx(es,{path:"documents/:id",element:p.jsx(bN,{})}),p.jsx(es,{path:"users",element:p.jsx(Xg,{roles:["admin","super_admin"],children:p.jsx(AN,{})})}),p.jsx(es,{path:"audit",element:p.jsx(Xg,{roles:["admin","super_admin"],children:p.jsx(L2,{})})}),p.jsx(es,{path:"settings",element:p.jsx(j2,{})})]})]})})})})}qg.createRoot(document.getElementById("root")).render(p.jsx(k1.StrictMode,{children:p.jsx($2,{})}));
