(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();var aS=Object.defineProperty,b0=t=>{throw TypeError(t)},iS=(t,e,n)=>e in t?aS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,X=(t,e,n)=>iS(t,typeof e!="symbol"?e+"":e,n),Qv=(t,e,n)=>e.has(t)||b0("Cannot "+n),o=(t,e,n)=>(Qv(t,e,"read from private field"),n?n.call(t):e.get(t)),k=(t,e,n)=>e.has(t)?b0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),m=(t,e,n,s)=>(Qv(t,e,"write to private field"),e.set(t,n),n),A=(t,e,n)=>(Qv(t,e,"access private method"),n),Jt=(t,e,n,s)=>({set _(a){m(t,e,a)},get _(){return o(t,e,s)}});function rS(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(s,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();function oS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var y0={exports:{}},yp={},w0={exports:{}},ne={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Gu=Symbol.for("react.element"),lS=Symbol.for("react.portal"),cS=Symbol.for("react.fragment"),uS=Symbol.for("react.strict_mode"),hS=Symbol.for("react.profiler"),dS=Symbol.for("react.provider"),fS=Symbol.for("react.context"),pS=Symbol.for("react.forward_ref"),gS=Symbol.for("react.suspense"),mS=Symbol.for("react.memo"),vS=Symbol.for("react.lazy"),oy=Symbol.iterator;function bS(t){return t===null||typeof t!="object"?null:(t=oy&&t[oy]||t["@@iterator"],typeof t=="function"?t:null)}var x0={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k0=Object.assign,A0={};function pl(t,e,n){this.props=t,this.context=e,this.refs=A0,this.updater=n||x0}pl.prototype.isReactComponent={};pl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};pl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function S0(){}S0.prototype=pl.prototype;function Jv(t,e,n){this.props=t,this.context=e,this.refs=A0,this.updater=n||x0}var Zv=Jv.prototype=new S0;Zv.constructor=Jv;k0(Zv,pl.prototype);Zv.isPureReactComponent=!0;var ly=Array.isArray,_0=Object.prototype.hasOwnProperty,eb={current:null},E0={key:!0,ref:!0,__self:!0,__source:!0};function C0(t,e,n){var s,a={},i=null,r=null;if(e!=null)for(s in e.ref!==void 0&&(r=e.ref),e.key!==void 0&&(i=""+e.key),e)_0.call(e,s)&&!E0.hasOwnProperty(s)&&(a[s]=e[s]);var l=arguments.length-2;if(l===1)a.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)a[s]===void 0&&(a[s]=l[s]);return{$$typeof:Gu,type:t,key:i,ref:r,props:a,_owner:eb.current}}function yS(t,e){return{$$typeof:Gu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function tb(t){return typeof t=="object"&&t!==null&&t.$$typeof===Gu}function wS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cy=/\/+/g;function qp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wS(""+t.key):e.toString(36)}function Ch(t,e,n,s,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var r=!1;if(t===null)r=!0;else switch(i){case"string":case"number":r=!0;break;case"object":switch(t.$$typeof){case Gu:case lS:r=!0}}if(r)return r=t,a=a(r),t=s===""?"."+qp(r,0):s,ly(a)?(n="",t!=null&&(n=t.replace(cy,"$&/")+"/"),Ch(a,e,n,"",function(u){return u})):a!=null&&(tb(a)&&(a=yS(a,n+(!a.key||r&&r.key===a.key?"":(""+a.key).replace(cy,"$&/")+"/")+t)),e.push(a)),1;if(r=0,s=s===""?".":s+":",ly(t))for(var l=0;l<t.length;l++){i=t[l];var c=s+qp(i,l);r+=Ch(i,e,n,c,a)}else if(c=bS(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=s+qp(i,l++),r+=Ch(i,e,n,c,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return r}function eh(t,e,n){if(t==null)return t;var s=[],a=0;return Ch(t,s,"","",function(i){return e.call(n,i,a++)}),s}function xS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var zt={current:null},Mh={transition:null},kS={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:Mh,ReactCurrentOwner:eb};function M0(){throw Error("act(...) is not supported in production builds of React.")}ne.Children={map:eh,forEach:function(t,e,n){eh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return eh(t,function(){e++}),e},toArray:function(t){return eh(t,function(e){return e})||[]},only:function(t){if(!tb(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ne.Component=pl;ne.Fragment=cS;ne.Profiler=hS;ne.PureComponent=Jv;ne.StrictMode=uS;ne.Suspense=gS;ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kS;ne.act=M0;ne.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=k0({},t.props),a=t.key,i=t.ref,r=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,r=eb.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)_0.call(e,c)&&!E0.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:Gu,type:t.type,key:a,ref:i,props:s,_owner:r}};ne.createContext=function(t){return t={$$typeof:fS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:dS,_context:t},t.Consumer=t};ne.createElement=C0;ne.createFactory=function(t){var e=C0.bind(null,t);return e.type=t,e};ne.createRef=function(){return{current:null}};ne.forwardRef=function(t){return{$$typeof:pS,render:t}};ne.isValidElement=tb;ne.lazy=function(t){return{$$typeof:vS,_payload:{_status:-1,_result:t},_init:xS}};ne.memo=function(t,e){return{$$typeof:mS,type:t,compare:e===void 0?null:e}};ne.startTransition=function(t){var e=Mh.transition;Mh.transition={};try{t()}finally{Mh.transition=e}};ne.unstable_act=M0;ne.useCallback=function(t,e){return zt.current.useCallback(t,e)};ne.useContext=function(t){return zt.current.useContext(t)};ne.useDebugValue=function(){};ne.useDeferredValue=function(t){return zt.current.useDeferredValue(t)};ne.useEffect=function(t,e){return zt.current.useEffect(t,e)};ne.useId=function(){return zt.current.useId()};ne.useImperativeHandle=function(t,e,n){return zt.current.useImperativeHandle(t,e,n)};ne.useInsertionEffect=function(t,e){return zt.current.useInsertionEffect(t,e)};ne.useLayoutEffect=function(t,e){return zt.current.useLayoutEffect(t,e)};ne.useMemo=function(t,e){return zt.current.useMemo(t,e)};ne.useReducer=function(t,e,n){return zt.current.useReducer(t,e,n)};ne.useRef=function(t){return zt.current.useRef(t)};ne.useState=function(t){return zt.current.useState(t)};ne.useSyncExternalStore=function(t,e,n){return zt.current.useSyncExternalStore(t,e,n)};ne.useTransition=function(){return zt.current.useTransition()};ne.version="18.3.1";w0.exports=ne;var C=w0.exports;const N0=oS(C),AS=rS({__proto__:null,default:N0},[C]);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var SS=C,_S=Symbol.for("react.element"),ES=Symbol.for("react.fragment"),CS=Object.prototype.hasOwnProperty,MS=SS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NS={key:!0,ref:!0,__self:!0,__source:!0};function P0(t,e,n){var s,a={},i=null,r=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(r=e.ref);for(s in e)CS.call(e,s)&&!NS.hasOwnProperty(s)&&(a[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)a[s]===void 0&&(a[s]=e[s]);return{$$typeof:_S,type:t,key:i,ref:r,props:a,_owner:MS.current}}yp.Fragment=ES;yp.jsx=P0;yp.jsxs=P0;y0.exports=yp;var p=y0.exports,Fg={},T0={exports:{}},pn={},L0={exports:{}},R0={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(t){function e(L,j){var D=L.length;L.push(j);e:for(;0<D;){var Y=D-1>>>1,Q=L[Y];if(0<a(Q,j))L[Y]=j,L[D]=Q,D=Y;else break e}}function n(L){return L.length===0?null:L[0]}function s(L){if(L.length===0)return null;var j=L[0],D=L.pop();if(D!==j){L[0]=D;e:for(var Y=0,Q=L.length,fe=Q>>>1;Y<fe;){var we=2*(Y+1)-1,st=L[we],de=we+1,se=L[de];if(0>a(st,D))de<Q&&0>a(se,st)?(L[Y]=se,L[de]=D,Y=de):(L[Y]=st,L[we]=D,Y=we);else if(de<Q&&0>a(se,D))L[Y]=se,L[de]=D,Y=de;else break e}}return j}function a(L,j){var D=L.sortIndex-j.sortIndex;return D!==0?D:L.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var r=Date,l=r.now();t.unstable_now=function(){return r.now()-l}}var c=[],u=[],h=1,d=null,f=3,g=!1,v=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(L){for(var j=n(u);j!==null;){if(j.callback===null)s(u);else if(j.startTime<=L)s(u),j.sortIndex=j.expirationTime,e(c,j);else break;j=n(u)}}function _(L){if(y=!1,w(L),!v)if(n(c)!==null)v=!0,F(E);else{var j=n(u);j!==null&&B(_,j.startTime-L)}}function E(L,j){v=!1,y&&(y=!1,b(P),P=-1),g=!0;var D=f;try{for(w(j),d=n(c);d!==null&&(!(d.expirationTime>j)||L&&!V());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,f=d.priorityLevel;var Q=Y(d.expirationTime<=j);j=t.unstable_now(),typeof Q=="function"?d.callback=Q:d===n(c)&&s(c),w(j)}else s(c);d=n(c)}if(d!==null)var fe=!0;else{var we=n(u);we!==null&&B(_,we.startTime-j),fe=!1}return fe}finally{d=null,f=D,g=!1}}var M=!1,N=null,P=-1,T=5,I=-1;function V(){return!(t.unstable_now()-I<T)}function re(){if(N!==null){var L=t.unstable_now();I=L;var j=!0;try{j=N(!0,L)}finally{j?ue():(M=!1,N=null)}}else M=!1}var ue;if(typeof x=="function")ue=function(){x(re)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,G=he.port2;he.port1.onmessage=re,ue=function(){G.postMessage(null)}}else ue=function(){S(re,0)};function F(L){N=L,M||(M=!0,ue())}function B(L,j){P=S(function(){L(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){v||g||(v=!0,F(E))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(L){switch(f){case 1:case 2:case 3:var j=3;break;default:j=f}var D=f;f=j;try{return L()}finally{f=D}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,j){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var D=f;f=L;try{return j()}finally{f=D}},t.unstable_scheduleCallback=function(L,j,D){var Y=t.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?Y+D:Y):D=Y,L){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=D+Q,L={id:h++,callback:j,priorityLevel:L,startTime:D,expirationTime:Q,sortIndex:-1},D>Y?(L.sortIndex=D,e(u,L),n(c)===null&&L===n(u)&&(y?(b(P),P=-1):y=!0,B(_,D-Y))):(L.sortIndex=Q,e(c,L),v||g||(v=!0,F(E))),L},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(L){var j=f;return function(){var D=f;f=j;try{return L.apply(this,arguments)}finally{f=D}}}})(R0);L0.exports=R0;var PS=L0.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var TS=C,fn=PS;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var I0=new Set,Au={};function kr(t,e){al(t,e),al(t+"Capture",e)}function al(t,e){for(Au[t]=e,t=0;t<e.length;t++)I0.add(e[t])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Og=Object.prototype.hasOwnProperty,LS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uy={},hy={};function RS(t){return Og.call(hy,t)?!0:Og.call(uy,t)?!1:LS.test(t)?hy[t]=!0:(uy[t]=!0,!1)}function IS(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function DS(t,e,n,s){if(e===null||typeof e>"u"||IS(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $t(t,e,n,s,a,i,r){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=r}var gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){gt[t]=new $t(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];gt[e]=new $t(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){gt[t]=new $t(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){gt[t]=new $t(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){gt[t]=new $t(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){gt[t]=new $t(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){gt[t]=new $t(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){gt[t]=new $t(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){gt[t]=new $t(t,5,!1,t.toLowerCase(),null,!1,!1)});var nb=/[\-:]([a-z])/g;function sb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(nb,sb);gt[e]=new $t(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(nb,sb);gt[e]=new $t(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(nb,sb);gt[e]=new $t(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){gt[t]=new $t(t,1,!1,t.toLowerCase(),null,!1,!1)});gt.xlinkHref=new $t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){gt[t]=new $t(t,1,!1,t.toLowerCase(),null,!0,!0)});function ab(t,e,n,s){var a=gt.hasOwnProperty(e)?gt[e]:null;(a!==null?a.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(DS(e,n,a,s)&&(n=null),s||a===null?RS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,s=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var ca=TS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,th=Symbol.for("react.element"),po=Symbol.for("react.portal"),go=Symbol.for("react.fragment"),ib=Symbol.for("react.strict_mode"),Wg=Symbol.for("react.profiler"),D0=Symbol.for("react.provider"),j0=Symbol.for("react.context"),rb=Symbol.for("react.forward_ref"),zg=Symbol.for("react.suspense"),$g=Symbol.for("react.suspense_list"),ob=Symbol.for("react.memo"),Na=Symbol.for("react.lazy"),F0=Symbol.for("react.offscreen"),dy=Symbol.iterator;function wl(t){return t===null||typeof t!="object"?null:(t=dy&&t[dy]||t["@@iterator"],typeof t=="function"?t:null)}var Re=Object.assign,Xp;function Fl(t){if(Xp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xp=e&&e[1]||""}return`
`+Xp+t}var Yp=!1;function Kp(t,e){if(!t||Yp)return"";Yp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=s.stack.split(`
`),r=a.length-1,l=i.length-1;1<=r&&0<=l&&a[r]!==i[l];)l--;for(;1<=r&&0<=l;r--,l--)if(a[r]!==i[l]){if(r!==1||l!==1)do if(r--,l--,0>l||a[r]!==i[l]){var c=`
`+a[r].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=r&&0<=l);break}}}finally{Yp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fl(t):""}function jS(t){switch(t.tag){case 5:return Fl(t.type);case 16:return Fl("Lazy");case 13:return Fl("Suspense");case 19:return Fl("SuspenseList");case 0:case 2:case 15:return t=Kp(t.type,!1),t;case 11:return t=Kp(t.type.render,!1),t;case 1:return t=Kp(t.type,!0),t;default:return""}}function Bg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case go:return"Fragment";case po:return"Portal";case Wg:return"Profiler";case ib:return"StrictMode";case zg:return"Suspense";case $g:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case j0:return(t.displayName||"Context")+".Consumer";case D0:return(t._context.displayName||"Context")+".Provider";case rb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ob:return e=t.displayName||null,e!==null?e:Bg(t.type)||"Memo";case Na:e=t._payload,t=t._init;try{return Bg(t(e))}catch{}}return null}function FS(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bg(e);case 8:return e===ib?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function hi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function O0(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function OS(t){var e=O0(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(r){s=""+r,i.call(this,r)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(r){s=""+r},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nh(t){t._valueTracker||(t._valueTracker=OS(t))}function W0(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=O0(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function tf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ug(t,e){var n=e.checked;return Re({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fy(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=hi(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function z0(t,e){e=e.checked,e!=null&&ab(t,"checked",e,!1)}function Hg(t,e){z0(t,e);var n=hi(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Vg(t,e.type,n):e.hasOwnProperty("defaultValue")&&Vg(t,e.type,hi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function py(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Vg(t,e,n){(e!=="number"||tf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ol=Array.isArray;function Uo(t,e,n,s){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&s&&(t[n].defaultSelected=!0)}else{for(n=""+hi(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,s&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Gg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return Re({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function gy(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(Ol(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:hi(n)}}function $0(t,e){var n=hi(e.value),s=hi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function my(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function B0(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?B0(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sh,U0=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sh=sh||document.createElement("div"),sh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Su(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},WS=["Webkit","ms","Moz","O"];Object.keys(Fc).forEach(function(t){WS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fc[e]=Fc[t]})});function H0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fc.hasOwnProperty(t)&&Fc[t]?(""+e).trim():e+"px"}function V0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=H0(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,a):t[n]=a}}var zS=Re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xg(t,e){if(e){if(zS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function Yg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kg=null;function lb(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Qg=null,Ho=null,Vo=null;function vy(t){if(t=Yu(t)){if(typeof Qg!="function")throw Error(R(280));var e=t.stateNode;e&&(e=Sp(e),Qg(t.stateNode,t.type,e))}}function G0(t){Ho?Vo?Vo.push(t):Vo=[t]:Ho=t}function q0(){if(Ho){var t=Ho,e=Vo;if(Vo=Ho=null,vy(t),e)for(t=0;t<e.length;t++)vy(e[t])}}function X0(t,e){return t(e)}function Y0(){}var Qp=!1;function K0(t,e,n){if(Qp)return t(e,n);Qp=!0;try{return X0(t,e,n)}finally{Qp=!1,(Ho!==null||Vo!==null)&&(Y0(),q0())}}function _u(t,e){var n=t.stateNode;if(n===null)return null;var s=Sp(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var Jg=!1;if(ia)try{var xl={};Object.defineProperty(xl,"passive",{get:function(){Jg=!0}}),window.addEventListener("test",xl,xl),window.removeEventListener("test",xl,xl)}catch{Jg=!1}function $S(t,e,n,s,a,i,r,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var Oc=!1,nf=null,sf=!1,Zg=null,BS={onError:function(t){Oc=!0,nf=t}};function US(t,e,n,s,a,i,r,l,c){Oc=!1,nf=null,$S.apply(BS,arguments)}function HS(t,e,n,s,a,i,r,l,c){if(US.apply(this,arguments),Oc){if(Oc){var u=nf;Oc=!1,nf=null}else throw Error(R(198));sf||(sf=!0,Zg=u)}}function Ar(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Q0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function by(t){if(Ar(t)!==t)throw Error(R(188))}function VS(t){var e=t.alternate;if(!e){if(e=Ar(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,s=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return by(a),t;if(i===s)return by(a),e;i=i.sibling}throw Error(R(188))}if(n.return!==s.return)n=a,s=i;else{for(var r=!1,l=a.child;l;){if(l===n){r=!0,n=a,s=i;break}if(l===s){r=!0,s=a,n=i;break}l=l.sibling}if(!r){for(l=i.child;l;){if(l===n){r=!0,n=i,s=a;break}if(l===s){r=!0,s=i,n=a;break}l=l.sibling}if(!r)throw Error(R(189))}}if(n.alternate!==s)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function J0(t){return t=VS(t),t!==null?Z0(t):null}function Z0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Z0(t);if(e!==null)return e;t=t.sibling}return null}var ex=fn.unstable_scheduleCallback,yy=fn.unstable_cancelCallback,GS=fn.unstable_shouldYield,qS=fn.unstable_requestPaint,We=fn.unstable_now,XS=fn.unstable_getCurrentPriorityLevel,cb=fn.unstable_ImmediatePriority,tx=fn.unstable_UserBlockingPriority,af=fn.unstable_NormalPriority,YS=fn.unstable_LowPriority,nx=fn.unstable_IdlePriority,wp=null,Cs=null;function KS(t){if(Cs&&typeof Cs.onCommitFiberRoot=="function")try{Cs.onCommitFiberRoot(wp,t,void 0,(t.current.flags&128)===128)}catch{}}var Jn=Math.clz32?Math.clz32:ZS,QS=Math.log,JS=Math.LN2;function ZS(t){return t>>>=0,t===0?32:31-(QS(t)/JS|0)|0}var ah=64,ih=4194304;function Wl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function rf(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,a=t.suspendedLanes,i=t.pingedLanes,r=n&268435455;if(r!==0){var l=r&~a;l!==0?s=Wl(l):(i&=r,i!==0&&(s=Wl(i)))}else r=n&~a,r!==0?s=Wl(r):i!==0&&(s=Wl(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&a)&&(a=s&-s,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Jn(e),a=1<<n,s|=t[n],e&=~a;return s}function e_(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function t_(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var r=31-Jn(i),l=1<<r,c=a[r];c===-1?(!(l&n)||l&s)&&(a[r]=e_(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function em(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function sx(){var t=ah;return ah<<=1,!(ah&4194240)&&(ah=64),t}function Jp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function qu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Jn(e),t[e]=n}function n_(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-Jn(n),i=1<<a;e[a]=0,s[a]=-1,t[a]=-1,n&=~i}}function ub(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Jn(n),a=1<<s;a&e|t[s]&e&&(t[s]|=e),n&=~a}}var me=0;function ax(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ix,hb,rx,ox,lx,tm=!1,rh=[],ni=null,si=null,ai=null,Eu=new Map,Cu=new Map,Oa=[],s_="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wy(t,e){switch(t){case"focusin":case"focusout":ni=null;break;case"dragenter":case"dragleave":si=null;break;case"mouseover":case"mouseout":ai=null;break;case"pointerover":case"pointerout":Eu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cu.delete(e.pointerId)}}function kl(t,e,n,s,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[a]},e!==null&&(e=Yu(e),e!==null&&hb(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function a_(t,e,n,s,a){switch(e){case"focusin":return ni=kl(ni,t,e,n,s,a),!0;case"dragenter":return si=kl(si,t,e,n,s,a),!0;case"mouseover":return ai=kl(ai,t,e,n,s,a),!0;case"pointerover":var i=a.pointerId;return Eu.set(i,kl(Eu.get(i)||null,t,e,n,s,a)),!0;case"gotpointercapture":return i=a.pointerId,Cu.set(i,kl(Cu.get(i)||null,t,e,n,s,a)),!0}return!1}function cx(t){var e=er(t.target);if(e!==null){var n=Ar(e);if(n!==null){if(e=n.tag,e===13){if(e=Q0(n),e!==null){t.blockedOn=e,lx(t.priority,function(){rx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=nm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Kg=s,n.target.dispatchEvent(s),Kg=null}else return e=Yu(n),e!==null&&hb(e),t.blockedOn=n,!1;e.shift()}return!0}function xy(t,e,n){Nh(t)&&n.delete(e)}function i_(){tm=!1,ni!==null&&Nh(ni)&&(ni=null),si!==null&&Nh(si)&&(si=null),ai!==null&&Nh(ai)&&(ai=null),Eu.forEach(xy),Cu.forEach(xy)}function Al(t,e){t.blockedOn===e&&(t.blockedOn=null,tm||(tm=!0,fn.unstable_scheduleCallback(fn.unstable_NormalPriority,i_)))}function Mu(t){function e(a){return Al(a,t)}if(0<rh.length){Al(rh[0],t);for(var n=1;n<rh.length;n++){var s=rh[n];s.blockedOn===t&&(s.blockedOn=null)}}for(ni!==null&&Al(ni,t),si!==null&&Al(si,t),ai!==null&&Al(ai,t),Eu.forEach(e),Cu.forEach(e),n=0;n<Oa.length;n++)s=Oa[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Oa.length&&(n=Oa[0],n.blockedOn===null);)cx(n),n.blockedOn===null&&Oa.shift()}var Go=ca.ReactCurrentBatchConfig,of=!0;function r_(t,e,n,s){var a=me,i=Go.transition;Go.transition=null;try{me=1,db(t,e,n,s)}finally{me=a,Go.transition=i}}function o_(t,e,n,s){var a=me,i=Go.transition;Go.transition=null;try{me=4,db(t,e,n,s)}finally{me=a,Go.transition=i}}function db(t,e,n,s){if(of){var a=nm(t,e,n,s);if(a===null)lg(t,e,s,lf,n),wy(t,s);else if(a_(a,t,e,n,s))s.stopPropagation();else if(wy(t,s),e&4&&-1<s_.indexOf(t)){for(;a!==null;){var i=Yu(a);if(i!==null&&ix(i),i=nm(t,e,n,s),i===null&&lg(t,e,s,lf,n),i===a)break;a=i}a!==null&&s.stopPropagation()}else lg(t,e,s,null,n)}}var lf=null;function nm(t,e,n,s){if(lf=null,t=lb(s),t=er(t),t!==null)if(e=Ar(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Q0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return lf=t,null}function ux(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XS()){case cb:return 1;case tx:return 4;case af:case YS:return 16;case nx:return 536870912;default:return 16}default:return 16}}var Xa=null,fb=null,Ph=null;function hx(){if(Ph)return Ph;var t,e=fb,n=e.length,s,a="value"in Xa?Xa.value:Xa.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var r=n-t;for(s=1;s<=r&&e[n-s]===a[i-s];s++);return Ph=a.slice(t,1<s?1-s:void 0)}function Th(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function oh(){return!0}function ky(){return!1}function gn(t){function e(n,s,a,i,r){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=i,this.target=r,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?oh:ky,this.isPropagationStopped=ky,this}return Re(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=oh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=oh)},persist:function(){},isPersistent:oh}),e}var gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pb=gn(gl),Xu=Re({},gl,{view:0,detail:0}),l_=gn(Xu),Zp,eg,Sl,xp=Re({},Xu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Sl&&(Sl&&t.type==="mousemove"?(Zp=t.screenX-Sl.screenX,eg=t.screenY-Sl.screenY):eg=Zp=0,Sl=t),Zp)},movementY:function(t){return"movementY"in t?t.movementY:eg}}),Ay=gn(xp),c_=Re({},xp,{dataTransfer:0}),u_=gn(c_),h_=Re({},Xu,{relatedTarget:0}),tg=gn(h_),d_=Re({},gl,{animationName:0,elapsedTime:0,pseudoElement:0}),f_=gn(d_),p_=Re({},gl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),g_=gn(p_),m_=Re({},gl,{data:0}),Sy=gn(m_),v_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},b_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},y_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function w_(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=y_[t])?!!e[t]:!1}function gb(){return w_}var x_=Re({},Xu,{key:function(t){if(t.key){var e=v_[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Th(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?b_[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gb,charCode:function(t){return t.type==="keypress"?Th(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Th(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),k_=gn(x_),A_=Re({},xp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_y=gn(A_),S_=Re({},Xu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gb}),__=gn(S_),E_=Re({},gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),C_=gn(E_),M_=Re({},xp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),N_=gn(M_),P_=[9,13,27,32],mb=ia&&"CompositionEvent"in window,Wc=null;ia&&"documentMode"in document&&(Wc=document.documentMode);var T_=ia&&"TextEvent"in window&&!Wc,dx=ia&&(!mb||Wc&&8<Wc&&11>=Wc),Ey=" ",Cy=!1;function fx(t,e){switch(t){case"keyup":return P_.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function px(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var mo=!1;function L_(t,e){switch(t){case"compositionend":return px(e);case"keypress":return e.which!==32?null:(Cy=!0,Ey);case"textInput":return t=e.data,t===Ey&&Cy?null:t;default:return null}}function R_(t,e){if(mo)return t==="compositionend"||!mb&&fx(t,e)?(t=hx(),Ph=fb=Xa=null,mo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return dx&&e.locale!=="ko"?null:e.data;default:return null}}var I_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function My(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!I_[t.type]:e==="textarea"}function gx(t,e,n,s){G0(s),e=cf(e,"onChange"),0<e.length&&(n=new pb("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var zc=null,Nu=null;function D_(t){Ex(t,0)}function kp(t){var e=yo(t);if(W0(e))return t}function j_(t,e){if(t==="change")return e}var mx=!1;if(ia){var ng;if(ia){var sg="oninput"in document;if(!sg){var Ny=document.createElement("div");Ny.setAttribute("oninput","return;"),sg=typeof Ny.oninput=="function"}ng=sg}else ng=!1;mx=ng&&(!document.documentMode||9<document.documentMode)}function Py(){zc&&(zc.detachEvent("onpropertychange",vx),Nu=zc=null)}function vx(t){if(t.propertyName==="value"&&kp(Nu)){var e=[];gx(e,Nu,t,lb(t)),K0(D_,e)}}function F_(t,e,n){t==="focusin"?(Py(),zc=e,Nu=n,zc.attachEvent("onpropertychange",vx)):t==="focusout"&&Py()}function O_(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kp(Nu)}function W_(t,e){if(t==="click")return kp(e)}function z_(t,e){if(t==="input"||t==="change")return kp(e)}function $_(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var es=typeof Object.is=="function"?Object.is:$_;function Pu(t,e){if(es(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!Og.call(e,a)||!es(t[a],e[a]))return!1}return!0}function Ty(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ly(t,e){var n=Ty(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ty(n)}}function bx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?bx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function yx(){for(var t=window,e=tf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=tf(t.document)}return e}function vb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function B_(t){var e=yx(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&bx(n.ownerDocument.documentElement,n)){if(s!==null&&vb(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(s.start,a);s=s.end===void 0?i:Math.min(s.end,a),!t.extend&&i>s&&(a=s,s=i,i=a),a=Ly(n,i);var r=Ly(n,s);a&&r&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==r.node||t.focusOffset!==r.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(r.node,r.offset)):(e.setEnd(r.node,r.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var U_=ia&&"documentMode"in document&&11>=document.documentMode,vo=null,sm=null,$c=null,am=!1;function Ry(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;am||vo==null||vo!==tf(s)||(s=vo,"selectionStart"in s&&vb(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),$c&&Pu($c,s)||($c=s,s=cf(sm,"onSelect"),0<s.length&&(e=new pb("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=vo)))}function lh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var bo={animationend:lh("Animation","AnimationEnd"),animationiteration:lh("Animation","AnimationIteration"),animationstart:lh("Animation","AnimationStart"),transitionend:lh("Transition","TransitionEnd")},ag={},wx={};ia&&(wx=document.createElement("div").style,"AnimationEvent"in window||(delete bo.animationend.animation,delete bo.animationiteration.animation,delete bo.animationstart.animation),"TransitionEvent"in window||delete bo.transitionend.transition);function Ap(t){if(ag[t])return ag[t];if(!bo[t])return t;var e=bo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in wx)return ag[t]=e[n];return t}var xx=Ap("animationend"),kx=Ap("animationiteration"),Ax=Ap("animationstart"),Sx=Ap("transitionend"),_x=new Map,Iy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function mi(t,e){_x.set(t,e),kr(e,[t])}for(var ig=0;ig<Iy.length;ig++){var rg=Iy[ig],H_=rg.toLowerCase(),V_=rg[0].toUpperCase()+rg.slice(1);mi(H_,"on"+V_)}mi(xx,"onAnimationEnd");mi(kx,"onAnimationIteration");mi(Ax,"onAnimationStart");mi("dblclick","onDoubleClick");mi("focusin","onFocus");mi("focusout","onBlur");mi(Sx,"onTransitionEnd");al("onMouseEnter",["mouseout","mouseover"]);al("onMouseLeave",["mouseout","mouseover"]);al("onPointerEnter",["pointerout","pointerover"]);al("onPointerLeave",["pointerout","pointerover"]);kr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));kr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));kr("onBeforeInput",["compositionend","keypress","textInput","paste"]);kr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));kr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));kr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),G_=new Set("cancel close invalid load scroll toggle".split(" ").concat(zl));function Dy(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,HS(s,e,void 0,t),t.currentTarget=null}function Ex(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],a=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var r=s.length-1;0<=r;r--){var l=s[r],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;Dy(a,l,u),i=c}else for(r=0;r<s.length;r++){if(l=s[r],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;Dy(a,l,u),i=c}}}if(sf)throw t=Zg,sf=!1,Zg=null,t}function ke(t,e){var n=e[cm];n===void 0&&(n=e[cm]=new Set);var s=t+"__bubble";n.has(s)||(Cx(e,t,2,!1),n.add(s))}function og(t,e,n){var s=0;e&&(s|=4),Cx(n,t,s,e)}var ch="_reactListening"+Math.random().toString(36).slice(2);function Tu(t){if(!t[ch]){t[ch]=!0,I0.forEach(function(n){n!=="selectionchange"&&(G_.has(n)||og(n,!1,t),og(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ch]||(e[ch]=!0,og("selectionchange",!1,e))}}function Cx(t,e,n,s){switch(ux(e)){case 1:var a=r_;break;case 4:a=o_;break;default:a=db}n=a.bind(null,e,n,t),a=void 0,!Jg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),s?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function lg(t,e,n,s,a){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var r=s.tag;if(r===3||r===4){var l=s.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(r===4)for(r=s.return;r!==null;){var c=r.tag;if((c===3||c===4)&&(c=r.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;r=r.return}for(;l!==null;){if(r=er(l),r===null)return;if(c=r.tag,c===5||c===6){s=i=r;continue e}l=l.parentNode}}s=s.return}K0(function(){var u=i,h=lb(n),d=[];e:{var f=_x.get(t);if(f!==void 0){var g=pb,v=t;switch(t){case"keypress":if(Th(n)===0)break e;case"keydown":case"keyup":g=k_;break;case"focusin":v="focus",g=tg;break;case"focusout":v="blur",g=tg;break;case"beforeblur":case"afterblur":g=tg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Ay;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=u_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=__;break;case xx:case kx:case Ax:g=f_;break;case Sx:g=C_;break;case"scroll":g=l_;break;case"wheel":g=N_;break;case"copy":case"cut":case"paste":g=g_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=_y}var y=(e&4)!==0,S=!y&&t==="scroll",b=y?f!==null?f+"Capture":null:f;y=[];for(var x=u,w;x!==null;){w=x;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,b!==null&&(_=_u(x,b),_!=null&&y.push(Lu(x,_,w)))),S)break;x=x.return}0<y.length&&(f=new g(f,v,null,n,h),d.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",f&&n!==Kg&&(v=n.relatedTarget||n.fromElement)&&(er(v)||v[ra]))break e;if((g||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,g?(v=n.relatedTarget||n.toElement,g=u,v=v?er(v):null,v!==null&&(S=Ar(v),v!==S||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=u),g!==v)){if(y=Ay,_="onMouseLeave",b="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(y=_y,_="onPointerLeave",b="onPointerEnter",x="pointer"),S=g==null?f:yo(g),w=v==null?f:yo(v),f=new y(_,x+"leave",g,n,h),f.target=S,f.relatedTarget=w,_=null,er(h)===u&&(y=new y(b,x+"enter",v,n,h),y.target=w,y.relatedTarget=S,_=y),S=_,g&&v)t:{for(y=g,b=v,x=0,w=y;w;w=Cr(w))x++;for(w=0,_=b;_;_=Cr(_))w++;for(;0<x-w;)y=Cr(y),x--;for(;0<w-x;)b=Cr(b),w--;for(;x--;){if(y===b||b!==null&&y===b.alternate)break t;y=Cr(y),b=Cr(b)}y=null}else y=null;g!==null&&jy(d,f,g,y,!1),v!==null&&S!==null&&jy(d,S,v,y,!0)}}e:{if(f=u?yo(u):window,g=f.nodeName&&f.nodeName.toLowerCase(),g==="select"||g==="input"&&f.type==="file")var E=j_;else if(My(f))if(mx)E=z_;else{E=O_;var M=F_}else(g=f.nodeName)&&g.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=W_);if(E&&(E=E(t,u))){gx(d,E,n,h);break e}M&&M(t,f,u),t==="focusout"&&(M=f._wrapperState)&&M.controlled&&f.type==="number"&&Vg(f,"number",f.value)}switch(M=u?yo(u):window,t){case"focusin":(My(M)||M.contentEditable==="true")&&(vo=M,sm=u,$c=null);break;case"focusout":$c=sm=vo=null;break;case"mousedown":am=!0;break;case"contextmenu":case"mouseup":case"dragend":am=!1,Ry(d,n,h);break;case"selectionchange":if(U_)break;case"keydown":case"keyup":Ry(d,n,h)}var N;if(mb)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else mo?fx(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(dx&&n.locale!=="ko"&&(mo||P!=="onCompositionStart"?P==="onCompositionEnd"&&mo&&(N=hx()):(Xa=h,fb="value"in Xa?Xa.value:Xa.textContent,mo=!0)),M=cf(u,P),0<M.length&&(P=new Sy(P,t,null,n,h),d.push({event:P,listeners:M}),N?P.data=N:(N=px(n),N!==null&&(P.data=N)))),(N=T_?L_(t,n):R_(t,n))&&(u=cf(u,"onBeforeInput"),0<u.length&&(h=new Sy("onBeforeInput","beforeinput",null,n,h),d.push({event:h,listeners:u}),h.data=N))}Ex(d,e)})}function Lu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function cf(t,e){for(var n=e+"Capture",s=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=_u(t,n),i!=null&&s.unshift(Lu(t,i,a)),i=_u(t,e),i!=null&&s.push(Lu(t,i,a))),t=t.return}return s}function Cr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function jy(t,e,n,s,a){for(var i=e._reactName,r=[];n!==null&&n!==s;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,a?(c=_u(n,i),c!=null&&r.unshift(Lu(n,c,l))):a||(c=_u(n,i),c!=null&&r.push(Lu(n,c,l)))),n=n.return}r.length!==0&&t.push({event:e,listeners:r})}var q_=/\r\n?/g,X_=/\u0000|\uFFFD/g;function Fy(t){return(typeof t=="string"?t:""+t).replace(q_,`
`).replace(X_,"")}function uh(t,e,n){if(e=Fy(e),Fy(t)!==e&&n)throw Error(R(425))}function uf(){}var im=null,rm=null;function om(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lm=typeof setTimeout=="function"?setTimeout:void 0,Y_=typeof clearTimeout=="function"?clearTimeout:void 0,Oy=typeof Promise=="function"?Promise:void 0,K_=typeof queueMicrotask=="function"?queueMicrotask:typeof Oy<"u"?function(t){return Oy.resolve(null).then(t).catch(Q_)}:lm;function Q_(t){setTimeout(function(){throw t})}function cg(t,e){var n=e,s=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){t.removeChild(a),Mu(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);Mu(e)}function ii(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Wy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ml=Math.random().toString(36).slice(2),Ss="__reactFiber$"+ml,Ru="__reactProps$"+ml,ra="__reactContainer$"+ml,cm="__reactEvents$"+ml,J_="__reactListeners$"+ml,Z_="__reactHandles$"+ml;function er(t){var e=t[Ss];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ra]||n[Ss]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Wy(t);t!==null;){if(n=t[Ss])return n;t=Wy(t)}return e}t=n,n=t.parentNode}return null}function Yu(t){return t=t[Ss]||t[ra],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function yo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function Sp(t){return t[Ru]||null}var um=[],wo=-1;function vi(t){return{current:t}}function Se(t){0>wo||(t.current=um[wo],um[wo]=null,wo--)}function xe(t,e){wo++,um[wo]=t.current,t.current=e}var di={},Pt=vi(di),Zt=vi(!1),pr=di;function il(t,e){var n=t.type.contextTypes;if(!n)return di;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function en(t){return t=t.childContextTypes,t!=null}function hf(){Se(Zt),Se(Pt)}function zy(t,e,n){if(Pt.current!==di)throw Error(R(168));xe(Pt,e),xe(Zt,n)}function Mx(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in e))throw Error(R(108,FS(t)||"Unknown",a));return Re({},n,s)}function df(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||di,pr=Pt.current,xe(Pt,t),xe(Zt,Zt.current),!0}function $y(t,e,n){var s=t.stateNode;if(!s)throw Error(R(169));n?(t=Mx(t,e,pr),s.__reactInternalMemoizedMergedChildContext=t,Se(Zt),Se(Pt),xe(Pt,t)):Se(Zt),xe(Zt,n)}var Xs=null,_p=!1,ug=!1;function Nx(t){Xs===null?Xs=[t]:Xs.push(t)}function eE(t){_p=!0,Nx(t)}function bi(){if(!ug&&Xs!==null){ug=!0;var t=0,e=me;try{var n=Xs;for(me=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Xs=null,_p=!1}catch(a){throw Xs!==null&&(Xs=Xs.slice(t+1)),ex(cb,bi),a}finally{me=e,ug=!1}}return null}var xo=[],ko=0,ff=null,pf=0,Ln=[],Rn=0,gr=null,na=1,sa="";function xi(t,e){xo[ko++]=pf,xo[ko++]=ff,ff=t,pf=e}function Px(t,e,n){Ln[Rn++]=na,Ln[Rn++]=sa,Ln[Rn++]=gr,gr=t;var s=na;t=sa;var a=32-Jn(s)-1;s&=~(1<<a),n+=1;var i=32-Jn(e)+a;if(30<i){var r=a-a%5;i=(s&(1<<r)-1).toString(32),s>>=r,a-=r,na=1<<32-Jn(e)+a|n<<a|s,sa=i+t}else na=1<<i|n<<a|s,sa=t}function bb(t){t.return!==null&&(xi(t,1),Px(t,1,0))}function yb(t){for(;t===ff;)ff=xo[--ko],xo[ko]=null,pf=xo[--ko],xo[ko]=null;for(;t===gr;)gr=Ln[--Rn],Ln[Rn]=null,sa=Ln[--Rn],Ln[Rn]=null,na=Ln[--Rn],Ln[Rn]=null}var dn=null,hn=null,Ne=!1,Qn=null;function Tx(t,e){var n=In(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function By(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,dn=t,hn=ii(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,dn=t,hn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=gr!==null?{id:na,overflow:sa}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=In(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,dn=t,hn=null,!0):!1;default:return!1}}function hm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function dm(t){if(Ne){var e=hn;if(e){var n=e;if(!By(t,e)){if(hm(t))throw Error(R(418));e=ii(n.nextSibling);var s=dn;e&&By(t,e)?Tx(s,n):(t.flags=t.flags&-4097|2,Ne=!1,dn=t)}}else{if(hm(t))throw Error(R(418));t.flags=t.flags&-4097|2,Ne=!1,dn=t}}}function Uy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;dn=t}function hh(t){if(t!==dn)return!1;if(!Ne)return Uy(t),Ne=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!om(t.type,t.memoizedProps)),e&&(e=hn)){if(hm(t))throw Lx(),Error(R(418));for(;e;)Tx(t,e),e=ii(e.nextSibling)}if(Uy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){hn=ii(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}hn=null}}else hn=dn?ii(t.stateNode.nextSibling):null;return!0}function Lx(){for(var t=hn;t;)t=ii(t.nextSibling)}function rl(){hn=dn=null,Ne=!1}function wb(t){Qn===null?Qn=[t]:Qn.push(t)}var tE=ca.ReactCurrentBatchConfig;function _l(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var s=n.stateNode}if(!s)throw Error(R(147,t));var a=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(r){var l=a.refs;r===null?delete l[i]:l[i]=r},e._stringRef=i,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function dh(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Hy(t){var e=t._init;return e(t._payload)}function Rx(t){function e(b,x){if(t){var w=b.deletions;w===null?(b.deletions=[x],b.flags|=16):w.push(x)}}function n(b,x){if(!t)return null;for(;x!==null;)e(b,x),x=x.sibling;return null}function s(b,x){for(b=new Map;x!==null;)x.key!==null?b.set(x.key,x):b.set(x.index,x),x=x.sibling;return b}function a(b,x){return b=ci(b,x),b.index=0,b.sibling=null,b}function i(b,x,w){return b.index=w,t?(w=b.alternate,w!==null?(w=w.index,w<x?(b.flags|=2,x):w):(b.flags|=2,x)):(b.flags|=1048576,x)}function r(b){return t&&b.alternate===null&&(b.flags|=2),b}function l(b,x,w,_){return x===null||x.tag!==6?(x=vg(w,b.mode,_),x.return=b,x):(x=a(x,w),x.return=b,x)}function c(b,x,w,_){var E=w.type;return E===go?h(b,x,w.props.children,_,w.key):x!==null&&(x.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Na&&Hy(E)===x.type)?(_=a(x,w.props),_.ref=_l(b,x,w),_.return=b,_):(_=Oh(w.type,w.key,w.props,null,b.mode,_),_.ref=_l(b,x,w),_.return=b,_)}function u(b,x,w,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==w.containerInfo||x.stateNode.implementation!==w.implementation?(x=bg(w,b.mode,_),x.return=b,x):(x=a(x,w.children||[]),x.return=b,x)}function h(b,x,w,_,E){return x===null||x.tag!==7?(x=fr(w,b.mode,_,E),x.return=b,x):(x=a(x,w),x.return=b,x)}function d(b,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return x=vg(""+x,b.mode,w),x.return=b,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case th:return w=Oh(x.type,x.key,x.props,null,b.mode,w),w.ref=_l(b,null,x),w.return=b,w;case po:return x=bg(x,b.mode,w),x.return=b,x;case Na:var _=x._init;return d(b,_(x._payload),w)}if(Ol(x)||wl(x))return x=fr(x,b.mode,w,null),x.return=b,x;dh(b,x)}return null}function f(b,x,w,_){var E=x!==null?x.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return E!==null?null:l(b,x,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case th:return w.key===E?c(b,x,w,_):null;case po:return w.key===E?u(b,x,w,_):null;case Na:return E=w._init,f(b,x,E(w._payload),_)}if(Ol(w)||wl(w))return E!==null?null:h(b,x,w,_,null);dh(b,w)}return null}function g(b,x,w,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return b=b.get(w)||null,l(x,b,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case th:return b=b.get(_.key===null?w:_.key)||null,c(x,b,_,E);case po:return b=b.get(_.key===null?w:_.key)||null,u(x,b,_,E);case Na:var M=_._init;return g(b,x,w,M(_._payload),E)}if(Ol(_)||wl(_))return b=b.get(w)||null,h(x,b,_,E,null);dh(x,_)}return null}function v(b,x,w,_){for(var E=null,M=null,N=x,P=x=0,T=null;N!==null&&P<w.length;P++){N.index>P?(T=N,N=null):T=N.sibling;var I=f(b,N,w[P],_);if(I===null){N===null&&(N=T);break}t&&N&&I.alternate===null&&e(b,N),x=i(I,x,P),M===null?E=I:M.sibling=I,M=I,N=T}if(P===w.length)return n(b,N),Ne&&xi(b,P),E;if(N===null){for(;P<w.length;P++)N=d(b,w[P],_),N!==null&&(x=i(N,x,P),M===null?E=N:M.sibling=N,M=N);return Ne&&xi(b,P),E}for(N=s(b,N);P<w.length;P++)T=g(N,b,P,w[P],_),T!==null&&(t&&T.alternate!==null&&N.delete(T.key===null?P:T.key),x=i(T,x,P),M===null?E=T:M.sibling=T,M=T);return t&&N.forEach(function(V){return e(b,V)}),Ne&&xi(b,P),E}function y(b,x,w,_){var E=wl(w);if(typeof E!="function")throw Error(R(150));if(w=E.call(w),w==null)throw Error(R(151));for(var M=E=null,N=x,P=x=0,T=null,I=w.next();N!==null&&!I.done;P++,I=w.next()){N.index>P?(T=N,N=null):T=N.sibling;var V=f(b,N,I.value,_);if(V===null){N===null&&(N=T);break}t&&N&&V.alternate===null&&e(b,N),x=i(V,x,P),M===null?E=V:M.sibling=V,M=V,N=T}if(I.done)return n(b,N),Ne&&xi(b,P),E;if(N===null){for(;!I.done;P++,I=w.next())I=d(b,I.value,_),I!==null&&(x=i(I,x,P),M===null?E=I:M.sibling=I,M=I);return Ne&&xi(b,P),E}for(N=s(b,N);!I.done;P++,I=w.next())I=g(N,b,P,I.value,_),I!==null&&(t&&I.alternate!==null&&N.delete(I.key===null?P:I.key),x=i(I,x,P),M===null?E=I:M.sibling=I,M=I);return t&&N.forEach(function(re){return e(b,re)}),Ne&&xi(b,P),E}function S(b,x,w,_){if(typeof w=="object"&&w!==null&&w.type===go&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case th:e:{for(var E=w.key,M=x;M!==null;){if(M.key===E){if(E=w.type,E===go){if(M.tag===7){n(b,M.sibling),x=a(M,w.props.children),x.return=b,b=x;break e}}else if(M.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Na&&Hy(E)===M.type){n(b,M.sibling),x=a(M,w.props),x.ref=_l(b,M,w),x.return=b,b=x;break e}n(b,M);break}else e(b,M);M=M.sibling}w.type===go?(x=fr(w.props.children,b.mode,_,w.key),x.return=b,b=x):(_=Oh(w.type,w.key,w.props,null,b.mode,_),_.ref=_l(b,x,w),_.return=b,b=_)}return r(b);case po:e:{for(M=w.key;x!==null;){if(x.key===M)if(x.tag===4&&x.stateNode.containerInfo===w.containerInfo&&x.stateNode.implementation===w.implementation){n(b,x.sibling),x=a(x,w.children||[]),x.return=b,b=x;break e}else{n(b,x);break}else e(b,x);x=x.sibling}x=bg(w,b.mode,_),x.return=b,b=x}return r(b);case Na:return M=w._init,S(b,x,M(w._payload),_)}if(Ol(w))return v(b,x,w,_);if(wl(w))return y(b,x,w,_);dh(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,x!==null&&x.tag===6?(n(b,x.sibling),x=a(x,w),x.return=b,b=x):(n(b,x),x=vg(w,b.mode,_),x.return=b,b=x),r(b)):n(b,x)}return S}var ol=Rx(!0),Ix=Rx(!1),gf=vi(null),mf=null,Ao=null,xb=null;function kb(){xb=Ao=mf=null}function Ab(t){var e=gf.current;Se(gf),t._currentValue=e}function fm(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function qo(t,e){mf=t,xb=Ao=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qt=!0),t.firstContext=null)}function jn(t){var e=t._currentValue;if(xb!==t)if(t={context:t,memoizedValue:e,next:null},Ao===null){if(mf===null)throw Error(R(308));Ao=t,mf.dependencies={lanes:0,firstContext:t}}else Ao=Ao.next=t;return e}var tr=null;function Sb(t){tr===null?tr=[t]:tr.push(t)}function Dx(t,e,n,s){var a=e.interleaved;return a===null?(n.next=n,Sb(e)):(n.next=a.next,a.next=n),e.interleaved=n,oa(t,s)}function oa(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pa=!1;function _b(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function aa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ri(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,le&2){var a=s.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),s.pending=e,oa(t,n)}return a=s.interleaved,a===null?(e.next=e,Sb(s)):(e.next=a.next,a.next=e),s.interleaved=e,oa(t,n)}function Lh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ub(t,n)}}function Vy(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var r={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=r:i=i.next=r,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vf(t,e,n,s){var a=t.updateQueue;Pa=!1;var i=a.firstBaseUpdate,r=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,r===null?i=u:r.next=u,r=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==r&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(i!==null){var d=a.baseState;r=0,h=u=c=null,l=i;do{var f=l.lane,g=l.eventTime;if((s&f)===f){h!==null&&(h=h.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=t,y=l;switch(f=e,g=n,y.tag){case 1:if(v=y.payload,typeof v=="function"){d=v.call(g,d,f);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=y.payload,f=typeof v=="function"?v.call(g,d,f):v,f==null)break e;d=Re({},d,f);break e;case 2:Pa=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=a.effects,f===null?a.effects=[l]:f.push(l))}else g={eventTime:g,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=g,c=d):h=h.next=g,r|=f;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;f=l,l=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(h===null&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=h,e=a.shared.interleaved,e!==null){a=e;do r|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);vr|=r,t.lanes=r,t.memoizedState=d}}function Gy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(R(191,a));a.call(s)}}}var Ku={},Ms=vi(Ku),Iu=vi(Ku),Du=vi(Ku);function nr(t){if(t===Ku)throw Error(R(174));return t}function Eb(t,e){switch(xe(Du,e),xe(Iu,t),xe(Ms,Ku),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qg(e,t)}Se(Ms),xe(Ms,e)}function ll(){Se(Ms),Se(Iu),Se(Du)}function Fx(t){nr(Du.current);var e=nr(Ms.current),n=qg(e,t.type);e!==n&&(xe(Iu,t),xe(Ms,n))}function Cb(t){Iu.current===t&&(Se(Ms),Se(Iu))}var Pe=vi(0);function bf(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hg=[];function Mb(){for(var t=0;t<hg.length;t++)hg[t]._workInProgressVersionPrimary=null;hg.length=0}var Rh=ca.ReactCurrentDispatcher,dg=ca.ReactCurrentBatchConfig,mr=0,Te=null,Ke=null,tt=null,yf=!1,Bc=!1,ju=0,nE=0;function vt(){throw Error(R(321))}function Nb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!es(t[n],e[n]))return!1;return!0}function Pb(t,e,n,s,a,i){if(mr=i,Te=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Rh.current=t===null||t.memoizedState===null?rE:oE,t=n(s,a),Bc){i=0;do{if(Bc=!1,ju=0,25<=i)throw Error(R(301));i+=1,tt=Ke=null,e.updateQueue=null,Rh.current=lE,t=n(s,a)}while(Bc)}if(Rh.current=wf,e=Ke!==null&&Ke.next!==null,mr=0,tt=Ke=Te=null,yf=!1,e)throw Error(R(300));return t}function Tb(){var t=ju!==0;return ju=0,t}function cs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return tt===null?Te.memoizedState=tt=t:tt=tt.next=t,tt}function Fn(){if(Ke===null){var t=Te.alternate;t=t!==null?t.memoizedState:null}else t=Ke.next;var e=tt===null?Te.memoizedState:tt.next;if(e!==null)tt=e,Ke=t;else{if(t===null)throw Error(R(310));Ke=t,t={memoizedState:Ke.memoizedState,baseState:Ke.baseState,baseQueue:Ke.baseQueue,queue:Ke.queue,next:null},tt===null?Te.memoizedState=tt=t:tt=tt.next=t}return tt}function Fu(t,e){return typeof e=="function"?e(t):e}function fg(t){var e=Fn(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var s=Ke,a=s.baseQueue,i=n.pending;if(i!==null){if(a!==null){var r=a.next;a.next=i.next,i.next=r}s.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,s=s.baseState;var l=r=null,c=null,u=i;do{var h=u.lane;if((mr&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=d,r=s):c=c.next=d,Te.lanes|=h,vr|=h}u=u.next}while(u!==null&&u!==i);c===null?r=s:c.next=l,es(s,e.memoizedState)||(Qt=!0),e.memoizedState=s,e.baseState=r,e.baseQueue=c,n.lastRenderedState=s}if(t=n.interleaved,t!==null){a=t;do i=a.lane,Te.lanes|=i,vr|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function pg(t){var e=Fn(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var s=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var r=a=a.next;do i=t(i,r.action),r=r.next;while(r!==a);es(i,e.memoizedState)||(Qt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function Ox(){}function Wx(t,e){var n=Te,s=Fn(),a=e(),i=!es(s.memoizedState,a);if(i&&(s.memoizedState=a,Qt=!0),s=s.queue,Lb(Bx.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||tt!==null&&tt.memoizedState.tag&1){if(n.flags|=2048,Ou(9,$x.bind(null,n,s,a,e),void 0,null),nt===null)throw Error(R(349));mr&30||zx(n,e,a)}return a}function zx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Te.updateQueue,e===null?(e={lastEffect:null,stores:null},Te.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function $x(t,e,n,s){e.value=n,e.getSnapshot=s,Ux(e)&&Hx(t)}function Bx(t,e,n){return n(function(){Ux(e)&&Hx(t)})}function Ux(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!es(t,n)}catch{return!0}}function Hx(t){var e=oa(t,1);e!==null&&Zn(e,t,1,-1)}function qy(t){var e=cs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fu,lastRenderedState:t},e.queue=t,t=t.dispatch=iE.bind(null,Te,t),[e.memoizedState,t]}function Ou(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Te.updateQueue,e===null?(e={lastEffect:null,stores:null},Te.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function Vx(){return Fn().memoizedState}function Ih(t,e,n,s){var a=cs();Te.flags|=t,a.memoizedState=Ou(1|e,n,void 0,s===void 0?null:s)}function Ep(t,e,n,s){var a=Fn();s=s===void 0?null:s;var i=void 0;if(Ke!==null){var r=Ke.memoizedState;if(i=r.destroy,s!==null&&Nb(s,r.deps)){a.memoizedState=Ou(e,n,i,s);return}}Te.flags|=t,a.memoizedState=Ou(1|e,n,i,s)}function Xy(t,e){return Ih(8390656,8,t,e)}function Lb(t,e){return Ep(2048,8,t,e)}function Gx(t,e){return Ep(4,2,t,e)}function qx(t,e){return Ep(4,4,t,e)}function Xx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Yx(t,e,n){return n=n!=null?n.concat([t]):null,Ep(4,4,Xx.bind(null,e,t),n)}function Rb(){}function Kx(t,e){var n=Fn();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Nb(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function Qx(t,e){var n=Fn();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Nb(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function Jx(t,e,n){return mr&21?(es(n,e)||(n=sx(),Te.lanes|=n,vr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qt=!0),t.memoizedState=n)}function sE(t,e){var n=me;me=n!==0&&4>n?n:4,t(!0);var s=dg.transition;dg.transition={};try{t(!1),e()}finally{me=n,dg.transition=s}}function Zx(){return Fn().memoizedState}function aE(t,e,n){var s=li(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},e1(t))t1(e,n);else if(n=Dx(t,e,n,s),n!==null){var a=Ot();Zn(n,t,s,a),n1(n,e,s)}}function iE(t,e,n){var s=li(t),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(e1(t))t1(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var r=e.lastRenderedState,l=i(r,n);if(a.hasEagerState=!0,a.eagerState=l,es(l,r)){var c=e.interleaved;c===null?(a.next=a,Sb(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}n=Dx(t,e,a,s),n!==null&&(a=Ot(),Zn(n,t,s,a),n1(n,e,s))}}function e1(t){var e=t.alternate;return t===Te||e!==null&&e===Te}function t1(t,e){Bc=yf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function n1(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,ub(t,n)}}var wf={readContext:jn,useCallback:vt,useContext:vt,useEffect:vt,useImperativeHandle:vt,useInsertionEffect:vt,useLayoutEffect:vt,useMemo:vt,useReducer:vt,useRef:vt,useState:vt,useDebugValue:vt,useDeferredValue:vt,useTransition:vt,useMutableSource:vt,useSyncExternalStore:vt,useId:vt,unstable_isNewReconciler:!1},rE={readContext:jn,useCallback:function(t,e){return cs().memoizedState=[t,e===void 0?null:e],t},useContext:jn,useEffect:Xy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ih(4194308,4,Xx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ih(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ih(4,2,t,e)},useMemo:function(t,e){var n=cs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=cs();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=aE.bind(null,Te,t),[s.memoizedState,t]},useRef:function(t){var e=cs();return t={current:t},e.memoizedState=t},useState:qy,useDebugValue:Rb,useDeferredValue:function(t){return cs().memoizedState=t},useTransition:function(){var t=qy(!1),e=t[0];return t=sE.bind(null,t[1]),cs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Te,a=cs();if(Ne){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),nt===null)throw Error(R(349));mr&30||zx(s,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,Xy(Bx.bind(null,s,i,t),[t]),s.flags|=2048,Ou(9,$x.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=cs(),e=nt.identifierPrefix;if(Ne){var n=sa,s=na;n=(s&~(1<<32-Jn(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=ju++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=nE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},oE={readContext:jn,useCallback:Kx,useContext:jn,useEffect:Lb,useImperativeHandle:Yx,useInsertionEffect:Gx,useLayoutEffect:qx,useMemo:Qx,useReducer:fg,useRef:Vx,useState:function(){return fg(Fu)},useDebugValue:Rb,useDeferredValue:function(t){var e=Fn();return Jx(e,Ke.memoizedState,t)},useTransition:function(){var t=fg(Fu)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:Ox,useSyncExternalStore:Wx,useId:Zx,unstable_isNewReconciler:!1},lE={readContext:jn,useCallback:Kx,useContext:jn,useEffect:Lb,useImperativeHandle:Yx,useInsertionEffect:Gx,useLayoutEffect:qx,useMemo:Qx,useReducer:pg,useRef:Vx,useState:function(){return pg(Fu)},useDebugValue:Rb,useDeferredValue:function(t){var e=Fn();return Ke===null?e.memoizedState=t:Jx(e,Ke.memoizedState,t)},useTransition:function(){var t=pg(Fu)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:Ox,useSyncExternalStore:Wx,useId:Zx,unstable_isNewReconciler:!1};function qn(t,e){if(t&&t.defaultProps){e=Re({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function pm(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Re({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Cp={isMounted:function(t){return(t=t._reactInternals)?Ar(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Ot(),a=li(t),i=aa(s,a);i.payload=e,n!=null&&(i.callback=n),e=ri(t,i,a),e!==null&&(Zn(e,t,a,s),Lh(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Ot(),a=li(t),i=aa(s,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ri(t,i,a),e!==null&&(Zn(e,t,a,s),Lh(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ot(),s=li(t),a=aa(n,s);a.tag=2,e!=null&&(a.callback=e),e=ri(t,a,s),e!==null&&(Zn(e,t,s,n),Lh(e,t,s))}};function Yy(t,e,n,s,a,i,r){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,r):e.prototype&&e.prototype.isPureReactComponent?!Pu(n,s)||!Pu(a,i):!0}function s1(t,e,n){var s=!1,a=di,i=e.contextType;return typeof i=="object"&&i!==null?i=jn(i):(a=en(e)?pr:Pt.current,s=e.contextTypes,i=(s=s!=null)?il(t,a):di),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cp,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function Ky(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Cp.enqueueReplaceState(e,e.state,null)}function gm(t,e,n,s){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},_b(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=jn(i):(i=en(e)?pr:Pt.current,a.context=il(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(pm(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Cp.enqueueReplaceState(a,a.state,null),vf(t,n,a,s),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function cl(t,e){try{var n="",s=e;do n+=jS(s),s=s.return;while(s);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function gg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function mm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var cE=typeof WeakMap=="function"?WeakMap:Map;function a1(t,e,n){n=aa(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){kf||(kf=!0,_m=s),mm(t,e)},n}function i1(t,e,n){n=aa(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var a=e.value;n.payload=function(){return s(a)},n.callback=function(){mm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){mm(t,e),typeof s!="function"&&(oi===null?oi=new Set([this]):oi.add(this));var r=e.stack;this.componentDidCatch(e.value,{componentStack:r!==null?r:""})}),n}function Qy(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new cE;var a=new Set;s.set(e,a)}else a=s.get(e),a===void 0&&(a=new Set,s.set(e,a));a.has(n)||(a.add(n),t=AE.bind(null,t,e,n),e.then(t,t))}function Jy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zy(t,e,n,s,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=aa(-1,1),e.tag=2,ri(n,e,1))),n.lanes|=1),t)}var uE=ca.ReactCurrentOwner,Qt=!1;function Dt(t,e,n,s){e.child=t===null?Ix(e,null,n,s):ol(e,t.child,n,s)}function ew(t,e,n,s,a){n=n.render;var i=e.ref;return qo(e,a),s=Pb(t,e,n,s,i,a),n=Tb(),t!==null&&!Qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,la(t,e,a)):(Ne&&n&&bb(e),e.flags|=1,Dt(t,e,s,a),e.child)}function tw(t,e,n,s,a){if(t===null){var i=n.type;return typeof i=="function"&&!$b(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,r1(t,e,i,s,a)):(t=Oh(n.type,null,s,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var r=i.memoizedProps;if(n=n.compare,n=n!==null?n:Pu,n(r,s)&&t.ref===e.ref)return la(t,e,a)}return e.flags|=1,t=ci(i,s),t.ref=e.ref,t.return=e,e.child=t}function r1(t,e,n,s,a){if(t!==null){var i=t.memoizedProps;if(Pu(i,s)&&t.ref===e.ref)if(Qt=!1,e.pendingProps=s=i,(t.lanes&a)!==0)t.flags&131072&&(Qt=!0);else return e.lanes=t.lanes,la(t,e,a)}return vm(t,e,n,s,a)}function o1(t,e,n){var s=e.pendingProps,a=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xe(_o,on),on|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xe(_o,on),on|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,xe(_o,on),on|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,xe(_o,on),on|=s;return Dt(t,e,a,n),e.child}function l1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function vm(t,e,n,s,a){var i=en(n)?pr:Pt.current;return i=il(e,i),qo(e,a),n=Pb(t,e,n,s,i,a),s=Tb(),t!==null&&!Qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,la(t,e,a)):(Ne&&s&&bb(e),e.flags|=1,Dt(t,e,n,a),e.child)}function nw(t,e,n,s,a){if(en(n)){var i=!0;df(e)}else i=!1;if(qo(e,a),e.stateNode===null)Dh(t,e),s1(e,n,s),gm(e,n,s,a),s=!0;else if(t===null){var r=e.stateNode,l=e.memoizedProps;r.props=l;var c=r.context,u=n.contextType;typeof u=="object"&&u!==null?u=jn(u):(u=en(n)?pr:Pt.current,u=il(e,u));var h=n.getDerivedStateFromProps,d=typeof h=="function"||typeof r.getSnapshotBeforeUpdate=="function";d||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(l!==s||c!==u)&&Ky(e,r,s,u),Pa=!1;var f=e.memoizedState;r.state=f,vf(e,s,r,a),c=e.memoizedState,l!==s||f!==c||Zt.current||Pa?(typeof h=="function"&&(pm(e,n,h,s),c=e.memoizedState),(l=Pa||Yy(e,n,l,s,f,c,u))?(d||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount()),typeof r.componentDidMount=="function"&&(e.flags|=4194308)):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),r.props=s,r.state=c,r.context=u,s=l):(typeof r.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{r=e.stateNode,jx(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:qn(e.type,l),r.props=u,d=e.pendingProps,f=r.context,c=n.contextType,typeof c=="object"&&c!==null?c=jn(c):(c=en(n)?pr:Pt.current,c=il(e,c));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof r.getSnapshotBeforeUpdate=="function")||typeof r.UNSAFE_componentWillReceiveProps!="function"&&typeof r.componentWillReceiveProps!="function"||(l!==d||f!==c)&&Ky(e,r,s,c),Pa=!1,f=e.memoizedState,r.state=f,vf(e,s,r,a);var v=e.memoizedState;l!==d||f!==v||Zt.current||Pa?(typeof g=="function"&&(pm(e,n,g,s),v=e.memoizedState),(u=Pa||Yy(e,n,u,s,f,v,c)||!1)?(h||typeof r.UNSAFE_componentWillUpdate!="function"&&typeof r.componentWillUpdate!="function"||(typeof r.componentWillUpdate=="function"&&r.componentWillUpdate(s,v,c),typeof r.UNSAFE_componentWillUpdate=="function"&&r.UNSAFE_componentWillUpdate(s,v,c)),typeof r.componentDidUpdate=="function"&&(e.flags|=4),typeof r.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof r.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=v),r.props=s,r.state=v,r.context=c,s=u):(typeof r.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof r.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return bm(t,e,n,s,i,a)}function bm(t,e,n,s,a,i){l1(t,e);var r=(e.flags&128)!==0;if(!s&&!r)return a&&$y(e,n,!1),la(t,e,i);s=e.stateNode,uE.current=e;var l=r&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&r?(e.child=ol(e,t.child,null,i),e.child=ol(e,null,l,i)):Dt(t,e,l,i),e.memoizedState=s.state,a&&$y(e,n,!0),e.child}function c1(t){var e=t.stateNode;e.pendingContext?zy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zy(t,e.context,!1),Eb(t,e.containerInfo)}function sw(t,e,n,s,a){return rl(),wb(a),e.flags|=256,Dt(t,e,n,s),e.child}var ym={dehydrated:null,treeContext:null,retryLane:0};function wm(t){return{baseLanes:t,cachePool:null,transitions:null}}function u1(t,e,n){var s=e.pendingProps,a=Pe.current,i=!1,r=(e.flags&128)!==0,l;if((l=r)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),xe(Pe,a&1),t===null)return dm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(r=s.children,t=s.fallback,i?(s=e.mode,i=e.child,r={mode:"hidden",children:r},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=r):i=Pp(r,s,0,null),t=fr(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=wm(n),e.memoizedState=ym,t):Ib(e,r));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return hE(t,e,r,s,l,a,n);if(i){i=s.fallback,r=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:s.children};return!(r&1)&&e.child!==a?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=ci(a,c),s.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=ci(l,i):(i=fr(i,r,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,r=t.child.memoizedState,r=r===null?wm(n):{baseLanes:r.baseLanes|n,cachePool:null,transitions:r.transitions},i.memoizedState=r,i.childLanes=t.childLanes&~n,e.memoizedState=ym,s}return i=t.child,t=i.sibling,s=ci(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function Ib(t,e){return e=Pp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fh(t,e,n,s){return s!==null&&wb(s),ol(e,t.child,null,n),t=Ib(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function hE(t,e,n,s,a,i,r){if(n)return e.flags&256?(e.flags&=-257,s=gg(Error(R(422))),fh(t,e,r,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,a=e.mode,s=Pp({mode:"visible",children:s.children},a,0,null),i=fr(i,a,r,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&ol(e,t.child,null,r),e.child.memoizedState=wm(r),e.memoizedState=ym,i);if(!(e.mode&1))return fh(t,e,r,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(R(419)),s=gg(i,s,void 0),fh(t,e,r,s)}if(l=(r&t.childLanes)!==0,Qt||l){if(s=nt,s!==null){switch(r&-r){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|r)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,oa(t,a),Zn(s,t,a,-1))}return zb(),s=gg(Error(R(421))),fh(t,e,r,s)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=SE.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,hn=ii(a.nextSibling),dn=e,Ne=!0,Qn=null,t!==null&&(Ln[Rn++]=na,Ln[Rn++]=sa,Ln[Rn++]=gr,na=t.id,sa=t.overflow,gr=e),e=Ib(e,s.children),e.flags|=4096,e)}function aw(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),fm(t.return,e,n)}function mg(t,e,n,s,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=a)}function h1(t,e,n){var s=e.pendingProps,a=s.revealOrder,i=s.tail;if(Dt(t,e,s.children,n),s=Pe.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&aw(t,n,e);else if(t.tag===19)aw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(xe(Pe,s),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&bf(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),mg(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&bf(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}mg(e,!0,n,null,i);break;case"together":mg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Dh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function la(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),vr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=ci(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ci(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function dE(t,e,n){switch(e.tag){case 3:c1(e),rl();break;case 5:Fx(e);break;case 1:en(e.type)&&df(e);break;case 4:Eb(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,a=e.memoizedProps.value;xe(gf,s._currentValue),s._currentValue=a;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(xe(Pe,Pe.current&1),e.flags|=128,null):n&e.child.childLanes?u1(t,e,n):(xe(Pe,Pe.current&1),t=la(t,e,n),t!==null?t.sibling:null);xe(Pe,Pe.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return h1(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),xe(Pe,Pe.current),s)break;return null;case 22:case 23:return e.lanes=0,o1(t,e,n)}return la(t,e,n)}var d1,xm,f1,p1;d1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xm=function(){};f1=function(t,e,n,s){var a=t.memoizedProps;if(a!==s){t=e.stateNode,nr(Ms.current);var i=null;switch(n){case"input":a=Ug(t,a),s=Ug(t,s),i=[];break;case"select":a=Re({},a,{value:void 0}),s=Re({},s,{value:void 0}),i=[];break;case"textarea":a=Gg(t,a),s=Gg(t,s),i=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=uf)}Xg(n,s);var r;n=null;for(u in a)if(!s.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(r in l)l.hasOwnProperty(r)&&(n||(n={}),n[r]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Au.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var c=s[u];if(l=a!=null?a[u]:void 0,s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(r in l)!l.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(n||(n={}),n[r]="");for(r in c)c.hasOwnProperty(r)&&l[r]!==c[r]&&(n||(n={}),n[r]=c[r])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Au.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ke("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};p1=function(t,e,n,s){n!==s&&(e.flags|=4)};function El(t,e){if(!Ne)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function bt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function fE(t,e,n){var s=e.pendingProps;switch(yb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return en(e.type)&&hf(),bt(e),null;case 3:return s=e.stateNode,ll(),Se(Zt),Se(Pt),Mb(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(hh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Qn!==null&&(Mm(Qn),Qn=null))),xm(t,e),bt(e),null;case 5:Cb(e);var a=nr(Du.current);if(n=e.type,t!==null&&e.stateNode!=null)f1(t,e,n,s,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(R(166));return bt(e),null}if(t=nr(Ms.current),hh(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Ss]=e,s[Ru]=i,t=(e.mode&1)!==0,n){case"dialog":ke("cancel",s),ke("close",s);break;case"iframe":case"object":case"embed":ke("load",s);break;case"video":case"audio":for(a=0;a<zl.length;a++)ke(zl[a],s);break;case"source":ke("error",s);break;case"img":case"image":case"link":ke("error",s),ke("load",s);break;case"details":ke("toggle",s);break;case"input":fy(s,i),ke("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},ke("invalid",s);break;case"textarea":gy(s,i),ke("invalid",s)}Xg(n,i),a=null;for(var r in i)if(i.hasOwnProperty(r)){var l=i[r];r==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&uh(s.textContent,l,t),a=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&uh(s.textContent,l,t),a=["children",""+l]):Au.hasOwnProperty(r)&&l!=null&&r==="onScroll"&&ke("scroll",s)}switch(n){case"input":nh(s),py(s,i,!0);break;case"textarea":nh(s),my(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=uf)}s=a,e.updateQueue=s,s!==null&&(e.flags|=4)}else{r=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=B0(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=r.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=r.createElement(n,{is:s.is}):(t=r.createElement(n),n==="select"&&(r=t,s.multiple?r.multiple=!0:s.size&&(r.size=s.size))):t=r.createElementNS(t,n),t[Ss]=e,t[Ru]=s,d1(t,e,!1,!1),e.stateNode=t;e:{switch(r=Yg(n,s),n){case"dialog":ke("cancel",t),ke("close",t),a=s;break;case"iframe":case"object":case"embed":ke("load",t),a=s;break;case"video":case"audio":for(a=0;a<zl.length;a++)ke(zl[a],t);a=s;break;case"source":ke("error",t),a=s;break;case"img":case"image":case"link":ke("error",t),ke("load",t),a=s;break;case"details":ke("toggle",t),a=s;break;case"input":fy(t,s),a=Ug(t,s),ke("invalid",t);break;case"option":a=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},a=Re({},s,{value:void 0}),ke("invalid",t);break;case"textarea":gy(t,s),a=Gg(t,s),ke("invalid",t);break;default:a=s}Xg(n,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?V0(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&U0(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Su(t,c):typeof c=="number"&&Su(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Au.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ke("scroll",t):c!=null&&ab(t,i,c,r))}switch(n){case"input":nh(t),py(t,s,!1);break;case"textarea":nh(t),my(t);break;case"option":s.value!=null&&t.setAttribute("value",""+hi(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Uo(t,!!s.multiple,i,!1):s.defaultValue!=null&&Uo(t,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=uf)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(t&&e.stateNode!=null)p1(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(R(166));if(n=nr(Du.current),nr(Ms.current),hh(e)){if(s=e.stateNode,n=e.memoizedProps,s[Ss]=e,(i=s.nodeValue!==n)&&(t=dn,t!==null))switch(t.tag){case 3:uh(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&uh(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Ss]=e,e.stateNode=s}return bt(e),null;case 13:if(Se(Pe),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ne&&hn!==null&&e.mode&1&&!(e.flags&128))Lx(),rl(),e.flags|=98560,i=!1;else if(i=hh(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(R(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(R(317));i[Ss]=e}else rl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),i=!1}else Qn!==null&&(Mm(Qn),Qn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Pe.current&1?Qe===0&&(Qe=3):zb())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return ll(),xm(t,e),t===null&&Tu(e.stateNode.containerInfo),bt(e),null;case 10:return Ab(e.type._context),bt(e),null;case 17:return en(e.type)&&hf(),bt(e),null;case 19:if(Se(Pe),i=e.memoizedState,i===null)return bt(e),null;if(s=(e.flags&128)!==0,r=i.rendering,r===null)if(s)El(i,!1);else{if(Qe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(r=bf(t),r!==null){for(e.flags|=128,El(i,!1),s=r.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,r=i.alternate,r===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=r.childLanes,i.lanes=r.lanes,i.child=r.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=r.memoizedProps,i.memoizedState=r.memoizedState,i.updateQueue=r.updateQueue,i.type=r.type,t=r.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return xe(Pe,Pe.current&1|2),e.child}t=t.sibling}i.tail!==null&&We()>ul&&(e.flags|=128,s=!0,El(i,!1),e.lanes=4194304)}else{if(!s)if(t=bf(r),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),El(i,!0),i.tail===null&&i.tailMode==="hidden"&&!r.alternate&&!Ne)return bt(e),null}else 2*We()-i.renderingStartTime>ul&&n!==1073741824&&(e.flags|=128,s=!0,El(i,!1),e.lanes=4194304);i.isBackwards?(r.sibling=e.child,e.child=r):(n=i.last,n!==null?n.sibling=r:e.child=r,i.last=r)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=We(),e.sibling=null,n=Pe.current,xe(Pe,s?n&1|2:n&1),e):(bt(e),null);case 22:case 23:return Wb(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?on&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function pE(t,e){switch(yb(e),e.tag){case 1:return en(e.type)&&hf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ll(),Se(Zt),Se(Pt),Mb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Cb(e),null;case 13:if(Se(Pe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));rl()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Se(Pe),null;case 4:return ll(),null;case 10:return Ab(e.type._context),null;case 22:case 23:return Wb(),null;case 24:return null;default:return null}}var ph=!1,Mt=!1,gE=typeof WeakSet=="function"?WeakSet:Set,W=null;function So(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){je(t,e,s)}else n.current=null}function g1(t,e,n){try{n()}catch(s){je(t,e,s)}}var iw=!1;function mE(t,e){if(im=of,t=yx(),vb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var r=0,l=-1,c=-1,u=0,h=0,d=t,f=null;t:for(;;){for(var g;d!==n||a!==0&&d.nodeType!==3||(l=r+a),d!==i||s!==0&&d.nodeType!==3||(c=r+s),d.nodeType===3&&(r+=d.nodeValue.length),(g=d.firstChild)!==null;)f=d,d=g;for(;;){if(d===t)break t;if(f===n&&++u===a&&(l=r),f===i&&++h===s&&(c=r),(g=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=g}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(rm={focusedElem:t,selectionRange:n},of=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var y=v.memoizedProps,S=v.memoizedState,b=e.stateNode,x=b.getSnapshotBeforeUpdate(e.elementType===e.type?y:qn(e.type,y),S);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(_){je(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return v=iw,iw=!1,v}function Uc(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&g1(e,n,i)}a=a.next}while(a!==s)}}function Mp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function km(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function m1(t){var e=t.alternate;e!==null&&(t.alternate=null,m1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ss],delete e[Ru],delete e[cm],delete e[J_],delete e[Z_])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function v1(t){return t.tag===5||t.tag===3||t.tag===4}function rw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||v1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Am(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=uf));else if(s!==4&&(t=t.child,t!==null))for(Am(t,e,n),t=t.sibling;t!==null;)Am(t,e,n),t=t.sibling}function Sm(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Sm(t,e,n),t=t.sibling;t!==null;)Sm(t,e,n),t=t.sibling}var ht=null,Yn=!1;function da(t,e,n){for(n=n.child;n!==null;)b1(t,e,n),n=n.sibling}function b1(t,e,n){if(Cs&&typeof Cs.onCommitFiberUnmount=="function")try{Cs.onCommitFiberUnmount(wp,n)}catch{}switch(n.tag){case 5:Mt||So(n,e);case 6:var s=ht,a=Yn;ht=null,da(t,e,n),ht=s,Yn=a,ht!==null&&(Yn?(t=ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ht.removeChild(n.stateNode));break;case 18:ht!==null&&(Yn?(t=ht,n=n.stateNode,t.nodeType===8?cg(t.parentNode,n):t.nodeType===1&&cg(t,n),Mu(t)):cg(ht,n.stateNode));break;case 4:s=ht,a=Yn,ht=n.stateNode.containerInfo,Yn=!0,da(t,e,n),ht=s,Yn=a;break;case 0:case 11:case 14:case 15:if(!Mt&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var i=a,r=i.destroy;i=i.tag,r!==void 0&&(i&2||i&4)&&g1(n,e,r),a=a.next}while(a!==s)}da(t,e,n);break;case 1:if(!Mt&&(So(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){je(n,e,l)}da(t,e,n);break;case 21:da(t,e,n);break;case 22:n.mode&1?(Mt=(s=Mt)||n.memoizedState!==null,da(t,e,n),Mt=s):da(t,e,n);break;default:da(t,e,n)}}function ow(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new gE),e.forEach(function(s){var a=_E.bind(null,t,s);n.has(s)||(n.add(s),s.then(a,a))})}}function Wn(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var i=t,r=e,l=r;e:for(;l!==null;){switch(l.tag){case 5:ht=l.stateNode,Yn=!1;break e;case 3:ht=l.stateNode.containerInfo,Yn=!0;break e;case 4:ht=l.stateNode.containerInfo,Yn=!0;break e}l=l.return}if(ht===null)throw Error(R(160));b1(i,r,a),ht=null,Yn=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){je(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)y1(e,t),e=e.sibling}function y1(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Wn(e,t),ss(t),s&4){try{Uc(3,t,t.return),Mp(3,t)}catch(y){je(t,t.return,y)}try{Uc(5,t,t.return)}catch(y){je(t,t.return,y)}}break;case 1:Wn(e,t),ss(t),s&512&&n!==null&&So(n,n.return);break;case 5:if(Wn(e,t),ss(t),s&512&&n!==null&&So(n,n.return),t.flags&32){var a=t.stateNode;try{Su(a,"")}catch(y){je(t,t.return,y)}}if(s&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,r=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&z0(a,i),Yg(l,r);var u=Yg(l,i);for(r=0;r<c.length;r+=2){var h=c[r],d=c[r+1];h==="style"?V0(a,d):h==="dangerouslySetInnerHTML"?U0(a,d):h==="children"?Su(a,d):ab(a,h,d,u)}switch(l){case"input":Hg(a,i);break;case"textarea":$0(a,i);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Uo(a,!!i.multiple,g,!1):f!==!!i.multiple&&(i.defaultValue!=null?Uo(a,!!i.multiple,i.defaultValue,!0):Uo(a,!!i.multiple,i.multiple?[]:"",!1))}a[Ru]=i}catch(y){je(t,t.return,y)}}break;case 6:if(Wn(e,t),ss(t),s&4){if(t.stateNode===null)throw Error(R(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(y){je(t,t.return,y)}}break;case 3:if(Wn(e,t),ss(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Mu(e.containerInfo)}catch(y){je(t,t.return,y)}break;case 4:Wn(e,t),ss(t);break;case 13:Wn(e,t),ss(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Fb=We())),s&4&&ow(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Mt=(u=Mt)||h,Wn(e,t),Mt=u):Wn(e,t),ss(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(W=t,h=t.child;h!==null;){for(d=W=h;W!==null;){switch(f=W,g=f.child,f.tag){case 0:case 11:case 14:case 15:Uc(4,f,f.return);break;case 1:So(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){s=f,n=f.return;try{e=s,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(y){je(s,n,y)}}break;case 5:So(f,f.return);break;case 22:if(f.memoizedState!==null){cw(d);continue}}g!==null?(g.return=f,W=g):cw(d)}h=h.sibling}e:for(h=null,d=t;;){if(d.tag===5){if(h===null){h=d;try{a=d.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=d.stateNode,c=d.memoizedProps.style,r=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=H0("display",r))}catch(y){je(t,t.return,y)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(y){je(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Wn(e,t),ss(t),s&4&&ow(t);break;case 21:break;default:Wn(e,t),ss(t)}}function ss(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(v1(n)){var s=n;break e}n=n.return}throw Error(R(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Su(a,""),s.flags&=-33);var i=rw(t);Sm(t,i,a);break;case 3:case 4:var r=s.stateNode.containerInfo,l=rw(t);Am(t,l,r);break;default:throw Error(R(161))}}catch(c){je(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function vE(t,e,n){W=t,w1(t)}function w1(t,e,n){for(var s=(t.mode&1)!==0;W!==null;){var a=W,i=a.child;if(a.tag===22&&s){var r=a.memoizedState!==null||ph;if(!r){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Mt;l=ph;var u=Mt;if(ph=r,(Mt=c)&&!u)for(W=a;W!==null;)r=W,c=r.child,r.tag===22&&r.memoizedState!==null?uw(a):c!==null?(c.return=r,W=c):uw(a);for(;i!==null;)W=i,w1(i),i=i.sibling;W=a,ph=l,Mt=u}lw(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,W=i):lw(t)}}function lw(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Mt||Mp(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Mt)if(n===null)s.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:qn(e.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Gy(e,i,s);break;case 3:var r=e.updateQueue;if(r!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Gy(e,r,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&Mu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}Mt||e.flags&512&&km(e)}catch(f){je(e,e.return,f)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function cw(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function uw(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Mp(4,e)}catch(c){je(e,n,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var a=e.return;try{s.componentDidMount()}catch(c){je(e,a,c)}}var i=e.return;try{km(e)}catch(c){je(e,i,c)}break;case 5:var r=e.return;try{km(e)}catch(c){je(e,r,c)}}}catch(c){je(e,e.return,c)}if(e===t){W=null;break}var l=e.sibling;if(l!==null){l.return=e.return,W=l;break}W=e.return}}var bE=Math.ceil,xf=ca.ReactCurrentDispatcher,Db=ca.ReactCurrentOwner,Dn=ca.ReactCurrentBatchConfig,le=0,nt=null,He=null,pt=0,on=0,_o=vi(0),Qe=0,Wu=null,vr=0,Np=0,jb=0,Hc=null,Kt=null,Fb=0,ul=1/0,Us=null,kf=!1,_m=null,oi=null,gh=!1,Ya=null,Af=0,Vc=0,Em=null,jh=-1,Fh=0;function Ot(){return le&6?We():jh!==-1?jh:jh=We()}function li(t){return t.mode&1?le&2&&pt!==0?pt&-pt:tE.transition!==null?(Fh===0&&(Fh=sx()),Fh):(t=me,t!==0||(t=window.event,t=t===void 0?16:ux(t.type)),t):1}function Zn(t,e,n,s){if(50<Vc)throw Vc=0,Em=null,Error(R(185));qu(t,n,s),(!(le&2)||t!==nt)&&(t===nt&&(!(le&2)&&(Np|=n),Qe===4&&Wa(t,pt)),tn(t,s),n===1&&le===0&&!(e.mode&1)&&(ul=We()+500,_p&&bi()))}function tn(t,e){var n=t.callbackNode;t_(t,e);var s=rf(t,t===nt?pt:0);if(s===0)n!==null&&yy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&yy(n),e===1)t.tag===0?eE(hw.bind(null,t)):Nx(hw.bind(null,t)),K_(function(){!(le&6)&&bi()}),n=null;else{switch(ax(s)){case 1:n=cb;break;case 4:n=tx;break;case 16:n=af;break;case 536870912:n=nx;break;default:n=af}n=M1(n,x1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function x1(t,e){if(jh=-1,Fh=0,le&6)throw Error(R(327));var n=t.callbackNode;if(Xo()&&t.callbackNode!==n)return null;var s=rf(t,t===nt?pt:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Sf(t,s);else{e=s;var a=le;le|=2;var i=A1();(nt!==t||pt!==e)&&(Us=null,ul=We()+500,dr(t,e));do try{xE();break}catch(l){k1(t,l)}while(!0);kb(),xf.current=i,le=a,He!==null?e=0:(nt=null,pt=0,e=Qe)}if(e!==0){if(e===2&&(a=em(t),a!==0&&(s=a,e=Cm(t,a))),e===1)throw n=Wu,dr(t,0),Wa(t,s),tn(t,We()),n;if(e===6)Wa(t,s);else{if(a=t.current.alternate,!(s&30)&&!yE(a)&&(e=Sf(t,s),e===2&&(i=em(t),i!==0&&(s=i,e=Cm(t,i))),e===1))throw n=Wu,dr(t,0),Wa(t,s),tn(t,We()),n;switch(t.finishedWork=a,t.finishedLanes=s,e){case 0:case 1:throw Error(R(345));case 2:ki(t,Kt,Us);break;case 3:if(Wa(t,s),(s&130023424)===s&&(e=Fb+500-We(),10<e)){if(rf(t,0)!==0)break;if(a=t.suspendedLanes,(a&s)!==s){Ot(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=lm(ki.bind(null,t,Kt,Us),e);break}ki(t,Kt,Us);break;case 4:if(Wa(t,s),(s&4194240)===s)break;for(e=t.eventTimes,a=-1;0<s;){var r=31-Jn(s);i=1<<r,r=e[r],r>a&&(a=r),s&=~i}if(s=a,s=We()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*bE(s/1960))-s,10<s){t.timeoutHandle=lm(ki.bind(null,t,Kt,Us),s);break}ki(t,Kt,Us);break;case 5:ki(t,Kt,Us);break;default:throw Error(R(329))}}}return tn(t,We()),t.callbackNode===n?x1.bind(null,t):null}function Cm(t,e){var n=Hc;return t.current.memoizedState.isDehydrated&&(dr(t,e).flags|=256),t=Sf(t,e),t!==2&&(e=Kt,Kt=n,e!==null&&Mm(e)),t}function Mm(t){Kt===null?Kt=t:Kt.push.apply(Kt,t)}function yE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],i=a.getSnapshot;a=a.value;try{if(!es(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Wa(t,e){for(e&=~jb,e&=~Np,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Jn(e),s=1<<n;t[n]=-1,e&=~s}}function hw(t){if(le&6)throw Error(R(327));Xo();var e=rf(t,0);if(!(e&1))return tn(t,We()),null;var n=Sf(t,e);if(t.tag!==0&&n===2){var s=em(t);s!==0&&(e=s,n=Cm(t,s))}if(n===1)throw n=Wu,dr(t,0),Wa(t,e),tn(t,We()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ki(t,Kt,Us),tn(t,We()),null}function Ob(t,e){var n=le;le|=1;try{return t(e)}finally{le=n,le===0&&(ul=We()+500,_p&&bi())}}function br(t){Ya!==null&&Ya.tag===0&&!(le&6)&&Xo();var e=le;le|=1;var n=Dn.transition,s=me;try{if(Dn.transition=null,me=1,t)return t()}finally{me=s,Dn.transition=n,le=e,!(le&6)&&bi()}}function Wb(){on=_o.current,Se(_o)}function dr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Y_(n)),He!==null)for(n=He.return;n!==null;){var s=n;switch(yb(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&hf();break;case 3:ll(),Se(Zt),Se(Pt),Mb();break;case 5:Cb(s);break;case 4:ll();break;case 13:Se(Pe);break;case 19:Se(Pe);break;case 10:Ab(s.type._context);break;case 22:case 23:Wb()}n=n.return}if(nt=t,He=t=ci(t.current,null),pt=on=e,Qe=0,Wu=null,jb=Np=vr=0,Kt=Hc=null,tr!==null){for(e=0;e<tr.length;e++)if(n=tr[e],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,i=n.pending;if(i!==null){var r=i.next;i.next=a,s.next=r}n.pending=s}tr=null}return t}function k1(t,e){do{var n=He;try{if(kb(),Rh.current=wf,yf){for(var s=Te.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}yf=!1}if(mr=0,tt=Ke=Te=null,Bc=!1,ju=0,Db.current=null,n===null||n.return===null){Qe=1,Wu=e,He=null;break}e:{var i=t,r=n.return,l=n,c=e;if(e=pt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=Jy(r);if(g!==null){g.flags&=-257,Zy(g,r,l,i,e),g.mode&1&&Qy(i,u,e),e=g,c=u;var v=e.updateQueue;if(v===null){var y=new Set;y.add(c),e.updateQueue=y}else v.add(c);break e}else{if(!(e&1)){Qy(i,u,e),zb();break e}c=Error(R(426))}}else if(Ne&&l.mode&1){var S=Jy(r);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Zy(S,r,l,i,e),wb(cl(c,l));break e}}i=c=cl(c,l),Qe!==4&&(Qe=2),Hc===null?Hc=[i]:Hc.push(i),i=r;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=a1(i,c,e);Vy(i,b);break e;case 1:l=c;var x=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof x.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(oi===null||!oi.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var _=i1(i,l,e);Vy(i,_);break e}}i=i.return}while(i!==null)}_1(n)}catch(E){e=E,He===n&&n!==null&&(He=n=n.return);continue}break}while(!0)}function A1(){var t=xf.current;return xf.current=wf,t===null?wf:t}function zb(){(Qe===0||Qe===3||Qe===2)&&(Qe=4),nt===null||!(vr&268435455)&&!(Np&268435455)||Wa(nt,pt)}function Sf(t,e){var n=le;le|=2;var s=A1();(nt!==t||pt!==e)&&(Us=null,dr(t,e));do try{wE();break}catch(a){k1(t,a)}while(!0);if(kb(),le=n,xf.current=s,He!==null)throw Error(R(261));return nt=null,pt=0,Qe}function wE(){for(;He!==null;)S1(He)}function xE(){for(;He!==null&&!GS();)S1(He)}function S1(t){var e=C1(t.alternate,t,on);t.memoizedProps=t.pendingProps,e===null?_1(t):He=e,Db.current=null}function _1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pE(n,e),n!==null){n.flags&=32767,He=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Qe=6,He=null;return}}else if(n=fE(n,e,on),n!==null){He=n;return}if(e=e.sibling,e!==null){He=e;return}He=e=t}while(e!==null);Qe===0&&(Qe=5)}function ki(t,e,n){var s=me,a=Dn.transition;try{Dn.transition=null,me=1,kE(t,e,n,s)}finally{Dn.transition=a,me=s}return null}function kE(t,e,n,s){do Xo();while(Ya!==null);if(le&6)throw Error(R(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(n_(t,i),t===nt&&(He=nt=null,pt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gh||(gh=!0,M1(af,function(){return Xo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Dn.transition,Dn.transition=null;var r=me;me=1;var l=le;le|=4,Db.current=null,mE(t,n),y1(n,t),B_(rm),of=!!im,rm=im=null,t.current=n,vE(n),qS(),le=l,me=r,Dn.transition=i}else t.current=n;if(gh&&(gh=!1,Ya=t,Af=a),i=t.pendingLanes,i===0&&(oi=null),KS(n.stateNode),tn(t,We()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(kf)throw kf=!1,t=_m,_m=null,t;return Af&1&&t.tag!==0&&Xo(),i=t.pendingLanes,i&1?t===Em?Vc++:(Vc=0,Em=t):Vc=0,bi(),null}function Xo(){if(Ya!==null){var t=ax(Af),e=Dn.transition,n=me;try{if(Dn.transition=null,me=16>t?16:t,Ya===null)var s=!1;else{if(t=Ya,Ya=null,Af=0,le&6)throw Error(R(331));var a=le;for(le|=4,W=t.current;W!==null;){var i=W,r=i.child;if(W.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(W=u;W!==null;){var h=W;switch(h.tag){case 0:case 11:case 15:Uc(8,h,i)}var d=h.child;if(d!==null)d.return=h,W=d;else for(;W!==null;){h=W;var f=h.sibling,g=h.return;if(m1(h),h===u){W=null;break}if(f!==null){f.return=g,W=f;break}W=g}}}var v=i.alternate;if(v!==null){var y=v.child;if(y!==null){v.child=null;do{var S=y.sibling;y.sibling=null,y=S}while(y!==null)}}W=i}}if(i.subtreeFlags&2064&&r!==null)r.return=i,W=r;else e:for(;W!==null;){if(i=W,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Uc(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,W=b;break e}W=i.return}}var x=t.current;for(W=x;W!==null;){r=W;var w=r.child;if(r.subtreeFlags&2064&&w!==null)w.return=r,W=w;else e:for(r=x;W!==null;){if(l=W,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Mp(9,l)}}catch(E){je(l,l.return,E)}if(l===r){W=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,W=_;break e}W=l.return}}if(le=a,bi(),Cs&&typeof Cs.onPostCommitFiberRoot=="function")try{Cs.onPostCommitFiberRoot(wp,t)}catch{}s=!0}return s}finally{me=n,Dn.transition=e}}return!1}function dw(t,e,n){e=cl(n,e),e=a1(t,e,1),t=ri(t,e,1),e=Ot(),t!==null&&(qu(t,1,e),tn(t,e))}function je(t,e,n){if(t.tag===3)dw(t,t,n);else for(;e!==null;){if(e.tag===3){dw(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(oi===null||!oi.has(s))){t=cl(n,t),t=i1(e,t,1),e=ri(e,t,1),t=Ot(),e!==null&&(qu(e,1,t),tn(e,t));break}}e=e.return}}function AE(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Ot(),t.pingedLanes|=t.suspendedLanes&n,nt===t&&(pt&n)===n&&(Qe===4||Qe===3&&(pt&130023424)===pt&&500>We()-Fb?dr(t,0):jb|=n),tn(t,e)}function E1(t,e){e===0&&(t.mode&1?(e=ih,ih<<=1,!(ih&130023424)&&(ih=4194304)):e=1);var n=Ot();t=oa(t,e),t!==null&&(qu(t,e,n),tn(t,n))}function SE(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),E1(t,n)}function _E(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(R(314))}s!==null&&s.delete(e),E1(t,n)}var C1;C1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zt.current)Qt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Qt=!1,dE(t,e,n);Qt=!!(t.flags&131072)}else Qt=!1,Ne&&e.flags&1048576&&Px(e,pf,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Dh(t,e),t=e.pendingProps;var a=il(e,Pt.current);qo(e,n),a=Pb(null,e,s,t,a,n);var i=Tb();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,en(s)?(i=!0,df(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,_b(e),a.updater=Cp,e.stateNode=a,a._reactInternals=e,gm(e,s,t,n),e=bm(null,e,s,!0,i,n)):(e.tag=0,Ne&&i&&bb(e),Dt(null,e,a,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Dh(t,e),t=e.pendingProps,a=s._init,s=a(s._payload),e.type=s,a=e.tag=CE(s),t=qn(s,t),a){case 0:e=vm(null,e,s,t,n);break e;case 1:e=nw(null,e,s,t,n);break e;case 11:e=ew(null,e,s,t,n);break e;case 14:e=tw(null,e,s,qn(s.type,t),n);break e}throw Error(R(306,s,""))}return e;case 0:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:qn(s,a),vm(t,e,s,a,n);case 1:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:qn(s,a),nw(t,e,s,a,n);case 3:e:{if(c1(e),t===null)throw Error(R(387));s=e.pendingProps,i=e.memoizedState,a=i.element,jx(t,e),vf(e,s,null,n);var r=e.memoizedState;if(s=r.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:r.cache,pendingSuspenseBoundaries:r.pendingSuspenseBoundaries,transitions:r.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=cl(Error(R(423)),e),e=sw(t,e,s,n,a);break e}else if(s!==a){a=cl(Error(R(424)),e),e=sw(t,e,s,n,a);break e}else for(hn=ii(e.stateNode.containerInfo.firstChild),dn=e,Ne=!0,Qn=null,n=Ix(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(rl(),s===a){e=la(t,e,n);break e}Dt(t,e,s,n)}e=e.child}return e;case 5:return Fx(e),t===null&&dm(e),s=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,r=a.children,om(s,a)?r=null:i!==null&&om(s,i)&&(e.flags|=32),l1(t,e),Dt(t,e,r,n),e.child;case 6:return t===null&&dm(e),null;case 13:return u1(t,e,n);case 4:return Eb(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=ol(e,null,s,n):Dt(t,e,s,n),e.child;case 11:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:qn(s,a),ew(t,e,s,a,n);case 7:return Dt(t,e,e.pendingProps,n),e.child;case 8:return Dt(t,e,e.pendingProps.children,n),e.child;case 12:return Dt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,a=e.pendingProps,i=e.memoizedProps,r=a.value,xe(gf,s._currentValue),s._currentValue=r,i!==null)if(es(i.value,r)){if(i.children===a.children&&!Zt.current){e=la(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){r=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=aa(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),fm(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)r=i.type===e.type?null:i.child;else if(i.tag===18){if(r=i.return,r===null)throw Error(R(341));r.lanes|=n,l=r.alternate,l!==null&&(l.lanes|=n),fm(r,n,e),r=i.sibling}else r=i.child;if(r!==null)r.return=i;else for(r=i;r!==null;){if(r===e){r=null;break}if(i=r.sibling,i!==null){i.return=r.return,r=i;break}r=r.return}i=r}Dt(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,s=e.pendingProps.children,qo(e,n),a=jn(a),s=s(a),e.flags|=1,Dt(t,e,s,n),e.child;case 14:return s=e.type,a=qn(s,e.pendingProps),a=qn(s.type,a),tw(t,e,s,a,n);case 15:return r1(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:qn(s,a),Dh(t,e),e.tag=1,en(s)?(t=!0,df(e)):t=!1,qo(e,n),s1(e,s,a),gm(e,s,a,n),bm(null,e,s,!0,t,n);case 19:return h1(t,e,n);case 22:return o1(t,e,n)}throw Error(R(156,e.tag))};function M1(t,e){return ex(t,e)}function EE(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function In(t,e,n,s){return new EE(t,e,n,s)}function $b(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CE(t){if(typeof t=="function")return $b(t)?1:0;if(t!=null){if(t=t.$$typeof,t===rb)return 11;if(t===ob)return 14}return 2}function ci(t,e){var n=t.alternate;return n===null?(n=In(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Oh(t,e,n,s,a,i){var r=2;if(s=t,typeof t=="function")$b(t)&&(r=1);else if(typeof t=="string")r=5;else e:switch(t){case go:return fr(n.children,a,i,e);case ib:r=8,a|=8;break;case Wg:return t=In(12,n,e,a|2),t.elementType=Wg,t.lanes=i,t;case zg:return t=In(13,n,e,a),t.elementType=zg,t.lanes=i,t;case $g:return t=In(19,n,e,a),t.elementType=$g,t.lanes=i,t;case F0:return Pp(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case D0:r=10;break e;case j0:r=9;break e;case rb:r=11;break e;case ob:r=14;break e;case Na:r=16,s=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=In(r,n,e,a),e.elementType=t,e.type=s,e.lanes=i,e}function fr(t,e,n,s){return t=In(7,t,s,e),t.lanes=n,t}function Pp(t,e,n,s){return t=In(22,t,s,e),t.elementType=F0,t.lanes=n,t.stateNode={isHidden:!1},t}function vg(t,e,n){return t=In(6,t,null,e),t.lanes=n,t}function bg(t,e,n){return e=In(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ME(t,e,n,s,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jp(0),this.expirationTimes=Jp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jp(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bb(t,e,n,s,a,i,r,l,c){return t=new ME(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=In(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_b(i),t}function NE(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:po,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function N1(t){if(!t)return di;t=t._reactInternals;e:{if(Ar(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(en(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if(en(n))return Mx(t,n,e)}return e}function P1(t,e,n,s,a,i,r,l,c){return t=Bb(n,s,!0,t,a,i,r,l,c),t.context=N1(null),n=t.current,s=Ot(),a=li(n),i=aa(s,a),i.callback=e??null,ri(n,i,a),t.current.lanes=a,qu(t,a,s),tn(t,s),t}function Tp(t,e,n,s){var a=e.current,i=Ot(),r=li(a);return n=N1(n),e.context===null?e.context=n:e.pendingContext=n,e=aa(i,r),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=ri(a,e,r),t!==null&&(Zn(t,a,r,i),Lh(t,a,r)),r}function _f(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ub(t,e){fw(t,e),(t=t.alternate)&&fw(t,e)}function PE(){return null}var T1=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hb(t){this._internalRoot=t}Lp.prototype.render=Hb.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));Tp(t,e,null,null)};Lp.prototype.unmount=Hb.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;br(function(){Tp(null,t,null,null)}),e[ra]=null}};function Lp(t){this._internalRoot=t}Lp.prototype.unstable_scheduleHydration=function(t){if(t){var e=ox();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Oa.length&&e!==0&&e<Oa[n].priority;n++);Oa.splice(n,0,t),n===0&&cx(t)}};function Vb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Rp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pw(){}function TE(t,e,n,s,a){if(a){if(typeof s=="function"){var i=s;s=function(){var u=_f(r);i.call(u)}}var r=P1(e,s,t,0,null,!1,!1,"",pw);return t._reactRootContainer=r,t[ra]=r.current,Tu(t.nodeType===8?t.parentNode:t),br(),r}for(;a=t.lastChild;)t.removeChild(a);if(typeof s=="function"){var l=s;s=function(){var u=_f(c);l.call(u)}}var c=Bb(t,0,!1,null,null,!1,!1,"",pw);return t._reactRootContainer=c,t[ra]=c.current,Tu(t.nodeType===8?t.parentNode:t),br(function(){Tp(e,c,n,s)}),c}function Ip(t,e,n,s,a){var i=n._reactRootContainer;if(i){var r=i;if(typeof a=="function"){var l=a;a=function(){var c=_f(r);l.call(c)}}Tp(e,r,t,a)}else r=TE(n,e,t,a,s);return _f(r)}ix=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Wl(e.pendingLanes);n!==0&&(ub(e,n|1),tn(e,We()),!(le&6)&&(ul=We()+500,bi()))}break;case 13:br(function(){var s=oa(t,1);if(s!==null){var a=Ot();Zn(s,t,1,a)}}),Ub(t,1)}};hb=function(t){if(t.tag===13){var e=oa(t,134217728);if(e!==null){var n=Ot();Zn(e,t,134217728,n)}Ub(t,134217728)}};rx=function(t){if(t.tag===13){var e=li(t),n=oa(t,e);if(n!==null){var s=Ot();Zn(n,t,e,s)}Ub(t,e)}};ox=function(){return me};lx=function(t,e){var n=me;try{return me=t,e()}finally{me=n}};Qg=function(t,e,n){switch(e){case"input":if(Hg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var a=Sp(s);if(!a)throw Error(R(90));W0(s),Hg(s,a)}}}break;case"textarea":$0(t,n);break;case"select":e=n.value,e!=null&&Uo(t,!!n.multiple,e,!1)}};X0=Ob;Y0=br;var LE={usingClientEntryPoint:!1,Events:[Yu,yo,Sp,G0,q0,Ob]},Cl={findFiberByHostInstance:er,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RE={bundleType:Cl.bundleType,version:Cl.version,rendererPackageName:Cl.rendererPackageName,rendererConfig:Cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ca.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=J0(t),t===null?null:t.stateNode},findFiberByHostInstance:Cl.findFiberByHostInstance||PE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mh.isDisabled&&mh.supportsFiber)try{wp=mh.inject(RE),Cs=mh}catch{}}pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LE;pn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vb(e))throw Error(R(200));return NE(t,e,null,n)};pn.createRoot=function(t,e){if(!Vb(t))throw Error(R(299));var n=!1,s="",a=T1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Bb(t,1,!1,null,null,n,!1,s,a),t[ra]=e.current,Tu(t.nodeType===8?t.parentNode:t),new Hb(e)};pn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=J0(e),t=t===null?null:t.stateNode,t};pn.flushSync=function(t){return br(t)};pn.hydrate=function(t,e,n){if(!Rp(e))throw Error(R(200));return Ip(null,t,e,!0,n)};pn.hydrateRoot=function(t,e,n){if(!Vb(t))throw Error(R(405));var s=n!=null&&n.hydratedSources||null,a=!1,i="",r=T1;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(r=n.onRecoverableError)),e=P1(e,null,t,1,n??null,a,!1,i,r),t[ra]=e.current,Tu(t),s)for(t=0;t<s.length;t++)n=s[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new Lp(e)};pn.render=function(t,e,n){if(!Rp(e))throw Error(R(200));return Ip(null,t,e,!1,n)};pn.unmountComponentAtNode=function(t){if(!Rp(t))throw Error(R(40));return t._reactRootContainer?(br(function(){Ip(null,null,t,!1,function(){t._reactRootContainer=null,t[ra]=null})}),!0):!1};pn.unstable_batchedUpdates=Ob;pn.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!Rp(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return Ip(t,e,n,!1,s)};pn.version="18.3.1-next-f1338f8080-20240426";function L1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L1)}catch(t){console.error(t)}}L1(),T0.exports=pn;var IE=T0.exports,gw=IE;Fg.createRoot=gw.createRoot,Fg.hydrateRoot=gw.hydrateRoot;/**
* @remix-run/router v1.23.1
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function zu(){return zu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},zu.apply(this,arguments)}var Ka;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ka||(Ka={}));const mw="popstate";function DE(t){t===void 0&&(t={});function e(s,a){let{pathname:i,search:r,hash:l}=s.location;return Nm("",{pathname:i,search:r,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:Ef(a)}return FE(e,n,null,t)}function Le(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Gb(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function jE(){return Math.random().toString(36).substr(2,8)}function vw(t,e){return{usr:t.state,key:t.key,idx:e}}function Nm(t,e,n,s){return n===void 0&&(n=null),zu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?vl(e):e,{state:n,key:e&&e.key||s||jE()})}function Ef(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function vl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function FE(t,e,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:i=!1}=s,r=a.history,l=Ka.Pop,c=null,u=h();u==null&&(u=0,r.replaceState(zu({},r.state,{idx:u}),""));function h(){return(r.state||{idx:null}).idx}function d(){l=Ka.Pop;let S=h(),b=S==null?null:S-u;u=S,c&&c({action:l,location:y.location,delta:b})}function f(S,b){l=Ka.Push;let x=Nm(y.location,S,b);u=h()+1;let w=vw(x,u),_=y.createHref(x);try{r.pushState(w,"",_)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;a.location.assign(_)}i&&c&&c({action:l,location:y.location,delta:1})}function g(S,b){l=Ka.Replace;let x=Nm(y.location,S,b);u=h();let w=vw(x,u),_=y.createHref(x);r.replaceState(w,"",_),i&&c&&c({action:l,location:y.location,delta:0})}function v(S){let b=a.location.origin!=="null"?a.location.origin:a.location.href,x=typeof S=="string"?S:Ef(S);return x=x.replace(/ $/,"%20"),Le(b,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,b)}let y={get action(){return l},get location(){return t(a,r)},listen(S){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(mw,d),c=S,()=>{a.removeEventListener(mw,d),c=null}},createHref(S){return e(a,S)},createURL:v,encodeLocation(S){let b=v(S);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:f,replace:g,go(S){return r.go(S)}};return y}var bw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(bw||(bw={}));function OE(t,e,n){return n===void 0&&(n="/"),WE(t,e,n)}function WE(t,e,n,s){let a=typeof e=="string"?vl(e):e,i=hl(a.pathname||"/",n);if(i==null)return null;let r=R1(t);zE(r);let l=null;for(let c=0;l==null&&c<r.length;++c){let u=QE(i);l=YE(r[c],u)}return l}function R1(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(i,r,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:r,route:i};c.relativePath.startsWith("/")&&(Le(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=ui([s,c.relativePath]),h=n.concat(c);i.children&&i.children.length>0&&(Le(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),R1(i.children,e,h,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:qE(u,i.index),routesMeta:h})};return t.forEach((i,r)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,r);else for(let c of I1(i.path))a(i,r,c)}),e}function I1(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return a?[i,""]:[i];let r=I1(s.join("/")),l=[];return l.push(...r.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...r),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function zE(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:XE(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const $E=/^:[\w-]+$/,BE=3,UE=2,HE=1,VE=10,GE=-2,yw=t=>t==="*";function qE(t,e){let n=t.split("/"),s=n.length;return n.some(yw)&&(s+=GE),e&&(s+=UE),n.filter(a=>!yw(a)).reduce((a,i)=>a+($E.test(i)?BE:i===""?HE:VE),s)}function XE(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function YE(t,e,n){let{routesMeta:s}=t,a={},i="/",r=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,h=i==="/"?e:e.slice(i.length)||"/",d=Pm({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!d)return null;Object.assign(a,d.params),r.push({params:a,pathname:ui([i,d.pathname]),pathnameBase:nC(ui([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=ui([i,d.pathnameBase]))}return r}function Pm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=KE(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],r=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:s.reduce((c,u,h)=>{let{paramName:d,isOptional:f}=u;if(d==="*"){let v=l[h]||"";r=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const g=l[h];return f&&!g?c[d]=void 0:c[d]=(g||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:r,pattern:t}}function KE(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Gb(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,r,l)=>(s.push({paramName:r,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function QE(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gb(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function hl(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const JE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ZE=t=>JE.test(t);function eC(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?vl(t):t,i;if(n)if(ZE(n))i=n;else{if(n.includes("//")){let r=n;n=n.replace(/\/\/+/g,"/"),Gb(!1,"Pathnames cannot have embedded double slashes - normalizing "+(r+" -> "+n))}n.startsWith("/")?i=ww(n.substring(1),"/"):i=ww(n,e)}else i=e;return{pathname:i,search:sC(s),hash:aC(a)}}function ww(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function yg(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function tC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qb(t,e){let n=tC(t);return e?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function Xb(t,e,n,s){s===void 0&&(s=!1);let a;typeof t=="string"?a=vl(t):(a=zu({},t),Le(!a.pathname||!a.pathname.includes("?"),yg("?","pathname","search",a)),Le(!a.pathname||!a.pathname.includes("#"),yg("#","pathname","hash",a)),Le(!a.search||!a.search.includes("#"),yg("#","search","hash",a)));let i=t===""||a.pathname==="",r=i?"/":a.pathname,l;if(r==null)l=n;else{let d=e.length-1;if(!s&&r.startsWith("..")){let f=r.split("/");for(;f[0]==="..";)f.shift(),d-=1;a.pathname=f.join("/")}l=d>=0?e[d]:"/"}let c=eC(a,l),u=r&&r!=="/"&&r.endsWith("/"),h=(i||r===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const ui=t=>t.join("/").replace(/\/\/+/g,"/"),nC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),sC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,aC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function iC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const D1=["post","put","patch","delete"];new Set(D1);const rC=["get",...D1];new Set(rC);/**
* React Router v6.30.2
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function $u(){return $u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},$u.apply(this,arguments)}const Dp=C.createContext(null),j1=C.createContext(null),ua=C.createContext(null),jp=C.createContext(null),Ns=C.createContext({outlet:null,matches:[],isDataRoute:!1}),F1=C.createContext(null);function oC(t,e){let{relative:n}=e===void 0?{}:e;bl()||Le(!1);let{basename:s,navigator:a}=C.useContext(ua),{hash:i,pathname:r,search:l}=Fp(t,{relative:n}),c=r;return s!=="/"&&(c=r==="/"?s:ui([s,r])),a.createHref({pathname:c,search:l,hash:i})}function bl(){return C.useContext(jp)!=null}function Sr(){return bl()||Le(!1),C.useContext(jp).location}function O1(t){C.useContext(ua).static||C.useLayoutEffect(t)}function _r(){let{isDataRoute:t}=C.useContext(Ns);return t?AC():lC()}function lC(){bl()||Le(!1);let t=C.useContext(Dp),{basename:e,future:n,navigator:s}=C.useContext(ua),{matches:a}=C.useContext(Ns),{pathname:i}=Sr(),r=JSON.stringify(qb(a,n.v7_relativeSplatPath)),l=C.useRef(!1);return O1(()=>{l.current=!0}),C.useCallback(function(c,u){if(u===void 0&&(u={}),!l.current)return;if(typeof c=="number"){s.go(c);return}let h=Xb(c,JSON.parse(r),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ui([e,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[e,s,r,i,t])}const cC=C.createContext(null);function uC(t){let e=C.useContext(Ns).outlet;return e&&C.createElement(cC.Provider,{value:t},e)}function hC(){let{matches:t}=C.useContext(Ns),e=t[t.length-1];return e?e.params:{}}function Fp(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=C.useContext(ua),{matches:a}=C.useContext(Ns),{pathname:i}=Sr(),r=JSON.stringify(qb(a,s.v7_relativeSplatPath));return C.useMemo(()=>Xb(t,JSON.parse(r),i,n==="path"),[t,r,i,n])}function dC(t,e){return fC(t,e)}function fC(t,e,n,s){bl()||Le(!1);let{navigator:a}=C.useContext(ua),{matches:i}=C.useContext(Ns),r=i[i.length-1],l=r?r.params:{};r&&r.pathname;let c=r?r.pathnameBase:"/";r&&r.route;let u=Sr(),h;if(e){var d;let S=typeof e=="string"?vl(e):e;c==="/"||(d=S.pathname)!=null&&d.startsWith(c)||Le(!1),h=S}else h=u;let f=h.pathname||"/",g=f;if(c!=="/"){let S=c.replace(/^\//,"").split("/");g="/"+f.replace(/^\//,"").split("/").slice(S.length).join("/")}let v=OE(t,{pathname:g}),y=bC(v&&v.map(S=>Object.assign({},S,{params:Object.assign({},l,S.params),pathname:ui([c,a.encodeLocation?a.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?c:ui([c,a.encodeLocation?a.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),i,n,s);return e&&y?C.createElement(jp.Provider,{value:{location:$u({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ka.Pop}},y):y}function pC(){let t=kC(),e=iC(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),n?C.createElement("pre",{style:s},n):null,null)}const gC=C.createElement(pC,null);class mC extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?C.createElement(Ns.Provider,{value:this.props.routeContext},C.createElement(F1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vC(t){let{routeContext:e,match:n,children:s}=t,a=C.useContext(Dp);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),C.createElement(Ns.Provider,{value:e},s)}function bC(t,e,n,s){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let r=t,l=(a=n)==null?void 0:a.errors;if(l!=null){let h=r.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);h>=0||Le(!1),r=r.slice(0,Math.min(r.length,h+1))}let c=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let h=0;h<r.length;h++){let d=r[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:g}=n,v=d.route.loader&&f[d.route.id]===void 0&&(!g||g[d.route.id]===void 0);if(d.route.lazy||v){c=!0,u>=0?r=r.slice(0,u+1):r=[r[0]];break}}}return r.reduceRight((h,d,f)=>{let g,v=!1,y=null,S=null;n&&(g=l&&d.route.id?l[d.route.id]:void 0,y=d.route.errorElement||gC,c&&(u<0&&f===0?(SC("route-fallback"),v=!0,S=null):u===f&&(v=!0,S=d.route.hydrateFallbackElement||null)));let b=e.concat(r.slice(0,f+1)),x=()=>{let w;return g?w=y:v?w=S:d.route.Component?w=C.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=h,C.createElement(vC,{match:d,routeContext:{outlet:h,matches:b,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?C.createElement(mC,{location:n.location,revalidation:n.revalidation,component:y,error:g,children:x(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):x()},null)}var W1=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(W1||{}),z1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(z1||{});function yC(t){let e=C.useContext(Dp);return e||Le(!1),e}function wC(t){let e=C.useContext(j1);return e||Le(!1),e}function xC(t){let e=C.useContext(Ns);return e||Le(!1),e}function $1(t){let e=xC(),n=e.matches[e.matches.length-1];return n.route.id||Le(!1),n.route.id}function kC(){var t;let e=C.useContext(F1),n=wC(),s=$1();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function AC(){let{router:t}=yC(W1.UseNavigateStable),e=$1(z1.UseNavigateStable),n=C.useRef(!1);return O1(()=>{n.current=!0}),C.useCallback(function(s,a){a===void 0&&(a={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,$u({fromRouteId:e},a)))},[t,e])}const xw={};function SC(t,e,n){xw[t]||(xw[t]=!0)}function _C(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Tm(t){let{to:e,replace:n,state:s,relative:a}=t;bl()||Le(!1);let{future:i,static:r}=C.useContext(ua),{matches:l}=C.useContext(Ns),{pathname:c}=Sr(),u=_r(),h=Xb(e,qb(l,i.v7_relativeSplatPath),c,a==="path"),d=JSON.stringify(h);return C.useEffect(()=>u(JSON.parse(d),{replace:n,state:s,relative:a}),[u,d,a,n,s]),null}function EC(t){return uC(t.context)}function zn(t){Le(!1)}function CC(t){let{basename:e="/",children:n=null,location:s,navigationType:a=Ka.Pop,navigator:i,static:r=!1,future:l}=t;bl()&&Le(!1);let c=e.replace(/^\/*/,"/"),u=C.useMemo(()=>({basename:c,navigator:i,static:r,future:$u({v7_relativeSplatPath:!1},l)}),[c,l,i,r]);typeof s=="string"&&(s=vl(s));let{pathname:h="/",search:d="",hash:f="",state:g=null,key:v="default"}=s,y=C.useMemo(()=>{let S=hl(h,c);return S==null?null:{location:{pathname:S,search:d,hash:f,state:g,key:v},navigationType:a}},[c,h,d,f,g,v,a]);return y==null?null:C.createElement(ua.Provider,{value:u},C.createElement(jp.Provider,{children:n,value:y}))}function MC(t){let{children:e,location:n}=t;return dC(Lm(e),n)}new Promise(()=>{});function Lm(t,e){e===void 0&&(e=[]);let n=[];return C.Children.forEach(t,(s,a)=>{if(!C.isValidElement(s))return;let i=[...e,a];if(s.type===C.Fragment){n.push.apply(n,Lm(s.props.children,i));return}s.type!==zn&&Le(!1),!s.props.index||!s.props.children||Le(!1);let r={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(r.children=Lm(s.props.children,i)),n.push(r)}),n}/**
* React Router DOM v6.30.2
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function Cf(){return Cf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Cf.apply(this,arguments)}function B1(t,e){if(t==null)return{};var n={},s=Object.keys(t),a,i;for(i=0;i<s.length;i++)a=s[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function NC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function PC(t,e){return t.button===0&&(!e||e==="_self")&&!NC(t)}function Rm(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(a=>[n,a]):[[n,s]])},[]))}function TC(t,e){let n=Rm(t);return e&&e.forEach((s,a)=>{n.has(a)||e.getAll(a).forEach(i=>{n.append(a,i)})}),n}const LC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],RC=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],IC="6";try{window.__reactRouterVersion=IC}catch{}const DC=C.createContext({isTransitioning:!1}),jC="startTransition",kw=AS[jC];function FC(t){let{basename:e,children:n,future:s,window:a}=t,i=C.useRef();i.current==null&&(i.current=DE({window:a,v5Compat:!0}));let r=i.current,[l,c]=C.useState({action:r.action,location:r.location}),{v7_startTransition:u}=s||{},h=C.useCallback(d=>{u&&kw?kw(()=>c(d)):c(d)},[c,u]);return C.useLayoutEffect(()=>r.listen(h),[r,h]),C.useEffect(()=>_C(s),[s]),C.createElement(CC,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:r,future:s})}const OC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",WC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zC=C.forwardRef(function(t,e){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:r,target:l,to:c,preventScrollReset:u,viewTransition:h}=t,d=B1(t,LC),{basename:f}=C.useContext(ua),g,v=!1;if(typeof c=="string"&&WC.test(c)&&(g=c,OC))try{let x=new URL(window.location.href),w=c.startsWith("//")?new URL(x.protocol+c):new URL(c),_=hl(w.pathname,f);w.origin===x.origin&&_!=null?c=_+w.search+w.hash:v=!0}catch{}let y=oC(c,{relative:s}),S=UC(c,{replace:i,state:r,target:l,preventScrollReset:u,relative:s,viewTransition:h});function b(x){n&&n(x),x.defaultPrevented||S(x)}return C.createElement("a",Cf({},d,{href:g||y,onClick:v||a?n:b,ref:e,target:l}))}),$C=C.forwardRef(function(t,e){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:i=!1,style:r,to:l,viewTransition:c,children:u}=t,h=B1(t,RC),d=Fp(l,{relative:h.relative}),f=Sr(),g=C.useContext(j1),{navigator:v,basename:y}=C.useContext(ua),S=g!=null&&VC(d)&&c===!0,b=v.encodeLocation?v.encodeLocation(d).pathname:d.pathname,x=f.pathname,w=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;s||(x=x.toLowerCase(),w=w?w.toLowerCase():null,b=b.toLowerCase()),w&&y&&(w=hl(w,y)||w);const _=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let E=x===b||!i&&x.startsWith(b)&&x.charAt(_)==="/",M=w!=null&&(w===b||!i&&w.startsWith(b)&&w.charAt(b.length)==="/"),N={isActive:E,isPending:M,isTransitioning:S},P=E?n:void 0,T;typeof a=="function"?T=a(N):T=[a,E?"active":null,M?"pending":null,S?"transitioning":null].filter(Boolean).join(" ");let I=typeof r=="function"?r(N):r;return C.createElement(zC,Cf({},h,{"aria-current":P,className:T,ref:e,style:I,to:l,viewTransition:c}),typeof u=="function"?u(N):u)});var Im;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Im||(Im={}));var Aw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Aw||(Aw={}));function BC(t){let e=C.useContext(Dp);return e||Le(!1),e}function UC(t,e){let{target:n,replace:s,state:a,preventScrollReset:i,relative:r,viewTransition:l}=e===void 0?{}:e,c=_r(),u=Sr(),h=Fp(t,{relative:r});return C.useCallback(d=>{if(PC(d,n)){d.preventDefault();let f=s!==void 0?s:Ef(u)===Ef(h);c(t,{replace:f,state:a,preventScrollReset:i,relative:r,viewTransition:l})}},[u,c,h,s,a,n,t,i,r,l])}function HC(t){let e=C.useRef(Rm(t)),n=C.useRef(!1),s=Sr(),a=C.useMemo(()=>TC(s.search,n.current?null:e.current),[s.search]),i=_r(),r=C.useCallback((l,c)=>{const u=Rm(typeof l=="function"?l(a):l);n.current=!0,i("?"+u,c)},[i,a]);return[a,r]}function VC(t,e){e===void 0&&(e={});let n=C.useContext(DC);n==null&&Le(!1);let{basename:s}=BC(Im.useViewTransitionState),a=Fp(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=hl(n.currentLocation.pathname,s)||n.currentLocation.pathname,r=hl(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Pm(a.pathname,r)!=null||Pm(a.pathname,i)!=null}const wg="/api/v1";function Sw(){const t=document.cookie.split(";");for(const e of t){const[n,s]=e.trim().split("=");if(n==="csrf_token")return decodeURIComponent(s)}return null}class GC{async request(e,n={}){const{method:s="GET",body:a,headers:i={}}=n,r=localStorage.getItem("access_token"),l=localStorage.getItem("device_id"),c=Sw(),u={"Content-Type":"application/json",...i};r&&(u.Authorization=`Bearer ${r}`),l&&(u["X-Device-ID"]=l),c&&s!=="GET"&&(u["X-CSRF-Token"]=c);const h=localStorage.getItem("desktop_session");h&&(u["X-Desktop-Session"]=h);const d=await fetch(`${wg}${e}`,{method:s,headers:u,body:a?JSON.stringify(a):void 0,credentials:"include"});if(d.status===401){const f=await d.json();if(f.code==="TOKEN_EXPIRED"&&await this.refreshToken())return this.request(e,n);throw new Error(f.error||"Unauthorized")}if(!d.ok){const f=await d.json().catch(()=>({}));throw new Error(f.error||`Request failed: ${d.status}`)}return{data:await d.json()}}async refreshToken(){const e=localStorage.getItem("refresh_token");if(!e)return!1;try{const n=await fetch(`${wg}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});if(!n.ok)return!1;const s=await n.json();return localStorage.setItem("access_token",s.access_token),localStorage.setItem("refresh_token",s.refresh_token),!0}catch{return!1}}async get(e){return this.request(e)}async post(e,n){return this.request(e,{method:"POST",body:n})}async put(e,n){return this.request(e,{method:"PUT",body:n})}async delete(e){return this.request(e,{method:"DELETE"})}async upload(e,n,s){const a=localStorage.getItem("access_token"),i=localStorage.getItem("device_id"),r=Sw(),l=localStorage.getItem("desktop_session"),c=new FormData;c.append("file",n),s&&c.append("title",s);const u={};a&&(u.Authorization=`Bearer ${a}`),i&&(u["X-Device-ID"]=i),r&&(u["X-CSRF-Token"]=r),l&&(u["X-Desktop-Session"]=l);const h=await fetch(`${wg}${e}`,{method:"POST",headers:u,body:c,credentials:"include"});if(!h.ok){const d=await h.json().catch(()=>({}));throw new Error(d.error||"Upload failed")}return{data:await h.json()}}async logEvent(e,n,s,a){try{await this.post("/audit/log",{action_type:e,target_type:n,target_id:s,metadata:a})}catch{}}async getDocumentAccess(e){return this.get(`/documents/${e}/access`)}async grantAccess(e,n){return this.post(`/documents/${e}/access`,{user_id:n})}async revokeAccess(e,n){return this.delete(`/documents/${e}/access/${n}`)}}const ce=new GC,U1=C.createContext(null);function qC({children:t}){const[e,n]=C.useState(null),[s,a]=C.useState(!0);C.useEffect(()=>{i()},[]);const i=async()=>{if(!localStorage.getItem("access_token")){a(!1);return}try{const u=await ce.get("/auth/profile");n(u.data)}catch{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}finally{a(!1)}},r=async(u,h,d)=>{const f=XC(),g=await ce.post("/auth/login",{email:u,password:h,totp_code:d,device_id:f});return g.data.requires_totp?{requiresTOTP:!0}:(localStorage.setItem("access_token",g.data.access_token),localStorage.setItem("refresh_token",g.data.refresh_token),g.data.client_ip&&localStorage.setItem("client_ip",g.data.client_ip),n(g.data.user),{requiresPasswordChange:g.data.requires_password_change||!1,requiresMFAEnrollment:g.data.requires_mfa_enrollment||!1})},l=async()=>{try{await ce.post("/auth/logout")}catch{}localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),n(null)},c=async()=>{const u=await ce.get("/auth/profile");n(u.data)};return p.jsx(U1.Provider,{value:{user:e,loading:s,login:r,logout:l,refreshUser:c},children:t})}function On(){const t=C.useContext(U1);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}function XC(){let t=localStorage.getItem("device_id");return t||(t="web-"+YC(),localStorage.setItem("device_id",t)),t}function YC(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}const H1=C.createContext(null);function KC({children:t}){const{user:e}=On(),[n,s]=C.useState(()=>{const i=localStorage.getItem("theme");return i==="twilight"||i==="glacium"?i:"twilight"});C.useEffect(()=>{e?e.role==="super_admin"||e.role==="admin"?s("twilight"):s("glacium"):s("twilight")},[e]),C.useEffect(()=>{document.documentElement.setAttribute("data-theme",n),localStorage.setItem("theme",n)},[n]);const a=()=>{s(i=>i==="twilight"?"glacium":"twilight")};return p.jsx(H1.Provider,{value:{theme:n,toggleTheme:a},children:t})}function V1(){const t=C.useContext(H1);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t}/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/var QC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const JC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ie=(t,e)=>{const n=C.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:r,className:l="",children:c,...u},h)=>C.createElement("svg",{ref:h,...QC,width:a,height:a,stroke:s,strokeWidth:r?Number(i)*24/Number(a):i,className:["lucide",`lucide-${JC(t)}`,l].join(" "),...u},[...e.map(([d,f])=>C.createElement(d,f)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const _w=ie("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const G1=ie("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const ZC=ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const q1=ie("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const eM=ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const tM=ie("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const nM=ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const X1=ie("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Dm=ie("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Wh=ie("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const zh=ie("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const _s=ie("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const sM=ie("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Ew=ie("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const aM=ie("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const iM=ie("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Y1=ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const K1=ie("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const rM=ie("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Mf=ie("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const oM=ie("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Q1=ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const J1=ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const lM=ie("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Nf=ie("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const cM=ie("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const jm=ie("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Yb=ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Z1=ie("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const uM=ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const dl=ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const hM=ie("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const yl=ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const dM=ie("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
* @license lucide-react v0.303.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const fM=ie("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function pM(){const[t,e]=C.useState(""),[n,s]=C.useState(""),[a,i]=C.useState(""),[r,l]=C.useState(!1),[c,u]=C.useState(!1),[h,d]=C.useState(!1),[f,g]=C.useState(""),{login:v,user:y}=On(),S=_r(),[b]=HC();C.useEffect(()=>{const w=b.get("auto"),_=b.get("token"),E=b.get("desktop_session"),M=b.get("refresh");if(w==="1"&&_&&E){localStorage.setItem("access_token",_),localStorage.setItem("desktop_session",E),M&&localStorage.setItem("refresh_token",M),window.history.replaceState({},document.title,"/login"),window.location.href="/dashboard";return}E&&!_&&(localStorage.setItem("desktop_session",E),window.history.replaceState({},document.title,"/login")),y&&S("/dashboard")},[b,y,S]);const x=async w=>{w.preventDefault(),g(""),d(!0);try{const _=await v(t,n,c?a:void 0);if(_.requiresTOTP){u(!0),d(!1);return}if(_.requiresPasswordChange){S("/force-change-password");return}if(_.requiresMFAEnrollment){S("/force-enroll-mfa");return}S("/dashboard")}catch(_){g(_ instanceof Error?_.message:"Login failed"),d(!1)}};return p.jsxs("div",{className:"login-page",children:[p.jsxs("div",{className:"login-bg",children:[p.jsx("div",{className:"bg-gradient"}),p.jsx("div",{className:"bg-pattern"})]}),p.jsx("div",{className:"login-container animate-slideUp",children:p.jsxs("div",{className:"login-card glass-card",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("div",{className:"logo-icon",children:p.jsx(Nf,{size:40})}),p.jsx("h1",{children:"SRAMS"}),p.jsx("p",{children:"Secure Role-Based Audit Management System"})]}),p.jsxs("form",{onSubmit:x,className:"login-form",children:[f&&p.jsx("div",{className:"error-message",children:f}),c?p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Two-Factor Authentication Code"}),p.jsx("input",{type:"text",className:"input totp-input",value:a,onChange:w=>i(w.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",required:!0,autoComplete:"one-time-code",maxLength:6}),p.jsx("p",{className:"totp-hint",children:"Enter the 6-digit code from your authenticator app"})]}):p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Email"}),p.jsx("input",{type:"email",className:"input",value:t,onChange:w=>e(w.target.value),placeholder:"admin@example.com",required:!0,autoComplete:"email"})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Password"}),p.jsxs("div",{className:"password-input",children:[p.jsx("input",{type:r?"text":"password",className:"input",value:n,onChange:w=>s(w.target.value),placeholder:"",required:!0,autoComplete:"current-password"}),p.jsx("button",{type:"button",className:"toggle-password",onClick:()=>l(!r),children:r?p.jsx(Wh,{size:18}):p.jsx(zh,{size:18})})]})]})]}),p.jsx("button",{type:"submit",className:"btn btn-primary login-btn",disabled:h,children:h?p.jsxs(p.Fragment,{children:[p.jsx(iM,{size:18,className:"animate-spin"}),p.jsx("span",{children:"Signing in..."})]}):p.jsx("span",{children:c?"Verify":"Sign In"})}),c&&p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{u(!1),i("")},children:"Back to Login"})]}),p.jsx("div",{className:"login-footer",children:p.jsx("p",{children:"Secure  Audited  Compliant"})})]})})]})}function gM(){const t=_r(),{refreshUser:e}=On(),[n,s]=C.useState(""),[a,i]=C.useState(""),[r,l]=C.useState(""),[c,u]=C.useState(!1),[h,d]=C.useState(!1),[f,g]=C.useState(!1),[v,y]=C.useState(""),[S,b]=C.useState(!1),x=async w=>{var _,E;if(w.preventDefault(),y(""),a!==r){y("New passwords do not match");return}if(a.length<8){y("Password must be at least 8 characters");return}if(a===n){y("New password must be different from current password");return}b(!0);try{await ce.post("/auth/change-password",{current_password:n,new_password:a}),await e(),t("/dashboard")}catch(M){const N=M;y(((E=(_=N==null?void 0:N.response)==null?void 0:_.data)==null?void 0:E.error)||"Failed to change password")}finally{b(!1)}};return p.jsx("div",{className:"login-page",children:p.jsx("div",{className:"login-container",children:p.jsxs("div",{className:"login-card glass-card",children:[p.jsxs("div",{className:"login-header",children:[p.jsx("div",{className:"login-icon",children:p.jsx(Y1,{size:32})}),p.jsx("h1",{children:"Password Change Required"}),p.jsx("p",{children:"For security reasons, you must change your password before continuing."})]}),p.jsxs("form",{onSubmit:x,className:"login-form",children:[v&&p.jsxs("div",{className:"error-message",children:[p.jsx(G1,{size:16}),p.jsx("span",{children:v})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Current Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:c?"text":"password",className:"input",placeholder:"Enter your current password",value:n,onChange:w=>s(w.target.value),required:!0,autoComplete:"current-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>u(!c),tabIndex:-1,children:c?p.jsx(Wh,{size:18}):p.jsx(zh,{size:18})})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"New Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:h?"text":"password",className:"input",placeholder:"Enter your new password",value:a,onChange:w=>i(w.target.value),required:!0,minLength:8,autoComplete:"new-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>d(!h),tabIndex:-1,children:h?p.jsx(Wh,{size:18}):p.jsx(zh,{size:18})})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Confirm New Password"}),p.jsxs("div",{className:"input-wrapper",children:[p.jsx("input",{type:f?"text":"password",className:"input",placeholder:"Confirm your new password",value:r,onChange:w=>l(w.target.value),required:!0,minLength:8,autoComplete:"new-password"}),p.jsx("button",{type:"button",className:"input-icon-btn",onClick:()=>g(!f),tabIndex:-1,children:f?p.jsx(Wh,{size:18}):p.jsx(zh,{size:18})})]})]}),a.length>=8&&a===r&&p.jsxs("div",{className:"success-hint",children:[p.jsx(q1,{size:16}),p.jsx("span",{children:"Passwords match!"})]}),p.jsx("button",{type:"submit",className:"btn btn-primary btn-full",disabled:S||!n||!a||!r,children:S?"Changing Password...":"Change Password & Continue"})]})]})})})}function mM(){const{user:t}=On(),[e,n]=C.useState(null),[s,a]=C.useState([]),[i,r]=C.useState([]),[l,c]=C.useState(!0),u=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin";C.useEffect(()=>{h(),ce.logEvent("page_view","dashboard")},[]);const h=async()=>{try{if(u){const g=await ce.get("/dashboard/stats");n(g.data)}const d=await ce.get("/documents/my?limit=5");a(d.data.documents||[]);const f=await ce.get("/requests/my?limit=5");r(f.data.requests||[])}catch(d){console.error("Failed to load dashboard:",d)}finally{c(!1)}};return l?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"dashboard animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("h1",{children:["Welcome back, ",t==null?void 0:t.full_name]}),p.jsx("p",{children:u?"Here's an overview of your system":"Access your documents and manage requests"})]}),u&&e&&p.jsxs("div",{className:"stats-grid",children:[p.jsx(vh,{icon:p.jsx(dl,{}),label:"Total Users",value:e.total_users,subtext:`${e.active_users} active`,color:"blue"}),p.jsx(vh,{icon:p.jsx(_s,{}),label:"Documents",value:e.total_documents,color:"purple"}),p.jsx(vh,{icon:p.jsx(G1,{}),label:"Pending Requests",value:e.pending_requests,color:"yellow"}),p.jsx(vh,{icon:p.jsx(_w,{}),label:"Active Sessions",value:e.active_sessions,subtext:`${e.today_logins} logins today`,color:"green"})]}),p.jsxs("div",{className:"dashboard-grid",children:[p.jsxs("div",{className:"dashboard-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsxs("h2",{children:[p.jsx(_s,{size:20})," My Documents"]}),p.jsx("a",{href:"/documents",className:"view-all",children:"View All "})]}),s.length>0?p.jsx("div",{className:"document-list",children:s.map(d=>p.jsxs("a",{href:`/documents/${d.id}`,className:"document-item",children:[p.jsx(_s,{size:18}),p.jsxs("div",{className:"document-info",children:[p.jsx("span",{className:"document-title",children:d.title}),p.jsx("span",{className:"document-date",children:new Date(d.created_at).toLocaleDateString()})]})]},d.id))}):p.jsxs("div",{className:"empty-state",children:[p.jsx(_s,{size:40}),p.jsx("p",{children:"No documents assigned yet"})]})]}),p.jsxs("div",{className:"dashboard-section glass-card",children:[p.jsx("div",{className:"section-header",children:p.jsxs("h2",{children:[p.jsx(Dm,{size:20})," My Requests"]})}),i.length>0?p.jsx("div",{className:"request-list",children:i.map(d=>p.jsxs("div",{className:"request-item",children:[p.jsx(vM,{status:d.status}),p.jsxs("div",{className:"request-info",children:[p.jsx("span",{className:"request-reason",children:d.reason||"Document access request"}),p.jsx("span",{className:"request-date",children:new Date(d.created_at).toLocaleDateString()})]}),p.jsx("span",{className:`badge badge-${bM(d.status)}`,children:d.status})]},d.id))}):p.jsxs("div",{className:"empty-state",children:[p.jsx(Dm,{size:40}),p.jsx("p",{children:"No requests yet"})]})]})]}),p.jsxs("div",{className:"quick-actions glass-card",children:[p.jsx("h2",{children:"Quick Actions"}),p.jsxs("div",{className:"action-buttons",children:[p.jsxs("a",{href:"/documents",className:"btn btn-primary",children:[p.jsx(_s,{size:18}),"Browse Documents"]}),u&&p.jsxs(p.Fragment,{children:[p.jsxs("a",{href:"/users",className:"btn btn-secondary",children:[p.jsx(dl,{size:18}),"Manage Users"]}),p.jsxs("a",{href:"/audit",className:"btn btn-secondary",children:[p.jsx(_w,{size:18}),"View Audit Logs"]})]})]})]})]})}function vh({icon:t,label:e,value:n,subtext:s,color:a}){return p.jsxs("div",{className:`stat-card glass-card stat-${a}`,children:[p.jsx("div",{className:"stat-icon",children:t}),p.jsxs("div",{className:"stat-content",children:[p.jsx("span",{className:"stat-value",children:n.toLocaleString()}),p.jsx("span",{className:"stat-label",children:e}),s&&p.jsx("span",{className:"stat-subtext",children:s})]})]})}function vM({status:t}){switch(t){case"approved":return p.jsx(q1,{size:18,className:"status-approved"});case"rejected":return p.jsx(hM,{size:18,className:"status-rejected"});default:return p.jsx(Dm,{size:18,className:"status-pending"})}}function bM(t){switch(t){case"approved":return"success";case"rejected":return"error";default:return"warning"}}function yM(){const{user:t}=On(),[e,n]=C.useState([]),[s,a]=C.useState([]),[i,r]=C.useState(!0),[l,c]=C.useState(""),[u,h]=C.useState(!1),[d,f]=C.useState(!1),[g,v]=C.useState(!1),[y,S]=C.useState(null),b=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="super_admin";C.useEffect(()=>{x()},[]);const x=async()=>{try{const M=await ce.get("/documents/my");if(n(M.data.documents||[]),b){const N=await ce.get("/documents");a(N.data.documents||[])}}catch(M){console.error("Failed to load documents:",M)}finally{r(!1)}},w=M=>M<1024?M+" B":M<1024*1024?(M/1024).toFixed(1)+" KB":(M/(1024*1024)).toFixed(1)+" MB",_=e.filter(M=>M.title.toLowerCase().includes(l.toLowerCase())||M.filename.toLowerCase().includes(l.toLowerCase())),E=s.filter(M=>M.title.toLowerCase().includes(l.toLowerCase())||M.filename.toLowerCase().includes(l.toLowerCase()));return i?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"documents-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Documents"}),p.jsx("p",{children:"View and manage your documents"})]}),p.jsxs("div",{className:"header-actions",children:[b&&p.jsxs("button",{className:"btn btn-primary",onClick:()=>h(!0),children:[p.jsx(Z1,{size:18}),"Upload"]}),!b&&p.jsxs("button",{className:"btn btn-secondary",onClick:()=>f(!0),children:[p.jsx(Q1,{size:18}),"Request Access"]})]})]}),p.jsxs("div",{className:"search-bar glass-card",children:[p.jsx(J1,{size:20}),p.jsx("input",{type:"text",placeholder:"Search documents...",value:l,onChange:M=>c(M.target.value)})]}),p.jsxs("section",{className:"document-section",children:[p.jsx("h2",{children:"My Documents"}),_.length>0?p.jsx("div",{className:"document-grid",children:_.map(M=>p.jsxs("a",{href:`/documents/${M.id}`,className:"document-card glass-card",children:[p.jsx("div",{className:"doc-icon",children:p.jsx(_s,{size:32})}),p.jsxs("div",{className:"doc-details",children:[p.jsx("h3",{children:M.title}),p.jsx("p",{children:M.filename}),p.jsxs("span",{className:"doc-meta",children:[w(M.file_size),"  ",new Date(M.created_at).toLocaleDateString()]})]})]},M.id))}):p.jsxs("div",{className:"empty-state glass-card",children:[p.jsx(_s,{size:48}),p.jsx("h3",{children:"No documents"}),p.jsx("p",{children:"You don't have any assigned documents yet"})]})]}),b&&p.jsxs("section",{className:"document-section",children:[p.jsx("h2",{children:"All Documents"}),E.length>0?p.jsx("div",{className:"document-grid",children:E.map(M=>p.jsxs("div",{className:"document-card glass-card",children:[p.jsxs("a",{href:`/documents/${M.id}`,className:"doc-link",children:[p.jsx("div",{className:"doc-icon",children:p.jsx(_s,{size:32})}),p.jsxs("div",{className:"doc-details",children:[p.jsx("h3",{children:M.title}),p.jsx("p",{children:M.filename}),p.jsxs("span",{className:"doc-meta",children:[w(M.file_size),"  ",new Date(M.created_at).toLocaleDateString()]})]})]}),p.jsxs("button",{className:"btn btn-small btn-secondary assign-btn",onClick:N=>{N.preventDefault(),N.stopPropagation(),S(M),v(!0)},children:[p.jsx(dl,{size:14}),"Assign Users"]})]},M.id))}):p.jsxs("div",{className:"empty-state glass-card",children:[p.jsx(_s,{size:48}),p.jsx("h3",{children:"No documents uploaded"}),p.jsx("p",{children:"Upload your first document to get started"})]})]}),u&&p.jsx(wM,{onClose:()=>h(!1),onSuccess:x}),d&&p.jsx(xM,{documents:s,onClose:()=>f(!1),onSuccess:x}),g&&y&&p.jsx(kM,{document:y,onClose:()=>{v(!1),S(null)},onSuccess:x})]})}function wM({onClose:t,onSuccess:e}){const[n,s]=C.useState(null),[a,i]=C.useState(""),[r,l]=C.useState(!1),[c,u]=C.useState(""),h=async()=>{if(n){l(!0),u("");try{await ce.upload("/documents",n,a||n.name),e(),t()}catch(d){u(d instanceof Error?d.message:"Upload failed")}finally{l(!1)}}};return p.jsx("div",{className:"modal-overlay",onClick:t,children:p.jsxs("div",{className:"modal glass-card",onClick:d=>d.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Upload Document"}),p.jsx("button",{className:"close-btn",onClick:t,children:p.jsx(yl,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[c&&p.jsx("div",{className:"error-message",children:c}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Title"}),p.jsx("input",{type:"text",className:"input",value:a,onChange:d=>i(d.target.value),placeholder:"Document title"})]}),p.jsxs("div",{className:"file-input",children:[p.jsx("input",{type:"file",accept:".pdf",onChange:d=>{var f;return s(((f=d.target.files)==null?void 0:f[0])||null)}}),n&&p.jsx("span",{className:"file-name",children:n.name})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:h,disabled:!n||r,children:r?"Uploading...":"Upload"})]})]})})}function xM({documents:t,onClose:e,onSuccess:n}){const[s,a]=C.useState(""),[i,r]=C.useState(""),[l,c]=C.useState(!1),[u,h]=C.useState(""),d=async()=>{if(s){c(!0),h("");try{await ce.post("/requests",{document_id:s,reason:i}),n(),e()}catch(f){h(f instanceof Error?f.message:"Request failed")}finally{c(!1)}}};return p.jsx("div",{className:"modal-overlay",onClick:e,children:p.jsxs("div",{className:"modal glass-card",onClick:f=>f.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Request Document Access"}),p.jsx("button",{className:"close-btn",onClick:e,children:p.jsx(yl,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[u&&p.jsx("div",{className:"error-message",children:u}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Select Document"}),p.jsxs("select",{className:"input",value:s,onChange:f=>a(f.target.value),children:[p.jsx("option",{value:"",children:"Choose a document..."}),t.map(f=>p.jsx("option",{value:f.id,children:f.title},f.id))]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Reason (optional)"}),p.jsx("textarea",{className:"input",value:i,onChange:f=>r(f.target.value),placeholder:"Why do you need access to this document?",rows:3})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:d,disabled:!s||l,children:l?"Submitting...":"Submit Request"})]})]})})}function kM({document:t,onClose:e,onSuccess:n}){const[s,a]=C.useState([]),[i,r]=C.useState(new Set),[l,c]=C.useState(new Set),[u,h]=C.useState(!0),[d,f]=C.useState(!1),[g,v]=C.useState("");C.useEffect(()=>{y()},[]);const y=async()=>{try{const w=((await ce.get("/users")).data.users||[]).filter(M=>!["admin","super_admin"].includes(M.role||""));a(w);const _=await ce.getDocumentAccess(t.id),E=new Set((_.data.users||[]).map(M=>M.id));r(E),c(new Set(E))}catch(w){console.error("Failed to load data:",w),v("Failed to load users")}finally{h(!1)}},S=w=>{r(_=>{const E=new Set(_);return E.has(w)?E.delete(w):E.add(w),E})},b=async()=>{f(!0),v("");try{const w=[...i].filter(E=>!l.has(E)),_=[...l].filter(E=>!i.has(E));for(const E of w)await ce.grantAccess(t.id,E);for(const E of _)await ce.revokeAccess(t.id,E);n(),e()}catch(w){v(w instanceof Error?w.message:"Failed to save changes")}finally{f(!1)}},x=()=>{if(i.size!==l.size)return!0;for(const w of i)if(!l.has(w))return!0;return!1};return p.jsx("div",{className:"modal-overlay",onClick:e,children:p.jsxs("div",{className:"modal glass-card modal-large",onClick:w=>w.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsxs("h2",{children:["Assign Users to: ",t.title]}),p.jsx("button",{className:"close-btn",onClick:e,children:p.jsx(yl,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[g&&p.jsx("div",{className:"error-message",children:g}),u?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):s.length===0?p.jsxs("div",{className:"empty-state",children:[p.jsx(dl,{size:32}),p.jsx("p",{children:"No users available to assign"})]}):p.jsx("div",{className:"user-list",children:s.map(w=>p.jsxs("div",{className:`user-item ${i.has(w.id)?"selected":""}`,onClick:()=>S(w.id),children:[p.jsx("div",{className:"user-checkbox",children:i.has(w.id)&&p.jsx(eM,{size:16})}),p.jsxs("div",{className:"user-info",children:[p.jsx("span",{className:"user-name",children:w.full_name}),p.jsx("span",{className:"user-email",children:w.email})]})]},w.id))})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsxs("span",{className:"selection-count",children:[i.size," user",i.size!==1?"s":""," selected"]}),p.jsxs("div",{className:"footer-actions",children:[p.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:b,disabled:!x()||d,children:d?"Saving...":"Save Changes"})]})]})]})})}var Gc={};Gc.d=(t,e)=>{for(var n in e)Gc.o(e,n)&&!Gc.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})};Gc.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var K=globalThis.pdfjsLib={};Gc.d(K,{AbortException:()=>fi,AnnotationEditorLayer:()=>FN,AnnotationEditorParamsType:()=>ae,AnnotationEditorType:()=>J,AnnotationEditorUIManager:()=>Uu,AnnotationLayer:()=>_N,AnnotationMode:()=>za,ColorPicker:()=>RA,DOMSVGFactory:()=>iy,DrawLayer:()=>ON,FeatureTest:()=>Wt,GlobalWorkerOptions:()=>pi,ImageKind:()=>$h,InvalidPDFException:()=>Om,MissingPDFException:()=>Bu,OPS:()=>Xn,OutputScale:()=>ny,PDFDataRangeTransport:()=>eA,PDFDateString:()=>ey,PDFWorker:()=>yd,PasswordResponses:()=>EM,PermissionFlag:()=>_M,PixelsPerInch:()=>fl,RenderingCancelledException:()=>Jb,TextLayer:()=>mv,TouchManager:()=>wk,UnexpectedResponseException:()=>Pf,Util:()=>$,VerbosityLevel:()=>Op,XfaLayer:()=>sA,build:()=>aN,createValidAbsoluteUrl:()=>PM,fetchData:()=>Bp,getDocument:()=>q2,getFilenameFromUrl:()=>WM,getPdfFilenameFromUrl:()=>zM,getXfaPageViewport:()=>$M,isDataScheme:()=>Up,isPdfFile:()=>Zb,noContextMenu:()=>ts,normalizeUnicode:()=>jM,setLayerDimensions:()=>yr,shadow:()=>ee,stopEvent:()=>un,version:()=>sN});const Nt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),ek=[1,0,0,1,0,0],Fm=[.001,0,0,.001,0,0],AM=1e7,xg=1.35,rn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},za={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},SM="pdfjs_internal_editor_",J={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},ae={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},_M={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},yt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},$h={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ge={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Ml={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Op={ERRORS:0,WARNINGS:1,INFOS:5},Xn={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},EM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Wp=Op.WARNINGS;function CM(t){Number.isInteger(t)&&(Wp=t)}function MM(){return Wp}function zp(t){Wp>=Op.INFOS&&console.log(`Info: ${t}`)}function Z(t){Wp>=Op.WARNINGS&&console.log(`Warning: ${t}`)}function ye(t){throw new Error(t)}function Ve(t,e){t||ye(e)}function NM(t){switch(t==null?void 0:t.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function PM(t,e=null,n=null){if(!t)return null;try{if(n&&typeof t=="string"){if(n.addDefaultProtocol&&t.startsWith("www.")){const a=t.match(/\./g);(a==null?void 0:a.length)>=2&&(t=`http://${t}`)}if(n.tryConvertEncoding)try{t=DM(t)}catch{}}const s=e?new URL(t,e):new URL(t);if(NM(s))return s}catch{}return null}function ee(t,e,n,s=!1){return Object.defineProperty(t,e,{value:n,enumerable:!s,configurable:!0,writable:!1}),n}const yi=function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t}();class Cw extends yi{constructor(e,n){super(e,"PasswordException"),this.code=n}}class kg extends yi{constructor(e,n){super(e,"UnknownErrorException"),this.details=n}}class Om extends yi{constructor(e){super(e,"InvalidPDFException")}}class Bu extends yi{constructor(e){super(e,"MissingPDFException")}}class Pf extends yi{constructor(e,n){super(e,"UnexpectedResponseException"),this.status=n}}class TM extends yi{constructor(e){super(e,"FormatError")}}class fi extends yi{constructor(e){super(e,"AbortException")}}function tk(t){(typeof t!="object"||(t==null?void 0:t.length)===void 0)&&ye("Invalid argument for bytesToString");const e=t.length,n=8192;if(e<n)return String.fromCharCode.apply(null,t);const s=[];for(let a=0;a<e;a+=n){const i=Math.min(a+n,e),r=t.subarray(a,i);s.push(String.fromCharCode.apply(null,r))}return s.join("")}function $p(t){typeof t!="string"&&ye("Invalid argument for stringToBytes");const e=t.length,n=new Uint8Array(e);for(let s=0;s<e;++s)n[s]=t.charCodeAt(s)&255;return n}function LM(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,t&255)}function Kb(t){const e=Object.create(null);for(const[n,s]of t)e[n]=s;return e}function RM(){const t=new Uint8Array(4);return t[0]=1,new Uint32Array(t.buffer,0,1)[0]===1}function IM(){try{return new Function(""),!0}catch{return!1}}class Wt{static get isLittleEndian(){return ee(this,"isLittleEndian",RM())}static get isEvalSupported(){return ee(this,"isEvalSupported",IM())}static get isOffscreenCanvasSupported(){return ee(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ee(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ee(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ee(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,n;return ee(this,"isCSSRoundSupported",(n=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:n.call(e,"width: round(1.5px, 1px)"))}}const Ag=Array.from(Array(256).keys(),t=>t.toString(16).padStart(2,"0"));var qi,bh,Wm;class ${static makeHexColor(e,n,s){return`#${Ag[e]}${Ag[n]}${Ag[s]}`}static scaleMinMax(e,n){let s;e[0]?(e[0]<0&&(s=n[0],n[0]=n[2],n[2]=s),n[0]*=e[0],n[2]*=e[0],e[3]<0&&(s=n[1],n[1]=n[3],n[3]=s),n[1]*=e[3],n[3]*=e[3]):(s=n[0],n[0]=n[1],n[1]=s,s=n[2],n[2]=n[3],n[3]=s,e[1]<0&&(s=n[1],n[1]=n[3],n[3]=s),n[1]*=e[1],n[3]*=e[1],e[2]<0&&(s=n[0],n[0]=n[2],n[2]=s),n[0]*=e[2],n[2]*=e[2]),n[0]+=e[4],n[1]+=e[5],n[2]+=e[4],n[3]+=e[5]}static transform(e,n){return[e[0]*n[0]+e[2]*n[1],e[1]*n[0]+e[3]*n[1],e[0]*n[2]+e[2]*n[3],e[1]*n[2]+e[3]*n[3],e[0]*n[4]+e[2]*n[5]+e[4],e[1]*n[4]+e[3]*n[5]+e[5]]}static applyTransform(e,n){const s=e[0]*n[0]+e[1]*n[2]+n[4],a=e[0]*n[1]+e[1]*n[3]+n[5];return[s,a]}static applyInverseTransform(e,n){const s=n[0]*n[3]-n[1]*n[2],a=(e[0]*n[3]-e[1]*n[2]+n[2]*n[5]-n[4]*n[3])/s,i=(-e[0]*n[1]+e[1]*n[0]+n[4]*n[1]-n[5]*n[0])/s;return[a,i]}static getAxialAlignedBoundingBox(e,n){const s=this.applyTransform(e,n),a=this.applyTransform(e.slice(2,4),n),i=this.applyTransform([e[0],e[3]],n),r=this.applyTransform([e[2],e[1]],n);return[Math.min(s[0],a[0],i[0],r[0]),Math.min(s[1],a[1],i[1],r[1]),Math.max(s[0],a[0],i[0],r[0]),Math.max(s[1],a[1],i[1],r[1])]}static inverseTransform(e){const n=e[0]*e[3]-e[1]*e[2];return[e[3]/n,-e[1]/n,-e[2]/n,e[0]/n,(e[2]*e[5]-e[4]*e[3])/n,(e[4]*e[1]-e[5]*e[0])/n]}static singularValueDecompose2dScale(e){const n=[e[0],e[2],e[1],e[3]],s=e[0]*n[0]+e[1]*n[2],a=e[0]*n[1]+e[1]*n[3],i=e[2]*n[0]+e[3]*n[2],r=e[2]*n[1]+e[3]*n[3],l=(s+r)/2,c=Math.sqrt((s+r)**2-4*(s*r-i*a))/2,u=l+c||1,h=l-c||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const n=e.slice(0);return e[0]>e[2]&&(n[0]=e[2],n[2]=e[0]),e[1]>e[3]&&(n[1]=e[3],n[3]=e[1]),n}static intersect(e,n){const s=Math.max(Math.min(e[0],e[2]),Math.min(n[0],n[2])),a=Math.min(Math.max(e[0],e[2]),Math.max(n[0],n[2]));if(s>a)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(n[1],n[3])),r=Math.min(Math.max(e[1],e[3]),Math.max(n[1],n[3]));return i>r?null:[s,i,a,r]}static bezierBoundingBox(e,n,s,a,i,r,l,c,u){return u?(u[0]=Math.min(u[0],e,l),u[1]=Math.min(u[1],n,c),u[2]=Math.max(u[2],e,l),u[3]=Math.max(u[3],n,c)):u=[Math.min(e,l),Math.min(n,c),Math.max(e,l),Math.max(n,c)],A(this,qi,Wm).call(this,e,s,i,l,n,a,r,c,3*(-e+3*(s-i)+l),6*(e-2*s+i),3*(s-e),u),A(this,qi,Wm).call(this,e,s,i,l,n,a,r,c,3*(-n+3*(a-r)+c),6*(n-2*a+r),3*(a-n),u),u}}qi=new WeakSet,bh=function(t,e,n,s,a,i,r,l,c,u){if(c<=0||c>=1)return;const h=1-c,d=c*c,f=d*c,g=h*(h*(h*t+3*c*e)+3*d*n)+f*s,v=h*(h*(h*a+3*c*i)+3*d*r)+f*l;u[0]=Math.min(u[0],g),u[1]=Math.min(u[1],v),u[2]=Math.max(u[2],g),u[3]=Math.max(u[3],v)},Wm=function(t,e,n,s,a,i,r,l,c,u,h,d){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&A(this,qi,bh).call(this,t,e,n,s,a,i,r,l,-h/u,d);return}const f=u**2-4*h*c;if(f<0)return;const g=Math.sqrt(f),v=2*c;A(this,qi,bh).call(this,t,e,n,s,a,i,r,l,(-u+g)/v,d),A(this,qi,bh).call(this,t,e,n,s,a,i,r,l,(-u-g)/v,d)},k($,qi);function DM(t){return decodeURIComponent(escape(t))}let Sg=null,Mw=null;function jM(t){return Sg||(Sg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Mw=new Map([["","t"]])),t.replaceAll(Sg,(e,n,s)=>n?n.normalize("NFKC"):Mw.get(s))}function FM(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const t=new Uint8Array(32);return crypto.getRandomValues(t),tk(t)}const Qb="pdfjs_internal_id_";function OM(t){return Uint8Array.prototype.toBase64?t.toBase64():btoa(tk(t))}typeof Promise.try!="function"&&(Promise.try=function(t,...e){return new Promise(n=>{n(t(...e))})});const Ps="http://www.w3.org/2000/svg",Nr=class{};X(Nr,"CSS",96),X(Nr,"PDF",72),X(Nr,"PDF_TO_CSS_UNITS",Nr.CSS/Nr.PDF);let fl=Nr;async function Bp(t,e="text"){if($l(t,document.baseURI)){const n=await fetch(t);if(!n.ok)throw new Error(n.statusText);switch(e){case"arraybuffer":return n.arrayBuffer();case"blob":return n.blob();case"json":return n.json()}return n.text()}return new Promise((n,s)=>{const a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType=e,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(e){case"arraybuffer":case"blob":case"json":n(a.response);return}n(a.responseText);return}s(new Error(a.statusText))}},a.send(null)})}class Qu{constructor({viewBox:e,userUnit:n,scale:s,rotation:a,offsetX:i=0,offsetY:r=0,dontFlip:l=!1}){this.viewBox=e,this.userUnit=n,this.scale=s,this.rotation=a,this.offsetX=i,this.offsetY=r,s*=n;const c=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,d,f,g;switch(a%=360,a<0&&(a+=360),a){case 180:h=-1,d=0,f=0,g=1;break;case 90:h=0,d=1,f=1,g=0;break;case 270:h=0,d=-1,f=-1,g=0;break;case 0:h=1,d=0,f=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(f=-f,g=-g);let v,y,S,b;h===0?(v=Math.abs(u-e[1])*s+i,y=Math.abs(c-e[0])*s+r,S=(e[3]-e[1])*s,b=(e[2]-e[0])*s):(v=Math.abs(c-e[0])*s+i,y=Math.abs(u-e[1])*s+r,S=(e[2]-e[0])*s,b=(e[3]-e[1])*s),this.transform=[h*s,d*s,f*s,g*s,v-h*s*c-f*s*u,y-d*s*c-g*s*u],this.width=S,this.height=b}get rawDims(){const{userUnit:e,viewBox:n}=this,s=n.map(a=>a*e);return ee(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:e=this.scale,rotation:n=this.rotation,offsetX:s=this.offsetX,offsetY:a=this.offsetY,dontFlip:i=!1}={}){return new Qu({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:n,offsetX:s,offsetY:a,dontFlip:i})}convertToViewportPoint(e,n){return $.applyTransform([e,n],this.transform)}convertToViewportRectangle(e){const n=$.applyTransform([e[0],e[1]],this.transform),s=$.applyTransform([e[2],e[3]],this.transform);return[n[0],n[1],s[0],s[1]]}convertToPdfPoint(e,n){return $.applyInverseTransform([e,n],this.transform)}}class Jb extends yi{constructor(e,n=0){super(e,"RenderingCancelledException"),this.extraDelay=n}}function Up(t){const e=t.length;let n=0;for(;n<e&&t[n].trim()==="";)n++;return t.substring(n,n+5).toLowerCase()==="data:"}function Zb(t){return typeof t=="string"&&/\.pdf$/i.test(t)}function WM(t){return[t]=t.split(/[#?]/,1),t.substring(t.lastIndexOf("/")+1)}function zM(t,e="document.pdf"){if(typeof t!="string")return e;if(Up(t))return Z('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,a=n.exec(t);let i=s.exec(a[1])||s.exec(a[2])||s.exec(a[3]);if(i&&(i=i[0],i.includes("%")))try{i=s.exec(decodeURIComponent(i))[0]}catch{}return i||e}class Nw{constructor(){X(this,"started",Object.create(null)),X(this,"times",[])}time(e){e in this.started&&Z(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Z(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let n=0;for(const{name:s}of this.times)n=Math.max(s.length,n);for(const{name:s,start:a,end:i}of this.times)e.push(`${s.padEnd(n)} ${i-a}ms
`);return e.join("")}}function $l(t,e){try{const{protocol:n}=e?new URL(t,e):new URL(t);return n==="http:"||n==="https:"}catch{return!1}}function ts(t){t.preventDefault()}function un(t){t.preventDefault(),t.stopPropagation()}var qc;class ey{static toDateObject(e){if(!e||typeof e!="string")return null;o(this,qc)||m(this,qc,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const n=o(this,qc).exec(e);if(!n)return null;const s=parseInt(n[1],10);let a=parseInt(n[2],10);a=a>=1&&a<=12?a-1:0;let i=parseInt(n[3],10);i=i>=1&&i<=31?i:1;let r=parseInt(n[4],10);r=r>=0&&r<=23?r:0;let l=parseInt(n[5],10);l=l>=0&&l<=59?l:0;let c=parseInt(n[6],10);c=c>=0&&c<=59?c:0;const u=n[7]||"Z";let h=parseInt(n[8],10);h=h>=0&&h<=23?h:0;let d=parseInt(n[9],10)||0;return d=d>=0&&d<=59?d:0,u==="-"?(r+=h,l+=d):u==="+"&&(r-=h,l-=d),new Date(Date.UTC(s,a,i,r,l,c))}}qc=new WeakMap,k(ey,qc);function $M(t,{scale:e=1,rotation:n=0}){const{width:s,height:a}=t.attributes.style,i=[0,0,parseInt(s),parseInt(a)];return new Qu({viewBox:i,userUnit:1,scale:e,rotation:n})}function ty(t){if(t.startsWith("#")){const e=parseInt(t.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return t.startsWith("rgb(")?t.slice(4,-1).split(",").map(e=>parseInt(e)):t.startsWith("rgba(")?t.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Z(`Not a valid color format: "${t}"`),[0,0,0])}function BM(t){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const n of t.keys()){e.style.color=n;const s=window.getComputedStyle(e).color;t.set(n,ty(s))}e.remove()}function Ee(t){const{a:e,b:n,c:s,d:a,e:i,f:r}=t.getTransform();return[e,n,s,a,i,r]}function as(t){const{a:e,b:n,c:s,d:a,e:i,f:r}=t.getTransform().invertSelf();return[e,n,s,a,i,r]}function yr(t,e,n=!1,s=!0){if(e instanceof Qu){const{pageWidth:a,pageHeight:i}=e.rawDims,{style:r}=t,l=Wt.isCSSRoundSupported,c=`var(--scale-factor) * ${a}px`,u=`var(--scale-factor) * ${i}px`,h=l?`round(down, ${c}, var(--scale-round-x, 1px))`:`calc(${c})`,d=l?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!n||e.rotation%180===0?(r.width=h,r.height=d):(r.width=d,r.height=h)}s&&t.setAttribute("data-main-rotation",e.rotation)}class ny{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Ai,Pr,Es,Eo,Bh,Xc,zm,nk,xs,Pw,Tw,Tf,sk,$m;const Uh=class Hh{constructor(e){k(this,xs),k(this,Ai,null),k(this,Pr,null),k(this,Es),k(this,Eo,null),k(this,Bh,null),m(this,Es,e),o(Hh,Xc)||m(Hh,Xc,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=m(this,Ai,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const n=o(this,Es)._uiManager._signal;e.addEventListener("contextmenu",ts,{signal:n}),e.addEventListener("pointerdown",A(Hh,zm,nk),{signal:n});const s=m(this,Eo,document.createElement("div"));s.className="buttons",e.append(s);const a=o(this,Es).toolbarPosition;if(a){const{style:i}=e,r=o(this,Es)._uiManager.direction==="ltr"?1-a[0]:a[0];i.insetInlineEnd=`${100*r}%`,i.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return A(this,xs,sk).call(this),e}get div(){return o(this,Ai)}hide(){var e;o(this,Ai).classList.add("hidden"),(e=o(this,Pr))==null||e.hideDropdown()}show(){var e;o(this,Ai).classList.remove("hidden"),(e=o(this,Bh))==null||e.shown()}async addAltText(e){const n=await e.render();A(this,xs,Tf).call(this,n),o(this,Eo).prepend(n,o(this,xs,$m)),m(this,Bh,e)}addColorPicker(e){m(this,Pr,e);const n=e.renderButton();A(this,xs,Tf).call(this,n),o(this,Eo).prepend(n,o(this,xs,$m))}remove(){var e;o(this,Ai).remove(),(e=o(this,Pr))==null||e.destroy(),m(this,Pr,null)}};Ai=new WeakMap,Pr=new WeakMap,Es=new WeakMap,Eo=new WeakMap,Bh=new WeakMap,Xc=new WeakMap,zm=new WeakSet,nk=function(t){t.stopPropagation()},xs=new WeakSet,Pw=function(t){o(this,Es)._focusEventsAllowed=!1,un(t)},Tw=function(t){o(this,Es)._focusEventsAllowed=!0,un(t)},Tf=function(t){const e=o(this,Es)._uiManager._signal;t.addEventListener("focusin",A(this,xs,Pw).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",A(this,xs,Tw).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",ts,{signal:e})},sk=function(){const{editorType:t,_uiManager:e}=o(this,Es),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",o(Uh,Xc)[t]),A(this,xs,Tf).call(this,n),n.addEventListener("click",s=>{e.delete()},{signal:e._signal}),o(this,Eo).append(n)},$m=function(){const t=document.createElement("div");return t.className="divider",t},k(Uh,zm),k(Uh,Xc,null);let UM=Uh;var Vh,Xi,Co,Yc,ak,ik,Lw;class HM{constructor(e){k(this,Yc),k(this,Vh,null),k(this,Xi,null),k(this,Co),m(this,Co,e)}show(e,n,s){const[a,i]=A(this,Yc,ik).call(this,n,s),{style:r}=o(this,Xi)||m(this,Xi,A(this,Yc,ak).call(this));e.append(o(this,Xi)),r.insetInlineEnd=`${100*a}%`,r.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){o(this,Xi).remove()}}Vh=new WeakMap,Xi=new WeakMap,Co=new WeakMap,Yc=new WeakSet,ak=function(){const t=m(this,Xi,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",ts,{signal:o(this,Co)._signal});const e=m(this,Vh,document.createElement("div"));return e.className="buttons",t.append(e),A(this,Yc,Lw).call(this),t},ik=function(t,e){let n=0,s=0;for(const a of t){const i=a.y+a.height;if(i<n)continue;const r=a.x+(e?a.width:0);if(i>n){s=r,n=i;continue}e?r>s&&(s=r):r<s&&(s=r)}return[e?1-s:s,n]},Lw=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=o(this,Co)._signal;t.addEventListener("contextmenu",ts,{signal:n}),t.addEventListener("click",()=>{o(this,Co).highlightSelection("floating_button")},{signal:n}),o(this,Vh).append(t)};function Lf(t,e,n){for(const s of n)e.addEventListener(s,t[s].bind(t))}var Bm;class VM{constructor(){k(this,Bm,0)}get id(){return`${SM}${Jt(this,Bm)._++}`}}Bm=new WeakMap;var Kc,Rf,Xe,Bl,Gh;const rk=class{constructor(){k(this,Bl),k(this,Kc,FM()),k(this,Rf,0),k(this,Xe,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',e=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),n=new Image;n.src=t;const s=n.decode().then(()=>(e.drawImage(n,0,0,1,1,0,0,1,3),new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]===0));return ee(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:n,size:s,type:a}=t;return A(this,Bl,Gh).call(this,`${e}_${n}_${s}_${a}`,t)}async getFromUrl(t){return A(this,Bl,Gh).call(this,t,t)}async getFromBlob(t,e){const n=await e;return A(this,Bl,Gh).call(this,t,n)}async getFromId(t){o(this,Xe)||m(this,Xe,new Map);const e=o(this,Xe).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){o(this,Xe)||m(this,Xe,new Map);let n=o(this,Xe).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${o(this,Kc)}_${Jt(this,Rf)._++}`,refCounter:1,isSvg:!1},o(this,Xe).set(t,n),o(this,Xe).set(n.id,n),n}getSvgUrl(t){const e=o(this,Xe).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var e;o(this,Xe)||m(this,Xe,new Map);const n=o(this,Xe).get(t);if(!n||(n.refCounter-=1,n.refCounter!==0))return;const{bitmap:s}=n;if(!n.url&&!n.file){const a=new OffscreenCanvas(s.width,s.height);a.getContext("bitmaprenderer").transferFromImageBitmap(s),n.blobPromise=a.convertToBlob()}(e=s.close)==null||e.call(s),n.bitmap=null}isValidId(t){return t.startsWith(`image_${o(this,Kc)}_`)}};Kc=new WeakMap,Rf=new WeakMap,Xe=new WeakMap,Bl=new WeakSet,Gh=async function(t,e){o(this,Xe)||m(this,Xe,new Map);let n=o(this,Xe).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${o(this,Kc)}_${Jt(this,Rf)._++}`,refCounter:0,isSvg:!1});let s;if(typeof e=="string"?(n.url=e,s=await Bp(e,"blob")):e instanceof File?s=n.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const a=rk._isSVGFittingCanvas,i=new FileReader,r=new Image,l=new Promise((c,u)=>{r.onload=()=>{n.bitmap=r,n.isSvg=!0,c()},i.onload=async()=>{const h=n.svgUrl=i.result;r.src=await a?`${h}#svgView(preserveAspectRatio(none))`:h},r.onerror=i.onerror=u});i.readAsDataURL(s),await l}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Z(s),n=null}return o(this,Xe).set(t,n),n&&o(this,Xe).set(n.id,n),n};let GM=rk;var $e,Si,qh,_e;class qM{constructor(e=128){k(this,$e,[]),k(this,Si,!1),k(this,qh),k(this,_e,-1),m(this,qh,e)}add({cmd:e,undo:n,post:s,mustExec:a,type:i=NaN,overwriteIfSameType:r=!1,keepUndo:l=!1}){if(a&&e(),o(this,Si))return;const c={cmd:e,undo:n,post:s,type:i};if(o(this,_e)===-1){o(this,$e).length>0&&(o(this,$e).length=0),m(this,_e,0),o(this,$e).push(c);return}if(r&&o(this,$e)[o(this,_e)].type===i){l&&(c.undo=o(this,$e)[o(this,_e)].undo),o(this,$e)[o(this,_e)]=c;return}const u=o(this,_e)+1;u===o(this,qh)?o(this,$e).splice(0,1):(m(this,_e,u),u<o(this,$e).length&&o(this,$e).splice(u)),o(this,$e).push(c)}undo(){if(o(this,_e)===-1)return;m(this,Si,!0);const{undo:e,post:n}=o(this,$e)[o(this,_e)];e(),n==null||n(),m(this,Si,!1),m(this,_e,o(this,_e)-1)}redo(){if(o(this,_e)<o(this,$e).length-1){m(this,_e,o(this,_e)+1),m(this,Si,!0);const{cmd:e,post:n}=o(this,$e)[o(this,_e)];e(),n==null||n(),m(this,Si,!1)}}hasSomethingToUndo(){return o(this,_e)!==-1}hasSomethingToRedo(){return o(this,_e)<o(this,$e).length-1}cleanType(e){if(o(this,_e)!==-1){for(let n=o(this,_e);n>=0;n--)if(o(this,$e)[n].type!==e){o(this,$e).splice(n+1,o(this,_e)-n),m(this,_e,n);return}o(this,$e).length=0,m(this,_e,-1)}}destroy(){m(this,$e,null)}}$e=new WeakMap,Si=new WeakMap,qh=new WeakMap,_e=new WeakMap;var Um,ok;class Ju{constructor(e){k(this,Um),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:n}=Wt.platform;for(const[s,a,i={}]of e)for(const r of s){const l=r.startsWith("mac+");n&&l?(this.callbacks.set(r.slice(4),{callback:a,options:i}),this.allKeys.add(r.split("+").at(-1))):!n&&!l&&(this.callbacks.set(r,{callback:a,options:i}),this.allKeys.add(r.split("+").at(-1)))}}exec(e,n){if(!this.allKeys.has(n.key))return;const s=this.callbacks.get(A(this,Um,ok).call(this,n));if(!s)return;const{callback:a,options:{bubbles:i=!1,args:r=[],checker:l=null}}=s;l&&!l(e,n)||(a.bind(e,...r,n)(),i||un(n))}}Um=new WeakSet,ok=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const lk=class ck{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return BM(e),ee(this,"_colors",e)}convert(e){const n=ty(e);if(!window.matchMedia("(forced-colors: active)").matches)return n;for(const[s,a]of this._colors)if(a.every((i,r)=>i===n[r]))return ck._colorsMapping.get(s);return n}getHexCode(e){const n=this._colors.get(e);return n?$.makeHexColor(...n):e}};X(lk,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let XM=lk;var Ul,bn,Ze,kt,Hl,pa,Tr,$n,_i,Lr,Vl,Rr,Ts,rs,Ir,If,Xh,Gl,Yh,Ls,Ei,ql,Yi,gs,Hm,Ki,Kh,Ci,Dr,Qh,Jh,dt,be,ga,jr,Xl,Zh,Mi,Rs,ma,ed,Bn,H,td,Vm,Rw,Iw,Df,uk,hk,dk,Gm,fk,qm,Xm,pk,It,Hs,gk,mk,Ym,vk,Yl,Km;const Qm=class Jm{constructor(e,n,s,a,i,r,l,c,u,h,d,f,g){k(this,H),k(this,Ul,new AbortController),k(this,bn,null),k(this,Ze,new Map),k(this,kt,new Map),k(this,Hl,null),k(this,pa,null),k(this,Tr,null),k(this,$n,new qM),k(this,_i,null),k(this,Lr,null),k(this,Vl,0),k(this,Rr,new Set),k(this,Ts,null),k(this,rs,null),k(this,Ir,new Set),X(this,"_editorUndoBar",null),k(this,If,!1),k(this,Xh,!1),k(this,Gl,!1),k(this,Yh,null),k(this,Ls,null),k(this,Ei,null),k(this,ql,null),k(this,Yi,!1),k(this,gs,null),k(this,Hm,new VM),k(this,Ki,!1),k(this,Kh,!1),k(this,Ci,null),k(this,Dr,null),k(this,Qh,null),k(this,Jh,null),k(this,dt,J.NONE),k(this,be,new Set),k(this,ga,null),k(this,jr,null),k(this,Xl,null),k(this,Zh,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1}),k(this,Mi,[0,0]),k(this,Rs,null),k(this,ma,null),k(this,ed,null),k(this,Bn,null);const v=this._signal=o(this,Ul).signal;m(this,ma,e),m(this,ed,n),m(this,Hl,s),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:v}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:v}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:v}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:v}),a._on("setpreference",this.onSetPreference.bind(this),{signal:v}),a._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:v}),A(this,H,uk).call(this),A(this,H,pk).call(this),A(this,H,Gm).call(this),m(this,pa,i.annotationStorage),m(this,Yh,i.filterFactory),m(this,jr,r),m(this,ql,l||null),m(this,If,c),m(this,Xh,u),m(this,Gl,h),m(this,Jh,d||null),this.viewParameters={realScale:fl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=f||null,this._supportsPinchToZoom=g!==!1}static get _keyboardManager(){const e=Jm.prototype,n=r=>o(r,ma).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&r.hasSomethingToControl(),s=(r,{target:l})=>{if(l instanceof HTMLInputElement){const{type:c}=l;return c!=="text"&&c!=="number"}return!0},a=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return ee(this,"_keyboardManager",new Ju([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],e.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:s}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(r,{target:l})=>!(l instanceof HTMLButtonElement)&&o(r,ma).contains(l)&&!r.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(r,{target:l})=>!(l instanceof HTMLButtonElement)&&o(r,ma).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-a,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[a,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-a],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:n}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,a],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:n}]]))}destroy(){var e,n,s,a,i;(e=o(this,Bn))==null||e.resolve(),m(this,Bn,null),(n=o(this,Ul))==null||n.abort(),m(this,Ul,null),this._signal=null;for(const r of o(this,kt).values())r.destroy();o(this,kt).clear(),o(this,Ze).clear(),o(this,Ir).clear(),m(this,bn,null),o(this,be).clear(),o(this,$n).destroy(),(s=o(this,Hl))==null||s.destroy(),(a=o(this,gs))==null||a.hide(),m(this,gs,null),o(this,Ls)&&(clearTimeout(o(this,Ls)),m(this,Ls,null)),o(this,Rs)&&(clearTimeout(o(this,Rs)),m(this,Rs,null)),(i=this._editorUndoBar)==null||i.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return o(this,Jh)}get useNewAltTextFlow(){return o(this,Xh)}get useNewAltTextWhenAddingImage(){return o(this,Gl)}get hcmFilter(){return ee(this,"hcmFilter",o(this,jr)?o(this,Yh).addHCMFilter(o(this,jr).foreground,o(this,jr).background):"none")}get direction(){return ee(this,"direction",getComputedStyle(o(this,ma)).direction)}get highlightColors(){return ee(this,"highlightColors",o(this,ql)?new Map(o(this,ql).split(",").map(e=>e.split("=").map(n=>n.trim()))):null)}get highlightColorNames(){return ee(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),m(this,Lr,e)}setMainHighlightColorPicker(e){m(this,Qh,e)}editAltText(e,n=!1){var s;(s=o(this,Hl))==null||s.editAltText(this,e,n)}switchToMode(e,n){this._eventBus.on("annotationeditormodechanged",n,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,n){this._eventBus.dispatch("setpreference",{source:this,name:e,value:n})}onSetPreference({name:e,value:n}){switch(e){case"enableNewAltTextWhenAddingImage":m(this,Gl,n);break}}onPageChanging({pageNumber:e}){m(this,Vl,e-1)}focusMainContainer(){o(this,ma).focus()}findParent(e,n){for(const s of o(this,kt).values()){const{x:a,y:i,width:r,height:l}=s.div.getBoundingClientRect();if(e>=a&&e<=a+r&&n>=i&&n<=i+l)return s}return null}disableUserSelect(e=!1){o(this,ed).classList.toggle("noUserSelect",e)}addShouldRescale(e){o(this,Ir).add(e)}removeShouldRescale(e){o(this,Ir).delete(e)}onScaleChanging({scale:e}){var n;this.commitOrRemove(),this.viewParameters.realScale=e*fl.PDF_TO_CSS_UNITS;for(const s of o(this,Ir))s.onScaleChanging();(n=o(this,Lr))==null||n.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:a,focusNode:i,focusOffset:r}=n,l=n.toString(),c=A(this,H,td).call(this,n).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;n.empty();const h=A(this,H,Vm).call(this,c),d=o(this,dt)===J.NONE,f=()=>{h==null||h.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:s,anchorOffset:a,focusNode:i,focusOffset:r,text:l}),d&&this.showAllEditors("highlight",!0,!0)};if(d){this.switchToMode(J.HIGHLIGHT,f);return}f()}addToAnnotationStorage(e){!e.isEmpty()&&o(this,pa)&&!o(this,pa).has(e.id)&&o(this,pa).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,o(this,Yi)&&(m(this,Yi,!1),A(this,H,Df).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const n of o(this,be))if(n.div.contains(e)){m(this,Dr,[n,e]),n._focusEventsAllowed=!1;break}}focus(){if(!o(this,Dr))return;const[e,n]=o(this,Dr);m(this,Dr,null),n.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),n.focus()}addEditListeners(){A(this,H,Gm).call(this),A(this,H,qm).call(this)}removeEditListeners(){A(this,H,fk).call(this),A(this,H,Xm).call(this)}dragOver(e){for(const{type:n}of e.dataTransfer.items)for(const s of o(this,rs))if(s.isHandlingMimeForPasting(n)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const n of e.dataTransfer.items)for(const s of o(this,rs))if(s.isHandlingMimeForPasting(n.type)){s.paste(n,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=o(this,bn))==null||n.commitOrRemove(),!this.hasSelection)return;const s=[];for(const a of o(this,be)){const i=a.serialize(!0);i&&s.push(i)}s.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(s))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:n}=e;for(const i of n.items)for(const r of o(this,rs))if(r.isHandlingMimeForPasting(i.type)){r.paste(i,this.currentLayer);return}let s=n.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(i){Z(`paste: "${i.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const a=this.currentLayer;try{const i=[];for(const c of s){const u=await a.deserialize(c);if(!u)return;i.push(u)}const r=()=>{for(const c of i)A(this,H,Ym).call(this,c);A(this,H,Km).call(this,i)},l=()=>{for(const c of i)c.remove()};this.addCommands({cmd:r,undo:l,mustExec:!0})}catch(i){Z(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),o(this,dt)!==J.NONE&&!this.isEditorHandlingKeyboard&&Jm._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,o(this,Yi)&&(m(this,Yi,!1),A(this,H,Df).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(A(this,H,hk).call(this),A(this,H,qm).call(this),A(this,H,It).call(this,{isEditing:o(this,dt)!==J.NONE,isEmpty:A(this,H,Yl).call(this),hasSomethingToUndo:o(this,$n).hasSomethingToUndo(),hasSomethingToRedo:o(this,$n).hasSomethingToRedo(),hasSelectedEditor:!1})):(A(this,H,dk).call(this),A(this,H,Xm).call(this),A(this,H,It).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!o(this,rs)){m(this,rs,e);for(const n of o(this,rs))A(this,H,Hs).call(this,n.defaultPropertiesToUpdate)}}getId(){return o(this,Hm).id}get currentLayer(){return o(this,kt).get(o(this,Vl))}getLayer(e){return o(this,kt).get(e)}get currentPageIndex(){return o(this,Vl)}addLayer(e){o(this,kt).set(e.pageIndex,e),o(this,Ki)?e.enable():e.disable()}removeLayer(e){o(this,kt).delete(e.pageIndex)}async updateMode(e,n=null,s=!1){var a;if(o(this,dt)!==e&&!(o(this,Bn)&&(await o(this,Bn).promise,!o(this,Bn)))){if(m(this,Bn,Promise.withResolvers()),m(this,dt,e),e===J.NONE){this.setEditingState(!1),A(this,H,mk).call(this),(a=this._editorUndoBar)==null||a.hide(),o(this,Bn).resolve();return}this.setEditingState(!0),await A(this,H,gk).call(this),this.unselectAll();for(const i of o(this,kt).values())i.updateMode(e);if(!n){s&&this.addNewEditorFromKeyboard(),o(this,Bn).resolve();return}for(const i of o(this,Ze).values())i.annotationElementId===n?(this.setSelected(i),i.enterInEditMode()):i.unselect();o(this,Bn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==o(this,dt)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,n){var s;if(o(this,rs)){switch(e){case ae.CREATE:this.currentLayer.addNewEditor();return;case ae.HIGHLIGHT_DEFAULT_COLOR:(s=o(this,Qh))==null||s.updateColor(n);break;case ae.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(o(this,Xl)||m(this,Xl,new Map)).set(e,n),this.showAllEditors("highlight",n);break}for(const a of o(this,be))a.updateParams(e,n);for(const a of o(this,rs))a.updateDefaultParams(e,n)}}showAllEditors(e,n,s=!1){var a;for(const i of o(this,Ze).values())i.editorType===e&&i.show(n);(((a=o(this,Xl))==null?void 0:a.get(ae.HIGHLIGHT_SHOW_ALL))??!0)!==n&&A(this,H,Hs).call(this,[[ae.HIGHLIGHT_SHOW_ALL,n]])}enableWaiting(e=!1){if(o(this,Kh)!==e){m(this,Kh,e);for(const n of o(this,kt).values())e?n.disableClick():n.enableClick(),n.div.classList.toggle("waiting",e)}}getEditors(e){const n=[];for(const s of o(this,Ze).values())s.pageIndex===e&&n.push(s);return n}getEditor(e){return o(this,Ze).get(e)}addEditor(e){o(this,Ze).set(e.id,e)}removeEditor(e){var n;e.div.contains(document.activeElement)&&(o(this,Ls)&&clearTimeout(o(this,Ls)),m(this,Ls,setTimeout(()=>{this.focusMainContainer(),m(this,Ls,null)},0))),o(this,Ze).delete(e.id),this.unselect(e),(!e.annotationElementId||!o(this,Rr).has(e.annotationElementId))&&((n=o(this,pa))==null||n.remove(e.id))}addDeletedAnnotationElement(e){o(this,Rr).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return o(this,Rr).has(e)}removeDeletedAnnotationElement(e){o(this,Rr).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){o(this,bn)!==e&&(m(this,bn,e),e&&A(this,H,Hs).call(this,e.propertiesToUpdate))}updateUI(e){o(this,H,vk)===e&&A(this,H,Hs).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){A(this,H,Hs).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(o(this,be).has(e)){o(this,be).delete(e),e.unselect(),A(this,H,It).call(this,{hasSelectedEditor:this.hasSelection});return}o(this,be).add(e),e.select(),A(this,H,Hs).call(this,e.propertiesToUpdate),A(this,H,It).call(this,{hasSelectedEditor:!0})}setSelected(e){var n;(n=o(this,Lr))==null||n.commitOrRemove();for(const s of o(this,be))s!==e&&s.unselect();o(this,be).clear(),o(this,be).add(e),e.select(),A(this,H,Hs).call(this,e.propertiesToUpdate),A(this,H,It).call(this,{hasSelectedEditor:!0})}isSelected(e){return o(this,be).has(e)}get firstSelectedEditor(){return o(this,be).values().next().value}unselect(e){e.unselect(),o(this,be).delete(e),A(this,H,It).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return o(this,be).size!==0}get isEnterHandled(){return o(this,be).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;o(this,$n).undo(),A(this,H,It).call(this,{hasSomethingToUndo:o(this,$n).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:A(this,H,Yl).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){o(this,$n).redo(),A(this,H,It).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:o(this,$n).hasSomethingToRedo(),isEmpty:A(this,H,Yl).call(this)})}addCommands(e){o(this,$n).add(e),A(this,H,It).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:A(this,H,Yl).call(this)})}cleanUndoStack(e){o(this,$n).cleanType(e)}delete(){var e;this.commitOrRemove();const n=(e=this.currentLayer)==null?void 0:e.endDrawingSession(!0);if(!this.hasSelection&&!n)return;const s=n?[n]:[...o(this,be)],a=()=>{var r;(r=this._editorUndoBar)==null||r.show(i,s.length===1?s[0].editorType:s.length);for(const l of s)l.remove()},i=()=>{for(const r of s)A(this,H,Ym).call(this,r)};this.addCommands({cmd:a,undo:i,mustExec:!0})}commitOrRemove(){var e;(e=o(this,bn))==null||e.commitOrRemove()}hasSomethingToControl(){return o(this,bn)||this.hasSelection}selectAll(){for(const e of o(this,be))e.commit();A(this,H,Km).call(this,o(this,Ze).values())}unselectAll(){var e;if(!(o(this,bn)&&(o(this,bn).commitOrRemove(),o(this,dt)!==J.NONE))&&!((e=o(this,Lr))!=null&&e.commitOrRemove())&&this.hasSelection){for(const n of o(this,be))n.unselect();o(this,be).clear(),A(this,H,It).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,n,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;o(this,Mi)[0]+=e,o(this,Mi)[1]+=n;const[a,i]=o(this,Mi),r=[...o(this,be)];o(this,Rs)&&clearTimeout(o(this,Rs)),m(this,Rs,setTimeout(()=>{m(this,Rs,null),o(this,Mi)[0]=o(this,Mi)[1]=0,this.addCommands({cmd:()=>{for(const l of r)o(this,Ze).has(l.id)&&l.translateInPage(a,i)},undo:()=>{for(const l of r)o(this,Ze).has(l.id)&&l.translateInPage(-a,-i)},mustExec:!1})},1e3));for(const l of r)l.translateInPage(e,n)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),m(this,Ts,new Map);for(const e of o(this,be))o(this,Ts).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!o(this,Ts))return!1;this.disableUserSelect(!1);const e=o(this,Ts);m(this,Ts,null);let n=!1;for(const[{x:a,y:i,pageIndex:r},l]of e)l.newX=a,l.newY=i,l.newPageIndex=r,n||(n=a!==l.savedX||i!==l.savedY||r!==l.savedPageIndex);if(!n)return!1;const s=(a,i,r,l)=>{if(o(this,Ze).has(a.id)){const c=o(this,kt).get(l);c?a._setParentAndPosition(c,i,r):(a.pageIndex=l,a.x=i,a.y=r)}};return this.addCommands({cmd:()=>{for(const[a,{newX:i,newY:r,newPageIndex:l}]of e)s(a,i,r,l)},undo:()=>{for(const[a,{savedX:i,savedY:r,savedPageIndex:l}]of e)s(a,i,r,l)},mustExec:!0}),!0}dragSelectedEditors(e,n){if(o(this,Ts))for(const s of o(this,Ts).keys())s.drag(e,n)}rebuild(e){if(e.parent===null){const n=this.getLayer(e.pageIndex);n?(n.changeParent(e),n.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||o(this,be).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return o(this,bn)===e}getActive(){return o(this,bn)}getMode(){return o(this,dt)}get imageManager(){return ee(this,"imageManager",new GM)}getSelectionBoxes(e){if(!e)return null;const n=document.getSelection();for(let u=0,h=n.rangeCount;u<h;u++)if(!e.contains(n.getRangeAt(u).commonAncestorContainer))return null;const{x:s,y:a,width:i,height:r}=e.getBoundingClientRect();let l;switch(e.getAttribute("data-main-rotation")){case"90":l=(u,h,d,f)=>({x:(h-a)/r,y:1-(u+d-s)/i,width:f/r,height:d/i});break;case"180":l=(u,h,d,f)=>({x:1-(u+d-s)/i,y:1-(h+f-a)/r,width:d/i,height:f/r});break;case"270":l=(u,h,d,f)=>({x:1-(h+f-a)/r,y:(u-s)/i,width:f/r,height:d/i});break;default:l=(u,h,d,f)=>({x:(u-s)/i,y:(h-a)/r,width:d/i,height:f/r});break}const c=[];for(let u=0,h=n.rangeCount;u<h;u++){const d=n.getRangeAt(u);if(!d.collapsed)for(const{x:f,y:g,width:v,height:y}of d.getClientRects())v===0||y===0||c.push(l(f,g,v,y))}return c.length===0?null:c}addChangedExistingAnnotation({annotationElementId:e,id:n}){(o(this,Tr)||m(this,Tr,new Map)).set(e,n)}removeChangedExistingAnnotation({annotationElementId:e}){var n;(n=o(this,Tr))==null||n.delete(e)}renderAnnotationElement(e){var n;const s=(n=o(this,Tr))==null?void 0:n.get(e.data.id);if(!s)return;const a=o(this,pa).getRawValue(s);a&&(o(this,dt)===J.NONE&&!a.hasBeenModified||a.renderAnnotationElement(e))}};Ul=new WeakMap,bn=new WeakMap,Ze=new WeakMap,kt=new WeakMap,Hl=new WeakMap,pa=new WeakMap,Tr=new WeakMap,$n=new WeakMap,_i=new WeakMap,Lr=new WeakMap,Vl=new WeakMap,Rr=new WeakMap,Ts=new WeakMap,rs=new WeakMap,Ir=new WeakMap,If=new WeakMap,Xh=new WeakMap,Gl=new WeakMap,Yh=new WeakMap,Ls=new WeakMap,Ei=new WeakMap,ql=new WeakMap,Yi=new WeakMap,gs=new WeakMap,Hm=new WeakMap,Ki=new WeakMap,Kh=new WeakMap,Ci=new WeakMap,Dr=new WeakMap,Qh=new WeakMap,Jh=new WeakMap,dt=new WeakMap,be=new WeakMap,ga=new WeakMap,jr=new WeakMap,Xl=new WeakMap,Zh=new WeakMap,Mi=new WeakMap,Rs=new WeakMap,ma=new WeakMap,ed=new WeakMap,Bn=new WeakMap,H=new WeakSet,td=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},Vm=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of o(this,kt).values())if(n.hasTextLayer(t))return n;return null},Rw=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const e=A(this,H,td).call(this,t).closest(".textLayer"),n=this.getSelectionBoxes(e);n&&(o(this,gs)||m(this,gs,new HM(this)),o(this,gs).show(e,n,this.direction==="ltr"))},Iw=function(){var t,e,n;const s=document.getSelection();if(!s||s.isCollapsed){o(this,ga)&&((t=o(this,gs))==null||t.hide(),m(this,ga,null),A(this,H,It).call(this,{hasSelectedText:!1}));return}const{anchorNode:a}=s;if(a===o(this,ga))return;const i=A(this,H,td).call(this,s).closest(".textLayer");if(!i){o(this,ga)&&((e=o(this,gs))==null||e.hide(),m(this,ga,null),A(this,H,It).call(this,{hasSelectedText:!1}));return}if((n=o(this,gs))==null||n.hide(),m(this,ga,a),A(this,H,It).call(this,{hasSelectedText:!0}),!(o(this,dt)!==J.HIGHLIGHT&&o(this,dt)!==J.NONE)&&(o(this,dt)===J.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),m(this,Yi,this.isShiftKeyDown),!this.isShiftKeyDown)){const r=o(this,dt)===J.HIGHLIGHT?A(this,H,Vm).call(this,i):null;r==null||r.toggleDrawing();const l=new AbortController,c=this.combinedSignal(l),u=h=>{h.type==="pointerup"&&h.button!==0||(l.abort(),r==null||r.toggleDrawing(!0),h.type==="pointerup"&&A(this,H,Df).call(this,"main_toolbar"))};window.addEventListener("pointerup",u,{signal:c}),window.addEventListener("blur",u,{signal:c})}},Df=function(t=""){o(this,dt)===J.HIGHLIGHT?this.highlightSelection(t):o(this,If)&&A(this,H,Rw).call(this)},uk=function(){document.addEventListener("selectionchange",A(this,H,Iw).bind(this),{signal:this._signal})},hk=function(){if(o(this,Ei))return;m(this,Ei,new AbortController);const t=this.combinedSignal(o(this,Ei));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},dk=function(){var t;(t=o(this,Ei))==null||t.abort(),m(this,Ei,null)},Gm=function(){if(o(this,Ci))return;m(this,Ci,new AbortController);const t=this.combinedSignal(o(this,Ci));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},fk=function(){var t;(t=o(this,Ci))==null||t.abort(),m(this,Ci,null)},qm=function(){if(o(this,_i))return;m(this,_i,new AbortController);const t=this.combinedSignal(o(this,_i));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},Xm=function(){var t;(t=o(this,_i))==null||t.abort(),m(this,_i,null)},pk=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},It=function(t){Object.entries(t).some(([e,n])=>o(this,Zh)[e]!==n)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(o(this,Zh),t)}),o(this,dt)===J.HIGHLIGHT&&t.hasSelectedEditor===!1&&A(this,H,Hs).call(this,[[ae.HIGHLIGHT_FREE,!0]]))},Hs=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},gk=async function(){if(!o(this,Ki)){m(this,Ki,!0);const t=[];for(const e of o(this,kt).values())t.push(e.enable());await Promise.all(t);for(const e of o(this,Ze).values())e.enable()}},mk=function(){if(this.unselectAll(),o(this,Ki)){m(this,Ki,!1);for(const t of o(this,kt).values())t.disable();for(const t of o(this,Ze).values())t.disable()}},Ym=function(t){const e=o(this,kt).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},vk=function(){let t=null;for(t of o(this,be));return t},Yl=function(){if(o(this,Ze).size===0)return!0;if(o(this,Ze).size===1)for(const t of o(this,Ze).values())return t.isEmpty();return!1},Km=function(t){for(const e of o(this,be))e.unselect();o(this,be).clear();for(const e of t)e.isEmpty()||(o(this,be).add(e),e.select());A(this,H,It).call(this,{hasSelectedEditor:this.hasSelection})},X(Qm,"TRANSLATE_SMALL",1),X(Qm,"TRANSLATE_BIG",10);let Uu=Qm;var ft,Ys,us,Qc,Vs,En,Kl,Is,ln,va,Fr,Gs,Qa,Ks,Jc,nd;const Ql=class ba{constructor(e){k(this,Ks),k(this,ft,null),k(this,Ys,!1),k(this,us,null),k(this,Qc,null),k(this,Vs,null),k(this,En,null),k(this,Kl,!1),k(this,Is,null),k(this,ln,null),k(this,va,null),k(this,Fr,null),k(this,Gs,!1),m(this,ln,e),m(this,Gs,e._uiManager.useNewAltTextFlow),o(ba,Qa)||m(ba,Qa,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){ba._l10n??(ba._l10n=e)}async render(){const e=m(this,us,document.createElement("button"));e.className="altText",e.tabIndex="0";const n=m(this,Qc,document.createElement("span"));e.append(n),o(this,Gs)?(e.classList.add("new"),e.setAttribute("data-l10n-id",o(ba,Qa).missing),n.setAttribute("data-l10n-id",o(ba,Qa)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),n.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=o(this,ln)._uiManager._signal;e.addEventListener("contextmenu",ts,{signal:s}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:s});const a=i=>{i.preventDefault(),o(this,ln)._uiManager.editAltText(o(this,ln)),o(this,Gs)&&o(this,ln)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:o(this,Ks,Jc)}})};return e.addEventListener("click",a,{capture:!0,signal:s}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(m(this,Kl,!0),a(i))},{signal:s}),await A(this,Ks,nd).call(this),e}finish(){o(this,us)&&(o(this,us).focus({focusVisible:o(this,Kl)}),m(this,Kl,!1))}isEmpty(){return o(this,Gs)?o(this,ft)===null:!o(this,ft)&&!o(this,Ys)}hasData(){return o(this,Gs)?o(this,ft)!==null||!!o(this,va):this.isEmpty()}get guessedText(){return o(this,va)}async setGuessedText(e){o(this,ft)===null&&(m(this,va,e),m(this,Fr,await ba._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),A(this,Ks,nd).call(this))}toggleAltTextBadge(e=!1){var n;if(!o(this,Gs)||o(this,ft)){(n=o(this,Is))==null||n.remove(),m(this,Is,null);return}if(!o(this,Is)){const s=m(this,Is,document.createElement("div"));s.className="noAltTextBadge",o(this,ln).div.append(s)}o(this,Is).classList.toggle("hidden",!e)}serialize(e){let n=o(this,ft);return!e&&o(this,va)===n&&(n=o(this,Fr)),{altText:n,decorative:o(this,Ys),guessedText:o(this,va),textWithDisclaimer:o(this,Fr)}}get data(){return{altText:o(this,ft),decorative:o(this,Ys)}}set data({altText:e,decorative:n,guessedText:s,textWithDisclaimer:a,cancel:i=!1}){s&&(m(this,va,s),m(this,Fr,a)),!(o(this,ft)===e&&o(this,Ys)===n)&&(i||(m(this,ft,e),m(this,Ys,n)),A(this,Ks,nd).call(this))}toggle(e=!1){o(this,us)&&(!e&&o(this,En)&&(clearTimeout(o(this,En)),m(this,En,null)),o(this,us).disabled=!e)}shown(){o(this,ln)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:o(this,Ks,Jc)}})}destroy(){var e,n;(e=o(this,us))==null||e.remove(),m(this,us,null),m(this,Qc,null),m(this,Vs,null),(n=o(this,Is))==null||n.remove(),m(this,Is,null)}};ft=new WeakMap,Ys=new WeakMap,us=new WeakMap,Qc=new WeakMap,Vs=new WeakMap,En=new WeakMap,Kl=new WeakMap,Is=new WeakMap,ln=new WeakMap,va=new WeakMap,Fr=new WeakMap,Gs=new WeakMap,Qa=new WeakMap,Ks=new WeakSet,Jc=function(){return o(this,ft)&&"added"||o(this,ft)===null&&this.guessedText&&"review"||"missing"},nd=async function(){var t,e,n;const s=o(this,us);if(!s)return;if(o(this,Gs)){if(s.classList.toggle("done",!!o(this,ft)),s.setAttribute("data-l10n-id",o(Ql,Qa)[o(this,Ks,Jc)]),(t=o(this,Qc))==null||t.setAttribute("data-l10n-id",o(Ql,Qa)[`${o(this,Ks,Jc)}-label`]),!o(this,ft)){(e=o(this,Vs))==null||e.remove();return}}else{if(!o(this,ft)&&!o(this,Ys)){s.classList.remove("done"),(n=o(this,Vs))==null||n.remove();return}s.classList.add("done"),s.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let a=o(this,Vs);if(!a){m(this,Vs,a=document.createElement("span")),a.className="tooltip",a.setAttribute("role","tooltip"),a.id=`alt-text-tooltip-${o(this,ln).id}`;const r=100,l=o(this,ln)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(o(this,En)),m(this,En,null)},{once:!0}),s.addEventListener("mouseenter",()=>{m(this,En,setTimeout(()=>{m(this,En,null),o(this,Vs).classList.add("show"),o(this,ln)._reportTelemetry({action:"alt_text_tooltip"})},r))},{signal:l}),s.addEventListener("mouseleave",()=>{var c;o(this,En)&&(clearTimeout(o(this,En)),m(this,En,null)),(c=o(this,Vs))==null||c.classList.remove("show")},{signal:l})}o(this,Ys)?a.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(a.removeAttribute("data-l10n-id"),a.textContent=o(this,ft)),a.parentNode||s.append(a);const i=o(this,ln).getImageForAltText();i==null||i.setAttribute("aria-describedby",a.id)},k(Ql,Qa,null),X(Ql,"_l10n",null);let Dw=Ql;var jf,Or,Ff,Of,Wf,zf,$f,Zc,ya,Wr,Ni,Mo,bk,jw,_g;const yk=class{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:a=null,onPinchEnd:i=null,signal:r}){k(this,Mo),k(this,jf),k(this,Or,!1),k(this,Ff,null),k(this,Of),k(this,Wf),k(this,zf),k(this,$f),k(this,Zc),k(this,ya,null),k(this,Wr),k(this,Ni,null),m(this,jf,t),m(this,Ff,n),m(this,Of,e),m(this,Wf,s),m(this,zf,a),m(this,$f,i),m(this,Wr,new AbortController),m(this,Zc,AbortSignal.any([r,o(this,Wr).signal])),t.addEventListener("touchstart",A(this,Mo,bk).bind(this),{passive:!1,signal:o(this,Zc)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ee(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var t;(t=o(this,Wr))==null||t.abort(),m(this,Wr,null)}};jf=new WeakMap,Or=new WeakMap,Ff=new WeakMap,Of=new WeakMap,Wf=new WeakMap,zf=new WeakMap,$f=new WeakMap,Zc=new WeakMap,ya=new WeakMap,Wr=new WeakMap,Ni=new WeakMap,Mo=new WeakSet,bk=function(t){var e,n,s;if((e=o(this,Of))!=null&&e.call(this)||t.touches.length<2)return;if(!o(this,Ni)){m(this,Ni,new AbortController);const r=AbortSignal.any([o(this,Zc),o(this,Ni).signal]),l=o(this,jf),c={signal:r,passive:!1};l.addEventListener("touchmove",A(this,Mo,jw).bind(this),c),l.addEventListener("touchend",A(this,Mo,_g).bind(this),c),l.addEventListener("touchcancel",A(this,Mo,_g).bind(this),c),(n=o(this,Wf))==null||n.call(this)}if(un(t),t.touches.length!==2||(s=o(this,Ff))!=null&&s.call(this)){m(this,ya,null);return}let[a,i]=t.touches;a.identifier>i.identifier&&([a,i]=[i,a]),m(this,ya,{touch0X:a.screenX,touch0Y:a.screenY,touch1X:i.screenX,touch1Y:i.screenY})},jw=function(t){var e;if(!o(this,ya)||t.touches.length!==2)return;let[n,s]=t.touches;n.identifier>s.identifier&&([n,s]=[s,n]);const{screenX:a,screenY:i}=n,{screenX:r,screenY:l}=s,c=o(this,ya),{touch0X:u,touch0Y:h,touch1X:d,touch1Y:f}=c,g=d-u,v=f-h,y=r-a,S=l-i,b=Math.hypot(y,S)||1,x=Math.hypot(g,v)||1;if(!o(this,Or)&&Math.abs(x-b)<=yk.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=a,c.touch0Y=i,c.touch1X=r,c.touch1Y=l,t.preventDefault(),!o(this,Or)){m(this,Or,!0);return}const w=[(a+r)/2,(i+l)/2];(e=o(this,zf))==null||e.call(this,w,x,b)},_g=function(t){var e;o(this,Ni).abort(),m(this,Ni,null),(e=o(this,$f))==null||e.call(this),o(this,ya)&&(t.preventDefault(),m(this,ya,null),m(this,Or,!1))};let wk=yk;var zr,ms,Ce,Jl,Pi,sd,$r,_t,Br,Ta,sr,Bf,No,At,ad,Ur,Ja,Ds,Zl,ec,yn,Qi,id,Zm,oe,ev,Uf,tv,yh,xk,Fw,Eg,wh,nv,kk,Ak,Sk,sv,_k,av,Ek,Ck,Mk,iv,eu;const Fe=class at{constructor(e){k(this,oe),k(this,zr,null),k(this,ms,null),k(this,Ce,null),k(this,Jl,!1),k(this,Pi,null),k(this,sd,""),k(this,$r,!1),k(this,_t,null),k(this,Br,null),k(this,Ta,null),k(this,sr,null),k(this,Bf,""),k(this,No,!1),k(this,At,null),k(this,ad,!1),k(this,Ur,!1),k(this,Ja,!1),k(this,Ds,null),k(this,Zl,0),k(this,ec,0),k(this,yn,null),k(this,Qi,null),X(this,"_editToolbar",null),X(this,"_initialOptions",Object.create(null)),X(this,"_initialData",null),X(this,"_isVisible",!0),X(this,"_uiManager",null),X(this,"_focusEventsAllowed",!0),k(this,id,!1),k(this,Zm,at._zIndex++),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:n,rawDims:{pageWidth:s,pageHeight:a,pageX:i,pageY:r}}=this.parent.viewport;this.rotation=n,this.pageRotation=(360+n-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,a],this.pageTranslation=[i,r];const[l,c]=this.parentDimensions;this.x=e.x/l,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=at.prototype._resizeWithKeyboard,n=Uu.TRANSLATE_SMALL,s=Uu.TRANSLATE_BIG;return ee(this,"_resizerKeyboardManager",new Ju([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-n,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[n,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-n]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,n]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,s]}],[["Escape","mac+Escape"],at.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ee(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const n=new YM({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});n.annotationElementId=e.annotationElementId,n.deleted=!0,n._uiManager.addToAnnotationStorage(n)}static initialize(e,n){if(at._l10n??(at._l10n=e),at._l10nResizer||(at._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),at._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);at._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,n){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,n){ye("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return o(this,id)}set _isDraggable(e){var n;m(this,id,e),(n=this.div)==null||n.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,n]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*n/(e*2),this.y+=this.width*e/(n*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*n/(e*2),this.y-=this.width*e/(n*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=o(this,Zm)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):A(this,oe,eu).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(o(this,No)?m(this,No,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const s=e.relatedTarget;s!=null&&s.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,n,s,a){const[i,r]=this.parentDimensions;[s,a]=this.screenToPageTranslation(s,a),this.x=(e+s)/i,this.y=(n+a)/r,this.fixAndSetPosition()}translate(e,n){A(this,oe,ev).call(this,this.parentDimensions,e,n)}translateInPage(e,n){o(this,At)||m(this,At,[this.x,this.y,this.width,this.height]),A(this,oe,ev).call(this,this.pageDimensions,e,n),this.div.scrollIntoView({block:"nearest"})}drag(e,n){o(this,At)||m(this,At,[this.x,this.y,this.width,this.height]);const{div:s,parentDimensions:[a,i]}=this;if(this.x+=e/a,this.y+=n/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:d,y:f}=this.div.getBoundingClientRect();this.parent.findNewParent(this,d,f)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:l}=this;const[c,u]=this.getBaseTranslation();r+=c,l+=u;const{style:h}=s;h.left=`${(100*r).toFixed(2)}%`,h.top=`${(100*l).toFixed(2)}%`,this._onTranslating(r,l),s.scrollIntoView({block:"nearest"})}_onTranslating(e,n){}_onTranslated(e,n){}get _hasBeenMoved(){return!!o(this,At)&&(o(this,At)[0]!==this.x||o(this,At)[1]!==this.y)}get _hasBeenResized(){return!!o(this,At)&&(o(this,At)[2]!==this.width||o(this,At)[3]!==this.height)}getBaseTranslation(){const[e,n]=this.parentDimensions,{_borderLineWidth:s}=at,a=s/e,i=s/n;switch(this.rotation){case 90:return[-a,i];case 180:return[a,i];case 270:return[a,-i];default:return[-a,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:n},pageDimensions:[s,a]}=this;let{x:i,y:r,width:l,height:c}=this;if(l*=s,c*=a,i*=s,r*=a,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(s-l,i)),r=Math.max(0,Math.min(a-c,r));break;case 90:i=Math.max(0,Math.min(s-c,i)),r=Math.min(a,Math.max(l,r));break;case 180:i=Math.min(s,Math.max(l,i)),r=Math.min(a,Math.max(c,r));break;case 270:i=Math.min(s,Math.max(c,i)),r=Math.max(0,Math.min(a-l,r));break}this.x=i/=s,this.y=r/=a;const[u,h]=this.getBaseTranslation();i+=u,r+=h,n.left=`${(100*i).toFixed(2)}%`,n.top=`${(100*r).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,n){var s;return A(s=at,Uf,tv).call(s,e,n,this.parentRotation)}pageTranslationToScreen(e,n){var s;return A(s=at,Uf,tv).call(s,e,n,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[n,s]}=this;return[n*e,s*e]}setDims(e,n){const[s,a]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/s).toFixed(2)}%`,o(this,$r)||(i.height=`${(100*n/a).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:n,width:s}=e,a=s.endsWith("%"),i=!o(this,$r)&&n.endsWith("%");if(a&&i)return;const[r,l]=this.parentDimensions;a||(e.width=`${(100*parseFloat(s)/r).toFixed(2)}%`),!o(this,$r)&&!i&&(e.height=`${(100*parseFloat(n)/l).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=o(this,Ce))==null||e.finish()}async addEditToolbar(){return this._editToolbar||o(this,Ur)?this._editToolbar:(this._editToolbar=new UM(this),this.div.append(this._editToolbar.render()),o(this,Ce)&&await this._editToolbar.addAltText(o(this,Ce)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=o(this,Ce))==null||e.destroy())}addContainer(e){var n;const s=(n=this._editToolbar)==null?void 0:n.div;s?s.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){o(this,Ce)||(Dw.initialize(at._l10n),m(this,Ce,new Dw(this)),o(this,zr)&&(o(this,Ce).data=o(this,zr),m(this,zr,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=o(this,Ce))==null?void 0:e.data}set altTextData(e){o(this,Ce)&&(o(this,Ce).data=e)}get guessedAltText(){var e;return(e=o(this,Ce))==null?void 0:e.guessedText}async setGuessedAltText(e){var n;await((n=o(this,Ce))==null?void 0:n.setGuessedText(e))}serializeAltText(e){var n;return(n=o(this,Ce))==null?void 0:n.serialize(e)}hasAltText(){return!!o(this,Ce)&&!o(this,Ce).isEmpty()}hasAltTextData(){var e;return((e=o(this,Ce))==null?void 0:e.hasData())??!1}render(){var e;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=o(this,Jl)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),A(this,oe,av).call(this);const[n,s]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*s/n).toFixed(2)}%`,this.div.style.maxHeight=`${(100*n/s).toFixed(2)}%`);const[a,i]=this.getInitialTranslation();return this.translate(a,i),Lf(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(o(this,Qi)||m(this,Qi,new wk({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:A(this,oe,kk).bind(this),onPinching:A(this,oe,Ak).bind(this),onPinchEnd:A(this,oe,Sk).bind(this),signal:this._uiManager._signal}))),(e=this._uiManager._editorUndoBar)==null||e.hide(),this.div}pointerdown(e){const{isMac:n}=Wt.platform;if(e.button!==0||e.ctrlKey&&n){e.preventDefault();return}if(m(this,No,!0),this._isDraggable){A(this,oe,_k).call(this,e);return}A(this,oe,sv).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){o(this,Ds)&&clearTimeout(o(this,Ds)),m(this,Ds,setTimeout(()=>{var e;m(this,Ds,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,n,s){e.changeParent(this),this.x=n,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(e,n,s=this.rotation){const a=this.parentScale,[i,r]=this.pageDimensions,[l,c]=this.pageTranslation,u=e/a,h=n/a,d=this.x*i,f=this.y*r,g=this.width*i,v=this.height*r;switch(s){case 0:return[d+u+l,r-f-h-v+c,d+u+g+l,r-f-h+c];case 90:return[d+h+l,r-f+u+c,d+h+v+l,r-f+u+g+c];case 180:return[d-u-g+l,r-f+h+c,d-u+l,r-f+h+v+c];case 270:return[d-h-v+l,r-f-u-g+c,d-h+l,r-f-u+c];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,n){const[s,a,i,r]=e,l=i-s,c=r-a;switch(this.rotation){case 0:return[s,n-r,l,c];case 90:return[s,n-a,c,l];case 180:return[i,n-a,l,c];case 270:return[i,n-r,c,l];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){m(this,Ur,!0)}disableEditMode(){m(this,Ur,!1)}isInEditMode(){return o(this,Ur)}shouldGetKeyboardEvents(){return o(this,Ja)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:n,bottom:s,right:a}=this.getClientDimensions(),{innerHeight:i,innerWidth:r}=window;return n<r&&a>0&&e<i&&s>0}rebuild(){A(this,oe,av).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,n=null){ye("An editor must be serializable")}static async deserialize(e,n,s){const a=new this.prototype.constructor({parent:n,id:n.getNextId(),uiManager:s});a.rotation=e.rotation,m(a,zr,e.accessibilityData);const[i,r]=a.pageDimensions,[l,c,u,h]=a.getRectInCurrentCoords(e.rect,r);return a.x=l/i,a.y=c/r,a.width=u/i,a.height=h/r,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,n;if((e=o(this,sr))==null||e.abort(),m(this,sr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),o(this,Ds)&&(clearTimeout(o(this,Ds)),m(this,Ds,null)),A(this,oe,eu).call(this),this.removeEditToolbar(),o(this,yn)){for(const s of o(this,yn).values())clearTimeout(s);m(this,yn,null)}this.parent=null,(n=o(this,Qi))==null||n.destroy(),m(this,Qi,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(A(this,oe,xk).call(this),o(this,_t).classList.remove("hidden"),Lf(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),m(this,Ta,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const n=o(this,_t).children;if(!o(this,ms)){m(this,ms,Array.from(n));const r=A(this,oe,Ek).bind(this),l=A(this,oe,Ck).bind(this),c=this._uiManager._signal;for(const u of o(this,ms)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",r,{signal:c}),u.addEventListener("blur",l,{signal:c}),u.addEventListener("focus",A(this,oe,Mk).bind(this,h),{signal:c}),u.setAttribute("data-l10n-id",at._l10nResizer[h])}}const s=o(this,ms)[0];let a=0;for(const r of n){if(r===s)break;a++}const i=(360-this.rotation+this.parentRotation)%360/90*(o(this,ms).length/4);if(i!==a){if(i<a)for(let l=0;l<a-i;l++)o(this,_t).append(o(this,_t).firstChild);else if(i>a)for(let l=0;l<i-a;l++)o(this,_t).firstChild.before(o(this,_t).lastChild);let r=0;for(const l of n){const c=o(this,ms)[r++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",at._l10nResizer[c])}}A(this,oe,iv).call(this,0),m(this,Ja,!0),o(this,_t).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,n){o(this,Ja)&&A(this,oe,nv).call(this,o(this,Bf),{deltaX:e,deltaY:n,fromKeyboard:!0})}_stopResizingWithKeyboard(){A(this,oe,eu).call(this),this.div.focus()}select(){var e,n,s;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var a,i;(a=this.div)!=null&&a.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(n=this._editToolbar)==null||n.show(),(s=o(this,Ce))==null||s.toggleAltTextBadge(!1)}unselect(){var e,n,s,a,i;(e=o(this,_t))==null||e.classList.add("hidden"),(n=this.div)==null||n.classList.remove("selectedEditor"),(s=this.div)!=null&&s.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(a=this._editToolbar)==null||a.hide(),(i=o(this,Ce))==null||i.toggleAltTextBadge(!0)}updateParams(e,n){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return o(this,ad)}set isEditing(e){m(this,ad,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,n){m(this,$r,!0);const s=e/n,{style:a}=this.div;a.aspectRatio=s,a.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,n=!1){if(n){o(this,yn)||m(this,yn,new Map);const{action:s}=e;let a=o(this,yn).get(s);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(e),o(this,yn).delete(s),o(this,yn).size===0&&m(this,yn,null)},at._telemetryTimeout),o(this,yn).set(s,a);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),m(this,Jl,!1)}disable(){this.div&&(this.div.tabIndex=-1),m(this,Jl,!0)}renderAnnotationElement(e){let n=e.container.querySelector(".annotationContent");if(!n)n=document.createElement("div"),n.classList.add("annotationContent",this.editorType),e.container.prepend(n);else if(n.nodeName==="CANVAS"){const s=n;n=document.createElement("div"),n.classList.add("annotationContent",this.editorType),s.before(n)}return n}resetAnnotationElement(e){const{firstChild:n}=e.container;(n==null?void 0:n.nodeName)==="DIV"&&n.classList.contains("annotationContent")&&n.remove()}};zr=new WeakMap,ms=new WeakMap,Ce=new WeakMap,Jl=new WeakMap,Pi=new WeakMap,sd=new WeakMap,$r=new WeakMap,_t=new WeakMap,Br=new WeakMap,Ta=new WeakMap,sr=new WeakMap,Bf=new WeakMap,No=new WeakMap,At=new WeakMap,ad=new WeakMap,Ur=new WeakMap,Ja=new WeakMap,Ds=new WeakMap,Zl=new WeakMap,ec=new WeakMap,yn=new WeakMap,Qi=new WeakMap,id=new WeakMap,Zm=new WeakMap,oe=new WeakSet,ev=function([t,e],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Uf=new WeakSet,tv=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},yh=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},xk=function(){if(o(this,_t))return;m(this,_t,document.createElement("div")),o(this,_t).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const s=document.createElement("div");o(this,_t).append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",A(this,oe,Fw).bind(this,n),{signal:e}),s.addEventListener("contextmenu",ts,{signal:e}),s.tabIndex=-1}this.div.prepend(o(this,_t))},Fw=function(t,e){var n;e.preventDefault();const{isMac:s}=Wt.platform;if(e.button!==0||e.ctrlKey&&s)return;(n=o(this,Ce))==null||n.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,m(this,Br,[e.screenX,e.screenY]);const i=new AbortController,r=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",A(this,oe,nv).bind(this,t),{passive:!0,capture:!0,signal:r}),window.addEventListener("touchmove",un,{passive:!1,signal:r}),window.addEventListener("contextmenu",ts,{signal:r}),m(this,Ta,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const l=this.parent.div.style.cursor,c=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const u=()=>{var h;i.abort(),this.parent.togglePointerEvents(!0),(h=o(this,Ce))==null||h.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=l,this.div.style.cursor=c,A(this,oe,wh).call(this)};window.addEventListener("pointerup",u,{signal:r}),window.addEventListener("blur",u,{signal:r})},Eg=function(t,e,n,s){this.width=n,this.height=s,this.x=t,this.y=e;const[a,i]=this.parentDimensions;this.setDims(a*n,i*s),this.fixAndSetPosition(),this._onResized()},wh=function(){if(!o(this,Ta))return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:s}=o(this,Ta);m(this,Ta,null);const a=this.x,i=this.y,r=this.width,l=this.height;a===t&&i===e&&r===n&&l===s||this.addCommands({cmd:A(this,oe,Eg).bind(this,a,i,r,l),undo:A(this,oe,Eg).bind(this,t,e,n,s),mustExec:!0})},nv=function(t,e){const[n,s]=this.parentDimensions,a=this.x,i=this.y,r=this.width,l=this.height,c=Fe.MIN_SIZE/n,u=Fe.MIN_SIZE/s,h=A(this,oe,yh).call(this,this.rotation),d=(G,F)=>[h[0]*G+h[2]*F,h[1]*G+h[3]*F],f=A(this,oe,yh).call(this,360-this.rotation),g=(G,F)=>[f[0]*G+f[2]*F,f[1]*G+f[3]*F];let v,y,S=!1,b=!1;switch(t){case"topLeft":S=!0,v=(G,F)=>[0,0],y=(G,F)=>[G,F];break;case"topMiddle":v=(G,F)=>[G/2,0],y=(G,F)=>[G/2,F];break;case"topRight":S=!0,v=(G,F)=>[G,0],y=(G,F)=>[0,F];break;case"middleRight":b=!0,v=(G,F)=>[G,F/2],y=(G,F)=>[0,F/2];break;case"bottomRight":S=!0,v=(G,F)=>[G,F],y=(G,F)=>[0,0];break;case"bottomMiddle":v=(G,F)=>[G/2,F],y=(G,F)=>[G/2,0];break;case"bottomLeft":S=!0,v=(G,F)=>[0,F],y=(G,F)=>[G,0];break;case"middleLeft":b=!0,v=(G,F)=>[0,F/2],y=(G,F)=>[G,F/2];break}const x=v(r,l),w=y(r,l);let _=d(...w);const E=Fe._round(a+_[0]),M=Fe._round(i+_[1]);let N=1,P=1,T,I;if(e.fromKeyboard)({deltaX:T,deltaY:I}=e);else{const{screenX:G,screenY:F}=e,[B,L]=o(this,Br);[T,I]=this.screenToPageTranslation(G-B,F-L),o(this,Br)[0]=G,o(this,Br)[1]=F}if([T,I]=g(T/n,I/s),S){const G=Math.hypot(r,l);N=P=Math.max(Math.min(Math.hypot(w[0]-x[0]-T,w[1]-x[1]-I)/G,1/r,1/l),c/r,u/l)}else b?N=Math.max(c,Math.min(1,Math.abs(w[0]-x[0]-T)))/r:P=Math.max(u,Math.min(1,Math.abs(w[1]-x[1]-I)))/l;const V=Fe._round(r*N),re=Fe._round(l*P);_=d(...y(V,re));const ue=E-_[0],he=M-_[1];o(this,At)||m(this,At,[this.x,this.y,this.width,this.height]),this.width=V,this.height=re,this.x=ue,this.y=he,this.setDims(n*V,s*re),this.fixAndSetPosition(),this._onResizing()},kk=function(){var t;m(this,Ta,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=o(this,Ce))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},Ak=function(t,e,n){let s=.7*(n/e)+1-.7;if(s===1)return;const a=A(this,oe,yh).call(this,this.rotation),i=(_,E)=>[a[0]*_+a[2]*E,a[1]*_+a[3]*E],[r,l]=this.parentDimensions,c=this.x,u=this.y,h=this.width,d=this.height,f=Fe.MIN_SIZE/r,g=Fe.MIN_SIZE/l;s=Math.max(Math.min(s,1/h,1/d),f/h,g/d);const v=Fe._round(h*s),y=Fe._round(d*s);if(v===h&&y===d)return;o(this,At)||m(this,At,[c,u,h,d]);const S=i(h/2,d/2),b=Fe._round(c+S[0]),x=Fe._round(u+S[1]),w=i(v/2,y/2);this.x=b-w[0],this.y=x-w[1],this.width=v,this.height=y,this.setDims(r*v,l*y),this.fixAndSetPosition(),this._onResizing()},Sk=function(){var t;(t=o(this,Ce))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),A(this,oe,wh).call(this)},sv=function(t){const{isMac:e}=Wt.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},_k=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,a=this._uiManager.combinedSignal(s),i={capture:!0,passive:!1,signal:a},r=c=>{s.abort(),m(this,Pi,null),m(this,No,!1),this._uiManager.endDragSession()||A(this,oe,sv).call(this,c),n&&this._onStopDragging()};e&&(m(this,Zl,t.clientX),m(this,ec,t.clientY),m(this,Pi,t.pointerId),m(this,sd,t.pointerType),window.addEventListener("pointermove",c=>{n||(n=!0,this._onStartDragging());const{clientX:u,clientY:h,pointerId:d}=c;if(d!==o(this,Pi)){un(c);return}const[f,g]=this.screenToPageTranslation(u-o(this,Zl),h-o(this,ec));m(this,Zl,u),m(this,ec,h),this._uiManager.dragSelectedEditors(f,g)},i),window.addEventListener("touchmove",un,i),window.addEventListener("pointerdown",c=>{c.pointerType===o(this,sd)&&(o(this,Qi)||c.isPrimary)&&r(c),un(c)},i));const l=c=>{if(!o(this,Pi)||o(this,Pi)===c.pointerId){r(c);return}un(c)};window.addEventListener("pointerup",l,{signal:a}),window.addEventListener("blur",l,{signal:a})},av=function(){if(o(this,sr)||!this.div)return;m(this,sr,new AbortController);const t=this._uiManager.combinedSignal(o(this,sr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Ek=function(t){Fe._resizerKeyboardManager.exec(this,t)},Ck=function(t){var e;o(this,Ja)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==o(this,_t)&&A(this,oe,eu).call(this)},Mk=function(t){m(this,Bf,o(this,Ja)?t:"")},iv=function(t){if(o(this,ms))for(const e of o(this,ms))e.tabIndex=t},eu=function(){m(this,Ja,!1),A(this,oe,iv).call(this,-1),A(this,oe,wh).call(this)},k(Fe,Uf),X(Fe,"_l10n",null),X(Fe,"_l10nResizer",null),X(Fe,"_borderLineWidth",-1),X(Fe,"_colorManager",new XM),X(Fe,"_zIndex",1),X(Fe,"_telemetryTimeout",1e3);let ze=Fe;class YM extends ze{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Ow=3285377520,vn=4294901760,is=65535;class Nk{constructor(e){this.h1=e?e&4294967295:Ow,this.h2=e?e&4294967295:Ow}update(e){let n,s;if(typeof e=="string"){n=new Uint8Array(e.length*2),s=0;for(let y=0,S=e.length;y<S;y++){const b=e.charCodeAt(y);b<=255?n[s++]=b:(n[s++]=b>>>8,n[s++]=b&255)}}else if(ArrayBuffer.isView(e))n=e.slice(),s=n.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=s>>2,i=s-a*4,r=new Uint32Array(n.buffer,0,a);let l=0,c=0,u=this.h1,h=this.h2;const d=3432918353,f=461845907,g=d&is,v=f&is;for(let y=0;y<a;y++)y&1?(l=r[y],l=l*d&vn|l*g&is,l=l<<15|l>>>17,l=l*f&vn|l*v&is,u^=l,u=u<<13|u>>>19,u=u*5+3864292196):(c=r[y],c=c*d&vn|c*g&is,c=c<<15|c>>>17,c=c*f&vn|c*v&is,h^=c,h=h<<13|h>>>19,h=h*5+3864292196);switch(l=0,i){case 3:l^=n[a*4+2]<<16;case 2:l^=n[a*4+1]<<8;case 1:l^=n[a*4],l=l*d&vn|l*g&is,l=l<<15|l>>>17,l=l*f&vn|l*v&is,a&1?u^=l:h^=l}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,n=this.h2;return e^=n>>>1,e=e*3981806797&vn|e*36045&is,n=n*4283543511&vn|((n<<16|e>>>16)*2950163797&vn)>>>16,e^=n>>>1,e=e*444984403&vn|e*60499&is,n=n*3301882366&vn|((n<<16|e>>>16)*3120437893&vn)>>>16,e^=n>>>1,(e>>>0).toString(16).padStart(8,"0")+(n>>>0).toString(16).padStart(8,"0")}}const rv=Object.freeze({map:null,hash:"",transfer:void 0});var Yo,Hr,it,ov,Pk;class sy{constructor(){k(this,ov),k(this,Yo,!1),k(this,Hr,null),k(this,it,new Map),this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,n){const s=o(this,it).get(e);return s===void 0?n:Object.assign(n,s)}getRawValue(e){return o(this,it).get(e)}remove(e){if(o(this,it).delete(e),o(this,it).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const n of o(this,it).values())if(n instanceof ze)return;this.onAnnotationEditor(null)}}setValue(e,n){const s=o(this,it).get(e);let a=!1;if(s!==void 0)for(const[i,r]of Object.entries(n))s[i]!==r&&(a=!0,s[i]=r);else a=!0,o(this,it).set(e,n);a&&A(this,ov,Pk).call(this),n instanceof ze&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(n.constructor._type)}has(e){return o(this,it).has(e)}getAll(){return o(this,it).size>0?Kb(o(this,it)):null}setAll(e){for(const[n,s]of Object.entries(e))this.setValue(n,s)}get size(){return o(this,it).size}resetModified(){o(this,Yo)&&(m(this,Yo,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Tk(this)}get serializable(){if(o(this,it).size===0)return rv;const e=new Map,n=new Nk,s=[],a=Object.create(null);let i=!1;for(const[r,l]of o(this,it)){const c=l instanceof ze?l.serialize(!1,a):l;c&&(e.set(r,c),n.update(`${r}:${JSON.stringify(c)}`),i||(i=!!c.bitmap))}if(i)for(const r of e.values())r.bitmap&&s.push(r.bitmap);return e.size>0?{map:e,hash:n.hexdigest(),transfer:s}:rv}get editorStats(){let e=null;const n=new Map;for(const s of o(this,it).values()){if(!(s instanceof ze))continue;const a=s.telemetryFinalData;if(!a)continue;const{type:i}=a;n.has(i)||n.set(i,Object.getPrototypeOf(s).constructor),e||(e=Object.create(null));const r=e[i]||(e[i]=new Map);for(const[l,c]of Object.entries(a)){if(l==="type")continue;let u=r.get(l);u||(u=new Map,r.set(l,u));const h=u.get(c)??0;u.set(c,h+1)}}for(const[s,a]of n)e[s]=a.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){m(this,Hr,null)}get modifiedIds(){if(o(this,Hr))return o(this,Hr);const e=[];for(const n of o(this,it).values())!(n instanceof ze)||!n.annotationElementId||!n.serialize()||e.push(n.annotationElementId);return m(this,Hr,{ids:new Set(e),hash:e.join(",")})}}Yo=new WeakMap,Hr=new WeakMap,it=new WeakMap,ov=new WeakSet,Pk=function(){o(this,Yo)||(m(this,Yo,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var rd;class Tk extends sy{constructor(e){super(),k(this,rd);const{map:n,hash:s,transfer:a}=e.serializable,i=structuredClone(n,a?{transfer:a}:null);m(this,rd,{map:i,hash:s,transfer:a})}get print(){ye("Should not call PrintAnnotationStorage.print")}get serializable(){return o(this,rd)}get modifiedIds(){return ee(this,"modifiedIds",{ids:new Set,hash:""})}}rd=new WeakMap;var tc;class KM{constructor({ownerDocument:e=globalThis.document,styleElement:n=null}){k(this,tc,new Set),this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const n=this.styleElement.sheet;n.insertRule(e,n.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),o(this,tc).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:n}){if(!(!e||o(this,tc).has(e.loadedName))){if(Ve(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:a,style:i}=e,r=new FontFace(s,a,i);this.addNativeFontFace(r);try{await r.load(),o(this,tc).add(s),n==null||n(e)}catch{Z(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(r)}return}ye("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const s=e.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(a){throw Z(`Failed to load font '${s.family}': '${a}'.`),e.disableFontFace=!0,a}}return}const n=e.createFontFaceRule();if(n){if(this.insertRule(n),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const a=this._queueLoadingCallback(s);this._prepareFontLoadEvent(e,a)})}}get isFontLoadingAPISupported(){var e;const n=!!((e=this._document)!=null&&e.fonts);return ee(this,"isFontLoadingAPISupported",n)}get isSyncFontLoadingSupported(){let e=!1;return(Nt||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),ee(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function n(){for(Ve(!a.done,"completeRequest() cannot be called twice."),a.done=!0;s.length>0&&s[0].done;){const i=s.shift();setTimeout(i.callback,0)}}const{loadingRequests:s}=this,a={done:!1,complete:n,callback:e};return s.push(a),a}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ee(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,n){function s(w,_){return w.charCodeAt(_)<<24|w.charCodeAt(_+1)<<16|w.charCodeAt(_+2)<<8|w.charCodeAt(_+3)&255}function a(w,_,E,M){const N=w.substring(0,_),P=w.substring(_+E);return N+M+P}let i,r;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;function h(w,_){if(++u>30){Z("Load test font never loaded."),_();return}if(c.font="30px "+w,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0){_();return}setTimeout(h.bind(null,w,_))}const d=`lt${Date.now()}${this.loadTestFontId++}`;let f=this._loadTestFont;f=a(f,976,d.length,d);const g=16,v=1482184792;let y=s(f,g);for(i=0,r=d.length-3;i<r;i+=4)y=y-v+s(d,i)|0;i<d.length&&(y=y-v+s(d+"XXX",i)|0),f=a(f,g,4,LM(y));const S=`url(data:font/opentype;base64,${btoa(f)});`,b=`@font-face {font-family:"${d}";src:${S}}`;this.insertRule(b);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const w of[e.loadedName,d]){const _=this._document.createElement("span");_.textContent="Hi",_.style.fontFamily=w,x.append(_)}this._document.body.append(x),h(d,()=>{x.remove(),n.complete()})}}tc=new WeakMap;class QM{constructor(e,{disableFontFace:n=!1,fontExtraProperties:s=!1,inspectFont:a=null}){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this.disableFontFace=n===!0,this.fontExtraProperties=s===!0,this._inspectFont=a}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let n;if(!this.cssFontInfo)n=new FontFace(this.loadedName,this.data,{});else{const s={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(s.style=`oblique ${this.cssFontInfo.italicAngle}deg`),n=new FontFace(this.cssFontInfo.fontFamily,this.data,s)}return(e=this._inspectFont)==null||e.call(this,this),n}createFontFaceRule(){var e;if(!this.data||this.disableFontFace)return null;const n=`url(data:${this.mimetype};base64,${OM(this.data)});`;let s;if(!this.cssFontInfo)s=`@font-face {font-family:"${this.loadedName}";src:${n}}`;else{let a=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(a+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${a}src:${n}}`}return(e=this._inspectFont)==null||e.call(this,this,n),s}getPathGenerator(e,n){if(this.compiledGlyphs[n]!==void 0)return this.compiledGlyphs[n];const s=this.loadedName+"_path_"+n;let a;try{a=e.get(s)}catch(r){Z(`getPathGenerator - ignoring character: "${r}".`)}const i=new Path2D(a||"");return this.fontExtraProperties||e.delete(s),this.compiledGlyphs[n]=i}}const xh={DATA:1,ERROR:2},Be={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Ww(){}function qt(t){if(t instanceof fi||t instanceof Om||t instanceof Bu||t instanceof Cw||t instanceof Pf||t instanceof kg)return t;switch(t instanceof Error||typeof t=="object"&&t!==null||ye('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),t.name){case"AbortException":return new fi(t.message);case"InvalidPDFException":return new Om(t.message);case"MissingPDFException":return new Bu(t.message);case"PasswordException":return new Cw(t.message,t.code);case"UnexpectedResponseException":return new Pf(t.message,t.status);case"UnknownErrorException":return new kg(t.message,t.details)}return new kg(t.message,t.toString())}var nc,La,Lk,zw,$w,kh;class sc{constructor(e,n,s){k(this,La),k(this,nc,new AbortController),this.sourceName=e,this.targetName=n,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",A(this,La,Lk).bind(this),{signal:o(this,nc).signal})}on(e,n){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=n}send(e,n,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:n},s)}sendWithPromise(e,n,s){const a=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[a]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:a,data:n},s)}catch(r){i.reject(r)}return i.promise}sendWithStream(e,n,s,a){const i=this.streamId++,r=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[i]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:r,targetName:l,action:e,streamId:i,data:n,desiredSize:u.desiredSize},a),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[i].pullCall=h,c.postMessage({sourceName:r,targetName:l,stream:Be.PULL,streamId:i,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Ve(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[i].cancelCall=h,this.streamControllers[i].isClosed=!0,c.postMessage({sourceName:r,targetName:l,stream:Be.CANCEL,streamId:i,reason:qt(u)}),h.promise}},s)}destroy(){var e;(e=o(this,nc))==null||e.abort(),m(this,nc,null)}}nc=new WeakMap,La=new WeakSet,Lk=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){A(this,La,$w).call(this,t);return}if(t.callback){const n=t.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===xh.DATA)s.resolve(t.data);else if(t.callback===xh.ERROR)s.reject(qt(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,s=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(i){a.postMessage({sourceName:n,targetName:s,callback:xh.DATA,callbackId:t.callbackId,data:i})},function(i){a.postMessage({sourceName:n,targetName:s,callback:xh.ERROR,callbackId:t.callbackId,reason:qt(i)})});return}if(t.streamId){A(this,La,zw).call(this,t);return}e(t.data)},zw=function(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,a=this.comObj,i=this,r=this.actionHandler[t.action],l={enqueue(c,u=1,h){if(this.isCancelled)return;const d=this.desiredSize;this.desiredSize-=u,d>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:s,stream:Be.ENQUEUE,streamId:e,chunk:c},h)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:Be.CLOSE,streamId:e}),delete i.streamSinks[e])},error(c){Ve(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:s,stream:Be.ERROR,streamId:e,reason:qt(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[e]=l,Promise.try(r,t.data,l).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Be.START_COMPLETE,streamId:e,success:!0})},function(c){a.postMessage({sourceName:n,targetName:s,stream:Be.START_COMPLETE,streamId:e,reason:qt(c)})})},$w=function(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,a=this.comObj,i=this.streamControllers[e],r=this.streamSinks[e];switch(t.stream){case Be.START_COMPLETE:t.success?i.startCall.resolve():i.startCall.reject(qt(t.reason));break;case Be.PULL_COMPLETE:t.success?i.pullCall.resolve():i.pullCall.reject(qt(t.reason));break;case Be.PULL:if(!r){a.postMessage({sourceName:n,targetName:s,stream:Be.PULL_COMPLETE,streamId:e,success:!0});break}r.desiredSize<=0&&t.desiredSize>0&&r.sinkCapability.resolve(),r.desiredSize=t.desiredSize,Promise.try(r.onPull||Ww).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Be.PULL_COMPLETE,streamId:e,success:!0})},function(c){a.postMessage({sourceName:n,targetName:s,stream:Be.PULL_COMPLETE,streamId:e,reason:qt(c)})});break;case Be.ENQUEUE:if(Ve(i,"enqueue should have stream controller"),i.isClosed)break;i.controller.enqueue(t.chunk);break;case Be.CLOSE:if(Ve(i,"close should have stream controller"),i.isClosed)break;i.isClosed=!0,i.controller.close(),A(this,La,kh).call(this,i,e);break;case Be.ERROR:Ve(i,"error should have stream controller"),i.controller.error(qt(t.reason)),A(this,La,kh).call(this,i,e);break;case Be.CANCEL_COMPLETE:t.success?i.cancelCall.resolve():i.cancelCall.reject(qt(t.reason)),A(this,La,kh).call(this,i,e);break;case Be.CANCEL:if(!r)break;const l=qt(t.reason);Promise.try(r.onCancel||Ww,l).then(function(){a.postMessage({sourceName:n,targetName:s,stream:Be.CANCEL_COMPLETE,streamId:e,success:!0})},function(c){a.postMessage({sourceName:n,targetName:s,stream:Be.CANCEL_COMPLETE,streamId:e,reason:qt(c)})}),r.sinkCapability.reject(l),r.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},kh=async function(t,e){var n,s,a;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(s=t.pullCall)==null?void 0:s.promise,(a=t.cancelCall)==null?void 0:a.promise]),delete this.streamControllers[e]};var od;class Rk{constructor({enableHWA:e=!1}){k(this,od,!1),m(this,od,e)}create(e,n){if(e<=0||n<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,n);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!o(this,od)})}}reset(e,n,s){if(!e.canvas)throw new Error("Canvas is not specified");if(n<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=n,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,n){ye("Abstract method `_createCanvas` called.")}}od=new WeakMap;class JM extends Rk{constructor({ownerDocument:e=globalThis.document,enableHWA:n=!1}){super({enableHWA:n}),this._document=e}_createCanvas(e,n){const s=this._document.createElement("canvas");return s.width=e,s.height=n,s}}class Ik{constructor({baseUrl:e=null,isCompressed:n=!0}){this.baseUrl=e,this.isCompressed=n}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const n=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(n).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${n}`)})}async _fetch(e){ye("Abstract method `_fetch` called.")}}class Dk extends Ik{async _fetch(e){const n=await Bp(e,this.isCompressed?"arraybuffer":"text");return n instanceof ArrayBuffer?new Uint8Array(n):$p(n)}}class jk{addFilter(e){return"none"}addHCMFilter(e,n){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,n,s,a,i){return"none"}destroy(e=!1){}}var Vr,Ko,$a,wa,Rt,ar,Gr,U,wt,ac,Po,ld,qr,Fk,lv,Xr,Nl,ic,cv,rc;class ZM extends jk{constructor({docId:e,ownerDocument:n=globalThis.document}){super(),k(this,U),k(this,Vr),k(this,Ko),k(this,$a),k(this,wa),k(this,Rt),k(this,ar),k(this,Gr,0),m(this,wa,e),m(this,Rt,n)}addFilter(e){if(!e)return"none";let n=o(this,U,wt).get(e);if(n)return n;const[s,a,i]=A(this,U,ld).call(this,e),r=e.length===1?s:`${s}${a}${i}`;if(n=o(this,U,wt).get(r),n)return o(this,U,wt).set(e,n),n;const l=`g_${o(this,wa)}_transfer_map_${Jt(this,Gr)._++}`,c=A(this,U,qr).call(this,l);o(this,U,wt).set(e,c),o(this,U,wt).set(r,c);const u=A(this,U,Xr).call(this,l);return A(this,U,ic).call(this,s,a,i,u),c}addHCMFilter(e,n){var s;const a=`${e}-${n}`,i="base";let r=o(this,U,ac).get(i);if((r==null?void 0:r.key)===a||(r?((s=r.filter)==null||s.remove(),r.key=a,r.url="none",r.filter=null):(r={key:a,url:"none",filter:null},o(this,U,ac).set(i,r)),!e||!n))return r.url;const l=A(this,U,rc).call(this,e);e=$.makeHexColor(...l);const c=A(this,U,rc).call(this,n);if(n=$.makeHexColor(...c),o(this,U,Po).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return r.url;const u=new Array(256);for(let v=0;v<=255;v++){const y=v/255;u[v]=y<=.03928?y/12.92:((y+.055)/1.055)**2.4}const h=u.join(","),d=`g_${o(this,wa)}_hcm_filter`,f=r.filter=A(this,U,Xr).call(this,d);A(this,U,ic).call(this,h,h,h,f),A(this,U,lv).call(this,f);const g=(v,y)=>{const S=l[v]/255,b=c[v]/255,x=new Array(y+1);for(let w=0;w<=y;w++)x[w]=S+w/y*(b-S);return x.join(",")};return A(this,U,ic).call(this,g(0,5),g(1,5),g(2,5),f),r.url=A(this,U,qr).call(this,d),r.url}addAlphaFilter(e){let n=o(this,U,wt).get(e);if(n)return n;const[s]=A(this,U,ld).call(this,[e]),a=`alpha_${s}`;if(n=o(this,U,wt).get(a),n)return o(this,U,wt).set(e,n),n;const i=`g_${o(this,wa)}_alpha_map_${Jt(this,Gr)._++}`,r=A(this,U,qr).call(this,i);o(this,U,wt).set(e,r),o(this,U,wt).set(a,r);const l=A(this,U,Xr).call(this,i);return A(this,U,cv).call(this,s,l),r}addLuminosityFilter(e){let n=o(this,U,wt).get(e||"luminosity");if(n)return n;let s,a;if(e?([s]=A(this,U,ld).call(this,[e]),a=`luminosity_${s}`):a="luminosity",n=o(this,U,wt).get(a),n)return o(this,U,wt).set(e,n),n;const i=`g_${o(this,wa)}_luminosity_map_${Jt(this,Gr)._++}`,r=A(this,U,qr).call(this,i);o(this,U,wt).set(e,r),o(this,U,wt).set(a,r);const l=A(this,U,Xr).call(this,i);return A(this,U,Fk).call(this,l),e&&A(this,U,cv).call(this,s,l),r}addHighlightHCMFilter(e,n,s,a,i){var r;const l=`${n}-${s}-${a}-${i}`;let c=o(this,U,ac).get(e);if((c==null?void 0:c.key)===l||(c?((r=c.filter)==null||r.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},o(this,U,ac).set(e,c)),!n||!s))return c.url;const[u,h]=[n,s].map(A(this,U,rc).bind(this));let d=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,v]=[a,i].map(A(this,U,rc).bind(this));f<d&&([d,f,g,v]=[f,d,v,g]),o(this,U,Po).style.color="";const y=(x,w,_)=>{const E=new Array(256),M=(f-d)/_,N=x/255,P=(w-x)/(255*_);let T=0;for(let I=0;I<=_;I++){const V=Math.round(d+I*M),re=N+I*P;for(let ue=T;ue<=V;ue++)E[ue]=re;T=V+1}for(let I=T;I<256;I++)E[I]=E[T-1];return E.join(",")},S=`g_${o(this,wa)}_hcm_${e}_filter`,b=c.filter=A(this,U,Xr).call(this,S);return A(this,U,lv).call(this,b),A(this,U,ic).call(this,y(g[0],v[0],5),y(g[1],v[1],5),y(g[2],v[2],5),b),c.url=A(this,U,qr).call(this,S),c.url}destroy(e=!1){var n,s,a,i;e&&(n=o(this,ar))!=null&&n.size||((s=o(this,$a))==null||s.parentNode.parentNode.remove(),m(this,$a,null),(a=o(this,Ko))==null||a.clear(),m(this,Ko,null),(i=o(this,ar))==null||i.clear(),m(this,ar,null),m(this,Gr,0))}}Vr=new WeakMap,Ko=new WeakMap,$a=new WeakMap,wa=new WeakMap,Rt=new WeakMap,ar=new WeakMap,Gr=new WeakMap,U=new WeakSet,wt=function(){return o(this,Ko)||m(this,Ko,new Map)},ac=function(){return o(this,ar)||m(this,ar,new Map)},Po=function(){if(!o(this,$a)){const t=o(this,Rt).createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=o(this,Rt).createElementNS(Ps,"svg");n.setAttribute("width",0),n.setAttribute("height",0),m(this,$a,o(this,Rt).createElementNS(Ps,"defs")),t.append(n),n.append(o(this,$a)),o(this,Rt).body.append(t)}return o(this,$a)},ld=function(t){if(t.length===1){const l=t[0],c=new Array(256);for(let h=0;h<256;h++)c[h]=l[h]/255;const u=c.join(",");return[u,u,u]}const[e,n,s]=t,a=new Array(256),i=new Array(256),r=new Array(256);for(let l=0;l<256;l++)a[l]=e[l]/255,i[l]=n[l]/255,r[l]=s[l]/255;return[a.join(","),i.join(","),r.join(",")]},qr=function(t){if(o(this,Vr)===void 0){m(this,Vr,"");const e=o(this,Rt).URL;e!==o(this,Rt).baseURI&&(Up(e)?Z('#createUrl: ignore "data:"-URL for performance reasons.'):m(this,Vr,e.split("#",1)[0]))}return`url(${o(this,Vr)}#${t})`},Fk=function(t){const e=o(this,Rt).createElementNS(Ps,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)},lv=function(t){const e=o(this,Rt).createElementNS(Ps,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)},Xr=function(t){const e=o(this,Rt).createElementNS(Ps,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),o(this,U,Po).append(e),e},Nl=function(t,e,n){const s=o(this,Rt).createElementNS(Ps,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),t.append(s)},ic=function(t,e,n,s){const a=o(this,Rt).createElementNS(Ps,"feComponentTransfer");s.append(a),A(this,U,Nl).call(this,a,"feFuncR",t),A(this,U,Nl).call(this,a,"feFuncG",e),A(this,U,Nl).call(this,a,"feFuncB",n)},cv=function(t,e){const n=o(this,Rt).createElementNS(Ps,"feComponentTransfer");e.append(n),A(this,U,Nl).call(this,n,"feFuncA",t)},rc=function(t){return o(this,U,Po).style.color=t,ty(getComputedStyle(o(this,U,Po)).getPropertyValue("color"))};class Ok{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const n=`${this.baseUrl}${e}`;return this._fetch(n).catch(s=>{throw new Error(`Unable to load font data at: ${n}`)})}async _fetch(e){ye("Abstract method `_fetch` called.")}}class Wk extends Ok{async _fetch(e){const n=await Bp(e,"arraybuffer");return new Uint8Array(n)}}Nt&&Z("Please use the `legacy` build in Node.js environments.");async function zk(t){const e=await process.getBuiltinModule("fs").promises.readFile(t);return new Uint8Array(e)}class e2 extends jk{}class t2 extends Rk{_createCanvas(e,n){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,n)}}class n2 extends Ik{async _fetch(e){return zk(e)}}class s2 extends Ok{async _fetch(e){return zk(e)}}const Ct={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function uv(t,e){if(!e)return;const n=e[2]-e[0],s=e[3]-e[1],a=new Path2D;a.rect(e[0],e[1],n,s),t.clip(a)}class ay{getPattern(){ye("Abstract method `getPattern` called.")}}class a2 extends ay{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let n;this._type==="axial"?n=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(n=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)n.addColorStop(s[0],s[1]);return n}getPattern(e,n,s,a){let i;if(a===Ct.STROKE||a===Ct.FILL){const r=n.current.getClippedPathBoundingBox(a,Ee(e))||[0,0,0,0],l=Math.ceil(r[2]-r[0])||1,c=Math.ceil(r[3]-r[1])||1,u=n.cachedCanvases.getCanvas("pattern",l,c),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-r[0],-r[1]),s=$.transform(s,[1,0,0,1,r[0],r[1]]),h.transform(...n.baseTransform),this.matrix&&h.transform(...this.matrix),uv(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),i=e.createPattern(u.canvas,"no-repeat");const d=new DOMMatrix(s);i.setTransform(d)}else uv(e,this._bbox),i=this._createGradient(e);return i}}function Cg(t,e,n,s,a,i,r,l){const c=e.coords,u=e.colors,h=t.data,d=t.width*4;let f;c[n+1]>c[s+1]&&(f=n,n=s,s=f,f=i,i=r,r=f),c[s+1]>c[a+1]&&(f=s,s=a,a=f,f=r,r=l,l=f),c[n+1]>c[s+1]&&(f=n,n=s,s=f,f=i,i=r,r=f);const g=(c[n]+e.offsetX)*e.scaleX,v=(c[n+1]+e.offsetY)*e.scaleY,y=(c[s]+e.offsetX)*e.scaleX,S=(c[s+1]+e.offsetY)*e.scaleY,b=(c[a]+e.offsetX)*e.scaleX,x=(c[a+1]+e.offsetY)*e.scaleY;if(v>=x)return;const w=u[i],_=u[i+1],E=u[i+2],M=u[r],N=u[r+1],P=u[r+2],T=u[l],I=u[l+1],V=u[l+2],re=Math.round(v),ue=Math.round(x);let he,G,F,B,L,j,D,Y;for(let Q=re;Q<=ue;Q++){if(Q<S){const se=Q<v?0:(v-Q)/(v-S);he=g-(g-y)*se,G=w-(w-M)*se,F=_-(_-N)*se,B=E-(E-P)*se}else{let se;Q>x?se=1:S===x?se=0:se=(S-Q)/(S-x),he=y-(y-b)*se,G=M-(M-T)*se,F=N-(N-I)*se,B=P-(P-V)*se}let fe;Q<v?fe=0:Q>x?fe=1:fe=(v-Q)/(v-x),L=g-(g-b)*fe,j=w-(w-T)*fe,D=_-(_-I)*fe,Y=E-(E-V)*fe;const we=Math.round(Math.min(he,L)),st=Math.round(Math.max(he,L));let de=d*Q+we*4;for(let se=we;se<=st;se++)fe=(he-se)/(he-L),fe<0?fe=0:fe>1&&(fe=1),h[de++]=G-(G-j)*fe|0,h[de++]=F-(F-D)*fe|0,h[de++]=B-(B-Y)*fe|0,h[de++]=255}}function i2(t,e,n){const s=e.coords,a=e.colors;let i,r;switch(e.type){case"lattice":const l=e.verticesPerRow,c=Math.floor(s.length/l)-1,u=l-1;for(i=0;i<c;i++){let h=i*l;for(let d=0;d<u;d++,h++)Cg(t,n,s[h],s[h+1],s[h+l],a[h],a[h+1],a[h+l]),Cg(t,n,s[h+l+1],s[h+1],s[h+l],a[h+l+1],a[h+1],a[h+l])}break;case"triangles":for(i=0,r=s.length;i<r;i+=3)Cg(t,n,s[i],s[i+1],s[i+2],a[i],a[i+1],a[i+2]);break;default:throw new Error("illegal figure")}}class r2 extends ay{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,n,s){const a=Math.floor(this._bounds[0]),i=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-a,l=Math.ceil(this._bounds[3])-i,c=Math.min(Math.ceil(Math.abs(r*e[0]*1.1)),3e3),u=Math.min(Math.ceil(Math.abs(l*e[1]*1.1)),3e3),h=r/c,d=l/u,f={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-i,scaleX:1/h,scaleY:1/d},g=c+2*2,v=u+2*2,y=s.getCanvas("mesh",g,v),S=y.context,b=S.createImageData(c,u);if(n){const x=b.data;for(let w=0,_=x.length;w<_;w+=4)x[w]=n[0],x[w+1]=n[1],x[w+2]=n[2],x[w+3]=255}for(const x of this._figures)i2(b,x,f);return S.putImageData(b,2,2),{canvas:y.canvas,offsetX:a-2*h,offsetY:i-2*d,scaleX:h,scaleY:d}}getPattern(e,n,s,a){uv(e,this._bbox);let i;if(a===Ct.SHADING)i=$.singularValueDecompose2dScale(Ee(e));else if(i=$.singularValueDecompose2dScale(n.baseTransform),this.matrix){const l=$.singularValueDecompose2dScale(this.matrix);i=[i[0]*l[0],i[1]*l[1]]}const r=this._createMeshCanvas(i,a===Ct.SHADING?null:this._background,n.cachedCanvases);return a!==Ct.SHADING&&(e.setTransform(...n.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(r.offsetX,r.offsetY),e.scale(r.scaleX,r.scaleY),e.createPattern(r.canvas,"no-repeat")}}class o2 extends ay{getPattern(){return"hotpink"}}function l2(t){switch(t[0]){case"RadialAxial":return new a2(t);case"Mesh":return new r2(t);case"Dummy":return new o2}throw new Error(`Unknown IR type: ${t[0]}`)}const Bw={COLORED:1,UNCOLORED:2},$k=class Bk{constructor(e,n,s,a,i){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=n,this.ctx=s,this.canvasGraphicsFactory=a,this.baseTransform=i}createPatternCanvas(e){const{bbox:n,operatorList:s,paintType:a,tilingType:i,color:r,canvasGraphicsFactory:l}=this;let{xstep:c,ystep:u}=this;c=Math.abs(c),u=Math.abs(u),zp("TilingType: "+i);const h=n[0],d=n[1],f=n[2],g=n[3],v=f-h,y=g-d,S=$.singularValueDecompose2dScale(this.matrix),b=$.singularValueDecompose2dScale(this.baseTransform),x=S[0]*b[0],w=S[1]*b[1];let _=v,E=y,M=!1,N=!1;const P=Math.ceil(c*x),T=Math.ceil(u*w),I=Math.ceil(v*x),V=Math.ceil(y*w);P>=I?_=c:M=!0,T>=V?E=u:N=!0;const re=this.getSizeAndScale(_,this.ctx.canvas.width,x),ue=this.getSizeAndScale(E,this.ctx.canvas.height,w),he=e.cachedCanvases.getCanvas("pattern",re.size,ue.size),G=he.context,F=l.createCanvasGraphics(G);if(F.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(F,a,r),G.translate(-re.scale*h,-ue.scale*d),F.transform(re.scale,0,0,ue.scale,0,0),G.save(),this.clipBbox(F,h,d,f,g),F.baseTransform=Ee(F.ctx),F.executeOperatorList(s),F.endDrawing(),G.restore(),M||N){const B=he.canvas;M&&(_=c),N&&(E=u);const L=this.getSizeAndScale(_,this.ctx.canvas.width,x),j=this.getSizeAndScale(E,this.ctx.canvas.height,w),D=L.size,Y=j.size,Q=e.cachedCanvases.getCanvas("pattern-workaround",D,Y),fe=Q.context,we=M?Math.floor(v/c):0,st=N?Math.floor(y/u):0;for(let de=0;de<=we;de++)for(let se=0;se<=st;se++)fe.drawImage(B,D*de,Y*se,D,Y,0,0,D,Y);return{canvas:Q.canvas,scaleX:L.scale,scaleY:j.scale,offsetX:h,offsetY:d}}return{canvas:he.canvas,scaleX:re.scale,scaleY:ue.scale,offsetX:h,offsetY:d}}getSizeAndScale(e,n,s){const a=Math.max(Bk.MAX_PATTERN_SIZE,n);let i=Math.ceil(e*s);return i>=a?i=a:s=i/e,{scale:s,size:i}}clipBbox(e,n,s,a,i){const r=a-n,l=i-s;e.ctx.rect(n,s,r,l),e.current.updateRectMinMax(Ee(e.ctx),[n,s,a,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,n,s){const a=e.ctx,i=e.current;switch(n){case Bw.COLORED:const r=this.ctx;a.fillStyle=r.fillStyle,a.strokeStyle=r.strokeStyle,i.fillColor=r.fillStyle,i.strokeColor=r.strokeStyle;break;case Bw.UNCOLORED:const l=$.makeHexColor(s[0],s[1],s[2]);a.fillStyle=l,a.strokeStyle=l,i.fillColor=l,i.strokeColor=l;break;default:throw new TM(`Unsupported paint type: ${n}`)}}getPattern(e,n,s,a){let i=s;a!==Ct.SHADING&&(i=$.transform(i,n.baseTransform),this.matrix&&(i=$.transform(i,this.matrix)));const r=this.createPatternCanvas(n);let l=new DOMMatrix(i);l=l.translate(r.offsetX,r.offsetY),l=l.scale(1/r.scaleX,1/r.scaleY);const c=e.createPattern(r.canvas,"repeat");return c.setTransform(l),c}};X($k,"MAX_PATTERN_SIZE",3e3);let c2=$k;function u2({src:t,srcPos:e=0,dest:n,width:s,height:a,nonBlackColor:i=4294967295,inverseDecode:r=!1}){const l=Wt.isLittleEndian?4278190080:255,[c,u]=r?[i,l]:[l,i],h=s>>3,d=s&7,f=t.length;n=new Uint32Array(n.buffer);let g=0;for(let v=0;v<a;v++){for(const S=e+h;e<S;e++){const b=e<f?t[e]:255;n[g++]=b&128?u:c,n[g++]=b&64?u:c,n[g++]=b&32?u:c,n[g++]=b&16?u:c,n[g++]=b&8?u:c,n[g++]=b&4?u:c,n[g++]=b&2?u:c,n[g++]=b&1?u:c}if(d===0)continue;const y=e<f?t[e++]:255;for(let S=0;S<d;S++)n[g++]=y&1<<7-S?u:c}return{srcPos:e,destPos:g}}const Uw=16,Hw=100,h2=15,Vw=10,Gw=1e3,Yt=16;function d2(t,e){if(t._removeMirroring)throw new Error("Context is already forwarding operations.");t.__originalSave=t.save,t.__originalRestore=t.restore,t.__originalRotate=t.rotate,t.__originalScale=t.scale,t.__originalTranslate=t.translate,t.__originalTransform=t.transform,t.__originalSetTransform=t.setTransform,t.__originalResetTransform=t.resetTransform,t.__originalClip=t.clip,t.__originalMoveTo=t.moveTo,t.__originalLineTo=t.lineTo,t.__originalBezierCurveTo=t.bezierCurveTo,t.__originalRect=t.rect,t.__originalClosePath=t.closePath,t.__originalBeginPath=t.beginPath,t._removeMirroring=()=>{t.save=t.__originalSave,t.restore=t.__originalRestore,t.rotate=t.__originalRotate,t.scale=t.__originalScale,t.translate=t.__originalTranslate,t.transform=t.__originalTransform,t.setTransform=t.__originalSetTransform,t.resetTransform=t.__originalResetTransform,t.clip=t.__originalClip,t.moveTo=t.__originalMoveTo,t.lineTo=t.__originalLineTo,t.bezierCurveTo=t.__originalBezierCurveTo,t.rect=t.__originalRect,t.closePath=t.__originalClosePath,t.beginPath=t.__originalBeginPath,delete t._removeMirroring},t.save=function(){e.save(),this.__originalSave()},t.restore=function(){e.restore(),this.__originalRestore()},t.translate=function(n,s){e.translate(n,s),this.__originalTranslate(n,s)},t.scale=function(n,s){e.scale(n,s),this.__originalScale(n,s)},t.transform=function(n,s,a,i,r,l){e.transform(n,s,a,i,r,l),this.__originalTransform(n,s,a,i,r,l)},t.setTransform=function(n,s,a,i,r,l){e.setTransform(n,s,a,i,r,l),this.__originalSetTransform(n,s,a,i,r,l)},t.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},t.rotate=function(n){e.rotate(n),this.__originalRotate(n)},t.clip=function(n){e.clip(n),this.__originalClip(n)},t.moveTo=function(n,s){e.moveTo(n,s),this.__originalMoveTo(n,s)},t.lineTo=function(n,s){e.lineTo(n,s),this.__originalLineTo(n,s)},t.bezierCurveTo=function(n,s,a,i,r,l){e.bezierCurveTo(n,s,a,i,r,l),this.__originalBezierCurveTo(n,s,a,i,r,l)},t.rect=function(n,s,a,i){e.rect(n,s,a,i),this.__originalRect(n,s,a,i)},t.closePath=function(){e.closePath(),this.__originalClosePath()},t.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class f2{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,n,s){let a;return this.cache[e]!==void 0?(a=this.cache[e],this.canvasFactory.reset(a,n,s)):(a=this.canvasFactory.create(n,s),this.cache[e]=a),a}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const n=this.cache[e];this.canvasFactory.destroy(n),delete this.cache[e]}}}function Ah(t,e,n,s,a,i,r,l,c,u){const[h,d,f,g,v,y]=Ee(t);if(d===0&&f===0){const x=r*h+v,w=Math.round(x),_=l*g+y,E=Math.round(_),M=(r+c)*h+v,N=Math.abs(Math.round(M)-w)||1,P=(l+u)*g+y,T=Math.abs(Math.round(P)-E)||1;return t.setTransform(Math.sign(h),0,0,Math.sign(g),w,E),t.drawImage(e,n,s,a,i,0,0,N,T),t.setTransform(h,d,f,g,v,y),[N,T]}if(h===0&&g===0){const x=l*f+v,w=Math.round(x),_=r*d+y,E=Math.round(_),M=(l+u)*f+v,N=Math.abs(Math.round(M)-w)||1,P=(r+c)*d+y,T=Math.abs(Math.round(P)-E)||1;return t.setTransform(0,Math.sign(d),Math.sign(f),0,w,E),t.drawImage(e,n,s,a,i,0,0,T,N),t.setTransform(h,d,f,g,v,y),[T,N]}t.drawImage(e,n,s,a,i,r,l,c,u);const S=Math.hypot(h,d),b=Math.hypot(f,g);return[S*c,b*u]}function p2(t){const{width:e,height:n}=t;if(e>Gw||n>Gw)return null;const s=1e3,a=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=e+1;let r=new Uint8Array(i*(n+1)),l,c,u;const h=e+7&-8;let d=new Uint8Array(h*n),f=0;for(const S of t.data){let b=128;for(;b>0;)d[f++]=S&b?0:255,b>>=1}let g=0;for(f=0,d[f]!==0&&(r[0]=1,++g),c=1;c<e;c++)d[f]!==d[f+1]&&(r[c]=d[f]?2:1,++g),f++;for(d[f]!==0&&(r[c]=2,++g),l=1;l<n;l++){f=l*h,u=l*i,d[f-h]!==d[f]&&(r[u]=d[f]?1:8,++g);let S=(d[f]?4:0)+(d[f-h]?8:0);for(c=1;c<e;c++)S=(S>>2)+(d[f+1]?4:0)+(d[f-h+1]?8:0),a[S]&&(r[u+c]=a[S],++g),f++;if(d[f-h]!==d[f]&&(r[u+c]=d[f]?2:4,++g),g>s)return null}for(f=h*(n-1),u=l*i,d[f]!==0&&(r[u]=8,++g),c=1;c<e;c++)d[f]!==d[f+1]&&(r[u+c]=d[f]?4:8,++g),f++;if(d[f]!==0&&(r[u+c]=4,++g),g>s)return null;const v=new Int32Array([0,i,-1,0,-i,0,0,0,1]),y=new Path2D;for(l=0;g&&l<=n;l++){let S=l*i;const b=S+e;for(;S<b&&!r[S];)S++;if(S===b)continue;y.moveTo(S%i,l);const x=S;let w=r[S];do{const _=v[w];do S+=_;while(!r[S]);const E=r[S];E!==5&&E!==10?(w=E,r[S]=0):(w=E&51*w>>4,r[S]&=w>>2|w<<2),y.lineTo(S%i,S/i|0),r[S]||--g}while(x!==S);--l}return d=null,r=null,function(S){S.save(),S.scale(1/e,-1/n),S.translate(0,-n),S.fill(y),S.beginPath(),S.restore()}}class qw{constructor(e,n){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=ek,this.textMatrixScale=1,this.fontMatrix=Fm,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=yt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,n])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,n){this.x=e,this.y=n}updatePathMinMax(e,n,s){[n,s]=$.applyTransform([n,s],e),this.minX=Math.min(this.minX,n),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,n),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,n){const s=$.applyTransform(n,e),a=$.applyTransform(n.slice(2),e),i=$.applyTransform([n[0],n[3]],e),r=$.applyTransform([n[2],n[1]],e);this.minX=Math.min(this.minX,s[0],a[0],i[0],r[0]),this.minY=Math.min(this.minY,s[1],a[1],i[1],r[1]),this.maxX=Math.max(this.maxX,s[0],a[0],i[0],r[0]),this.maxY=Math.max(this.maxY,s[1],a[1],i[1],r[1])}updateScalingPathMinMax(e,n){$.scaleMinMax(e,n),this.minX=Math.min(this.minX,n[0]),this.minY=Math.min(this.minY,n[1]),this.maxX=Math.max(this.maxX,n[2]),this.maxY=Math.max(this.maxY,n[3])}updateCurvePathMinMax(e,n,s,a,i,r,l,c,u,h){const d=$.bezierBoundingBox(n,s,a,i,r,l,c,u,h);h||this.updateRectMinMax(e,d)}getPathBoundingBox(e=Ct.FILL,n=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===Ct.STROKE){n||ye("Stroke bounding box must include transform.");const a=$.singularValueDecompose2dScale(n),i=a[0]*this.lineWidth/2,r=a[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=$.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Ct.FILL,n=null){return $.intersect(this.clipBox,this.getPathBoundingBox(e,n))}}function Xw(t,e){if(e instanceof ImageData){t.putImageData(e,0,0);return}const n=e.height,s=e.width,a=n%Yt,i=(n-a)/Yt,r=a===0?i:i+1,l=t.createImageData(s,Yt);let c=0,u;const h=e.data,d=l.data;let f,g,v,y;if(e.kind===$h.GRAYSCALE_1BPP){const S=h.byteLength,b=new Uint32Array(d.buffer,0,d.byteLength>>2),x=b.length,w=s+7>>3,_=4294967295,E=Wt.isLittleEndian?4278190080:255;for(f=0;f<r;f++){for(v=f<i?Yt:a,u=0,g=0;g<v;g++){const M=S-c;let N=0;const P=M>w?s:M*8-7,T=P&-8;let I=0,V=0;for(;N<T;N+=8)V=h[c++],b[u++]=V&128?_:E,b[u++]=V&64?_:E,b[u++]=V&32?_:E,b[u++]=V&16?_:E,b[u++]=V&8?_:E,b[u++]=V&4?_:E,b[u++]=V&2?_:E,b[u++]=V&1?_:E;for(;N<P;N++)I===0&&(V=h[c++],I=128),b[u++]=V&I?_:E,I>>=1}for(;u<x;)b[u++]=0;t.putImageData(l,0,f*Yt)}}else if(e.kind===$h.RGBA_32BPP){for(g=0,y=s*Yt*4,f=0;f<i;f++)d.set(h.subarray(c,c+y)),c+=y,t.putImageData(l,0,g),g+=Yt;f<r&&(y=s*a*4,d.set(h.subarray(c,c+y)),t.putImageData(l,0,g))}else if(e.kind===$h.RGB_24BPP)for(v=Yt,y=s*v,f=0;f<r;f++){for(f>=i&&(v=a,y=s*v),u=0,g=y;g--;)d[u++]=h[c++],d[u++]=h[c++],d[u++]=h[c++],d[u++]=255;t.putImageData(l,0,f*Yt)}else throw new Error(`bad image kind: ${e.kind}`)}function Yw(t,e){if(e.bitmap){t.drawImage(e.bitmap,0,0);return}const n=e.height,s=e.width,a=n%Yt,i=(n-a)/Yt,r=a===0?i:i+1,l=t.createImageData(s,Yt);let c=0;const u=e.data,h=l.data;for(let d=0;d<r;d++){const f=d<i?Yt:a;({srcPos:c}=u2({src:u,srcPos:c,dest:h,width:s,height:f,nonBlackColor:0})),t.putImageData(l,0,d*Yt)}}function Pl(t,e){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of n)t[s]!==void 0&&(e[s]=t[s]);t.setLineDash!==void 0&&(e.setLineDash(t.getLineDash()),e.lineDashOffset=t.lineDashOffset)}function Sh(t){if(t.strokeStyle=t.fillStyle="#000000",t.fillRule="nonzero",t.globalAlpha=1,t.lineWidth=1,t.lineCap="butt",t.lineJoin="miter",t.miterLimit=10,t.globalCompositeOperation="source-over",t.font="10px sans-serif",t.setLineDash!==void 0&&(t.setLineDash([]),t.lineDashOffset=0),!Nt){const{filter:e}=t;e!=="none"&&e!==""&&(t.filter="none")}}function Kw(t,e){if(e)return!0;const n=$.singularValueDecompose2dScale(t);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*fl.PDF_TO_CSS_UNITS);return n[0]<=s&&n[1]<=s}const g2=["butt","round","square"],m2=["miter","round","bevel"],v2={},Qw={};var xa,hv,dv,fv;const b2=class Uk{constructor(e,n,s,a,i,{optionalContentConfig:r,markedContentStack:l=null},c,u){k(this,xa),this.ctx=e,this.current=new qw(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=n,this.objs=s,this.canvasFactory=a,this.filterFactory=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=r,this.cachedCanvases=new f2(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=c,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,n=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):n}beginDrawing({transform:e,viewport:n,transparency:s=!1,background:a=null}){const i=this.ctx.canvas.width,r=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,i,r),this.ctx.fillStyle=l,s){const c=this.cachedCanvases.getCanvas("transparent",i,r);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform(...Ee(this.compositeCtx))}this.ctx.save(),Sh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...n.transform),this.viewportScale=n.scale,this.baseTransform=Ee(this.ctx)}executeOperatorList(e,n,s,a){const i=e.argsArray,r=e.fnArray;let l=n||0;const c=i.length;if(c===l)return l;const u=c-l>Vw&&typeof s=="function",h=u?Date.now()+h2:0;let d=0;const f=this.commonObjs,g=this.objs;let v;for(;;){if(a!==void 0&&l===a.nextBreakPoint)return a.breakIt(l,s),l;if(v=r[l],v!==Xn.dependency)this[v].apply(this,i[l]);else for(const y of i[l]){const S=y.startsWith("g_")?f:g;if(!S.has(y))return S.get(y,s),l}if(l++,l===c)return l;if(u&&++d>Vw){if(Date.now()>h)return s(),l;d=0}}}endDrawing(){A(this,xa,hv).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const n of e.values())typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&(n.width=n.height=0);e.clear()}this._cachedBitmapsMap.clear(),A(this,xa,dv).call(this)}_scaleImage(e,n){const s=e.width??e.displayWidth,a=e.height??e.displayHeight;let i=Math.max(Math.hypot(n[0],n[1]),1),r=Math.max(Math.hypot(n[2],n[3]),1),l=s,c=a,u="prescale1",h,d;for(;i>2&&l>1||r>2&&c>1;){let f=l,g=c;i>2&&l>1&&(f=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),i/=l/f),r>2&&c>1&&(g=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,r/=c/g),h=this.cachedCanvases.getCanvas(u,f,g),d=h.context,d.clearRect(0,0,f,g),d.drawImage(e,0,0,l,c,0,0,f,g),e=h.canvas,l=f,c=g,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const n=this.ctx,{width:s,height:a}=e,i=this.current.fillColor,r=this.current.patternFill,l=Ee(n);let c,u,h,d;if((e.bitmap||e.data)&&e.count>1){const P=e.bitmap||e.data.buffer;u=JSON.stringify(r?l:[l.slice(0,4),i]),c=this._cachedBitmapsMap.get(P),c||(c=new Map,this._cachedBitmapsMap.set(P,c));const T=c.get(u);if(T&&!r){const I=Math.round(Math.min(l[0],l[2])+l[4]),V=Math.round(Math.min(l[1],l[3])+l[5]);return{canvas:T,offsetX:I,offsetY:V}}h=T}h||(d=this.cachedCanvases.getCanvas("maskCanvas",s,a),Yw(d.context,e));let f=$.transform(l,[1/s,0,0,-1/a,0,0]);f=$.transform(f,[1,0,0,1,0,-a]);const[g,v,y,S]=$.getAxialAlignedBoundingBox([0,0,s,a],f),b=Math.round(y-g)||1,x=Math.round(S-v)||1,w=this.cachedCanvases.getCanvas("fillCanvas",b,x),_=w.context,E=g,M=v;_.translate(-E,-M),_.transform(...f),h||(h=this._scaleImage(d.canvas,as(_)),h=h.img,c&&r&&c.set(u,h)),_.imageSmoothingEnabled=Kw(Ee(_),e.interpolate),Ah(_,h,0,0,h.width,h.height,0,0,s,a),_.globalCompositeOperation="source-in";const N=$.transform(as(_),[1,0,0,1,-E,-M]);return _.fillStyle=r?i.getPattern(n,this,N,Ct.FILL):i,_.fillRect(0,0,s,a),c&&!r&&(this.cachedCanvases.delete("fillCanvas"),c.set(u,w.canvas)),{canvas:w.canvas,offsetX:Math.round(E),offsetY:Math.round(M)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=g2[e]}setLineJoin(e){this.ctx.lineJoin=m2[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,n){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=n)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[n,s]of e)switch(n){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(s,e,n);this.suspendedCtx=this.ctx,this.ctx=a.context;const i=this.ctx;i.setTransform(...Ee(this.suspendedCtx)),Pl(this.suspendedCtx,i),d2(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Pl(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const n=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,n,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,n,s,a){const i=a[0],r=a[1],l=a[2]-i,c=a[3]-r;l===0||c===0||(this.genericComposeSMask(n.context,s,l,c,n.subtype,n.backdrop,n.transferMap,i,r,n.offsetX,n.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}genericComposeSMask(e,n,s,a,i,r,l,c,u,h,d){let f=e.canvas,g=c-h,v=u-d;if(r){const S=$.makeHexColor(...r);if(g<0||v<0||g+s>f.width||v+a>f.height){const b=this.cachedCanvases.getCanvas("maskExtension",s,a),x=b.context;x.drawImage(f,-g,-v),x.globalCompositeOperation="destination-atop",x.fillStyle=S,x.fillRect(0,0,s,a),x.globalCompositeOperation="source-over",f=b.canvas,g=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(g,v,s,a),e.clip(b),e.globalCompositeOperation="destination-atop",e.fillStyle=S,e.fillRect(g,v,s,a),e.restore()}}n.save(),n.globalAlpha=1,n.setTransform(1,0,0,1,0,0),i==="Alpha"&&l?n.filter=this.filterFactory.addAlphaFilter(l):i==="Luminosity"&&(n.filter=this.filterFactory.addLuminosityFilter(l));const y=new Path2D;y.rect(c,u,s,a),n.clip(y),n.globalCompositeOperation="destination-in",n.drawImage(f,g,v,s,a,c,u,s,a),n.restore()}save(){this.inSMaskMode?(Pl(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Pl(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,n,s,a,i,r){this.ctx.transform(e,n,s,a,i,r),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,n,s){const a=this.ctx,i=this.current;let r=i.x,l=i.y,c,u;const h=Ee(a),d=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,f=d?s.slice(0):null;for(let g=0,v=0,y=e.length;g<y;g++)switch(e[g]|0){case Xn.rectangle:r=n[v++],l=n[v++];const S=n[v++],b=n[v++],x=r+S,w=l+b;a.moveTo(r,l),S===0||b===0?a.lineTo(x,w):(a.lineTo(x,l),a.lineTo(x,w),a.lineTo(r,w)),d||i.updateRectMinMax(h,[r,l,x,w]),a.closePath();break;case Xn.moveTo:r=n[v++],l=n[v++],a.moveTo(r,l),d||i.updatePathMinMax(h,r,l);break;case Xn.lineTo:r=n[v++],l=n[v++],a.lineTo(r,l),d||i.updatePathMinMax(h,r,l);break;case Xn.curveTo:c=r,u=l,r=n[v+4],l=n[v+5],a.bezierCurveTo(n[v],n[v+1],n[v+2],n[v+3],r,l),i.updateCurvePathMinMax(h,c,u,n[v],n[v+1],n[v+2],n[v+3],r,l,f),v+=6;break;case Xn.curveTo2:c=r,u=l,a.bezierCurveTo(r,l,n[v],n[v+1],n[v+2],n[v+3]),i.updateCurvePathMinMax(h,c,u,r,l,n[v],n[v+1],n[v+2],n[v+3],f),r=n[v+2],l=n[v+3],v+=4;break;case Xn.curveTo3:c=r,u=l,r=n[v+2],l=n[v+3],a.bezierCurveTo(n[v],n[v+1],r,l,r,l),i.updateCurvePathMinMax(h,c,u,n[v],n[v+1],r,l,r,l,f),v+=4;break;case Xn.closePath:a.closePath();break}d&&i.updateScalingPathMinMax(h,f),i.setCurrentPoint(r,l)}closePath(){this.ctx.closePath()}stroke(e=!0){const n=this.ctx,s=this.current.strokeColor;n.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&s!=null&&s.getPattern?(n.save(),n.strokeStyle=s.getPattern(n,this,as(n),Ct.STROKE),this.rescaleAndStroke(!1),n.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),n.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const n=this.ctx,s=this.current.fillColor,a=this.current.patternFill;let i=!1;a&&(n.save(),n.fillStyle=s.getPattern(n,this,as(n),Ct.FILL),i=!0);const r=this.current.getClippedPathBoundingBox();this.contentVisible&&r!==null&&(this.pendingEOFill?(n.fill("evenodd"),this.pendingEOFill=!1):n.fill()),i&&n.restore(),e&&this.consumePath(r)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=v2}eoClip(){this.pendingClip=Qw}beginText(){this.current.textMatrix=ek,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,n=this.ctx;if(e===void 0){n.beginPath();return}const s=new Path2D,a=n.getTransform().invertSelf();for(const{transform:i,x:r,y:l,fontSize:c,path:u}of e)s.addPath(u,new DOMMatrix(i).preMultiplySelf(a).translate(r,l).scale(c,-c));n.clip(s),n.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,n){var s;const a=this.commonObjs.get(e),i=this.current;if(!a)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=a.fontMatrix||Fm,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Z("Invalid font matrix for font "+e),n<0?(n=-n,i.fontDirection=-1):i.fontDirection=1,this.current.font=a,this.current.fontSize=n,a.isType3Font)return;const r=a.loadedName||"sans-serif",l=((s=a.systemFontInfo)==null?void 0:s.css)||`"${r}", ${a.fallbackName}`;let c="normal";a.black?c="900":a.bold&&(c="bold");const u=a.italic?"italic":"normal";let h=n;n<Uw?h=Uw:n>Hw&&(h=Hw),this.current.fontSizeScale=n/h,this.ctx.font=`${u} ${c} ${h}px ${l}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,n){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,n){this.setLeading(-n),this.moveText(e,n)}setTextMatrix(e,n,s,a,i,r){this.current.textMatrix=[e,n,s,a,i,r],this.current.textMatrixScale=Math.hypot(e,n),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,n,s,a,i){const r=this.ctx,l=this.current,c=l.font,u=l.textRenderingMode,h=l.fontSize/l.fontSizeScale,d=u&yt.FILL_STROKE_MASK,f=!!(u&yt.ADD_TO_PATH_FLAG),g=l.patternFill&&!c.missingFile,v=l.patternStroke&&!c.missingFile;let y;if((c.disableFontFace||f||g||v)&&(y=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||g||v){if(r.save(),r.translate(n,s),r.scale(h,-h),d===yt.FILL||d===yt.FILL_STROKE)if(a){const S=r.getTransform();r.setTransform(...a),r.fill(A(this,xa,fv).call(this,y,S,a))}else r.fill(y);if(d===yt.STROKE||d===yt.FILL_STROKE)if(i){const S=r.getTransform();r.setTransform(...i),r.stroke(A(this,xa,fv).call(this,y,S,i))}else r.lineWidth/=h,r.stroke(y);r.restore()}else(d===yt.FILL||d===yt.FILL_STROKE)&&r.fillText(e,n,s),(d===yt.STROKE||d===yt.FILL_STROKE)&&r.strokeText(e,n,s);f&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Ee(r),x:n,y:s,fontSize:h,path:y})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const n=e.getImageData(0,0,10,10).data;let s=!1;for(let a=3;a<n.length;a+=4)if(n[a]>0&&n[a]<255){s=!0;break}return ee(this,"isFontSubpixelAAEnabled",s)}showText(e){const n=this.current,s=n.font;if(s.isType3Font)return this.showType3Text(e);const a=n.fontSize;if(a===0)return;const i=this.ctx,r=n.fontSizeScale,l=n.charSpacing,c=n.wordSpacing,u=n.fontDirection,h=n.textHScale*u,d=e.length,f=s.vertical,g=f?1:-1,v=s.defaultVMetrics,y=a*n.fontMatrix[0],S=n.textRenderingMode===yt.FILL&&!s.disableFontFace&&!n.patternFill;i.save(),i.transform(...n.textMatrix),i.translate(n.x,n.y+n.textRise),u>0?i.scale(h,-1):i.scale(h,1);let b,x;if(n.patternFill){i.save();const N=n.fillColor.getPattern(i,this,as(i),Ct.FILL);b=Ee(i),i.restore(),i.fillStyle=N}if(n.patternStroke){i.save();const N=n.strokeColor.getPattern(i,this,as(i),Ct.STROKE);x=Ee(i),i.restore(),i.strokeStyle=N}let w=n.lineWidth;const _=n.textMatrixScale;if(_===0||w===0){const N=n.textRenderingMode&yt.FILL_STROKE_MASK;(N===yt.STROKE||N===yt.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=_;if(r!==1&&(i.scale(r,r),w/=r),i.lineWidth=w,s.isInvalidPDFjsFont){const N=[];let P=0;for(const T of e)N.push(T.unicode),P+=T.width;i.fillText(N.join(""),0,0),n.x+=P*y*h,i.restore(),this.compose();return}let E=0,M;for(M=0;M<d;++M){const N=e[M];if(typeof N=="number"){E+=g*N*a/1e3;continue}let P=!1;const T=(N.isSpace?c:0)+l,I=N.fontChar,V=N.accent;let re,ue,he=N.width;if(f){const F=N.vmetric||v,B=-(N.vmetric?F[1]:he*.5)*y,L=F[2]*y;he=F?-F[0]:he,re=B/r,ue=(E+L)/r}else re=E/r,ue=0;if(s.remeasure&&he>0){const F=i.measureText(I).width*1e3/a*r;if(he<F&&this.isFontSubpixelAAEnabled){const B=he/F;P=!0,i.save(),i.scale(B,1),re/=B}else he!==F&&(re+=(he-F)/2e3*a/r)}if(this.contentVisible&&(N.isInFont||s.missingFile)){if(S&&!V)i.fillText(I,re,ue);else if(this.paintChar(I,re,ue,b,x),V){const F=re+a*V.offset.x/r,B=ue-a*V.offset.y/r;this.paintChar(V.fontChar,F,B,b,x)}}const G=f?he*y-T*u:he*y+T*u;E+=G,P&&i.restore()}f?n.y-=E:n.x+=E*h,i.restore(),this.compose()}showType3Text(e){const n=this.ctx,s=this.current,a=s.font,i=s.fontSize,r=s.fontDirection,l=a.vertical?1:-1,c=s.charSpacing,u=s.wordSpacing,h=s.textHScale*r,d=s.fontMatrix||Fm,f=e.length,g=s.textRenderingMode===yt.INVISIBLE;let v,y,S,b;if(!(g||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),n.transform(...s.textMatrix),n.translate(s.x,s.y),n.scale(h,r),v=0;v<f;++v){if(y=e[v],typeof y=="number"){b=l*y*i/1e3,this.ctx.translate(b,0),s.x+=b*h;continue}const x=(y.isSpace?u:0)+c,w=a.charProcOperatorList[y.operatorListId];if(!w){Z(`Type3 character "${y.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=y,this.save(),n.scale(i,i),n.transform(...d),this.executeOperatorList(w),this.restore()),S=$.applyTransform([y.width,0],d)[0]*i+x,n.translate(S,0),s.x+=S*h}n.restore(),this.processingType3=null}}setCharWidth(e,n){}setCharWidthAndBounds(e,n,s,a,i,r){this.ctx.rect(s,a,i-s,r-a),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let n;if(e[0]==="TilingPattern"){const s=e[1],a=this.baseTransform||Ee(this.ctx),i={createCanvasGraphics:r=>new Uk(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};n=new c2(e,s,this.ctx,i,a)}else n=this._getPattern(e[1],e[2]);return n}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,n,s){this.ctx.strokeStyle=this.current.strokeColor=$.makeHexColor(e,n,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,n,s){this.ctx.fillStyle=this.current.fillColor=$.makeHexColor(e,n,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,n=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=l2(this.getObject(e)),this.cachedPatterns.set(e,s)),n&&(s.matrix=n),s}shadingFill(e){if(!this.contentVisible)return;const n=this.ctx;this.save();const s=this._getPattern(e);n.fillStyle=s.getPattern(n,this,as(n),Ct.SHADING);const a=as(n);if(a){const{width:i,height:r}=n.canvas,[l,c,u,h]=$.getAxialAlignedBoundingBox([0,0,i,r],a);this.ctx.fillRect(l,c,u-l,h-c)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){ye("Should not call beginInlineImage")}beginImageData(){ye("Should not call beginImageData")}paintFormXObjectBegin(e,n){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Ee(this.ctx),n)){const s=n[2]-n[0],a=n[3]-n[1];this.ctx.rect(n[0],n[1],s,a),this.current.updateRectMinMax(Ee(this.ctx),n),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;e.isolated||zp("TODO: Support non-isolated groups."),e.knockout&&Z("Knockout groups not supported.");const s=Ee(n);if(e.matrix&&n.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=$.getAxialAlignedBoundingBox(e.bbox,Ee(n));const i=[0,0,n.canvas.width,n.canvas.height];a=$.intersect(a,i)||[0,0,0,0];const r=Math.floor(a[0]),l=Math.floor(a[1]),c=Math.max(Math.ceil(a[2])-r,1),u=Math.max(Math.ceil(a[3])-l,1);this.current.startNewPathAndClipBox([0,0,c,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const d=this.cachedCanvases.getCanvas(h,c,u),f=d.context;f.translate(-r,-l),f.transform(...s),e.smask?this.smaskStack.push({canvas:d.canvas,context:f,offsetX:r,offsetY:l,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(n.setTransform(1,0,0,1,0,0),n.translate(r,l),n.save()),Pl(n,f),this.ctx=f,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const a=Ee(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...a);const i=$.getAxialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],a);this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,n,s,a,i){if(A(this,xa,hv).call(this),Sh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const r=n[2]-n[0],l=n[3]-n[1];if(i&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=r,n[3]=l;const[c,u]=$.singularValueDecompose2dScale(Ee(this.ctx)),{viewportScale:h}=this,d=Math.ceil(r*this.outputScaleX*h),f=Math.ceil(l*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(d,f);const{canvas:g,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(e,g),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(c,0,0,-u,0,l*u),Sh(this.ctx)}else Sh(this.ctx),this.endPath(),this.ctx.rect(n[0],n[1],r,l),this.ctx.clip(),this.ctx.beginPath()}this.current=new qw(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...a)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),A(this,xa,dv).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const n=e.count;e=this.getObject(e.data,e),e.count=n;const s=this.ctx,a=this.processingType3;if(a&&(a.compiled===void 0&&(a.compiled=p2(e)),a.compiled)){a.compiled(s);return}const i=this._createMaskCanvas(e),r=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,i.offsetX,i.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,n,s=0,a=0,i,r){if(!this.contentVisible)return;e=this.getObject(e.data,e);const l=this.ctx;l.save();const c=Ee(l);l.transform(n,s,a,i,0,0);const u=this._createMaskCanvas(e);l.setTransform(1,0,0,1,u.offsetX-c[4],u.offsetY-c[5]);for(let h=0,d=r.length;h<d;h+=2){const f=$.transform(c,[n,s,a,i,r[h],r[h+1]]),[g,v]=$.applyTransform([0,0],f);l.drawImage(u.canvas,g,v)}l.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,a=this.current.patternFill;for(const i of e){const{data:r,width:l,height:c,transform:u}=i,h=this.cachedCanvases.getCanvas("maskCanvas",l,c),d=h.context;d.save();const f=this.getObject(r,i);Yw(d,f),d.globalCompositeOperation="source-in",d.fillStyle=a?s.getPattern(d,this,as(n),Ct.FILL):s,d.fillRect(0,0,l,c),d.restore(),n.save(),n.transform(...u),n.scale(1,-1),Ah(n,h.canvas,0,0,l,c,0,-1,1,1),n.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const n=this.getObject(e);if(!n){Z("Dependent image isn't ready yet");return}this.paintInlineImageXObject(n)}paintImageXObjectRepeat(e,n,s,a){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){Z("Dependent image isn't ready yet");return}const r=i.width,l=i.height,c=[];for(let u=0,h=a.length;u<h;u+=2)c.push({transform:[n,0,0,s,a[u],a[u+1]],x:0,y:0,w:r,h:l});this.paintInlineImageXObjectGroup(i,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:n,width:s,height:a}=e,i=this.cachedCanvases.getCanvas("inlineImage",s,a),r=i.context;return r.filter=this.current.transferMaps,r.drawImage(n,0,0),r.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const n=e.width,s=e.height,a=this.ctx;if(this.save(),!Nt){const{filter:l}=a;l!=="none"&&l!==""&&(a.filter="none")}a.scale(1/n,-1/s);let i;if(e.bitmap)i=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)i=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",n,s).context;Xw(l,e),i=this.applyTransferMapsToCanvas(l)}const r=this._scaleImage(i,as(a));a.imageSmoothingEnabled=Kw(Ee(a),e.interpolate),Ah(a,r.img,0,0,r.paintWidth,r.paintHeight,0,-s,n,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,n){if(!this.contentVisible)return;const s=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const i=e.width,r=e.height,l=this.cachedCanvases.getCanvas("inlineImage",i,r).context;Xw(l,e),a=this.applyTransferMapsToCanvas(l)}for(const i of n)s.save(),s.transform(...i.transform),s.scale(1,-1),Ah(s,a,i.x,i.y,i.w,i.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,n){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,n){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const n=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(n||(this.pendingClip===Qw?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ee(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const n=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),a=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,a)/n}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:n,b:s,c:a,d:i}=this.ctx.getTransform();let r,l;if(s===0&&a===0){const c=Math.abs(n),u=Math.abs(i);if(c===u)if(e===0)r=l=1/c;else{const h=c*e;r=l=h<1?1/h:1}else if(e===0)r=1/c,l=1/u;else{const h=c*e,d=u*e;r=h<1?1/h:1,l=d<1?1/d:1}}else{const c=Math.abs(n*i-s*a),u=Math.hypot(n,s),h=Math.hypot(a,i);if(e===0)r=h/c,l=u/c;else{const d=e*c;r=h>d?h/d:1,l=u>d?u/d:1}}this._cachedScaleForStroking[0]=r,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:n}=this,{lineWidth:s}=this.current,[a,i]=this.getScaleForStroking();if(n.lineWidth=s||1,a===1&&i===1){n.stroke();return}const r=n.getLineDash();if(e&&n.save(),n.scale(a,i),r.length>0){const l=Math.max(a,i);n.setLineDash(r.map(c=>c/l)),n.lineDashOffset/=l}n.stroke(),e&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};xa=new WeakSet,hv=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},dv=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},fv=function(t,e,n){const s=new Path2D;return s.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),s};let cd=b2;for(const t in Xn)cd.prototype[t]!==void 0&&(cd.prototype[Xn[t]]=cd.prototype[t]);var Hf,Vf;class pi{static get workerPort(){return o(this,Hf)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");m(this,Hf,e)}static get workerSrc(){return o(this,Vf)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");m(this,Vf,e)}}Hf=new WeakMap,Vf=new WeakMap,k(pi,Hf,null),k(pi,Vf,"");var Yr,ud;class y2{constructor({parsedData:e,rawData:n}){k(this,Yr),k(this,ud),m(this,Yr,e),m(this,ud,n)}getRaw(){return o(this,ud)}get(e){return o(this,Yr).get(e)??null}getAll(){return Kb(o(this,Yr))}has(e){return o(this,Yr).has(e)}}Yr=new WeakMap,ud=new WeakMap;const Kr=Symbol("INTERNAL");var hd,dd,fd,oc;class w2{constructor(e,{name:n,intent:s,usage:a,rbGroups:i}){k(this,hd,!1),k(this,dd,!1),k(this,fd,!1),k(this,oc,!0),m(this,hd,!!(e&rn.DISPLAY)),m(this,dd,!!(e&rn.PRINT)),this.name=n,this.intent=s,this.usage=a,this.rbGroups=i}get visible(){if(o(this,fd))return o(this,oc);if(!o(this,oc))return!1;const{print:e,view:n}=this.usage;return o(this,hd)?(n==null?void 0:n.viewState)!=="OFF":o(this,dd)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,n,s=!1){e!==Kr&&ye("Internal method `_setVisible` called."),m(this,fd,s),m(this,oc,n)}}hd=new WeakMap,dd=new WeakMap,fd=new WeakMap,oc=new WeakMap;var Ti,ve,lc,cc,Gf,pv;class x2{constructor(e,n=rn.DISPLAY){if(k(this,Gf),k(this,Ti,null),k(this,ve,new Map),k(this,lc,null),k(this,cc,null),this.renderingIntent=n,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,m(this,cc,e.order);for(const s of e.groups)o(this,ve).set(s.id,new w2(n,s));if(e.baseState==="OFF")for(const s of o(this,ve).values())s._setVisible(Kr,!1);for(const s of e.on)o(this,ve).get(s)._setVisible(Kr,!0);for(const s of e.off)o(this,ve).get(s)._setVisible(Kr,!1);m(this,lc,this.getHash())}}isVisible(e){if(o(this,ve).size===0)return!0;if(!e)return zp("Optional content group not defined."),!0;if(e.type==="OCG")return o(this,ve).has(e.id)?o(this,ve).get(e.id).visible:(Z(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return A(this,Gf,pv).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const n of e.ids){if(!o(this,ve).has(n))return Z(`Optional content group not found: ${n}`),!0;if(o(this,ve).get(n).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const n of e.ids){if(!o(this,ve).has(n))return Z(`Optional content group not found: ${n}`),!0;if(!o(this,ve).get(n).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const n of e.ids){if(!o(this,ve).has(n))return Z(`Optional content group not found: ${n}`),!0;if(!o(this,ve).get(n).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const n of e.ids){if(!o(this,ve).has(n))return Z(`Optional content group not found: ${n}`),!0;if(o(this,ve).get(n).visible)return!1}return!0}return Z(`Unknown optional content policy ${e.policy}.`),!0}return Z(`Unknown group type ${e.type}.`),!0}setVisibility(e,n=!0,s=!0){var a;const i=o(this,ve).get(e);if(!i){Z(`Optional content group not found: ${e}`);return}if(s&&n&&i.rbGroups.length)for(const r of i.rbGroups)for(const l of r)l!==e&&((a=o(this,ve).get(l))==null||a._setVisible(Kr,!1,!0));i._setVisible(Kr,!!n,!0),m(this,Ti,null)}setOCGState({state:e,preserveRB:n}){let s;for(const a of e){switch(a){case"ON":case"OFF":case"Toggle":s=a;continue}const i=o(this,ve).get(a);if(i)switch(s){case"ON":this.setVisibility(a,!0,n);break;case"OFF":this.setVisibility(a,!1,n);break;case"Toggle":this.setVisibility(a,!i.visible,n);break}}m(this,Ti,null)}get hasInitialVisibility(){return o(this,lc)===null||this.getHash()===o(this,lc)}getOrder(){return o(this,ve).size?o(this,cc)?o(this,cc).slice():[...o(this,ve).keys()]:null}getGroups(){return o(this,ve).size>0?Kb(o(this,ve)):null}getGroup(e){return o(this,ve).get(e)||null}getHash(){if(o(this,Ti)!==null)return o(this,Ti);const e=new Nk;for(const[n,s]of o(this,ve))e.update(`${n}:${s.visible}`);return m(this,Ti,e.hexdigest())}}Ti=new WeakMap,ve=new WeakMap,lc=new WeakMap,cc=new WeakMap,Gf=new WeakSet,pv=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let s=1;s<e;s++){const a=t[s];let i;if(Array.isArray(a))i=A(this,Gf,pv).call(this,a);else if(o(this,ve).has(a))i=o(this,ve).get(a).visible;else return Z(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!i)return!1;break;case"Or":if(i)return!0;break;case"Not":return!i;default:return!0}}return n==="And"};class k2{constructor(e,{disableRange:n=!1,disableStream:s=!1}){Ve(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:a,initialData:i,progressiveDone:r,contentDispositionFilename:l}=e;if(this._queuedChunks=[],this._progressiveDone=r,this._contentDispositionFilename=l,(i==null?void 0:i.length)>0){const c=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(c)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!s,this._isRangeSupported=!n,this._contentLength=a,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((c,u)=>{this._onReceiveData({begin:c,chunk:u})}),e.addProgressListener((c,u)=>{this._onProgress({loaded:c,total:u})}),e.addProgressiveReadListener(c=>{this._onReceiveData({chunk:c})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:n}){const s=n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const a=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(s),!0)});Ve(a,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var n,s,a,i;e.total===void 0?(s=(n=this._rangeReaders[0])==null?void 0:n.onProgress)==null||s.call(n,{loaded:e.loaded}):(i=(a=this._fullRequestReader)==null?void 0:a.onProgress)==null||i.call(a,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const n=this._rangeReaders.indexOf(e);n>=0&&this._rangeReaders.splice(n,1)}getFullReader(){Ve(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new A2(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,n){if(n<=this._progressiveDataLength)return null;const s=new S2(this,e,n);return this._pdfDataRangeTransport.requestDataRange(e,n),this._rangeReaders.push(s),s}cancelAllRequests(e){var n;(n=this._fullRequestReader)==null||n.cancel(e);for(const s of this._rangeReaders.slice(0))s.cancel(e);this._pdfDataRangeTransport.abort()}}class A2{constructor(e,n,s=!1,a=null){this._stream=e,this._done=s||!1,this._filename=Zb(a)?a:null,this._queuedChunks=n||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class S2{constructor(e,n,s){this._stream=e,this._begin=n,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const n=this._queuedChunk;return this._queuedChunk=null,{value:n,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function _2(t){let e=!0,n=s("filename\\*","i").exec(t);if(n){n=n[1];let h=l(n);return h=unescape(h),h=c(h),h=u(h),i(h)}if(n=r(t),n){const h=u(n);return i(h)}if(n=s("filename","i").exec(t),n){n=n[1];let h=l(n);return h=u(h),i(h)}function s(h,d){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',d)}function a(h,d){if(h){if(!/^[\x00-\xFF]+$/.test(d))return d;try{const f=new TextDecoder(h,{fatal:!0}),g=$p(d);d=f.decode(g),e=!1}catch{}}return d}function i(h){return e&&/[\x80-\xff]/.test(h)&&(h=a("utf-8",h),e&&(h=a("iso-8859-1",h))),h}function r(h){const d=[];let f;const g=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(f=g.exec(h))!==null;){let[,y,S,b]=f;if(y=parseInt(y,10),y in d){if(y===0)break;continue}d[y]=[S,b]}const v=[];for(let y=0;y<d.length&&y in d;++y){let[S,b]=d[y];b=l(b),S&&(b=unescape(b),y===0&&(b=c(b))),v.push(b)}return v.join("")}function l(h){if(h.startsWith('"')){const d=h.slice(1).split('\\"');for(let f=0;f<d.length;++f){const g=d[f].indexOf('"');g!==-1&&(d[f]=d[f].slice(0,g),d.length=f+1),d[f]=d[f].replaceAll(/\\(.)/g,"$1")}h=d.join('"')}return h}function c(h){const d=h.indexOf("'");if(d===-1)return h;const f=h.slice(0,d),g=h.slice(d+1).replace(/^[^']*'/,"");return a(f,g)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(d,f,g,v){if(g==="q"||g==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,S){return String.fromCharCode(parseInt(S,16))}),a(f,v);try{v=atob(v)}catch{}return a(f,v)})}return""}function Hk(t,e){const n=new Headers;if(!t||!e||typeof e!="object")return n;for(const s in e){const a=e[s];a!==void 0&&n.append(s,a)}return n}function Hp(t){try{return new URL(t).origin}catch{}return null}function Vk({responseHeaders:t,isHttp:e,rangeChunkSize:n,disableRange:s}){const a={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(t.get("Content-Length"),10);return!Number.isInteger(i)||(a.suggestedLength=i,i<=2*n)||s||!e||t.get("Accept-Ranges")!=="bytes"||(t.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function Gk(t){const e=t.get("Content-Disposition");if(e){let n=_2(e);if(n.includes("%"))try{n=decodeURIComponent(n)}catch{}if(Zb(n))return n}return null}function Vp(t,e){return t===404||t===0&&e.startsWith("file:")?new Bu('Missing PDF "'+e+'".'):new Pf(`Unexpected server response (${t}) while retrieving PDF "${e}".`,t)}function qk(t){return t===200||t===206}function Xk(t,e,n){return{method:"GET",headers:t,signal:n.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function Yk(t){return t instanceof Uint8Array?t.buffer:t instanceof ArrayBuffer?t:(Z(`getArrayBuffer - unexpected data format: ${t}`),new Uint8Array(t).buffer)}class Jw{constructor(e){X(this,"_responseOrigin",null),this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=Hk(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ve(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new E2(this),this._fullRequestReader}getRangeReader(e,n){if(n<=this._progressiveDataLength)return null;const s=new C2(this,e,n);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var n;(n=this._fullRequestReader)==null||n.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class E2{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const n=e.source;this._withCredentials=n.withCredentials||!1,this._contentLength=n.length,this._headersCapability=Promise.withResolvers(),this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange;const s=new Headers(e.headers),a=n.url;fetch(a,Xk(s,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=Hp(i.url),!qk(i.status))throw Vp(i.status,a);this._reader=i.body.getReader(),this._headersCapability.resolve();const r=i.headers,{allowRangeRequests:l,suggestedLength:c}=Vk({responseHeaders:r,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=c||this._contentLength,this._filename=Gk(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new fi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._headersCapability.promise;const{value:n,done:s}=await this._reader.read();return s?{value:n,done:s}:(this._loaded+=n.byteLength,(e=this.onProgress)==null||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Yk(n),done:!1})}cancel(e){var n;(n=this._reader)==null||n.cancel(e),this._abortController.abort()}}class C2{constructor(e,n,s){this._stream=e,this._reader=null,this._loaded=0;const a=e.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${n}-${s-1}`);const r=a.url;fetch(r,Xk(i,this._withCredentials,this._abortController)).then(l=>{const c=Hp(l.url);if(c!==e._responseOrigin)throw new Error(`Expected range response-origin "${c}" to match "${e._responseOrigin}".`);if(!qk(l.status))throw Vp(l.status,r);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;await this._readCapability.promise;const{value:n,done:s}=await this._reader.read();return s?{value:n,done:s}:(this._loaded+=n.byteLength,(e=this.onProgress)==null||e.call(this,{loaded:this._loaded}),{value:Yk(n),done:!1})}cancel(e){var n;(n=this._reader)==null||n.cancel(e),this._abortController.abort()}}const Mg=200,Ng=206;function M2(t){const e=t.response;return typeof e!="string"?e:$p(e).buffer}class N2{constructor({url:e,httpHeaders:n,withCredentials:s}){X(this,"_responseOrigin",null),this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=Hk(this.isHttp,n),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const n=new XMLHttpRequest,s=this.currXhrId++,a=this.pendingRequests[s]={xhr:n};n.open("GET",this.url),n.withCredentials=this.withCredentials;for(const[i,r]of this.headers)n.setRequestHeader(i,r);return this.isHttp&&"begin"in e&&"end"in e?(n.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),a.expectedStatus=Ng):a.expectedStatus=Mg,n.responseType="arraybuffer",Ve(e.onError,"Expected `onError` callback to be provided."),n.onerror=()=>{e.onError(n.status)},n.onreadystatechange=this.onStateChange.bind(this,s),n.onprogress=this.onProgress.bind(this,s),a.onHeadersReceived=e.onHeadersReceived,a.onDone=e.onDone,a.onError=e.onError,a.onProgress=e.onProgress,n.send(null),s}onProgress(e,n){var s;const a=this.pendingRequests[e];a&&((s=a.onProgress)==null||s.call(a,n))}onStateChange(e,n){const s=this.pendingRequests[e];if(!s)return;const a=s.xhr;if(a.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),a.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],a.status===0&&this.isHttp){s.onError(a.status);return}const i=a.status||Mg;if(!(i===Mg&&s.expectedStatus===Ng)&&i!==s.expectedStatus){s.onError(a.status);return}const r=M2(a);if(i===Ng){const l=a.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?s.onDone({begin:parseInt(c[1],10),chunk:r}):(Z('Missing or invalid "Content-Range" header.'),s.onError(0))}else r?s.onDone({begin:0,chunk:r}):s.onError(a.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const n=this.pendingRequests[e].xhr;delete this.pendingRequests[e],n.abort()}}class P2{constructor(e){this._source=e,this._manager=new N2(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const n=this._rangeRequestReaders.indexOf(e);n>=0&&this._rangeRequestReaders.splice(n,1)}getFullReader(){return Ve(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new T2(this._manager,this._source),this._fullRequestReader}getRangeReader(e,n){const s=new L2(this._manager,e,n);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var n;(n=this._fullRequestReader)==null||n.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class T2{constructor(e,n){this._manager=e,this._url=n.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=n.disableRange||!1,this._contentLength=n.length,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,n=this._manager.getRequestXhr(e);this._manager._responseOrigin=Hp(n.responseURL);const s=n.getAllResponseHeaders(),a=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[c,...u]=l.split(": ");return[c,u.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:r}=Vk({responseHeaders:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=Gk(a),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Vp(e,this._url),this._headersCapability.reject(this._storedError);for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var n;(n=this.onProgress)==null||n.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L2{constructor(e,n,s){this._manager=e,this._url=e.url,this._requestId=e.request({begin:n,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const n=Hp((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);n!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${n}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const n=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:n,done:!1}):this._queuedChunk=n,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Vp(e,this._url));for(const n of this._requests)n.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var n;this.isStreamingSupported||(n=this.onProgress)==null||n.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const n=this._queuedChunk;return this._queuedChunk=null,{value:n,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const R2=/^[a-z][a-z0-9\-+.]+:/i;function I2(t){if(R2.test(t))return new URL(t);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(t))}class D2{constructor(e){this.source=e,this.url=I2(e.url),Ve(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Ve(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new j2(this),this._fullRequestReader}getRangeReader(e,n){if(n<=this._progressiveDataLength)return null;const s=new F2(this,e,n);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){var n;(n=this._fullRequestReader)==null||n.cancel(e);for(const s of this._rangeRequestReaders.slice(0))s.cancel(e)}}class j2{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const n=e.source;this._contentLength=n.length,this._loaded=0,this._filename=null,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(a=>{this._contentLength=a.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},a=>{a.code==="ENOENT"&&(a=new Bu(`Missing PDF "${this._url}".`)),this._storedError=a,this._headersCapability.reject(a)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const n=this._readableStream.read();return n===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=n.length,(e=this.onProgress)==null||e.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(n).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",n=>{this._error(n)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new fi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class F2{constructor(e,n,s){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const a=e.source;this._isStreamingSupported=!a.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:n,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var e;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const n=this._readableStream.read();return n===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=n.length,(e=this.onProgress)==null||e.call(this,{loaded:this._loaded}),{value:new Uint8Array(n).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",n=>{this._error(n)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const O2=1e5,Bt=30,W2=.8;var Zw,Li,nn,pd,gd,ir,Ba,qf,Xf,Qr,tu,uc,rr,nu,Yf,hc,Qo,Kf,Qf,Jr,To,_h,wi,su,Jo,Kk,e0,gv,qs,md,Pg,Qk,t0;const Ut=class dc{constructor({textContentSource:e,container:n,viewport:s}){k(this,Jo),k(this,Li,Promise.withResolvers()),k(this,nn,null),k(this,pd,!1),k(this,gd,!!((Zw=globalThis.FontInspector)!=null&&Zw.enabled)),k(this,ir,null),k(this,Ba,null),k(this,qf,0),k(this,Xf,0),k(this,Qr,null),k(this,tu,null),k(this,uc,0),k(this,rr,0),k(this,nu,Object.create(null)),k(this,Yf,[]),k(this,hc,null),k(this,Qo,[]),k(this,Kf,new WeakMap),k(this,Qf,null);var a;if(e instanceof ReadableStream)m(this,hc,e);else if(typeof e=="object")m(this,hc,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');m(this,nn,m(this,tu,n)),m(this,rr,s.scale*(globalThis.devicePixelRatio||1)),m(this,uc,s.rotation),m(this,Ba,{div:null,properties:null,ctx:null});const{pageWidth:i,pageHeight:r,pageX:l,pageY:c}=s.rawDims;m(this,Qf,[1,0,0,-1,-l,c+r]),m(this,Xf,i),m(this,qf,r),A(a=dc,qs,Qk).call(a),yr(n,s),o(this,Li).promise.finally(()=>{o(dc,su).delete(this),m(this,Ba,null),m(this,nu,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:n}=Wt.platform;return ee(this,"fontFamilyMap",new Map([["sans-serif",`${e&&n?"Calibri, ":""}sans-serif`],["monospace",`${e&&n?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{o(this,Qr).read().then(({value:n,done:s})=>{if(s){o(this,Li).resolve();return}o(this,ir)??m(this,ir,n.lang),Object.assign(o(this,nu),n.styles),A(this,Jo,Kk).call(this,n.items),e()},o(this,Li).reject)};return m(this,Qr,o(this,hc).getReader()),o(dc,su).add(this),e(),o(this,Li).promise}update({viewport:e,onBefore:n=null}){var s;const a=e.scale*(globalThis.devicePixelRatio||1),i=e.rotation;if(i!==o(this,uc)&&(n==null||n(),m(this,uc,i),yr(o(this,tu),{rotation:i})),a!==o(this,rr)){n==null||n(),m(this,rr,a);const r={div:null,properties:null,ctx:A(s=dc,qs,md).call(s,o(this,ir))};for(const l of o(this,Qo))r.properties=o(this,Kf).get(l),r.div=l,A(this,Jo,gv).call(this,r)}}cancel(){var e;const n=new fi("TextLayer task cancelled.");(e=o(this,Qr))==null||e.cancel(n).catch(()=>{}),m(this,Qr,null),o(this,Li).reject(n)}get textDivs(){return o(this,Qo)}get textContentItemsStr(){return o(this,Yf)}static cleanup(){if(!(o(this,su).size>0)){o(this,Jr).clear();for(const{canvas:e}of o(this,To).values())e.remove();o(this,To).clear()}}};Li=new WeakMap,nn=new WeakMap,pd=new WeakMap,gd=new WeakMap,ir=new WeakMap,Ba=new WeakMap,qf=new WeakMap,Xf=new WeakMap,Qr=new WeakMap,tu=new WeakMap,uc=new WeakMap,rr=new WeakMap,nu=new WeakMap,Yf=new WeakMap,hc=new WeakMap,Qo=new WeakMap,Kf=new WeakMap,Qf=new WeakMap,Jr=new WeakMap,To=new WeakMap,_h=new WeakMap,wi=new WeakMap,su=new WeakMap,Jo=new WeakSet,Kk=function(t){var e,n;if(o(this,pd))return;(n=o(this,Ba)).ctx??(n.ctx=A(e=Ut,qs,md).call(e,o(this,ir)));const s=o(this,Qo),a=o(this,Yf);for(const i of t){if(s.length>O2){Z("Ignoring additional textDivs for performance reasons."),m(this,pd,!0);return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const r=o(this,nn);m(this,nn,document.createElement("span")),o(this,nn).classList.add("markedContent"),i.id!==null&&o(this,nn).setAttribute("id",`${i.id}`),r.append(o(this,nn))}else i.type==="endMarkedContent"&&m(this,nn,o(this,nn).parentNode);continue}a.push(i.str),A(this,Jo,e0).call(this,i)}},e0=function(t){var e;const n=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};o(this,Qo).push(n);const a=$.transform(o(this,Qf),t.transform);let i=Math.atan2(a[1],a[0]);const r=o(this,nu)[t.fontName];r.vertical&&(i+=Math.PI/2);let l=o(this,gd)&&r.fontSubstitution||r.fontFamily;l=Ut.fontFamilyMap.get(l)||l;const c=Math.hypot(a[2],a[3]),u=c*A(e=Ut,qs,t0).call(e,l,o(this,ir));let h,d;i===0?(h=a[4],d=a[5]-u):(h=a[4]+u*Math.sin(i),d=a[5]-u*Math.cos(i));const f="calc(var(--scale-factor)*",g=n.style;o(this,nn)===o(this,tu)?(g.left=`${(100*h/o(this,Xf)).toFixed(2)}%`,g.top=`${(100*d/o(this,qf)).toFixed(2)}%`):(g.left=`${f}${h.toFixed(2)}px)`,g.top=`${f}${d.toFixed(2)}px)`),g.fontSize=`${f}${(o(Ut,wi)*c).toFixed(2)}px)`,g.fontFamily=l,s.fontSize=c,n.setAttribute("role","presentation"),n.textContent=t.str,n.dir=t.dir,o(this,gd)&&(n.dataset.fontName=r.fontSubstitutionLoadedName||t.fontName),i!==0&&(s.angle=i*(180/Math.PI));let v=!1;if(t.str.length>1)v=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const y=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);y!==S&&Math.max(y,S)/Math.min(y,S)>1.5&&(v=!0)}if(v&&(s.canvasWidth=r.vertical?t.height:t.width),o(this,Kf).set(n,s),o(this,Ba).div=n,o(this,Ba).properties=s,A(this,Jo,gv).call(this,o(this,Ba)),s.hasText&&o(this,nn).append(n),s.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),o(this,nn).append(y)}},gv=function(t){var e;const{div:n,properties:s,ctx:a}=t,{style:i}=n;let r="";if(o(Ut,wi)>1&&(r=`scale(${1/o(Ut,wi)})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:l}=i,{canvasWidth:c,fontSize:u}=s;A(e=Ut,qs,Pg).call(e,a,u*o(this,rr),l);const{width:h}=a.measureText(n.textContent);h>0&&(r=`scaleX(${c*o(this,rr)/h}) ${r}`)}s.angle!==0&&(r=`rotate(${s.angle}deg) ${r}`),r.length>0&&(i.transform=r)},qs=new WeakSet,md=function(t=null){let e=o(this,To).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),o(this,To).set(t,e),o(this,_h).set(e,{size:0,family:""})}return e},Pg=function(t,e,n){const s=o(this,_h).get(t);e===s.size&&n===s.family||(t.font=`${e}px ${n}`,s.size=e,s.family=n)},Qk=function(){if(o(this,wi)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),m(this,wi,t.getBoundingClientRect().height),t.remove()},t0=function(t,e){const n=o(this,Jr).get(t);if(n)return n;const s=A(this,qs,md).call(this,e);s.canvas.width=s.canvas.height=Bt,A(this,qs,Pg).call(this,s,Bt,t);const a=s.measureText("");let i=a.fontBoundingBoxAscent,r=Math.abs(a.fontBoundingBoxDescent);if(i){const u=i/(i+r);return o(this,Jr).set(t,u),s.canvas.width=s.canvas.height=0,u}s.strokeStyle="red",s.clearRect(0,0,Bt,Bt),s.strokeText("g",0,0);let l=s.getImageData(0,0,Bt,Bt).data;r=0;for(let u=l.length-1-3;u>=0;u-=4)if(l[u]>0){r=Math.ceil(u/4/Bt);break}s.clearRect(0,0,Bt,Bt),s.strokeText("A",0,Bt),l=s.getImageData(0,0,Bt,Bt).data,i=0;for(let u=0,h=l.length;u<h;u+=4)if(l[u]>0){i=Bt-Math.floor(u/4/Bt);break}s.canvas.width=s.canvas.height=0;const c=i?i/(i+r):W2;return o(this,Jr).set(t,c),c},k(Ut,qs),k(Ut,Jr,new Map),k(Ut,To,new Map),k(Ut,_h,new WeakMap),k(Ut,wi,null),k(Ut,su,new Set);let mv=Ut;class Hu{static textContent(e){const n=[],s={items:n,styles:Object.create(null)};function a(i){var r;if(!i)return;let l=null;const c=i.name;if(c==="#text")l=i.value;else if(Hu.shouldBuildText(c))(r=i==null?void 0:i.attributes)!=null&&r.textContent?l=i.attributes.textContent:i.value&&(l=i.value);else return;if(l!==null&&n.push({str:l}),!!i.children)for(const u of i.children)a(u)}return a(e),s}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const z2=65536,$2=100,B2=5e3,U2=Nt?t2:JM,H2=Nt?n2:Dk,V2=Nt?e2:ZM,G2=Nt?s2:Wk;function q2(t={}){typeof t=="string"||t instanceof URL?t={url:t}:(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});const e=new K2,{docId:n}=e,s=t.url?X2(t.url):null,a=t.data?Y2(t.data):null,i=t.httpHeaders||null,r=t.withCredentials===!0,l=t.password??null,c=t.range instanceof eA?t.range:null,u=Number.isInteger(t.rangeChunkSize)&&t.rangeChunkSize>0?t.rangeChunkSize:z2;let h=t.worker instanceof yd?t.worker:null;const d=t.verbosity,f=typeof t.docBaseUrl=="string"&&!Up(t.docBaseUrl)?t.docBaseUrl:null,g=typeof t.cMapUrl=="string"?t.cMapUrl:null,v=t.cMapPacked!==!1,y=t.CMapReaderFactory||H2,S=typeof t.standardFontDataUrl=="string"?t.standardFontDataUrl:null,b=t.StandardFontDataFactory||G2,x=t.stopAtErrors!==!0,w=Number.isInteger(t.maxImageSize)&&t.maxImageSize>-1?t.maxImageSize:-1,_=t.isEvalSupported!==!1,E=typeof t.isOffscreenCanvasSupported=="boolean"?t.isOffscreenCanvasSupported:!Nt,M=typeof t.isImageDecoderSupported=="boolean"?t.isImageDecoderSupported:!Nt&&(Wt.platform.isFirefox||!globalThis.chrome),N=Number.isInteger(t.canvasMaxAreaInBytes)?t.canvasMaxAreaInBytes:-1,P=typeof t.disableFontFace=="boolean"?t.disableFontFace:Nt,T=t.fontExtraProperties===!0,I=t.enableXfa===!0,V=t.ownerDocument||globalThis.document,re=t.disableRange===!0,ue=t.disableStream===!0,he=t.disableAutoFetch===!0,G=t.pdfBug===!0,F=t.CanvasFactory||U2,B=t.FilterFactory||V2,L=t.enableHWA===!0,j=c?c.length:t.length??NaN,D=typeof t.useSystemFonts=="boolean"?t.useSystemFonts:!Nt&&!P,Y=typeof t.useWorkerFetch=="boolean"?t.useWorkerFetch:y===Dk&&b===Wk&&g&&S&&$l(g,document.baseURI)&&$l(S,document.baseURI),Q=null;CM(d);const fe={canvasFactory:new F({ownerDocument:V,enableHWA:L}),filterFactory:new B({docId:n,ownerDocument:V}),cMapReaderFactory:Y?null:new y({baseUrl:g,isCompressed:v}),standardFontDataFactory:Y?null:new b({baseUrl:S})};if(!h){const de={verbosity:d,port:pi.workerPort};h=de.port?yd.fromPort(de):new yd(de),e._worker=h}const we={docId:n,apiVersion:"4.10.38",data:a,password:l,disableAutoFetch:he,rangeChunkSize:u,length:j,docBaseUrl:f,enableXfa:I,evaluatorOptions:{maxImageSize:w,disableFontFace:P,ignoreErrors:x,isEvalSupported:_,isOffscreenCanvasSupported:E,isImageDecoderSupported:M,canvasMaxAreaInBytes:N,fontExtraProperties:T,useSystemFonts:D,cMapUrl:Y?g:null,standardFontDataUrl:Y?S:null}},st={disableFontFace:P,fontExtraProperties:T,ownerDocument:V,pdfBug:G,styleElement:Q,loadingParams:{disableAutoFetch:he,enableXfa:I}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const de=h.messageHandler.sendWithPromise("GetDocRequest",we,a?[a.buffer]:null);let se;if(c)se=new k2(c,{disableRange:re,disableStream:ue});else if(!a){if(!s)throw new Error("getDocument - no `url` parameter provided.");let Tt;if(Nt)if($l(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Tt=Jw}else Tt=D2;else Tt=$l(s)?Jw:P2;se=new Tt({url:s,length:j,httpHeaders:i,withCredentials:r,rangeChunkSize:u,disableRange:re,disableStream:ue})}return de.then(Tt=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const mt=new sc(n,Tt,h.port),mn=new eN(mt,e,se,st,fe);e._transport=mn,mt.send("Ready",null)})}).catch(e._capability.reject),e}function X2(t){if(t instanceof URL)return t.href;try{return new URL(t,window.location).href}catch{if(Nt&&typeof t=="string")return t}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Y2(t){if(Nt&&typeof Buffer<"u"&&t instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength)return t;if(typeof t=="string")return $p(t);if(t instanceof ArrayBuffer||ArrayBuffer.isView(t)||typeof t=="object"&&!isNaN(t==null?void 0:t.length))return new Uint8Array(t);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function n0(t){return typeof t=="object"&&Number.isInteger(t==null?void 0:t.num)&&t.num>=0&&Number.isInteger(t==null?void 0:t.gen)&&t.gen>=0}var vv;const Jk=class Zk{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Jt(Zk,vv)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,n,s,a;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((n=this._transport)==null?void 0:n.destroy())}catch(i){throw(s=this._worker)!=null&&s.port&&delete this._worker._pendingDestroy,i}this._transport=null,(a=this._worker)==null||a.destroy(),this._worker=null}};vv=new WeakMap,k(Jk,vv,0);let K2=Jk;class eA{constructor(e,n,s=!1,a=null){this.length=e,this.initialData=n,this.progressiveDone=s,this.contentDispositionFilename=a,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,n){for(const s of this._rangeListeners)s(e,n)}onDataProgress(e,n){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,n)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const n of this._progressiveReadListeners)n(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,n){ye("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Q2{constructor(e,n){this._pdfInfo=e,this._transport=n}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ee(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:n}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(n)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Ri,Ua,vs,Lo,Jf;class J2{constructor(e,n,s,a=!1){k(this,vs),k(this,Ri,null),k(this,Ua,!1),this._pageIndex=e,this._pageInfo=n,this._transport=s,this._stats=a?new Nw:null,this._pdfBug=a,this.commonObjs=s.commonObjs,this.objs=new tA,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:n=this.rotate,offsetX:s=0,offsetY:a=0,dontFlip:i=!1}={}){return new Qu({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:n,offsetX:s,offsetY:a,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:n}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,n)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ee(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:n,intent:s="display",annotationMode:a=za.ENABLE,transform:i=null,background:r=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:d=!1}){var f,g;(f=this._stats)==null||f.time("Overall");const v=this._transport.getRenderingIntent(s,a,h,d),{renderingIntent:y,cacheKey:S}=v;m(this,Ua,!1),A(this,vs,Jf).call(this),l||(l=this._transport.getOptionalContentConfig(y));let b=this._intentStates.get(S);b||(b=Object.create(null),this._intentStates.set(S,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const x=!!(y&rn.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(g=this._stats)==null||g.time("Page Request"),this._pumpOperatorList(v));const w=M=>{var N;b.renderTasks.delete(_),(this._maybeCleanupAfterRender||x)&&m(this,Ua,!0),A(this,vs,Lo).call(this,!x),M?(_.capability.reject(M),this._abortOperatorList({intentState:b,reason:M instanceof Error?M:new Error(M)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(N=globalThis.Stats)!=null&&N.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new nN({callback:w,params:{canvasContext:e,viewport:n,transform:i,background:r},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:u});(b.renderTasks||(b.renderTasks=new Set)).add(_);const E=_.task;return Promise.all([b.displayReadyCapability.promise,l]).then(([M,N])=>{var P;if(this.destroyed){w();return}if((P=this._stats)==null||P.time("Rendering"),!(N.renderingIntent&y))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:M,optionalContentConfig:N}),_.operatorListChanged()}).catch(w),E}getOperatorList({intent:e="display",annotationMode:n=za.ENABLE,printAnnotationStorage:s=null,isEditing:a=!1}={}){var i;function r(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(u))}const l=this._transport.getRenderingIntent(e,n,s,a,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let u;return c.opListReadCapability||(u=Object.create(null),u.operatorListChanged=r,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(u),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(i=this._stats)==null||i.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:n=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:n===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Hu.textContent(s));const n=this.streamTextContent(e);return new Promise(function(s,a){function i(){r.read().then(function({value:c,done:u}){if(u){s(l);return}l.lang??(l.lang=c.lang),Object.assign(l.styles,c.styles),l.items.push(...c.items),i()},a)}const r=n.getReader(),l={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const n of this._intentStates.values())if(this._abortOperatorList({intentState:n,reason:new Error("Page was destroyed."),force:!0}),!n.opListReadCapability)for(const s of n.renderTasks)e.push(s.completed),s.cancel();return this.objs.clear(),m(this,Ua,!1),A(this,vs,Jf).call(this),Promise.all(e)}cleanup(e=!1){m(this,Ua,!0);const n=A(this,vs,Lo).call(this,!1);return e&&n&&this._stats&&(this._stats=new Nw),n}_startRenderPage(e,n){var s,a;const i=this._intentStates.get(n);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(a=i.displayReadyCapability)==null||a.resolve(e))}_renderPageChunk(e,n){for(let s=0,a=e.length;s<a;s++)n.operatorList.fnArray.push(e.fnArray[s]),n.operatorList.argsArray.push(e.argsArray[s]);n.operatorList.lastChunk=e.lastChunk,n.operatorList.separateAnnots=e.separateAnnots;for(const s of n.renderTasks)s.operatorListChanged();e.lastChunk&&A(this,vs,Lo).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:n,annotationStorageSerializable:s,modifiedIds:a}){const{map:i,transfer:r}=s,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:n,annotationStorage:i,modifiedIds:a},r).getReader(),c=this._intentStates.get(n);c.streamReader=l;const u=()=>{l.read().then(({value:h,done:d})=>{if(d){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(h,c),u())},h=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const d of c.renderTasks)d.operatorListChanged();A(this,vs,Lo).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(h);else if(c.opListReadCapability)c.opListReadCapability.reject(h);else throw h}})};u()}_abortOperatorList({intentState:e,reason:n,force:s=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!s){if(e.renderTasks.size>0)return;if(n instanceof Jb){let a=$2;n.extraDelay>0&&n.extraDelay<1e3&&(a+=n.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:n,force:!0})},a);return}}if(e.streamReader.cancel(new fi(n.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[a,i]of this._intentStates)if(i===e){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}Ri=new WeakMap,Ua=new WeakMap,vs=new WeakSet,Lo=function(t=!1){if(A(this,vs,Jf).call(this),!o(this,Ua)||this.destroyed)return!1;if(t)return m(this,Ri,setTimeout(()=>{m(this,Ri,null),A(this,vs,Lo).call(this,!1)},B2)),!1;for(const{renderTasks:e,operatorList:n}of this._intentStates.values())if(e.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),m(this,Ua,!1),!0},Jf=function(){o(this,Ri)&&(clearTimeout(o(this,Ri)),m(this,Ri,null))};var ka,bv;class Z2{constructor(){k(this,ka,new Map),k(this,bv,Promise.resolve())}postMessage(e,n){const s={data:structuredClone(e,n?{transfer:n}:null)};o(this,bv).then(()=>{for(const[a]of o(this,ka))a.call(this,s)})}addEventListener(e,n,s=null){let a=null;if((s==null?void 0:s.signal)instanceof AbortSignal){const{signal:i}=s;if(i.aborted){Z("LoopbackPort - cannot use an `aborted` signal.");return}const r=()=>this.removeEventListener(e,n);a=()=>i.removeEventListener("abort",r),i.addEventListener("abort",r)}o(this,ka).set(n,a)}removeEventListener(e,n){const s=o(this,ka).get(n);s==null||s(),o(this,ka).delete(n)}terminate(){for(const[,e]of o(this,ka))e==null||e();o(this,ka).clear()}}ka=new WeakMap,bv=new WeakMap;var yv,Zo,Ji,fc,vd,au,bd;const Aa=class Lt{constructor({name:e=null,port:n=null,verbosity:s=MM()}={}){k(this,fc);var a;if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,n){if((a=o(Lt,Ji))!=null&&a.has(n))throw new Error("Cannot use more than one PDFWorker per port.");(o(Lt,Ji)||m(Lt,Ji,new WeakMap)).set(n,this),this._initializeFromPort(n);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new sc("main","worker",e),this._messageHandler.on("ready",function(){}),A(this,fc,vd).call(this)}_initialize(){if(o(Lt,Zo)||o(Lt,au,bd)){this._setupFakeWorker();return}let{workerSrc:e}=Lt;try{Lt._isSameOrigin(window.location.href,e)||(e=Lt._createCDNWrapper(new URL(e,window.location).href));const n=new Worker(e,{type:"module"}),s=new sc("main","worker",n),a=()=>{i.abort(),s.destroy(),n.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=new AbortController;n.addEventListener("error",()=>{this._webWorker||a()},{signal:i.signal}),s.on("test",l=>{if(i.abort(),this.destroyed||!l){a();return}this._messageHandler=s,this._port=n,this._webWorker=n,A(this,fc,vd).call(this)}),s.on("ready",l=>{if(i.abort(),this.destroyed){a();return}try{r()}catch{this._setupFakeWorker()}});const r=()=>{const l=new Uint8Array;s.send("test",l,[l.buffer])};r();return}catch{zp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){o(Lt,Zo)||(Z("Setting up fake worker."),m(Lt,Zo,!0)),Lt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const n=new Z2;this._port=n;const s=`fake${Jt(Lt,yv)._++}`,a=new sc(s+"_worker",s,n);e.setup(a,n),this._messageHandler=new sc(s,s+"_worker",n),A(this,fc,vd).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,n,s;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(n=o(Lt,Ji))==null||n.delete(this._port),this._port=null,(s=this._messageHandler)==null||s.destroy(),this._messageHandler=null}static fromPort(e){var n;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const s=(n=o(this,Ji))==null?void 0:n.get(e.port);if(s){if(s._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return s}return new Lt(e)}static get workerSrc(){if(pi.workerSrc)return pi.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ee(this,"_setupFakeWorkerGlobal",(async()=>o(this,au,bd)?o(this,au,bd):(await import(this.workerSrc)).WorkerMessageHandler)())}};yv=new WeakMap,Zo=new WeakMap,Ji=new WeakMap,fc=new WeakSet,vd=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},au=new WeakSet,bd=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},k(Aa,au),k(Aa,yv,0),k(Aa,Zo,!1),k(Aa,Ji),Nt&&(m(Aa,Zo,!0),pi.workerSrc||(pi.workerSrc="./pdf.worker.mjs")),Aa._isSameOrigin=(t,e)=>{let n;try{if(n=new URL(t),!n.origin||n.origin==="null")return!1}catch{return!1}const s=new URL(e,n);return n.origin===s.origin},Aa._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let yd=Aa;var Ha,js,pc,gc,Sa,Zr,mc;class eN{constructor(e,n,s,a,i){k(this,Zr),k(this,Ha,new Map),k(this,js,new Map),k(this,pc,new Map),k(this,gc,new Map),k(this,Sa,null),this.messageHandler=e,this.loadingTask=n,this.commonObjs=new tA,this.fontLoader=new KM({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ee(this,"annotationStorage",new sy)}getRenderingIntent(e,n=za.ENABLE,s=null,a=!1,i=!1){let r=rn.DISPLAY,l=rv;switch(e){case"any":r=rn.ANY;break;case"display":break;case"print":r=rn.PRINT;break;default:Z(`getRenderingIntent - invalid intent: ${e}`)}const c=r&rn.PRINT&&s instanceof Tk?s:this.annotationStorage;switch(n){case za.DISABLE:r+=rn.ANNOTATIONS_DISABLE;break;case za.ENABLE:break;case za.ENABLE_FORMS:r+=rn.ANNOTATIONS_FORMS;break;case za.ENABLE_STORAGE:r+=rn.ANNOTATIONS_STORAGE,l=c.serializable;break;default:Z(`getRenderingIntent - invalid annotationMode: ${n}`)}a&&(r+=rn.IS_EDITING),i&&(r+=rn.OPLIST);const{ids:u,hash:h}=c.modifiedIds,d=[r,l.hash,h];return{renderingIntent:r,cacheKey:d.join("_"),annotationStorageSerializable:l,modifiedIds:u}}destroy(){var e;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(e=o(this,Sa))==null||e.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];for(const a of o(this,js).values())n.push(a._destroy());o(this,js).clear(),o(this,pc).clear(),o(this,gc).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const s=this.messageHandler.sendWithPromise("Terminate",null);return n.push(s),Promise.all(n).then(()=>{var a,i;this.commonObjs.clear(),this.fontLoader.clear(),o(this,Ha).clear(),this.filterFactory.destroy(),mv.cleanup(),(a=this._networkStream)==null||a.cancelAllRequests(new fi("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:n}=this;e.on("GetReader",(s,a)=>{Ve(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},a.onPull=()=>{this._fullReader.read().then(function({value:i,done:r}){if(r){a.close();return}Ve(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{a.error(i)})},a.onCancel=i=>{this._fullReader.cancel(i),a.ready.catch(r=>{if(!this.destroyed)throw r})}}),e.on("ReaderHeadersReady",async s=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:r,contentLength:l}=this._fullReader;return(!i||!r)&&(this._lastProgress&&((a=n.onProgress)==null||a.call(n,this._lastProgress)),this._fullReader.onProgress=c=>{var u;(u=n.onProgress)==null||u.call(n,{loaded:c.loaded,total:c.total})}),{isStreamingSupported:i,isRangeSupported:r,contentLength:l}}),e.on("GetRangeReader",(s,a)=>{Ve(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(s.begin,s.end);if(!i){a.close();return}a.onPull=()=>{i.read().then(function({value:r,done:l}){if(l){a.close();return}Ve(r instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{a.error(r)})},a.onCancel=r=>{i.cancel(r),a.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,n._capability.resolve(new Q2(s,this))}),e.on("DocException",s=>{n._capability.reject(qt(s))}),e.on("PasswordRequest",s=>{m(this,Sa,Promise.withResolvers());try{if(!n.onPassword)throw qt(s);const a=i=>{i instanceof Error?o(this,Sa).reject(i):o(this,Sa).resolve({password:i})};n.onPassword(a,s.code)}catch(a){o(this,Sa).reject(a)}return o(this,Sa).promise}),e.on("DataLoaded",s=>{var a;(a=n.onProgress)==null||a.call(n,{loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),e.on("StartRenderPage",s=>{this.destroyed||o(this,js).get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),e.on("commonobj",([s,a,i])=>{var r;if(this.destroyed||this.commonObjs.has(s))return null;switch(a){case"Font":const{disableFontFace:l,fontExtraProperties:c,pdfBug:u}=this._params;if("error"in i){const g=i.error;Z(`Error during font loading: ${g}`),this.commonObjs.resolve(s,g);break}const h=u&&(r=globalThis.FontInspector)!=null&&r.enabled?(g,v)=>globalThis.FontInspector.fontAdded(g,v):null,d=new QM(i,{disableFontFace:l,fontExtraProperties:c,inspectFont:h});this.fontLoader.bind(d).catch(()=>e.sendWithPromise("FontFallback",{id:s})).finally(()=>{!c&&d.data&&(d.data=null),this.commonObjs.resolve(s,d)});break;case"CopyLocalImage":const{imageRef:f}=i;Ve(f,"The imageRef must be defined.");for(const g of o(this,js).values())for(const[,v]of g.objs)if((v==null?void 0:v.ref)===f)return v.dataLen?(this.commonObjs.resolve(s,structuredClone(v)),v.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,i);break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),e.on("obj",([s,a,i,r])=>{var l;if(this.destroyed)return;const c=o(this,js).get(a);if(!c.objs.has(s)){if(c._intentStates.size===0){(l=r==null?void 0:r.bitmap)==null||l.close();return}switch(i){case"Image":c.objs.resolve(s,r),(r==null?void 0:r.dataLen)>AM&&(c._maybeCleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(s,r);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",s=>{var a;this.destroyed||(a=n.onProgress)==null||a.call(n,{loaded:s.loaded,total:s.total})}),e.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),e.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var e;this.annotationStorage.size<=0&&Z("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfer:s}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:((e=this._fullReader)==null?void 0:e.filename)??null},s).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const n=e-1,s=o(this,pc).get(n);if(s)return s;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&o(this,gc).set(i.refStr,e);const r=new J2(n,i,this,this._params.pdfBug);return o(this,js).set(n,r),r});return o(this,pc).set(n,a),a}getPageIndex(e){return n0(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,n){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:n})}getFieldObjects(){return A(this,Zr,mc).call(this,"GetFieldObjects")}hasJSActions(){return A(this,Zr,mc).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return A(this,Zr,mc).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return A(this,Zr,mc).call(this,"GetOptionalContentConfig").then(n=>new x2(n,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",n=o(this,Ha).get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,null).then(a=>{var i,r;return{info:a[0],metadata:a[1]?new y2(a[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((r=this._fullReader)==null?void 0:r.contentLength)??null}});return o(this,Ha).set(e,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const n of o(this,js).values())if(!n.cleanup())throw new Error(`startCleanup: Page ${n.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),o(this,Ha).clear(),this.filterFactory.destroy(!0),mv.cleanup()}}cachedPageNumber(e){if(!n0(e))return null;const n=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return o(this,gc).get(n)??null}}Ha=new WeakMap,js=new WeakMap,pc=new WeakMap,gc=new WeakMap,Sa=new WeakMap,Zr=new WeakSet,mc=function(t,e=null){const n=o(this,Ha).get(t);if(n)return n;const s=this.messageHandler.sendWithPromise(t,e);return o(this,Ha).set(t,s),s};const vc=Symbol("INITIAL_DATA");var kn,wd,wv;class tA{constructor(){k(this,wd),k(this,kn,Object.create(null))}get(e,n=null){if(n){const a=A(this,wd,wv).call(this,e);return a.promise.then(()=>n(a.data)),null}const s=o(this,kn)[e];if(!s||s.data===vc)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const n=o(this,kn)[e];return!!n&&n.data!==vc}delete(e){const n=o(this,kn)[e];return!n||n.data===vc?!1:(delete o(this,kn)[e],!0)}resolve(e,n=null){const s=A(this,wd,wv).call(this,e);s.data=n,s.resolve()}clear(){var e;for(const n in o(this,kn)){const{data:s}=o(this,kn)[n];(e=s==null?void 0:s.bitmap)==null||e.close()}m(this,kn,Object.create(null))}*[Symbol.iterator](){for(const e in o(this,kn)){const{data:n}=o(this,kn)[e];n!==vc&&(yield[e,n])}}}kn=new WeakMap,wd=new WeakSet,wv=function(t){var e;return(e=o(this,kn))[t]||(e[t]={...Promise.withResolvers(),data:vc})};var Ii;class tN{constructor(e){k(this,Ii,null),m(this,Ii,e),this.onContinue=null}get promise(){return o(this,Ii).capability.promise}cancel(e=0){o(this,Ii).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=o(this,Ii).operatorList;if(!e)return!1;const{annotationCanvasMap:n}=o(this,Ii);return e.form||e.canvas&&(n==null?void 0:n.size)>0}}Ii=new WeakMap;var Di,Ro;const nA=class bc{constructor({callback:e,params:n,objs:s,commonObjs:a,annotationCanvasMap:i,operatorList:r,pageIndex:l,canvasFactory:c,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:d=!1,pageColors:f=null}){k(this,Di,null),this.callback=e,this.params=n,this.objs=s,this.commonObjs=a,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=l,this.canvasFactory=c,this.filterFactory=u,this._pdfBug=d,this.pageColors=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new tN(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:n}){var s,a;if(this.cancelled)return;if(this._canvas){if(o(bc,Ro).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");o(bc,Ro).add(this._canvas)}this._pdfBug&&(s=globalThis.StepperManager)!=null&&s.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:r,transform:l,background:c}=this.params;this.gfx=new cd(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:n},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:l,viewport:r,transparency:e,background:c}),this.operatorListIdx=0,this.graphicsReady=!0,(a=this.graphicsReadyCallback)==null||a.call(this)}cancel(e=null,n=0){var s;this.running=!1,this.cancelled=!0,(s=this.gfx)==null||s.endDrawing(),o(this,Di)&&(window.cancelAnimationFrame(o(this,Di)),m(this,Di,null)),o(bc,Ro).delete(this._canvas),this.callback(e||new Jb(`Rendering cancelled, page ${this._pageIndex+1}`,n))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?m(this,Di,window.requestAnimationFrame(()=>{m(this,Di,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),o(bc,Ro).delete(this._canvas),this.callback())))}};Di=new WeakMap,Ro=new WeakMap,k(nA,Ro,new WeakSet);let nN=nA;const sN="4.10.38",aN="f9bea397f";function s0(t){return Math.floor(Math.max(0,Math.min(1,t))*255).toString(16).padStart(2,"0")}function Tl(t){return Math.max(0,Math.min(255,255*t))}class a0{static CMYK_G([e,n,s,a]){return["G",1-Math.min(1,.3*e+.59*s+.11*n+a)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Tl(e),[e,e,e]}static G_HTML([e]){const n=s0(e);return`#${n}${n}${n}`}static RGB_G([e,n,s]){return["G",.3*e+.59*n+.11*s]}static RGB_rgb(e){return e.map(Tl)}static RGB_HTML(e){return`#${e.map(s0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,n,s,a]){return["RGB",1-Math.min(1,e+a),1-Math.min(1,s+a),1-Math.min(1,n+a)]}static CMYK_rgb([e,n,s,a]){return[Tl(1-Math.min(1,e+a)),Tl(1-Math.min(1,s+a)),Tl(1-Math.min(1,n+a))]}static CMYK_HTML(e){const n=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(n)}static RGB_CMYK([e,n,s]){const a=1-e,i=1-n,r=1-s,l=Math.min(a,i,r);return["CMYK",a,i,r,l]}}class iN{create(e,n,s=!1){if(e<=0||n<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),s||(a.setAttribute("width",`${e}px`),a.setAttribute("height",`${n}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${e} ${n}`),a}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){ye("Abstract method `_createSVG` called.")}}class iy extends iN{_createSVG(e){return document.createElementNS(Ps,e)}}class sA{static setupStorage(e,n,s,a,i){const r=a.getValue(n,{value:null});switch(s.name){case"textarea":if(r.value!==null&&(e.textContent=r.value),i==="print")break;e.addEventListener("input",l=>{a.setValue(n,{value:l.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(r.value===s.attributes.xfaOn?e.setAttribute("checked",!0):r.value===s.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",l=>{a.setValue(n,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(r.value!==null&&e.setAttribute("value",r.value),i==="print")break;e.addEventListener("input",l=>{a.setValue(n,{value:l.target.value})})}break;case"select":if(r.value!==null){e.setAttribute("value",r.value);for(const l of s.children)l.attributes.value===r.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}e.addEventListener("input",l=>{const c=l.target.options,u=c.selectedIndex===-1?"":c[c.selectedIndex].value;a.setValue(n,{value:u})});break}}static setAttributes({html:e,element:n,storage:s=null,intent:a,linkService:i}){const{attributes:r}=n,l=e instanceof HTMLAnchorElement;r.type==="radio"&&(r.name=`${r.name}-${a}`);for(const[c,u]of Object.entries(r))if(u!=null)switch(c){case"class":u.length&&e.setAttribute(c,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!l||c!=="href"&&c!=="newWindow")&&e.setAttribute(c,u)}l&&i.addLinkAttributes(e,r.href,r.newWindow),s&&r.dataId&&this.setupStorage(e,r.dataId,n,s)}static render(e){var n,s;const a=e.annotationStorage,i=e.linkService,r=e.xfaHtml,l=e.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:i});const u=l!=="richText",h=e.div;if(h.append(c),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=g}u&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(r.children.length===0){if(r.value){const g=document.createTextNode(r.value);c.append(g),u&&Hu.shouldBuildText(r.name)&&d.push(g)}return{textDivs:d}}const f=[[r,-1,c]];for(;f.length>0;){const[g,v,y]=f.at(-1);if(v+1===g.children.length){f.pop();continue}const S=g.children[++f.at(-1)[1]];if(S===null)continue;const{name:b}=S;if(b==="#text"){const w=document.createTextNode(S.value);d.push(w),y.append(w);continue}const x=(n=S==null?void 0:S.attributes)!=null&&n.xmlns?document.createElementNS(S.attributes.xmlns,b):document.createElement(b);if(y.append(x),S.attributes&&this.setAttributes({html:x,element:S,storage:a,intent:l,linkService:i}),((s=S.children)==null?void 0:s.length)>0)f.push([S,-1,x]);else if(S.value){const w=document.createTextNode(S.value);u&&Hu.shouldBuildText(b)&&d.push(w),x.append(w)}}for(const g of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const n=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=n,e.div.hidden=!1}}const Zu=1e3,rN=9,wr=new WeakSet;function gi(t){return{width:t[2]-t[0],height:t[3]-t[1]}}class oN{static create(e){switch(e.data.annotationType){case Ge.LINK:return new oA(e);case Ge.TEXT:return new cN(e);case Ge.WIDGET:switch(e.data.fieldType){case"Tx":return new uN(e);case"Btn":return e.data.radioButton?new lA(e):e.data.checkBox?new dN(e):new fN(e);case"Ch":return new pN(e);case"Sig":return new hN(e)}return new Er(e);case Ge.POPUP:return new kv(e);case Ge.FREETEXT:return new hA(e);case Ge.LINE:return new mN(e);case Ge.SQUARE:return new vN(e);case Ge.CIRCLE:return new bN(e);case Ge.POLYLINE:return new dA(e);case Ge.CARET:return new wN(e);case Ge.INK:return new ry(e);case Ge.POLYGON:return new yN(e);case Ge.HIGHLIGHT:return new fA(e);case Ge.UNDERLINE:return new xN(e);case Ge.SQUIGGLY:return new kN(e);case Ge.STRIKEOUT:return new AN(e);case Ge.STAMP:return new pA(e);case Ge.FILEATTACHMENT:return new SN(e);default:return new Je(e)}}}var ji,yc,wc,xd,xv;const lN=class aA{constructor(e,{isRenderable:n=!1,ignoreBorder:s=!1,createQuadrilaterals:a=!1}={}){k(this,xd),k(this,ji,null),k(this,yc,!1),k(this,wc,null),this.isRenderable=n,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,n&&(this.container=this._createContainer(s)),a&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:n,richText:s}){return!!(e!=null&&e.str||n!=null&&n.str||s!=null&&s.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return aA._hasPopupData(this.data)}updateEdited(e){var n;if(!this.container)return;o(this,ji)||m(this,ji,{rect:this.data.rect.slice(0)});const{rect:s}=e;s&&A(this,xd,xv).call(this,s),(n=o(this,wc))==null||n.popup.updateEdited(e)}resetEdited(){var e;o(this,ji)&&(A(this,xd,xv).call(this,o(this,ji).rect),(e=o(this,wc))==null||e.popup.resetEdited(),m(this,ji,null))}_createContainer(e){const{data:n,parent:{page:s,viewport:a}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",n.id),this instanceof Er||(i.tabIndex=Zu);const{style:r}=i;if(r.zIndex=this.parent.zIndex++,n.alternativeText&&(i.title=n.alternativeText),n.noRotate&&i.classList.add("norotate"),!n.rect||this instanceof kv){const{rotation:y}=n;return!n.hasOwnCanvas&&y!==0&&this.setRotation(y,i),i}const{width:l,height:c}=gi(n.rect);if(!e&&n.borderStyle.width>0){r.borderWidth=`${n.borderStyle.width}px`;const y=n.borderStyle.horizontalCornerRadius,S=n.borderStyle.verticalCornerRadius;if(y>0||S>0){const x=`calc(${y}px * var(--scale-factor)) / calc(${S}px * var(--scale-factor))`;r.borderRadius=x}else if(this instanceof lA){const x=`calc(${l}px * var(--scale-factor)) / calc(${c}px * var(--scale-factor))`;r.borderRadius=x}switch(n.borderStyle.style){case Ml.SOLID:r.borderStyle="solid";break;case Ml.DASHED:r.borderStyle="dashed";break;case Ml.BEVELED:Z("Unimplemented border style: beveled");break;case Ml.INSET:Z("Unimplemented border style: inset");break;case Ml.UNDERLINE:r.borderBottomStyle="solid";break}const b=n.borderColor||null;b?(m(this,yc,!0),r.borderColor=$.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):r.borderWidth=0}const u=$.normalizeRect([n.rect[0],s.view[3]-n.rect[1]+s.view[1],n.rect[2],s.view[3]-n.rect[3]+s.view[1]]),{pageWidth:h,pageHeight:d,pageX:f,pageY:g}=a.rawDims;r.left=`${100*(u[0]-f)/h}%`,r.top=`${100*(u[1]-g)/d}%`;const{rotation:v}=n;return n.hasOwnCanvas||v===0?(r.width=`${100*l/h}%`,r.height=`${100*c/d}%`):this.setRotation(v,i),i}setRotation(e,n=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:a}=this.parent.viewport.rawDims,{width:i,height:r}=gi(this.data.rect);let l,c;e%180===0?(l=100*i/s,c=100*r/a):(l=100*r/s,c=100*i/a),n.style.width=`${l}%`,n.style.height=`${c}%`,n.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(n,s,a)=>{const i=a.detail[n],r=i[0],l=i.slice(1);a.target.style[s]=a0[`${r}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[s]:a0[`${r}_rgb`](l)})};return ee(this,"_commonActions",{display:n=>{const{display:s}=n.detail,a=s%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:s===1||s===2})},print:n=>{this.annotationStorage.setValue(this.data.id,{noPrint:!n.detail.print})},hidden:n=>{const{hidden:s}=n.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:n=>{setTimeout(()=>n.target.focus({preventScroll:!1}),0)},userName:n=>{n.target.title=n.detail.userName},readonly:n=>{n.target.disabled=n.detail.readonly},required:n=>{this._setRequired(n.target,n.detail.required)},bgColor:n=>{e("bgColor","backgroundColor",n)},fillColor:n=>{e("fillColor","backgroundColor",n)},fgColor:n=>{e("fgColor","color",n)},textColor:n=>{e("textColor","color",n)},borderColor:n=>{e("borderColor","borderColor",n)},strokeColor:n=>{e("strokeColor","borderColor",n)},rotation:n=>{const s=n.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(e,n){const s=this._commonActions;for(const a of Object.keys(n.detail)){const i=e[a]||s[a];i==null||i(n)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const n=this.annotationStorage.getRawValue(this.data.id);if(!n)return;const s=this._commonActions;for(const[a,i]of Object.entries(n)){const r=s[a];if(r){const l={detail:{[a]:i},target:e};r(l),delete n[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[n,s,a,i]=this.data.rect.map(y=>Math.fround(y));if(e.length===8){const[y,S,b,x]=e.subarray(2,6);if(a===y&&i===S&&n===b&&s===x)return}const{style:r}=this.container;let l;if(o(this,yc)){const{borderColor:y,borderWidth:S}=r;r.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const c=a-n,u=i-s,{svgFactory:h}=this,d=h.createElement("svg");d.classList.add("quadrilateralsContainer"),d.setAttribute("width",0),d.setAttribute("height",0);const f=h.createElement("defs");d.append(f);const g=h.createElement("clipPath"),v=`clippath_${this.data.id}`;g.setAttribute("id",v),g.setAttribute("clipPathUnits","objectBoundingBox"),f.append(g);for(let y=2,S=e.length;y<S;y+=8){const b=e[y],x=e[y+1],w=e[y+2],_=e[y+3],E=h.createElement("rect"),M=(w-n)/c,N=(i-x)/u,P=(b-w)/c,T=(x-_)/u;E.setAttribute("x",M),E.setAttribute("y",N),E.setAttribute("width",P),E.setAttribute("height",T),g.append(E),l==null||l.push(`<rect vector-effect="non-scaling-stroke" x="${M}" y="${N}" width="${P}" height="${T}"/>`)}o(this,yc)&&(l.push("</g></svg>')"),r.backgroundImage=l.join("")),this.container.append(d),this.container.style.clipPath=`url(#${v})`}_createPopup(){const{data:e}=this,n=m(this,wc,new kv({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(n.render())}render(){ye("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,n=null){const s=[];if(this._fieldObjects){const a=this._fieldObjects[e];if(a)for(const{page:i,id:r,exportValues:l}of a){if(i===-1||r===n)continue;const c=typeof l=="string"?l:null,u=document.querySelector(`[data-element-id="${r}"]`);if(u&&!wr.has(u)){Z(`_getElementsByName - element not allowed: ${r}`);continue}s.push({id:r,exportValue:c,domElement:u})}return s}for(const a of document.getElementsByName(e)){const{exportValue:i}=a,r=a.getAttribute("data-element-id");r!==n&&wr.has(a)&&s.push({id:r,exportValue:i,domElement:a})}return s}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const n of e)n.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:n}}=this;this.container.addEventListener("dblclick",()=>{var s;(s=this.linkService.eventBus)==null||s.dispatch("switchannotationeditormode",{source:this,mode:e,editId:n})})}};ji=new WeakMap,yc=new WeakMap,wc=new WeakMap,xd=new WeakSet,xv=function(t){const{container:{style:e},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:i,pageX:r,pageY:l}}}}=this;n==null||n.splice(0,4,...t);const{width:c,height:u}=gi(t);e.left=`${100*(t[0]-r)/a}%`,e.top=`${100*(i-t[3]+l)/i}%`,s===0?(e.width=`${100*c/a}%`,e.height=`${100*u/i}%`):this.setRotation(s)};let Je=lN;var bs,or,iA,rA;class oA extends Je{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0}),k(this,bs),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let a=!1;return e.url?(n.addLinkAttributes(s,e.url,e.newWindow),a=!0):e.action?(this._bindNamedAction(s,e.action),a=!0):e.attachment?(A(this,bs,iA).call(this,s,e.attachment,e.attachmentDest),a=!0):e.setOCGState?(A(this,bs,rA).call(this,s,e.setOCGState),a=!0):e.dest?(this._bindLink(s,e.dest),a=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),a=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(s,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&this.container.append(s),this.container}_bindLink(e,n){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&A(this,bs,or).call(this)}_bindNamedAction(e,n){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),A(this,bs,or).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(n.actions)){const i=s.get(a);i&&(e[i]=()=>{var r;return(r=this.linkService.eventBus)==null||r.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:a}}),!1})}e.onclick||(e.onclick=()=>!1),A(this,bs,or).call(this)}_bindResetFormAction(e,n){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),A(this,bs,or).call(this),!this._fieldObjects){Z('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(e.onclick=()=>!1);return}e.onclick=()=>{var a;s==null||s();const{fields:i,refs:r,include:l}=n,c=[];if(i.length!==0||r.length!==0){const d=new Set(r);for(const f of i){const g=this._fieldObjects[f]||[];for(const{id:v}of g)d.add(v)}for(const f of Object.values(this._fieldObjects))for(const g of f)d.has(g.id)===l&&c.push(g)}else for(const d of Object.values(this._fieldObjects))c.push(...d);const u=this.annotationStorage,h=[];for(const d of c){const{id:f}=d;switch(h.push(f),d.type){case"text":{const v=d.defaultValue||"";u.setValue(f,{value:v});break}case"checkbox":case"radiobutton":{const v=d.defaultValue===d.exportValues;u.setValue(f,{value:v});break}case"combobox":case"listbox":{const v=d.defaultValue||"";u.setValue(f,{value:v});break}default:continue}const g=document.querySelector(`[data-element-id="${f}"]`);if(g){if(!wr.has(g)){Z(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;g.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}bs=new WeakSet,or=function(){this.container.setAttribute("data-internal-link","")},iA=function(t,e,n=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(e.content,e.filename,n),!1},A(this,bs,or).call(this)},rA=function(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),A(this,bs,or).call(this)};class cN extends Je{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Er extends Je{render(){return this.container}showElementAndHideCanvas(e){var n;this.data.hasOwnCanvas&&(((n=e.previousSibling)==null?void 0:n.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Wt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,n,s,a,i){s.includes("mouse")?e.addEventListener(s,r=>{var l;(l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:i(r),shift:r.shiftKey,modifier:this._getKeyModifier(r)}})}):e.addEventListener(s,r=>{var l;if(s==="blur"){if(!n.focused||!r.relatedTarget)return;n.focused=!1}else if(s==="focus"){if(n.focused)return;n.focused=!0}i&&((l=this.linkService.eventBus)==null||l.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:i(r)}}))})}_setEventListeners(e,n,s,a){var i,r,l;for(const[c,u]of s)(u==="Action"||(i=this.data.actions)!=null&&i[u])&&((u==="Focus"||u==="Blur")&&(n||(n={focused:!1})),this._setEventListener(e,n,c,u,a),u==="Focus"&&!((r=this.data.actions)!=null&&r.Blur)?this._setEventListener(e,n,"blur","Blur",null):u==="Blur"&&!((l=this.data.actions)!=null&&l.Focus)&&this._setEventListener(e,n,"focus","Focus",null))}_setBackgroundColor(e){const n=this.data.backgroundColor||null;e.style.backgroundColor=n===null?"transparent":$.makeHexColor(n[0],n[1],n[2])}_setTextStyle(e){const n=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||rN,i=e.style;let r;const l=2,c=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l),h=Math.round(u/(xg*a))||1,d=u/h;r=Math.min(a,c(d/xg))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-l);r=Math.min(a,c(u/xg))}i.fontSize=`calc(${r}px * var(--scale-factor))`,i.color=$.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(i.textAlign=n[this.data.textAlignment])}_setRequired(e,n){n?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",n)}}class uN extends Er{constructor(e){const n=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:n})}setPropertyOnSiblings(e,n,s,a){const i=this.annotationStorage;for(const r of this._getElementsByName(e.name,e.id))r.domElement&&(r.domElement[n]=s),i.setValue(r.id,{[a]:s})}render(){var e,n;const s=this.annotationStorage,a=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=s.getValue(a,{value:this.data.fieldValue});let l=r.value||"";const c=s.getValue(a,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=r.formattedValue||((e=this.data.textContent)==null?void 0:e.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",u??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),wr.add(i),i.setAttribute("data-element-id",a),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=Zu,this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",f=>{s.setValue(a,{value:f.target.value}),this.setPropertyOnSiblings(i,"value",f.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",f=>{const g=this.data.defaultFieldValue??"";i.value=h.userValue=g,h.formattedValue=null});let d=f=>{const{formattedValue:g}=h;g!=null&&(f.target.value=g),f.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",g=>{var v;if(h.focused)return;const{target:y}=g;h.userValue&&(y.value=h.userValue),h.lastCommittedValue=y.value,h.commitKey=1,(v=this.data.actions)!=null&&v.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",g=>{this.showElementAndHideCanvas(g.target);const v={value(y){h.userValue=y.detail.value??"",s.setValue(a,{value:h.userValue.toString()}),y.target.value=h.userValue},formattedValue(y){const{formattedValue:S}=y.detail;h.formattedValue=S,S!=null&&y.target!==document.activeElement&&(y.target.value=S),s.setValue(a,{formattedValue:S})},selRange(y){y.target.setSelectionRange(...y.detail.selRange)},charLimit:y=>{var S;const{charLimit:b}=y.detail,{target:x}=y;if(b===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",b);let w=h.userValue;!w||w.length<=b||(w=w.slice(0,b),x.value=h.userValue=w,s.setValue(a,{value:w}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:w,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(v,g)}),i.addEventListener("keydown",g=>{var v;h.commitKey=1;let y=-1;if(g.key==="Escape"?y=0:g.key==="Enter"&&!this.data.multiLine?y=2:g.key==="Tab"&&(h.commitKey=3),y===-1)return;const{value:S}=g.target;h.lastCommittedValue!==S&&(h.lastCommittedValue=S,h.userValue=S,(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:S,willCommit:!0,commitKey:y,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}}))});const f=d;d=null,i.addEventListener("blur",g=>{var v,y;if(!h.focused||!g.relatedTarget)return;(v=this.data.actions)!=null&&v.Blur||(h.focused=!1);const{value:S}=g.target;h.userValue=S,h.lastCommittedValue!==S&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:S,willCommit:!0,commitKey:h.commitKey,selStart:g.target.selectionStart,selEnd:g.target.selectionEnd}})),f(g)}),(n=this.data.actions)!=null&&n.Keystroke&&i.addEventListener("beforeinput",g=>{var v;h.lastCommittedValue=null;const{data:y,target:S}=g,{value:b,selectionStart:x,selectionEnd:w}=S;let _=x,E=w;switch(g.inputType){case"deleteWordBackward":{const M=b.substring(0,x).match(/\w*[^\w]*$/);M&&(_-=M[0].length);break}case"deleteWordForward":{const M=b.substring(x).match(/^[^\w]*\w*/);M&&(E+=M[0].length);break}case"deleteContentBackward":x===w&&(_-=1);break;case"deleteContentForward":x===w&&(E+=1);break}g.preventDefault(),(v=this.linkService.eventBus)==null||v.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:b,change:y||"",willCommit:!1,selStart:_,selEnd:E}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],g=>g.target.value)}if(d&&i.addEventListener("blur",d),this.data.comb){const f=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${f}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class hN extends Er{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class dN extends Er{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,n=this.data,s=n.id;let a=e.getValue(s,{value:n.exportValue===n.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",e.setValue(s,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return wr.add(i),i.setAttribute("data-element-id",s),i.disabled=n.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=n.fieldName,a&&i.setAttribute("checked",!0),i.setAttribute("exportValue",n.exportValue),i.tabIndex=Zu,i.addEventListener("change",r=>{const{name:l,checked:c}=r.target;for(const u of this._getElementsByName(l,s)){const h=c&&u.exportValue===n.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(s,{value:c})}),i.addEventListener("resetform",r=>{const l=n.defaultFieldValue||"Off";r.target.checked=l===n.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",r=>{const l={value(c){c.target.checked=c.detail.value!=="Off",e.setValue(s,{value:c.target.checked})}};this._dispatchEventFromSandbox(l,r)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],r=>r.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class lA extends Er{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,n=this.data,s=n.id;let a=e.getValue(s,{value:n.fieldValue===n.buttonValue}).value;if(typeof a=="string"&&(a=a!==n.buttonValue,e.setValue(s,{value:a})),a)for(const r of this._getElementsByName(n.fieldName,s))e.setValue(r.id,{value:!1});const i=document.createElement("input");if(wr.add(i),i.setAttribute("data-element-id",s),i.disabled=n.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=n.fieldName,a&&i.setAttribute("checked",!0),i.tabIndex=Zu,i.addEventListener("change",r=>{const{name:l,checked:c}=r.target;for(const u of this._getElementsByName(l,s))e.setValue(u.id,{value:!1});e.setValue(s,{value:c})}),i.addEventListener("resetform",r=>{const l=n.defaultFieldValue;r.target.checked=l!=null&&l===n.buttonValue}),this.enableScripting&&this.hasJSActions){const r=n.buttonValue;i.addEventListener("updatefromsandbox",l=>{const c={value:u=>{const h=r===u.detail.value;for(const d of this._getElementsByName(u.target.name)){const f=h&&d.id===s;d.domElement&&(d.domElement.checked=f),e.setValue(d.id,{value:f})}}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class fN extends oA{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const n=e.lastChild;return this.enableScripting&&this.hasJSActions&&n&&(this._setDefaultPropertiesFromJS(n),n.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),e}}class pN extends Er{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,n=this.data.id,s=e.getValue(n,{value:this.data.fieldValue}),a=document.createElement("select");wr.add(a),a.setAttribute("data-element-id",n),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=Zu;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",h=>{const d=this.data.defaultFieldValue;for(const f of a.options)f.selected=f.value===d});for(const h of this.data.options){const d=document.createElement("option");d.textContent=h.displayValue,d.value=h.exportValue,s.value.includes(h.exportValue)&&(d.setAttribute("selected",!0),i=!1),a.append(d)}let r=null;if(i){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),a.prepend(h),r=()=>{h.remove(),a.removeEventListener("input",r),r=null},a.addEventListener("input",r)}const l=h=>{const d=h?"value":"textContent",{options:f,multiple:g}=a;return g?Array.prototype.filter.call(f,v=>v.selected).map(v=>v[d]):f.selectedIndex===-1?null:f[f.selectedIndex][d]};let c=l(!1);const u=h=>{const d=h.target.options;return Array.prototype.map.call(d,f=>({displayValue:f.textContent,exportValue:f.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",h=>{const d={value(f){r==null||r();const g=f.detail.value,v=new Set(Array.isArray(g)?g:[g]);for(const y of a.options)y.selected=v.has(y.value);e.setValue(n,{value:l(!0)}),c=l(!1)},multipleSelection(f){a.multiple=!0},remove(f){const g=a.options,v=f.detail.remove;g[v].selected=!1,a.remove(v),g.length>0&&Array.prototype.findIndex.call(g,y=>y.selected)===-1&&(g[0].selected=!0),e.setValue(n,{value:l(!0),items:u(f)}),c=l(!1)},clear(f){for(;a.length!==0;)a.remove(0);e.setValue(n,{value:null,items:[]}),c=l(!1)},insert(f){const{index:g,displayValue:v,exportValue:y}=f.detail.insert,S=a.children[g],b=document.createElement("option");b.textContent=v,b.value=y,S?S.before(b):a.append(b),e.setValue(n,{value:l(!0),items:u(f)}),c=l(!1)},items(f){const{items:g}=f.detail;for(;a.length!==0;)a.remove(0);for(const v of g){const{displayValue:y,exportValue:S}=v,b=document.createElement("option");b.textContent=y,b.value=S,a.append(b)}a.options.length>0&&(a.options[0].selected=!0),e.setValue(n,{value:l(!0),items:u(f)}),c=l(!1)},indices(f){const g=new Set(f.detail.indices);for(const v of f.target.options)v.selected=g.has(v.index);e.setValue(n,{value:l(!0)}),c=l(!1)},editable(f){f.target.disabled=!f.detail.editable}};this._dispatchEventFromSandbox(d,h)}),a.addEventListener("input",h=>{var d;const f=l(!0),g=l(!1);e.setValue(n,{value:f}),h.preventDefault(),(d=this.linkService.eventBus)==null||d.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n,name:"Keystroke",value:c,change:g,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):a.addEventListener("input",function(h){e.setValue(n,{value:l(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class kv extends Je{constructor(e){const{data:n,elements:s}=e;super(e,{isRenderable:Je._hasPopupData(n)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new gN({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),n=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${Qb}${s}`).join(",")),this.container}}var iu,Av,Sv,ru,eo,Oe,Ra,xc,Zf,ep,ou,_a,hs,Va,tp,Ga,kd,Fi,to,Ye,Ad,Tg,i0,cA,uA,r0,np,sp,_v;class gN{constructor({container:e,color:n,elements:s,titleObj:a,modificationDate:i,contentsObj:r,richText:l,parent:c,rect:u,parentRect:h,open:d}){k(this,Ye),k(this,iu,A(this,Ye,uA).bind(this)),k(this,Av,A(this,Ye,_v).bind(this)),k(this,Sv,A(this,Ye,sp).bind(this)),k(this,ru,A(this,Ye,np).bind(this)),k(this,eo,null),k(this,Oe,null),k(this,Ra,null),k(this,xc,null),k(this,Zf,null),k(this,ep,null),k(this,ou,null),k(this,_a,!1),k(this,hs,null),k(this,Va,null),k(this,tp,null),k(this,Ga,null),k(this,kd,null),k(this,Fi,null),k(this,to,!1);var f;m(this,Oe,e),m(this,kd,a),m(this,Ra,r),m(this,Ga,l),m(this,ep,c),m(this,eo,n),m(this,tp,u),m(this,ou,h),m(this,Zf,s),m(this,xc,ey.toDateObject(i)),this.trigger=s.flatMap(g=>g.getElementsToTriggerPopup());for(const g of this.trigger)g.addEventListener("click",o(this,ru)),g.addEventListener("mouseenter",o(this,Sv)),g.addEventListener("mouseleave",o(this,Av)),g.classList.add("popupTriggerArea");for(const g of s)(f=g.container)==null||f.addEventListener("keydown",o(this,iu));o(this,Oe).hidden=!0,d&&A(this,Ye,np).call(this)}render(){if(o(this,hs))return;const e=m(this,hs,document.createElement("div"));if(e.className="popup",o(this,eo)){const i=e.style.outlineColor=$.makeHexColor(...o(this,eo));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`:e.style.backgroundColor=$.makeHexColor(...o(this,eo).map(r=>Math.floor(.7*(255-r)+r)))}const n=document.createElement("span");n.className="header";const s=document.createElement("h1");if(n.append(s),{dir:s.dir,str:s.textContent}=o(this,kd),e.append(n),o(this,xc)){const i=document.createElement("span");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:o(this,xc).valueOf()})),n.append(i)}const a=o(this,Ye,Ad);if(a)sA.render({xfaHtml:a,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(o(this,Ra));e.append(i)}o(this,Oe).append(e)}_formatContents({str:e,dir:n}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=n;const a=e.split(/(?:\r\n?|\n)/);for(let i=0,r=a.length;i<r;++i){const l=a[i];s.append(document.createTextNode(l)),i<r-1&&s.append(document.createElement("br"))}return s}updateEdited({rect:e,popupContent:n}){var s;o(this,Fi)||m(this,Fi,{contentsObj:o(this,Ra),richText:o(this,Ga)}),e&&m(this,Va,null),n&&(m(this,Ga,A(this,Ye,cA).call(this,n)),m(this,Ra,null)),(s=o(this,hs))==null||s.remove(),m(this,hs,null)}resetEdited(){var e;o(this,Fi)&&({contentsObj:Jt(this,Ra)._,richText:Jt(this,Ga)._}=o(this,Fi),m(this,Fi,null),(e=o(this,hs))==null||e.remove(),m(this,hs,null),m(this,Va,null))}forceHide(){m(this,to,this.isVisible),o(this,to)&&(o(this,Oe).hidden=!0)}maybeShow(){o(this,to)&&(o(this,hs)||A(this,Ye,sp).call(this),m(this,to,!1),o(this,Oe).hidden=!1)}get isVisible(){return o(this,Oe).hidden===!1}}iu=new WeakMap,Av=new WeakMap,Sv=new WeakMap,ru=new WeakMap,eo=new WeakMap,Oe=new WeakMap,Ra=new WeakMap,xc=new WeakMap,Zf=new WeakMap,ep=new WeakMap,ou=new WeakMap,_a=new WeakMap,hs=new WeakMap,Va=new WeakMap,tp=new WeakMap,Ga=new WeakMap,kd=new WeakMap,Fi=new WeakMap,to=new WeakMap,Ye=new WeakSet,Ad=function(){const t=o(this,Ga),e=o(this,Ra);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&o(this,Ga).html||null},Tg=function(){var t,e,n;return((n=(e=(t=o(this,Ye,Ad))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},i0=function(){var t,e,n;return((n=(e=(t=o(this,Ye,Ad))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},cA=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:o(this,Ye,i0),fontSize:o(this,Ye,Tg)?`calc(${o(this,Ye,Tg)}px * var(--scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:s});return n},uA=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&o(this,_a))&&A(this,Ye,np).call(this)},r0=function(){if(o(this,Va)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:s,pageY:a}}}=o(this,ep);let i=!!o(this,ou),r=i?o(this,ou):o(this,tp);for(const f of o(this,Zf))if(!r||$.intersect(f.data.rect,r)!==null){r=f.data.rect,i=!0;break}const l=$.normalizeRect([r[0],t[3]-r[1]+t[1],r[2],t[3]-r[3]+t[1]]),c=i?r[2]-r[0]+5:0,u=l[0]+c,h=l[1];m(this,Va,[100*(u-s)/e,100*(h-a)/n]);const{style:d}=o(this,Oe);d.left=`${o(this,Va)[0]}%`,d.top=`${o(this,Va)[1]}%`},np=function(){m(this,_a,!o(this,_a)),o(this,_a)?(A(this,Ye,sp).call(this),o(this,Oe).addEventListener("click",o(this,ru)),o(this,Oe).addEventListener("keydown",o(this,iu))):(A(this,Ye,_v).call(this),o(this,Oe).removeEventListener("click",o(this,ru)),o(this,Oe).removeEventListener("keydown",o(this,iu)))},sp=function(){o(this,hs)||this.render(),this.isVisible?o(this,_a)&&o(this,Oe).classList.add("focused"):(A(this,Ye,r0).call(this),o(this,Oe).hidden=!1,o(this,Oe).style.zIndex=parseInt(o(this,Oe).style.zIndex)+1e3)},_v=function(){o(this,Oe).classList.remove("focused"),!(o(this,_a)||!this.isVisible)&&(o(this,Oe).hidden=!0,o(this,Oe).style.zIndex=parseInt(o(this,Oe).style.zIndex)-1e3)};class hA extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=J.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const n of this.textContent){const s=document.createElement("span");s.textContent=n,e.append(s)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Sd;class mN extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),k(this,Sd,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:n,height:s}=gi(e.rect),a=this.svgFactory.create(n,s,!0),i=m(this,Sd,this.svgFactory.createElement("svg:line"));return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),i.setAttribute("fill","transparent"),a.append(i),this.container.append(a),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,Sd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Sd=new WeakMap;var _d;class vN extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),k(this,_d,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:n,height:s}=gi(e.rect),a=this.svgFactory.create(n,s,!0),i=e.borderStyle.width,r=m(this,_d,this.svgFactory.createElement("svg:rect"));return r.setAttribute("x",i/2),r.setAttribute("y",i/2),r.setAttribute("width",n-i),r.setAttribute("height",s-i),r.setAttribute("stroke-width",i||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),a.append(r),this.container.append(a),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,_d)}addHighlightArea(){this.container.classList.add("highlightArea")}}_d=new WeakMap;var Ed;class bN extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),k(this,Ed,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:n,height:s}=gi(e.rect),a=this.svgFactory.create(n,s,!0),i=e.borderStyle.width,r=m(this,Ed,this.svgFactory.createElement("svg:ellipse"));return r.setAttribute("cx",n/2),r.setAttribute("cy",s/2),r.setAttribute("rx",n/2-i/2),r.setAttribute("ry",s/2-i/2),r.setAttribute("stroke-width",i||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),a.append(r),this.container.append(a),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,Ed)}addHighlightArea(){this.container.classList.add("highlightArea")}}Ed=new WeakMap;var Cd;class dA extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),k(this,Cd,null),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:s,popupRef:a}}=this;if(!n)return this.container;const{width:i,height:r}=gi(e),l=this.svgFactory.create(i,r,!0);let c=[];for(let h=0,d=n.length;h<d;h+=2){const f=n[h]-e[0],g=e[3]-n[h+1];c.push(`${f},${g}`)}c=c.join(" ");const u=m(this,Cd,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",s.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!a&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return o(this,Cd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Cd=new WeakMap;class yN extends dA{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class wN extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Md,no,Nd,Ev;class ry extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),k(this,Nd),k(this,Md,null),k(this,no,[]),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?J.HIGHLIGHT:J.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:n,inkLists:s,borderStyle:a,popupRef:i}}=this,{transform:r,width:l,height:c}=A(this,Nd,Ev).call(this,n,e),u=this.svgFactory.create(l,c,!0),h=m(this,Md,this.svgFactory.createElement("svg:g"));u.append(h),h.setAttribute("stroke-width",a.width||1),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.setAttribute("stroke-miterlimit",10),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),h.setAttribute("transform",r);for(let d=0,f=s.length;d<f;d++){const g=this.svgFactory.createElement(this.svgElementName);o(this,no).push(g),g.setAttribute("points",s[d].join(",")),h.append(g)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:n,points:s,rect:a}=e,i=o(this,Md);if(n>=0&&i.setAttribute("stroke-width",n||1),s)for(let r=0,l=o(this,no).length;r<l;r++)o(this,no)[r].setAttribute("points",s[r].join(","));if(a){const{transform:r,width:l,height:c}=A(this,Nd,Ev).call(this,this.data.rotation,a);i.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),i.setAttribute("transform",r)}}getElementsToTriggerPopup(){return o(this,no)}addHighlightArea(){this.container.classList.add("highlightArea")}}Md=new WeakMap,no=new WeakMap,Nd=new WeakSet,Ev=function(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}};class fA extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=J.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class xN extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class kN extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class AN extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class pA extends Je{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=J.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Pd,Td,Cv;class SN extends Je{constructor(e){var n;super(e,{isRenderable:!0}),k(this,Td),k(this,Pd,null);const{file:s}=this.data;this.filename=s.filename,this.content=s.content,(n=this.linkService.eventBus)==null||n.dispatch("fileattachmentannotation",{source:this,...s})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let s;n.hasAppearance||n.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),s.addEventListener("dblclick",A(this,Td,Cv).bind(this)),m(this,Pd,s);const{isMac:a}=Wt.platform;return e.addEventListener("keydown",i=>{i.key==="Enter"&&(a?i.metaKey:i.ctrlKey)&&A(this,Td,Cv).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),e.append(s),e}getElementsToTriggerPopup(){return o(this,Pd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Pd=new WeakMap,Td=new WeakSet,Cv=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var ap,Io,so,ip,kc,gA,Mv;class _N{constructor({div:e,accessibilityManager:n,annotationCanvasMap:s,annotationEditorUIManager:a,page:i,viewport:r,structTreeLayer:l}){k(this,kc),k(this,ap,null),k(this,Io,null),k(this,so,new Map),k(this,ip,null),this.div=e,m(this,ap,n),m(this,Io,s),m(this,ip,l||null),this.page=i,this.viewport=r,this.zIndex=0,this._annotationEditorUIManager=a}hasEditableAnnotations(){return o(this,so).size>0}async render(e){var n;const{annotations:s}=e,a=this.div;yr(a,this.viewport);const i=new Map,r={data:null,layer:a,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new iy,annotationStorage:e.annotationStorage||new sy,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of s){if(l.noHTML)continue;const c=l.annotationType===Ge.POPUP;if(c){const d=i.get(l.id);if(!d)continue;r.elements=d}else{const{width:d,height:f}=gi(l.rect);if(d<=0||f<=0)continue}r.data=l;const u=oN.create(r);if(!u.isRenderable)continue;if(!c&&l.popupRef){const d=i.get(l.popupRef);d?d.push(u):i.set(l.popupRef,[u])}const h=u.render();l.hidden&&(h.style.visibility="hidden"),await A(this,kc,gA).call(this,h,l.id),u._isEditable&&(o(this,so).set(u.data.id,u),(n=this._annotationEditorUIManager)==null||n.renderAnnotationElement(u))}A(this,kc,Mv).call(this)}update({viewport:e}){const n=this.div;this.viewport=e,yr(n,{rotation:e.rotation}),A(this,kc,Mv).call(this),n.hidden=!1}getEditableAnnotations(){return Array.from(o(this,so).values())}getEditableAnnotation(e){return o(this,so).get(e)}}ap=new WeakMap,Io=new WeakMap,so=new WeakMap,ip=new WeakMap,kc=new WeakSet,gA=async function(t,e){var n,s;const a=t.firstChild||t,i=a.id=`${Qb}${e}`,r=await((n=o(this,ip))==null?void 0:n.getAriaAttributes(i));if(r)for(const[l,c]of r)a.setAttribute(l,c);this.div.append(t),(s=o(this,ap))==null||s.moveElementInDOM(this.div,t,a,!1)},Mv=function(){if(!o(this,Io))return;const t=this.div;for(const[e,n]of o(this,Io)){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(n):a.classList.contains("annotationContent")?a.after(n):a.before(n):s.append(n)}o(this,Io).clear()};const Ld=/\r\n?|\n/g;var ys,Cn,Rd,ao,Mn,sn,mA,vA,bA,rp,lr,op,Id,yA,Nv,wA;const Fs=class rt extends ze{constructor(e){super({...e,name:"freeTextEditor"}),k(this,sn),k(this,ys),k(this,Cn,""),k(this,Rd,`${this.id}-editor`),k(this,ao,null),k(this,Mn),m(this,ys,e.color||rt._defaultColor||ze._defaultLineColor),m(this,Mn,e.fontSize||rt._defaultFontSize)}static get _keyboardManager(){const e=rt.prototype,n=i=>i.isEmpty(),s=Uu.TRANSLATE_SMALL,a=Uu.TRANSLATE_BIG;return ee(this,"_keyboardManager",new Ju([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-a,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[s,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[a,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-a],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,s],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,a],checker:n}]]))}static initialize(e,n){ze.initialize(e,n);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case ae.FREETEXT_SIZE:rt._defaultFontSize=n;break;case ae.FREETEXT_COLOR:rt._defaultColor=n;break}}updateParams(e,n){switch(e){case ae.FREETEXT_SIZE:A(this,sn,mA).call(this,n);break;case ae.FREETEXT_COLOR:A(this,sn,vA).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[ae.FREETEXT_SIZE,rt._defaultFontSize],[ae.FREETEXT_COLOR,rt._defaultColor||ze._defaultLineColor]]}get propertiesToUpdate(){return[[ae.FREETEXT_SIZE,o(this,Mn)],[ae.FREETEXT_COLOR,o(this,ys)]]}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-rt._internalPadding*e,-(rt._internalPadding+o(this,Mn))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(J.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),m(this,ao,new AbortController);const e=this._uiManager.combinedSignal(o(this,ao));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",o(this,Rd)),this._isDraggable=!0,(e=o(this,ao))==null||e.abort(),m(this,ao,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var n;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=o(this,Cn),n=m(this,Cn,A(this,sn,bA).call(this).trimEnd());if(e===n)return;const s=a=>{if(m(this,Cn,a),!a){this.remove();return}A(this,sn,Id).call(this),this._uiManager.rebuild(this),A(this,sn,rp).call(this)};this.addCommands({cmd:()=>{s(n)},undo:()=>{s(e)},mustExec:!1}),A(this,sn,rp).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){rt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,n;this.width&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",o(this,Rd)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${o(this,Mn)}px * var(--scale-factor))`,s.color=o(this,ys),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Lf(this,this.div,["dblclick","keydown"]),this.width){const[a,i]=this.parentDimensions;if(this.annotationElementId){const{position:r}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,h]=this.pageDimensions,[d,f]=this.pageTranslation;let g,v;switch(this.rotation){case 0:g=e+(r[0]-d)/u,v=n+this.height-(r[1]-f)/h;break;case 90:g=e+(r[0]-d)/u,v=n-(r[1]-f)/h,[l,c]=[c,-l];break;case 180:g=e-this.width+(r[0]-d)/u,v=n-(r[1]-f)/h,[l,c]=[-l,-c];break;case 270:g=e+(r[0]-d-this.height*h)/u,v=n+(r[1]-f-this.width*u)/h,[l,c]=[-c,l];break}this.setAt(g*a,v*i,l,c)}else this.setAt(e*a,n*i,this.width*a,this.height*i);A(this,sn,Id).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var n,s,a;const i=e.clipboardData||window.clipboardData,{types:r}=i;if(r.length===1&&r[0]==="text/plain")return;e.preventDefault();const l=A(n=rt,lr,Nv).call(n,i.getData("text")||"").replaceAll(Ld,`
`);if(!l)return;const c=window.getSelection();if(!c.rangeCount)return;this.editorDiv.normalize(),c.deleteFromDocument();const u=c.getRangeAt(0);if(!l.includes(`
`)){u.insertNode(document.createTextNode(l)),this.editorDiv.normalize(),c.collapseToStart();return}const{startContainer:h,startOffset:d}=u,f=[],g=[];if(h.nodeType===Node.TEXT_NODE){const S=h.parentElement;if(g.push(h.nodeValue.slice(d).replaceAll(Ld,"")),S!==this.editorDiv){let b=f;for(const x of this.editorDiv.childNodes){if(x===S){b=g;continue}b.push(A(s=rt,lr,op).call(s,x))}}f.push(h.nodeValue.slice(0,d).replaceAll(Ld,""))}else if(h===this.editorDiv){let S=f,b=0;for(const x of this.editorDiv.childNodes)b++===d&&(S=g),S.push(A(a=rt,lr,op).call(a,x))}m(this,Cn,`${f.join(`
`)}${l}${g.join(`
`)}`),A(this,sn,Id).call(this);const v=new Range;let y=f.reduce((S,b)=>S+b.length,0);for(const{firstChild:S}of this.editorDiv.childNodes)if(S.nodeType===Node.TEXT_NODE){const b=S.nodeValue.length;if(y<=b){v.setStart(S,y),v.setEnd(S,y);break}y-=b}c.removeAllRanges(),c.addRange(v)}get contentDiv(){return this.editorDiv}static async deserialize(e,n,s){var a;let i=null;if(e instanceof hA){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:u,rotation:h,id:d,popupRef:f},textContent:g,textPosition:v,parent:{page:{pageNumber:y}}}=e;if(!g||g.length===0)return null;i=e={annotationType:J.FREETEXT,color:Array.from(c),fontSize:l,value:g.join(`
`),position:v,pageIndex:y-1,rect:u.slice(0),rotation:h,id:d,deleted:!1,popupRef:f}}const r=await super.deserialize(e,n,s);return m(r,Mn,e.fontSize),m(r,ys,$.makeHexColor(...e.color)),m(r,Cn,A(a=rt,lr,Nv).call(a,e.value)),r.annotationElementId=e.id||null,r._initialData=i,r}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=rt._internalPadding*this.parentScale,s=this.getRect(n,n),a=ze._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:o(this,ys)),i={annotationType:J.FREETEXT,color:a,fontSize:o(this,Mn),value:A(this,sn,yA).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?i:this.annotationElementId&&!A(this,sn,wA).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e);if(this.deleted)return n;const{style:s}=n;s.fontSize=`calc(${o(this,Mn)}px * var(--scale-factor))`,s.color=o(this,ys),n.replaceChildren();for(const i of o(this,Cn).split(`
`)){const r=document.createElement("div");r.append(i?document.createTextNode(i):document.createElement("br")),n.append(r)}const a=rt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(a,a),popupContent:o(this,Cn)}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};ys=new WeakMap,Cn=new WeakMap,Rd=new WeakMap,ao=new WeakMap,Mn=new WeakMap,sn=new WeakSet,mA=function(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-o(this,Mn))*this.parentScale),m(this,Mn,s),A(this,sn,rp).call(this)},n=o(this,Mn);this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},vA=function(t){const e=s=>{m(this,ys,this.editorDiv.style.color=s)},n=o(this,ys);this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},bA=function(){var t;const e=[];this.editorDiv.normalize();let n=null;for(const s of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(A(t=Fs,lr,op).call(t,s)),n=s);return e.join(`
`)},rp=function(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,i=a.style.display,r=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),n=a.getBoundingClientRect(),a.remove(),a.style.display=i,a.classList.toggle("hidden",r)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()},lr=new WeakSet,op=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Ld,"")},Id=function(){if(this.editorDiv.replaceChildren(),!!o(this,Cn))for(const t of o(this,Cn).split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}},yA=function(){return o(this,Cn).replaceAll(""," ")},Nv=function(t){return t.replaceAll(" ","")},wA=function(t){const{value:e,fontSize:n,color:s,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some((i,r)=>i!==s[r])||t.pageIndex!==a},k(Fs,lr),X(Fs,"_freeTextDefaultContent",""),X(Fs,"_internalPadding",0),X(Fs,"_defaultColor",null),X(Fs,"_defaultFontSize",10),X(Fs,"_type","freetext"),X(Fs,"_editorType",J.FREETEXT);let EN=Fs;class O{toSVGPath(){ye("Abstract method `toSVGPath` must be implemented.")}get box(){ye("Abstract getter `box` must be implemented.")}serialize(e,n){ye("Abstract method `serialize` must be implemented.")}static _rescale(e,n,s,a,i,r){r||(r=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)r[l]=n+e[l]*a,r[l+1]=s+e[l+1]*i;return r}static _rescaleAndSwap(e,n,s,a,i,r){r||(r=new Float32Array(e.length));for(let l=0,c=e.length;l<c;l+=2)r[l]=n+e[l+1]*a,r[l+1]=s+e[l]*i;return r}static _translate(e,n,s,a){a||(a=new Float32Array(e.length));for(let i=0,r=e.length;i<r;i+=2)a[i]=n+e[i],a[i+1]=s+e[i+1];return a}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,n,s,a,i){switch(i){case 90:return[1-n/s,e/a];case 180:return[1-e/s,1-n/a];case 270:return[n/s,1-e/a];default:return[e/s,n/a]}}static _normalizePagePoint(e,n,s){switch(s){case 90:return[1-n,e];case 180:return[1-e,1-n];case 270:return[n,1-e];default:return[e,n]}}static createBezierPoints(e,n,s,a,i,r){return[(e+5*s)/6,(n+5*a)/6,(5*s+i)/6,(5*a+r)/6,(s+i)/2,(a+r)/2]}}X(O,"PRECISION",1e-4);var Nn,ws,lu,cu,Os,te,el,tl,Dd,jd,uu,Ac,Oi,Fd,Lg,Pv,Pn,Ll,xA,kA,AA,SA,_A,EA;const io=class Tv{constructor({x:e,y:n},s,a,i,r,l=0){k(this,Pn),k(this,Nn),k(this,ws,[]),k(this,lu),k(this,cu),k(this,Os,[]),k(this,te,new Float32Array(18)),k(this,el),k(this,tl),k(this,Dd),k(this,jd),k(this,uu),k(this,Ac),k(this,Oi,[]),m(this,Nn,s),m(this,Ac,i*a),m(this,cu,r),o(this,te).set([NaN,NaN,NaN,NaN,e,n],6),m(this,lu,l),m(this,jd,o(Tv,Fd)*a),m(this,Dd,o(Tv,Pv)*a),m(this,uu,a),o(this,Oi).push(e,n)}isEmpty(){return isNaN(o(this,te)[8])}add({x:e,y:n}){var s;m(this,el,e),m(this,tl,n);const[a,i,r,l]=o(this,Nn);let[c,u,h,d]=o(this,te).subarray(8,12);const f=e-h,g=n-d,v=Math.hypot(f,g);if(v<o(this,Dd))return!1;const y=v-o(this,jd),S=y/v,b=S*f,x=S*g;let w=c,_=u;c=h,u=d,h+=b,d+=x,(s=o(this,Oi))==null||s.push(e,n);const E=-x/y,M=b/y,N=E*o(this,Ac),P=M*o(this,Ac);return o(this,te).set(o(this,te).subarray(2,8),0),o(this,te).set([h+N,d+P],4),o(this,te).set(o(this,te).subarray(14,18),12),o(this,te).set([h-N,d-P],16),isNaN(o(this,te)[6])?(o(this,Os).length===0&&(o(this,te).set([c+N,u+P],2),o(this,Os).push(NaN,NaN,NaN,NaN,(c+N-a)/r,(u+P-i)/l),o(this,te).set([c-N,u-P],14),o(this,ws).push(NaN,NaN,NaN,NaN,(c-N-a)/r,(u-P-i)/l)),o(this,te).set([w,_,c,u,h,d],6),!this.isEmpty()):(o(this,te).set([w,_,c,u,h,d],6),Math.abs(Math.atan2(_-u,w-c)-Math.atan2(x,b))<Math.PI/2?([c,u,h,d]=o(this,te).subarray(2,6),o(this,Os).push(NaN,NaN,NaN,NaN,((c+h)/2-a)/r,((u+d)/2-i)/l),[c,u,w,_]=o(this,te).subarray(14,18),o(this,ws).push(NaN,NaN,NaN,NaN,((w+c)/2-a)/r,((_+u)/2-i)/l),!0):([w,_,c,u,h,d]=o(this,te).subarray(0,6),o(this,Os).push(((w+5*c)/6-a)/r,((_+5*u)/6-i)/l,((5*c+h)/6-a)/r,((5*u+d)/6-i)/l,((c+h)/2-a)/r,((u+d)/2-i)/l),[h,d,c,u,w,_]=o(this,te).subarray(12,18),o(this,ws).push(((w+5*c)/6-a)/r,((_+5*u)/6-i)/l,((5*c+h)/6-a)/r,((5*u+d)/6-i)/l,((c+h)/2-a)/r,((u+d)/2-i)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=o(this,Os),n=o(this,ws);if(isNaN(o(this,te)[6])&&!this.isEmpty())return A(this,Pn,xA).call(this);const s=[];s.push(`M${e[4]} ${e[5]}`);for(let a=6;a<e.length;a+=6)isNaN(e[a])?s.push(`L${e[a+4]} ${e[a+5]}`):s.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);A(this,Pn,AA).call(this,s);for(let a=n.length-6;a>=6;a-=6)isNaN(n[a])?s.push(`L${n[a+4]} ${n[a+5]}`):s.push(`C${n[a]} ${n[a+1]} ${n[a+2]} ${n[a+3]} ${n[a+4]} ${n[a+5]}`);return A(this,Pn,kA).call(this,s),s.join(" ")}newFreeDrawOutline(e,n,s,a,i,r){return new NA(e,n,s,a,i,r)}getOutlines(){var e;const n=o(this,Os),s=o(this,ws),a=o(this,te),[i,r,l,c]=o(this,Nn),u=new Float32Array((((e=o(this,Oi))==null?void 0:e.length)??0)+2);for(let f=0,g=u.length-2;f<g;f+=2)u[f]=(o(this,Oi)[f]-i)/l,u[f+1]=(o(this,Oi)[f+1]-r)/c;if(u[u.length-2]=(o(this,el)-i)/l,u[u.length-1]=(o(this,tl)-r)/c,isNaN(a[6])&&!this.isEmpty())return A(this,Pn,SA).call(this,u);const h=new Float32Array(o(this,Os).length+24+o(this,ws).length);let d=n.length;for(let f=0;f<d;f+=2){if(isNaN(n[f])){h[f]=h[f+1]=NaN;continue}h[f]=n[f],h[f+1]=n[f+1]}d=A(this,Pn,EA).call(this,h,d);for(let f=s.length-6;f>=6;f-=6)for(let g=0;g<6;g+=2){if(isNaN(s[f+g])){h[d]=h[d+1]=NaN,d+=2;continue}h[d]=s[f+g],h[d+1]=s[f+g+1],d+=2}return A(this,Pn,_A).call(this,h,d),this.newFreeDrawOutline(h,u,o(this,Nn),o(this,uu),o(this,lu),o(this,cu))}};Nn=new WeakMap,ws=new WeakMap,lu=new WeakMap,cu=new WeakMap,Os=new WeakMap,te=new WeakMap,el=new WeakMap,tl=new WeakMap,Dd=new WeakMap,jd=new WeakMap,uu=new WeakMap,Ac=new WeakMap,Oi=new WeakMap,Fd=new WeakMap,Lg=new WeakMap,Pv=new WeakMap,Pn=new WeakSet,Ll=function(){const t=o(this,te).subarray(4,6),e=o(this,te).subarray(16,18),[n,s,a,i]=o(this,Nn);return[(o(this,el)+(t[0]-e[0])/2-n)/a,(o(this,tl)+(t[1]-e[1])/2-s)/i,(o(this,el)+(e[0]-t[0])/2-n)/a,(o(this,tl)+(e[1]-t[1])/2-s)/i]},xA=function(){const[t,e,n,s]=o(this,Nn),[a,i,r,l]=A(this,Pn,Ll).call(this);return`M${(o(this,te)[2]-t)/n} ${(o(this,te)[3]-e)/s} L${(o(this,te)[4]-t)/n} ${(o(this,te)[5]-e)/s} L${a} ${i} L${r} ${l} L${(o(this,te)[16]-t)/n} ${(o(this,te)[17]-e)/s} L${(o(this,te)[14]-t)/n} ${(o(this,te)[15]-e)/s} Z`},kA=function(t){const e=o(this,ws);t.push(`L${e[4]} ${e[5]} Z`)},AA=function(t){const[e,n,s,a]=o(this,Nn),i=o(this,te).subarray(4,6),r=o(this,te).subarray(16,18),[l,c,u,h]=A(this,Pn,Ll).call(this);t.push(`L${(i[0]-e)/s} ${(i[1]-n)/a} L${l} ${c} L${u} ${h} L${(r[0]-e)/s} ${(r[1]-n)/a}`)},SA=function(t){const e=o(this,te),[n,s,a,i]=o(this,Nn),[r,l,c,u]=A(this,Pn,Ll).call(this),h=new Float32Array(36);return h.set([NaN,NaN,NaN,NaN,(e[2]-n)/a,(e[3]-s)/i,NaN,NaN,NaN,NaN,(e[4]-n)/a,(e[5]-s)/i,NaN,NaN,NaN,NaN,r,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(e[16]-n)/a,(e[17]-s)/i,NaN,NaN,NaN,NaN,(e[14]-n)/a,(e[15]-s)/i],0),this.newFreeDrawOutline(h,t,o(this,Nn),o(this,uu),o(this,lu),o(this,cu))},_A=function(t,e){const n=o(this,ws);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},EA=function(t,e){const n=o(this,te).subarray(4,6),s=o(this,te).subarray(16,18),[a,i,r,l]=o(this,Nn),[c,u,h,d]=A(this,Pn,Ll).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-a)/r,(n[1]-i)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,(s[0]-a)/r,(s[1]-i)/l],e),e+=24},k(io,Fd,8),k(io,Lg,2),k(io,Pv,o(io,Fd)+o(io,Lg));let CA=io;var Sc,Do,qa,Od,wn,Wd,Ue,Lv,MA;class NA extends O{constructor(e,n,s,a,i,r){super(),k(this,Lv),k(this,Sc),k(this,Do,new Float32Array(4)),k(this,qa),k(this,Od),k(this,wn),k(this,Wd),k(this,Ue),m(this,Ue,e),m(this,wn,n),m(this,Sc,s),m(this,Wd,a),m(this,qa,i),m(this,Od,r),this.lastPoint=[NaN,NaN],A(this,Lv,MA).call(this,r);const[l,c,u,h]=o(this,Do);for(let d=0,f=e.length;d<f;d+=2)e[d]=(e[d]-l)/u,e[d+1]=(e[d+1]-c)/h;for(let d=0,f=n.length;d<f;d+=2)n[d]=(n[d]-l)/u,n[d+1]=(n[d+1]-c)/h}toSVGPath(){const e=[`M${o(this,Ue)[4]} ${o(this,Ue)[5]}`];for(let n=6,s=o(this,Ue).length;n<s;n+=6){if(isNaN(o(this,Ue)[n])){e.push(`L${o(this,Ue)[n+4]} ${o(this,Ue)[n+5]}`);continue}e.push(`C${o(this,Ue)[n]} ${o(this,Ue)[n+1]} ${o(this,Ue)[n+2]} ${o(this,Ue)[n+3]} ${o(this,Ue)[n+4]} ${o(this,Ue)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,s,a],i){const r=s-e,l=a-n;let c,u;switch(i){case 0:c=O._rescale(o(this,Ue),e,a,r,-l),u=O._rescale(o(this,wn),e,a,r,-l);break;case 90:c=O._rescaleAndSwap(o(this,Ue),e,n,r,l),u=O._rescaleAndSwap(o(this,wn),e,n,r,l);break;case 180:c=O._rescale(o(this,Ue),s,n,-r,l),u=O._rescale(o(this,wn),s,n,-r,l);break;case 270:c=O._rescaleAndSwap(o(this,Ue),s,a,-r,-l),u=O._rescaleAndSwap(o(this,wn),s,a,-r,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return o(this,Do)}newOutliner(e,n,s,a,i,r=0){return new CA(e,n,s,a,i,r)}getNewOutline(e,n){const[s,a,i,r]=o(this,Do),[l,c,u,h]=o(this,Sc),d=i*u,f=r*h,g=s*u+l,v=a*h+c,y=this.newOutliner({x:o(this,wn)[0]*d+g,y:o(this,wn)[1]*f+v},o(this,Sc),o(this,Wd),e,o(this,Od),n??o(this,qa));for(let S=2;S<o(this,wn).length;S+=2)y.add({x:o(this,wn)[S]*d+g,y:o(this,wn)[S+1]*f+v});return y.getOutlines()}}Sc=new WeakMap,Do=new WeakMap,qa=new WeakMap,Od=new WeakMap,wn=new WeakMap,Wd=new WeakMap,Ue=new WeakMap,Lv=new WeakSet,MA=function(t){const e=o(this,Ue);let n=e[4],s=e[5],a=n,i=s,r=n,l=s,c=n,u=s;const h=t?Math.max:Math.min;for(let f=6,g=e.length;f<g;f+=6){if(isNaN(e[f]))a=Math.min(a,e[f+4]),i=Math.min(i,e[f+5]),r=Math.max(r,e[f+4]),l=Math.max(l,e[f+5]),u<e[f+5]?(c=e[f+4],u=e[f+5]):u===e[f+5]&&(c=h(c,e[f+4]));else{const v=$.bezierBoundingBox(n,s,...e.slice(f,f+6));a=Math.min(a,v[0]),i=Math.min(i,v[1]),r=Math.max(r,v[2]),l=Math.max(l,v[3]),u<v[3]?(c=v[2],u=v[3]):u===v[3]&&(c=h(c,v[2]))}n=e[f+4],s=e[f+5]}const d=o(this,Do);d[0]=a-o(this,qa),d[1]=i-o(this,qa),d[2]=r-a+2*o(this,qa),d[3]=l-i+2*o(this,qa),this.lastPoint=[c,u]};var lp,cp,Wi,os,ks,PA,Eh,TA,LA,Rv;class Iv{constructor(e,n=0,s=0,a=!0){k(this,ks),k(this,lp),k(this,cp),k(this,Wi,[]),k(this,os,[]);let i=1/0,r=-1/0,l=1/0,c=-1/0;const u=10**-4;for(const{x:S,y:b,width:x,height:w}of e){const _=Math.floor((S-n)/u)*u,E=Math.ceil((S+x+n)/u)*u,M=Math.floor((b-n)/u)*u,N=Math.ceil((b+w+n)/u)*u,P=[_,M,N,!0],T=[E,M,N,!1];o(this,Wi).push(P,T),i=Math.min(i,_),r=Math.max(r,E),l=Math.min(l,M),c=Math.max(c,N)}const h=r-i+2*s,d=c-l+2*s,f=i-s,g=l-s,v=o(this,Wi).at(a?-1:-2),y=[v[0],v[2]];for(const S of o(this,Wi)){const[b,x,w]=S;S[0]=(b-f)/h,S[1]=(x-g)/d,S[2]=(w-g)/d}m(this,lp,new Float32Array([f,g,h,d])),m(this,cp,y)}getOutlines(){o(this,Wi).sort((n,s)=>n[0]-s[0]||n[1]-s[1]||n[2]-s[2]);const e=[];for(const n of o(this,Wi))n[3]?(e.push(...A(this,ks,Rv).call(this,n)),A(this,ks,TA).call(this,n)):(A(this,ks,LA).call(this,n),e.push(...A(this,ks,Rv).call(this,n)));return A(this,ks,PA).call(this,e)}}lp=new WeakMap,cp=new WeakMap,Wi=new WeakMap,os=new WeakMap,ks=new WeakSet,PA=function(t){const e=[],n=new Set;for(const i of t){const[r,l,c]=i;e.push([r,l,i],[r,c,i])}e.sort((i,r)=>i[1]-r[1]||i[0]-r[0]);for(let i=0,r=e.length;i<r;i+=2){const l=e[i][2],c=e[i+1][2];l.push(c),c.push(l),n.add(l),n.add(c)}const s=[];let a;for(;n.size>0;){const i=n.values().next().value;let[r,l,c,u,h]=i;n.delete(i);let d=r,f=l;for(a=[r,c],s.push(a);;){let g;if(n.has(u))g=u;else if(n.has(h))g=h;else break;n.delete(g),[r,l,c,u,h]=g,d!==r&&(a.push(d,f,r,f===l?l:c),d=r),f=f===l?c:l}a.push(d,f)}return new CN(s,o(this,lp),o(this,cp))},Eh=function(t){const e=o(this,os);let n=0,s=e.length-1;for(;n<=s;){const a=n+s>>1,i=e[a][0];if(i===t)return a;i<t?n=a+1:s=a-1}return s+1},TA=function([,t,e]){const n=A(this,ks,Eh).call(this,t);o(this,os).splice(n,0,[t,e])},LA=function([,t,e]){const n=A(this,ks,Eh).call(this,t);for(let s=n;s<o(this,os).length;s++){const[a,i]=o(this,os)[s];if(a!==t)break;if(a===t&&i===e){o(this,os).splice(s,1);return}}for(let s=n-1;s>=0;s--){const[a,i]=o(this,os)[s];if(a!==t)break;if(a===t&&i===e){o(this,os).splice(s,1);return}}},Rv=function(t){const[e,n,s]=t,a=[[e,n,s]],i=A(this,ks,Eh).call(this,s);for(let r=0;r<i;r++){const[l,c]=o(this,os)[r];for(let u=0,h=a.length;u<h;u++){const[,d,f]=a[u];if(!(c<=d||f<=l)){if(d>=l){if(f>c)a[u][1]=c;else{if(h===1)return[];a.splice(u,1),u--,h--}continue}a[u][2]=l,f>c&&a.push([e,c,f])}}}return a};var zd,_c;class CN extends O{constructor(e,n,s){super(),k(this,zd),k(this,_c),m(this,_c,e),m(this,zd,n),this.lastPoint=s}toSVGPath(){const e=[];for(const n of o(this,_c)){let[s,a]=n;e.push(`M${s} ${a}`);for(let i=2;i<n.length;i+=2){const r=n[i],l=n[i+1];r===s?(e.push(`V${l}`),a=l):l===a&&(e.push(`H${r}`),s=r)}e.push("Z")}return e.join(" ")}serialize([e,n,s,a],i){const r=[],l=s-e,c=a-n;for(const u of o(this,_c)){const h=new Array(u.length);for(let d=0;d<u.length;d+=2)h[d]=e+u[d]*l,h[d+1]=a-u[d+1]*c;r.push(h)}return r}get box(){return o(this,zd)}get classNamesForOutlining(){return["highlightOutline"]}}zd=new WeakMap,_c=new WeakMap;class Dv extends CA{newFreeDrawOutline(e,n,s,a,i,r){return new MN(e,n,s,a,i,r)}}class MN extends NA{newOutliner(e,n,s,a,i,r=0){return new Dv(e,n,s,a,i,r)}}var ds,ro,hu,et,up,Ec,$d,hp,cr,As,du,fu,Ie,jv,Fv,Ov,zi,o0,Ia;const Bd=class Ws{constructor({editor:e=null,uiManager:n=null}){k(this,Ie),k(this,ds,null),k(this,ro,null),k(this,hu),k(this,et,null),k(this,up,!1),k(this,Ec,!1),k(this,$d,null),k(this,hp),k(this,cr,null),k(this,As,null),k(this,du);var s;e?(m(this,Ec,!1),m(this,du,ae.HIGHLIGHT_COLOR),m(this,$d,e)):(m(this,Ec,!0),m(this,du,ae.HIGHLIGHT_DEFAULT_COLOR)),m(this,As,(e==null?void 0:e._uiManager)||n),m(this,hp,o(this,As)._eventBus),m(this,hu,(e==null?void 0:e.color)||((s=o(this,As))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),o(Ws,fu)||m(Ws,fu,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ee(this,"_keyboardManager",new Ju([[["Escape","mac+Escape"],Ws.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ws.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ws.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ws.prototype._moveToPrevious],[["Home","mac+Home"],Ws.prototype._moveToBeginning],[["End","mac+End"],Ws.prototype._moveToEnd]]))}renderButton(){const e=m(this,ds,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const n=o(this,As)._signal;e.addEventListener("click",A(this,Ie,zi).bind(this),{signal:n}),e.addEventListener("keydown",A(this,Ie,Ov).bind(this),{signal:n});const s=m(this,ro,document.createElement("span"));return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=o(this,hu),e.append(s),e}renderMainDropdown(){const e=m(this,et,A(this,Ie,jv).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===o(this,ds)){A(this,Ie,zi).call(this,e);return}const n=e.target.getAttribute("data-color");n&&A(this,Ie,Fv).call(this,n,e)}_moveToNext(e){var n,s;if(!o(this,Ie,Ia)){A(this,Ie,zi).call(this,e);return}if(e.target===o(this,ds)){(n=o(this,et).firstChild)==null||n.focus();return}(s=e.target.nextSibling)==null||s.focus()}_moveToPrevious(e){var n,s;if(e.target===((n=o(this,et))==null?void 0:n.firstChild)||e.target===o(this,ds)){o(this,Ie,Ia)&&this._hideDropdownFromKeyboard();return}o(this,Ie,Ia)||A(this,Ie,zi).call(this,e),(s=e.target.previousSibling)==null||s.focus()}_moveToBeginning(e){var n;if(!o(this,Ie,Ia)){A(this,Ie,zi).call(this,e);return}(n=o(this,et).firstChild)==null||n.focus()}_moveToEnd(e){var n;if(!o(this,Ie,Ia)){A(this,Ie,zi).call(this,e);return}(n=o(this,et).lastChild)==null||n.focus()}hideDropdown(){var e,n;(e=o(this,et))==null||e.classList.add("hidden"),(n=o(this,cr))==null||n.abort(),m(this,cr,null)}_hideDropdownFromKeyboard(){var e;if(!o(this,Ec)){if(!o(this,Ie,Ia)){(e=o(this,$d))==null||e.unselect();return}this.hideDropdown(),o(this,ds).focus({preventScroll:!0,focusVisible:o(this,up)})}}updateColor(e){if(o(this,ro)&&(o(this,ro).style.backgroundColor=e),!o(this,et))return;const n=o(this,As).highlightColors.values();for(const s of o(this,et).children)s.setAttribute("aria-selected",n.next().value===e)}destroy(){var e,n;(e=o(this,ds))==null||e.remove(),m(this,ds,null),m(this,ro,null),(n=o(this,et))==null||n.remove(),m(this,et,null)}};ds=new WeakMap,ro=new WeakMap,hu=new WeakMap,et=new WeakMap,up=new WeakMap,Ec=new WeakMap,$d=new WeakMap,hp=new WeakMap,cr=new WeakMap,As=new WeakMap,du=new WeakMap,fu=new WeakMap,Ie=new WeakSet,jv=function(){const t=document.createElement("div"),e=o(this,As)._signal;t.addEventListener("contextmenu",ts,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,s]of o(this,As).highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",s),a.title=n,a.setAttribute("data-l10n-id",o(Bd,fu)[n]);const i=document.createElement("span");a.append(i),i.className="swatch",i.style.backgroundColor=s,a.setAttribute("aria-selected",s===o(this,hu)),a.addEventListener("click",A(this,Ie,Fv).bind(this,s),{signal:e}),t.append(a)}return t.addEventListener("keydown",A(this,Ie,Ov).bind(this),{signal:e}),t},Fv=function(t,e){e.stopPropagation(),o(this,hp).dispatch("switchannotationeditorparams",{source:this,type:o(this,du),value:t})},Ov=function(t){Bd._keyboardManager.exec(this,t)},zi=function(t){if(o(this,Ie,Ia)){this.hideDropdown();return}if(m(this,up,t.detail===0),o(this,cr)||(m(this,cr,new AbortController),window.addEventListener("pointerdown",A(this,Ie,o0).bind(this),{signal:o(this,As).combinedSignal(o(this,cr))})),o(this,et)){o(this,et).classList.remove("hidden");return}const e=m(this,et,A(this,Ie,jv).call(this));o(this,ds).append(e)},o0=function(t){var e;(e=o(this,et))!=null&&e.contains(t.target)||this.hideDropdown()},Ia=function(){return o(this,et)&&!o(this,et).classList.contains("hidden")},k(Bd,fu,null);let RA=Bd;var pu,dp,Za,jo,gu,an,fp,pp,nl,Vn,Sn,Et,mu,ei,jt,Cc,Kn,Ud,pe,Wv,gp,IA,DA,l0,zv,$i,Zs,sl,jA,Hd,vu,FA,OA,WA,zA,$A;const Ht=class xt extends ze{constructor(e){super({...e,name:"highlightEditor"}),k(this,pe),k(this,pu,null),k(this,dp,0),k(this,Za),k(this,jo,null),k(this,gu,null),k(this,an,null),k(this,fp,null),k(this,pp,0),k(this,nl,null),k(this,Vn,null),k(this,Sn,null),k(this,Et,!1),k(this,mu,null),k(this,ei),k(this,jt,null),k(this,Cc,""),k(this,Kn),k(this,Ud,""),this.color=e.color||xt._defaultColor,m(this,Kn,e.thickness||xt._defaultThickness),m(this,ei,e.opacity||xt._defaultOpacity),m(this,Za,e.boxes||null),m(this,Ud,e.methodOfCreation||""),m(this,Cc,e.text||""),this._isDraggable=!1,e.highlightId>-1?(m(this,Et,!0),A(this,pe,gp).call(this,e),A(this,pe,$i).call(this)):o(this,Za)&&(m(this,pu,e.anchorNode),m(this,dp,e.anchorOffset),m(this,fp,e.focusNode),m(this,pp,e.focusOffset),A(this,pe,Wv).call(this),A(this,pe,$i).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=xt.prototype;return ee(this,"_keyboardManager",new Ju([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:o(this,Et)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:o(this,Kn),methodOfCreation:o(this,Ud)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var s;ze.initialize(e,n),xt._defaultColor||(xt._defaultColor=((s=n.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case ae.HIGHLIGHT_DEFAULT_COLOR:xt._defaultColor=n;break;case ae.HIGHLIGHT_THICKNESS:xt._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return o(this,mu)}updateParams(e,n){switch(e){case ae.HIGHLIGHT_COLOR:A(this,pe,IA).call(this,n);break;case ae.HIGHLIGHT_THICKNESS:A(this,pe,DA).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[ae.HIGHLIGHT_DEFAULT_COLOR,xt._defaultColor],[ae.HIGHLIGHT_THICKNESS,xt._defaultThickness]]}get propertiesToUpdate(){return[[ae.HIGHLIGHT_COLOR,this.color||xt._defaultColor],[ae.HIGHLIGHT_THICKNESS,o(this,Kn)||xt._defaultThickness],[ae.HIGHLIGHT_FREE,o(this,Et)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(m(this,gu,new RA({editor:this})),e.addColorPicker(o(this,gu))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(A(this,pe,vu).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,A(this,pe,vu).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){A(this,pe,zv).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,pe,$i).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let s=!1;this.parent&&!e?A(this,pe,zv).call(this):e&&(A(this,pe,$i).call(this,e),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),s&&this.select()}rotate(e){var n,s,a;const{drawLayer:i}=this.parent;let r;o(this,Et)?(e=(e-this.rotation+360)%360,r=A(n=xt,Zs,sl).call(n,o(this,Vn).box,e)):r=A(s=xt,Zs,sl).call(s,[this.x,this.y,this.width,this.height],e),i.updateProperties(o(this,Sn),{bbox:r,root:{"data-main-rotation":e}}),i.updateProperties(o(this,jt),{bbox:A(a=xt,Zs,sl).call(a,o(this,an).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();o(this,Cc)&&(e.setAttribute("aria-label",o(this,Cc)),e.setAttribute("role","mark")),o(this,Et)?e.classList.add("free"):this.div.addEventListener("keydown",A(this,pe,jA).bind(this),{signal:this._uiManager._signal});const n=m(this,nl,document.createElement("div"));e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=o(this,jo);const[s,a]=this.parentDimensions;return this.setDims(this.width*s,this.height*a),Lf(this,o(this,nl),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(o(this,jt),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(o(this,jt),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:A(this,pe,Hd).call(this,!0);break;case 1:case 3:A(this,pe,Hd).call(this,!1);break}}select(){var e;super.select(),o(this,jt)&&((e=this.parent)==null||e.drawLayer.updateProperties(o(this,jt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),o(this,jt)&&((e=this.parent)==null||e.drawLayer.updateProperties(o(this,jt),{rootClass:{selected:!1}}),o(this,Et)||A(this,pe,Hd).call(this,!1))}get _mustFixPosition(){return!o(this,Et)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(o(this,Sn),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(o(this,jt),{rootClass:{hidden:!e}}))}static startHighlighting(e,n,{target:s,x:a,y:i}){const{x:r,y:l,width:c,height:u}=s.getBoundingClientRect(),h=new AbortController,d=e.combinedSignal(h),f=g=>{h.abort(),A(this,Zs,zA).call(this,e,g)};window.addEventListener("blur",f,{signal:d}),window.addEventListener("pointerup",f,{signal:d}),window.addEventListener("pointerdown",un,{capture:!0,passive:!1,signal:d}),window.addEventListener("contextmenu",ts,{signal:d}),s.addEventListener("pointermove",A(this,Zs,WA).bind(this,e),{signal:d}),this._freeHighlight=new Dv({x:a,y:i},[r,l,c,u],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,n,s){var a,i,r,l;let c=null;if(e instanceof fA){const{data:{quadPoints:x,rect:w,rotation:_,id:E,color:M,opacity:N,popupRef:P},parent:{page:{pageNumber:T}}}=e;c=e={annotationType:J.HIGHLIGHT,color:Array.from(M),opacity:N,quadPoints:x,boxes:null,pageIndex:T-1,rect:w.slice(0),rotation:_,id:E,deleted:!1,popupRef:P}}else if(e instanceof ry){const{data:{inkLists:x,rect:w,rotation:_,id:E,color:M,borderStyle:{rawWidth:N},popupRef:P},parent:{page:{pageNumber:T}}}=e;c=e={annotationType:J.HIGHLIGHT,color:Array.from(M),thickness:N,inkLists:x,boxes:null,pageIndex:T-1,rect:w.slice(0),rotation:_,id:E,deleted:!1,popupRef:P}}const{color:u,quadPoints:h,inkLists:d,opacity:f}=e,g=await super.deserialize(e,n,s);g.color=$.makeHexColor(...u),m(g,ei,f||1),d&&m(g,Kn,e.thickness),g.annotationElementId=e.id||null,g._initialData=c;const[v,y]=g.pageDimensions,[S,b]=g.pageTranslation;if(h){const x=m(g,Za,[]);for(let w=0;w<h.length;w+=8)x.push({x:(h[w]-S)/v,y:1-(h[w+1]-b)/y,width:(h[w+2]-h[w])/v,height:(h[w+1]-h[w+5])/y});A(a=g,pe,Wv).call(a),A(i=g,pe,$i).call(i),g.rotate(g.rotation)}else if(d){m(g,Et,!0);const x=d[0],w={x:x[0]-S,y:y-(x[1]-b)},_=new Dv(w,[0,0,v,y],1,o(g,Kn)/2,!0,.001);for(let N=0,P=x.length;N<P;N+=2)w.x=x[N]-S,w.y=y-(x[N+1]-b),_.add(w);const{id:E,clipPathId:M}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:g.color,"fill-opacity":g._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:_.toSVGPath()}},!0,!0);A(r=g,pe,gp).call(r,{highlightOutlines:_.getOutlines(),highlightId:E,clipPathId:M}),A(l=g,pe,$i).call(l)}return g}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),s=ze._colorManager.convert(this.color),a={annotationType:J.HIGHLIGHT,color:s,opacity:o(this,ei),thickness:o(this,Kn),quadPoints:A(this,pe,FA).call(this),outlines:A(this,pe,OA).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:A(this,pe,vu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!A(this,pe,$A).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};pu=new WeakMap,dp=new WeakMap,Za=new WeakMap,jo=new WeakMap,gu=new WeakMap,an=new WeakMap,fp=new WeakMap,pp=new WeakMap,nl=new WeakMap,Vn=new WeakMap,Sn=new WeakMap,Et=new WeakMap,mu=new WeakMap,ei=new WeakMap,jt=new WeakMap,Cc=new WeakMap,Kn=new WeakMap,Ud=new WeakMap,pe=new WeakSet,Wv=function(){const t=new Iv(o(this,Za),.001);m(this,Vn,t.getOutlines()),[this.x,this.y,this.width,this.height]=o(this,Vn).box;const e=new Iv(o(this,Za),.0025,.001,this._uiManager.direction==="ltr");m(this,an,e.getOutlines());const{lastPoint:n}=o(this,an);m(this,mu,[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height])},gp=function({highlightOutlines:t,highlightId:e,clipPathId:n}){var s,a;if(m(this,Vn,t),m(this,an,t.getNewOutline(o(this,Kn)/2+1.5,.0025)),e>=0)m(this,Sn,e),m(this,jo,n),this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),m(this,jt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:o(this,an).box,path:{d:o(this,an).toSVGPath()}},!0));else if(this.parent){const h=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(o(this,Sn),{bbox:A(s=Ht,Zs,sl).call(s,o(this,Vn).box,(h-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(o(this,jt),{bbox:A(a=Ht,Zs,sl).call(a,o(this,an).box,h),path:{d:o(this,an).toSVGPath()}})}const[i,r,l,c]=t.box;switch(this.rotation){case 0:this.x=i,this.y=r,this.width=l,this.height=c;break;case 90:{const[h,d]=this.parentDimensions;this.x=r,this.y=1-i,this.width=l*d/h,this.height=c*h/d;break}case 180:this.x=1-i,this.y=1-r,this.width=l,this.height=c;break;case 270:{const[h,d]=this.parentDimensions;this.x=1-r,this.y=i,this.width=l*d/h,this.height=c*h/d;break}}const{lastPoint:u}=o(this,an);m(this,mu,[(u[0]-i)/l,(u[1]-r)/c])},IA=function(t){const e=(a,i)=>{var r,l;this.color=a,m(this,ei,i),(r=this.parent)==null||r.drawLayer.updateProperties(o(this,Sn),{root:{fill:a,"fill-opacity":i}}),(l=o(this,gu))==null||l.updateColor(a)},n=this.color,s=o(this,ei);this.addCommands({cmd:e.bind(this,t,Ht._defaultOpacity),undo:e.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},DA=function(t){const e=o(this,Kn),n=s=>{m(this,Kn,s),A(this,pe,l0).call(this,s)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ae.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},l0=function(t){if(!o(this,Et))return;A(this,pe,gp).call(this,{highlightOutlines:o(this,Vn).getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)},zv=function(){o(this,Sn)===null||!this.parent||(this.parent.drawLayer.remove(o(this,Sn)),m(this,Sn,null),this.parent.drawLayer.remove(o(this,jt)),m(this,jt,null))},$i=function(t=this.parent){o(this,Sn)===null&&({id:Jt(this,Sn)._,clipPathId:Jt(this,jo)._}=t.drawLayer.draw({bbox:o(this,Vn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":o(this,ei)},rootClass:{highlight:!0,free:o(this,Et)},path:{d:o(this,Vn).toSVGPath()}},!1,!0),m(this,jt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:o(this,Et)},bbox:o(this,an).box,path:{d:o(this,an).toSVGPath()}},o(this,Et))),o(this,nl)&&(o(this,nl).style.clipPath=o(this,jo)))},Zs=new WeakSet,sl=function([t,e,n,s],a){switch(a){case 90:return[1-e-s,t,s,n];case 180:return[1-t-n,1-e-s,n,s];case 270:return[e,1-t-n,s,n]}return[t,e,n,s]},jA=function(t){Ht._keyboardManager.exec(this,t)},Hd=function(t){if(!o(this,pu))return;const e=window.getSelection();t?e.setPosition(o(this,pu),o(this,dp)):e.setPosition(o(this,fp),o(this,pp))},vu=function(){return o(this,Et)?this.rotation:0},FA=function(){if(o(this,Et))return null;const[t,e]=this.pageDimensions,[n,s]=this.pageTranslation,a=o(this,Za),i=new Float32Array(a.length*8);let r=0;for(const{x:l,y:c,width:u,height:h}of a){const d=l*t+n,f=(1-c)*e+s;i[r]=i[r+4]=d,i[r+1]=i[r+3]=f,i[r+2]=i[r+6]=d+u*t,i[r+5]=i[r+7]=f-h*e,r+=8}return i},OA=function(t){return o(this,Vn).serialize(t,A(this,pe,vu).call(this))},WA=function(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},zA=function(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},$A=function(t){const{color:e}=this._initialData;return t.color.some((n,s)=>n!==e[s])},k(Ht,Zs),X(Ht,"_defaultColor",null),X(Ht,"_defaultOpacity",1),X(Ht,"_defaultThickness",12),X(Ht,"_type","highlight"),X(Ht,"_editorType",J.HIGHLIGHT),X(Ht,"_freeHighlightId",-1),X(Ht,"_freeHighlight",null),X(Ht,"_freeHighlightClipId","");let c0=Ht;var oo;class NN{constructor(){k(this,oo,Object.create(null))}updateProperty(e,n){this[e]=n,this.updateSVGProperty(e,n)}updateProperties(e){if(e)for(const[n,s]of Object.entries(e))this.updateProperty(n,s)}updateSVGProperty(e,n){o(this,oo)[e]=n}toSVGProperties(){const e=o(this,oo);return m(this,oo,Object.create(null)),{root:e}}reset(){m(this,oo,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){ye("Not implemented")}}oo=new WeakMap;var _n,Mc,ut,Fo,Oo,Da,ja,Fa,Wo,Ae,$v,Rg,Bv,Nc,u0,Vd,bu,lo;const xn=class q extends ze{constructor(e){super(e),k(this,Ae),k(this,_n,null),k(this,Mc),X(this,"_drawId",null),m(this,Mc,e.mustBeCommitted||!1),e.drawOutlines&&(A(this,Ae,$v).call(this,e),A(this,Ae,Nc).call(this))}static _mergeSVGProperties(e,n){const s=new Set(Object.keys(e));for(const[a,i]of Object.entries(n))s.has(a)?Object.assign(e[a],i):e[a]=i;return e}static getDefaultDrawingOptions(e){ye("Not implemented")}static get typesMap(){ye("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,n){const s=this.typesMap.get(e);s&&this._defaultDrawingOptions.updateProperty(s,n),this._currentParent&&(o(q,ut).updateProperty(s,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,n){const s=this.constructor.typesMap.get(e);s&&this._updateProperty(e,s,n)}static get defaultPropertiesToUpdate(){const e=[],n=this._defaultDrawingOptions;for(const[s,a]of this.typesMap)e.push([s,n[a]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:n}=this;for(const[s,a]of this.constructor.typesMap)e.push([s,n[a]]);return e}_updateProperty(e,n,s){const a=this._drawingOptions,i=a[n],r=l=>{var c;a.updateProperty(n,l);const u=o(this,_n).updateProperty(n,l);u&&A(this,Ae,bu).call(this,u),(c=this.parent)==null||c.drawLayer.updateProperties(this._drawId,a.toSVGProperties())};this.addCommands({cmd:r.bind(this,s),undo:r.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(o(this,_n).getPathResizingSVGProperties(A(this,Ae,Vd).call(this)),{bbox:A(this,Ae,lo).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(o(this,_n).getPathResizedSVGProperties(A(this,Ae,Vd).call(this)),{bbox:A(this,Ae,lo).call(this)}))}_onTranslating(e,n){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:A(this,Ae,lo).call(this,e,n)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties(o(this,_n).getPathTranslatedSVGProperties(A(this,Ae,Vd).call(this),this.parentDimensions),{bbox:A(this,Ae,lo).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,o(this,Mc)&&(m(this,Mc,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){A(this,Ae,Bv).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(A(this,Ae,Nc).call(this),A(this,Ae,bu).call(this,o(this,_n).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var n;let s=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),A(this,Ae,Bv).call(this)):e&&(this._uiManager.addShouldRescale(this),A(this,Ae,Nc).call(this,e),s=!this.parent&&((n=this.div)==null?void 0:n.classList.contains("selectedEditor"))),super.setParent(e),s&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,q._mergeSVGProperties({bbox:A(this,Ae,lo).call(this)},o(this,_n).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&A(this,Ae,bu).call(this,o(this,_n).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const n=document.createElement("div");e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[s,a]=this.parentDimensions;return this.setDims(this.width*s,this.height*a),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,n,s,a,i){ye("Not implemented")}static startDrawing(e,n,s,a){var i;const{target:r,offsetX:l,offsetY:c,pointerId:u,pointerType:h}=a;if(o(q,ja)&&o(q,ja)!==h)return;const{viewport:{rotation:d}}=e,{width:f,height:g}=r.getBoundingClientRect(),v=m(q,Fo,new AbortController),y=e.combinedSignal(v);if(o(q,Da)||m(q,Da,u),o(q,ja)??m(q,ja,h),window.addEventListener("pointerup",S=>{var b;o(q,Da)===S.pointerId?this._endDraw(S):(b=o(q,Fa))==null||b.delete(S.pointerId)},{signal:y}),window.addEventListener("pointercancel",S=>{var b;o(q,Da)===S.pointerId?this._currentParent.endDrawingSession():(b=o(q,Fa))==null||b.delete(S.pointerId)},{signal:y}),window.addEventListener("pointerdown",S=>{o(q,ja)===S.pointerType&&((o(q,Fa)||m(q,Fa,new Set)).add(S.pointerId),o(q,ut).isCancellable()&&(o(q,ut).removeLastElement(),o(q,ut).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",ts,{signal:y}),r.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),r.addEventListener("touchmove",S=>{S.timeStamp===o(q,Wo)&&un(S)},{signal:y}),e.toggleDrawing(),(i=n._editorUndoBar)==null||i.hide(),o(q,ut)){e.drawLayer.updateProperties(this._currentDrawId,o(q,ut).startNew(l,c,f,g,d));return}n.updateUIForDefaultProperties(this),m(q,ut,this.createDrawerInstance(l,c,f,g,d)),m(q,Oo,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(o(q,Oo).toSVGProperties(),o(q,ut).defaultSVGProperties),!0,!1)}static _drawMove(e){var n;if(m(q,Wo,-1),!o(q,ut))return;const{offsetX:s,offsetY:a,pointerId:i}=e;if(o(q,Da)===i){if(((n=o(q,Fa))==null?void 0:n.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,o(q,ut).add(s,a)),m(q,Wo,e.timeStamp),un(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,m(q,ut,null),m(q,Oo,null),m(q,ja,null),m(q,Wo,NaN)),o(q,Fo)&&(o(q,Fo).abort(),m(q,Fo,null),m(q,Da,NaN),m(q,Fa,null))}static _endDraw(e){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),e&&n.drawLayer.updateProperties(this._currentDrawId,o(q,ut).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const s=o(q,ut),a=this._currentDrawId,i=s.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(a,s.setLastElement(i))},undo:()=>{n.drawLayer.updateProperties(a,s.removeLastElement())},mustExec:!1,type:ae.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(ae.DRAW_STEP),!o(q,ut).isEmpty()){const{pageDimensions:[s,a],scale:i}=n,r=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:o(q,ut).getOutlines(s*i,a*i,i,this._INNER_MARGIN),drawingOptions:o(q,Oo),mustBeCommitted:!e});return this._cleanup(!0),r}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,n,s,a,i,r){ye("Not implemented")}static async deserialize(e,n,s){var a,i;const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:u}}=n.viewport,h=this.deserializeDraw(c,u,r,l,this._INNER_MARGIN,e),d=await super.deserialize(e,n,s);return d.createDrawingOptions(e),A(a=d,Ae,$v).call(a,{drawOutlines:h}),A(i=d,Ae,Nc).call(i),d.onScaleChanging(),d.rotate(),d}serializeDraw(e){const[n,s]=this.pageTranslation,[a,i]=this.pageDimensions;return o(this,_n).serialize([n,s,a,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};_n=new WeakMap,Mc=new WeakMap,ut=new WeakMap,Fo=new WeakMap,Oo=new WeakMap,Da=new WeakMap,ja=new WeakMap,Fa=new WeakMap,Wo=new WeakMap,Ae=new WeakSet,$v=function({drawOutlines:t,drawId:e,drawingOptions:n}){m(this,_n,t),this._drawingOptions||(this._drawingOptions=n),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=A(this,Ae,Rg).call(this,t,this.parent),A(this,Ae,bu).call(this,t.box)},Rg=function(t,e){const{id:n}=e.drawLayer.draw(xn._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n},Bv=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Nc=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=A(this,Ae,Rg).call(this,o(this,_n),t)}},u0=function([t,e,n,s]){const{parentDimensions:[a,i],rotation:r}=this;switch(r){case 90:return[e,1-t,n*(i/a),s*(a/i)];case 180:return[1-t,1-e,n,s];case 270:return[1-e,t,n*(i/a),s*(a/i)];default:return[t,e,n,s]}},Vd=function(){const{x:t,y:e,width:n,height:s,parentDimensions:[a,i],rotation:r}=this;switch(r){case 90:return[1-e,t,n*(a/i),s*(i/a)];case 180:return[1-t,1-e,n,s];case 270:return[e,1-t,n*(a/i),s*(i/a)];default:return[t,e,n,s]}},bu=function(t){if([this.x,this.y,this.width,this.height]=A(this,Ae,u0).call(this,t),this.div){this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}this._onResized()},lo=function(){const{x:t,y:e,width:n,height:s,rotation:a,parentRotation:i,parentDimensions:[r,l]}=this;switch((a*4+i)/90){case 1:return[1-e-s,t,s,n];case 2:return[1-t-n,1-e-s,n,s];case 3:return[e,1-t-n,s,n];case 4:return[t,e-n*(r/l),s*(l/r),n*(r/l)];case 5:return[1-e,t,n*(r/l),s*(l/r)];case 6:return[1-t-s*(l/r),1-e,s*(l/r),n*(r/l)];case 7:return[e-n*(r/l),1-t-s*(l/r),n*(r/l),s*(l/r)];case 8:return[t-n,e-s,n,s];case 9:return[1-e,t-n,s,n];case 10:return[1-t,1-e,n,s];case 11:return[e-s,1-t,s,n];case 12:return[t-s*(l/r),e,s*(l/r),n*(r/l)];case 13:return[1-e-n*(r/l),t-s*(l/r),n*(r/l),s*(l/r)];case 14:return[1-t,1-e-n*(r/l),s*(l/r),n*(r/l)];case 15:return[e,1-t,n*(r/l),s*(l/r)];default:return[t,e,n,s]}},X(xn,"_currentDrawId",-1),X(xn,"_currentParent",null),k(xn,ut,null),k(xn,Fo,null),k(xn,Oo,null),k(xn,Da,NaN),k(xn,ja,null),k(xn,Fa,null),k(xn,Wo,NaN),X(xn,"_INNER_MARGIN",3);let PN=xn;var zs,ot,lt,zo,Pc,Vt,ct,Un,co,$o,Bo,Tc,Gd;class TN{constructor(e,n,s,a,i,r){k(this,Tc),k(this,zs,new Float64Array(6)),k(this,ot),k(this,lt),k(this,zo),k(this,Pc),k(this,Vt),k(this,ct,""),k(this,Un,0),k(this,co,new GA),k(this,$o),k(this,Bo),m(this,$o,s),m(this,Bo,a),m(this,zo,i),m(this,Pc,r),[e,n]=A(this,Tc,Gd).call(this,e,n);const l=m(this,ot,[NaN,NaN,NaN,NaN,e,n]);m(this,Vt,[e,n]),m(this,lt,[{line:l,points:o(this,Vt)}]),o(this,zs).set(l,0)}updateProperty(e,n){e==="stroke-width"&&m(this,Pc,n)}isEmpty(){return!o(this,lt)||o(this,lt).length===0}isCancellable(){return o(this,Vt).length<=10}add(e,n){[e,n]=A(this,Tc,Gd).call(this,e,n);const[s,a,i,r]=o(this,zs).subarray(2,6),l=e-i,c=n-r;return Math.hypot(o(this,$o)*l,o(this,Bo)*c)<=2?null:(o(this,Vt).push(e,n),isNaN(s)?(o(this,zs).set([i,r,e,n],2),o(this,ot).push(NaN,NaN,NaN,NaN,e,n),{path:{d:this.toSVGPath()}}):(isNaN(o(this,zs)[0])&&o(this,ot).splice(6,6),o(this,zs).set([s,a,i,r,e,n],0),o(this,ot).push(...O.createBezierPoints(s,a,i,r,e,n)),{path:{d:this.toSVGPath()}}))}end(e,n){return this.add(e,n)||(o(this,Vt).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,n,s,a,i){m(this,$o,s),m(this,Bo,a),m(this,zo,i),[e,n]=A(this,Tc,Gd).call(this,e,n);const r=m(this,ot,[NaN,NaN,NaN,NaN,e,n]);m(this,Vt,[e,n]);const l=o(this,lt).at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),o(this,lt).push({line:r,points:o(this,Vt)}),o(this,zs).set(r,0),m(this,Un,0),this.toSVGPath(),null}getLastElement(){return o(this,lt).at(-1)}setLastElement(e){return o(this,lt)?(o(this,lt).push(e),m(this,ot,e.line),m(this,Vt,e.points),m(this,Un,0),{path:{d:this.toSVGPath()}}):o(this,co).setLastElement(e)}removeLastElement(){if(!o(this,lt))return o(this,co).removeLastElement();o(this,lt).pop(),m(this,ct,"");for(let e=0,n=o(this,lt).length;e<n;e++){const{line:s,points:a}=o(this,lt)[e];m(this,ot,s),m(this,Vt,a),m(this,Un,0),this.toSVGPath()}return{path:{d:o(this,ct)}}}toSVGPath(){const e=O.svgRound(o(this,ot)[4]),n=O.svgRound(o(this,ot)[5]);if(o(this,Vt).length===2)return m(this,ct,`${o(this,ct)} M ${e} ${n} Z`),o(this,ct);if(o(this,Vt).length<=6){const a=o(this,ct).lastIndexOf("M");m(this,ct,`${o(this,ct).slice(0,a)} M ${e} ${n}`),m(this,Un,6)}if(o(this,Vt).length===4){const a=O.svgRound(o(this,ot)[10]),i=O.svgRound(o(this,ot)[11]);return m(this,ct,`${o(this,ct)} L ${a} ${i}`),m(this,Un,12),o(this,ct)}const s=[];o(this,Un)===0&&(s.push(`M ${e} ${n}`),m(this,Un,6));for(let a=o(this,Un),i=o(this,ot).length;a<i;a+=6){const[r,l,c,u,h,d]=o(this,ot).slice(a,a+6).map(O.svgRound);s.push(`C${r} ${l} ${c} ${u} ${h} ${d}`)}return m(this,ct,o(this,ct)+s.join(" ")),m(this,Un,o(this,ot).length),o(this,ct)}getOutlines(e,n,s,a){const i=o(this,lt).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),o(this,co).build(o(this,lt),e,n,s,o(this,zo),o(this,Pc),a),m(this,zs,null),m(this,ot,null),m(this,lt,null),m(this,ct,null),o(this,co)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}zs=new WeakMap,ot=new WeakMap,lt=new WeakMap,zo=new WeakMap,Pc=new WeakMap,Vt=new WeakMap,ct=new WeakMap,Un=new WeakMap,co=new WeakMap,$o=new WeakMap,Bo=new WeakMap,Tc=new WeakSet,Gd=function(t,e){return O._normalizePoint(t,e,o(this,$o),o(this,Bo),o(this,zo))};var Xt,qd,mp,An,Qs,Js,yu,wu,xu,cn,ea,BA,UA,HA;const LN=class VA extends O{constructor(){super(...arguments),k(this,cn),k(this,Xt),k(this,qd,0),k(this,mp),k(this,An),k(this,Qs),k(this,Js),k(this,yu),k(this,wu),k(this,xu)}build(e,n,s,a,i,r,l){m(this,Qs,n),m(this,Js,s),m(this,yu,a),m(this,wu,i),m(this,xu,r),m(this,mp,l??0),m(this,An,e),A(this,cn,UA).call(this)}setLastElement(e){return o(this,An).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return o(this,An).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:n}of o(this,An)){if(e.push(`M${O.svgRound(n[4])} ${O.svgRound(n[5])}`),n.length===6){e.push("Z");continue}if(n.length===12){e.push(`L${O.svgRound(n[10])} ${O.svgRound(n[11])}`);continue}for(let s=6,a=n.length;s<a;s+=6){const[i,r,l,c,u,h]=n.subarray(s,s+6).map(O.svgRound);e.push(`C${i} ${r} ${l} ${c} ${u} ${h}`)}}return e.join("")}serialize([e,n,s,a],i){const r=[],l=[],[c,u,h,d]=A(this,cn,BA).call(this);let f,g,v,y,S,b,x,w,_;switch(o(this,wu)){case 0:_=O._rescale,f=e,g=n+a,v=s,y=-a,S=e+c*s,b=n+(1-u-d)*a,x=e+(c+h)*s,w=n+(1-u)*a;break;case 90:_=O._rescaleAndSwap,f=e,g=n,v=s,y=a,S=e+u*s,b=n+c*a,x=e+(u+d)*s,w=n+(c+h)*a;break;case 180:_=O._rescale,f=e+s,g=n,v=-s,y=a,S=e+(1-c-h)*s,b=n+u*a,x=e+(1-c)*s,w=n+(u+d)*a;break;case 270:_=O._rescaleAndSwap,f=e+s,g=n+a,v=-s,y=-a,S=e+(1-u-d)*s,b=n+(1-c-h)*a,x=e+(1-u)*s,w=n+(1-c)*a;break}for(const{line:E,points:M}of o(this,An))r.push(_(E,f,g,v,y,i?new Array(E.length):null)),l.push(_(M,f,g,v,y,i?new Array(M.length):null));return{lines:r,points:l,rect:[S,b,x,w]}}static deserialize(e,n,s,a,i,{paths:{lines:r,points:l},rotation:c,thickness:u}){const h=[];let d,f,g,v,y;switch(c){case 0:y=O._rescale,d=-e/s,f=n/a+1,g=1/s,v=-1/a;break;case 90:y=O._rescaleAndSwap,d=-n/a,f=-e/s,g=1/a,v=1/s;break;case 180:y=O._rescale,d=e/s+1,f=-n/a,g=-1/s,v=1/a;break;case 270:y=O._rescaleAndSwap,d=n/a+1,f=e/s+1,g=-1/a,v=-1/s;break}if(!r){r=[];for(const b of l){const x=b.length;if(x===2){r.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(x===4){r.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const w=new Float32Array(3*(x-2));r.push(w);let[_,E,M,N]=b.subarray(0,4);w.set([NaN,NaN,NaN,NaN,_,E],0);for(let P=4;P<x;P+=2){const T=b[P],I=b[P+1];w.set(O.createBezierPoints(_,E,M,N,T,I),(P-2)*3),[_,E,M,N]=[M,N,T,I]}}}for(let b=0,x=r.length;b<x;b++)h.push({line:y(r[b].map(w=>w??NaN),d,f,g,v),points:y(l[b].map(w=>w??NaN),d,f,g,v)});const S=new VA;return S.build(h,s,a,1,c,u,i),S}get box(){return o(this,Xt)}updateProperty(e,n){return e==="stroke-width"?A(this,cn,HA).call(this,n):null}updateParentDimensions([e,n],s){const[a,i]=A(this,cn,ea).call(this);m(this,Qs,e),m(this,Js,n),m(this,yu,s);const[r,l]=A(this,cn,ea).call(this),c=r-a,u=l-i,h=o(this,Xt);return h[0]-=c,h[1]-=u,h[2]+=2*c,h[3]+=2*u,h}updateRotation(e){return m(this,qd,e),{path:{transform:this.rotationTransform}}}get viewBox(){return o(this,Xt).map(O.svgRound).join(" ")}get defaultProperties(){const[e,n]=o(this,Xt);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(e)} ${O.svgRound(n)}`}}}get rotationTransform(){const[,,e,n]=o(this,Xt);let s=0,a=0,i=0,r=0,l=0,c=0;switch(o(this,qd)){case 90:a=n/e,i=-e/n,l=e;break;case 180:s=-1,r=-1,l=e,c=n;break;case 270:a=-n/e,i=e/n,c=n;break;default:return""}return`matrix(${s} ${a} ${i} ${r} ${O.svgRound(l)} ${O.svgRound(c)})`}getPathResizingSVGProperties([e,n,s,a]){const[i,r]=A(this,cn,ea).call(this),[l,c,u,h]=o(this,Xt);if(Math.abs(u-i)<=O.PRECISION||Math.abs(h-r)<=O.PRECISION){const y=e+s/2-(l+u/2),S=n+a/2-(c+h/2);return{path:{"transform-origin":`${O.svgRound(e)} ${O.svgRound(n)}`,transform:`${this.rotationTransform} translate(${y} ${S})`}}}const d=(s-2*i)/(u-2*i),f=(a-2*r)/(h-2*r),g=u/s,v=h/a;return{path:{"transform-origin":`${O.svgRound(l)} ${O.svgRound(c)}`,transform:`${this.rotationTransform} scale(${g} ${v}) translate(${O.svgRound(i)} ${O.svgRound(r)}) scale(${d} ${f}) translate(${O.svgRound(-i)} ${O.svgRound(-r)})`}}}getPathResizedSVGProperties([e,n,s,a]){const[i,r]=A(this,cn,ea).call(this),l=o(this,Xt),[c,u,h,d]=l;if(l[0]=e,l[1]=n,l[2]=s,l[3]=a,Math.abs(h-i)<=O.PRECISION||Math.abs(d-r)<=O.PRECISION){const S=e+s/2-(c+h/2),b=n+a/2-(u+d/2);for(const{line:x,points:w}of o(this,An))O._translate(x,S,b,x),O._translate(w,S,b,w);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(e)} ${O.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const f=(s-2*i)/(h-2*i),g=(a-2*r)/(d-2*r),v=-f*(c+i)+e+i,y=-g*(u+r)+n+r;if(f!==1||g!==1||v!==0||y!==0)for(const{line:S,points:b}of o(this,An))O._rescale(S,v,y,f,g,S),O._rescale(b,v,y,f,g,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(e)} ${O.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,n],s){const[a,i]=s,r=o(this,Xt),l=e-r[0],c=n-r[1];if(o(this,Qs)===a&&o(this,Js)===i)for(const{line:u,points:h}of o(this,An))O._translate(u,l,c,u),O._translate(h,l,c,h);else{const u=o(this,Qs)/a,h=o(this,Js)/i;m(this,Qs,a),m(this,Js,i);for(const{line:d,points:f}of o(this,An))O._rescale(d,l,c,u,h,d),O._rescale(f,l,c,u,h,f);r[2]*=u,r[3]*=h}return r[0]=e,r[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${O.svgRound(e)} ${O.svgRound(n)}`}}}get defaultSVGProperties(){const e=o(this,Xt);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${O.svgRound(e[0])} ${O.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}};Xt=new WeakMap,qd=new WeakMap,mp=new WeakMap,An=new WeakMap,Qs=new WeakMap,Js=new WeakMap,yu=new WeakMap,wu=new WeakMap,xu=new WeakMap,cn=new WeakSet,ea=function(t=o(this,xu)){const e=o(this,mp)+t/2*o(this,yu);return o(this,wu)%180===0?[e/o(this,Qs),e/o(this,Js)]:[e/o(this,Js),e/o(this,Qs)]},BA=function(){const[t,e,n,s]=o(this,Xt),[a,i]=A(this,cn,ea).call(this,0);return[t+a,e+i,n-2*a,s-2*i]},UA=function(){const t=m(this,Xt,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of o(this,An)){if(s.length<=12){for(let r=4,l=s.length;r<l;r+=6){const[c,u]=s.subarray(r,r+2);t[0]=Math.min(t[0],c),t[1]=Math.min(t[1],u),t[2]=Math.max(t[2],c),t[3]=Math.max(t[3],u)}continue}let a=s[4],i=s[5];for(let r=6,l=s.length;r<l;r+=6){const[c,u,h,d,f,g]=s.subarray(r,r+6);$.bezierBoundingBox(a,i,c,u,h,d,f,g,t),a=f,i=g}}const[e,n]=A(this,cn,ea).call(this);t[0]=Math.min(1,Math.max(0,t[0]-e)),t[1]=Math.min(1,Math.max(0,t[1]-n)),t[2]=Math.min(1,Math.max(0,t[2]+e)),t[3]=Math.min(1,Math.max(0,t[3]+n)),t[2]-=t[0],t[3]-=t[1]},HA=function(t){const[e,n]=A(this,cn,ea).call(this);m(this,xu,t);const[s,a]=A(this,cn,ea).call(this),[i,r]=[s-e,a-n],l=o(this,Xt);return l[0]-=i,l[1]-=r,l[2]+=2*i,l[3]+=2*r,l};let GA=LN;var Lc;const RN=class qA extends NN{constructor(e){super(),k(this,Lc),m(this,Lc,e),super.updateProperties({fill:"none",stroke:ze._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,n){e==="stroke-width"&&(n??(n=this["stroke-width"]),n*=o(this,Lc).realScale),super.updateSVGProperty(e,n)}clone(){const e=new qA(o(this,Lc));return e.updateAll(this),e}};Lc=new WeakMap;let IN=RN;var Uv,XA;const Xd=class YA extends PN{constructor(e){super({...e,name:"inkEditor"}),k(this,Uv),this._willKeepAspectRatio=!0}static initialize(e,n){ze.initialize(e,n),this._defaultDrawingOptions=new IN(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return ee(this,"typesMap",new Map([[ae.INK_THICKNESS,"stroke-width"],[ae.INK_COLOR,"stroke"],[ae.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,n,s,a,i){return new TN(e,n,s,a,i,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,n,s,a,i,r){return GA.deserialize(e,n,s,a,i,r)}static async deserialize(e,n,s){let a=null;if(e instanceof ry){const{data:{inkLists:r,rect:l,rotation:c,id:u,color:h,opacity:d,borderStyle:{rawWidth:f},popupRef:g},parent:{page:{pageNumber:v}}}=e;a=e={annotationType:J.INK,color:Array.from(h),thickness:f,opacity:d,paths:{points:r},boxes:null,pageIndex:v-1,rect:l.slice(0),rotation:c,id:u,deleted:!1,popupRef:g}}const i=await super.deserialize(e,n,s);return i.annotationElementId=e.id||null,i._initialData=a,i}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:n,parent:s}=this;n.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(e,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:n,opacity:s}){this._drawingOptions=YA.getDefaultDrawingOptions({stroke:$.makeHexColor(...e),"stroke-width":n,"stroke-opacity":s})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:s,rect:a}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":r,"stroke-width":l}}=this,c={annotationType:J.INK,color:ze._colorManager.convert(i),opacity:r,thickness:l,paths:{lines:n,points:s},pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?c:this.annotationElementId&&!A(this,Uv,XA).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(e){const{points:n,rect:s}=this.serializeDraw(!1);return e.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:n}),null}};Uv=new WeakSet,XA=function(t){const{color:e,thickness:n,opacity:s,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((i,r)=>i!==e[r])||t.thickness!==n||t.opacity!==s||t.pageIndex!==a},X(Xd,"_type","ink"),X(Xd,"_editorType",J.INK),X(Xd,"_defaultDrawingOptions",null);let DN=Xd;var De,St,Zi,ti,ur,Rc,ta,$s,Tn,ku,Me,Rl,Il,Yd,Hv,vp,Vv,Kd,KA;const Qd=class extends ze{constructor(t){super({...t,name:"stampEditor"}),k(this,Me),k(this,De,null),k(this,St,null),k(this,Zi,null),k(this,ti,null),k(this,ur,null),k(this,Rc,""),k(this,ta,null),k(this,$s,null),k(this,Tn,!1),k(this,ku,!1),m(this,ti,t.bitmapUrl),m(this,ur,t.bitmapFile)}static initialize(t,e){ze.initialize(t,e)}static get supportedTypes(){return ee(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(t=>`image/${t}`))}static get supportedTypesStr(){return ee(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(J.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:i}=t||this.copyCanvas(null,null,!0).imageData,r=await n.guess({name:"altText",request:{data:s,width:a,height:i,channels:s.length/(a*i)}});if(!r)throw new Error("No response from the AI service.");if(r.error)throw new Error("Error from the AI service.");if(r.cancel)return null;if(!r.output)throw new Error("No valid response from the AI service.");const l=r.output;return await this.setGuessedAltText(l),e&&!this.hasAltTextData()&&(this.altTextData={alt:l,decorative:!1}),l}remove(){var t;o(this,St)&&(m(this,De,null),this._uiManager.imageManager.deleteId(o(this,St)),(t=o(this,ta))==null||t.remove(),m(this,ta,null),o(this,$s)&&(clearTimeout(o(this,$s)),m(this,$s,null))),super.remove()}rebuild(){if(!this.parent){o(this,St)&&A(this,Me,Yd).call(this);return}super.rebuild(),this.div!==null&&(o(this,St)&&o(this,ta)===null&&A(this,Me,Yd).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(o(this,Zi)||o(this,De)||o(this,ti)||o(this,ur)||o(this,St))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),o(this,De)?A(this,Me,Hv).call(this):A(this,Me,Yd).call(this),this.width&&!this.annotationElementId){const[n,s]=this.parentDimensions;this.setAt(t*n,e*s,this.width*n,this.height*s)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){this.parent&&(o(this,$s)!==null&&clearTimeout(o(this,$s)),m(this,$s,setTimeout(()=>{m(this,$s,null),A(this,Me,Vv).call(this)},200)))}copyCanvas(t,e,n=!1){var s;t||(t=224);const{width:a,height:i}=o(this,De),r=new ny;let l=o(this,De),c=a,u=i,h=null;if(e){if(a>e||i>e){const M=Math.min(e/a,e/i);c=Math.floor(a*M),u=Math.floor(i*M)}h=document.createElement("canvas");const f=h.width=Math.ceil(c*r.sx),g=h.height=Math.ceil(u*r.sy);o(this,Tn)||(l=A(this,Me,vp).call(this,f,g));const v=h.getContext("2d");v.filter=this._uiManager.hcmFilter;let y="white",S="#cfcfd8";this._uiManager.hcmFilter!=="none"?S="black":(s=window.matchMedia)!=null&&s.call(window,"(prefers-color-scheme: dark)").matches&&(y="#8f8f9d",S="#42414d");const b=15,x=b*r.sx,w=b*r.sy,_=new OffscreenCanvas(x*2,w*2),E=_.getContext("2d");E.fillStyle=y,E.fillRect(0,0,x*2,w*2),E.fillStyle=S,E.fillRect(0,0,x,w),E.fillRect(x,w,x,w),v.fillStyle=v.createPattern(_,"repeat"),v.fillRect(0,0,f,g),v.drawImage(l,0,0,l.width,l.height,0,0,f,g)}let d=null;if(n){let f,g;if(r.symmetric&&l.width<t&&l.height<t)f=l.width,g=l.height;else if(l=o(this,De),a>t||i>t){const y=Math.min(t/a,t/i);f=Math.floor(a*y),g=Math.floor(i*y),o(this,Tn)||(l=A(this,Me,vp).call(this,f,g))}const v=new OffscreenCanvas(f,g).getContext("2d",{willReadFrequently:!0});v.drawImage(l,0,0,l.width,l.height,0,0,f,g),d={width:f,height:g,data:v.getImageData(0,0,f,g).data}}return{canvas:h,width:c,height:u,imageData:d}}getImageForAltText(){return o(this,ta)}static async deserialize(t,e,n){var s;let a=null;if(t instanceof pA){const{data:{rect:v,rotation:y,id:S,structParent:b,popupRef:x},container:w,parent:{page:{pageNumber:_}}}=t,E=w.querySelector("canvas"),M=n.imageManager.getFromCanvas(w.id,E);E.remove();const N=((s=await e._structTree.getAriaAttributes(`${Qb}${S}`))==null?void 0:s.get("aria-label"))||"";a=t={annotationType:J.STAMP,bitmapId:M.id,bitmap:M.bitmap,pageIndex:_-1,rect:v.slice(0),rotation:y,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:N},isSvg:!1,structParent:b,popupRef:x}}const i=await super.deserialize(t,e,n),{rect:r,bitmap:l,bitmapUrl:c,bitmapId:u,isSvg:h,accessibilityData:d}=t;u&&n.imageManager.isValidId(u)?(m(i,St,u),l&&m(i,De,l)):m(i,ti,c),m(i,Tn,h);const[f,g]=i.pageDimensions;return i.width=(r[2]-r[0])/f,i.height=(r[3]-r[1])/g,i.annotationElementId=t.id||null,d&&(i.altTextData=d),i._initialData=a,m(i,ku,!!a),i}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:J.STAMP,bitmapId:o(this,St),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:o(this,Tn),structTreeParentId:this._structTreeParentId};if(t)return n.bitmapUrl=A(this,Me,Kd).call(this,!0),n.accessibilityData=this.serializeAltText(!0),n;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(n.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const r=A(this,Me,KA).call(this,n);if(r.isSame)return null;r.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,e===null)return n;e.stamps||(e.stamps=new Map);const i=o(this,Tn)?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!e.stamps.has(o(this,St)))e.stamps.set(o(this,St),{area:i,serialized:n}),n.bitmap=A(this,Me,Kd).call(this,!1);else if(o(this,Tn)){const r=e.stamps.get(o(this,St));i>r.area&&(r.area=i,r.serialized.bitmap.close(),r.serialized.bitmap=A(this,Me,Kd).call(this,!1))}return n}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};De=new WeakMap,St=new WeakMap,Zi=new WeakMap,ti=new WeakMap,ur=new WeakMap,Rc=new WeakMap,ta=new WeakMap,$s=new WeakMap,Tn=new WeakMap,ku=new WeakMap,Me=new WeakSet,Rl=function(t,e=!1){if(!t){this.remove();return}m(this,De,t.bitmap),e||(m(this,St,t.id),m(this,Tn,t.isSvg)),t.file&&m(this,Rc,t.file.name),A(this,Me,Hv).call(this)},Il=function(){if(m(this,Zi,null),this._uiManager.enableWaiting(!1),!!o(this,ta)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,De)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,De)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Yd=function(){if(o(this,St)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(o(this,St)).then(n=>A(this,Me,Rl).call(this,n,!0)).finally(()=>A(this,Me,Il).call(this));return}if(o(this,ti)){const n=o(this,ti);m(this,ti,null),this._uiManager.enableWaiting(!0),m(this,Zi,this._uiManager.imageManager.getFromUrl(n).then(s=>A(this,Me,Rl).call(this,s)).finally(()=>A(this,Me,Il).call(this)));return}if(o(this,ur)){const n=o(this,ur);m(this,ur,null),this._uiManager.enableWaiting(!0),m(this,Zi,this._uiManager.imageManager.getFromFile(n).then(s=>A(this,Me,Rl).call(this,s)).finally(()=>A(this,Me,Il).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=Qd.supportedTypesStr;const e=this._uiManager._signal;m(this,Zi,new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),A(this,Me,Rl).call(this,s)}n()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:e})}).finally(()=>A(this,Me,Il).call(this))),t.click()},Hv=function(){var t;const{div:e}=this;let{width:n,height:s}=o(this,De);const[a,i]=this.pageDimensions,r=.75;if(this.width)n=this.width*a,s=this.height*i;else if(n>r*a||s>r*i){const h=Math.min(r*a/n,r*i/s);n*=h,s*=h}const[l,c]=this.parentDimensions;this.setDims(n*l/a,s*c/i),this._uiManager.enableWaiting(!1);const u=m(this,ta,document.createElement("canvas"));u.setAttribute("role","img"),this.addContainer(u),this.width=n/a,this.height=s/i,(t=this._initialOptions)!=null&&t.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),A(this,Me,Vv).call(this),o(this,ku)||(this.parent.addUndoableEditor(this),m(this,ku,!0)),this._reportTelemetry({action:"inserted_image"}),o(this,Rc)&&u.setAttribute("aria-label",o(this,Rc))},vp=function(t,e){const{width:n,height:s}=o(this,De);let a=n,i=s,r=o(this,De);for(;a>2*t||i>2*e;){const l=a,c=i;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2));const u=new OffscreenCanvas(a,i);u.getContext("2d").drawImage(r,0,0,l,c,0,0,a,i),r=u.transferToImageBitmap()}return r},Vv=function(){const[t,e]=this.parentDimensions,{width:n,height:s}=this,a=new ny,i=Math.ceil(n*t*a.sx),r=Math.ceil(s*e*a.sy),l=o(this,ta);if(!l||l.width===i&&l.height===r)return;l.width=i,l.height=r;const c=o(this,Tn)?o(this,De):A(this,Me,vp).call(this,i,r),u=l.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(c,0,0,c.width,c.height,0,0,i,r)},Kd=function(t){if(t){if(o(this,Tn)){const n=this._uiManager.imageManager.getSvgUrl(o(this,St));if(n)return n}const e=document.createElement("canvas");return{width:e.width,height:e.height}=o(this,De),e.getContext("2d").drawImage(o(this,De),0,0),e.toDataURL()}if(o(this,Tn)){const[e,n]=this.pageDimensions,s=Math.round(this.width*e*fl.PDF_TO_CSS_UNITS),a=Math.round(this.height*n*fl.PDF_TO_CSS_UNITS),i=new OffscreenCanvas(s,a);return i.getContext("2d").drawImage(o(this,De),0,0,o(this,De).width,o(this,De).height,0,0,s,a),i.transferToImageBitmap()}return structuredClone(o(this,De))},KA=function(t){var e;const{pageIndex:n,accessibilityData:{altText:s}}=this._initialData,a=t.pageIndex===n,i=(((e=t.accessibilityData)==null?void 0:e.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&a&&i,isSameAltText:i}},X(Qd,"_type","stamp"),X(Qd,"_editorType",J.STAMP);let jN=Qd;var uo,Ic,Bs,Bi,Ea,Gn,Ui,Dc,ho,ls,Ca,Ft,Ma,z,hr,qe,QA,fs,Gv,qv,Jd;const Zd=class Hi{constructor({uiManager:e,pageIndex:n,div:s,structTreeLayer:a,accessibilityManager:i,annotationLayer:r,drawLayer:l,textLayer:c,viewport:u,l10n:h}){k(this,qe),k(this,uo),k(this,Ic,!1),k(this,Bs,null),k(this,Bi,null),k(this,Ea,null),k(this,Gn,new Map),k(this,Ui,!1),k(this,Dc,!1),k(this,ho,!1),k(this,ls,null),k(this,Ca,null),k(this,Ft,null),k(this,Ma,null),k(this,z);const d=[...o(Hi,hr).values()];if(!Hi._initialized){Hi._initialized=!0;for(const f of d)f.initialize(h,e)}e.registerEditorTypes(d),m(this,z,e),this.pageIndex=n,this.div=s,m(this,uo,i),m(this,Bs,r),this.viewport=u,m(this,Ft,c),this.drawLayer=l,this._structTree=a,o(this,z).addLayer(this)}get isEmpty(){return o(this,Gn).size===0}get isInvisible(){return this.isEmpty&&o(this,z).getMode()===J.NONE}updateToolbar(e){o(this,z).updateToolbar(e)}updateMode(e=o(this,z).getMode()){switch(A(this,qe,Jd).call(this),e){case J.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case J.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case J.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:n}=this.div;for(const s of o(Hi,hr).values())n.toggle(`${s._type}Editing`,e===s._editorType);this.div.hidden=!1}hasTextLayer(e){var n;return e===((n=o(this,Ft))==null?void 0:n.div)}setEditingState(e){o(this,z).setEditingState(e)}addCommands(e){o(this,z).addCommands(e)}cleanUndoStack(e){o(this,z).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var n;(n=o(this,Bs))==null||n.div.classList.toggle("disabled",!e)}async enable(){m(this,ho,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const s of o(this,Gn).values())s.enableEditing(),s.show(!0),s.annotationElementId&&(o(this,z).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));if(!o(this,Bs)){m(this,ho,!1);return}const n=o(this,Bs).getEditableAnnotations();for(const s of n){if(s.hide(),o(this,z).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const a=await this.deserialize(s);a&&(this.addOrRebuild(a),a.enableEditing())}m(this,ho,!1)}disable(){var e;m(this,Dc,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const n=new Map,s=new Map;for(const i of o(this,Gn).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){n.set(i.annotationElementId,i);continue}else s.set(i.annotationElementId,i);(e=this.getEditableAnnotation(i.annotationElementId))==null||e.show(),i.remove()}if(o(this,Bs)){const i=o(this,Bs).getEditableAnnotations();for(const r of i){const{id:l}=r.data;if(o(this,z).isDeletedAnnotationElement(l))continue;let c=s.get(l);if(c){c.resetAnnotationElement(r),c.show(!1),r.show();continue}c=n.get(l),c&&(o(this,z).addChangedExistingAnnotation(c),c.renderAnnotationElement(r)&&c.show(!1)),r.show()}}A(this,qe,Jd).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:a}=this.div;for(const i of o(Hi,hr).values())a.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),m(this,Dc,!1)}getEditableAnnotation(e){var n;return((n=o(this,Bs))==null?void 0:n.getEditableAnnotation(e))||null}setActiveEditor(e){o(this,z).getActive()!==e&&o(this,z).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=o(this,Ft))!=null&&e.div&&!o(this,Ma)){m(this,Ma,new AbortController);const n=o(this,z).combinedSignal(o(this,Ma));o(this,Ft).div.addEventListener("pointerdown",A(this,qe,QA).bind(this),{signal:n}),o(this,Ft).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=o(this,Ft))!=null&&e.div&&o(this,Ma)&&(o(this,Ma).abort(),m(this,Ma,null),o(this,Ft).div.classList.remove("highlighting"))}enableClick(){if(o(this,Bi))return;m(this,Bi,new AbortController);const e=o(this,z).combinedSignal(o(this,Bi));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const n=this.pointerup.bind(this);this.div.addEventListener("pointerup",n,{signal:e}),this.div.addEventListener("pointercancel",n,{signal:e})}disableClick(){var e;(e=o(this,Bi))==null||e.abort(),m(this,Bi,null)}attach(e){o(this,Gn).set(e.id,e);const{annotationElementId:n}=e;n&&o(this,z).isDeletedAnnotationElement(n)&&o(this,z).removeDeletedAnnotationElement(e)}detach(e){var n;o(this,Gn).delete(e.id),(n=o(this,uo))==null||n.removePointerInTextLayer(e.contentDiv),!o(this,Dc)&&e.annotationElementId&&o(this,z).addDeletedAnnotationElement(e)}remove(e){this.detach(e),o(this,z).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var n;e.parent!==this&&(e.parent&&e.annotationElementId&&(o(this,z).addDeletedAnnotationElement(e.annotationElementId),ze.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(n=e.parent)==null||n.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),o(this,z).addEditor(e),this.attach(e),!e.isAttachedToDOM){const n=e.render();this.div.append(n),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!o(this,ho)),o(this,z).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:s}=document;e.div.contains(s)&&!o(this,Ea)&&(e._focusEventsAllowed=!1,m(this,Ea,setTimeout(()=>{m(this,Ea,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:o(this,z)._signal}),s.focus())},0))),e._structTreeParentId=(n=o(this,uo))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const n=()=>e._uiManager.rebuild(e),s=()=>{e.remove()};this.addCommands({cmd:n,undo:s,mustExec:!1})}getNextId(){return o(this,z).getId()}combinedSignal(e){return o(this,z).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=o(this,qe,fs))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,n){o(this,z).updateToolbar(e),o(this,z).updateMode(e);const{offsetX:s,offsetY:a}=A(this,qe,qv).call(this),i=this.getNextId(),r=A(this,qe,Gv).call(this,{parent:this,id:i,x:s,y:a,uiManager:o(this,z),isCentered:!0,...n});r&&this.add(r)}async deserialize(e){var n;return await((n=o(Hi,hr).get(e.annotationType??e.annotationEditorType))==null?void 0:n.deserialize(e,this,o(this,z)))||null}createAndAddNewEditor(e,n,s={}){const a=this.getNextId(),i=A(this,qe,Gv).call(this,{parent:this,id:a,x:e.offsetX,y:e.offsetY,uiManager:o(this,z),isCentered:n,...s});return i&&this.add(i),i}addNewEditor(){this.createAndAddNewEditor(A(this,qe,qv).call(this),!0)}setSelected(e){o(this,z).setSelected(e)}toggleSelected(e){o(this,z).toggleSelected(e)}unselect(e){o(this,z).unselect(e)}pointerup(e){var n;const{isMac:s}=Wt.platform;if(!(e.button!==0||e.ctrlKey&&s)&&e.target===this.div&&o(this,Ui)&&(m(this,Ui,!1),!((n=o(this,qe,fs))!=null&&n.isDrawer&&o(this,qe,fs).supportMultipleDrawings))){if(!o(this,Ic)){m(this,Ic,!0);return}if(o(this,z).getMode()===J.STAMP){o(this,z).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var n;if(o(this,z).getMode()===J.HIGHLIGHT&&this.enableTextSelection(),o(this,Ui)){m(this,Ui,!1);return}const{isMac:s}=Wt.platform;if(e.button!==0||e.ctrlKey&&s||e.target!==this.div)return;if(m(this,Ui,!0),(n=o(this,qe,fs))!=null&&n.isDrawer){this.startDrawingSession(e);return}const a=o(this,z).getActive();m(this,Ic,!a||a.isEmpty())}startDrawingSession(e){if(this.div.focus(),o(this,ls)){o(this,qe,fs).startDrawing(this,o(this,z),!1,e);return}o(this,z).setCurrentDrawingSession(this),m(this,ls,new AbortController);const n=o(this,z).combinedSignal(o(this,ls));this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(m(this,Ca,null),this.commitOrRemove())},{signal:n}),o(this,qe,fs).startDrawing(this,o(this,z),!1,e)}pause(e){if(e){const{activeElement:n}=document;this.div.contains(n)&&m(this,Ca,n);return}o(this,Ca)&&setTimeout(()=>{var n;(n=o(this,Ca))==null||n.focus(),m(this,Ca,null)},0)}endDrawingSession(e=!1){return o(this,ls)?(o(this,z).setCurrentDrawingSession(null),o(this,ls).abort(),m(this,ls,null),m(this,Ca,null),o(this,qe,fs).endDrawing(e)):null}findNewParent(e,n,s){const a=o(this,z).findParent(n,s);return a===null||a===this?!1:(a.changeParent(e),!0)}commitOrRemove(){return o(this,ls)?(this.endDrawingSession(),!0):!1}onScaleChanging(){o(this,ls)&&o(this,qe,fs).onScaleChangingWhenDrawing(this)}destroy(){var e,n;this.commitOrRemove(),((e=o(this,z).getActive())==null?void 0:e.parent)===this&&(o(this,z).commitOrRemove(),o(this,z).setActiveEditor(null)),o(this,Ea)&&(clearTimeout(o(this,Ea)),m(this,Ea,null));for(const s of o(this,Gn).values())(n=o(this,uo))==null||n.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,o(this,Gn).clear(),o(this,z).removeLayer(this)}render({viewport:e}){this.viewport=e,yr(this.div,e);for(const n of o(this,z).getEditors(this.pageIndex))this.add(n),n.rebuild();this.updateMode()}update({viewport:e}){o(this,z).commitOrRemove(),A(this,qe,Jd).call(this);const n=this.viewport.rotation,s=e.rotation;if(this.viewport=e,yr(this.div,{rotation:s}),n!==s)for(const a of o(this,Gn).values())a.rotate(s)}get pageDimensions(){const{pageWidth:e,pageHeight:n}=this.viewport.rawDims;return[e,n]}get scale(){return o(this,z).viewParameters.realScale}};uo=new WeakMap,Ic=new WeakMap,Bs=new WeakMap,Bi=new WeakMap,Ea=new WeakMap,Gn=new WeakMap,Ui=new WeakMap,Dc=new WeakMap,ho=new WeakMap,ls=new WeakMap,Ca=new WeakMap,Ft=new WeakMap,Ma=new WeakMap,z=new WeakMap,hr=new WeakMap,qe=new WeakSet,QA=function(t){o(this,z).unselectAll();const{target:e}=t;if(e===o(this,Ft).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&o(this,Ft).div.contains(e)){const{isMac:n}=Wt.platform;if(t.button!==0||t.ctrlKey&&n)return;o(this,z).showAllEditors("highlight",!0,!0),o(this,Ft).div.classList.add("free"),this.toggleDrawing(),c0.startHighlighting(this,o(this,z).direction==="ltr",{target:o(this,Ft).div,x:t.x,y:t.y}),o(this,Ft).div.addEventListener("pointerup",()=>{o(this,Ft).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:o(this,z)._signal}),t.preventDefault()}},fs=function(){return o(Zd,hr).get(o(this,z).getMode())},Gv=function(t){const e=o(this,qe,fs);return e?new e.prototype.constructor(t):null},qv=function(){const{x:t,y:e,width:n,height:s}=this.div.getBoundingClientRect(),a=Math.max(0,t),i=Math.max(0,e),r=Math.min(window.innerWidth,t+n),l=Math.min(window.innerHeight,e+s),c=(a+r)/2-t,u=(i+l)/2-e,[h,d]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:h,offsetY:d}},Jd=function(){for(const t of o(this,Gn).values())t.isEmpty()&&t.remove()},X(Zd,"_initialized",!1),k(Zd,hr,new Map([EN,DN,jN,c0].map(t=>[t._editorType,t])));let FN=Zd;var ps,ef,Gt,fo,Xv,JA,Vi,Yv,ZA,Kv;const jc=class Hn{constructor({pageIndex:e}){k(this,Vi),k(this,ps,null),k(this,ef,0),k(this,Gt,new Map),k(this,fo,new Map),this.pageIndex=e}setParent(e){if(!o(this,ps)){m(this,ps,e);return}if(o(this,ps)!==e){if(o(this,Gt).size>0)for(const n of o(this,Gt).values())n.remove(),e.append(n);m(this,ps,e)}}static get _svgFactory(){return ee(this,"_svgFactory",new iy)}draw(e,n=!1,s=!1){const a=Jt(this,ef)._++,i=A(this,Vi,Yv).call(this),r=Hn._svgFactory.createElement("defs");i.append(r);const l=Hn._svgFactory.createElement("path");r.append(l);const c=`path_p${this.pageIndex}_${a}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke"),n&&o(this,fo).set(a,l);const u=s?A(this,Vi,ZA).call(this,r,c):null,h=Hn._svgFactory.createElement("use");return i.append(h),h.setAttribute("href",`#${c}`),this.updateProperties(i,e),o(this,Gt).set(a,i),{id:a,clipPathId:`url(#${u})`}}drawOutline(e,n){const s=Jt(this,ef)._++,a=A(this,Vi,Yv).call(this),i=Hn._svgFactory.createElement("defs");a.append(i);const r=Hn._svgFactory.createElement("path");i.append(r);const l=`path_p${this.pageIndex}_${s}`;r.setAttribute("id",l),r.setAttribute("vector-effect","non-scaling-stroke");let c;if(n){const d=Hn._svgFactory.createElement("mask");i.append(d),c=`mask_p${this.pageIndex}_${s}`,d.setAttribute("id",c),d.setAttribute("maskUnits","objectBoundingBox");const f=Hn._svgFactory.createElement("rect");d.append(f),f.setAttribute("width","1"),f.setAttribute("height","1"),f.setAttribute("fill","white");const g=Hn._svgFactory.createElement("use");d.append(g),g.setAttribute("href",`#${l}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const u=Hn._svgFactory.createElement("use");a.append(u),u.setAttribute("href",`#${l}`),c&&u.setAttribute("mask",`url(#${c})`);const h=u.cloneNode();return a.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(a,e),o(this,Gt).set(s,a),s}finalizeDraw(e,n){o(this,fo).delete(e),this.updateProperties(e,n)}updateProperties(e,n){var s;if(!n)return;const{root:a,bbox:i,rootClass:r,path:l}=n,c=typeof e=="number"?o(this,Gt).get(e):e;if(c){if(a&&A(this,Vi,Kv).call(this,c,a),i&&A(s=Hn,Xv,JA).call(s,c,i),r){const{classList:u}=c;for(const[h,d]of Object.entries(r))u.toggle(h,d)}if(l){const u=c.firstChild.firstChild;A(this,Vi,Kv).call(this,u,l)}}}updateParent(e,n){if(n===this)return;const s=o(this,Gt).get(e);s&&(o(n,ps).append(s),o(this,Gt).delete(e),o(n,Gt).set(e,s))}remove(e){o(this,fo).delete(e),o(this,ps)!==null&&(o(this,Gt).get(e).remove(),o(this,Gt).delete(e))}destroy(){m(this,ps,null);for(const e of o(this,Gt).values())e.remove();o(this,Gt).clear(),o(this,fo).clear()}};ps=new WeakMap,ef=new WeakMap,Gt=new WeakMap,fo=new WeakMap,Xv=new WeakSet,JA=function(t,[e,n,s,a]){const{style:i}=t;i.top=`${100*n}%`,i.left=`${100*e}%`,i.width=`${100*s}%`,i.height=`${100*a}%`},Vi=new WeakSet,Yv=function(){const t=jc._svgFactory.create(1,1,!0);return o(this,ps).append(t),t.setAttribute("aria-hidden",!0),t},ZA=function(t,e){const n=jc._svgFactory.createElement("clipPath");t.append(n);const s=`clip_${e}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const a=jc._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),s},Kv=function(t,e){for(const[n,s]of Object.entries(e))s===null?t.removeAttribute(n):t.setAttribute(n,s)},k(jc,Xv);let ON=jc;globalThis.pdfjsTestingUtils={HighlightOutliner:Iv};K.AbortException;K.AnnotationEditorLayer;K.AnnotationEditorParamsType;K.AnnotationEditorType;K.AnnotationEditorUIManager;K.AnnotationLayer;K.AnnotationMode;K.ColorPicker;K.DOMSVGFactory;K.DrawLayer;K.FeatureTest;var WN=K.GlobalWorkerOptions;K.ImageKind;K.InvalidPDFException;K.MissingPDFException;K.OPS;K.OutputScale;K.PDFDataRangeTransport;K.PDFDateString;K.PDFWorker;K.PasswordResponses;K.PermissionFlag;K.PixelsPerInch;K.RenderingCancelledException;K.TextLayer;K.TouchManager;K.UnexpectedResponseException;K.Util;K.VerbosityLevel;K.XfaLayer;K.build;K.createValidAbsoluteUrl;K.fetchData;var zN=K.getDocument;K.getFilenameFromUrl;K.getPdfFilenameFromUrl;K.getXfaPageViewport;K.isDataScheme;K.isPdfFile;K.noContextMenu;K.normalizeUnicode;K.setLayerDimensions;K.shadow;K.stopEvent;K.version;const $N="/assets/pdf.worker.min-yatZIOMy.mjs";WN.workerSrc=$N;function BN(){const{id:t}=hC(),{user:e}=On(),n=_r(),s=C.useRef(null),a=C.useRef(null),i=C.useRef(null),[r,l]=C.useState(null),[c,u]=C.useState(1),[h,d]=C.useState(0),[f,g]=C.useState(1.2),[v,y]=C.useState(!0),[S,b]=C.useState(""),[x,w]=C.useState(null),[_,E]=C.useState([]),[M,N]=C.useState(!1),[P,T]=C.useState(20),[I,V]=C.useState(!1);C.useEffect(()=>{re();const B=j=>j.preventDefault();document.addEventListener("contextmenu",B);const L=j=>{j.key==="ArrowLeft"?u(D=>Math.max(1,D-1)):j.key==="ArrowRight"?u(D=>Math.min(h||1,D+1)):j.key==="-"||j.key==="_"?g(D=>Math.max(.5,D-.2)):(j.key==="+"||j.key==="=")&&g(D=>Math.min(3,D+.2))};return document.addEventListener("keydown",L),ce.logEvent("document_view","document",t),()=>{document.removeEventListener("contextmenu",B),document.removeEventListener("keydown",L),x&&ce.post(`/documents/view/${x}/end`,{pages_viewed:_})}},[t,h]),C.useEffect(()=>{r&&I&&ue()},[r,c,f,I]);const re=async()=>{var B;try{try{const we={Authorization:`Bearer ${localStorage.getItem("access_token")}`},st=localStorage.getItem("desktop_session");st&&(we["X-Desktop-Session"]=st);const de=await fetch("/api/v1/system/logo",{headers:we});if(de.ok){const se=await de.blob(),Tt=URL.createObjectURL(se),mt=document.createElement("img");mt.src=Tt,await new Promise((mn,ha)=>{mt.onload=mn,mt.onerror=ha}),i.current=mt,N(!0),console.log("Custom logo loaded successfully")}}catch(we){console.log("No custom logo found, using default text",we)}try{const we={Authorization:`Bearer ${localStorage.getItem("access_token")}`},st=localStorage.getItem("desktop_session");st&&(we["X-Desktop-Session"]=st);const de=await fetch("/api/v1/system/config",{headers:we});if(de.ok){const se=await de.json(),Tt=parseInt(((B=se.config)==null?void 0:B.watermark_opacity)||"20",10);T(Tt),console.log("Watermark opacity loaded:",Tt)}}catch(we){console.log("Failed to load opacity setting, using default",we)}V(!0);const L={Authorization:`Bearer ${localStorage.getItem("access_token")}`,"X-Device-ID":localStorage.getItem("device_id")||""},j=localStorage.getItem("desktop_session");j&&(L["X-Desktop-Session"]=j);const D=await fetch(`/api/v1/documents/${t}/view`,{headers:L,credentials:"include"});if(!D.ok)throw new Error("Failed to load document");const Y=D.headers.get("X-View-ID");Y&&w(Y);const Q=await(await D.blob()).arrayBuffer(),fe=await zN({data:Q}).promise;l(fe),d(fe.numPages),y(!1)}catch(L){b(L instanceof Error?L.message:"Failed to load document"),y(!1)}},ue=async()=>{if(!r||!s.current)return;const B=await r.getPage(c),L=window.devicePixelRatio||1,j=B.getViewport({scale:f*L}),D=s.current,Y=D.getContext("2d");D.height=j.height,D.width=j.width,D.style.width=`${j.width/L}px`,D.style.height=`${j.height/L}px`,Y.save(),Y.setTransform(1,0,0,1,0,0),Y.globalCompositeOperation="source-over",Y.globalAlpha=1,Y.clearRect(0,0,D.width,D.height),Y.restore(),await B.render({canvasContext:Y,viewport:j}).promise,he(Y,D.width,D.height,L),_.includes(c)||(E(Q=>[...Q,c]),x&&ce.post(`/documents/view/${x}/page/${c}`,{}))},he=(B,L,j,D=1)=>{const Y=localStorage.getItem("client_ip")||"Local",Q=new Date,fe=Q.toLocaleDateString()+" "+Q.toLocaleTimeString();B.save(),B.globalCompositeOperation="multiply",B.globalAlpha=P/100,B.textAlign="center";const we=-35*Math.PI/180;B.rotate(we);const st=450*D,de=300*D,se=120*D,Tt=50*D;for(let mt=-L;mt<L*2;mt+=st)for(let mn=-j;mn<j*2;mn+=de){let ha=0;i.current?(B.drawImage(i.current,mt-se/2,mn-Tt/2,se,Tt),ha=Tt/2+15*D):(B.fillStyle="#0066CC",B.font=`bold ${28*D}px Arial, sans-serif`,B.fillText(" SRAMS",mt,mn),ha=30*D),B.fillStyle="#333333",B.font=`bold ${16*D}px Arial, sans-serif`,B.fillText((e==null?void 0:e.full_name)||"User",mt,mn+ha),B.fillStyle="#666666",B.font=`${14*D}px Arial, sans-serif`,B.fillText(`IP: ${Y}`,mt,mn+ha+20*D),B.fillText(fe,mt,mn+ha+40*D),B.fillStyle="#CC0000",B.font=`bold ${12*D}px Arial, sans-serif`,B.fillText(" CONFIDENTIAL - DO NOT COPY",mt,mn+ha+65*D)}B.restore()},G=B=>{B>=1&&B<=h&&u(B)},F=B=>{g(L=>Math.max(.5,Math.min(3,L+B)))};return v?p.jsxs("div",{className:"viewer-loading",children:[p.jsx("div",{className:"loading-spinner"}),p.jsx("p",{children:"Loading document..."})]}):S?p.jsxs("div",{className:"viewer-error",children:[p.jsx("p",{children:S}),p.jsx("button",{className:"btn btn-primary",onClick:()=>n("/documents"),children:"Back to Documents"})]}):p.jsxs("div",{className:"document-viewer",ref:a,children:[p.jsxs("div",{className:"viewer-toolbar glass",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>n("/documents"),children:p.jsx(ZC,{size:20})}),p.jsx("div",{className:"toolbar-separator"}),p.jsxs("div",{className:"page-controls",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>G(c-1),disabled:c<=1,children:p.jsx(tM,{size:20})}),p.jsxs("span",{className:"page-indicator",children:[c," / ",h]}),p.jsx("button",{className:"toolbar-btn",onClick:()=>G(c+1),disabled:c>=h,children:p.jsx(nM,{size:20})})]}),p.jsx("div",{className:"toolbar-separator"}),p.jsxs("div",{className:"zoom-controls",children:[p.jsx("button",{className:"toolbar-btn",onClick:()=>F(-.2),children:p.jsx(fM,{size:20})}),p.jsxs("span",{className:"zoom-indicator",children:[Math.round(f*100),"%"]}),p.jsx("button",{className:"toolbar-btn",onClick:()=>F(.2),children:p.jsx(dM,{size:20})})]})]}),p.jsx("div",{className:"canvas-container",children:p.jsx("canvas",{ref:s,className:"pdf-canvas"})}),p.jsx("div",{className:"security-overlay"})]})}function UN(){const{user:t}=On(),[e,n]=C.useState([]),[s,a]=C.useState(!0),[i,r]=C.useState(""),[l,c]=C.useState(""),[u,h]=C.useState(!1),[d,f]=C.useState(null),g=(t==null?void 0:t.role)==="super_admin",v=(t==null?void 0:t.role)==="admin";C.useEffect(()=>{y()},[l]);const y=async()=>{try{const _=l?`?role=${l}`:"",E=await ce.get(`/users${_}`);n(E.data.users||[])}catch(_){console.error("Failed to load users:",_)}finally{a(!1)}},S=async _=>{if(confirm(`Are you sure you want to delete ${_.full_name}?`))try{await ce.delete(`/users/${_.id}`),y()}catch(E){alert(E instanceof Error?E.message:"Failed to delete user")}},b=e.filter(_=>!(!g&&_.role==="super_admin")).filter(_=>_.full_name.toLowerCase().includes(i.toLowerCase())||_.email.toLowerCase().includes(i.toLowerCase())),x=_=>!(_.id===(t==null?void 0:t.id)||!g&&_.role==="super_admin"),w=_=>!(_.id===(t==null?void 0:t.id)||_.role==="super_admin"||v&&!g&&_.role==="admin");return s?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("div",{className:"users-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Users"}),p.jsx("p",{children:"Manage system users and their roles"})]}),p.jsxs("button",{className:"btn btn-primary",onClick:()=>{f(null),h(!0)},children:[p.jsx(Q1,{size:18}),"Add User"]})]}),p.jsxs("div",{className:"filters glass-card",children:[p.jsxs("div",{className:"search-input",children:[p.jsx(J1,{size:20}),p.jsx("input",{type:"text",placeholder:"Search users...",value:i,onChange:_=>r(_.target.value)})]}),p.jsxs("select",{className:"input",value:l,onChange:_=>c(_.target.value),children:[p.jsx("option",{value:"",children:"All Roles"}),p.jsx("option",{value:"user",children:"Users"}),p.jsx("option",{value:"admin",children:"Admins"}),g&&p.jsx("option",{value:"super_admin",children:"Super Admins"})]})]}),p.jsxs("div",{className:"table-container glass-card",children:[p.jsxs("table",{className:"table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[p.jsx("th",{children:"Name"}),p.jsx("th",{children:"Email"}),p.jsx("th",{children:"Role"}),p.jsx("th",{children:"Status"}),p.jsx("th",{children:"Last Login"}),p.jsx("th",{children:"Actions"})]})}),p.jsx("tbody",{children:b.map(_=>p.jsxs("tr",{children:[p.jsx("td",{children:p.jsxs("div",{className:"user-cell",children:[p.jsx("div",{className:"user-avatar",children:_.full_name.charAt(0).toUpperCase()}),p.jsx("span",{children:_.full_name})]})}),p.jsx("td",{children:_.email}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${GN(_.role)}`,children:VN(_.role)})}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${_.is_active?"success":"error"}`,children:_.is_active?"Active":"Inactive"})}),p.jsx("td",{children:_.last_login?new Date(_.last_login).toLocaleDateString():"Never"}),p.jsx("td",{children:p.jsxs("div",{className:"action-buttons",children:[x(_)&&p.jsx("button",{className:"action-btn",onClick:()=>{f(_),h(!0)},children:p.jsx(oM,{size:16})}),w(_)&&p.jsx("button",{className:"action-btn danger",onClick:()=>S(_),children:p.jsx(Yb,{size:16})})]})})]},_.id))})]}),b.length===0&&p.jsxs("div",{className:"empty-state",children:[p.jsx(dl,{size:48}),p.jsx("p",{children:"No users found"})]})]}),u&&p.jsx(HN,{user:d,isSuperAdmin:g,onClose:()=>h(!1),onSuccess:()=>{h(!1),y()}})]})}function HN({user:t,isSuperAdmin:e,onClose:n,onSuccess:s}){const[a,i]=C.useState({email:(t==null?void 0:t.email)||"",password:"",full_name:(t==null?void 0:t.full_name)||"",mobile:(t==null?void 0:t.mobile)||"",role:(t==null?void 0:t.role)||"user",is_active:(t==null?void 0:t.is_active)??!0}),[r,l]=C.useState(!1),[c,u]=C.useState(""),h=async d=>{d.preventDefault(),l(!0),u("");try{t?await ce.put(`/users/${t.id}`,{full_name:a.full_name,mobile:a.mobile,role:e?a.role:void 0,is_active:a.is_active}):await ce.post("/users",a),s()}catch(f){u(f instanceof Error?f.message:"Failed to save user")}finally{l(!1)}};return p.jsx("div",{className:"modal-overlay",onClick:n,children:p.jsxs("div",{className:"modal glass-card",onClick:d=>d.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:t?"Edit User":"Add User"}),p.jsx("button",{className:"close-btn",onClick:n,children:p.jsx(yl,{size:24})})]}),p.jsxs("form",{onSubmit:h,className:"modal-body",children:[c&&p.jsx("div",{className:"error-message",children:c}),!t&&p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Email"}),p.jsx("input",{type:"email",className:"input",value:a.email,onChange:d=>i({...a,email:d.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Password"}),p.jsx("input",{type:"password",className:"input",value:a.password,onChange:d=>i({...a,password:d.target.value}),required:!0,minLength:8})]})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Full Name"}),p.jsx("input",{type:"text",className:"input",value:a.full_name,onChange:d=>i({...a,full_name:d.target.value}),required:!0})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Mobile"}),p.jsx("input",{type:"tel",className:"input",value:a.mobile,onChange:d=>i({...a,mobile:d.target.value})})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Role"}),p.jsxs("select",{className:"input",value:a.role,onChange:d=>i({...a,role:d.target.value}),disabled:!e||(t==null?void 0:t.role)==="super_admin",children:[p.jsx("option",{value:"user",children:"User"}),p.jsx("option",{value:"admin",children:"Admin"})]})]}),t&&p.jsx("div",{className:"input-group",children:p.jsxs("label",{className:"checkbox-label",children:[p.jsx("input",{type:"checkbox",checked:a.is_active,onChange:d=>i({...a,is_active:d.target.checked})}),p.jsx("span",{children:"Active"})]})}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{type:"button",className:"btn btn-secondary",onClick:n,children:"Cancel"}),p.jsx("button",{type:"submit",className:"btn btn-primary",disabled:r,children:r?"Saving...":"Save"})]})]})]})})}function VN(t){return t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function GN(t){switch(t){case"super_admin":return"error";case"admin":return"warning";default:return"info"}}function ns(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function xr(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}const eS=6048e5,qN=864e5;let XN={};function Gp(){return XN}function Vu(t,e){var n,s,a,i;const r=Gp(),l=(e==null?void 0:e.weekStartsOn)??((s=(n=e==null?void 0:e.locale)==null?void 0:n.options)==null?void 0:s.weekStartsOn)??r.weekStartsOn??((i=(a=r.locale)==null?void 0:a.options)==null?void 0:i.weekStartsOn)??0,c=ns(t),u=c.getDay(),h=(u<l?7:0)+u-l;return c.setDate(c.getDate()-h),c.setHours(0,0,0,0),c}function bp(t){return Vu(t,{weekStartsOn:1})}function tS(t){const e=ns(t),n=e.getFullYear(),s=xr(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=bp(s),i=xr(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const r=bp(i);return e.getTime()>=a.getTime()?n+1:e.getTime()>=r.getTime()?n:n-1}function h0(t){const e=ns(t);return e.setHours(0,0,0,0),e}function d0(t){const e=ns(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function YN(t,e){const n=h0(t),s=h0(e),a=+n-d0(n),i=+s-d0(s);return Math.round((a-i)/qN)}function KN(t){const e=tS(t),n=xr(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),bp(n)}function QN(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function JN(t){if(!QN(t)&&typeof t!="number")return!1;const e=ns(t);return!isNaN(Number(e))}function ZN(t){const e=ns(t),n=xr(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}const eP={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},tP=(t,e,n)=>{let s;const a=eP[t];return typeof a=="string"?s=a:e===1?s=a.one:s=a.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function Ig(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const nP={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},sP={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},aP={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},iP={date:Ig({formats:nP,defaultWidth:"full"}),time:Ig({formats:sP,defaultWidth:"full"}),dateTime:Ig({formats:aP,defaultWidth:"full"})},rP={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},oP=(t,e,n,s)=>rP[t];function Dl(t){return(e,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let a;if(s==="formatting"&&t.formattingValues){const r=t.defaultFormattingWidth||t.defaultWidth,l=n!=null&&n.width?String(n.width):r;a=t.formattingValues[l]||t.formattingValues[r]}else{const r=t.defaultWidth,l=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[l]||t.values[r]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const lP={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cP={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},uP={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},hP={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},fP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},pP=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},gP={ordinalNumber:pP,era:Dl({values:lP,defaultWidth:"wide"}),quarter:Dl({values:cP,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Dl({values:uP,defaultWidth:"wide"}),day:Dl({values:hP,defaultWidth:"wide"}),dayPeriod:Dl({values:dP,defaultWidth:"wide",formattingValues:fP,defaultFormattingWidth:"wide"})};function jl(t){return(e,n={})=>{const s=n.width,a=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const r=i[0],l=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?vP(l,d=>d.test(r)):mP(l,d=>d.test(r));let u;u=t.valueCallback?t.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;const h=e.slice(r.length);return{value:u,rest:h}}}function mP(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function vP(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function bP(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const a=s[0],i=e.match(t.parsePattern);if(!i)return null;let r=t.valueCallback?t.valueCallback(i[0]):i[0];r=n.valueCallback?n.valueCallback(r):r;const l=e.slice(a.length);return{value:r,rest:l}}}const yP=/^(\d+)(th|st|nd|rd)?/i,wP=/\d+/i,xP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},kP={any:[/^b/i,/^(a|c)/i]},AP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},SP={any:[/1/i,/2/i,/3/i,/4/i]},_P={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},EP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},CP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},MP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},NP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},PP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},TP={ordinalNumber:bP({matchPattern:yP,parsePattern:wP,valueCallback:t=>parseInt(t,10)}),era:jl({matchPatterns:xP,defaultMatchWidth:"wide",parsePatterns:kP,defaultParseWidth:"any"}),quarter:jl({matchPatterns:AP,defaultMatchWidth:"wide",parsePatterns:SP,defaultParseWidth:"any",valueCallback:t=>t+1}),month:jl({matchPatterns:_P,defaultMatchWidth:"wide",parsePatterns:EP,defaultParseWidth:"any"}),day:jl({matchPatterns:CP,defaultMatchWidth:"wide",parsePatterns:MP,defaultParseWidth:"any"}),dayPeriod:jl({matchPatterns:NP,defaultMatchWidth:"any",parsePatterns:PP,defaultParseWidth:"any"})},LP={code:"en-US",formatDistance:tP,formatLong:iP,formatRelative:oP,localize:gP,match:TP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function RP(t){const e=ns(t);return YN(e,ZN(e))+1}function IP(t){const e=ns(t),n=+bp(e)-+KN(e);return Math.round(n/eS)+1}function nS(t,e){var n,s,a,i;const r=ns(t),l=r.getFullYear(),c=Gp(),u=(e==null?void 0:e.firstWeekContainsDate)??((s=(n=e==null?void 0:e.locale)==null?void 0:n.options)==null?void 0:s.firstWeekContainsDate)??c.firstWeekContainsDate??((i=(a=c.locale)==null?void 0:a.options)==null?void 0:i.firstWeekContainsDate)??1,h=xr(t,0);h.setFullYear(l+1,0,u),h.setHours(0,0,0,0);const d=Vu(h,e),f=xr(t,0);f.setFullYear(l,0,u),f.setHours(0,0,0,0);const g=Vu(f,e);return r.getTime()>=d.getTime()?l+1:r.getTime()>=g.getTime()?l:l-1}function DP(t,e){var n,s,a,i;const r=Gp(),l=(e==null?void 0:e.firstWeekContainsDate)??((s=(n=e==null?void 0:e.locale)==null?void 0:n.options)==null?void 0:s.firstWeekContainsDate)??r.firstWeekContainsDate??((i=(a=r.locale)==null?void 0:a.options)==null?void 0:i.firstWeekContainsDate)??1,c=nS(t,e),u=xr(t,0);return u.setFullYear(c,0,l),u.setHours(0,0,0,0),Vu(u,e)}function jP(t,e){const n=ns(t),s=+Vu(n,e)-+DP(n,e);return Math.round(s/eS)+1}function ge(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const fa={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return ge(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):ge(n+1,2)},d(t,e){return ge(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return ge(t.getHours()%12||12,e.length)},H(t,e){return ge(t.getHours(),e.length)},m(t,e){return ge(t.getMinutes(),e.length)},s(t,e){return ge(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),a=Math.trunc(s*Math.pow(10,n-3));return ge(a,e.length)}},Mr={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},f0={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),a=s>0?s:1-s;return n.ordinalNumber(a,{unit:"year"})}return fa.y(t,e)},Y:function(t,e,n,s){const a=nS(t,s),i=a>0?a:1-a;if(e==="YY"){const r=i%100;return ge(r,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):ge(i,e.length)},R:function(t,e){const n=tS(t);return ge(n,e.length)},u:function(t,e){const n=t.getFullYear();return ge(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return ge(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return ge(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return fa.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return ge(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const a=jP(t,s);return e==="wo"?n.ordinalNumber(a,{unit:"week"}):ge(a,e.length)},I:function(t,e,n){const s=IP(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):ge(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):fa.d(t,e)},D:function(t,e,n){const s=RP(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):ge(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return ge(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return ge(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),a=s===0?7:s;switch(e){case"i":return String(a);case"ii":return ge(a,e.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let a;switch(s===12?a=Mr.noon:s===0?a=Mr.midnight:a=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let a;switch(s>=17?a=Mr.evening:s>=12?a=Mr.afternoon:s>=4?a=Mr.morning:a=Mr.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return fa.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):fa.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):ge(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):ge(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):fa.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):fa.s(t,e)},S:function(t,e){return fa.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return g0(s);case"XXXX":case"XX":return Gi(s);case"XXXXX":case"XXX":default:return Gi(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return g0(s);case"xxxx":case"xx":return Gi(s);case"xxxxx":case"xxx":default:return Gi(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+p0(s,":");case"OOOO":default:return"GMT"+Gi(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+p0(s,":");case"zzzz":default:return"GMT"+Gi(s,":")}},t:function(t,e,n){const s=Math.trunc(t.getTime()/1e3);return ge(s,e.length)},T:function(t,e,n){const s=t.getTime();return ge(s,e.length)}};function p0(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),a=Math.trunc(s/60),i=s%60;return i===0?n+String(a):n+String(a)+e+ge(i,2)}function g0(t,e){return t%60===0?(t>0?"-":"+")+ge(Math.abs(t)/60,2):Gi(t,e)}function Gi(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),a=ge(Math.trunc(s/60),2),i=ge(s%60,2);return n+a+e+i}const m0=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},sS=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},FP=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],a=n[2];if(!a)return m0(t,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",m0(s,e)).replace("{{time}}",sS(a,e))},OP={p:sS,P:FP},WP=/^D+$/,zP=/^Y+$/,$P=["D","DD","YY","YYYY"];function BP(t){return WP.test(t)}function UP(t){return zP.test(t)}function HP(t,e,n){const s=VP(t,e,n);if(console.warn(s),$P.includes(t))throw new RangeError(s)}function VP(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const GP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,qP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,XP=/^'([^]*?)'?$/,YP=/''/g,KP=/[a-zA-Z]/;function QP(t,e,n){var s,a,i,r;const l=Gp(),c=l.locale??LP,u=l.firstWeekContainsDate??((a=(s=l.locale)==null?void 0:s.options)==null?void 0:a.firstWeekContainsDate)??1,h=l.weekStartsOn??((r=(i=l.locale)==null?void 0:i.options)==null?void 0:r.weekStartsOn)??0,d=ns(t);if(!JN(d))throw new RangeError("Invalid time value");let f=e.match(qP).map(v=>{const y=v[0];if(y==="p"||y==="P"){const S=OP[y];return S(v,c.formatLong)}return v}).join("").match(GP).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const y=v[0];if(y==="'")return{isToken:!1,value:JP(v)};if(f0[y])return{isToken:!0,value:v};if(y.match(KP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:v}});c.localize.preprocessor&&(f=c.localize.preprocessor(d,f));const g={firstWeekContainsDate:u,weekStartsOn:h,locale:c};return f.map(v=>{if(!v.isToken)return v.value;const y=v.value;(UP(y)||BP(y))&&HP(y,e,String(t));const S=f0[y[0]];return S(d,y,c.localize,g)}).join("")}function JP(t){const e=t.match(XP);return e?e[1].replace(YP,"'"):t}function ZP(){const{user:t}=On(),[e,n]=C.useState([]),[s,a]=C.useState(!0),[i,r]=C.useState(0),[l,c]=C.useState(0),[u,h]=C.useState([]),[d,f]=C.useState({action_type:"",start_date:"",end_date:""}),[g,v]=C.useState(!1),[y,S]=C.useState([]),b=(t==null?void 0:t.role)==="super_admin",x=50;C.useEffect(()=>{w(),_()},[l,d]);const w=async()=>{a(!0);try{const P=new URLSearchParams;P.append("offset",String(l*x)),P.append("limit",String(x)),d.action_type&&P.append("action_type",d.action_type),d.start_date&&P.append("start_date",d.start_date),d.end_date&&P.append("end_date",d.end_date);const T=await ce.get(`/audit?${P}`);n(T.data.logs||[]),r(T.data.total)}catch(P){console.error("Failed to load logs:",P)}finally{a(!1)}},_=async()=>{try{const P=await ce.get("/audit/types");h(P.data.action_types||[])}catch{}},E=async P=>{if(!(!y.length||!P))try{await ce.post("/audit/bulk-delete",{log_ids:y,reason:P}),S([]),v(!1),w()}catch(T){alert(T instanceof Error?T.message:"Failed to delete logs")}},M=P=>{S(T=>T.includes(P)?T.filter(I=>I!==P):[...T,P])},N=Math.ceil(i/x);return p.jsxs("div",{className:"audit-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsxs("div",{children:[p.jsx("h1",{children:"Audit Logs"}),p.jsx("p",{children:"View system activity and security events"})]}),b&&y.length>0&&p.jsxs("button",{className:"btn btn-danger",onClick:()=>v(!0),children:[p.jsx(Yb,{size:18}),"Delete Selected (",y.length,")"]})]}),p.jsxs("div",{className:"filters glass-card",children:[p.jsxs("div",{className:"filter-group",children:[p.jsx(sM,{size:20}),p.jsx("span",{children:"Filters:"})]}),p.jsxs("select",{className:"input",value:d.action_type,onChange:P=>f({...d,action_type:P.target.value}),children:[p.jsx("option",{value:"",children:"All Actions"}),u.map(P=>p.jsx("option",{value:P,children:v0(P)},P))]}),p.jsx("input",{type:"date",className:"input",value:d.start_date,onChange:P=>f({...d,start_date:P.target.value}),placeholder:"Start Date"}),p.jsx("input",{type:"date",className:"input",value:d.end_date,onChange:P=>f({...d,end_date:P.target.value}),placeholder:"End Date"}),(d.action_type||d.start_date||d.end_date)&&p.jsx("button",{className:"btn btn-secondary",onClick:()=>f({action_type:"",start_date:"",end_date:""}),children:"Clear"})]}),p.jsxs("div",{className:"table-container glass-card",children:[s?p.jsx("div",{className:"loading-container",children:p.jsx("div",{className:"loading-spinner"})}):p.jsxs("table",{className:"table",children:[p.jsx("thead",{children:p.jsxs("tr",{children:[b&&p.jsx("th",{className:"checkbox-col"}),p.jsx("th",{children:"Timestamp"}),p.jsx("th",{children:"Action"}),p.jsx("th",{children:"Actor"}),p.jsx("th",{children:"Target"}),p.jsx("th",{children:"IP Address"}),p.jsx("th",{children:"Details"})]})}),p.jsx("tbody",{children:e.map(P=>p.jsxs("tr",{className:P.deleted_at?"deleted":"",children:[b&&p.jsx("td",{className:"checkbox-col",children:!P.deleted_at&&p.jsx("input",{type:"checkbox",checked:y.includes(P.id),onChange:()=>M(P.id)})}),p.jsx("td",{className:"timestamp",children:QP(new Date(P.created_at),"MMM d, yyyy HH:mm:ss")}),p.jsx("td",{children:p.jsx("span",{className:`badge badge-${tT(P.action_type)}`,children:v0(P.action_type)})}),p.jsx("td",{children:p.jsx("span",{className:"actor-role",children:P.actor_role||"System"})}),p.jsx("td",{children:P.target_type||"-"}),p.jsx("td",{className:"ip-cell",children:P.ip_address||"-"}),p.jsx("td",{children:Object.keys(P.metadata||{}).length>0&&p.jsxs("code",{className:"metadata",children:[JSON.stringify(P.metadata).slice(0,50),"..."]})})]},P.id))})]}),e.length===0&&!s&&p.jsxs("div",{className:"empty-state",children:[p.jsx(X1,{size:48}),p.jsx("p",{children:"No audit logs found"})]}),N>1&&p.jsxs("div",{className:"pagination",children:[p.jsx("button",{className:"btn btn-secondary",disabled:l===0,onClick:()=>c(P=>P-1),children:"Previous"}),p.jsxs("span",{children:["Page ",l+1," of ",N]}),p.jsx("button",{className:"btn btn-secondary",disabled:l>=N-1,onClick:()=>c(P=>P+1),children:"Next"})]})]}),g&&p.jsx(eT,{count:y.length,onClose:()=>v(!1),onConfirm:E})]})}function eT({count:t,onClose:e,onConfirm:n}){const[s,a]=C.useState("");return p.jsx("div",{className:"modal-overlay",onClick:e,children:p.jsxs("div",{className:"modal glass-card",onClick:i=>i.stopPropagation(),children:[p.jsxs("div",{className:"modal-header",children:[p.jsx("h2",{children:"Delete Audit Logs"}),p.jsx("button",{className:"close-btn",onClick:e,children:p.jsx(yl,{size:24})})]}),p.jsxs("div",{className:"modal-body",children:[p.jsxs("p",{className:"warning-text",children:["You are about to delete ",t," audit log(s). This action is logged and cannot be undone."]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Deletion Reason (required)"}),p.jsx("textarea",{className:"input",value:s,onChange:i=>a(i.target.value),placeholder:"Explain why these logs are being deleted...",rows:3,required:!0})]})]}),p.jsxs("div",{className:"modal-footer",children:[p.jsx("button",{className:"btn btn-secondary",onClick:e,children:"Cancel"}),p.jsx("button",{className:"btn btn-danger",onClick:()=>n(s),disabled:!s.trim(),children:"Delete Logs"})]})]})})}function v0(t){return t.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function tT(t){return t.includes("login")||t.includes("logout")?"info":t.includes("failed")||t.includes("delete")?"error":t.includes("create")||t.includes("approve")?"success":"warning"}function nT(){const{user:t,refreshUser:e}=On(),{theme:n,toggleTheme:s}=V1(),a=(t==null?void 0:t.role)==="super_admin";return p.jsxs("div",{className:"settings-page animate-fadeIn",children:[p.jsxs("header",{className:"page-header",children:[p.jsx("h1",{children:"Settings"}),p.jsx("p",{children:"Manage your account and preferences"})]}),p.jsxs("div",{className:"settings-grid",children:[p.jsx(sT,{user:t,onUpdate:e}),p.jsx(aT,{user:t,onUpdate:e}),p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(Mf,{size:24}),p.jsx("h2",{children:"Preferences"})]}),p.jsxs("div",{className:"preference-item",children:[p.jsxs("div",{className:"preference-info",children:[p.jsx("h3",{children:"Theme"}),p.jsx("p",{children:"Choose your preferred color scheme"})]}),p.jsxs("button",{className:"theme-toggle",onClick:s,children:[n==="dark"?p.jsx(jm,{size:20}):p.jsx(Mf,{size:20}),p.jsx("span",{children:n==="dark"?"Light Mode":"Dark Mode"})]})]})]}),a&&p.jsx(rT,{}),p.jsx(iT,{})]})]})}function sT({user:t,onUpdate:e}){var n;const[s,a]=C.useState(!1),[i,r]=C.useState((t==null?void 0:t.full_name)||""),[l,c]=C.useState((t==null?void 0:t.mobile)||""),[u,h]=C.useState(!1),d=async()=>{h(!0);try{await ce.put(`/users/${t.id}`,{full_name:i,mobile:l}),await e(),a(!1)}catch{alert("Failed to update profile")}finally{h(!1)}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(uM,{size:24}),p.jsx("h2",{children:"Profile"})]}),p.jsxs("div",{className:"profile-content",children:[p.jsx("div",{className:"profile-avatar",children:(n=t==null?void 0:t.full_name)==null?void 0:n.charAt(0).toUpperCase()}),s?p.jsxs("div",{className:"profile-form",children:[p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Full Name"}),p.jsx("input",{type:"text",className:"input",value:i,onChange:f=>r(f.target.value)})]}),p.jsxs("div",{className:"input-group",children:[p.jsx("label",{className:"input-label",children:"Mobile"}),p.jsx("input",{type:"tel",className:"input",value:l,onChange:f=>c(f.target.value)})]}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>a(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:d,disabled:u,children:u?"Saving...":"Save"})]})]}):p.jsxs("div",{className:"profile-info",children:[p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Name"}),p.jsx("span",{className:"value",children:t==null?void 0:t.full_name})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Email"}),p.jsx("span",{className:"value",children:t==null?void 0:t.email})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Mobile"}),p.jsx("span",{className:"value",children:(t==null?void 0:t.mobile)||"Not set"})]}),p.jsxs("div",{className:"info-row",children:[p.jsx("span",{className:"label",children:"Role"}),p.jsx("span",{className:"value badge badge-info",children:t==null?void 0:t.role})]}),p.jsx("button",{className:"btn btn-secondary",onClick:()=>a(!0),children:"Edit Profile"})]})]})]})}function aT({user:t,onUpdate:e}){const[n,s]=C.useState(!1),[a,i]=C.useState(""),[r,l]=C.useState(""),[c,u]=C.useState(!1),[h,d]=C.useState(!1),[f,g]=C.useState(""),[v,y]=C.useState(""),S=async()=>{u(!0);try{await ce.post("/auth/change-password",{current_password:a,new_password:r}),alert("Password changed successfully"),s(!1),i(""),l("")}catch(_){alert(_ instanceof Error?_.message:"Failed to change password")}finally{u(!1)}},b=async()=>{try{const _=await ce.get("/auth/totp/setup");g(_.data.secret),d(!0)}catch{alert("Failed to setup 2FA")}},x=async()=>{try{await ce.post("/auth/totp/enable",{secret:f,code:v}),await e(),d(!1),y(""),alert("2FA enabled successfully")}catch{alert("Invalid code")}},w=async()=>{if(confirm("Are you sure you want to disable 2FA?"))try{await ce.post("/auth/totp/disable",{}),await e()}catch{alert("Failed to disable 2FA")}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(Nf,{size:24}),p.jsx("h2",{children:"Security"})]}),p.jsxs("div",{className:"security-item",children:[p.jsxs("div",{className:"security-info",children:[p.jsx(Y1,{size:20}),p.jsxs("div",{children:[p.jsx("h3",{children:"Password"}),p.jsx("p",{children:"Change your account password"})]})]}),n?p.jsxs("div",{className:"password-form",children:[p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"password",className:"input",placeholder:"Current password",value:a,onChange:_=>i(_.target.value)})}),p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"password",className:"input",placeholder:"New password (min 8 characters)",value:r,onChange:_=>l(_.target.value),minLength:8})}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:S,disabled:c||r.length<8,children:c?"Changing...":"Change Password"})]})]}):p.jsx("button",{className:"btn btn-secondary",onClick:()=>s(!0),children:"Change"})]}),p.jsxs("div",{className:"security-item",children:[p.jsxs("div",{className:"security-info",children:[p.jsx(cM,{size:20}),p.jsxs("div",{children:[p.jsx("h3",{children:"Two-Factor Authentication"}),p.jsx("p",{children:t!=null&&t.totp_enabled?"Enabled":"Add extra security to your account"})]})]}),h?p.jsxs("div",{className:"totp-form",children:[p.jsxs("p",{className:"totp-instructions",children:["Add this secret to your authenticator app: ",p.jsx("code",{children:f})]}),p.jsx("div",{className:"input-group",children:p.jsx("input",{type:"text",className:"input",placeholder:"Enter 6-digit code",value:v,onChange:_=>y(_.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6})}),p.jsxs("div",{className:"button-group",children:[p.jsx("button",{className:"btn btn-secondary",onClick:()=>d(!1),children:"Cancel"}),p.jsx("button",{className:"btn btn-primary",onClick:x,disabled:v.length!==6,children:"Enable 2FA"})]})]}):t!=null&&t.totp_enabled?p.jsx("button",{className:"btn btn-danger",onClick:w,children:"Disable"}):p.jsx("button",{className:"btn btn-secondary",onClick:b,children:"Setup"})]})]})}function iT(){const[t,e]=C.useState([]),[n,s]=C.useState(!1),a=async()=>{s(!0);try{const i=await ce.get("/auth/sessions");e(i.data.sessions||[])}catch(i){console.error("Failed to load sessions:",i)}finally{s(!1)}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(K1,{size:24}),p.jsx("h2",{children:"Active Sessions"}),p.jsx("button",{className:"btn btn-secondary",onClick:a,disabled:n,children:n?"Loading...":"View Sessions"})]}),t.length>0&&p.jsx("div",{className:"sessions-list",children:t.map((i,r)=>{var l;return p.jsx("div",{className:"session-item",children:p.jsxs("div",{className:"session-info",children:[p.jsx("span",{className:"session-ip",children:i.ip_address}),p.jsxs("span",{className:"session-agent",children:[(l=i.user_agent)==null?void 0:l.slice(0,50),"..."]}),p.jsxs("span",{className:"session-time",children:["Last active: ",new Date(i.last_activity).toLocaleString()]})]})},i.id||r)})})]})}function rT(){const[t,e]=C.useState(null),[n,s]=C.useState(!0),[a,i]=C.useState(!1),[r,l]=C.useState(""),[c,u]=C.useState(""),[h,d]=C.useState(20),[f,g]=C.useState(20),[v,y]=C.useState(!1);C.useEffect(()=>{x(),S()},[]);const S=async()=>{var E;try{const M=localStorage.getItem("access_token"),N=localStorage.getItem("desktop_session"),P={Authorization:`Bearer ${M}`};N&&(P["X-Desktop-Session"]=N);const T=await fetch("/api/v1/system/config",{headers:P});if(T.ok){const I=await T.json(),V=parseInt(((E=I.config)==null?void 0:E.watermark_opacity)||"20",10);d(V),g(V)}}catch(M){console.log("Failed to load opacity setting:",M)}},b=async()=>{y(!0),l(""),u("");try{const E=localStorage.getItem("access_token"),M=localStorage.getItem("desktop_session"),N={"Content-Type":"application/json",Authorization:`Bearer ${E||""}`};M&&(N["X-Desktop-Session"]=M);const P=await fetch("/api/v1/system/config",{method:"PUT",headers:N,body:JSON.stringify({key:"watermark_opacity",value:String(h)})});if(P.ok)g(h),u(`Watermark opacity set to ${h}%`);else{const T=await P.json();l(T.error||"Failed to save opacity")}}catch{l("Failed to save opacity setting")}finally{y(!1)}},x=async()=>{try{const E=localStorage.getItem("access_token"),M=localStorage.getItem("desktop_session"),N={Authorization:`Bearer ${E}`};M&&(N["X-Desktop-Session"]=M);const P=await fetch("/api/v1/system/logo",{headers:N});if(P.ok){const T=await P.blob();e(URL.createObjectURL(T)),console.log("Logo loaded successfully")}else e(null),console.log("No logo found:",P.status)}catch(E){e(null),console.log("Failed to load logo:",E)}finally{s(!1)}},w=async E=>{var M;const N=(M=E.target.files)==null?void 0:M[0];if(N){if(!["image/png","image/jpeg","image/gif"].includes(N.type)){l("Only PNG, JPG, or GIF files allowed");return}if(N.size>500*1024){l("Logo file too large (max 500KB)");return}l(""),u(""),i(!0);try{const P=localStorage.getItem("access_token"),T=localStorage.getItem("desktop_session"),I=new FormData;I.append("logo",N);const V={Authorization:`Bearer ${P||""}`};T&&(V["X-Desktop-Session"]=T);const re=await fetch("/api/v1/system/logo",{method:"POST",headers:V,body:I});if(re.ok)u("Logo uploaded successfully"),x();else{const ue=await re.json();l(ue.error||"Failed to upload logo")}}catch{l("Failed to upload logo")}finally{i(!1)}}},_=async()=>{if(confirm("Are you sure you want to delete the company logo?")){l(""),u("");try{const E=localStorage.getItem("access_token"),M=localStorage.getItem("desktop_session"),N={Authorization:`Bearer ${E||""}`};M&&(N["X-Desktop-Session"]=M);const P=await fetch("/api/v1/system/logo",{method:"DELETE",headers:N});if(P.ok)u("Logo deleted"),e(null);else{const T=await P.json();l(T.error||"Failed to delete logo")}}catch{l("Failed to delete logo")}}};return p.jsxs("section",{className:"settings-section glass-card",children:[p.jsxs("div",{className:"section-header",children:[p.jsx(Ew,{size:24}),p.jsx("h2",{children:"Company Logo"})]}),p.jsx("p",{className:"section-description",children:"Upload a company logo to display in document watermarks. The logo will be visible on all documents viewed by users."}),r&&p.jsx("div",{className:"error-message",children:r}),c&&p.jsx("div",{className:"success-message",children:c}),p.jsx("div",{className:"logo-preview-container",children:n?p.jsx("div",{className:"loading-spinner"}):t?p.jsx("img",{src:t,alt:"Company Logo",className:"logo-preview"}):p.jsxs("div",{className:"logo-placeholder",children:[p.jsx(Ew,{size:48}),p.jsx("span",{children:"No logo uploaded"})]})}),p.jsxs("div",{className:"logo-actions",children:[p.jsxs("label",{className:"btn btn-primary upload-btn",children:[p.jsx(Z1,{size:16}),a?"Uploading...":"Upload Logo",p.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/gif",onChange:w,disabled:a,style:{display:"none"}})]}),t&&p.jsxs("button",{className:"btn btn-danger",onClick:_,children:[p.jsx(Yb,{size:16}),"Delete Logo"]})]}),p.jsx("p",{className:"help-text",children:"Supported formats: PNG, JPG, GIF  Max size: 500KB"}),p.jsxs("div",{className:"opacity-control",children:[p.jsx("h3",{children:"Watermark Opacity"}),p.jsx("p",{className:"section-description",children:"Adjust how visible the watermark appears on documents (1% = very faint, 100% = solid)"}),p.jsxs("div",{className:"opacity-slider-container",children:[p.jsx("input",{type:"range",min:"1",max:"100",value:h,onChange:E=>d(parseInt(E.target.value,10)),className:"opacity-slider"}),p.jsxs("span",{className:"opacity-value",children:[h,"%"]})]}),p.jsxs("div",{className:"opacity-actions",children:[p.jsx("button",{className:"btn btn-primary",onClick:b,disabled:v||h===f,children:v?"Applying...":"Apply Opacity"}),h!==f&&p.jsx("span",{className:"unsaved-indicator",children:"Unsaved changes"})]})]})]})}const Dg={CONFIG_UPDATE:"CONFIG_UPDATE",FORCE_LOGOUT:"FORCE_LOGOUT",SESSION_REVOKED:"SESSION_REVOKED"};function oT(t={}){const{user:e,logout:n}=On(),s=C.useRef(null),a=C.useRef(null),i=C.useRef(0),r=5,l=C.useCallback(()=>{if(!e)return;s.current&&s.current.close();const c=localStorage.getItem("access_token");if(!c)return;const u=`/api/v1/realtime/subscribe?token=${encodeURIComponent(c)}`,h=new EventSource(u,{withCredentials:!0});s.current=h,h.addEventListener("connected",d=>{var f;i.current=0;try{const g=JSON.parse(d.data);(f=t.onConnected)==null||f.call(t,g.client_id)}catch{}}),h.addEventListener(Dg.CONFIG_UPDATE,d=>{var f;try{const g=JSON.parse(d.data);g.payload&&((f=t.onConfigUpdate)==null||f.call(t,g.payload.key,g.payload.value))}catch{console.error("Failed to parse CONFIG_UPDATE event")}}),h.addEventListener(Dg.FORCE_LOGOUT,d=>{var f,g;try{const v=((f=JSON.parse(d.data).payload)==null?void 0:f.reason)||"Your session has been terminated";(g=t.onForceLogout)==null||g.call(t,v),n(),alert(v)}catch{n()}}),h.addEventListener(Dg.SESSION_REVOKED,d=>{var f,g;try{const v=((f=JSON.parse(d.data).payload)==null?void 0:f.reason)||"Session revoked by administrator";(g=t.onForceLogout)==null||g.call(t,v),n(),alert(v)}catch{n()}}),h.onerror=d=>{var f;if((f=t.onError)==null||f.call(t,d),h.close(),i.current<r){const g=Math.min(1e3*Math.pow(2,i.current),3e4);i.current++,a.current=window.setTimeout(l,g)}}},[e,n,t]);return C.useEffect(()=>(l(),()=>{s.current&&s.current.close(),a.current&&window.clearTimeout(a.current)}),[l]),{reconnect:C.useCallback(()=>{i.current=0,l()},[l])}}function lT(){var t;const{user:e,logout:n}=On(),{theme:s,toggleTheme:a}=V1(),i=_r(),[r,l]=C.useState(!1),c=C.useCallback((v,y)=>{console.log(`[SSE] Config updated: ${v} =`,y),window.dispatchEvent(new CustomEvent("srams:config-update",{detail:{key:v,value:y}}))},[]),u=C.useCallback(v=>{console.log("[SSE] Force logout:",v)},[]);oT({onConfigUpdate:c,onForceLogout:u,onConnected:v=>console.log(`[SSE] Connected: ${v}`),onError:()=>console.warn("[SSE] Connection error, will retry...")});const h=async()=>{await n(),i("/login")},d=(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin",f=(e==null?void 0:e.role)==="super_admin",g=[{to:"/dashboard",icon:aM,label:"Dashboard"},{to:"/documents",icon:_s,label:"Documents"},...d?[{to:"/users",icon:dl,label:"Users"},{to:"/audit",icon:X1,label:"Audit Logs"}]:[],{to:"/settings",icon:lM,label:"Settings"}];return p.jsxs("div",{className:"layout",children:[p.jsxs("header",{className:"mobile-header",children:[p.jsx("button",{className:"menu-btn",onClick:()=>l(!0),children:p.jsx(rM,{size:24})}),p.jsxs("div",{className:"logo",children:[p.jsx(Nf,{size:24}),p.jsx("span",{children:"SRAMS"})]}),p.jsx("button",{className:"theme-btn",onClick:a,children:s==="twilight"?p.jsx(jm,{size:20}):p.jsx(Mf,{size:20})})]}),r&&p.jsx("div",{className:"sidebar-overlay",onClick:()=>l(!1)}),p.jsxs("aside",{className:`sidebar ${r?"open":""}`,children:[p.jsxs("div",{className:"sidebar-header",children:[p.jsxs("div",{className:"logo",children:[p.jsx(Nf,{size:28}),p.jsx("span",{children:"SRAMS"})]}),p.jsx("button",{className:"close-btn",onClick:()=>l(!1),children:p.jsx(yl,{size:24})})]}),p.jsx("nav",{className:"sidebar-nav",children:g.map(v=>p.jsxs($C,{to:v.to,className:({isActive:y})=>`nav-item ${y?"active":""}`,onClick:()=>l(!1),children:[p.jsx(v.icon,{size:20}),p.jsx("span",{children:v.label})]},v.to))}),p.jsxs("div",{className:"sidebar-footer",children:[p.jsxs("div",{className:"user-info",children:[p.jsx("div",{className:"user-avatar",children:(t=e==null?void 0:e.full_name)==null?void 0:t.charAt(0).toUpperCase()}),p.jsxs("div",{className:"user-details",children:[p.jsx("span",{className:"user-name",children:e==null?void 0:e.full_name}),p.jsx("span",{className:"user-role",children:f?"Super Admin":d?"Admin":"User"})]})]}),p.jsxs("div",{className:"sidebar-actions",children:[p.jsx("button",{className:"action-btn",onClick:a,title:"Toggle theme",children:s==="twilight"?p.jsx(jm,{size:18}):p.jsx(Mf,{size:18})}),p.jsx("button",{className:"action-btn logout",onClick:h,title:"Logout",children:p.jsx(K1,{size:18})})]})]})]}),p.jsx("main",{className:"main-content",children:p.jsx(EC,{})})]})}function jg({children:t,roles:e}){const{user:n,loading:s}=On();return s?p.jsx("div",{className:"flex items-center justify-center",style:{height:"100vh"},children:p.jsx("div",{className:"animate-spin",style:{width:40,height:40,border:"3px solid var(--color-border)",borderTopColor:"var(--color-accent-primary)",borderRadius:"50%"}})}):n?e&&!e.includes(n.role)?p.jsx(Tm,{to:"/dashboard",replace:!0}):p.jsx(p.Fragment,{children:t}):p.jsx(Tm,{to:"/login",replace:!0})}function cT(){return p.jsx(qC,{children:p.jsx(KC,{children:p.jsx(FC,{children:p.jsxs(MC,{children:[p.jsx(zn,{path:"/login",element:p.jsx(pM,{})}),p.jsx(zn,{path:"/force-change-password",element:p.jsx(gM,{})}),p.jsxs(zn,{path:"/",element:p.jsx(jg,{children:p.jsx(lT,{})}),children:[p.jsx(zn,{index:!0,element:p.jsx(Tm,{to:"/dashboard",replace:!0})}),p.jsx(zn,{path:"dashboard",element:p.jsx(mM,{})}),p.jsx(zn,{path:"documents",element:p.jsx(yM,{})}),p.jsx(zn,{path:"documents/:id",element:p.jsx(BN,{})}),p.jsx(zn,{path:"users",element:p.jsx(jg,{roles:["admin","super_admin"],children:p.jsx(UN,{})})}),p.jsx(zn,{path:"audit",element:p.jsx(jg,{roles:["admin","super_admin"],children:p.jsx(ZP,{})})}),p.jsx(zn,{path:"settings",element:p.jsx(nT,{})})]})]})})})})}Fg.createRoot(document.getElementById("root")).render(p.jsx(N0.StrictMode,{children:p.jsx(cT,{})}));
